<!doctype html>
<html lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />

<meta name="generator" content="Hugo 0.120.3">

<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel="stylesheet">
<link href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" rel="stylesheet"/>
<style type="text/css">/*https://coolors.co/afd5aa-f0f2ef-a69f98-3d3d3d-8c6057*/
:root {
  --main-color: #8C6056; 
  --secondary-color: #AFD5AA;
  --logo-text-color: #fff;
  --body-text-color: #3d3d3d;
  --heading-text-color: #383838;
  --background-color: #fff;
}</style>
<link href='https://blog.dornea.nu/css/tachyons.min.css' rel="stylesheet">
<link href='https://blog.dornea.nu/css/styles.css' rel="stylesheet">
<link rel="stylesheet" href="https://blog.dornea.nu/css/custom.css">
<link rel="stylesheet" href="https://blog.dornea.nu/css/syntax.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script>


<link rel="icon" 
 
  href='https://blog.dornea.nu/favicon.ico'

type="image/x-icon"/>

<link href='https://blog.dornea.nu/feed.xml' rel="alternate" type="application/atom+xml" title="blog.dornea.nu" />



<script src="https://beamanalytics.b-cdn.net/beam.min.js" data-token="b8a4b728-8eda-42fb-8376-10168c622160" async>

</script>

</head>
<body class="global-font">
  <nav class=" flex-ns justify-between border-box pa3 pl3-l pr2-l mt1 mt0-ns" id="navbar">
  <div class="flex">
    <a class="f4 fw6 ttu no-underline dim bg-main-color pv1 ph2 br2" id="site-title" href='https://blog.dornea.nu/' title="Home">blog.dornea.nu</a>
  </div>
  
  <div class=" flex-ns mt2 mt0-ns pv1">
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='https://blog.dornea.nu/' title="Home">Home</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='http://dornea.nu' title="About">About</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='https://blog.dornea.nu/feed.xml' title="RSS">RSS</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='https://blog.dornea.nu/tags' title="Tags">Tags</a>
    
      <a class="link dim dark-gray f6 dib mr2 mr3-l ttu tracked" href='https://brainfck.org' title="Zettelkasten">Zettelkasten</a>
    
  </div>
  
</nav>
  
<main class="center mv4 content-width ph3">
  <div class="f3 fw6 heading-color heading-font post-title">Android Dynamic Code Analysis - Mastering DroidBox</div>
  <p class="silver f6 mt1 mb4 post-meta">
    <time>05 Aug 2014</time> 
     | 
    

    
     ~
  

16 mins
|

    
    tags: [ <a href='https://blog.dornea.nu/tags/android' class="link silver">android</a> <a href='https://blog.dornea.nu/tags/hacking' class="link silver">hacking</a> <a href='https://blog.dornea.nu/tags/networking' class="link silver">networking</a> <a href='https://blog.dornea.nu/tags/security' class="link silver">security</a> <a href='https://blog.dornea.nu/tags/ipython' class="link silver">ipython</a> <a href='https://blog.dornea.nu/tags/code' class="link silver">code</a> <a href='https://blog.dornea.nu/tags/sca' class="link silver">sca</a> <a href='https://blog.dornea.nu/tags/droidbox' class="link silver">droidbox</a> <a href='https://blog.dornea.nu/tags/re' class="link silver">re</a> <a href='https://blog.dornea.nu/tags/mobile' class="link silver">mobile</a> <a href='https://blog.dornea.nu/tags/fakebanker' class="link silver">fakebanker</a> <a href='https://blog.dornea.nu/tags/appsec' class="link silver">appsec</a>  ]
    

  </p>
  <div class="lh-copy post-content">
    

      <p>In this article I&rsquo;ll have a a closer look at <a href="https://code.google.com/p/droidbox/">DroidBox</a> which provides a mobile sandbox to look at Android applications. In the previous <a href="https://blog.dornea.nu/2014/07/07/disect-android-apks-like-a-pro-static-code-analysis/">post</a> I&rsquo;ve dealt with <em>static code analysis</em>. This time will start running our malicious application and look at the &ldquo;noise&rdquo; it generates. That would be:</p>
<ul>
<li>file system access</li>
<li>network activity</li>
<li>interaction with the operating system</li>
<li>interaction with other applications</li>
<li>etc.</li>
</ul>
<p><em>DroidBox</em> is very easy to use and consists of an own system image and kernel meant to log one applications activities. Using <code>adb logcat</code> <em>DroidBox</em> will look for certain debug messages and collect anything related to the monitored app. However I must say that loged data isn&rsquo;t always complete. Sometimes you&rsquo;ll get only a <em>striped</em> version of the data which caused the activity. In that case it&rsquo;s almost impossible e.g. to have a deep look at the network traffic (especially HTTP). You won&rsquo;t be able to construct a full request-response-sequence due to missing data. Nevertheless you can use DroidBox to get an overview of malicious activities triggered by the app. For a more technical analysis of the data you&rsquo;ll need additional tools (more to come in future posts).</p>
<h3 id="requirements-for-droidbox">Requirements for DroidBox</h3>
<p>First you&rsquo;ll have to install some requirements DroidBox needs. First make sure you have the system relevant packages installed:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">root@kali:~# apt-get install python-virtualenv libatlas-dev liblapack-dev libblas-dev
</span></span></code></pre></td></tr></table>
</div>
</div><p>You&rsquo;ll need those in order to use <code>scipy</code>, <code>matplotlib</code> and <code>numpy</code> along with Droidbox. Now create a virtual environment and install <em>python</em> dependencies:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl">root@kali:~/work/apk# mkdir env
</span></span><span class="line"><span class="cl">root@kali:~/work/apk# virtualenv env
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">root@kali:~/work/apk# <span class="nb">source</span> env/bin/activate
</span></span><span class="line"><span class="cl"><span class="o">(</span>env<span class="o">)</span>root@kali:~/work/apk# pip install numpy scipy matplotlib
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="install-droidbox">Install Droidbox</h3>
<p>Download the package:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">(</span>env<span class="o">)</span>root@kali:~/work/apk# wget https://droidbox.googlecode.com/files/DroidBox411RC.tar.gz
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="setup-path">Setup PATH</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">import</span> <span class="n">os</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">sys</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Setup new PATH</span>
</span></span><span class="line"><span class="cl"><span class="n">old_path</span> <span class="o">=</span> <span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="n">new_path</span> <span class="o">=</span> <span class="n">old_path</span> <span class="o">+</span> <span class="s2">&#34;:&#34;</span> <span class="o">+</span> <span class="s2">&#34;/root/work/apk/SDK/android-sdk-linux/tools:/root/work/apk/SDK/android-sdk-linux/platform-tools:/root/work/apk/SDK/android-sdk-linux/build-tools/19.1.0&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">environ</span><span class="p">[</span><span class="s1">&#39;PATH&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="n">new_path</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Change working directory</span>
</span></span><span class="line"><span class="cl"><span class="n">os</span><span class="o">.</span><span class="n">chdir</span><span class="p">(</span><span class="s2">&#34;/root/work/apk/DroidBox_4.1.1/&#34;</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h3 id="setup-ipython-settings">Setup IPython settings</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">%pylab inline
</span></span><span class="line"><span class="cl">import binascii
</span></span><span class="line"><span class="cl">import pandas as pd
</span></span><span class="line"><span class="cl">import numpy as np
</span></span><span class="line"><span class="cl">import matplotlib.pyplot as plt
</span></span><span class="line"><span class="cl">import networkx as nx
</span></span><span class="line"><span class="cl">import datetime as dt
</span></span><span class="line"><span class="cl">import time
</span></span><span class="line"><span class="cl">import ipy_table
</span></span><span class="line"><span class="cl">from IPython.display import display_pretty, display_html, display_jpeg, display_png, display_json, display_latex, display_svg
</span></span><span class="line"><span class="cl">from IPython.display import HTML
</span></span><span class="line"><span class="cl">from IPython.core.magic import register_cell_magic, Magics, magics_class, cell_magic
</span></span><span class="line"><span class="cl">import jinja2
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Ipython settings
</span></span><span class="line"><span class="cl">pd.set_option(&#39;display.height&#39;, 1000)
</span></span><span class="line"><span class="cl">pd.set_option(&#39;display.max_rows&#39;, 500)
</span></span><span class="line"><span class="cl">pd.set_option(&#39;display.max_columns&#39;, 500)
</span></span><span class="line"><span class="cl">pd.set_option(&#39;display.max_colwidth&#39;, 100)
</span></span><span class="line"><span class="cl">pd.set_option(&#39;display.width&#39;, 1000)
</span></span><span class="line"><span class="cl">pd.set_option(&#39;display.column_space&#39;, 1000)
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>Populating the interactive namespace from numpy and matplotlib
height has been deprecated.
</code></pre>
<h3 id="external-extensions">External extensions</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1"># Install</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">install_ext</span> <span class="n">https</span><span class="p">:</span><span class="o">//</span><span class="n">raw</span><span class="o">.</span><span class="n">githubusercontent</span><span class="o">.</span><span class="n">com</span><span class="o">/</span><span class="n">dorneanu</span><span class="o">/</span><span class="n">ipython</span><span class="o">/</span><span class="n">master</span><span class="o">/</span><span class="n">extensions</span><span class="o">/</span><span class="n">diagmagic</span><span class="o">.</span><span class="n">py</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="c1"># Then load extensions</span>
</span></span><span class="line"><span class="cl"><span class="o">%</span><span class="n">load_ext</span> <span class="n">diagmagic</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>Installed diagmagic.py. To use it, type:
  %load_ext diagmagic
</code></pre>
<h3 id="utilities">Utilities</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="n">from</span> <span class="n">IPython</span> <span class="n">import</span> <span class="n">display</span>
</span></span><span class="line"><span class="cl"><span class="n">from</span> <span class="n">IPython</span><span class="o">.</span><span class="n">core</span><span class="o">.</span><span class="n">magic</span> <span class="n">import</span> <span class="n">register_cell_magic</span><span class="p">,</span> <span class="n">Magics</span><span class="p">,</span> <span class="n">magics_class</span><span class="p">,</span> <span class="n">cell_magic</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">jinja2</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># &lt;!-- collapse=True --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="k">def</span> <span class="nf">df2table</span><span class="p">(</span><span class="n">df</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s2">&#34;&#34;&#34; Outputs a DataFrame as a table using ipy_table &#34;&#34;&#34;</span>
</span></span><span class="line"><span class="cl">    <span class="n">entries</span> <span class="o">=</span> <span class="p">[</span><span class="n">list</span><span class="p">(</span><span class="n">i</span><span class="p">)</span> <span class="k">for</span> <span class="n">i</span> <span class="ow">in</span> <span class="n">df</span><span class="o">.</span><span class="n">itertuples</span><span class="p">()]</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Extract table header</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span> <span class="o">=</span> <span class="n">list</span><span class="p">(</span><span class="n">df</span><span class="o">.</span><span class="n">columns</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Add index to header</span>
</span></span><span class="line"><span class="cl">    <span class="n">header</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">df</span><span class="o">.</span><span class="n">index</span><span class="o">.</span><span class="n">name</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="c1"># Insert header at 1st place</span>
</span></span><span class="line"><span class="cl">    <span class="n">entries</span><span class="o">.</span><span class="n">insert</span><span class="p">(</span><span class="mi">0</span><span class="p">,</span> <span class="n">header</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    <span class="k">return</span> <span class="n">ipy_table</span><span class="o">.</span><span class="n">make_table</span><span class="p">(</span><span class="n">entries</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Create jinja cell magic (http://nbviewer.ipython.org/urls/gist.github.com/bj0/5343292/raw/23a0845ee874827e3635edb0bf5701710a537bfc/jinja2.ipynb)</span>
</span></span><span class="line"><span class="cl"><span class="err">@</span><span class="n">magics_class</span>
</span></span><span class="line"><span class="cl"><span class="k">class</span> <span class="n">JinjaMagics</span><span class="p">(</span><span class="n">Magics</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">    <span class="s1">&#39;&#39;&#39;Magics class containing the jinja2 magic and state&#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">__init__</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">shell</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="n">super</span><span class="p">(</span><span class="n">JinjaMagics</span><span class="p">,</span> <span class="bp">self</span><span class="p">)</span><span class="o">.</span><span class="n">__init__</span><span class="p">(</span><span class="n">shell</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># create a jinja2 environment to use for rendering</span>
</span></span><span class="line"><span class="cl">        <span class="c1"># this can be modified for desired effects (ie: using different variable syntax)</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">env</span> <span class="o">=</span> <span class="n">jinja2</span><span class="o">.</span><span class="n">Environment</span><span class="p">(</span><span class="n">loader</span><span class="o">=</span><span class="n">jinja2</span><span class="o">.</span><span class="n">FileSystemLoader</span><span class="p">(</span><span class="s1">&#39;.&#39;</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="c1"># possible output types</span>
</span></span><span class="line"><span class="cl">        <span class="bp">self</span><span class="o">.</span><span class="n">display_functions</span> <span class="o">=</span> <span class="n">dict</span><span class="p">(</span><span class="n">html</span><span class="o">=</span><span class="n">display</span><span class="o">.</span><span class="n">HTML</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">                                      <span class="n">latex</span><span class="o">=</span><span class="n">display</span><span class="o">.</span><span class="n">Latex</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                      <span class="n">json</span><span class="o">=</span><span class="n">display</span><span class="o">.</span><span class="n">JSON</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                      <span class="n">pretty</span><span class="o">=</span><span class="n">display</span><span class="o">.</span><span class="n">Pretty</span><span class="p">,</span>
</span></span><span class="line"><span class="cl">                                      <span class="n">display</span><span class="o">=</span><span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl">    <span class="err">@</span><span class="n">cell_magic</span>
</span></span><span class="line"><span class="cl">    <span class="k">def</span> <span class="nf">jinja</span><span class="p">(</span><span class="bp">self</span><span class="p">,</span> <span class="n">line</span><span class="p">,</span> <span class="n">cell</span><span class="p">):</span>
</span></span><span class="line"><span class="cl">        <span class="s1">&#39;&#39;&#39;
</span></span></span><span class="line"><span class="cl"><span class="s1">        jinja2 cell magic function.  Contents of cell are rendered by jinja2, and 
</span></span></span><span class="line"><span class="cl"><span class="s1">        the line can be used to specify output type.
</span></span></span><span class="line"><span class="cl"><span class="s1">
</span></span></span><span class="line"><span class="cl"><span class="s1">        ie: &#34;</span><span class="si">%%</span><span class="s1">jinja html&#34; will return the rendered cell wrapped in an HTML object.
</span></span></span><span class="line"><span class="cl"><span class="s1">        &#39;&#39;&#39;</span>
</span></span><span class="line"><span class="cl">        <span class="n">f</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">display_functions</span><span class="o">.</span><span class="n">get</span><span class="p">(</span><span class="n">line</span><span class="o">.</span><span class="n">lower</span><span class="p">()</span><span class="o">.</span><span class="n">strip</span><span class="p">(),</span> <span class="n">display</span><span class="o">.</span><span class="n">display</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="n">tmp</span> <span class="o">=</span> <span class="bp">self</span><span class="o">.</span><span class="n">env</span><span class="o">.</span><span class="n">from_string</span><span class="p">(</span><span class="n">cell</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        <span class="n">rend</span> <span class="o">=</span> <span class="n">tmp</span><span class="o">.</span><span class="n">render</span><span class="p">(</span><span class="n">dict</span><span class="p">((</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="k">for</span> <span class="p">(</span><span class="n">k</span><span class="p">,</span><span class="n">v</span><span class="p">)</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">user_ns</span><span class="o">.</span><span class="n">items</span><span class="p">()</span> 
</span></span><span class="line"><span class="cl">                                        <span class="k">if</span> <span class="ow">not</span> <span class="n">k</span><span class="o">.</span><span class="n">startswith</span><span class="p">(</span><span class="s1">&#39;_&#39;</span><span class="p">)</span> <span class="ow">and</span> <span class="n">k</span> <span class="ow">not</span> <span class="ow">in</span> <span class="bp">self</span><span class="o">.</span><span class="n">shell</span><span class="o">.</span><span class="n">user_ns_hidden</span><span class="p">))</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">        <span class="k">return</span> <span class="n">f</span><span class="p">(</span><span class="n">rend</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">        
</span></span><span class="line"><span class="cl">    
</span></span><span class="line"><span class="cl"><span class="n">ip</span> <span class="o">=</span> <span class="n">get_ipython</span><span class="p">()</span>
</span></span><span class="line"><span class="cl"><span class="n">ip</span><span class="o">.</span><span class="n">register_magics</span><span class="p">(</span><span class="n">JinjaMagics</span><span class="p">)</span>
</span></span></code></pre></td></tr></table>
</div>
</div><h2 id="create-android-virtual-device-adv">Create Android Virtual Device (ADV)</h2>
<p>Now you&rsquo;ll have to install an Android device virtually in order to analyze the APK. Supposing you have installed the SDK in the previous step now you should have some <em>targets</em> available on your machine. If not (that was my case) then make sure you have a X session running and run <code>android</code> from the console. In my case I&rsquo;ve fired up <code>vnc</code> and connected to the Kali machine.</p>
<p>This is what I&rsquo;ve got:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">%%bash
</span></span><span class="line"><span class="cl">android list targets <span class="p">|</span> head -n <span class="m">10</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>Available Android targets:
----------
id: 1 or &quot;android-16&quot;
     Name: Android 4.1.2
     Type: Platform
     API level: 16
     Revision: 4
     Skins: WXGA800-7in, WQVGA400, WVGA800 (default), WXGA800, HVGA, WSVGA, WVGA854, WQVGA432, WXGA720, QVGA
 Tag/ABIs : default/armeabi-v7a
----------
</code></pre>
<p>Now we <strong>create</strong> the AVD using following command:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># android create avd --abi default/armeabi-v7a -n android-4.1.2-droidbox -t 1 -c 1000M
</span></span><span class="line"><span class="cl">Android 4.1.2 is a basic Android platform.
</span></span><span class="line"><span class="cl">Do you wish to create a custom hardware profile [no]
</span></span><span class="line"><span class="cl">Created AVD &#39;android-4.1.2-droidbox&#39; based on Android 4.1.2, ARM (armeabi-v7a) processor,
</span></span><span class="line"><span class="cl">with the following hardware config:
</span></span><span class="line"><span class="cl">hw.lcd.density=240
</span></span><span class="line"><span class="cl">hw.ramSize=512
</span></span><span class="line"><span class="cl">hw.sdCard=yes
</span></span><span class="line"><span class="cl">vm.heapSize=48
</span></span></code></pre></td></tr></table>
</div>
</div><div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">%%bash
</span></span><span class="line"><span class="cl">android list avd
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>Available Android Virtual Devices:
    Name: android-4.1.2-droidbox
    Path: /root/.android/avd/android-4.1.2-droidbox.avd
  Target: Android 4.1.2 (API level 16)
 Tag/ABI: default/armeabi-v7a
    Skin: WVGA800
  Sdcard: 1000M
</code></pre>
<h3 id="start-the-emulator">Start the emulator</h3>
<p>In <code>DroidBox</code>s package directory you&rsquo;ll find <code>startemu.sh</code>. Open it and add your favourite parameters.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-bash" data-lang="bash"><span class="line"><span class="cl">%%bash
</span></span><span class="line"><span class="cl">cat startemu.sh
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>#!/usr/bin/env bash

emulator -avd $1 -system images/system.img -ramdisk images/ramdisk.img -wipe-data -prop dalvik.vm.execution-mode=int:portable &amp;
</code></pre>
<p>Afterwards make sure you have a X session and <strong>run</strong> the emulator with your previously created AVD:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-shell" data-lang="shell"><span class="line"><span class="cl"><span class="o">(</span>env<span class="o">)</span>root@kali:~/work/apk/DroidBox# ./startemu.sh android-4.1.2-droidbox
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><p>Now you should see your emulator booting &hellip;</p>
<h3 id="run-droidbox">Run DroidBox</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">!./droidbox.sh /root/work/apk/DroidBox_4.1.1/APK/FakeBanker.apk
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>[H[2J ____                        __  ____
/\  _`\               __    /\ \/\  _`\
\ \ \/\ \  _ __  ___ /\_\   \_\ \ \ \L\ \   ___   __  _
 \ \ \ \ \/\`'__\ __`\/\ \  /'_` \ \  _ &lt;' / __`\/\ \/'\
  \ \ \_\ \ \ \/\ \L\ \ \ \/\ \L\ \ \ \L\ \ \L\ \/&gt;  &lt;/
   \ \____/\ \_\ \____/\ \_\ \___,_\ \____/ \____//\_/\_\
    \/___/  \/_/\/___/  \/_/\/__,_ /\/___/ \/___/ \//\/_/
Waiting for the device...
Installing the application /root/work/apk/DroidBox_4.1.1/APK/FakeBanker.apk...
Running the component com.gmail.xpack/com.gmail.xpack.MainActivity...
Starting the activity com.gmail.xpack.MainActivity...
Application started
Analyzing the application during infinite time seconds...
^C
</code></pre>
<blockquote>
<p>DroidBox will then listen for activities until you kill it by ^C.</p>
</blockquote>
<p>Meanwhile I was interacting with the APP and saw that DroidBox was collecting the logs during the interacttions.
DroidBox will output its results as a JSON file. <strong>I&rsquo;ve uploaded the results to <a href="http://pastebin.com/7YSb3EMW">pastebin.com</a></strong>. Now let&rsquo;s have some fun and take a look at the results.</p>
<p>Before starting analyzing the output keep in mind that:</p>
<blockquote>
<p>[&hellip;] all data received/sent, read/written are shown in hexadecimal since the handled data can contain binary data.</p>
<p>(Source: <a href="https://github.com/floe/mobile-sandbox/blob/master/DroidBox_4.1.1/scripts/droidbox.py">https://github.com/floe/mobile-sandbox/blob/master/DroidBox_4.1.1/scripts/droidbox.py</a>)</p>
</blockquote>
<h2 id="results-analysis">Results analysis</h2>
<p>First let&rsquo;s download the data and let python parse it</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1"># &lt;!-- collapse=True --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">json</span>
</span></span><span class="line"><span class="cl"><span class="n">import</span> <span class="n">urllib</span>
</span></span><span class="line"><span class="cl"><span class="n">url</span> <span class="o">=</span> <span class="s2">&#34;http://pastebin.com/raw.php?i=7YSb3EMW&#34;</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Load data</span>
</span></span><span class="line"><span class="cl"><span class="n">jsonurl</span> <span class="o">=</span> <span class="n">urllib</span><span class="o">.</span><span class="n">urlopen</span><span class="p">(</span><span class="n">url</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">jsonurl</span><span class="o">.</span><span class="n">read</span><span class="p">())</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Show dictionary keys</span>
</span></span><span class="line"><span class="cl"><span class="n">result</span><span class="o">.</span><span class="n">keys</span><span class="p">()</span>
</span></span></code></pre></td></tr></table>
</div>
</div><pre><code>[u'apkName',
 u'enfperm',
 u'opennet',
 u'cryptousage',
 u'sendsms',
 u'servicestart',
 u'sendnet',
 u'closenet',
 u'accessedfiles',
 u'fdaccess',
 u'dataleaks',
 u'recvnet',
 u'dexclass',
 u'hashes',
 u'recvsaction',
 u'phonecalls']
</code></pre>
<p>So we have diffenrent categories of activities we can look at. After analyzing the JSON content I&rsquo;ve come to following most important activities.</p>
<h2 id="file-system-activities">File system activities</h2>
<p>Let&rsquo;s have a look at the file system access actions triggered by the application. Due to DroidBox limitations I couldn&rsquo;t have a look at the <strong>complete</strong> raw data.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># &lt;!-- collapse=True --&gt;
</span></span><span class="line"><span class="cl"># Convert timestamps to human readable time delta
</span></span><span class="line"><span class="cl">timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;fdaccess&#39;].keys()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create list of accessed files entries
</span></span><span class="line"><span class="cl">accessed_files = [i[1] for i in result[&#39;fdaccess&#39;].items()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create dataframe
</span></span><span class="line"><span class="cl">df_accessedfiles = pd.DataFrame(accessed_files, index=timestamps)
</span></span><span class="line"><span class="cl">df_accessedfiles.sort(inplace=True)
</span></span><span class="line"><span class="cl">df_accessedfiles.index.name=&#39;Timestamp&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Unhexlify data
</span></span><span class="line"><span class="cl">unhexed_data = [binascii.unhexlify(d) for d in df_accessedfiles[&#39;data&#39;]]
</span></span><span class="line"><span class="cl">df_accessedfiles[&#39;rawdata&#39;] = unhexed_data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">df2table(df_accessedfiles[[&#39;operation&#39;, &#39;path&#39;, &#39;rawdata&#39;]].reset_index())
</span></span><span class="line"><span class="cl">#ipy_table.apply_theme(&#39;basic&#39;)
</span></span><span class="line"><span class="cl">df_accessedfiles[[&#39;operation&#39;, &#39;path&#39;, &#39;rawdata&#39;]].reset_index()
</span></span></code></pre></td></tr></table>
</div>
</div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>operation</th>
      <th>path</th>
      <th>rawdata</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 0:00:03</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> 0:00:04</td>
      <td>  read</td>
      <td>                                   /proc/1184/cmdline</td>
      <td> com.gmail.xpack�������������������������������������������������������������p/FakeBanker.apk�ain...</td>
    </tr>
    <tr>
      <th>2 </th>
      <td> 0:00:04</td>
      <td>  read</td>
      <td>                                   /proc/1197/cmdline</td>
      <td> logcat�DroidBox:W�dalvikvm:W�ActivityManager:I������������������������������p/FakeBanker.apk�ain...</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> 0:00:08</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>4 </th>
      <td> 0:00:09</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>5 </th>
      <td> 0:00:10</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>6 </th>
      <td> 0:00:10</td>
      <td>  read</td>
      <td>                                   /proc/1205/cmdline</td>
      <td> com.gmail.xpack:remote������������������������������������������������������p/FakeBanker.apk�ain...</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> 0:00:36</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>8 </th>
      <td> 0:00:36</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> 0:01:05</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>10</th>
      <td> 0:15:06</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>11</th>
      <td> 0:15:06</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>12</th>
      <td> 0:15:24</td>
      <td>  read</td>
      <td>                                         /dev/urandom</td>
      <td>                                                                                E0��2qV���4!=�Nd��V</td>
    </tr>
    <tr>
      <th>13</th>
      <td> 0:15:27</td>
      <td>  read</td>
      <td>                                   /proc/1239/cmdline</td>
      <td> com.android.exchange��������������������������������������������������������p/FakeBanker.apk�ain...</td>
    </tr>
    <tr>
      <th>14</th>
      <td> 0:15:35</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>15</th>
      <td> 0:15:37</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>16</th>
      <td> 0:15:37</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>17</th>
      <td> 0:15:58</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>18</th>
      <td> 0:16:00</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>19</th>
      <td> 0:16:01</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>20</th>
      <td> 0:16:10</td>
      <td>  read</td>
      <td>                                      /proc/wakelocks</td>
      <td> name\tcount\texpire_count\twake_count\tactive_since\ttotal_time\tsleep_time\tmax_time\tlast_chan...</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="network-activities">Network activities</h2>
<h3 id="opened-connections-opennet">Opened connections (opennet)</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># &lt;!-- collapse=True --&gt;
</span></span><span class="line"><span class="cl"># Convert timestamps to human readable time delta
</span></span><span class="line"><span class="cl">timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;opennet&#39;].keys()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create list of accessed files entries
</span></span><span class="line"><span class="cl">open_net = [i[1] for i in result[&#39;opennet&#39;].items()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create dataframe
</span></span><span class="line"><span class="cl">df_opennet = pd.DataFrame(open_net, index=timestamps)
</span></span><span class="line"><span class="cl">df_opennet.sort(inplace=True)
</span></span><span class="line"><span class="cl">df_opennet.index.name=&#39;Timestamp&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#df2table(df_opennet)
</span></span><span class="line"><span class="cl">#ipy_table.apply_theme(&#39;basic&#39;)
</span></span><span class="line"><span class="cl">df_opennet.reset_index()
</span></span></code></pre></td></tr></table>
</div>
</div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>desthost</th>
      <th>destport</th>
      <th>fd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 0:00:08</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 17</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0:15:06</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 23</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0:15:36</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 28</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0:16:00</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 33</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="sent-data-sendnet">Sent data (sendnet)</h3>
<p>Here you can have a look at the sent data. Again: The POST/GET requests are not fully complete.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># &lt;!-- collapse=True --&gt;
</span></span><span class="line"><span class="cl"># Convert timestamps to human readable time delta
</span></span><span class="line"><span class="cl">timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;sendnet&#39;].keys()]
</span></span><span class="line"><span class="cl"># Create list of accessed files entries
</span></span><span class="line"><span class="cl">send_net = [i[1] for i in result[&#39;sendnet&#39;].items()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create dataframe
</span></span><span class="line"><span class="cl">df_sendnet = pd.DataFrame(send_net, index=timestamps)
</span></span><span class="line"><span class="cl">df_sendnet.sort(inplace=True)
</span></span><span class="line"><span class="cl">df_sendnet.index.name=&#39;Timestamp&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Unhexlify data
</span></span><span class="line"><span class="cl">unhexed_data = [binascii.unhexlify(d) for d in df_sendnet[&#39;data&#39;]]
</span></span><span class="line"><span class="cl">df_sendnet[&#39;rawdata&#39;] = unhexed_data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#df2table(df_sendnet[[&#39;desthost&#39;, &#39;destport&#39;, &#39;fd&#39;, &#39;operation&#39;, &#39;type&#39;, &#39;rawdata&#39;]])
</span></span><span class="line"><span class="cl">#ipy_table.apply_theme(&#39;basic&#39;)
</span></span><span class="line"><span class="cl">df_sendnet[[&#39;desthost&#39;, &#39;destport&#39;, &#39;fd&#39;, &#39;operation&#39;, &#39;type&#39;, &#39;rawdata&#39;]].reset_index()
</span></span></code></pre></td></tr></table>
</div>
</div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>desthost</th>
      <th>destport</th>
      <th>fd</th>
      <th>operation</th>
      <th>type</th>
      <th>rawdata</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 0:00:08</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 17</td>
      <td> send</td>
      <td> net write</td>
      <td> POST /images/1.php HTTP/1.1\r\nUser-agent: Mozilla/4.76 (Java; U;Linux armv7l 2.6.29-gc497e41; r...</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0:15:06</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 23</td>
      <td> send</td>
      <td> net write</td>
      <td> POST /images/1.php HTTP/1.1\r\nUser-agent: Mozilla/4.76 (Java; U;Linux armv7l 2.6.29-gc497e41; r...</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0:15:36</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 28</td>
      <td> send</td>
      <td> net write</td>
      <td> POST /images/1.php HTTP/1.1\r\nUser-agent: Mozilla/4.76 (Java; U;Linux armv7l 2.6.29-gc497e41; r...</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0:16:00</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 33</td>
      <td> send</td>
      <td> net write</td>
      <td> POST /images/1.php HTTP/1.1\r\nUser-agent: Mozilla/4.76 (Java; U;Linux armv7l 2.6.29-gc497e41; r...</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="received-data-recvnet">Received data (recvnet)</h3>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># &lt;!-- collapse=True --&gt;
</span></span><span class="line"><span class="cl"># Convert timestamps to human readable time delta
</span></span><span class="line"><span class="cl">timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;recvnet&#39;].keys()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create list of accessed files entries
</span></span><span class="line"><span class="cl">recv_net = [i[1] for i in result[&#39;recvnet&#39;].items()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create dataframe
</span></span><span class="line"><span class="cl">df_recvnet = pd.DataFrame(recv_net, index=timestamps)
</span></span><span class="line"><span class="cl">df_recvnet.sort(inplace=True)
</span></span><span class="line"><span class="cl">df_recvnet.index.name=&#39;Timestamp&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Unhexlify data
</span></span><span class="line"><span class="cl">unhexed_data = [binascii.unhexlify(d) for d in df_recvnet[&#39;data&#39;]]
</span></span><span class="line"><span class="cl">df_recvnet[&#39;rawdata&#39;] = unhexed_data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#df2table(df_recvnet[[&#39;host&#39;, &#39;port&#39;, &#39;type&#39;, &#39;rawdata&#39;]])
</span></span><span class="line"><span class="cl">#ipy_table.apply_theme(&#39;basic&#39;)
</span></span><span class="line"><span class="cl">df_recvnet[[&#39;host&#39;, &#39;port&#39;, &#39;type&#39;, &#39;rawdata&#39;]].reset_index()
</span></span></code></pre></td></tr></table>
</div>
</div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>host</th>
      <th>port</th>
      <th>type</th>
      <th>rawdata</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 0:00:08</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:29:38 GMT\r\nServer: Apache\r\nContent-...</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0:00:08</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> x=10\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\n&lt;!DOCTYPE H...</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0:15:06</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> x=10\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\n&lt;!DOCTYPE H...</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0:15:06</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:44:36 GMT\r\nServer: Apache\r\nContent-...</td>
    </tr>
    <tr>
      <th>4</th>
      <td> 0:15:36</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:45:06 GMT\r\nServer: Apache\r\nContent-...</td>
    </tr>
    <tr>
      <th>5</th>
      <td> 0:15:36</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> x=10\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\n&lt;!DOCTYPE H...</td>
    </tr>
    <tr>
      <th>6</th>
      <td> 0:16:00</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:45:30 GMT\r\nServer: Apache\r\nContent-...</td>
    </tr>
    <tr>
      <th>7</th>
      <td> 0:16:00</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> x=10\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\n&lt;!DOCTYPE H...</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="requests-sequence">Requests sequence</h2>
<p>Since I was not able to get the full contents of the POST/GET requests (and their equivalent responses), I had to rely on the information found <a href="http://www.apk-analyzer.net/analysis/646/3752/0/html">here</a>. Below is a short sequence diagramm describing the general process of the communication. Keep in mind that the sequence only tries to give you a short overview of the data exchange between the process and the webserver.</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">%%seqdiag
</span></span><span class="line"><span class="cl"># &lt;!-- collapse=True --&gt;
</span></span><span class="line"><span class="cl">seqdiag {
</span></span><span class="line"><span class="cl">  application  -&gt; citroen-club.ch [label = &#34;POST /images/1.php HTTP/1.1&#34;];
</span></span><span class="line"><span class="cl">  application &lt;-- citroen-club.ch [label = &#34;HTTP/1.1 406 Not Acceptable&#34;, leftnote= &#34;&#34;];
</span></span><span class="line"><span class="cl">  application --&gt; best-invest-int.com [label = &#34;POST /gallery/3.php HTTP/1.1&#34;, note = &#34;POST data=U2ltU3RhdGUgPSBOT1QgUkVBRFkgCg%3D%3D%0A&amp;rid=25&#34;];
</span></span><span class="line"><span class="cl">  application &lt;-- best-invest-int.com [label = &#34;HTTP/1.1 403 Forbidden&#34;];
</span></span><span class="line"><span class="cl">  application --&gt; best-invest-int.com [label = &#34;POST /gallery/4.php HTTP/1.1&#34;, note = &#34;POST data=U2ltU3RhdGUgPSBOT1QgUkVBRFkgCg%3D%3D%0A&amp;LogCode=CONF&amp;LogText=Get+config+data+from+server&#34;];
</span></span><span class="line"><span class="cl">  application &lt;-- best-invest-int.com [label = &#34;HTTP/1.1 403 Forbidden&#34;];
</span></span><span class="line"><span class="cl">  application --&gt; best-invest-int.com [label = &#34;POST /gallery/4.php HTTP/1.1&#34;, note = &#34;POST data=U2ltU3RhdGUgPSBOT1QgUkVBRFkgCg%3D%3D%0A&amp;LogCode=DATA&amp;LogText=Send+data+to+server&amp;&#34;];
</span></span><span class="line"><span class="cl">  application &lt;-- best-invest-int.com [label = &#34;...&#34;];
</span></span><span class="line"><span class="cl">}
</span></span></code></pre></td></tr></table>
</div>
</div><p><img src="https://blog.dornea.nu/posts/img/2014/android-dynamic-code-analysis-mastering-droidbox/output_44_0.png" alt="png"></p>
<p>And now a complete request/response pair:</p>
<p><strong>Request</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">POST /gallery/4.php HTTP/1.1
</span></span><span class="line"><span class="cl">User-agent: Mozilla/4.76 (Java; U;Linux i686 3.0.36-android-x86-eeepc+; ru; The Android Project 0)
</span></span><span class="line"><span class="cl">Content-Type: application/x-www-form-urlencoded; charset=UTF-8
</span></span><span class="line"><span class="cl">Pragma: no-cache
</span></span><span class="line"><span class="cl">Host: best-invest-int.com
</span></span><span class="line"><span class="cl">Connection: Keep-Alive
</span></span><span class="line"><span class="cl">Accept-Encoding: gzip
</span></span><span class="line"><span class="cl">Content-Length: 86
</span></span><span class="line"><span class="cl">Data Raw: 64 61 74 61 3d 55 32 6c 74 55 33 52 68 64 47 55 67 50 53 42 4f 54 31 51 67 55 6b 56 42 52 46 6b 67 43 67 25 33 44 25 33 44 25 30 41 26 4c 6f 67 43 6f 64 65 3d 43 4f 4e 46 26 4c 6f 67 54 65 78 74 3d 43 68 65 63 6b 2b 70 75 6c 6c 2b 6f 66 66 2b 75 72 6c 73 26 
</span></span><span class="line"><span class="cl">Data Ascii: data=U2ltU3RhdGUgPSBOT1QgUkVBRFkgCg%3D%3D%0A&amp;LogCode=CONF&amp;LogText=Check+pull+off+urls&amp;
</span></span></code></pre></td></tr></table>
</div>
</div><p><strong>Response</strong>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-zed" data-lang="zed"><span class="line"><span class="cl"><span class="nn">HTTP/</span><span class="err">1</span><span class="p">.</span><span class="err">1</span><span class="w"> </span><span class="err">403</span><span class="w"> </span><span class="n">Forbidden</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Date</span><span class="o">:</span><span class="w"> </span><span class="n">Thu</span><span class="p">,</span><span class="w"> </span><span class="err">21</span><span class="w"> </span><span class="n">Nov</span><span class="w"> </span><span class="err">2013</span><span class="w"> </span><span class="err">12</span><span class="o">:</span><span class="err">37</span><span class="o">:</span><span class="err">26</span><span class="w"> </span><span class="n">GMT</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Server</span><span class="o">:</span><span class="w"> </span><span class="nn">Apache/</span><span class="err">2</span><span class="p">.</span><span class="err">2</span><span class="p">.</span><span class="err">3</span><span class="w"> </span><span class="p">(</span><span class="n">CentOS</span><span class="p">)</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Content</span><span class="o">-</span><span class="n">Length</span><span class="o">:</span><span class="w"> </span><span class="err">299</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Connection</span><span class="o">:</span><span class="w"> </span><span class="n">close</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="n">Content</span><span class="o">-</span><span class="n">Type</span><span class="o">:</span><span class="w"> </span><span class="nn">text/</span><span class="n">html</span><span class="p">;</span><span class="w"> </span><span class="n">charset</span><span class="o">=</span><span class="n">iso</span><span class="o">-</span><span class="err">8859</span><span class="o">-</span><span class="err">1</span><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w">
</span></span></span><span class="line"><span class="cl"><span class="w"></span><span class="o">&lt;!</span><span class="n">DOCTYPE</span><span class="w"> </span><span class="n">HTML</span><span class="w"> </span><span class="n">PUBLIC</span><span class="w"> </span><span class="err">&#34;</span><span class="o">-</span><span class="c1">//IETF//DTD HTML 2.0//EN&#34;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Forbidden&lt;/h1&gt;&lt;p&gt;You don&#39;t have permission to access /gallery/4.phpon this server.&lt;/p&gt;&lt;hr&gt;&lt;address&gt;Apache/2.2.3 (CentOS) Server at best-invest-int.com Port 80&lt;/address&gt;&lt;/body&gt;&lt;/html&gt;
</span></span></span></code></pre></td></tr></table>
</div>
</div><h2 id="crypto-activities">Crypto activities</h2>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl"># &lt;!-- collapse=True --&gt;
</span></span><span class="line"><span class="cl"># Convert timestamps to human readable time delta
</span></span><span class="line"><span class="cl">timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;cryptousage&#39;].keys()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create list of accessed files entries
</span></span><span class="line"><span class="cl">crypto_usage = [i[1] for i in result[&#39;cryptousage&#39;].items()]
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Create dataframe
</span></span><span class="line"><span class="cl">df_cryptousage = pd.DataFrame(crypto_usage, index=timestamps)
</span></span><span class="line"><span class="cl">df_cryptousage.sort(inplace=True)
</span></span><span class="line"><span class="cl">df_cryptousage.index.name=&#39;Timestamp&#39;
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"># Unhexlify data
</span></span><span class="line"><span class="cl">#unhexed_data = [binascii.unhexlify(d) for d in df_recvnet[&#39;data&#39;]]
</span></span><span class="line"><span class="cl">#df_recvnet[&#39;rawdata&#39;] = unhexed_data
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">#df_recvnet[[&#39;host&#39;, &#39;port&#39;, &#39;type&#39;, &#39;rawdata&#39;]]
</span></span><span class="line"><span class="cl">df_cryptousage.reset_index()
</span></span></code></pre></td></tr></table>
</div>
</div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>algorithm</th>
      <th>key</th>
      <th>operation</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 0:00:09</td>
      <td> Blowfish</td>
      <td> 52, 101, 54, 54, 55, 54, 54, 101, 54, 98, 54, 97, 54, 99, 54, 101, 55, 54, 54, 98, 54, 97, 52, 9...</td>
      <td> keyalgo</td>
      <td> crypto</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0:15:06</td>
      <td> Blowfish</td>
      <td> 52, 101, 54, 54, 55, 54, 54, 101, 54, 98, 54, 97, 54, 99, 54, 101, 55, 54, 54, 98, 54, 97, 52, 9...</td>
      <td> keyalgo</td>
      <td> crypto</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0:15:36</td>
      <td> Blowfish</td>
      <td> 52, 101, 54, 54, 55, 54, 54, 101, 54, 98, 54, 97, 54, 99, 54, 101, 55, 54, 54, 98, 54, 97, 52, 9...</td>
      <td> keyalgo</td>
      <td> crypto</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0:16:00</td>
      <td> Blowfish</td>
      <td> 52, 101, 54, 54, 55, 54, 54, 101, 54, 98, 54, 97, 54, 99, 54, 101, 55, 54, 54, 98, 54, 97, 52, 9...</td>
      <td> keyalgo</td>
      <td> crypto</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="activities-chart">Activities chart</h2>
<p>Now let&rsquo;s have a look in which <em>order</em> the several activities took place. Below you&rsquo;ll find a table containing the timestamp, operation and category of each specific activity (e.g. file system access, network read/write etc.)</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="c1"># &lt;!-- collapse=True --&gt;</span>
</span></span><span class="line"><span class="cl"><span class="c1"># Create df</span>
</span></span><span class="line"><span class="cl"><span class="n">df_activities</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">DataFrame</span><span class="p">(</span><span class="n">columns</span><span class="o">=</span><span class="p">[[</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">]])</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># file system access</span>
</span></span><span class="line"><span class="cl"><span class="n">accessed_files</span> <span class="o">=</span> <span class="n">df_accessedfiles</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">3</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">accessed_files</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;file system&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">accessed_files</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># network activities</span>
</span></span><span class="line"><span class="cl"><span class="n">network_open</span> <span class="o">=</span> <span class="n">df_opennet</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="mi">0</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">network_open</span><span class="p">[</span><span class="s1">&#39;Operation&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;net open&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">network_open</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s1">&#39;network&#39;</span>
</span></span><span class="line"><span class="cl"><span class="n">network_open</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">network_sent</span> <span class="o">=</span> <span class="n">df_sendnet</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">6</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">network_sent</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;network&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">network_sent</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">network_recv</span> <span class="o">=</span> <span class="n">df_recvnet</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">4</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">network_recv</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;network&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">network_recv</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># crpyto usage</span>
</span></span><span class="line"><span class="cl"><span class="n">crypto_usage</span> <span class="o">=</span> <span class="n">df_cryptousage</span><span class="o">.</span><span class="n">reset_index</span><span class="p">()[[</span><span class="mi">0</span><span class="p">,</span><span class="mi">1</span><span class="p">]]</span>
</span></span><span class="line"><span class="cl"><span class="n">crypto_usage</span><span class="p">[</span><span class="s1">&#39;Category&#39;</span><span class="p">]</span> <span class="o">=</span> <span class="s2">&#34;crypto&#34;</span>
</span></span><span class="line"><span class="cl"><span class="n">crypto_usage</span><span class="o">.</span><span class="n">columns</span> <span class="o">=</span> <span class="p">[</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">,</span> <span class="s1">&#39;Operation&#39;</span><span class="p">,</span> <span class="s1">&#39;Category&#39;</span><span class="p">]</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Merge data frames</span>
</span></span><span class="line"><span class="cl"><span class="n">df_activities</span> <span class="o">=</span> <span class="n">pd</span><span class="o">.</span><span class="n">concat</span><span class="p">([</span><span class="n">accessed_files</span><span class="p">,</span> <span class="n">network_open</span><span class="p">,</span> <span class="n">network_sent</span><span class="p">,</span> <span class="n">network_recv</span><span class="p">,</span> <span class="n">crypto_usage</span><span class="p">],</span> <span class="n">ignore_index</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">df_activities</span><span class="o">.</span><span class="n">sort</span><span class="p">(</span><span class="s1">&#39;Timestamp&#39;</span><span class="p">,</span> <span class="n">inplace</span><span class="o">=</span><span class="n">True</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="c1"># Convert to JSON</span>
</span></span><span class="line"><span class="cl"><span class="n">d</span> <span class="o">=</span> <span class="n">df_activities</span><span class="o">.</span><span class="n">to_json</span><span class="p">(</span><span class="n">orient</span><span class="o">=</span><span class="s1">&#39;records&#39;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="n">json_data</span> <span class="o">=</span> <span class="n">json</span><span class="o">.</span><span class="n">dumps</span><span class="p">(</span><span class="n">json</span><span class="o">.</span><span class="n">loads</span><span class="p">(</span><span class="n">d</span><span class="p">),</span> <span class="n">ensure_ascii</span><span class="o">=</span><span class="n">False</span><span class="p">)</span><span class="o">.</span><span class="n">encode</span><span class="p">(</span><span class="s2">&#34;utf-8&#34;</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl"><span class="n">df_activities</span>
</span></span></code></pre></td></tr></table>
</div>
</div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>Operation</th>
      <th>Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 0:00:03</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> 0:00:04</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>2 </th>
      <td> 0:00:04</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> 0:00:08</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>21</th>
      <td> 0:00:08</td>
      <td>  net open</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>25</th>
      <td> 0:00:08</td>
      <td> net write</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>29</th>
      <td> 0:00:08</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>30</th>
      <td> 0:00:08</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>4 </th>
      <td> 0:00:09</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>37</th>
      <td> 0:00:09</td>
      <td>  Blowfish</td>
      <td>      crypto</td>
    </tr>
    <tr>
      <th>5 </th>
      <td> 0:00:10</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>6 </th>
      <td> 0:00:10</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> 0:00:36</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>8 </th>
      <td> 0:00:36</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> 0:01:05</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>10</th>
      <td> 0:15:06</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>11</th>
      <td> 0:15:06</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>22</th>
      <td> 0:15:06</td>
      <td>  net open</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>26</th>
      <td> 0:15:06</td>
      <td> net write</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>31</th>
      <td> 0:15:06</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>32</th>
      <td> 0:15:06</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>38</th>
      <td> 0:15:06</td>
      <td>  Blowfish</td>
      <td>      crypto</td>
    </tr>
    <tr>
      <th>12</th>
      <td> 0:15:24</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>13</th>
      <td> 0:15:27</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>14</th>
      <td> 0:15:35</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>23</th>
      <td> 0:15:36</td>
      <td>  net open</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>27</th>
      <td> 0:15:36</td>
      <td> net write</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>33</th>
      <td> 0:15:36</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>34</th>
      <td> 0:15:36</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>39</th>
      <td> 0:15:36</td>
      <td>  Blowfish</td>
      <td>      crypto</td>
    </tr>
    <tr>
      <th>15</th>
      <td> 0:15:37</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>16</th>
      <td> 0:15:37</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>17</th>
      <td> 0:15:58</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>18</th>
      <td> 0:16:00</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>24</th>
      <td> 0:16:00</td>
      <td>  net open</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>28</th>
      <td> 0:16:00</td>
      <td> net write</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>35</th>
      <td> 0:16:00</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>36</th>
      <td> 0:16:00</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>40</th>
      <td> 0:16:00</td>
      <td>  Blowfish</td>
      <td>      crypto</td>
    </tr>
    <tr>
      <th>19</th>
      <td> 0:16:01</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>20</th>
      <td> 0:16:10</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
  </tbody>
</table>
</div>
<p>A fancier overview &hellip;</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">%%</span><span class="n">jinja</span> <span class="n">html</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;!--</span> <span class="n">collapse</span><span class="o">=</span><span class="n">True</span> <span class="o">--&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">html</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;http://d3js.org/d3.v3.min.js&#34;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">script</span> <span class="n">src</span><span class="o">=</span><span class="s2">&#34;http://dimplejs.org/dist/dimple.v2.1.0.min.js&#34;</span><span class="o">&gt;&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">title</span><span class="o">&gt;</span><span class="p">{{</span> <span class="n">title</span> <span class="p">}}</span><span class="o">&lt;/</span><span class="n">title</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">head</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;</span><span class="n">div</span> <span class="n">id</span><span class="o">=</span><span class="s2">&#34;bar_chart&#34;</span><span class="o">&gt;&lt;/</span><span class="n">div</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;</span><span class="n">script</span> <span class="n">type</span><span class="o">=</span><span class="s2">&#34;text/javascript&#34;</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl">    <span class="k">var</span> <span class="n">json_data</span>  <span class="o">=</span> <span class="p">{{</span> <span class="n">json_data</span> <span class="p">}};</span>
</span></span><span class="line"><span class="cl">    <span class="k">var</span> <span class="n">svg</span> <span class="o">=</span> <span class="n">dimple</span><span class="o">.</span><span class="n">newSvg</span><span class="p">(</span><span class="s2">&#34;#bar_chart&#34;</span><span class="p">,</span> <span class="mi">800</span><span class="p">,</span> <span class="mi">800</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="k">var</span> <span class="n">myChart</span> <span class="o">=</span> <span class="n">new</span> <span class="n">dimple</span><span class="o">.</span><span class="n">chart</span><span class="p">(</span><span class="n">svg</span><span class="p">,</span> <span class="n">json_data</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">myChart</span><span class="o">.</span><span class="n">setBounds</span><span class="p">(</span><span class="mi">150</span><span class="p">,</span> <span class="mi">50</span><span class="p">,</span> <span class="mi">700</span><span class="p">,</span> <span class="mi">680</span><span class="p">)</span>
</span></span><span class="line"><span class="cl">    <span class="n">myChart</span><span class="o">.</span><span class="n">addCategoryAxis</span><span class="p">(</span><span class="s2">&#34;x&#34;</span><span class="p">,</span> <span class="p">[</span><span class="s2">&#34;Category&#34;</span><span class="p">,</span> <span class="s2">&#34;Operation&#34;</span><span class="p">]);</span>
</span></span><span class="line"><span class="cl">    <span class="n">myChart</span><span class="o">.</span><span class="n">addCategoryAxis</span><span class="p">(</span><span class="s2">&#34;y&#34;</span><span class="p">,</span> <span class="s2">&#34;Timestamp&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">myChart</span><span class="o">.</span><span class="n">addSeries</span><span class="p">(</span><span class="s2">&#34;Operation&#34;</span><span class="p">,</span> <span class="n">dimple</span><span class="o">.</span><span class="n">plot</span><span class="o">.</span><span class="n">bar</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">myChart</span><span class="o">.</span><span class="n">addLegend</span><span class="p">(</span><span class="mi">170</span><span class="p">,</span> <span class="mi">10</span><span class="p">,</span> <span class="mi">630</span><span class="p">,</span> <span class="mi">20</span><span class="p">,</span> <span class="s2">&#34;right&#34;</span><span class="p">);</span>
</span></span><span class="line"><span class="cl">    <span class="n">myChart</span><span class="o">.</span><span class="n">draw</span><span class="p">();</span>
</span></span><span class="line"><span class="cl">  <span class="o">&lt;/</span><span class="n">script</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">body</span><span class="o">&gt;</span>
</span></span><span class="line"><span class="cl"><span class="o">&lt;/</span><span class="n">html</span><span class="o">&gt;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><!-- collapse=True -->
<html>
<head>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://dimplejs.org/dist/dimple.v2.1.0.min.js"></script>
<title></title>
</head>
<body>
<div id="bar_chart"></div>
  <script type="text/javascript">
    var json_data  = [{"Category": "file system", "Timestamp": "0:00:03", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:00:04", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:00:04", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:00:08", "Operation": "read"}, {"Category": "network", "Timestamp": "0:00:08", "Operation": "net open"}, {"Category": "network", "Timestamp": "0:00:08", "Operation": "net write"}, {"Category": "network", "Timestamp": "0:00:08", "Operation": "net read"}, {"Category": "network", "Timestamp": "0:00:08", "Operation": "net read"}, {"Category": "file system", "Timestamp": "0:00:09", "Operation": "write"}, {"Category": "crypto", "Timestamp": "0:00:09", "Operation": "Blowfish"}, {"Category": "file system", "Timestamp": "0:00:10", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:00:10", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:00:36", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:00:36", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:01:05", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:15:06", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:15:06", "Operation": "write"}, {"Category": "network", "Timestamp": "0:15:06", "Operation": "net open"}, {"Category": "network", "Timestamp": "0:15:06", "Operation": "net write"}, {"Category": "network", "Timestamp": "0:15:06", "Operation": "net read"}, {"Category": "network", "Timestamp": "0:15:06", "Operation": "net read"}, {"Category": "crypto", "Timestamp": "0:15:06", "Operation": "Blowfish"}, {"Category": "file system", "Timestamp": "0:15:24", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:15:27", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:15:35", "Operation": "read"}, {"Category": "network", "Timestamp": "0:15:36", "Operation": "net open"}, {"Category": "network", "Timestamp": "0:15:36", "Operation": "net write"}, {"Category": "network", "Timestamp": "0:15:36", "Operation": "net read"}, {"Category": "network", "Timestamp": "0:15:36", "Operation": "net read"}, {"Category": "crypto", "Timestamp": "0:15:36", "Operation": "Blowfish"}, {"Category": "file system", "Timestamp": "0:15:37", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:15:37", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:15:58", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:16:00", "Operation": "write"}, {"Category": "network", "Timestamp": "0:16:00", "Operation": "net open"}, {"Category": "network", "Timestamp": "0:16:00", "Operation": "net write"}, {"Category": "network", "Timestamp": "0:16:00", "Operation": "net read"}, {"Category": "network", "Timestamp": "0:16:00", "Operation": "net read"}, {"Category": "crypto", "Timestamp": "0:16:00", "Operation": "Blowfish"}, {"Category": "file system", "Timestamp": "0:16:01", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:16:10", "Operation": "read"}];
    var svg = dimple.newSvg("#bar_chart", 800, 800);
    var myChart = new dimple.chart(svg, json_data);
    myChart.setBounds(150, 50, 700, 680)
    myChart.addCategoryAxis("x", ["Category", "Operation"]);
    myChart.addCategoryAxis("y", "Timestamp");
    myChart.addSeries("Operation", dimple.plot.bar);
    myChart.addLegend(170, 10, 630, 20, "right");
    myChart.draw();
  </script>
</body>
</html>
<p>A few <strong>observations</strong>:</p>
<ul>
<li>file system access (both read and write) are taking place all the time</li>
<li>the crypto routines are apparently involved when sending data over internet or receiving data</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>I think <code>DroidBox</code> is a very good tool to deal with Android APKs and analyze their behaviour during run-time. It comes with a working mobile sandbox meant to inspect and monitor an applications activities. However during my analysis I had to rely on previous analysis since the results didn&rsquo;t contain the full details. Not only the network traffic but also the contents read from files weren&rsquo;t complete. In order to fully unterstand one malware I need complete details about its behaviour.  For example I had following response from the server which is completely useless:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:29:38 GMT\r\nServer: Apache\r\nContent-...
</span></span></code></pre></td></tr></table>
</div>
</div><p>Besides that I was indeed able to see that the application is reading from some file. But the delivered content was once again striped:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39; standalone=&#39;yes&#39; ?&gt;\n&lt;map&gt;\n&lt;string name=&#34;DOWNLOADDOMAIN&#34;&gt;c...
</span></span></code></pre></td></tr></table>
</div>
</div><p>I hope the developers will see this as a vital necessity and update as soon as possible. Furthermore I&rsquo;ll look forward to other mobile sandboxes which have data instrumentation capabilities. Next time I&rsquo;ll have a deeper look at Androids <a href="http://developer.android.com/tools/debugging/ddms.html">DDMS</a>.</p>

    

  </div>
  <div id="comments">
      

  </div>
</main>
 






<div class="tl fixed list-pages lh-copy" id="contents-list"></div>



<div class="pagination tc tr-l db fixed-l bottom-2-l right-2-l mb3 mb0-l">
  
<a id="scroll-to-top" class="f6 o-0 link br2 ph2 pv1 mb1 bg-main-color pointer" onclick="topFunction()" style="color: #fff; visibility: hidden; display: none; transition: opacity .5s, visibility .5s;" title="back to top">back to top</a>
<br>
  <p class="mb0 mt2">
  <a href="https://blog.dornea.nu/2014/07/07/disect-android-apks-like-a-pro-static-code-analysis/">prev</a>
  <a href="https://blog.dornea.nu/2014/08/06/web-application-survey-tutorial/">next</a>
  </p>
</div>

  <footer class="content-width mt0 mt5-l mb4 f6 center ph3 gray tc tl-l">
  <hr class="dn db-l ml0-l gray w3"><br>
  Powered by <a href="https://gohugo.io/" target="_blank" class="link gray dim">Hugo</a>, based on the <a href="https://github.com/lingxz/er" target="_blank" class="link gray dim">Er</a> theme.
  
  <a href="https://blog.dornea.nu/feed.xml" target="_blank" title="rss"><svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="feather feather-rss"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg></a>
</footer>

  



<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<style>.is-active-link::before { background-color: var(--secondary-color); }</style>




<script type="text/javascript">
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
  var currentScrollPos = window.pageYOffset;

  
  if (document.getElementById("tag-cloud") !== null) { 
    if (prevScrollpos > currentScrollPos) { 
      document.getElementById("tag-cloud").style.visibility = "visible";
      document.getElementById("tag-cloud").style.opacity = "1";
    } else {
      document.getElementById("tag-cloud").style.visibility = "hidden";
      document.getElementById("tag-cloud").style.opacity = "0";
    }
  }
  

  
  if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
      document.getElementById("scroll-to-top").style.display = "inline";
      document.getElementById("scroll-to-top").style.visibility = "visible";
      document.getElementById("scroll-to-top").style.opacity = "1";
  } else {
      document.getElementById("scroll-to-top").style.visibility = "hidden";
      document.getElementById("scroll-to-top").style.opacity = "0";
  }
  
  prevScrollpos = currentScrollPos;
}


function topFunction() {
  document.body.scrollTop = 0; 
  document.documentElement.scrollTop = 0; 
}






if (document.getElementById("contents-list") !== null && document.getElementsByClassName("post-content").length !== 0) { 
  tocbot.init({
    
    tocSelector: '#contents-list',
    
    contentSelector: '.post-content',
    
    headingSelector: 'h1, h2, h3',
  });
}


</script>





<script>
 var glightbox = GLightbox({
     selector: '.glightbox'
 });
</script>

  
</body>
</html>
