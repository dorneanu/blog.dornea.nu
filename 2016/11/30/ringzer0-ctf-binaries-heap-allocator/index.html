<!doctype html>
<html lang="en">
<head><meta charset="utf-8">
<meta name="viewport" content="width=device-width, initial-scale=1" />
<meta content='text/html; charset=utf-8' http-equiv='content-type' />

<meta name="generator" content="Hugo 0.120.3">

<link href="https://fonts.googleapis.com/css?family=Source+Sans+Pro:400,600" rel="stylesheet">
<link href="https://use.fontawesome.com/releases/v5.7.1/css/all.css" rel="stylesheet"/>
<style type="text/css">/*https://coolors.co/afd5aa-f0f2ef-a69f98-3d3d3d-8c6057*/
:root {
  --main-color: #8C6056; 
  --secondary-color: #AFD5AA;
  --logo-text-color: #fff;
  --body-text-color: #3d3d3d;
  --heading-text-color: #383838;
  --background-color: #fff;
}</style>
<link href='https://blog.dornea.nu/css/tachyons.min.css' rel="stylesheet">
<link href='https://blog.dornea.nu/css/styles.css' rel="stylesheet">
<link rel="stylesheet" href="https://blog.dornea.nu/css/custom.css">
<link rel="stylesheet" href="https://blog.dornea.nu/css/syntax.css">



<link rel="stylesheet" href="https://cdn.jsdelivr.net/npm/glightbox/dist/css/glightbox.min.css" />
<script src="https://cdn.jsdelivr.net/gh/mcstudios/glightbox/dist/js/glightbox.min.js"></script>


<link rel="icon" 
 
  href='https://blog.dornea.nu/favicon.ico'

type="image/x-icon"/>

<link href='https://blog.dornea.nu/feed.xml' rel="alternate" type="application/atom+xml" title="blog.dornea.nu" />



<script src="https://beamanalytics.b-cdn.net/beam.min.js" data-token="b8a4b728-8eda-42fb-8376-10168c622160" async>

</script>

</head>
<body class="global-font">
  <nav class="fixed w-100 bg-white bb b--black-10" id="navbar" style="z-index: 9999;">
  <div class="content-width center flex flex-wrap justify-between items-center pa3">
    
    <div class="flex items-center">
      <a class="f4 fw6 ttu no-underline dim bg-main-color pv1 ph3 br2 white" id="site-title" href='https://blog.dornea.nu/' title="Home">blog.dornea.nu</a>
    </div>

    
    <div class="dn flex-l items-center">
      
        
          <a class="link dim dark-gray f6 dib ml4 ttu tracked fw5" href='https://blog.dornea.nu/' title="Home">Home</a>
        
          <a class="link dim dark-gray f6 dib ml4 ttu tracked fw5" href='http://dornea.nu' title="About">About</a>
        
          <a class="link dim dark-gray f6 dib ml4 ttu tracked fw5" href='https://blog.dornea.nu/feed.xml' title="RSS">RSS</a>
        
          <a class="link dim dark-gray f6 dib ml4 ttu tracked fw5" href='https://blog.dornea.nu/tags' title="Tags">Tags</a>
        
          <a class="link dim dark-gray f6 dib ml4 ttu tracked fw5" href='https://brainfck.org' title="Zettelkasten">Zettelkasten</a>
        
      
    </div>

    
    <div class="db dn-l">
      <button class="bg-transparent bn pointer dim" id="menu-toggle">
        <svg xmlns="http://www.w3.org/2000/svg" width="24" height="24" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
          <line x1="3" y1="12" x2="21" y2="12"></line>
          <line x1="3" y1="6" x2="21" y2="6"></line>
          <line x1="3" y1="18" x2="21" y2="18"></line>
        </svg>
      </button>
    </div>
  </div>

  
  <div class="dn bg-white w-100 pa3 shadow-1" id="mobile-menu">
    
      
        <a class="link dim dark-gray f6 db pv2 ttu tracked fw5" href='https://blog.dornea.nu/' title="Home">Home</a>
      
        <a class="link dim dark-gray f6 db pv2 ttu tracked fw5" href='http://dornea.nu' title="About">About</a>
      
        <a class="link dim dark-gray f6 db pv2 ttu tracked fw5" href='https://blog.dornea.nu/feed.xml' title="RSS">RSS</a>
      
        <a class="link dim dark-gray f6 db pv2 ttu tracked fw5" href='https://blog.dornea.nu/tags' title="Tags">Tags</a>
      
        <a class="link dim dark-gray f6 db pv2 ttu tracked fw5" href='https://brainfck.org' title="Zettelkasten">Zettelkasten</a>
      
    
  </div>
</nav>


<div class="h3"></div>

<script>
  document.addEventListener('DOMContentLoaded', function() {
    const menuToggle = document.getElementById('menu-toggle');
    const mobileMenu = document.getElementById('mobile-menu');
    
    menuToggle.addEventListener('click', function() {
      const expanded = mobileMenu.classList.contains('db');
      mobileMenu.classList.toggle('db');
      mobileMenu.classList.toggle('dn');
    });
  });
</script>

  
<main class="center mv4 content-width ph3">
  <div class="f3 fw6 heading-color heading-font post-title">ringzer0 CTF - Binaries - Heap Allocator</div>
  <p class="silver f6 mt1 mb4 post-meta">
    <time>30 Nov 2016</time> 
     | 
    

    
     ~
  

15 mins
|

    
    tags: [ <a href='https://blog.dornea.nu/tags/ringzer0' class="link silver">ringzer0</a> <a href='https://blog.dornea.nu/tags/ctf' class="link silver">ctf</a> <a href='https://blog.dornea.nu/tags/wargames' class="link silver">wargames</a> <a href='https://blog.dornea.nu/tags/asm' class="link silver">asm</a> <a href='https://blog.dornea.nu/tags/x86' class="link silver">x86</a> <a href='https://blog.dornea.nu/tags/sploitfun' class="link silver">sploitfun</a>  ]
    

  </p>
  <div class="lh-copy post-content">
    

      <p>First let&rsquo;s collect some information about the binary itself:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ readelf IntelligenSoftware -h
</span></span><span class="line"><span class="cl">ELF Header:
</span></span><span class="line"><span class="cl">  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
</span></span><span class="line"><span class="cl">  Class:                             ELF64
</span></span><span class="line"><span class="cl">  Data:                              2&#39;s complement, little endian
</span></span><span class="line"><span class="cl">  Version:                           1 (current)
</span></span><span class="line"><span class="cl">  OS/ABI:                            UNIX - System V
</span></span><span class="line"><span class="cl">  ABI Version:                       0
</span></span><span class="line"><span class="cl">  Type:                              EXEC (Executable file)
</span></span><span class="line"><span class="cl">  Machine:                           Advanced Micro Devices X86-64
</span></span><span class="line"><span class="cl">  Version:                           0x1
</span></span><span class="line"><span class="cl">  Entry point address:               0x400688
</span></span><span class="line"><span class="cl">  Start of program headers:          64 (bytes into file)
</span></span><span class="line"><span class="cl">  Start of section headers:          4608 (bytes into file)
</span></span><span class="line"><span class="cl">  Flags:                             0x0
</span></span><span class="line"><span class="cl">  Size of this header:               64 (bytes)
</span></span><span class="line"><span class="cl">  Size of program headers:           56 (bytes)
</span></span><span class="line"><span class="cl">  Number of program headers:         9
</span></span><span class="line"><span class="cl">  Size of section headers:           64 (bytes)
</span></span><span class="line"><span class="cl">  Number of section headers:         30
</span></span><span class="line"><span class="cl">  Section header string table index: 27
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s see some code:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ objdump -d IntelligentSoftware -j .text 
</span></span><span class="line"><span class="cl">...
</span></span><span class="line"><span class="cl">0000000000400660 &lt;main&gt;:
</span></span><span class="line"><span class="cl">  400660:       48 83 ec 08             sub    $0x8,%rsp
</span></span><span class="line"><span class="cl">  400664:       ba a0 10 60 00          mov    $0x6010a0,%edx
</span></span><span class="line"><span class="cl">  400669:       be 87 08 40 00          mov    $0x400887,%esi
</span></span><span class="line"><span class="cl">  40066e:       bf 01 00 00 00          mov    $0x1,%edi
</span></span><span class="line"><span class="cl">  400673:       31 c0                   xor    %eax,%eax
</span></span><span class="line"><span class="cl">  400675:       e8 26 ff ff ff          callq  4005a0 &lt;__printf_chk@plt&gt;
</span></span><span class="line"><span class="cl">  40067a:       31 c0                   xor    %eax,%eax
</span></span><span class="line"><span class="cl">  40067c:       e8 ff 00 00 00          callq  400780 &lt;get_flag&gt;
</span></span><span class="line"><span class="cl">  400681:       31 c0                   xor    %eax,%eax
</span></span><span class="line"><span class="cl">  400683:       48 83 c4 08             add    $0x8,%rsp
</span></span><span class="line"><span class="cl">  400687:       c3                      retq
</span></span></code></pre></td></tr></table>
</div>
</div><p>Nothing interesting here. But there is a <code>call</code> to <code>get_flag</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">0000000000400780 &lt;get_flag&gt;:
</span></span><span class="line"><span class="cl">  400780:       53                      push   %rbx
</span></span><span class="line"><span class="cl">  400781:       bf 00 04 00 00          mov    $0x400,%edi
</span></span><span class="line"><span class="cl">  400786:       e8 05 fe ff ff          callq  400590 &lt;malloc@plt&gt;
</span></span><span class="line"><span class="cl">  40078b:       be 54 08 40 00          mov    $0x400854,%esi
</span></span><span class="line"><span class="cl">  400790:       48 89 c3                mov    %rax,%rbx
</span></span><span class="line"><span class="cl">  400793:       48 89 c2                mov    %rax,%rdx
</span></span><span class="line"><span class="cl">  400651:       eb d0                   jmp    400623 &lt;__libc_csu_ctor+0x73&gt;
</span></span><span class="line"><span class="cl">  400653:       66 a5                   movsw  %ds:(%rsi),%es:(%rdi)
</span></span><span class="line"><span class="cl">  400655:       83 e8 02                sub    $0x2,%eax
</span></span><span class="line"><span class="cl">  400658:       eb cf                   jmp    400629 &lt;__libc_csu_ctor+0x79&gt;
</span></span><span class="line"><span class="cl">  40065a:       e8 01 ff ff ff          callq  400560 &lt;__stack_chk_fail@plt&gt;
</span></span><span class="line"><span class="cl">  40065f:       90                      nop
</span></span></code></pre></td></tr></table>
</div>
</div><p>And there is some <code>jmp</code> to a <strong>libc constructor</strong> (`__libc_csu_ctor&rsquo;).</p>
<h3 id="libc-constructors--destructors">Libc constructors / destructors</h3>
<p>If you don&rsquo;t have a clue what <strong>libc</strong> constructors/destructors are, make sure
you have a look at:</p>
<ul>
<li><a href="http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html">Linux x86 Program Start Up</a></li>
<li><a href="http://bottomupcs.sourceforge.net/csbu/x3564.htm">Starting a process</a></li>
<li><a href="http://eli.thegreenplace.net/2012/08/13/how-statically-linked-programs-run-on-linux">How statically linked programs run on Linux</a></li>
<li><a href="http://nairobi-embedded.org/070_elf_c_runtime.html">C Run-time for ELF Executables</a></li>
</ul>
<h3 id="dynamic-analysis">Dynamic analysis</h3>
<p>Again using <code>radare</code> I&rsquo;ll disassemble <code>get_flag</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[0x00400688]&gt; pdf @ sym.get_flag
</span></span><span class="line"><span class="cl">/ (fcn) sym.get_flag 73
</span></span><span class="line"><span class="cl">|   sym.get_flag ();
</span></span><span class="line"><span class="cl">|       |   ; CALL XREF from 0x0040067c (sym.main)
</span></span><span class="line"><span class="cl">|       |   0x00400780      53             push rbx
</span></span><span class="line"><span class="cl">|       |   0x00400781      bf00040000     mov edi, 0x400
</span></span><span class="line"><span class="cl">|       |   0x00400786      e805feffff     call sym.imp.malloc        ;  void *malloc(size_t size);
</span></span><span class="line"><span class="cl">|       |   0x0040078b      be54084000     mov esi, str.Allocating_1024_bytes__p..._n ; &#34;Allocating 1024 bytes %p....&#34; @ 0x400854
</span></span><span class="line"><span class="cl">|       |   0x00400790      4889c3         mov rbx, rax
</span></span><span class="line"><span class="cl">|       |   0x00400793      4889c2         mov rdx, rax
</span></span><span class="line"><span class="cl">|       |   0x00400796      bf01000000     mov edi, 1
</span></span><span class="line"><span class="cl">|       |   0x0040079b      31c0           xor eax, eax
</span></span><span class="line"><span class="cl">|       |   0x0040079d      e8fefdffff     call sym.imp.__printf_chk
</span></span><span class="line"><span class="cl">|       |   0x004007a2      4889df         mov rdi, rbx
</span></span><span class="line"><span class="cl">|       |   0x004007a5      e896fdffff     call sym.imp.free          ; void free(void *ptr);
</span></span><span class="line"><span class="cl">|       |   0x004007aa      4889da         mov rdx, rbx
</span></span><span class="line"><span class="cl">|       |   0x004007ad      bf01000000     mov edi, 1
</span></span><span class="line"><span class="cl">|       |   0x004007b2      be71084000     mov esi, str.Freeing_buffer__p..._n ; &#34;Freeing buffer %p....&#34; @ 0x400871
</span></span><span class="line"><span class="cl">|       |   0x004007b7      31c0           xor eax, eax
</span></span><span class="line"><span class="cl">|       |   0x004007b9      e8e2fdffff     call sym.imp.__printf_chk
</span></span><span class="line"><span class="cl">|       |   0x004007be      5b             pop rbx
</span></span><span class="line"><span class="cl">|       |   0x004007bf      bf90084000     mov edi, str.Heap_is_working_perfectly__No_Flag_then ; &#34;Heap is working perfectly! No Flag then&#34; @ 0x400890
</span></span><span class="line"><span class="cl">\       `=&lt; 0x004007c4      e987fdffff     jmp sym.imp.puts
</span></span></code></pre></td></tr></table>
</div>
</div><p>Nothing suspicious about it: <code>malloc</code> is being called and then <code>free</code>. Now let&rsquo;s have a look at the constructors, which are usually
called before <code>main</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="p">[</span><span class="mh">0x00400688</span><span class="p">]</span><span class="o">&gt;</span> <span class="n">pdf</span> <span class="err">@</span> <span class="n">entry0</span>
</span></span><span class="line"><span class="cl">            <span class="p">;</span><span class="o">--</span> <span class="n">_start</span><span class="p">:</span>
</span></span><span class="line"><span class="cl"><span class="o">/</span> <span class="p">(</span><span class="n">fcn</span><span class="p">)</span> <span class="n">entry0</span> <span class="mi">41</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="n">entry0</span> <span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="n">UNKNOWN</span> <span class="n">XREF</span> <span class="n">from</span> <span class="mh">0x00400018</span> <span class="p">(</span><span class="n">unk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x00400688</span>      <span class="mi">31</span><span class="n">ed</span>           <span class="n">xor</span> <span class="n">ebp</span><span class="p">,</span> <span class="n">ebp</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x0040068a</span>      <span class="mi">4989</span><span class="n">d1</span>         <span class="n">mov</span> <span class="n">r9</span><span class="p">,</span> <span class="n">rdx</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x0040068d</span>      <span class="mi">5</span><span class="n">e</span>             <span class="n">pop</span> <span class="n">rsi</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x0040068e</span>      <span class="mf">4889e2</span>         <span class="n">mov</span> <span class="n">rdx</span><span class="p">,</span> <span class="n">rsp</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x00400691</span>      <span class="mf">4883e4</span><span class="n">f0</span>       <span class="ow">and</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0xfffffffffffffff0</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x00400695</span>      <span class="mi">50</span>             <span class="n">push</span> <span class="n">rax</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x00400696</span>      <span class="mi">54</span>             <span class="n">push</span> <span class="n">rsp</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x00400697</span>      <span class="mi">49</span><span class="n">c7c0400840</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">r8</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_fini</span> <span class="p">;</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_fini</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x0040069e</span>      <span class="mi">48</span><span class="n">c7c1d00740</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">rcx</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_init</span> <span class="p">;</span> <span class="s2">&#34;AWA..AVI..AUI..ATL.% . &#34;</span> <span class="err">@</span> <span class="mh">0x4007d0</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004006a5</span>      <span class="mi">48</span><span class="n">c7c7600640</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">main</span>           <span class="p">;</span> <span class="s2">&#34;H......`&#34;</span> <span class="err">@</span> <span class="mh">0x400660</span>
</span></span><span class="line"><span class="cl">\           <span class="mh">0x004006ac</span>      <span class="n">e8bffeffff</span>     <span class="n">call</span> <span class="n">sym</span><span class="o">.</span><span class="n">imp</span><span class="o">.</span><span class="n">__libc_start_main</span><span class="p">;</span> <span class="ne">int</span> <span class="n">__libc_start_main</span><span class="p">(</span><span class="k">func</span> <span class="n">main</span><span class="p">,</span> <span class="ne">int</span> <span class="n">argc</span><span class="p">,</span> <span class="n">char</span> <span class="o">**</span><span class="n">ubp_av</span><span class="p">,</span> <span class="k">func</span> <span class="n">init</span><span class="p">,</span> <span class="k">func</span> <span class="n">fini</span><span class="p">,</span> <span class="k">func</span> <span class="n">rtld_fini</span><span class="p">,</span> <span class="n">void</span> <span class="o">*</span><span class="n">stack_end</span><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Ahh, there we go. From the links mentioned before we know that <code>__libc_start_main</code> has following syntax:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-.c" data-lang=".c"><span class="line"><span class="cl"><span class="kt">int</span> <span class="nf">__libc_start_main</span><span class="p">(</span> 
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="p">(</span><span class="o">*</span><span class="n">main</span><span class="p">)</span> <span class="p">(</span><span class="kt">int</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">*</span><span class="p">,</span> <span class="kt">char</span> <span class="o">*</span> <span class="o">*</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">	<span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">	<span class="kt">char</span> <span class="o">*</span> <span class="o">*</span> <span class="n">ubp_av</span><span class="p">,</span> 
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">init</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">fini</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span><span class="n">rtld_fini</span><span class="p">)</span> <span class="p">(</span><span class="kt">void</span><span class="p">),</span> 
</span></span><span class="line"><span class="cl">	<span class="kt">void</span> <span class="p">(</span><span class="o">*</span> <span class="n">stack_end</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="p">);</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>So before calling <code>main</code> its arguments are copied to the corresponding registers. Since we&rsquo;re dealing with <code>x86-64</code>
the <strong>ABI</strong> requires that registers are used instead of the stack. On Linux we have the <a href="https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI">System V AMD64 ABI</a> calling convention which uses following registers for the parameters:</p>
<ul>
<li>RDI</li>
<li>RSI</li>
<li>RDX</li>
<li>RCX</li>
<li>R8</li>
<li>R9</li>
</ul>
<p>Additional arguments can be passed on the stack. In our case we have:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>digraph G {
    // Define layout
    graph [pad=&quot;.75&quot;, ranksep=&quot;0.95&quot;, nodesep=&quot;0.05&quot;];
    rankdir=LR;
    node [shape=&quot;record&quot;];
    rank=same;
 
    // Define pointers
    rsp [
        label=&quot;&lt;p&gt; $rdi \l&quot;, height=&quot;0.1&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
    ];
    
    // rbp [
    // 	label=&quot;&lt;p&gt; $rbp \l&quot;, height=&quot;0.1&quot;,
    // 	color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
    // ];
 
    rsp_4 [
        label=&quot;&lt;p&gt; $rsi \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
    ];
 
 
    rsp_8 [
        label=&quot;&lt;p&gt; $rdx \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
    ];
 
    rsp_12 [
        label=&quot;&lt;p&gt; $rcx \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
    ];
    
    rsp_16 [
        label=&quot;&lt;p&gt; $r8 \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
    ];
    
    rsp_20 [
        label=&quot;&lt;p&gt; $r9 \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
    ];
 
    // Define stack
    stack [
        width=&quot;3&quot;,
        label=&quot;&lt;p&gt;\nArguments\n\n | &lt;bp&gt;\n...\n\n | &lt;20&gt;0x7ffff7de9900 (_dl_fini) \l| &lt;16&gt;0x00400840 (sym.__libc_csu_fini) \l| &lt;12&gt;0x4007d0 (sym.__libc_csu_init)  \l | &lt;8&gt;(char **ubp_av = $rsp) \l | &lt;4&gt;(int argc = pop)  \l | &lt;0&gt;0x400660 (sym.main) \l&quot;
    ];
   
   
    // Pointer -&gt; Stack edges
    //rbp:p -&gt; stack:bp [style=invis];
    rsp:p -&gt; stack:0 [style=invis];
    rsp_4:p -&gt; stack:4 [style=invis];
    rsp_8:p -&gt; stack:8 [style=invis];
    rsp_12:p -&gt; stack:12 [style=invis];
    rsp_16:p -&gt; stack:16 [style=invis];
    rsp_20:p -&gt; stack:20 [style=invis];
}
</code></pre>

</details>

<p><img src="https://blog.dornea.nu/posts/img/2016/r0-binaries-heap-allocator/stack.dot.png" alt=""></p>
<p>As stated <a href="http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html">here</a> <code>__libc_start_main</code> does
the following:</p>
<ul>
<li>Takes care of some security problems with setuid setgid programs</li>
<li>Starts up threading</li>
<li>Registers the fini (our program), and rtld_fini (run-time loader) arguments to get run by at_exit to run the program&rsquo;s and the loader&rsquo;s cleanup routines</li>
<li>Calls the init argument</li>
<li>Calls the main with the argc and argv arguments passed to it and with the global __environ argument as detailed above.</li>
<li>Calls exit with the return value of main</li>
</ul>
<p>The <code>init</code> argument is set to <code>__libc_csu_init</code>. In the <strong>glibc</strong> source tree you will find <code>csu/elf-init.c</code> which contains <code>__libc_csu_init</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-.c" data-lang=".c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">__libc_csu_init</span> <span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span> <span class="p">{</span>
</span></span><span class="line"><span class="cl">	 <span class="nf">_init</span> <span class="p">();</span> 
</span></span><span class="line"><span class="cl">	
</span></span><span class="line"><span class="cl">	<span class="k">const</span> <span class="kt">size_t</span> <span class="n">size</span> <span class="o">=</span> <span class="n">__init_array_end</span> <span class="o">-</span> <span class="n">__init_array_start</span><span class="p">;</span> 
</span></span><span class="line"><span class="cl">	<span class="k">for</span> <span class="p">(</span><span class="kt">size_t</span> <span class="n">i</span> <span class="o">=</span> <span class="mi">0</span><span class="p">;</span> <span class="n">i</span> <span class="o">&lt;</span> <span class="n">size</span><span class="p">;</span> <span class="n">i</span><span class="o">++</span><span class="p">)</span> 
</span></span><span class="line"><span class="cl">		<span class="p">(</span><span class="o">*</span><span class="n">__init_array_start</span> <span class="p">[</span><span class="n">i</span><span class="p">])</span> <span class="p">(</span><span class="n">argc</span><span class="p">,</span> <span class="n">argv</span><span class="p">,</span> <span class="n">envp</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s have a look at the disassembly:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[0x00400688]&gt; pdf @ sym.__libc_csu_init
</span></span><span class="line"><span class="cl">/ (fcn) sym.__libc_csu_init 101
</span></span><span class="line"><span class="cl">|   sym.__libc_csu_init ();
</span></span><span class="line"><span class="cl">|           ; DATA XREF from 0x0040069e (entry0)
</span></span><span class="line"><span class="cl">|           ; DATA XREF from 0x004005c4 (sym.__libc_csu_ctor)
</span></span><span class="line"><span class="cl">|           ; DATA XREF from 0x004005c9 (sym.__libc_csu_ctor)
</span></span><span class="line"><span class="cl">|           0x004007d0      4157           push r15
</span></span><span class="line"><span class="cl">|           0x004007d2      4189ff         mov r15d, edi
</span></span><span class="line"><span class="cl">|           ; DATA XREF from 0x004005d2 (sym.__libc_csu_ctor)
</span></span><span class="line"><span class="cl">|           0x004007d5      4156           push r14
</span></span><span class="line"><span class="cl">|           0x004007d7      4989f6         mov r14, rsi
</span></span><span class="line"><span class="cl">|           0x004007da      4155           push r13
</span></span><span class="line"><span class="cl">|           0x004007dc      4989d5         mov r13, rdx
</span></span><span class="line"><span class="cl">|           0x004007df      4154           push r12
</span></span><span class="line"><span class="cl">|           0x004007e1      4c8d25200620.  lea r12, qword obj.__frame_dummy_init_array_entry ; 0x600e08 ; loc.__init_array_start ; &#34;P.@&#34; @ 0x600e08
</span></span><span class="line"><span class="cl">|           0x004007e8      55             push rbp
</span></span><span class="line"><span class="cl">|           0x004007e9      488d2d280620.  lea rbp, qword obj.__do_global_dtors_aux_fini_array_entry ; 0x600e18 ; loc.__init_array_end ; &#34;0.@&#34; @ 0x600e18
</span></span><span class="line"><span class="cl">|           0x004007f0      53             push rbx
</span></span><span class="line"><span class="cl">|           0x004007f1      4c29e5         sub rbp, r12
</span></span><span class="line"><span class="cl">|           0x004007f4      31db           xor ebx, ebx
</span></span><span class="line"><span class="cl">|           0x004007f6      48c1fd03       sar rbp, 3
</span></span><span class="line"><span class="cl">|           0x004007fa      4883ec08       sub rsp, 8
</span></span><span class="line"><span class="cl">|           0x004007fe      e805fdffff     call sym._init
</span></span><span class="line"><span class="cl">|           0x00400803      4885ed         test rbp, rbp
</span></span><span class="line"><span class="cl">|       ,=&lt; 0x00400806      741e           je 0x400826
</span></span><span class="line"><span class="cl">|       |   0x00400808      0f1f84000000.  nop dword [rax + rax]
</span></span><span class="line"><span class="cl">|      .--&gt; 0x00400810      4c89ea         mov rdx, r13
</span></span><span class="line"><span class="cl">|      ||   0x00400813      4c89f6         mov rsi, r14
</span></span><span class="line"><span class="cl">|      ||   0x00400816      4489ff         mov edi, r15d
</span></span><span class="line"><span class="cl">|      ||   0x00400819      41ff14dc       call qword [r12 + rbx*8]
</span></span><span class="line"><span class="cl">|      ||   0x0040081d      4883c301       add rbx, 1
</span></span><span class="line"><span class="cl">|      ||   0x00400821      4839eb         cmp rbx, rbp
</span></span><span class="line"><span class="cl">|      `==&lt; 0x00400824      75ea           jne 0x400810
</span></span><span class="line"><span class="cl">|       `-&gt; 0x00400826      4883c408       add rsp, 8
</span></span><span class="line"><span class="cl">|           0x0040082a      5b             pop rbx
</span></span><span class="line"><span class="cl">|           0x0040082b      5d             pop rbp
</span></span><span class="line"><span class="cl">|           0x0040082c      415c           pop r12
</span></span><span class="line"><span class="cl">|           0x0040082e      415d           pop r13
</span></span><span class="line"><span class="cl">|           0x00400830      415e           pop r14
</span></span><span class="line"><span class="cl">|           0x00400832      415f           pop r15
</span></span><span class="line"><span class="cl">\           0x00400834      c3             ret
</span></span></code></pre></td></tr></table>
</div>
</div><p>You can definitely see the call to <code>_init()</code>. The loop inside looks very interesting:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">|       |   0x08048592      8db600000000   lea esi, [esi]
</span></span><span class="line"><span class="cl">|      .--&gt; 0x08048598      8b442438       mov eax, dword [esp + arg_38h] ; [0x38:4]=52 ; &#39;8&#39;
</span></span><span class="line"><span class="cl">|      ||   0x0804859c      892c24         mov dword [esp], ebp
</span></span><span class="line"><span class="cl">|      ||   0x0804859f      89442408       mov dword [esp + local_8h], eax
</span></span><span class="line"><span class="cl">|      ||   0x080485a3      8b442434       mov eax, dword [esp + arg_34h] ; [0x34:4]=6 ; &#39;4&#39;
</span></span><span class="line"><span class="cl">|      ||   0x080485a7      89442404       mov dword [esp + local_4h], eax
</span></span><span class="line"><span class="cl">|      ||   0x080485ab      ff94b308ffff.  call dword [ebx + esi*4 - 0xf8]
</span></span><span class="line"><span class="cl">|      ||   0x080485b2      83c601         add esi, 1
</span></span><span class="line"><span class="cl">|      ||   0x080485b5      39fe           cmp esi, edi
</span></span><span class="line"><span class="cl">|      `==&lt; 0x080485b7      75df           jne 0x8048598
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s have a look what&rsquo;s happening inside this loop:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gef&gt; b *0x0000000000400803
</span></span><span class="line"><span class="cl">gef&gt; r
</span></span><span class="line"><span class="cl">gef&gt; 
</span></span><span class="line"><span class="cl">0x0000000000400819    &lt;__libc_csu_init+73&gt;     call   QWORD PTR [r12+rbx*8]   &lt;- $pc
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">gef&gt; x/x $r12
</span></span><span class="line"><span class="cl">0x600e08:       0x00400750
</span></span><span class="line"><span class="cl">gef&gt; x/x $rbx
</span></span><span class="line"><span class="cl">0x0:    Cannot access memory at address 0x0
</span></span></code></pre></td></tr></table>
</div>
</div><p>As you can see the address at <code>$r12 + rbx*8</code> will be called. Since <code>$rbx</code> is null the programm
execution will jump to the address <code>0x00400750</code>. But where does this address come from?</p>
<h3 id="constructors">Constructors</h3>
<p>As you have seen previously an <code>init_array</code> is used to call some functions. In C you&rsquo;d usually
implement some constructors using <code>__attribute__</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-.c" data-lang=".c"><span class="line"><span class="cl"><span class="kt">void</span> <span class="nf">init</span><span class="p">(</span><span class="kt">int</span> <span class="n">argc</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">argv</span><span class="p">,</span> <span class="kt">char</span> <span class="o">**</span><span class="n">envp</span><span class="p">)</span> <span class="p">{</span> 
</span></span><span class="line"><span class="cl">	<span class="nf">printf</span><span class="p">(</span><span class="s">&#34;INIT!&#34;</span><span class="p">);</span> 
</span></span><span class="line"><span class="cl"><span class="p">}</span>
</span></span><span class="line"><span class="cl"><span class="nf">__attribute__</span><span class="p">((</span><span class="nf">section</span><span class="p">(</span><span class="s">&#34;.init_array&#34;</span><span class="p">)))</span> <span class="nf">typeof</span><span class="p">(</span><span class="n">init</span><span class="p">)</span> <span class="o">*</span><span class="n">__init</span> <span class="o">=</span> <span class="n">init</span><span class="p">;</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>This whole information is stored inside the ELF binary at a section called <code>init_array</code>. Let&rsquo;s
see what it contains:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span><span class="lnt">7
</span><span class="lnt">8
</span><span class="lnt">9
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">$ objdump -d -j .init_array IntelligentSoftware
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">IntelligentSoftware:     file format elf64-x86-64
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">Disassembly of section .init_array:
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">0000000000600e08 &lt;__frame_dummy_init_array_entry&gt;:
</span></span><span class="line"><span class="cl">  600e08:       50 07 40 00 00 00 00 00 b0 05 40 00 00 00 00 00     P.@.......@.....
</span></span></code></pre></td></tr></table>
</div>
</div><p>Did you recognize the address <code>0x600e08</code> and the value <code>0x00400750</code>? Let&rsquo;s go back to <code>radare</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span><span class="lnt">3
</span><span class="lnt">4
</span><span class="lnt">5
</span><span class="lnt">6
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[0x00400688]&gt; pxr @ obj.__frame_dummy_init_array_entry
</span></span><span class="line"><span class="cl">0x00600e08  0x0000000000400750   P.@..... (.text) sym.frame_dummy sym.frame_dummy R X &#39;cmp qword [rip + 0x2006c8], 0&#39;
</span></span><span class="line"><span class="cl">0x00600e10  0x00000000004005b0   ..@..... (.text) sym.__libc_csu_ctor sym.__libc_csu_ctor R X &#39;sub rsp, 0x48&#39;
</span></span><span class="line"><span class="cl">0x00600e18  0x0000000000400730   0.@..... (.text) sym.__do_global_dtors_aux sym.__do_global_dtors_aux R X &#39;cmp byte [rip + 0x200998], 0&#39;
</span></span><span class="line"><span class="cl">0x00600e20  0x0000000000000000   ........ section_end.GNU_STACK
</span></span><span class="line"><span class="cl">...
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s have a look at the <strong>2nd</strong>  constructor/entry:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl"><span class="o">/</span> <span class="p">(</span><span class="n">fcn</span><span class="p">)</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_ctor</span> <span class="mi">216</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>   <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_ctor</span> <span class="p">();</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_8h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_10h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x10</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_11h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x11</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_12h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x12</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_14h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x14</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_18h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x18</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_38h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x38</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="n">UNKNOWN</span> <span class="n">XREF</span> <span class="n">from</span> <span class="mh">0x00400e10</span> <span class="p">(</span><span class="n">unk</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="p">;</span> <span class="n">CALL</span> <span class="n">XREF</span> <span class="n">from</span> <span class="mh">0x004005b0</span> <span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_ctor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004005b0</span>      <span class="mi">4883</span><span class="n">ec48</span>       <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x48</span>               <span class="p">;</span> <span class="s1">&#39;H&#39;</span> <span class="p">;</span> <span class="p">[</span><span class="mi">13</span><span class="p">]</span> <span class="n">va</span><span class="o">=</span><span class="mh">0x004005b0</span> <span class="n">pa</span><span class="o">=</span><span class="mh">0x000005b0</span> <span class="n">sz</span><span class="o">=</span><span class="mi">658</span> <span class="n">vsz</span><span class="o">=</span><span class="mi">658</span> <span class="n">rwx</span><span class="o">=--</span><span class="n">r</span><span class="o">-</span><span class="n">x</span> <span class="o">.</span><span class="n">text</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004005b4</span>      <span class="mi">64488</span><span class="n">b042528</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="p">:[</span><span class="mh">0x28</span><span class="p">]</span>    <span class="p">;</span> <span class="p">[</span><span class="mh">0x28</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mh">0x1200</span> <span class="p">;</span> <span class="s1">&#39;(&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004005bd</span>      <span class="mi">4889442438</span>     <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_38h</span><span class="p">],</span> <span class="n">rax</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004005c2</span>      <span class="mi">31</span><span class="n">c0</span>           <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004005c4</span>      <span class="n">b8d0074000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_init</span> <span class="p">;</span> <span class="s2">&#34;AWA..AVI..AUI..ATL.% . &#34;</span> <span class="err">@</span> <span class="mh">0x4007d0</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004005c9</span>      <span class="mi">48</span><span class="n">c7442408d0</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_8h</span><span class="p">],</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_init</span> <span class="p">;</span> <span class="p">[</span><span class="mh">0x4007d0</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mh">0x495641ff89415741</span> <span class="n">LEA</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_init</span> <span class="p">;</span> <span class="s2">&#34;AWA..AVI..AUI..ATL.% . &#34;</span> <span class="err">@</span> <span class="mh">0x4007d0</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004005d2</span>      <span class="mi">678</span><span class="n">b4005</span>       <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">eax</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span>    <span class="p">;</span> <span class="p">[</span><span class="mh">0x5</span><span class="p">:</span><span class="mi">4</span><span class="p">]</span><span class="o">=</span><span class="mi">257</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>           <span class="mh">0x004005d6</span>      <span class="mi">3</span><span class="n">ccc</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mh">0xcc</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>       <span class="p">,</span><span class="o">=&lt;</span> <span class="mh">0x004005d8</span>      <span class="mi">7415</span>           <span class="n">je</span> <span class="mh">0x4005ef</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>       <span class="o">|</span>   <span class="p">;</span> <span class="n">JMP</span> <span class="n">XREF</span> <span class="n">from</span> <span class="mh">0x0040064c</span> <span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_ctor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>       <span class="o">|</span>   <span class="mh">0x004005da</span>      <span class="mi">488</span><span class="n">b442438</span>     <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_38h</span><span class="p">]</span> <span class="p">;</span> <span class="p">[</span><span class="mh">0x38</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mh">0x1b001e00400009</span> <span class="p">;</span> <span class="s1">&#39;8&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>       <span class="o">|</span>   <span class="mh">0x004005df</span>      <span class="mf">644833042528.</span>  <span class="n">xor</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="p">:[</span><span class="mh">0x28</span><span class="p">]</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="p">,</span><span class="o">==&lt;</span> <span class="mh">0x004005e8</span>      <span class="mi">7570</span>           <span class="n">jne</span> <span class="mh">0x40065a</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">||</span>   <span class="mh">0x004005ea</span>      <span class="mi">4883</span><span class="n">c448</span>       <span class="n">add</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x48</span>               <span class="p">;</span> <span class="s1">&#39;H&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">||</span>   <span class="mh">0x004005ee</span>      <span class="n">c3</span>             <span class="n">ret</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span><span class="err">`</span><span class="o">-&gt;</span> <span class="mh">0x004005ef</span>      <span class="mi">488</span><span class="n">b3d8a0a20</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">__libc_ptr</span><span class="p">]</span> <span class="p">;</span> <span class="p">[</span><span class="mh">0x601080</span><span class="p">:</span><span class="mi">8</span><span class="p">]</span><span class="o">=</span><span class="mh">0x6010a0</span> <span class="n">obj</span><span class="o">.</span><span class="n">banner</span> <span class="n">LEA</span> <span class="n">obj</span><span class="o">.</span><span class="n">__libc_ptr</span> <span class="p">;</span> <span class="n">obj</span><span class="o">.</span><span class="n">__libc_ptr</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span>    <span class="mh">0x004005f6</span>      <span class="n">c644241046</span>     <span class="n">mov</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_10h</span><span class="p">],</span> <span class="mh">0x46</span> <span class="p">;</span> <span class="s1">&#39;F&#39;</span> <span class="p">;</span> <span class="p">[</span><span class="mh">0x46</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span> <span class="p">;</span> <span class="s1">&#39;F&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span>    <span class="mh">0x004005fb</span>      <span class="mi">488</span><span class="n">d742410</span>     <span class="n">lea</span> <span class="n">rsi</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_10h</span><span class="p">]</span> <span class="p">;</span> <span class="mh">0x10</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span>    <span class="mh">0x00400600</span>      <span class="n">c64424114c</span>     <span class="n">mov</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_11h</span><span class="p">],</span> <span class="mh">0x4c</span> <span class="p">;</span> <span class="s1">&#39;L&#39;</span> <span class="p">;</span> <span class="p">[</span><span class="mh">0x4c</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span> <span class="p">;</span> <span class="s1">&#39;L&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span>    <span class="mh">0x00400605</span>      <span class="mi">66</span><span class="n">c744241833</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">word</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_18h</span><span class="p">],</span> <span class="mh">0x3933</span> <span class="p">;</span> <span class="p">[</span><span class="mh">0x3933</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mh">0xffff</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span>    <span class="mh">0x0040060c</span>      <span class="n">b828000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mh">0x28</span>               <span class="p">;</span> <span class="s1">&#39;(&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span>    <span class="mh">0x00400611</span>      <span class="mi">66</span><span class="n">c744241241</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">word</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_12h</span><span class="p">],</span> <span class="mh">0x4741</span> <span class="p">;</span> <span class="p">[</span><span class="mh">0x4741</span><span class="p">:</span><span class="mi">2</span><span class="p">]</span><span class="o">=</span><span class="mh">0xffff</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span>    <span class="mh">0x00400618</span>      <span class="n">c64424142d</span>     <span class="n">mov</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_14h</span><span class="p">],</span> <span class="mh">0x2d</span> <span class="p">;</span> <span class="s1">&#39;-&#39;</span> <span class="p">;</span> <span class="p">[</span><span class="mh">0x2d</span><span class="p">:</span><span class="mi">1</span><span class="p">]</span><span class="o">=</span><span class="mi">0</span> <span class="p">;</span> <span class="s1">&#39;-&#39;</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span>    <span class="mh">0x0040061d</span>      <span class="mi">40</span><span class="n">f6c701</span>       <span class="n">test</span> <span class="n">dil</span><span class="p">,</span> <span class="mi">1</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">|</span><span class="p">,</span><span class="o">=&lt;</span> <span class="mh">0x00400621</span>      <span class="mi">752</span><span class="n">b</span>           <span class="n">jne</span> <span class="mh">0x40064e</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">||</span>   <span class="p">;</span> <span class="n">JMP</span> <span class="n">XREF</span> <span class="n">from</span> <span class="mh">0x00400651</span> <span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_ctor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>      <span class="o">||</span>   <span class="mh">0x00400623</span>      <span class="mi">40</span><span class="n">f6c702</span>       <span class="n">test</span> <span class="n">dil</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>     <span class="p">,</span><span class="o">===&lt;</span> <span class="mh">0x00400627</span>      <span class="mi">752</span><span class="n">a</span>           <span class="n">jne</span> <span class="mh">0x400653</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>     <span class="o">|||</span>   <span class="p">;</span> <span class="n">JMP</span> <span class="n">XREF</span> <span class="n">from</span> <span class="mh">0x00400658</span> <span class="p">(</span><span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_ctor</span><span class="p">)</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>     <span class="o">|||</span>   <span class="mh">0x00400629</span>      <span class="mi">89</span><span class="n">c1</span>           <span class="n">mov</span> <span class="n">ecx</span><span class="p">,</span> <span class="n">eax</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>     <span class="o">|||</span>   <span class="mh">0x0040062b</span>      <span class="mi">31</span><span class="n">d2</span>           <span class="n">xor</span> <span class="n">edx</span><span class="p">,</span> <span class="n">edx</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>     <span class="o">|||</span>   <span class="mh">0x0040062d</span>      <span class="n">c1e902</span>         <span class="n">shr</span> <span class="n">ecx</span><span class="p">,</span> <span class="mi">2</span>
</span></span><span class="line"><span class="cl"><span class="o">|</span>     <span class="o">|||</span>   <span class="mh">0x00400630</span>      <span class="n">a802</span>           <span class="n">test</span> <span class="n">al</span><span class="p">,</span> <span class="mi">2</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Do you see how the string <code>FLAG-</code> is being concatenated? Let&rsquo;s <code>seek</code> to that address and let <code>radare</code> give us some
graphics:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span><span class="lnt">41
</span><span class="lnt">42
</span><span class="lnt">43
</span><span class="lnt">44
</span><span class="lnt">45
</span><span class="lnt">46
</span><span class="lnt">47
</span><span class="lnt">48
</span><span class="lnt">49
</span><span class="lnt">50
</span><span class="lnt">51
</span><span class="lnt">52
</span><span class="lnt">53
</span><span class="lnt">54
</span><span class="lnt">55
</span><span class="lnt">56
</span><span class="lnt">57
</span><span class="lnt">58
</span><span class="lnt">59
</span><span class="lnt">60
</span><span class="lnt">61
</span><span class="lnt">62
</span><span class="lnt">63
</span><span class="lnt">64
</span><span class="lnt">65
</span><span class="lnt">66
</span><span class="lnt">67
</span><span class="lnt">68
</span><span class="lnt">69
</span><span class="lnt">70
</span><span class="lnt">71
</span><span class="lnt">72
</span><span class="lnt">73
</span><span class="lnt">74
</span><span class="lnt">75
</span><span class="lnt">76
</span><span class="lnt">77
</span><span class="lnt">78
</span><span class="lnt">79
</span><span class="lnt">80
</span><span class="lnt">81
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">[0x00400688]&gt; s 0x00000000004005b
</span></span><span class="line"><span class="cl">[0x004005b0]&gt; VV
</span></span><span class="line"><span class="cl">
</span></span><span class="line"><span class="cl">                                                         =---------------------------------=
</span></span><span class="line"><span class="cl">                                                         | [0x4005b0]                      |
</span></span><span class="line"><span class="cl">                                                         | 0x004005c4 sym.__libc_csu_init  |
</span></span><span class="line"><span class="cl">                                                         | 0x004005c9 sym.__libc_csu_init  |
</span></span><span class="line"><span class="cl">                                                         =---------------------------------=
</span></span><span class="line"><span class="cl">                                                               t f
</span></span><span class="line"><span class="cl">                                                             .-&#39; &#39;-----------------.
</span></span><span class="line"><span class="cl">                                                             |                     |
</span></span><span class="line"><span class="cl">                                                             |                     |
</span></span><span class="line"><span class="cl">                                                       =--------------------=      |
</span></span><span class="line"><span class="cl">                                                       |  0x4005ef          |      |
</span></span><span class="line"><span class="cl">                                                       =--------------------=      |
</span></span><span class="line"><span class="cl">                                                             t f                   |
</span></span><span class="line"><span class="cl">                                                       .-----&#39; &#39;-------------.     |
</span></span><span class="line"><span class="cl">                                                       |                     |     |
</span></span><span class="line"><span class="cl">                                                       |                     |     |
</span></span><span class="line"><span class="cl">                                                 =--------------------=      |     |
</span></span><span class="line"><span class="cl">                                                 |  0x40064e          |      |     |
</span></span><span class="line"><span class="cl">                                                 =--------------------=      |     |
</span></span><span class="line"><span class="cl">                                                     v                       |     |
</span></span><span class="line"><span class="cl">                                                     &#39;-----.   .-------------&#39;     |
</span></span><span class="line"><span class="cl">                                                           |   |                   |
</span></span><span class="line"><span class="cl">                                                           |   |                   |
</span></span><span class="line"><span class="cl">                                                       =--------------------=      |
</span></span><span class="line"><span class="cl">                                                       |  0x400623          |      |
</span></span><span class="line"><span class="cl">                                                       =--------------------=      |
</span></span><span class="line"><span class="cl">                                                             t f                   |
</span></span><span class="line"><span class="cl">                                                       .-----&#39; &#39;-------------.     |
</span></span><span class="line"><span class="cl">                                                       |                     |     |
</span></span><span class="line"><span class="cl">                                                       |                     |     |
</span></span><span class="line"><span class="cl">                                                 =--------------------=      |     |
</span></span><span class="line"><span class="cl">                                                 |  0x400653          |      |     |
</span></span><span class="line"><span class="cl">                                                 =--------------------=      |     |
</span></span><span class="line"><span class="cl">                                                     v                       |     |
</span></span><span class="line"><span class="cl">                                                     &#39;-----.   .-------------&#39;     |
</span></span><span class="line"><span class="cl">                                                           |   |                   |
</span></span><span class="line"><span class="cl">                                                           |   |                   |
</span></span><span class="line"><span class="cl">                                                       =--------------------=      |
</span></span><span class="line"><span class="cl">                                                       |  0x400629          |      |
</span></span><span class="line"><span class="cl">                                                       =--------------------=      |
</span></span><span class="line"><span class="cl">                                                               f t                 |
</span></span><span class="line"><span class="cl">                                                         .-----&#39; &#39;-----------.     |
</span></span><span class="line"><span class="cl">                                                         |                   |     |
</span></span><span class="line"><span class="cl">                                                         |                   |     |
</span></span><span class="line"><span class="cl">                                                 =--------------------=      |     |
</span></span><span class="line"><span class="cl">                                                 |  0x400636          |      |     |
</span></span><span class="line"><span class="cl">                                                 =--------------------=      |     |
</span></span><span class="line"><span class="cl">                                                     v                       |     |
</span></span><span class="line"><span class="cl">                                                     &#39;-----.     .-----------&#39;     |
</span></span><span class="line"><span class="cl">                                                           |     |                 |
</span></span><span class="line"><span class="cl">                                                           |     |                 |
</span></span><span class="line"><span class="cl">                                                       =--------------------=      |
</span></span><span class="line"><span class="cl">                                                       |  0x400641          |      |
</span></span><span class="line"><span class="cl">                                                       =--------------------=      |
</span></span><span class="line"><span class="cl">                                                               f t                 |
</span></span><span class="line"><span class="cl">                                                         .-----&#39; &#39;-----------.     |
</span></span><span class="line"><span class="cl">                                                         |                   |     |
</span></span><span class="line"><span class="cl">                                                         |                   |     |
</span></span><span class="line"><span class="cl">                                                 =--------------------=      |     |
</span></span><span class="line"><span class="cl">                                                 |  0x400645          |      |     |
</span></span><span class="line"><span class="cl">                                                 =--------------------=      |     |
</span></span><span class="line"><span class="cl">                                                     v                       |     |
</span></span><span class="line"><span class="cl">                                                     &#39;------------.   .-.----&#39;-----&#39;
</span></span><span class="line"><span class="cl">                                                                  |   | |
</span></span><span class="line"><span class="cl">                                                                  |   | |
</span></span><span class="line"><span class="cl">                                                              =--------------------=
</span></span><span class="line"><span class="cl">                                                              |  0x4005da          |
</span></span><span class="line"><span class="cl">                                                              =--------------------=
</span></span><span class="line"><span class="cl">                                                                    t f
</span></span><span class="line"><span class="cl">                                      .-----------------------------&#39; &#39;-------------------.
</span></span><span class="line"><span class="cl">                                      |                                                   |
</span></span><span class="line"><span class="cl">                                      |                                                   |
</span></span><span class="line"><span class="cl">                                =------------------------------------------=      =--------------------=
</span></span><span class="line"><span class="cl">                                |  0x40065a                                |      |  0x4005ea          |
</span></span><span class="line"><span class="cl">                                | 0x0040065a call sym.imp.__stack_chk_fail |      =--------------------=
</span></span><span class="line"><span class="cl">                                | 0x00400675 call sym.imp.__printf_chk     |
</span></span><span class="line"><span class="cl">                                | 0x0040067c call sym.get_flag             |
</span></span><span class="line"><span class="cl">                                =------------------------------------------=
</span></span></code></pre></td></tr></table>
</div>
</div><p>As you can see there is one execution path which will directly lead to <code>0x4005da</code> and then either
to <code>0x4005ea</code> or <code>sym.imp.__stack_chk_fail</code> if sth was wrong with the stack (this function
wil be called if the stack canaries were modified). Now let&rsquo;s have a look what happens inside
the first block:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span><span class="lnt">11
</span><span class="lnt">12
</span><span class="lnt">13
</span><span class="lnt">14
</span><span class="lnt">15
</span><span class="lnt">16
</span><span class="lnt">17
</span><span class="lnt">18
</span><span class="lnt">19
</span><span class="lnt">20
</span><span class="lnt">21
</span><span class="lnt">22
</span><span class="lnt">23
</span><span class="lnt">24
</span><span class="lnt">25
</span><span class="lnt">26
</span><span class="lnt">27
</span><span class="lnt">28
</span><span class="lnt">29
</span><span class="lnt">30
</span><span class="lnt">31
</span><span class="lnt">32
</span><span class="lnt">33
</span><span class="lnt">34
</span><span class="lnt">35
</span><span class="lnt">36
</span><span class="lnt">37
</span><span class="lnt">38
</span><span class="lnt">39
</span><span class="lnt">40
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-gdscript3" data-lang="gdscript3"><span class="line"><span class="cl">                <span class="o">=----------------------------------------------------------------------------=</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">[</span><span class="mh">0x4005b0</span><span class="p">]</span>                                                                 <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span>   <span class="p">;</span><span class="o">--</span> <span class="n">section_end</span><span class="o">..</span><span class="n">plt</span><span class="p">:</span>                                                    <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span>   <span class="p">;</span><span class="o">--</span> <span class="n">section</span><span class="o">..</span><span class="n">text</span><span class="p">:</span>                                                       <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">(</span><span class="n">fcn</span><span class="p">)</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_ctor</span> <span class="mi">216</span>                                              <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span>   <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_ctor</span> <span class="p">();</span>                                                  <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_8h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x8</span>                                               <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_10h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x10</span>                                             <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_11h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x11</span>                                             <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_12h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x12</span>                                             <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_14h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x14</span>                                             <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_18h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x18</span>                                             <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="p">;</span> <span class="k">var</span> <span class="ne">int</span> <span class="n">local_38h</span> <span class="err">@</span> <span class="n">rsp</span><span class="o">+</span><span class="mh">0x38</span>                                             <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005b0</span> <span class="mi">4883</span><span class="n">ec48</span>       <span class="n">sub</span> <span class="n">rsp</span><span class="p">,</span> <span class="mh">0x48</span>                                    <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005b4</span> <span class="mi">64488</span><span class="n">b042528</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">rax</span><span class="p">,</span> <span class="n">qword</span> <span class="n">fs</span><span class="p">:[</span><span class="mh">0x28</span><span class="p">]</span>                         <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005bd</span> <span class="mi">4889442438</span>     <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_38h</span><span class="p">],</span> <span class="n">rax</span>                 <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005c2</span> <span class="mi">31</span><span class="n">c0</span>           <span class="n">xor</span> <span class="n">eax</span><span class="p">,</span> <span class="n">eax</span>                                     <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005c4</span> <span class="n">b8d0074000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_init</span>                     <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005c9</span> <span class="mi">48</span><span class="n">c7442408d0</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_8h</span><span class="p">],</span> <span class="n">sym</span><span class="o">.</span><span class="n">__libc_csu_init</span>  <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005d2</span> <span class="mi">678</span><span class="n">b4005</span>       <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="n">dword</span> <span class="p">[</span><span class="n">eax</span> <span class="o">+</span> <span class="mi">5</span><span class="p">]</span>                         <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005d6</span> <span class="mi">3</span><span class="n">ccc</span>           <span class="n">cmp</span> <span class="n">al</span><span class="p">,</span> <span class="mh">0xcc</span>                                     <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">|</span> <span class="mh">0x004005d8</span> <span class="mi">7415</span>           <span class="n">je</span> <span class="mh">0x4005ef</span> <span class="p">;[</span><span class="n">a</span><span class="p">]</span>                                 <span class="o">|</span>
</span></span><span class="line"><span class="cl">                <span class="o">=----------------------------------------------------------------------------=</span>
</span></span><span class="line"><span class="cl">                      <span class="n">t</span> <span class="n">f</span>
</span></span><span class="line"><span class="cl">          <span class="o">.-----------</span><span class="s1">&#39; &#39;</span><span class="o">-------------------------------------------------.</span>
</span></span><span class="line"><span class="cl">          <span class="o">|</span>                                                               <span class="o">|</span>
</span></span><span class="line"><span class="cl">          <span class="o">|</span>                                                               <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">=---------------------------------------------------------------=</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span>  <span class="mh">0x4005ef</span>                                                     <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x004005ef</span> <span class="mi">488</span><span class="n">b3d8a0a20</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">rdi</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">obj</span><span class="o">.</span><span class="n">__libc_ptr</span><span class="p">]</span>     <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x004005f6</span> <span class="n">c644241046</span>     <span class="n">mov</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_10h</span><span class="p">],</span> <span class="mh">0x46</span>    <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x004005fb</span> <span class="mi">488</span><span class="n">d742410</span>     <span class="n">lea</span> <span class="n">rsi</span><span class="p">,</span> <span class="n">qword</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_10h</span><span class="p">]</span>    <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x00400600</span> <span class="n">c64424114c</span>     <span class="n">mov</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_11h</span><span class="p">],</span> <span class="mh">0x4c</span>    <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x00400605</span> <span class="mi">66</span><span class="n">c744241833</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">word</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_18h</span><span class="p">],</span> <span class="mh">0x3933</span>  <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x0040060c</span> <span class="n">b828000000</span>     <span class="n">mov</span> <span class="n">eax</span><span class="p">,</span> <span class="mh">0x28</span>                       <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x00400611</span> <span class="mi">66</span><span class="n">c744241241</span><span class="o">.</span>  <span class="n">mov</span> <span class="n">word</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_12h</span><span class="p">],</span> <span class="mh">0x4741</span>  <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x00400618</span> <span class="n">c64424142d</span>     <span class="n">mov</span> <span class="n">byte</span> <span class="p">[</span><span class="n">rsp</span> <span class="o">+</span> <span class="n">local_14h</span><span class="p">],</span> <span class="mh">0x2d</span>    <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x0040061d</span> <span class="mi">40</span><span class="n">f6c701</span>       <span class="n">test</span> <span class="n">dil</span><span class="p">,</span> <span class="mi">1</span>                         <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">|</span> <span class="mh">0x00400621</span> <span class="mi">752</span><span class="n">b</span>           <span class="n">jne</span> <span class="mh">0x40064e</span> <span class="p">;[</span><span class="n">b</span><span class="p">]</span>                   <span class="o">|</span>     <span class="o">|</span>
</span></span><span class="line"><span class="cl">    <span class="o">=---------------------------------------------------------------=</span>     <span class="o">|</span>
</span></span></code></pre></td></tr></table>
</div>
</div><p>Apparently the programm will jump to <code>0x4005ef</code> only if <code>$al = 0xcc</code>:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt">1
</span><span class="lnt">2
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">|           0x004005d6      3ccc           cmp al, 0xcc
</span></span><span class="line"><span class="cl">|       ,=&lt; 0x004005d8      7415           je 0x4005ef
</span></span></code></pre></td></tr></table>
</div>
</div><p>Let&rsquo;s debug the binary and see what happens:</p>
<div class="highlight"><div class="chroma">
<table class="lntable"><tr><td class="lntd">
<pre tabindex="0" class="chroma"><code><span class="lnt"> 1
</span><span class="lnt"> 2
</span><span class="lnt"> 3
</span><span class="lnt"> 4
</span><span class="lnt"> 5
</span><span class="lnt"> 6
</span><span class="lnt"> 7
</span><span class="lnt"> 8
</span><span class="lnt"> 9
</span><span class="lnt">10
</span></code></pre></td>
<td class="lntd">
<pre tabindex="0" class="chroma"><code class="language-fallback" data-lang="fallback"><span class="line"><span class="cl">gef&gt;  b *0x004005d6
</span></span><span class="line"><span class="cl">Breakpoint 1 at 0x4005d6
</span></span><span class="line"><span class="cl">gef&gt;  r
</span></span><span class="line"><span class="cl">gef&gt;  set $al=0xcc
</span></span><span class="line"><span class="cl">gef&gt;  c
</span></span><span class="line"><span class="cl">Continuing.
</span></span><span class="line"><span class="cl">FLAG-Allocating 1024 bytes 0x602420...
</span></span><span class="line"><span class="cl">Freeing buffer 0x602420...
</span></span><span class="line"><span class="cl">Heap is working perfectly! No Flag then
</span></span><span class="line"><span class="cl">[Inferior 1 (process 1745) exited normally]
</span></span></code></pre></td></tr></table>
</div>
</div><p>Well <code>FLAG-Allocating</code> looks like a flag! ;)</p>

    

  </div>
  
  
  

<section class="related-topics mt5 mb4">
  <div class="bt b--black-10 pt4">
    <h3 class="f4 fw6 mb3">Explore Related Topics</h3>
    
    <div class="cf">
      
      
      
      
      
      
      
      
      
      
      
      <div class="fl w-100">
        <div class="pa3 br2 bg-white ba b--black-10">
          <h4 class="f5 fw6 mt0 mb2">Explore My Main Topics</h4>
          <div class="cf">
            <div class="fl w-third-l pr2">
              <ul class="list pl0 mt0">
                <li class="pv1"><a href="https://blog.dornea.nu/tags/books" class="link dim dark-gray f6">Books & Reading</a></li>
                <li class="pv1"><a href="https://blog.dornea.nu/tags/summary" class="link dim dark-gray f6">Book Summaries</a></li>
              </ul>
            </div>
            <div class="fl w-third-l ph2">
              <ul class="list pl0 mt0">
                <li class="pv1"><a href="https://blog.dornea.nu/tags/philosophy" class="link dim dark-gray f6">Philosophy</a></li>
                <li class="pv1"><a href="https://blog.dornea.nu/tags/productivity" class="link dim dark-gray f6">Productivity</a></li>
                <li class="pv1"><a href="https://blog.dornea.nu/tags/politics" class="link dim dark-gray f6">Politics</a></li>
              </ul>
            </div>
            <div class="fl w-third-l pl2">
              <ul class="list pl0 mt0">
                <li class="pv1"><a href="https://blog.dornea.nu/tags/coding" class="link dim dark-gray f6">Coding</a></li>
                <li class="pv1"><a href="https://blog.dornea.nu/tags/emacs" class="link dim dark-gray f6">Emacs</a></li>
                <li class="pv1"><a href="https://brainfck.org" class="link dim dark-gray f6">My Zettelkasten</a></li>
              </ul>
            </div>
          </div>
        </div>
      </div>
      
    </div>
    
    <div class="tc mt4">
      <a href="https://blog.dornea.nu/tags" class="f6 link dim br-pill ph3 pv2 mb2 dib white bg-main-color">Browse All Tags</a>
    </div>
  </div>
</section>
  
  <div id="comments">
      

  </div>
</main>
 






<div class="tl fixed list-pages lh-copy" id="contents-list"></div>



<div class="pagination tc tr-l db fixed-l bottom-2-l right-2-l mb3 mb0-l">
  
<a id="scroll-to-top" class="f6 o-0 link br2 ph2 pv1 mb1 bg-main-color pointer" onclick="topFunction()" style="color: #fff; visibility: hidden; display: none; transition: opacity .5s, visibility .5s;" title="back to top">back to top</a>
<br>
  <p class="mb0 mt2">
  <a href="https://blog.dornea.nu/2016/11/29/ringzer0-ctf-binaries-time-to-learn-x86-asm-and-gdb/">prev</a>
  <a href="https://blog.dornea.nu/2016/12/09/ringzer0-ctf-binaries-introduction-to-mips/">next</a>
  </p>
</div>

  <footer class="content-width mt5 mb4 center ph3 gray f6">
  
  <div class="bt b--black-10 pv3"></div>
  
  
  <div class="cf">
    
    <div class="fl w-100 w-50-l pr4-l">
      <p class="mb2 fw6">About this blog</p>
      <p class="mv0 lh-copy">
        Personal thoughts on programming, productivity, and philosophy. I write about things I'm learning and ideas I find interesting.
      </p>
      <p class="mt3 o-70">
        © 2025 Victor Dorneanu
      </p>
    </div>
    
    
    <div class="fl w-100 w-50-l pl4-l mt4 mt0-l">
      <div class="cf">
        
        <div class="fl w-33">
          <p class="mb2 fw6">Navigation</p>
          <ul class="list pl0">
            <li class="pv1"><a href='https://blog.dornea.nu/' title="Home" class="link gray dim">Home</a></li>
            <li class="pv1"><a href='http://dornea.nu' title="About" class="link gray dim">About</a></li>
            <li class="pv1"><a href='https://blog.dornea.nu/tags' title="Tags" class="link gray dim">Tags</a></li>
            <li class="pv1"><a href='https://brainfck.org' title="Zettelkasten" class="link gray dim">Zettelkasten</a></li>
          </ul>
        </div>
        
        
        <div class="fl w-33">
          <p class="mb2 fw6">Connect</p>
          <ul class="list pl0">
            <li class="pv1">
              <a href='https://blog.dornea.nu/feed.xml' title="RSS" class="link gray dim">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="v-mid mr1"><path d="M4 11a9 9 0 0 1 9 9"></path><path d="M4 4a16 16 0 0 1 16 16"></path><circle cx="5" cy="19" r="1"></circle></svg>
                RSS Feed
              </a>
            </li>
            <li class="pv1">
              <a href='https://github.com/dorneanu' title="GitHub" class="link gray dim">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="v-mid mr1"><path d="M9 19c-5 1.5-5-2.5-7-3m14 6v-3.87a3.37 3.37 0 0 0-.94-2.61c3.14-.35 6.44-1.54 6.44-7A5.44 5.44 0 0 0 20 4.77 5.07 5.07 0 0 0 19.91 1S18.73.65 16 2.48a13.38 13.38 0 0 0-7 0C6.27.65 5.09 1 5.09 1A5.07 5.07 0 0 0 5 4.77a5.44 5.44 0 0 0-1.5 3.78c0 5.42 3.3 6.61 6.44 7A3.37 3.37 0 0 0 9 18.13V22"></path></svg>
                GitHub
              </a>
            </li>
            <li class="pv1">
              <a href='https://www.goodreads.com/user/show/121423977-victor-dorneanu' title="Goodreads" class="link gray dim">
                <svg xmlns="http://www.w3.org/2000/svg" width="16" height="16" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round" class="v-mid mr1"><path d="M4 19.5A2.5 2.5 0 0 1 6.5 17H20"></path><path d="M6.5 2H20v20H6.5A2.5 2.5 0 0 1 4 19.5v-15A2.5 2.5 0 0 1 6.5 2z"></path></svg>
                Goodreads
              </a>
            </li>
          </ul>
        </div>

        
        <div class="fl w-33">
          <p class="mb2 fw6">Support</p>
          <div class="pv1">
            <a href="https://www.buymeacoffee.com/dorneanu" target="_blank" class="dib">
              <img src="https://cdn.buymeacoffee.com/buttons/v2/default-yellow.png" alt="Buy Me A Coffee" style="height: 40px;">
            </a>
          </div>
        </div>
      </div>
    </div>
  </div>
  
  
  <div class="tc mt4 pt3 f7 o-70">
    Powered by <a href="https://gohugo.io/" target="_blank" class="link gray dim">Hugo</a>, based on the <a href="https://github.com/lingxz/er" target="_blank" class="link gray dim">Er</a> theme.
  </div>
</footer>
  



<script src="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.min.js"></script>
<link rel="stylesheet" href="https://cdnjs.cloudflare.com/ajax/libs/tocbot/4.4.2/tocbot.css">
<style>.is-active-link::before { background-color: var(--secondary-color); }</style>




<script type="text/javascript">
var prevScrollpos = window.pageYOffset;
window.onscroll = function() {
  var currentScrollPos = window.pageYOffset;

  
  if (document.getElementById("tag-cloud") !== null) { 
    if (prevScrollpos > currentScrollPos) { 
      document.getElementById("tag-cloud").style.visibility = "visible";
      document.getElementById("tag-cloud").style.opacity = "1";
    } else {
      document.getElementById("tag-cloud").style.visibility = "hidden";
      document.getElementById("tag-cloud").style.opacity = "0";
    }
  }
  

  
  if (document.body.scrollTop > 1000 || document.documentElement.scrollTop > 1000) {
      document.getElementById("scroll-to-top").style.display = "inline";
      document.getElementById("scroll-to-top").style.visibility = "visible";
      document.getElementById("scroll-to-top").style.opacity = "1";
  } else {
      document.getElementById("scroll-to-top").style.visibility = "hidden";
      document.getElementById("scroll-to-top").style.opacity = "0";
  }
  
  prevScrollpos = currentScrollPos;
}


function topFunction() {
  document.body.scrollTop = 0; 
  document.documentElement.scrollTop = 0; 
}






if (document.getElementById("contents-list") !== null && document.getElementsByClassName("post-content").length !== 0) { 
  tocbot.init({
    
    tocSelector: '#contents-list',
    
    contentSelector: '.post-content',
    
    headingSelector: 'h1, h2, h3',
  });
}


</script>





<script>
 var glightbox = GLightbox({
     selector: '.glightbox'
 });
</script>

  
</body>
</html>
